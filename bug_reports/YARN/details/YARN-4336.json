{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12911083","self":"https://issues.apache.org/jira/rest/api/2/issue/12911083","key":"YARN-4336","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2015-11-06T15:46:21.558+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Nov 06 17:19:41 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_251444_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_3626013","customfield_12312321":null,"resolutiondate":"2015-11-06T16:32:42.602+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-4336/watchers","watchCount":3,"isWatching":false},"created":"2015-11-06T15:28:05.176+0000","customfield_12310192":"Tactical workaround","customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327197","id":"12327197","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12327585","id":"12327585","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329003","id":"12329003","description":"2.6.1 release","name":"2.6.1","archived":false,"released":true,"releaseDate":"2015-09-23"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12331976","id":"12331976","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[{"id":"12448059","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12448059","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12818690","key":"YARN-3452","self":"https://issues.apache.org/jira/rest/api/2/issue/12818690","fields":{"summary":"Bogus token usernames cause many invalid group lookups","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-03-19T07:10:37.998+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Hi folks after performing some debug for our Unix Engineering and Active Directory teams it was discovered that on YARN Container Initialization a call via Hadoop Common AccessControlList.java:\n\n  for(String group: ugi.getGroupNames()) {\n        if (groups.contains(group)) {\n          return true;\n        }\n      }\n\nUnfortunately with the security call to check access on \"appattempt_XXXXXXXXXXXXX_XXXXX_XXXXX\" will always return false but will make unnecessary calls to NameSwitch service on linux which will call things like SSSD/Quest VASD which will then initiate LDAP calls looking for non existent userid's causing excessive load on LDAP.\n\nFor now our tactical work around is as follows:\n\n\n\nExample of VASD Debug log showing the lookups for one task attempt 32 of them:\n/**\n   * Checks if a user represented by the provided {@link UserGroupInformation}\n   * is a member of the Access Control List\n   * @param ugi UserGroupInformation to check if contained in the ACL\n   * @return true if ugi is member of the list\n   */\n  public final boolean isUserInList(UserGroupInformation ugi) {\n    if (allAllowed || users.contains(ugi.getShortUserName())) {\n      return true;\n    } else {\n        String patternString = \"^appattempt_\\\\d+_\\\\d+_\\\\d+$\";\n\n        Pattern pattern = Pattern.compile(patternString);\n\n        Matcher matcher = pattern.matcher(ugi.getShortUserName());\n        boolean matches = matcher.matches();\n        if (matches) {\n        \tLOG.debug(\"Bailing !! AppAttempt Matches DONOT call UGI FOR GROUPS!!\");;\n        \treturn false;\n        }\n    \t\n    \t\n      for(String group: ugi.getGroupNames()) {\n        if (groups.contains(group)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  public boolean isUserAllowed(UserGroupInformation ugi) {\n    return isUserInList(ugi);\n  } \nOne task:\nOct 30 22:55:43 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:55:43 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:55:43 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:55:43 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:56:15 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:56:15 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:56:15 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:56:15 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:56:45 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:56:45 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:56:45 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:56:45 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:57:18 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:57:18 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:57:18 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:57:18 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:57:49 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:57:49 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:57:49 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:57:49 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:58:22 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:58:22 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:58:22 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:58:22 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:58:52 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:58:52 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:58:52 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:58:52 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:59:30 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:59:30 xhadoopm5d vasd[20741]: _vasug_user_namesearch_gc: searching GC for host service domain EXNSD.EXA.EXAMPLE.COM with filter (&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))\nOct 30 22:59:30 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\nOct 30 22:59:30 xhadoopm5d vasd[20741]: libvas_attrs_find_uri: Searching <GC://@EXNSD.EXA.EXAMPLE.COM> with filter=<(&(objectCategory=Person)(samaccountname=appattempt_1446145939879_0022_000001))>, base=<>, scope=<sub>\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329059","id":"12329059","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12771096","id":"12771096","filename":"tactical_defense.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"created":"2015-11-06T19:47:01.601+0000","size":2349,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12771096/tactical_defense.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"YARN NodeManager - Container Initialization - Excessive load on NSS/LDAP","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"NSS w/ SSSD or Dell/Quest - VASD","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12911083/comment/14993821","id":"14993821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"body":"tactical fix","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"created":"2015-11-06T15:34:48.733+0000","updated":"2015-11-06T15:34:48.733+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12911083/comment/14993836","id":"14993836","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"I believe this is a duplicate of YARN-3452.  We fixed it by reverting  HADOOP-10650 in our internal build since we don't need the blacklisting functionality added by that feature, and that's what caused the excess lookups.  IMHO the real fix is to have YARN not use bogus user names, but I don't know if that's going to be an easy change to make.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-11-06T15:46:21.558+0000","updated":"2015-11-06T15:46:21.558+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12911083/comment/14993899","id":"14993899","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"body":"[~jlowe] I dumped stack traces below and it seems to match what was done in Hadoop-10650.. Do you see an issue with my workaround for now in my own env until HWX can provide a final solution?\n\nSeems like this could also be related...\n\nhttps://issues.apache.org/jira/browse/HADOOP-12413\n\nStack Trace:\n2015-11-06 11:25:52,313 DEBUG ipc.Server (Server.java:processOneRpc(1762)) -  got #-33\n2015-11-06 11:25:52,313 DEBUG security.SaslRpcServer (SaslRpcServer.java:create(174)) - Created SASL server with mechanism = DIGEST-\nMD5\n2015-11-06 11:25:52,314 DEBUG ipc.Server (Server.java:doSaslReply(1424)) - Sending sasl message state: NEGOTIATE\nauths {\n  method: \"TOKEN\"\n  mechanism: \"DIGEST-MD5\"\n  protocol: \"\"\n  serverId: \"default\"\n  challenge: \"realm=\\\"default\\\",nonce=\\\"389ZufpXfkC6CKunYceHayMBI3KM7v3keu9nPC/b\\\",qop=\\\"auth\\\",charset=utf-8,algorithm=md5-sess\"\n}\nauths {\n  method: \"KERBEROS\"\n  mechanism: \"GSSAPI\"\n  protocol: \"nm\"\n  serverId: \"xhadoopm5d.example.com\"\n}\n\n2015-11-06 11:25:52,314 DEBUG ipc.Server (Server.java:processResponse(972)) - Socket Reader #1 for port 8040: responding to null fro\nm 157.121.72.167:64599 Call#-33 Retry#-1\n2015-11-06 11:25:52,314 DEBUG ipc.Server (Server.java:processResponse(991)) - Socket Reader #1 for port 8040: responding to null fro\nm 157.121.72.167:64599 Call#-33 Retry#-1 Wrote 212 bytes.\n2015-11-06 11:25:52,343 DEBUG ipc.Server (Server.java:processOneRpc(1762)) -  got #-33\n2015-11-06 11:25:52,343 DEBUG ipc.Server (Server.java:processSaslToken(1393)) - Have read input token of size 246 for processing by \nsaslServer.evaluateResponse()\n2015-11-06 11:25:52,344 DEBUG security.SaslRpcServer (SaslRpcServer.java:handle(308)) - SASL server DIGEST-MD5 callback: setting pas\nsword for client: testing (auth:SIMPLE)\n2015-11-06 11:25:52,344 DEBUG security.SaslRpcServer (SaslRpcServer.java:handle(325)) - SASL server DIGEST-MD5 callback: setting can\nonicalized client ID: testing\n2015-11-06 11:25:52,345 DEBUG ipc.Server (Server.java:buildSaslResponse(1410)) - Will send SUCCESS token of size 40 from saslServer.\n2015-11-06 11:25:52,345 DEBUG ipc.Server (Server.java:saslProcess(1298)) - SASL server context established. Negotiated QoP is auth\n2015-11-06 11:25:52,345 DEBUG ipc.Server (Server.java:saslProcess(1303)) - SASL server successfully authenticated client: testing (a\nuth:SIMPLE)\n2015-11-06 11:25:52,345 INFO  ipc.Server (Server.java:saslProcess(1306)) - Auth successful for testing (auth:SIMPLE)\n2015-11-06 11:25:52,345 DEBUG ipc.Server (Server.java:doSaslReply(1424)) - Sending sasl message state: SUCCESS\ntoken: \"rspauth=9bfdf3e61c489664e885d7043b352c24\"\n\n2015-11-06 11:25:52,345 DEBUG ipc.Server (Server.java:processResponse(972)) - Socket Reader #1 for port 8040: responding to null fro\nm 157.121.72.167:64599 Call#-33 Retry#-1\n2015-11-06 11:25:52,346 DEBUG ipc.Server (Server.java:processResponse(991)) - Socket Reader #1 for port 8040: responding to null fro\nm 157.121.72.167:64599 Call#-33 Retry#-1 Wrote 64 bytes.\n2015-11-06 11:25:52,357 DEBUG ipc.Server (Server.java:processOneRpc(1762)) -  got #-3\n2015-11-06 11:25:52,357 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - java.lang.Thread.getSt\nackTrace(Thread.java:1589)\n2015-11-06 11:25:52,357 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.security.UserGroupInformation.getGroupNames(UserGroupInformation.java:1487)\n2015-11-06 11:25:52,357 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.security.authorize.AccessControlList.isUserInList(AccessControlList.java:252)\n2015-11-06 11:25:52,357 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.security.authorize.AccessControlList.isUserAllowed(AccessControlList.java:262)\n2015-11-06 11:25:52,357 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.security.authorize.ServiceAuthorizationManager.authorize(ServiceAuthorizationManager.java:110)\n2015-11-06 11:25:52,357 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server.authorize(Server.java:2507)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server.access$3300(Server.java:135)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Connection.authorizeConnection(Server.java:1923)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Connection.processConnectionContext(Server.java:1690)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Connection.processRpcOutOfBandRequest(Server.java:1891)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Connection.processOneRpc(Server.java:1767)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Connection.readAndProcess(Server.java:1531)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Listener.doRead(Server.java:762)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Listener$Reader.doRunLoop(Server.java:636)\n2015-11-06 11:25:52,358 DEBUG security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1488)) - org.apache.hadoop.ipc.Server$Listener$Reader.run(Server.java:607)\n2015-11-06 11:25:52,370 WARN  security.UserGroupInformation (UserGroupInformation.java:getGroupNames(1495)) - No groups available for user testing\n2015-11-06 11:25:52,370 INFO  authorize.ServiceAuthorizationManager (ServiceAuthorizationManager.java:authorize(118)) - Authorization successful for testing (auth:TOKEN) for protocol=interface org.apache.hadoop.yarn.server.nodemanager.api.LocalizationProtocolPB\n2015-11-06 11:25:52,370 DEBUG ipc.Server (Server.java:authorizeConnection(1925)) - Successfully authorized userInfo {\n}\nprotocol: \"org.apache.hadoop.yarn.server.nodemanager.api.LocalizationProtocolPB\"\n\n2015-11-06 11:25:52,370 DEBUG ipc.Server (Server.java:processOneRpc(1762)) -  got #0\n2015-11-06 11:25:52,371 DEBUG ipc.Server (Server.java:run(2009)) - IPC Server handler 0 on 8040: org.apache.hadoop.yarn.server.nodemanager.api.LocalizationProtocolPB.heartbeat from 157.121.72.167:64599 Call#0 Retry#0 for RpcKind RPC_PROTOCOL_BUFFER\n2015-11-06 11:25:52,371 DEBUG security.UserGroupInformation (UserGroupInformation.java:logPrivilegedAction(1655)) - PrivilegedAction as:testing (auth:TOKEN) from:org.apache.hadoop.ipc.Server$Handler.run(Server.java:2033)\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"created":"2015-11-06T16:30:40.557+0000","updated":"2015-11-06T16:30:40.557+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12911083/comment/14993932","id":"14993932","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"bq. Seems like this could also be related...  https://issues.apache.org/jira/browse/HADOOP-12413\nNice find!  I totally missed that when it went by.  I'll pull that fix into the 2.6 and 2.7 lines.  I think that could eliminate the bogus lookups in practice when the reverse ACL isn't being used.\n\nbq.  Do you see an issue with my workaround for now in my own env until HWX can provide a final solution?\nIt will work.  Nit: it's pricey to compile the pattern every time, could just compile it once.  Or as I mentioned above, I think pulling in HADOOP-12413 to your build could also eliminate the bogus lookups (assuming you don't use the reverse ACL feature).\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-11-06T16:47:04.356+0000","updated":"2015-11-06T16:47:04.356+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12911083/comment/14994018","id":"14994018","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"body":"[~jlowe] just confirmed that HADOOP-12413 does seem to fix it.. Just ran a test with the else if block... I think as a safety measure for the time being I may still keep my tactical fix but I'll move the regex to compile once as if the LDAP storm from our jobs show up again I'm going to have a bad day :)\n\n\nConfirmed it never was sent out to NSS/LDAP\nappattempt_1446307555640_0052_000001","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gss2002","name":"gss2002","key":"gss2002","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Senia","active":true,"timeZone":"America/New_York"},"created":"2015-11-06T17:19:41.640+0000","updated":"2015-11-06T17:19:41.640+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-4336/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2o2d3:"}}