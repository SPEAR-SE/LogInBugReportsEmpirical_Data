{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12636928","self":"https://issues.apache.org/jira/rest/api/2/issue/12636928","key":"YARN-477","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2013-03-28T23:26:51.166+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Mar 28 23:26:51 UTC 2013","customfield_12310420":"317420","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1287834867_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-03-28T22:27:07.268+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-477/watchers","watchCount":5,"isWatching":false},"created":"2013-03-14T00:43:12.423+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zjshen","name":"zjshen","key":"zjshen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Zhijie Shen","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-03-28T23:26:51.166+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I have been porting Giraph to YARN (GIRAPH-13 is the issue) and when I launch my App Master, if the container command line runs it successfully, any failure in the App Master or my launched Giraph Tasks promptly reports to Client and ends my job run. However, if the command line sent to the app master container fails to launch it at all, the error exit code is not propagating. My client hangs with the job at containersUsed == 1 and state == ACCEPTED for as long as you want to sit and wait before CTRL-C'ing your way out.\n\nDisclaimer: this could be my fault. But I wanted to throw it out there in case its not. I also (when this happens) not getting error logs since the app master never launched, so I really have no visibility into why it failed to launch. I am sure its not launching, but the client IS sending the app request, getting a container for my AM, and I see the command line run on the container in my logs. Thats all.\n\nThanks! If this is a dup or \"won't fix\" for some reason, let me know and sorry for wasting your time!\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323272","id":"12323272","description":"2.0.3-alpha release","name":"2.0.3-alpha","archived":false,"released":true,"releaseDate":"2013-02-14"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"317761","customfield_12312823":null,"summary":"MiniYARNCluster: When container executor script fails to launch App Master, NM logs error, but Client doesn't get signaled to kill the job","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636928/comment/13602892","id":"13602892","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"body":"Duh. Too many issues fixed all at once, they are all running together in my mind. OK, going over this again, this is happening during my integration tests with MiniYARNCluster, not on the real cluster.\n\nSo perhaps the real YARN implementation handles propagating the error to the client and RM (etc) when the command line the client tries to use to launch the container for the AM fails. I think its the MiniYARNCluster that is not handling this situation correctly.\n\nAgain, the issue is:\n\nClient starts fine. Creates AMContainerSpec stuff and tries to request AM container. This request includes the shell command to launch our AM in the container. Container shows up as being granted and provisioned by RM, but from there the client hangs waiting for job success/fail, saying it has \"1 container used\" the whole time (the AM failed container.) What seems to be happening is this shell script fails in launching the AM in its container, so the container just sits there forever. Lets check this in MiniYARNCluster and see.\n\nI will try to \"break\" the Giraph MiniYARNCluster test again and recreate some decent log traces leading up to the event and I will post here. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-14T23:44:07.255+0000","updated":"2013-03-14T23:44:07.255+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636928/comment/13602895","id":"13602895","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"body":"nodemanager log for MiniYARNCluster DID get a log report for app master that could only come from the shell command failing:\n\n{code}\nException in thread \"main\" java.lang.NoClassDefFoundError: org/apache/giraph/yarn/GiraphApplicationMaster\nCaused by: java.lang.ClassNotFoundException: org.apache.giraph.yarn.GiraphApplicationMaster\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)\n{code}\n\nSo thats good. But I don't think its propagating this to the MiniYARNCluster's RM or my Client. From my Client's end, the logs are endless heartbeat msg's with -1000 exitCode until I ctrl-c out of the test suite.\n\nFYI, this is not a priority or blocker for my Giraph on YARN, it all works now (including the test) in case I wasn't clear. But it should probably get investigated/fixed soon if I've really found something here ;)\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-14T23:47:45.641+0000","updated":"2013-03-14T23:47:45.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636928/comment/13604440","id":"13604440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"body":"Sorry, tried to recreate this today and am not seeing the same problem when I set up the same conditions (test breaks instead of hangs on minicluster job forever like before) maybe wait on this and I will post NM and RM logs when I encounter it again.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=initialcontext","name":"initialcontext","key":"initialcontext","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Reisman","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-16T22:33:41.563+0000","updated":"2013-03-16T22:33:41.563+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636928/comment/13616817","id":"13616817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Eli, please reopen the ticket if you run into this again. Tx.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-28T23:26:51.166+0000","updated":"2013-03-28T23:26:51.166+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-477/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1irrz:"}}