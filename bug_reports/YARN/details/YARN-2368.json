{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12730448","self":"https://issues.apache.org/jira/rest/api/2/issue/12730448","key":"YARN-2368","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2014-07-29T11:18:14.963+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 06 16:28:20 UTC 2015","customfield_12310420":"408521","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_24301014752_*|*_1_*:*_2_*:*_683154_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-05-06T16:28:33.064+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-2368/watchers","watchCount":15,"isWatching":false},"created":"2014-07-29T10:00:15.200+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326697","id":"12326697","description":"2.4.1 bug-fix release","name":"2.4.1","archived":false,"released":true,"releaseDate":"2014-06-30"}],"issuelinks":[{"id":"12423782","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12423782","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12761770","key":"YARN-2962","self":"https://issues.apache.org/jira/rest/api/2/issue/12761770","fields":{"summary":"ZKRMStateStore: Limit the number of znodes under a znode","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-10T05:29:57.755+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319322","id":"12319322","name":"resourcemanager"}],"timeoriginalestimate":null,"description":"Both ResouceManagers throw out STATE_STORE_OP_FAILED events and failed finally. ZooKeeper log shows that ZKRMStateStore tries to update a znode larger than 1MB, which is the default configuration of ZooKeeper server and client in 'jute.maxbuffer'.\n\nResourceManager (ip addr: 10.153.80.8) log shows as the following:\n{code}\n2014-07-25 22:33:11,078 INFO org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore: ZKRMStateStore Session connected\n2014-07-25 22:33:11,078 INFO org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore: ZKRMStateStore Session restored\n2014-07-25 22:33:11,214 FATAL org.apache.hadoop.yarn.server.resourcemanager.ResourceManager: Received a org.apache.hadoop.yarn.server.resourcemanager.RMFatalEvent of type STATE_STORE_OP_FAILED. Cause:\norg.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /rmstore/ZKRMStateRoot/RMAppRoot/application_1406264354826_1645/appattempt_1406264354826_1645_000001\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n        at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1041)\n        at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1069)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore$8.run(ZKRMStateStore.java:926)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore$8.run(ZKRMStateStore.java:923)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore$ZKAction.runWithCheck(ZKRMStateStore.java:973)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore$ZKAction.runWithRetries(ZKRMStateStore.java:992)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.existsWithRetries(ZKRMStateStore.java:923)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.updateApplicationAttemptStateInternal(ZKRMStateStore.java:620)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore.handleStoreEvent(RMStateStore.java:675)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore$ForwardingEventHandler.handle(RMStateStore.java:766)\n        at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore$ForwardingEventHandler.handle(RMStateStore.java:761)\n        at org.apache.hadoop.yarn.event.AsyncDispatcher.dispatch(AsyncDispatcher.java:173)\n        at org.apache.hadoop.yarn.event.AsyncDispatcher$1.run(AsyncDispatcher.java:106)\n        at java.lang.Thread.run(Thread.java:745)\n{code}\n\n\nMeanwhile, ZooKeeps log shows as the following:\n{code}\n2014-07-25 22:10:09,728 [myid:1] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.153.80.8:58890\n2014-07-25 22:10:09,730 [myid:1] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@832] - Client attempting to renew session 0x247684586e70006 at /10.153.80.8:58890\n2014-07-25 22:10:09,730 [myid:1] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:Learner@107] - Revalidating client: 0x247684586e70006\n2014-07-25 22:10:09,730 [myid:1] - INFO  [QuorumPeer[myid=1]/0.0.0.0:2181:ZooKeeperServer@595] - Established session 0x247684586e70006 with negotiated timeout 10000 for client /10.153.80.8:58890\n2014-07-25 22:10:09,730 [myid:1] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@863] - got auth packet /10.153.80.8:58890\n2014-07-25 22:10:09,730 [myid:1] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@897] - auth success /10.153.80.8:58890\n2014-07-25 22:10:09,742 [myid:1] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x247684586e70006 due to java.io.IOException: Len error 1530\n747\n2014-07-25 22:10:09,743 [myid:1] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.153.80.8:58890 which had sessionid 0x247684586e70006\n... ...\n2014-07-25 22:33:10,966 [myid:1] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x247684586e70006 due to java.io.IOException: Len error 1530747\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12658387","id":"12658387","filename":"YARN-2368.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-29T10:07:07.281+0000","size":3460,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12658387/YARN-2368.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"408519","customfield_12312823":null,"summary":"ResourceManager failed when ZKRMStateStore tries to update znode data larger than 1MB","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14077572","id":"14077572","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"This patch adds a configure, \"yarn.resourcemanager.zk-jutemaxbuffer-bytes\", in yarn-site.xml, so that ZKRMStateStore can set jute.maxbuffer larger than 1MB when connect to ZooKeeper Server. \n\nPlease have a check of the patch, thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-29T10:11:32.305+0000","updated":"2014-07-29T10:11:32.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14077616","id":"14077616","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12658387/YARN-2368.patch\n  against trunk revision .\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.\n\n    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-YARN-Build/4471//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-YARN-Build/4471//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-07-29T11:18:14.963+0000","updated":"2014-07-29T11:18:14.963+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14078804","id":"14078804","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for your contribution, [~breno.leitao]! Could you explain the condition you faced this problem? If we face this problem very often, it's critical problem of ZKRMStateStore. However, data stored in ZKRMStateStore are small basically. Therefore, I think it's strange that this kind of problem appear. Additionally, if the max data size is fixed, we should make it default value not to face this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-07-30T02:29:59.960+0000","updated":"2014-07-30T02:29:59.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14078805","id":"14078805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"[~breno.leitao], oops, sorry for calling you wrongly. I tried to mention [~guoleitao].\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-07-30T02:31:45.548+0000","updated":"2014-07-30T02:31:45.548+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14078954","id":"14078954","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~ozawa] for your comments. \n\nI deployed hadoop-2.3.0-cdh5.1.0 with 22-queue fairscheduler on my 20-node cluster. Two resourcemanagers are deployed exclusively on 10.153.80.8 and 10.153.80.18. \n\nJobs are submitted from gridmix:\n{code}\nsudo -u mapred hadoop jar /usr/lib/hadoop-mapreduce/hadoop-gridmix.jar -Dgridmix.min.file.size=10485760 -Dgridmix.job-submission.use-queue-in-trace=true -Dgridmix.distributed-cache-emulation.enable=false  -generate 34816m hdfs:///user/mapred/foo/ hdfs:///tmp/job-trace.json\n{code}\njob-trace.json is generated by Rumen, with 6,000 jobs, average #maptasks per job is  320 and average #reducetasks is 25.\n\nI found 3 times (gridmix tested more than 3 times) that resourcemanager failed when handle STATE_STORE_OP_FAILED event. At the same time, zookeeper throws out  'Len error IOException'\n{code}\n... ...\n2014-07-24 21:00:51,170 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.153.80.8:47135\n2014-07-24 21:00:51,171 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@832] - Client attempting to renew session 0x247678daa88001a at /10.153.80.8:47135\n2014-07-24 21:00:51,171 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:Learner@107] - Revalidating client: 0x247678daa88001a\n2014-07-24 21:00:51,171 [myid:3] - INFO  [QuorumPeer[myid=3]/0.0.0.0:2181:ZooKeeperServer@595] - Established session 0x247678daa88001a with negotiated timeout 10000 for client /10.153.80.8:47135\n2014-07-24 21:00:51,171 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@863] - got auth packet /10.153.80.8:47135\n2014-07-24 21:00:51,172 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@897] - auth success /10.153.80.8:47135\n2014-07-24 21:00:51,186 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x247678daa88001a due to java.io.IOException: Len error 1813411\n2014-07-24 21:00:51,186 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.153.80.8:47135 which had sessionid 0x247678daa88001a\n\n... ...\n\n2014-07-25 22:10:08,919 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.153.80.8:50480\n2014-07-25 22:10:08,921 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@832] - Client attempting to renew session 0x247684586e70006 at /10.153.80.8:50480\n2014-07-25 22:10:08,922 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@595] - Established session 0x247684586e70006 with negotiated timeout 10000 for client /10.153.80.8:50480\n2014-07-25 22:10:08,922 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@863] - got auth packet /10.153.80.8:50480\n2014-07-25 22:10:08,923 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@897] - auth success /10.153.80.8:50480\n2014-07-25 22:10:08,934 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x247684586e70006 due to java.io.IOException: Len error 1530747\n2014-07-25 22:10:08,934 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.153.80.8:50480 which had sessionid 0x247684586e70006\n\n... ...\n\n2014-07-26 02:22:59,627 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.153.80.18:60588\n2014-07-26 02:22:59,629 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@832] - Client attempting to renew session 0x2476de7c1af0002 at /10.153.80.18:60588\n2014-07-26 02:22:59,629 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@595] - Established session 0x2476de7c1af0002 with negotiated timeout 10000 for client /10.153.80.18:60588\n2014-07-26 02:22:59,630 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@863] - got auth packet /10.153.80.18:60588\n2014-07-26 02:22:59,630 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:ZooKeeperServer@897] - auth success /10.153.80.18:60588\n2014-07-26 02:22:59,648 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x2476de7c1af0002 due to java.io.IOException: Len error 1649043\n2014-07-26 02:22:59,648 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.153.80.18:60588 which had sessionid 0x2476de7c1af0002\n{code}\n\n\n  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoleitao","name":"guoleitao","key":"guoleitao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=guoleitao&avatarId=15863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=guoleitao&avatarId=15863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=guoleitao&avatarId=15863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=guoleitao&avatarId=15863"},"displayName":"Leitao Guo","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-30T05:59:46.579+0000","updated":"2014-07-30T05:59:46.579+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14355471","id":"14355471","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dmorel","name":"dmorel","key":"dmorel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Morel","active":true,"timeZone":"Europe/Berlin"},"body":"Passing \"-Djute.maxbuffer=<bytes>\" in the startup scripts environment (in /etc/hadoop/conf/yarn-env.sh or  /etc/default/hadoop-yarn-resourcemanager) to the YARN_RESOURCEMANAGER_OPTS variable does the trick. It's picked up by the RM binary and effective.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dmorel","name":"dmorel","key":"dmorel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Morel","active":true,"timeZone":"Europe/Berlin"},"created":"2015-03-10T18:57:09.789+0000","updated":"2015-03-10T18:57:09.789+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14355748","id":"14355748","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12658387/YARN-2368.patch\n  against trunk revision aa92b76.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:red}-1 findbugs{color}.  The patch appears to introduce 5 new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager:\n\n                  org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.TestContainerAllocation\n\nTest results: https://builds.apache.org/job/PreCommit-YARN-Build/6904//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-YARN-Build/6904//artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-server-resourcemanager.html\nConsole output: https://builds.apache.org/job/PreCommit-YARN-Build/6904//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-10T21:19:25.182+0000","updated":"2015-03-10T21:19:25.182+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14380135","id":"14380135","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kasha","name":"kasha","key":"kasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karthik Kambatla","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for reporting this, [~guoleitao]. The jutebuffer size depends on the number of applications users want to store in the state-store. I believe YARN-2962 is a better fix. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kasha","name":"kasha","key":"kasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karthik Kambatla","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-25T16:10:24.087+0000","updated":"2015-03-25T16:10:24.087+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730448/comment/14530819","id":"14530819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xgong","name":"xgong","key":"xgong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Xuan Gong","active":true,"timeZone":"America/Los_Angeles"},"body":"It is duplicate as YARN-2962. Close this as duplicate and we can discuss the issue there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xgong","name":"xgong","key":"xgong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Xuan Gong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-06T16:28:20.995+0000","updated":"2015-05-06T16:28:20.995+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-2368/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1yajb:"}}