{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13116615","self":"https://issues.apache.org/jira/rest/api/2/issue/13116615","key":"YARN-7453","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334216","id":"12334216","description":"2.9.0 release","name":"2.9.0","archived":false,"released":true,"releaseDate":"2017-11-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341435","id":"12341435","description":"3.0.0 GA release","name":"3.0.0","archived":false,"released":true,"releaseDate":"2017-12-13"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341436","id":"12341436","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2017-11-07T17:34:52.959+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 09 19:38:29 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_91869928_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_17637144","customfield_12312321":null,"resolutiondate":"2017-11-08T16:11:35.900+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-7453/watchers","watchCount":9,"isWatching":false},"created":"2017-11-07T09:46:28.885+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334216","id":"12334216","description":"2.9.0 release","name":"2.9.0","archived":false,"released":true,"releaseDate":"2017-11-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341436","id":"12341436","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-11-09T19:38:29.165+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319322","id":"12319322","name":"resourcemanager"}],"timeoriginalestimate":null,"description":"It is observed that RM fail to switch to ACTIVE after first successful start! The below exception throws when RM is switching from ACTIVE->STANDBY->ACTIVE. This continues in loop!\r\n{noformat}\r\n2017-11-07 15:08:11,664 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceManager: Transitioning to active state\r\n2017-11-07 15:08:11,669 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceManager: Recovery started\r\n2017-11-07 15:08:11,669 INFO org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore: Loaded RM state version info 1.5\r\n2017-11-07 15:08:11,670 ERROR org.apache.hadoop.yarn.server.resourcemanager.ResourceManager: Failed to load/recover state\r\norg.apache.zookeeper.KeeperException$NoAuthException: KeeperErrorCode = NoAuth\r\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:113)\r\n\tat org.apache.zookeeper.ZooKeeper.multiInternal(ZooKeeper.java:1006)\r\n\tat org.apache.zookeeper.ZooKeeper.multi(ZooKeeper.java:910)\r\n\tat org.apache.curator.framework.imps.CuratorTransactionImpl.doOperation(CuratorTransactionImpl.java:159)\r\n\tat org.apache.curator.framework.imps.CuratorTransactionImpl.access$200(CuratorTransactionImpl.java:44)\r\n\tat org.apache.curator.framework.imps.CuratorTransactionImpl$2.call(CuratorTransactionImpl.java:129)\r\n\tat org.apache.curator.framework.imps.CuratorTransactionImpl$2.call(CuratorTransactionImpl.java:125)\r\n\tat org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:109)\r\n\tat org.apache.curator.framework.imps.CuratorTransactionImpl.commit(CuratorTransactionImpl.java:122)\r\n\tat org.apache.hadoop.util.curator.ZKCuratorManager$SafeTransaction.commit(ZKCuratorManager.java:403)\r\n\tat org.apache.hadoop.util.curator.ZKCuratorManager.safeSetData(ZKCuratorManager.java:372)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.getAndIncrementEpoch(ZKRMStateStore.java:493)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$RMActiveServices.serviceStart(ResourceManager.java:771)\r\n\tat org.apache.hadoop.service.AbstractService.start(AbstractService.java:194)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.startActiveServices(ResourceManager.java:1162)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$1.run(ResourceManager.java:1202)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$1.run(ResourceManager.java:1198)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\r\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.transitionToActive(ResourceManager.java:1198)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.AdminService.transitionToActive(AdminService.java:320)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.ActiveStandbyElectorBasedElectorService.becomeActive(ActiveStandbyElectorBasedElectorService.java:144)\r\n\tat org.apache.hadoop.ha.ActiveStandbyElector.becomeActive(ActiveStandbyElector.java:894)\r\n\tat org.apache.hadoop.ha.ActiveStandbyElector.processResult(ActiveStandbyElector.java:473)\r\n\tat org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:607)\r\n\tat org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:505)\r\n{noformat}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334216","id":"12334216","description":"2.9.0 release","name":"2.9.0","archived":false,"released":true,"releaseDate":"2017-11-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341436","id":"12341436","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12896637","id":"12896637","filename":"YARN-7453.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-11-08T12:01:16.572+0000","size":4862,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12896637/YARN-7453.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12896632","id":"12896632","filename":"YARN-7453.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-11-08T11:16:38.611+0000","size":10491,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12896632/YARN-7453.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Fix issue where RM fails to switch to active after first successful start","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16241809","id":"16241809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"I suspect YARN-7053 would be the cause of this issue! ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-11-07T10:36:47.674+0000","updated":"2017-11-07T10:36:47.674+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242482","id":"16242482","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"Hmmm.. that is interesting, It looks like YARN-7053 was part of 3.0.0-beta1 as well. Don't think anything has changed after that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T17:34:52.959+0000","updated":"2017-11-07T18:07:54.606+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242579","id":"16242579","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"I tried to debug this issue, but couldn't get any root cause. I used even tests TestZKRMStateStore#testZKRootPathAcls with minor modifications pointing to running ZooKeeper, couldn't reproduce in test. The same error is getting trunk. I believe this issue must exist in 3.0-beta as well.\r\nThe recent JIRAs committed wrt state store ACLs are HADOOP-14741 YARN-7053 and YARN-6840. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-11-07T18:25:40.875+0000","updated":"2017-11-07T18:25:40.875+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242591","id":"16242591","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhung","name":"jhung","key":"jhung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Hung","active":true,"timeZone":"America/Los_Angeles"},"body":"Hmm, YARN-6840 shouldn't affect it, especially if you are not setting {{yarn.scheduler.configuration.store.class}} to {{zk}}, but there was some minor refactoring there, I'll see if I can repro this...\r\n\r\nEDIT: I tried starting to active multiple times (manual failover) and didn't get any errors here. [~rohithsharma] was this consistently reproducible?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhung","name":"jhung","key":"jhung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Hung","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T18:34:45.348+0000","updated":"2017-11-07T19:02:31.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242657","id":"16242657","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"[~jhung], thanks for testing..\r\nWere you testing this on trunk or the 2.9.0 RC ? Also, can you maybe share the conf ?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T19:06:57.826+0000","updated":"2017-11-07T19:06:57.826+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242693","id":"16242693","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhung","name":"jhung","key":"jhung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Hung","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~asuresh], actually, I built this from source (bb6a1aa5fac18941ecd15502e0dec23997f81e44).\r\n\r\nHere are the relevant confs: {noformat}\r\n  <property>\r\n    <name>yarn.resourcemanager.hostname.rm1</name>\r\n    <value>host1.com</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.hostname.rm2</name>\r\n    <value>host2.com</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.ha.enabled</name>\r\n    <value>true</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.ha.rm-ids</name>\r\n    <value>rm1,rm2</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.recovery.enabled</name>\r\n    <value>true</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.store.class</name>\r\n    <value>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.zk.address</name>\r\n    <value>host1.com:2191</value>\r\n  </property>\r\n  <property>\r\n    <name>hadoop.zk.address</name>\r\n    <value>host1.com:2191</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.ha.id</name>\r\n    <value>rm1</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.ha.automatic-failover.enabled</name>\r\n    <value>false</value>\r\n  </property>\r\n  <property>\r\n    <name>yarn.resourcemanager.cluster-id</name>\r\n    <value>test</value>\r\n  </property>\r\n{noformat}\r\n({{yarn.resourcemanager.ha.id}}=rm2 for the other RM).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhung","name":"jhung","key":"jhung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Hung","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T19:21:04.016+0000","updated":"2017-11-07T19:21:04.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242723","id":"16242723","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"Looks like that is the last commit on *branch-2.9*. Everything else on *branch-2.9.0* is documentation.\r\n\r\n{code}\r\ncommit bb6a1aa5fac18941ecd15502e0dec23997f81e44\r\nAuthor: Arun Suresh <asuresh@apache.org>\r\nDate:   Thu Nov 2 22:49:38 2017 -0700\r\n\r\n    Preparing for 2.9.1 development\r\n{code}\r\n\r\nIf you don't mind and if you have your test setup ready, can you maybe try using bits from the\r\n[RC|http://home.apache.org/~asuresh/hadoop-2.9.0-RC0/]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T19:32:08.311+0000","updated":"2017-11-07T19:33:01.428+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242782","id":"16242782","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhung","name":"jhung","key":"jhung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Hung","active":true,"timeZone":"America/Los_Angeles"},"body":"Sure, thanks, switched to the RC, but still wasn't able to reproduce it.\r\n\r\nRelevant logs: {noformat}17/11/07 19:50:26 INFO resourcemanager.ResourceManager: Recovery started\r\n17/11/07 19:50:26 INFO recovery.RMStateStore: Loaded RM state version info 1.5\r\n17/11/07 19:50:26 INFO security.RMDelegationTokenSecretManager: recovering RMDelegationTokenSecretManager.\r\n17/11/07 19:50:26 INFO resourcemanager.RMAppManager: Recovering 0 applications\r\n17/11/07 19:50:26 INFO resourcemanager.RMAppManager: Successfully recovered 0 out of 0 applications\r\n17/11/07 19:50:26 INFO resourcemanager.ResourceManager: Recovery ended\r\n...\r\n17/11/07 19:50:26 INFO resourcemanager.RMAuditLogger: USER=jhung\tIP=host1.com\tOPERATION=transitionToActive\tTARGET=RM\tRESULT=SUCCESS\r\n...\r\n17/11/07 19:50:43 INFO resourcemanager.RMAuditLogger: USER=jhung\tIP=host1.com\tOPERATION=transitionToStandby\tTARGET=RM\tRESULT=SUCCESS\r\n...\r\n17/11/07 19:56:43 INFO recovery.RMStateStore: Loaded RM state version info 1.5\r\n17/11/07 19:56:43 INFO security.RMDelegationTokenSecretManager: recovering RMDelegationTokenSecretManager.\r\n17/11/07 19:56:43 INFO resourcemanager.RMAppManager: Recovering 0 applications\r\n17/11/07 19:56:43 INFO resourcemanager.RMAppManager: Successfully recovered 0 out of 0 applications\r\n17/11/07 19:56:43 INFO resourcemanager.ResourceManager: Recovery ended\r\n...\r\n17/11/07 19:56:43 INFO resourcemanager.ResourceManager: Transitioned to active state\r\n17/11/07 19:56:43 INFO resourcemanager.RMAuditLogger: USER=jhung\tIP=host1.com\tOPERATION=transitionToActive\tTARGET=RM\tRESULT=SUCCESS\r\n{noformat}\r\n\r\nThis was after issuing:{noformat}yarn rmadmin -transitionToActive rm1\r\nyarn rmadmin -transitionToStandby rm1\r\nyarn rmadmin -transitionToActive rm1\r\n{noformat}\r\n\r\nI also turned on automatic failover, and didn't get any exceptions there either.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhung","name":"jhung","key":"jhung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Hung","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T20:03:54.475+0000","updated":"2017-11-07T20:03:54.475+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242786","id":"16242786","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~jhung] !!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T20:06:46.371+0000","updated":"2017-11-07T20:06:46.371+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242805","id":"16242805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=elgoiri","name":"elgoiri","key":"elgoiri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Íñigo Goiri","active":true,"timeZone":"Etc/UTC"},"body":"From the vote for 3.0.0-beta1 RC0, I can see [~rohithsharma] tested HA.\r\n[Link to the archive|http://mail-archives.apache.org/mod_mbox/hadoop-hdfs-dev/201710.mbox/ajax/%3CCAGi%3DjZDPP%2BUwamnPQz89t4xy2bnPbvDUtYRRWG6sN3Dnojf05w%40mail.gmail.com%3E]:\r\n{code}\r\nBuilt from source and deployed YARN HA cluster with ATSv2 enabled in non-secured cluster.\r\n- tested for RM HA/work-preservring-restart/ NM-work-preserving restart for ATSv2 entities.\r\n- verified all ATSv2 REST end points to retrieve the entities\r\n- ran sample MR jobs and distributed jobs\r\n{code}\r\n\r\nIf I'm not wrong, YARN-7053 and HADOOP-14741 were already in 3.0.0-beta1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=elgoiri","name":"elgoiri","key":"elgoiri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Íñigo Goiri","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-07T20:18:59.853+0000","updated":"2017-11-07T20:18:59.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16242855","id":"16242855","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"Verified it myself on a fresh cluster running 2.9.0 RC.\r\n\r\nManual mode:\r\n{code}\r\n2017-11-07 15:39:14,420 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceManager: Transitioned to active state\r\n2017-11-07 15:39:14,420 INFO org.apache.hadoop.yarn.server.resourcemanager.RMAuditLogger: USER=hadoop   IP=10.200.91.22 OPERATION=transitionToActive    TARGET=RM       RESULT=SUCCESS\r\n....\r\n2017-11-07 15:40:02,791 INFO org.apache.hadoop.yarn.server.resourcemanager.RMAuditLogger: USER=hadoop   IP=10.200.91.22 OPERATION=transitionToStandby   TARGET=RM       RESULT=SUCCESS\r\n2017-11-07 15:41:08,378 INFO org.apache.hadoop.conf.Configuration: found resource yarn-site.xml at file:/home/hadoop/cisl-linux-021/conf/yarn-site.xml\r\n....\r\n2017-11-07 15:41:08,624 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceManager: Transitioned to active state\r\n2017-11-07 15:41:08,624 INFO org.apache.hadoop.yarn.server.resourcemanager.RMAuditLogger: USER=hadoop   IP=10.200.91.22 OPERATION=transitionToActive    TARGET=RM       RESULT=SUCCESS\r\n{code}\r\n\r\nCommands:\r\n{code}\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -transitionToStandby rm1\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                standby\r\ncisl-linux-024:8033                                standby\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -transitionToActive rm2\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                standby\r\ncisl-linux-024:8033                                active\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -transitionToStandby rm2\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                standby\r\ncisl-linux-024:8033                                standby\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -transitionToActive rm1\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                active\r\ncisl-linux-024:8033                                standby\r\n{code}\r\n\r\nAutomatic mode:\r\n{code}\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                active\r\ncisl-linux-024:8033                                standby\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                active\r\ncisl-linux-024:8033                                standby\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn-daemon.sh stop resourcemanager\r\nstopping resourcemanager\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\n17/11/07 15:49:33 INFO ipc.Client: Retrying connect to server: cisl-linux-021/10.200.91.22:8033. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=1, sleepTime=1000 MILLISECONDS)\r\ncisl-linux-021:8033                                Failed to connect: Call From cisl-linux-021/10.200.91.22 to cisl-linux-021:8033 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused\r\ncisl-linux-024:8033                                active\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn-daemon.sh start resourcemanager\r\nstarting resourcemanager, logging to /home/hadoop/cisl-linux-021/yarn-log/yarn-hadoop-resourcemanager-cisl-linux-021.out\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                standby\r\ncisl-linux-024:8033                                active\r\n...\r\n[Went to other RM and killed it]\r\n...\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                active\r\n17/11/07 15:50:28 INFO ipc.Client: Retrying connect to server: cisl-linux-024/10.200.91.25:8033. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=1, sleepTime=1000 MILLISECONDS)\r\ncisl-linux-024:8033                                Failed to connect: Call From cisl-linux-021/10.200.91.22 to cisl-linux-024:8033 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused\r\n...\r\n[Restarted the other RM]\r\n...\r\n[hadoop@cisl-linux-021 cisl-linux-021]$ yarn rmadmin -getAllServiceState\r\ncisl-linux-021:8033                                active\r\ncisl-linux-024:8033                                standby\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-07T20:52:16.137+0000","updated":"2017-11-07T20:52:16.137+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16243751","id":"16243751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Reverted YARN-6840's ResourceManager and ZKRMStateStore changes. This solves the issue for now. Detailed analysis will be shared a bit later","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-11-08T11:17:15.604+0000","updated":"2017-11-08T11:17:15.604+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16243792","id":"16243792","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"Previous patch contains a little bit additional modifications, attached required only changes patch!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-11-08T12:02:50.617+0000","updated":"2017-11-08T12:02:50.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16243862","id":"16243862","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  9s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 16m 43s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 27s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m 49s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 14s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 24s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 44s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 25s{color} | {color:orange} hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager: The patch generated 21 new + 37 unchanged - 0 fixed = 58 total (was 37) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 40s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 10s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 12s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 23s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 56m 28s{color} | {color:green} hadoop-yarn-server-resourcemanager in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 23s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}102m 52s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |\r\n| JIRA Issue | YARN-7453 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12896632/YARN-7453.001.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux f015a5df495e 3.13.0-129-generic #178-Ubuntu SMP Fri Aug 11 12:48:20 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / e4c220e |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_131 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-YARN-Build/18399/artifact/out/diff-checkstyle-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18399/testReport/ |\r\n| Max. process+thread count | 866 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18399/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-08T13:05:05.749+0000","updated":"2017-11-08T13:05:05.749+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16243986","id":"16243986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 10s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 20m 17s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 52s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 34s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 54s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 59s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 25s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 31s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 51s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 46s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 46s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 30s{color} | {color:orange} hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager: The patch generated 1 new + 37 unchanged - 0 fixed = 38 total (was 37) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 48s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 58s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 34s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 29s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 60m 56s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 28s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}114m 40s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestIncreaseAllocationExpirer |\r\n|   | hadoop.yarn.server.resourcemanager.TestOpportunisticContainerAllocatorAMService |\r\n|   | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestContainerResizing |\r\n| Timed out junit tests | org.apache.hadoop.yarn.server.resourcemanager.TestRMStoreCommands |\r\n|   | org.apache.hadoop.yarn.server.resourcemanager.recovery.TestZKRMStateStore |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |\r\n| JIRA Issue | YARN-7453 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12896637/YARN-7453.001.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux aa45fb2f4809 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / e4c220e |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_131 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-YARN-Build/18401/artifact/out/diff-checkstyle-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\r\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/18401/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18401/testReport/ |\r\n| Max. process+thread count | 794 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18401/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-08T14:06:49.770+0000","updated":"2017-11-08T14:06:49.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16244205","id":"16244205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 for the patch.\r\nI ran the failed and timeout tests locally - it works for me. They just seem to be flaky\r\n\r\nCommitting this shortly (will take care of checkstyle when I commit)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-08T15:56:36.008+0000","updated":"2017-11-08T15:56:36.008+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16244234","id":"16244234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed this to trunk, branch-3.0. branch-2, branch-2.9 and branch-2.9.0\r\nThanks for the quick turnaround [~rohithsharma] and for the testing/investigation [~jhung], [~goiri], [~subru] and [~leftnoteasy]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=asuresh","name":"asuresh","key":"asuresh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun Suresh","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-08T16:11:35.933+0000","updated":"2017-11-08T16:11:35.933+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16244251","id":"16244251","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #13203 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/13203/])\nYARN-7453. Fix issue where RM fails to switch to active after first (arun suresh: rev a9c70b0e84dab0c41e480a0dc0cb1a22efdc64ee)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/recovery/ZKRMStateStore.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/capacity/conf/ZKConfigurationStore.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-08T16:22:52.694+0000","updated":"2017-11-08T16:22:52.694+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16245154","id":"16245154","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"Thanks [~asuresh] for committing the patch. I thank all of you for helping investigating the issue and verifying the patch. Special thanks to [~jianhe] [~sunilg] for helping isolating the problem, quick build verifications and for initial patch Sunil provided to me offline!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-11-09T03:26:34.281+0000","updated":"2017-11-09T03:26:34.281+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116615/comment/16246371","id":"16246371","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=subru","name":"subru","key":"subru","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=subru&avatarId=21709","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=subru&avatarId=21709","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=subru&avatarId=21709","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=subru&avatarId=21709"},"displayName":"Subru Krishnan","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~rohithsharma], [~jhung], [~asuresh],  [~leftnoteasy], [~elgoiri], [~sunilg], [~jianhe] for pulling together and resolving this fast, great teamwork!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=subru","name":"subru","key":"subru","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=subru&avatarId=21709","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=subru&avatarId=21709","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=subru&avatarId=21709","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=subru&avatarId=21709"},"displayName":"Subru Krishnan","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-09T19:38:29.165+0000","updated":"2017-11-09T19:38:29.165+0000"}],"maxResults":20,"total":20,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-7453/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3mhbz:"}}