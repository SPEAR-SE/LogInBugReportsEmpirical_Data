{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12919652","self":"https://issues.apache.org/jira/rest/api/2/issue/12919652","key":"YARN-4427","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-12-07T11:15:22.849+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 09 09:53:04 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-4427/watchers","watchCount":8,"isWatching":false},"created":"2015-12-07T10:52:30.042+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-12-09T09:53:04.230+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":" *Seen the following in one of our environment when AM got allocated container but failed to updated in the ZK Where cluster is having network problem for sometime(up and down).* \n\n{noformat}\n2015-12-07 16:39:38,489 | WARN  | IPC Server handler 49 on 26003 | IPC Server handler 49 on 26003, call org.apache.hadoop.yarn.server.api.ResourceTrackerPB.registerNodeManager from 9.91.8.220:52169 Call#17 Retry#0 | Server.java:2107\njava.lang.NullPointerException\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService.handleNMContainerStatus(ResourceTrackerService.java:286)\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService.registerNodeManager(ResourceTrackerService.java:395)\n        at org.apache.hadoop.yarn.server.api.impl.pb.service.ResourceTrackerPBServiceImpl.registerNodeManager(ResourceTrackerPBServiceImpl.java:54)\n        at org.apache.hadoop.yarn.proto.ResourceTracker$ResourceTrackerService$2.callBlockingMethod(ResourceTracker.java:79)\n        at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)\n        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:973)\n        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2088)\n        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2084)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:422)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1673)\n        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2082)\n{noformat}\n\nCorresponding code, it might not match with {{branch-2.7/Trunk}} since we had modified internally.\n{code}\n 284\tRMAppAttempt rmAppAttempt = rmApp.getRMAppAttempt(appAttemptId);\n 285\tContainer masterContainer = rmAppAttempt.getMasterContainer();\n 286\tif (masterContainer.getId().equals(containerStatus.getContainerId())\n 287       && containerStatus.getContainerState() == ContainerState.COMPLETE) {\n 288     ContainerStatus status =\n 289         ContainerStatus.newInstance(containerStatus.getContainerId(),\n 290           containerStatus.getContainerState(), containerStatus.getDiagnostics(),\n 291           containerStatus.getContainerExitStatus());\n 292     // sending master container finished event.\n 293     RMAppAttemptContainerFinishedEvent evt =\n 294         new RMAppAttemptContainerFinishedEvent(appAttemptId, status,\n 295             nodeId);\n 296     rmContext.getDispatcher().getEventHandler().handle(evt);\n 297   }\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"NPE on handleNMContainerStatus when NM is registering to RM","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12919652/comment/15044751","id":"15044751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"Marking as critical since {{Nodemanger}} will not be able register to RM. \n *Trace In NM* \n{noformat}\n2015-12-05 16:17:29,384 | ERROR | Thread-6943 | Unexpected error rebooting NodeStatusUpdater | NodeStatusUpdaterImpl.java:276\njava.lang.NullPointerException: java.lang.NullPointerException\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService.handleNMContainerStatus(ResourceTrackerService.java:286)\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService.registerNodeManager(ResourceTrackerService.java:395)\n        at org.apache.hadoop.yarn.server.api.impl.pb.service.ResourceTrackerPBServiceImpl.registerNodeManager(ResourceTrackerPBServiceImpl.java:54)\n        at org.apache.hadoop.yarn.proto.ResourceTracker$ResourceTrackerService$2.callBlockingMethod(ResourceTracker.java:79)\n        at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)\n        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:973)\n        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2088)\n        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2084)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:422)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1673)\n        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2082)\n        \n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) \n        at java.lang.reflect.Constructor.newInstance(Constructor.java:422)\n        at org.apache.hadoop.yarn.ipc.RPCUtil.instantiateException(RPCUtil.java:53)\n        at org.apache.hadoop.yarn.ipc.RPCUtil.instantiateRuntimeException(RPCUtil.java:85)\n        at org.apache.hadoop.yarn.ipc.RPCUtil.unwrapAndThrowException(RPCUtil.java:122)\n        at org.apache.hadoop.yarn.server.api.impl.pb.client.ResourceTrackerPBClientImpl.registerNodeManager(ResourceTrackerPBClientImpl.java:70)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:497)     \n        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:191)\n        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)\n        at com.sun.proxy.$Proxy78.registerNodeManager(Unknown Source)\n        at org.apache.hadoop.yarn.server.nodemanager.NodeStatusUpdaterImpl.registerWithRM(NodeStatusUpdaterImpl.java:313)\n{noformat}\n\nAdding {{masterContainer != null}} ResourceTrackerService#handleNMContainerStatus, should be fine I think.. anythoughts on this..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-07T10:58:31.647+0000","updated":"2015-12-07T10:58:31.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12919652/comment/15044775","id":"15044775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"IIUC, {{masterContainer}} never be null since NM is reporting the containers status which means RM has containers status. Can you share the logs? And can you give more details about the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2015-12-07T11:15:22.849+0000","updated":"2015-12-07T11:15:22.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12919652/comment/15044871","id":"15044871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gu+chi","name":"gu chi","key":"gu chi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"gu-chi","active":true,"timeZone":"Etc/UTC"},"body":"NM recovery is enabled, this is the precondition","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gu+chi","name":"gu chi","key":"gu chi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"gu-chi","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-07T13:00:01.073+0000","updated":"2015-12-07T13:00:01.073+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12919652/comment/15046804","id":"15046804","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~rohithsharma] thanks a for taking a look into this issue..Yes, {{masterContainer}} is null,even I thought {{rmAppAttempt}} can be null,but it is not in this cluster.\n\n{code}  \n    RMAppAttempt rmAppAttempt = rmApp.getRMAppAttempt(appAttemptId);\n    Container masterContainer = rmAppAttempt.getMasterContainer();\n    if ((masterContainer.getId().equals(containerStatus.getContainerId())) && (containerStatus.getContainerState() == ContainerState.COMPLETE))\n{code} \n\n *Cause :*  As I mentioned in the description,ZK Cluster was up and down which makes frequent leader election..Thinking RM written znode with ZK1 and while recovering reading from ZK2 where data is not synced(Here master container details missed). \n\n Please correct me if I am wrong..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-08T12:24:28.269+0000","updated":"2015-12-08T12:24:28.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12919652/comment/15047139","id":"15047139","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~brahma] for the details.\nDuring recovery of AppAttempt, {{masterContainer}} can be null only if the AttemptState doesn't have and its very unlikely. if ZK was unstable, do you mean a partial recovery has happened here for AppAttempt where {{masterContainer}} is null?\nCould you also pls share the final state of that attempt during recovery.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-08T17:47:50.561+0000","updated":"2015-12-08T17:47:50.561+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12919652/comment/15048397","id":"15048397","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~sunilg] Thanks for taking a look into this issue.. final state was null.. \n\n *Resource Manger Log:* \n{noformat}\n2015-12-05 15:22:00,780 | INFO  | main-EventThread | Recovering app: application_1449190041506_0175 with 0 attempts and final state = null | RMAppImpl.java:790\n2015-12-05 15:26:12,433 | INFO  | main-EventThread | Recovering app: application_1449190041506_0175 with 0 attempts and final state = null | RMAppImpl.java:790\n2015-12-05 15:32:46,810 | INFO  | main-EventThread | Recovering app: application_1449190041506_0175 with 0 attempts and final state = null | RMAppImpl.java:790\n2015-12-05 15:45:33,199 | INFO  | main-EventThread | Recovering app: application_1449190041506_0175 with 0 attempts and final state = null | RMAppImpl.java:790\n2015-12-05 16:11:41,556 | INFO  | main-EventThread | Recovering app: application_1449190041506_0175 with 0 attempts and final state = null | RMAppImpl.java:790\n2015-12-05 16:14:28,228 | INFO  | AsyncDispatcher event handler | Storing attempt: AppId: application_1449190041506_0175 AttemptId: appattempt_1449190041506_0175_000001 MasterContainer: Container: [ContainerId: container_1449190041506_0175_01_000001, NodeId: 9-91-8-220:26009, NodeHttpAddress: 9-91-8-220:26010, Resource: <memory:1536, vCores:1>, Priority: 0, Token: Token { kind: ContainerToken, service: **.**.**.220:26009 }, ] | RMAppAttemptImpl.java:1959\n2015-12-05 16:17:26,811 | INFO  | main-EventThread | Recovering app: application_1449190041506_0175 with 0 attempts and final state = null | RMAppImpl.java:790\n{noformat}\n\n *ZNode Creation:* \n\n{noformat}\n2015-12-05 16:14:28,241 | INFO  | CommitProcWorkThread-38 | session=0x130006c883cb000d\tip=**.**.**.217\toperation=create znode\ttarget=ZooKeeperServer\tznode=/rmstore/ZKRMStateRoot/RMAppRoot/application_1449190041506_0175/appattempt_1449190041506_0175_000001\tresult=success | org.apache.zookeeper.ZKAuditLogger$LogLevel$5.printLog(ZKAuditLogger.java:70)\n{noformat}\n\n *RM Frequent connections to different ZK:* \n\n{noformat}\n2015-12-05 16:15:46,240 | INFO  | main-SendThread(9-91-8-217:24002) | Socket connection established, initiating session, client: /**.**.**.217:53843, server: host-217/**.**.**.217:24002 | ClientCnxn.java:1021\n2015-12-05 16:15:46,810 | INFO  | main-SendThread(host-208:24002) | Socket connection established, initiating session, client: /**.**.**.217:46137, server: host-208/**.**.**.208:24002 | ClientCnxn.java:1021\n2015-12-05 16:15:47,021 | INFO  | main-SendThread(host-220:24002) | Socket connection established, initiating session, client: /**.**.**.217:39488, server: host-220/**.**.**.220:24002 | ClientCnxn.java:1021\n2015-12-05 16:15:47,265 | INFO  | main-SendThread(host-220:24002) | Socket connection established, initiating session, client: /**.**.**.217:39491, server: host-220/**.**.**.220:24002 | ClientCnxn.java:1021\n2015-12-05 16:15:55,632 | INFO  | main-SendThread(host-218:24002) | Socket connection established, initiating session, client: /**.**.**.217:56809, server: host-218/**.**.**.218:24002 | ClientCnxn.java:1021\n2015-12-05 16:16:33,619 | INFO  | main-SendThread(host-219:24002) | Socket connection established, initiating session, client: /**.**.**.217:48605, server: host-219/**.**.**.219:24002 | ClientCnxn.java:1021\n2015-12-05 16:17:18,369 | INFO  | main-SendThread(host-220:24002) | Socket connection established, initiating session, client: /**.**.**.217:40376, server: host-220/**.**.**.220:24002 | ClientCnxn.java:1021\n{noformat}\n\n *NPE In the RM:* \n\n{noformat}\n2015-12-05 16:17:29,385 | WARN  | IPC Server handler 1 on 26003 | IPC Server handler 1 on 26003, call org.apache.hadoop.yarn.server.api.ResourceTrackerPB.registerNodeManager from **.**.**.220:49704 Call#4003 Retry#0 | Server.java:2107\njava.lang.NullPointerException\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService.handleNMContainerStatus(ResourceTrackerService.java:286)\n\tat org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService.registerNodeManager(ResourceTrackerService.java:395)\n\tat org.apache.hadoop.yarn.server.api.impl.pb.service.ResourceTrackerPBServiceImpl.registerNodeManager(ResourceTrackerPBServiceImpl.java:54)\n\tat org.apache.hadoop.yarn.proto.ResourceTracker$ResourceTrackerService$2.callBlockingMethod(ResourceTracker.java:79)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)\n\tat org.apache.hadoop.ipc.RPC$Server.call(RPC.java:973)\n\tat org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2088)\n\tat org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2084)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1673)\n\tat org.apache.hadoop.ipc.Server$Handler.run(Server.java:2082)\n{noformat}\n\n *Actual problem is in ZK since data is not persisted in the cluster, for same I will check ZK..what my point is, how to handle when this occurs from RM side..?  adding null check will not solve this since container details will not be deleted from the NM.* \n\n *Reproduce Scenario :* \nJust remove the appatempt from ZK and restart the cluster when application is running (ensure work preserving is disabled.)\nrmr /rmstore/ZKRMStateRoot/RMAppRoot/application_1449644945944_0001/appattempt_1449644945944_0001_000001","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-09T09:53:04.230+0000","updated":"2015-12-09T09:53:04.230+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-4427/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2pizr:"}}