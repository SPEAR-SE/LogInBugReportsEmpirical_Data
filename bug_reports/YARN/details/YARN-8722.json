{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13181508","self":"https://issues.apache.org/jira/rest/api/2/issue/13181508","key":"YARN-8722","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/10004","id":"10004","description":"Not A Bug","name":"Not A Bug"},"customfield_12312322":null,"customfield_12310220":"2018-08-28T15:51:03.024+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 29 02:19:12 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_233327982_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2018-08-30T22:40:22.585+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-8722/watchers","watchCount":4,"isWatching":false},"created":"2018-08-28T05:51:34.620+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-30T22:40:22.598+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12331058","id":"12331058","name":"yarn-native-services"}],"timeoriginalestimate":null,"description":"Can't get job status with the following command, after a submarine job is submitted.\r\nbin/yarn app -status standlone-tf (service name)\r\n\r\nThe environment context is as follows:\r\n1) Security enabled.\r\nkerberos\r\n\r\n2) Klist output\r\n Ticket cache: FILE:/tmp/krb5cc_1010\r\n Default principal: hadoop/admin@HADOOP.****.COM\r\n\r\nValid starting Expires Service principal\r\n 08/28/2018 10:50:07 08/28/2018 20:50:07 krbtgt/HADOOP.****.COM@HADOOP.****.COM\r\n renew until 08/29/2018 10:50:07\r\n\r\n3) Service spec json.\r\n standlone-tf.json in the attachment\r\n\r\n4) service HDFS path permission. \r\n drwxr-x--- - hadoop hdfs 0 2018-08-27 15:54 hdfs://submarine/user/hadoop/.yarn/services/standlone-tf\r\n\r\ndrwxr-x--- - hadoop hdfs 0 2018-08-27 15:54 hdfs://submarine/user/hadoop/.yarn/services/standlone-tf/lib\r\n -rw-rw-rw- 2 hadoop hdfs 2228 2018-08-27 15:54 hdfs://submarine/user/hadoop/.yarn/services/standlone-tf/standlone-tf.json\r\n\r\n5) Stacktrace.\r\n stack.txt in the attachment\r\n\r\n6) yarn app -status -> error.\r\n bin/yarn app -status standlone-tf (service name)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12937384","id":"12937384","filename":"stack.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuan_zac","name":"yuan_zac","key":"yuan_zac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zac Zhou","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-28T05:52:13.980+0000","size":9627,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12937384/stack.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12937385","id":"12937385","filename":"standlone-tf.json","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuan_zac","name":"yuan_zac","key":"yuan_zac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zac Zhou","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-28T05:52:13.964+0000","size":2228,"mimeType":"application/json","content":"https://issues.apache.org/jira/secure/attachment/12937385/standlone-tf.json"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Failed to get native service application status when security is enabled ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuan_zac","name":"yuan_zac","key":"yuan_zac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zac Zhou","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuan_zac","name":"yuan_zac","key":"yuan_zac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zac Zhou","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13181508/comment/16595185","id":"16595185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftnoteasy","name":"leftnoteasy","key":"leftnoteasy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=leftnoteasy&avatarId=18647","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=leftnoteasy&avatarId=18647","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=leftnoteasy&avatarId=18647","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=leftnoteasy&avatarId=18647"},"displayName":"Wangda Tan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~eyang], [~billie.rinaldi], have we seen this issue when trying to get app status in a kerberoized cluster?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftnoteasy","name":"leftnoteasy","key":"leftnoteasy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=leftnoteasy&avatarId=18647","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=leftnoteasy&avatarId=18647","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=leftnoteasy&avatarId=18647","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=leftnoteasy&avatarId=18647"},"displayName":"Wangda Tan","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-08-28T15:51:03.024+0000","updated":"2018-08-28T15:51:03.024+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13181508/comment/16595310","id":"16595310","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"body":"This looks like a misconfiguration on the tested cluster.  YARN user is not allowed to impersonate hadoop user to access HDFS.  YARN user must have proxy user ACL setup to impersonate end user in order to access the home directory of the end user in HDFS.  Please check core-site.xml, and make sure that user have the following defined:\r\n{code:java}\r\n    <property>\r\n      <name>hadoop.proxyuser.yarn.groups</name>\r\n      <value>users</value>\r\n    </property>\r\n\r\n    <property>\r\n      <name>hadoop.proxyuser.yarn.hosts</name>\r\n      <value>rm1.example.com,rm2.example.com</value>\r\n    </property>{code}\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-08-28T17:08:21.412+0000","updated":"2018-08-28T17:08:21.412+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13181508/comment/16595340","id":"16595340","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftnoteasy","name":"leftnoteasy","key":"leftnoteasy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=leftnoteasy&avatarId=18647","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=leftnoteasy&avatarId=18647","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=leftnoteasy&avatarId=18647","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=leftnoteasy&avatarId=18647"},"displayName":"Wangda Tan","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~eyang], \r\n\r\n[~yuan_zac], are you able to *submit* job without enabling proxy? I guess you cannot submit job as well.\r\n\r\n[~eyang], in some environment setups, admin doesn't want to add yarn to proxy user. In existing native service implementation, what is the dependency of API Server to end user's home directory? If it is only for service spec, can we store such specs to yarn's own directory?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftnoteasy","name":"leftnoteasy","key":"leftnoteasy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=leftnoteasy&avatarId=18647","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=leftnoteasy&avatarId=18647","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=leftnoteasy&avatarId=18647","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=leftnoteasy&avatarId=18647"},"displayName":"Wangda Tan","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-08-28T17:31:01.369+0000","updated":"2018-08-28T17:31:01.369+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13181508/comment/16595440","id":"16595440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"body":"YARN implementation is built as a thick client and thick server.  The thick client can run in the server as well.  Without security ACL, it becomes possible to reverse engineer thick client and send network packets to fool server to perform operations.\r\n\r\nIn the current implementation, we can not recommend to run without proxy user setup due to the spec file stored in end user's home directory instead of centralized.  There was proposal to centralize the metadata in YARN-7399.  The centralized meta store must define ACL to represent which user can access which app.  That details needs to be hashed out to remove proxy user ACL dependency that we have today.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-08-28T18:55:24.971+0000","updated":"2018-08-28T18:55:24.971+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13181508/comment/16595840","id":"16595840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuan_zac","name":"yuan_zac","key":"yuan_zac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zac Zhou","active":true,"timeZone":"Etc/UTC"},"body":"[~leftnoteasy]\r\n\r\nYeah， without the proxy settings，we can't submit the job as well.\r\n\r\n[~eyang] \r\n\r\nIn the current implementation, we need to add the proxy settings, right?\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuan_zac","name":"yuan_zac","key":"yuan_zac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zac Zhou","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-29T02:03:03.401+0000","updated":"2018-08-29T02:03:03.401+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13181508/comment/16595853","id":"16595853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~yuan_zac] {quote}In the current implementation, we need to add the proxy settings, right? {quote}\r\n\r\nYes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-08-29T02:19:12.173+0000","updated":"2018-08-29T02:19:12.173+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-8722/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3xhfz:"}}