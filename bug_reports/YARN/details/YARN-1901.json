{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12706548","self":"https://issues.apache.org/jira/rest/api/2/issue/12706548","key":"YARN-1901","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2014-04-04T07:47:44.647+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Apr 04 22:36:52 UTC 2014","customfield_12310420":"384871","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_78203161_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-04-04T22:37:48.705+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-1901/watchers","watchCount":6,"isWatching":false},"created":"2014-04-04T00:54:25.573+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326142","id":"12326142","description":"2.4.0 release","name":"2.4.0","archived":false,"released":true,"releaseDate":"2014-04-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-04-04T22:37:48.730+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319322","id":"12319322","name":"resourcemanager"}],"timeoriginalestimate":null,"description":"I built from trunk, and configured RM Ha, then I submitted a hive job.\n\nthere are total 11 maps, then I stopped active RM when 6 maps finished.\n\nbut Hive shows me all map tasks restat again. This is conflict with the design description.\n\njob progress:\n\n{code}\n2014-03-31 18:44:14,088 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 713.84 sec\n2014-03-31 18:44:15,128 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 722.83 sec\n2014-03-31 18:44:16,160 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 731.95 sec\n 2014-03-31 18:44:17,191 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 744.17 sec\n2014-03-31 18:44:18,220 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 756.22 sec\n2014-03-31 18:44:19,250 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 762.4 sec\n 2014-03-31 18:44:20,281 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 774.64 sec\n2014-03-31 18:44:21,306 Stage-1 map = 70%,  reduce = 0%, Cumulative CPU 786.49 sec\n2014-03-31 18:44:22,334 Stage-1 map = 70%,  reduce = 0%, Cumulative CPU 792.59 sec\n 2014-03-31 18:44:23,363 Stage-1 map = 73%,  reduce = 0%, Cumulative CPU 807.58 sec\n2014-03-31 18:44:24,392 Stage-1 map = 77%,  reduce = 0%, Cumulative CPU 815.96 sec\n2014-03-31 18:44:25,416 Stage-1 map = 80%,  reduce = 0%, Cumulative CPU 823.83 sec\n 2014-03-31 18:44:26,443 Stage-1 map = 80%,  reduce = 0%, Cumulative CPU 826.84 sec\n2014-03-31 18:44:27,472 Stage-1 map = 82%,  reduce = 0%, Cumulative CPU 832.16 sec\n2014-03-31 18:44:28,501 Stage-1 map = 84%,  reduce = 0%, Cumulative CPU 839.73 sec\n 2014-03-31 18:44:29,531 Stage-1 map = 86%,  reduce = 0%, Cumulative CPU 844.45 sec\n2014-03-31 18:44:30,564 Stage-1 map = 82%,  reduce = 0%, Cumulative CPU 760.34 sec\n2014-03-31 18:44:31,728 Stage-1 map = 0%,  reduce = 0%\n 2014-03-31 18:45:06,918 Stage-1 map = 2%,  reduce = 0%, Cumulative CPU 213.81 sec\n2014-03-31 18:45:07,952 Stage-1 map = 2%,  reduce = 0%, Cumulative CPU 216.83 sec\n2014-03-31 18:45:08,979 Stage-1 map = 7%,  reduce = 0%, Cumulative CPU 229.15 sec\n 2014-03-31 18:45:10,007 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 244.42 sec\n2014-03-31 18:45:11,040 Stage-1 map = 14%,  reduce = 0%, Cumulative CPU 247.31 sec\n2014-03-31 18:45:12,072 Stage-1 map = 18%,  reduce = 0%, Cumulative CPU 259.5 sec\n 2014-03-31 18:45:13,105 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 274.72 sec\n2014-03-31 18:45:14,135 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 280.76 sec\n2014-03-31 18:45:15,170 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 292.9 sec\n 2014-03-31 18:45:16,202 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 305.16 sec\n2014-03-31 18:45:17,233 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 314.21 sec\n2014-03-31 18:45:18,264 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 323.34 sec\n 2014-03-31 18:45:19,294 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 335.6 sec\n2014-03-31 18:45:20,325 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 344.71 sec\n2014-03-31 18:45:21,355 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 353.8 sec\n 2014-03-31 18:45:22,385 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 366.06 sec\n2014-03-31 18:45:23,415 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 375.2 sec\n2014-03-31 18:45:24,449 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 384.28 sec\n{code}\n\nI am using hive-0.12.0,  and ZKRMStateRoot as RM store class.  Hive using a simple external table(only one column).\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"385138","customfield_12312823":null,"summary":"All tasks restart during RM failover on Hive","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12706548/comment/13959500","id":"13959500","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"body":"avoiding confusing, my stop RM means 'yarn-daemon.sh stop resourcemanager'","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"created":"2014-04-04T00:56:51.895+0000","updated":"2014-04-04T00:56:51.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12706548/comment/13959726","id":"13959726","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"Thank you for reporting, [~azuryy].  Currently, AM restarts after restarting RM. To address the problem, we have discussion under YARN-556. \n\nThe current hadoop supports: \"RM can be able to continue running existing applications on cluster after the RM has been restarted. \" For more detail, please see the design note on YARN-128.\nhttps://issues.apache.org/jira/secure/attachment/12552867/RMRestartPhase1.pdf","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-04T07:47:44.647+0000","updated":"2014-04-04T07:47:44.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12706548/comment/13959731","id":"13959731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry, I typoed and it may cunfuse you.\n\nThe current hadoop supports: \"RM can be able to continue running existing applications on cluster after the RM has been restarted. Clients should not have to re-submit currently running/submitted apps.\"\n\nAnd work-preserving restart is under development on YARN-556. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-04T07:49:48.865+0000","updated":"2014-04-04T07:49:48.865+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12706548/comment/13959815","id":"13959815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"body":"Hi [~oazwa],\nCan you search the mail list of yarn-dev, I had a mail for this issue.\n\nThis issue is only for Hive jobs. It works well for general MR jobs.(only unfinished tasks restart, all finished tasks not re-run)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"created":"2014-04-04T09:36:14.313+0000","updated":"2014-04-04T09:36:14.313+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12706548/comment/13960026","id":"13960026","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"This appears to be a duplicate of HIVE-6638.  As [~ozawa] mentioned, AMs are restarted when the RM restarts until YARN-556 is addressed.  When an AM restarts, it is not automatically the case that completed tasks will be recovered -- it must be supported by the output committer.  HIVE-6638 is updating Hive's OutputCommitter so it can support task recovery upon AM restart.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2014-04-04T14:55:41.420+0000","updated":"2014-04-04T14:55:41.420+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12706548/comment/13960515","id":"13960515","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"body":"Yes, exactly duplicated, thanks, I've closed it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=azuryy","name":"azuryy","key":"azuryy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fengdong Yu","active":true,"timeZone":"Etc/UTC"},"created":"2014-04-04T22:36:52.612+0000","updated":"2014-04-04T22:36:52.612+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-1901/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1uaxz:"}}