{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13028601","self":"https://issues.apache.org/jira/rest/api/2/issue/13028601","key":"YARN-6008","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-01-03T06:09:09.779+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jan 12 04:42:17 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-6008/watchers","watchCount":9,"isWatching":false},"created":"2016-12-16T06:54:26.619+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12490112","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12490112","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13031584","key":"YARN-6048","self":"https://issues.apache.org/jira/rest/api/2/issue/13031584","fields":{"summary":"YarnClient API call that is supposed to return containers of a previous attempt returns containers of the current application attempt ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajithshetty","name":"ajithshetty","key":"ajithshetty","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ajith S","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-01-12T04:42:17.689+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"When we run command \"yarn container -list\" on using failed application attempt we should either get containers from that attempt or get a back list as containers are no longer in running state.\n\nSteps to reproduce:\n1. Launch a yarn application. \n2. Kill app master, it tries to restart application with new attempt id. \n3. Now run yarn command,\nyarn container -list <Application Attempt ID>\n\nWhere Application Attempt ID is of failed attempt, \n\nit lists the container from next attempt which is in \"RUNNING\" state right now.\n\nExpected behavior:\nIt should return list of killed containers from attempt 1 or empty list.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Fetch container list for failed application attempt","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pgugale","name":"pgugale","key":"pgugale","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyanka Gugale","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pgugale","name":"pgugale","key":"pgugale","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyanka Gugale","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"hadoop version 2.6","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15753654","id":"15753654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pgugale","name":"pgugale","key":"pgugale","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyanka Gugale","active":true,"timeZone":"Etc/UTC"},"body":"Please refer discussion forum communication: http://mail-archives.apache.org/mod_mbox/hadoop-user/201612.mbox/browser","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pgugale","name":"pgugale","key":"pgugale","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyanka Gugale","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-16T06:55:27.148+0000","updated":"2016-12-16T06:55:27.148+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15794263","id":"15794263","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Let me take this discussion ahead.\n\nAs per current behavior, all running containers of *current attempt* will be returned regardless old/new attemptId is passed via CLI or api. Its makes sense because we are transferring old running containers from killed/failed attempt to new attempt as possible. So it makes sense to show containers of running attempt.\n\nI would like to know whether this makes sense or if its not fine, you could help share specific use case issue where its breaks some of client scenarios. In that case, we can see whether a *cli sub-option* can be provided (for attempt cli/api) to get exclusive containers of  given attempt ID (like show an error message that attempt is not running etc). Thoughts? . cc/ [~davidyan]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-03T06:09:09.779+0000","updated":"2017-01-03T06:09:09.779+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15794283","id":"15794283","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sunilg] In my case, the current attempt is actually not reusing the containers from the previous attempt. The previous attempt has containers that are terminated as a result of an AM failure. After the entire application is killed, the call actually returns the right containers. That's why I think the current behavior does not make sense.\n\nHere's an example:\n\nApplication has one failed attempt, and the current attempt is 02. This call that asks for containers from the previous attempt (01) returns the containers of the current attempt (02):\n\n{code}\n$ ~/hadoop/bin/yarn container -list appattempt_1483391433545_0002_000001\n17/01/02 22:15:43 INFO impl.TimelineClientImpl: Timeline service address: http://0.0.0.0:8188/ws/v1/timeline/\n17/01/02 22:15:43 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n17/01/02 22:15:43 INFO client.AHSProxy: Connecting to Application History server at /0.0.0.0:10200\nTotal number of containers :4\n                  Container-Id\t          Start Time\t         Finish Time\t               State\t                Host\t   Node Http Address\t                            LOG-URL\ncontainer_1483391433545_0002_02_000005\tMon Jan 02 19:17:02 -0800 2017\t                 N/A\t             RUNNING\t  david-ubuntu:37617\thttp://david-ubuntu:8042\thttp://david-ubuntu:8042/node/containerlogs/container_1483391433545_0002_02_000005/david\ncontainer_1483391433545_0002_02_000004\tMon Jan 02 19:17:01 -0800 2017\t                 N/A\t             RUNNING\t  david-ubuntu:37617\thttp://david-ubuntu:8042\thttp://david-ubuntu:8042/node/containerlogs/container_1483391433545_0002_02_000004/david\ncontainer_1483391433545_0002_02_000002\tMon Jan 02 19:16:59 -0800 2017\t                 N/A\t             RUNNING\t  david-ubuntu:37617\thttp://david-ubuntu:8042\thttp://david-ubuntu:8042/node/containerlogs/container_1483391433545_0002_02_000002/david\ncontainer_1483391433545_0002_02_000001\tMon Jan 02 19:16:48 -0800 2017\t                 N/A\t             RUNNING\t  david-ubuntu:37617\thttp://david-ubuntu:8042\thttp://david-ubuntu:8042/node/containerlogs/container_1483391433545_0002_02_000001/david\n{code}\n\nNow, let's kill the application:\n\n{code}\n$ ~/hadoop/bin/yarn application -kill application_1483391433545_0002\n17/01/02 22:18:39 INFO impl.TimelineClientImpl: Timeline service address: http://0.0.0.0:8188/ws/v1/timeline/\n17/01/02 22:18:39 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n17/01/02 22:18:39 INFO client.AHSProxy: Connecting to Application History server at /0.0.0.0:10200\nKilling application application_1483391433545_0002\n17/01/02 22:18:39 INFO impl.YarnClientImpl: Killed application application_1483391433545_0002\n{code}\n\nNow, let's execute the previous call again that asks for the containers from attempt 01:\n\n{code}\n$ ~/hadoop/bin/yarn container -list appattempt_1483391433545_0002_000001\n17/01/02 22:19:28 INFO impl.TimelineClientImpl: Timeline service address: http://0.0.0.0:8188/ws/v1/timeline/\n17/01/02 22:19:28 INFO client.RMProxy: Connecting to ResourceManager at /0.0.0.0:8032\n17/01/02 22:19:29 INFO client.AHSProxy: Connecting to Application History server at /0.0.0.0:10200\nTotal number of containers :4\n                  Container-Id\t          Start Time\t         Finish Time\t               State\t                Host\t   Node Http Address\t                            LOG-URL\ncontainer_1483391433545_0002_01_000004\tMon Jan 02 13:29:08 -0800 2017\tMon Jan 02 19:16:47 -0800 2017\t            COMPLETE\t  david-ubuntu:37617\t                 N/A\thttp://0.0.0.0:8188/applicationhistory/logs/david-ubuntu:37617/container_1483391433545_0002_01_000004/container_1483391433545_0002_01_000004/david\ncontainer_1483391433545_0002_01_000003\tMon Jan 02 13:29:07 -0800 2017\tMon Jan 02 19:16:45 -0800 2017\t            COMPLETE\t  david-ubuntu:37617\t                 N/A\thttp://0.0.0.0:8188/applicationhistory/logs/david-ubuntu:37617/container_1483391433545_0002_01_000003/container_1483391433545_0002_01_000003/david\ncontainer_1483391433545_0002_01_000002\tMon Jan 02 13:29:06 -0800 2017\tMon Jan 02 19:16:47 -0800 2017\t            COMPLETE\t  david-ubuntu:37617\t                 N/A\thttp://0.0.0.0:8188/applicationhistory/logs/david-ubuntu:37617/container_1483391433545_0002_01_000002/container_1483391433545_0002_01_000002/david\ncontainer_1483391433545_0002_01_000001\tMon Jan 02 13:28:56 -0800 2017\tMon Jan 02 19:16:47 -0800 2017\t            COMPLETE\t  david-ubuntu:37617\t                 N/A\thttp://0.0.0.0:8188/applicationhistory/logs/david-ubuntu:37617/container_1483391433545_0002_01_000001/container_1483391433545_0002_01_000001/david\n{code}\n\n\nAs you can see, after the application has been killed, it has the right behavior, but not when the application is running. That's why I think it does not make sense.\n\nHope the above helps!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-03T06:20:53.171+0000","updated":"2017-01-03T06:20:53.171+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15794566","id":"15794566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~davidyan] for explaining. This helps.\n\nThis looks like a problem. We should not list containers from an attempt where app is was originally killed (ie. No more attempts are running). \nBut I tested in trunk code, and it seems its not listing any containers. I need to check in 2.7.3. I ll get back.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-03T09:04:04.863+0000","updated":"2017-01-03T09:04:04.863+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15794584","id":"15794584","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sunilg] With the Timeline Server running, shouldn't it return the containers from an attempt even when the app was killed? Note that I'm running the Timeline Server and I do intend to get the container info from a killed app.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-03T09:11:42.443+0000","updated":"2017-01-03T09:11:42.443+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15794699","id":"15794699","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~davidyan] for the pointer.\nPost YARN-2808, we are trying to merge running containers from RM and completed containers from Timeline. And RM defaults to running attempt if given attempt id is failed. Hence we ran into this mix of problem.\n\nI tested same scenario and has got below output\n\nStep1: Killed attempt1 and attemp2 is running. In attempt1, 2 containers were already finished. Now query for attemp1.\n{noformat}\nHW12715:bin sunilgovindan$ ./yarn container -list appattempt_1483435241400_0002_000001\n2017-01-03 15:39:07,332 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n2017-01-03 15:39:07,786 INFO impl.TimelineClientImpl: Timeline service address: 0.0.0.0:8188\n2017-01-03 15:39:07,801 INFO client.RMProxy: Connecting to ResourceManager at /127.0.0.1:25001\n2017-01-03 15:39:07,937 INFO client.AHSProxy: Connecting to Application History server at /0.0.0.0:10200\nTotal number of containers :4\n                  Container-Id\t          Start Time\t         Finish Time\t               State\t                Host\t   Node Http Address\t                            LOG-URL\ncontainer_1483435241400_0002_02_000002\tTue Jan 03 15:38:36 +0530 2017\t                 N/A\t             RUNNING\t     localhost:25006\thttp://localhost:25008\thttp://localhost:25008/node/containerlogs/container_1483435241400_0002_02_000002/sunilgovindan\ncontainer_1483435241400_0002_02_000001\tTue Jan 03 15:38:31 +0530 2017\t                 N/A\t             RUNNING\t     localhost:25006\thttp://localhost:25008\thttp://localhost:25008/node/containerlogs/container_1483435241400_0002_02_000001/sunilgovindan\ncontainer_1483435241400_0002_01_000002\tTue Jan 03 15:38:06 +0530 2017\tTue Jan 03 15:38:30 +0530 2017\t            COMPLETE\t     localhost:25006\thttp://localhost:25008\thttp://0.0.0.0:8188/applicationhistory/logs/localhost:25006/container_1483435241400_0002_01_000002/container_1483435241400_0002_01_000002/sunilgovindan\ncontainer_1483435241400_0002_01_000001\tTue Jan 03 15:38:00 +0530 2017\tTue Jan 03 15:38:30 +0530 2017\t            COMPLETE\t     localhost:25006\thttp://localhost:25008\thttp://0.0.0.0:8188/applicationhistory/logs/localhost:25006/container_1483435241400_0002_01_000001/container_1483435241400_0002_01_000001/sunilgovindan\n{noformat}\n\nStep2: Now kill app1\n{noformat}\nHW12715:bin sunilgovindan$ ./yarn application -kill application_1483435241400_0002\n2017-01-03 15:39:39,214 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n2017-01-03 15:39:39,708 INFO impl.TimelineClientImpl: Timeline service address: 0.0.0.0:8188\n2017-01-03 15:39:39,723 INFO client.RMProxy: Connecting to ResourceManager at /127.0.0.1:25001\n2017-01-03 15:39:39,859 INFO client.AHSProxy: Connecting to Application History server at /0.0.0.0:10200\nKilling application application_1483435241400_0002\n2017-01-03 15:39:40,213 INFO impl.YarnClientImpl: Killed application application_1483435241400_0002\n{noformat}\n\nStep3: Do same query as per Step1. I have to get completed list here\n{noformat}\nHW12715:bin sunilgovindan$ ./yarn container -list appattempt_1483435241400_0002_000001\n2017-01-03 15:39:44,914 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n2017-01-03 15:39:45,363 INFO impl.TimelineClientImpl: Timeline service address: 0.0.0.0:8188\n2017-01-03 15:39:45,377 INFO client.RMProxy: Connecting to ResourceManager at /127.0.0.1:25001\n2017-01-03 15:39:45,511 INFO client.AHSProxy: Connecting to Application History server at /0.0.0.0:10200\nTotal number of containers :2\n                  Container-Id\t          Start Time\t         Finish Time\t               State\t                Host\t   Node Http Address\t                            LOG-URL\ncontainer_1483435241400_0002_01_000002\tTue Jan 03 15:38:06 +0530 2017\tTue Jan 03 15:38:30 +0530 2017\t            COMPLETE\t     localhost:25006\thttp://localhost:25008\thttp://0.0.0.0:8188/applicationhistory/logs/localhost:25006/container_1483435241400_0002_01_000002/container_1483435241400_0002_01_000002/sunilgovindan\ncontainer_1483435241400_0002_01_000001\tTue Jan 03 15:38:00 +0530 2017\tTue Jan 03 15:38:30 +0530 2017\t            COMPLETE\t     localhost:25006\thttp://localhost:25008\thttp://0.0.0.0:8188/applicationhistory/logs/localhost:25006/container_1483435241400_0002_01_000001/container_1483435241400_0002_01_000001/sunilgovindan\nHW12715:bin sunilgovindan$\n{noformat}\n\nIn step1, I am getting attemp1's completed containers and attemp2's running containers. Now once app is finished, same query will get completed containers of attempt1. [Behavior from trunk code]. \nTo avoid confusion, we can avoid giving running containers of attemp2 when attemp1 is queried for. And we can have some checks internally to see whether containers was transferred or not and then add that running containers to completed list.But thats an over kill. So either we can show all running containers of current attempt when previous attempt is queried OR we can skip to show any containers from RM and show only completed containers from Timeline server. My vote is in showing RUNNING + COMPLETED together.\n\nIn 2.7.3, if results are coming like you have mentioned (only RUNNING and NO COMPLETED) and not like my test results, i think its a bug in 2.7.3. I will double check that also in 2.7.3.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-03T10:19:36.027+0000","updated":"2017-01-03T10:19:36.027+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15794822","id":"15794822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajithshetty","name":"ajithshetty","key":"ajithshetty","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ajith S","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi\nWould like to work on this, can i assign this.?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajithshetty","name":"ajithshetty","key":"ajithshetty","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ajith S","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-03T11:19:13.448+0000","updated":"2017-01-03T11:19:13.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15795638","id":"15795638","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"body":"I think Step1 is producing the wrong result. The container IDs returned for attempt 1 are:\ncontainer_1483435241400_0002_02_000002\ncontainer_1483435241400_0002_02_000001\ncontainer_1483435241400_0002_01_000002\ncontainer_1483435241400_0002_01_000001\n\nHowever, the first two container IDs indicate that they are from attempt 2 (note the 02 in the container ID). So they should not appear when querying for attempt 1.\n\nI am not familiar on how YARN reuses containers from previous attempt, but if my understanding is correct, it's possible to have a query for attempt 2 returning containers from attempt 1, but not vice versa like what is happening.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-03T17:47:43.395+0000","updated":"2017-01-03T17:50:35.809+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15811143","id":"15811143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~davidyan]\n\nSorry for the delay here. I understood the explanation, thank you.\n\nYes, I think it makes more sense now. IIUC If any container is reused in attempt2, still the container id will be of attempt1. Hence its not necessary that we need to show attempt2 containers here. \nIt may not very direct implementation though. Since attempt1 was not present, we go to current attempt and pull live containers from there. So we need to filter specific containers for given attempt from the running attempt.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-09T09:19:27.429+0000","updated":"2017-01-09T09:19:27.429+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15811145","id":"15811145","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"I think its fine, if [~davidyan] is not actively working one same.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-09T09:20:40.759+0000","updated":"2017-01-09T09:20:40.759+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15813936","id":"15813936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks, I'm just a YARN user, not exactly a dev, at least not yet. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-10T05:22:31.496+0000","updated":"2017-01-10T05:22:31.496+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15814480","id":"15814480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~davidyan]\n\n[~ajithshetty] as mentioned [here|https://issues.apache.org/jira/browse/YARN-6008?focusedCommentId=15811143&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15811143], we were planning to show only those containers of a given attempt. Which means that, some containers may be in RM and some may be in Timeline as well. Pls share your thoughts.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-10T09:35:22.942+0000","updated":"2017-01-10T09:35:22.942+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15814634","id":"15814634","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"body":"Without Timeline Server, I think that's the expected behavior. However with Timeline Server enabled, it is supposed to return historical containers along with live containers. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidyan","name":"davidyan","key":"davidyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davidyan&avatarId=25590","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davidyan&avatarId=25590","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davidyan&avatarId=25590","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davidyan&avatarId=25590"},"displayName":"David Yan","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-01-10T10:43:50.556+0000","updated":"2017-01-10T10:43:50.556+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15814736","id":"15814736","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Yes. Thats correct. I was also meaning the same.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-10T11:35:51.516+0000","updated":"2017-01-10T11:35:51.516+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13028601/comment/15820160","id":"15820160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajithshetty","name":"ajithshetty","key":"ajithshetty","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ajith S","active":true,"timeZone":"Asia/Kolkata"},"body":"I agree to this, will upload initial patch for the same shortly","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajithshetty","name":"ajithshetty","key":"ajithshetty","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ajith S","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-12T04:42:17.689+0000","updated":"2017-01-12T04:42:17.689+0000"}],"maxResults":15,"total":15,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-6008/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i37ofz:"}}