{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12786434","self":"https://issues.apache.org/jira/rest/api/2/issue/12786434","key":"YARN-3415","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329059","id":"12329059","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335735","id":"12335735","description":"3.0.0-alpha1 release","name":"3.0.0-alpha1","archived":false,"released":true,"releaseDate":"2016-09-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-03-28T07:59:33.699+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Apr 03 18:36:51 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_338575173_*|*_1_*:*_1_*:*_142535710_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-04-02T21:01:23.925+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-3415/watchers","watchCount":9,"isWatching":false},"created":"2015-03-28T07:22:53.099+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327197","id":"12327197","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-08-30T01:25:11.994+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12322906","id":"12322906","name":"fairscheduler","description":"Fair Scheduler"}],"timeoriginalestimate":null,"description":"We encountered this problem while running a spark cluster. The amResourceUsage for a queue became artificially high and then the cluster got deadlocked because the maxAMShare constrain kicked in and no new AM got admitted to the cluster.\n\nI have described the problem in detail here: https://github.com/apache/spark/pull/5233#issuecomment-87160289\n\nIn summary - the condition for adding the container's memory towards amResourceUsage is fragile. It depends on the number of live containers belonging to the app. We saw that the spark AM went down without explicitly releasing its requested containers and then one of those containers memory was counted towards amResource.\n\ncc - [~sandyr]","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327585","id":"12327585","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329003","id":"12329003","description":"2.6.1 release","name":"2.6.1","archived":false,"released":true,"releaseDate":"2015-09-23"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12708063","id":"12708063","filename":"YARN-3415.000.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-29T22:58:23.136+0000","size":7419,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12708063/YARN-3415.000.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12708400","id":"12708400","filename":"YARN-3415.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T09:49:16.145+0000","size":12181,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12708400/YARN-3415.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12708850","id":"12708850","filename":"YARN-3415.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T23:14:50.614+0000","size":12176,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12708850/YARN-3415.002.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Non-AM containers can be counted towards amResourceUsage of a Fair Scheduler queue","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14385185","id":"14385185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"I can work on this issue, I read the problem at https://github.com/apache/spark/pull/5233#issuecomment-87160289.\nIt looks like the issue can be fixed by checking whether the AM is running before call addAMResourceUsage.\nWe should only addAMResourceUsage when AM is not running.\n{code}\n      if (!isAmRunning() && getLiveContainers().size() == 1 && !getUnmanagedAM()) {\n        getQueue().addAMResourceUsage(container.getResource());\n        setAmRunning(true);\n      }\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-28T07:59:33.699+0000","updated":"2015-03-28T07:59:33.699+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14385192","id":"14385192","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"It looks like we should also check isAmRunning at FairScheduler#allocate \n{code}\n   if (!application.getUnmanagedAM() && ask.size() == 1\n        && application.getLiveContainers().isEmpty()) {\n      application.setAMResource(ask.get(0).getCapability());\n    }\n{code}\nand FSAppAttempt#assignContainer\n{code}\n        if (getLiveContainers().size() == 0 && !getUnmanagedAM()) {\n          if (!getQueue().canRunAppAM(getAMResource())) {\n            return Resources.none();\n          }\n        }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-28T08:35:51.227+0000","updated":"2015-03-28T08:35:51.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14385202","id":"14385202","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"> if (!isAmRunning() && getLiveContainers().size() == 1 && !getUnmanagedAM()) {\n\nFew points:\n# If the above approach is valid - why do we need the {{getLiveContainers()}} check at all?\n# I don't see any place where we are setting {{amRunning}} to {{false}} once it is set to {{true}}. Should we do that for completeness?\n# Why is there no {{getUnmanagedAM()}} check in {{removeApp}} where we are subtracting from {{amResourceUsage}}. I think the conditions for adding and subtracting {{amResourceUsage}} should be similar as much as possible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-28T09:09:58.159+0000","updated":"2015-03-28T09:09:58.159+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14385347","id":"14385347","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for filing this [~ragarwal] and for taking this up [~zxu].  This seems like a fairly serious issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-28T14:45:17.026+0000","updated":"2015-03-28T14:45:17.026+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14385672","id":"14385672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ragarwal], thanks for the comment.\nbq. 1. If the above approach is valid - why do we need the getLiveContainers() check at all?\ntotally agree, If we check !isAmRunning(), getLiveContainers() check is redundant.\n\nbq. 2. I don't see any place where we are setting amRunning to false once it is set to true. Should we do that for completeness?\nWe don't need to set it false. because each FSAppAttempt has only one AM, once FSAppAttempt is removed, it will be garbage collected.\n\nbq. 3. Why is there no getUnmanagedAM() check in removeApp where we are subtracting from amResourceUsage. I think the conditions for adding and subtracting amResourceUsage should be similar as much as possible.\ntotally agree, it will be better to check getUnmanagedAM() for readability.\nCurrently it works, because we check getUnmanagedAM() when we setAMResource in FairScheduler#allocate. So if getUnmanagedAM() is true, app.getAMResource() will return Resources.none().\nAnd also we can remove the check app.getAMResource() != null because the following code will guarantee it will not return null.\n{code}\n  private Resource _get(String label, ResourceType type) {\n    try {\n      readLock.lock();\n      UsageByLabel usage = usages.get(label);\n      if (null == usage) {\n        return Resources.none();\n      }\n      return normalize(usage.resArr[type.idx]);\n    } finally {\n      readLock.unlock();\n    }\n  }\n{code}\n\nAbout my previous comments\nbq. It looks like we should also check isAmRunning at FairScheduler#allocate\nChecking isAmRunning at FairScheduler#allocate is not necessary. Because except AM container, all other containers for FSAppAttempt will be allocated by AM. once AM container is finished, no more FairScheduler#allocate will be called.\n\nI will upload a patch with a test case for this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-29T08:20:41.803+0000","updated":"2015-03-29T08:20:41.803+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14386003","id":"14386003","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"I uploaded a patch YARN-3415.000.patch for review.\nThe patch fixed two bugs and did 4 minor code optimizations.\nbugs fixed:\n1. Checking whether the AM is running before call addAMResourceUsage.\nWe should only addAMResourceUsage when AM is not running.\nWithout this fix, the test will fail because queue AmResourceUsage is changed by non-AM container.\n2. Don’t check non-AM container for queue MaxAMShare limitation.\nWithout this fix, the test will fail because non-AM container allocation is rejected due to MaxAMShare limitation.\n\ncode optimizations:\n1. remove redundant check for getLiveContainers().size() when addAMResourceUsage in FSAppAttempt.\n2. remove redundant check for getLiveContainers().size() when check queue MaxAMShare(canRunAppAM) in FSAppAttempt.\n3. remove redundant check for app.getAMResource() in FSLeafQueue#removeApp.\nI didn’t check app.getUnmanagedAM() here, instead I add comments: AmRunning is set to true only when getUnmanagedAM() is false.\nBut checking app.getUnmanagedAM() is also ok for me.\n4. check application.isAmRunning() instead of application.getLiveContainers().isEmpty() in FairScheduler#allocate.\nBecause application.getLiveContainers() will consume much more CPU power than application.isAmRunning().\nFairScheduler#allocate is a function which will be called very frequently.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-29T23:06:08.794+0000","updated":"2015-03-29T23:06:08.794+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14386042","id":"14386042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12708063/YARN-3415.000.patch\n  against trunk revision 3d9132d.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager:\n\n                  org.apache.hadoop.yarn.server.resourcemanager.TestRMHA\n                  org.apache.hadoop.yarn.server.resourcemanager.TestRMAdminService\n                  org.apache.hadoop.yarn.server.resourcemanager.webapp.TestRMWebappAuthentication\n                  org.apache.hadoop.yarn.server.resourcemanager.TestMoveApplication\n                  org.apache.hadoop.yarn.server.resourcemanager.recovery.TestZKRMStateStore\n\nTest results: https://builds.apache.org/job/PreCommit-YARN-Build/7143//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-YARN-Build/7143//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-30T00:21:49.383+0000","updated":"2015-03-30T00:21:49.383+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14386048","id":"14386048","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"The test failure is due to HADOOP-11754\n{code}\norg.mortbay.jetty.webapp.WebAppContext@63eaebdd{/,jar:file:/home/jenkins/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.0.0-SNAPSHOT/hadoop-yarn-common-3.0.0-SNAPSHOT.jar!/webapps/cluster}\njavax.servlet.ServletException: java.lang.RuntimeException: Could not read signature secret file: /home/jenkins/hadoop-http-auth-signature-secret\n\tat org.apache.hadoop.security.authentication.server.AuthenticationFilter.initializeSecretProvider(AuthenticationFilter.java:266)\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-30T00:30:17.959+0000","updated":"2015-03-30T00:30:17.959+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14387425","id":"14387425","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"body":"This looks mostly reasonable.  A few comments:\n* In FSAppAttempt, can we change the \"If this container is used to run AM\" comment to \"If not running unmanaged, the first container we allocate is always the AM. Update the leaf queue's AM usage\"?\n* The four lines of comment in FSLeafQueue could be reduced to \"If isAMRunning is true, we're no running an unmanaged AM.\"\n* Would it make sense to move the call to setAMResource that's currently in FairScheduler next to the call to getQueue().addAMResourceUsage() so that the queue and attempt resource usage get updated at the same time?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-30T21:19:06.805+0000","updated":"2015-03-30T21:19:06.805+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14387763","id":"14387763","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"I don't understand the newly added tests:\n{code}\n+    // request non-AM container for app5\n+    createSchedulingRequestExistingApplication(1024, 1, attId5);\n+    assertEquals(\"Application5's AM should have 1 container\",\n+        1, app5.getLiveContainers().size());\n+    // complete AM container before non-AM container is allocated.\n+    // spark application hit this situation.\n+    RMContainer amContainer5 = (RMContainer)app5.getLiveContainers().toArray()[0];\n+    ContainerExpiredSchedulerEvent containerExpired =\n+        new ContainerExpiredSchedulerEvent(amContainer5.getContainerId());\n+    scheduler.handle(containerExpired);\n+    assertEquals(\"Application5's AM should have 0 container\",\n+        0, app5.getLiveContainers().size());\n+    assertEquals(\"Queue1's AM resource usage should be 2048 MB memory\",\n+        2048, queue1.getAmResourceUsage().getMemory());\n+    scheduler.update();\n+    scheduler.handle(updateEvent);\n+    // non-AM container should be allocated\n+    // check non-AM container allocation is not rejected\n+    // due to queue MaxAMShare limitation.\n+    assertEquals(\"Application5's AM should have 1 container\",\n+        1, app5.getLiveContainers().size());\n+    // check non-AM container allocation won't affect queue AmResourceUsage\n+    assertEquals(\"Queue1's AM resource usage should be 2048 MB memory\",\n+        2048, queue1.getAmResourceUsage().getMemory());\n{code}\nJust before this block, I can see that the AM for app5 is already running and is taking 2048MB.\nSo, in my opinion, the tests should be like:\n- Add a non-AM container to app5. Handle the nodeUpdate event - check that the number of live containers is 2.\n- kill the AM container. Handle the events. Check that number of live containers becomes 1. Check that AM resource usage becomes 0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T01:16:07.772+0000","updated":"2015-03-31T01:16:07.772+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14388262","id":"14388262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12708381/YARN-3415.001.patch\n  against trunk revision b5a22e9.\n\n    {color:red}-1 patch{color}.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-YARN-Build/7167//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-31T08:50:50.343+0000","updated":"2015-03-31T08:50:50.343+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14388285","id":"14388285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sandyr], that is a very good idea to move the call to setAMResource that's currently in FairScheduler next to the call to getQueue().addAMResourceUsage().\nThe new patch YARN-3415.001.patch addressed this issue and it also addressed your first two comments.\n\n[~ragarwal], thanks for the review.\nFirst I want to clarify the AM resource usage won't be changed when the AM container is completed, It will only be changed when the application attempt is removed from scheduler, which will call FSLeafQueue#removeApp.\nSo currently  \"Check that AM resource usage becomes 0\" is done after all application attempts are removed.\n{code}\n    assertEquals(\"Queue1's AM resource usage should be 0\",\n        0, queue1.getAmResourceUsage().getMemory());\n{code}\n\nbq. Add a non-AM container to app5. Handle the nodeUpdate event - check that the number of live containers is 2.\nThe old code already had this test for app1, the test can pass without the patch.\n{code}\n    // Still can run non-AM container\n    createSchedulingRequestExistingApplication(1024, 1, attId1);\n    scheduler.update();\n    scheduler.handle(updateEvent);\n    assertEquals(\"Application1 should have two running containers\",\n        2, app1.getLiveContainers().size());\n{code}\n\nI think your issue is due to the non-AM container allocation is delayed after AM container is finished, which cause 0 LiveContainers.\nMy test simulates \"complete AM container before non-AM container is allocated\", the old code will increase the AM resource usage when non-AM container is allocated. So without the patch, the test will fail.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T09:11:42.950+0000","updated":"2015-03-31T09:11:42.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14388387","id":"14388387","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12708400/YARN-3415.001.patch\n  against trunk revision b5a22e9.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.\n\nTest results: https://builds.apache.org/job/PreCommit-YARN-Build/7170//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-YARN-Build/7170//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-31T11:28:18.822+0000","updated":"2015-03-31T11:28:18.822+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14391218","id":"14391218","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"body":"+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T18:50:21.458+0000","updated":"2015-04-01T18:50:21.458+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14391624","id":"14391624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ragarwal] did you have any more comments before I commit this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandyr","name":"sandyr","key":"sandyr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandy Ryza","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T22:29:11.116+0000","updated":"2015-04-01T22:29:11.116+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14391674","id":"14391674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"It looks good.\n\nI have one minor comment:\n{code}\n+    // non-AM container should be allocated\n+    // check non-AM container allocation is not rejected\n+    // due to queue MaxAMShare limitation.\n+    assertEquals(\"Application5's AM should have 1 container\",\n+        1, app5.getLiveContainers().size());\n{code}\nThe message in the {{assertEquals}} here should be 'Application5 should have 1 container.\" Because the AM is expired at this point.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T22:57:51.497+0000","updated":"2015-04-01T22:57:51.497+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14391728","id":"14391728","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ragarwal], thanks for the review. I uploaded a new patch YARN-3415.002.patch which addressed your comment.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T23:17:40.147+0000","updated":"2015-04-01T23:17:40.147+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14391738","id":"14391738","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ragarwal","name":"ragarwal","key":"ragarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ragarwal&avatarId=18538","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ragarwal&avatarId=18538","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ragarwal&avatarId=18538","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ragarwal&avatarId=18538"},"displayName":"Rohit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T23:25:34.245+0000","updated":"2015-04-01T23:25:34.245+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14391972","id":"14391972","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12708850/YARN-3415.002.patch\n  against trunk revision 4d14816.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.\n\nTest results: https://builds.apache.org/job/PreCommit-YARN-Build/7196//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-YARN-Build/7196//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-02T02:06:00.440+0000","updated":"2015-04-02T02:06:00.440+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14393351","id":"14393351","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sandyr], thanks for the review, The latest patch YARN-3415.002.patch is rebased on the latest code base and it passed the Jenkins test. Let me know whether you have more comments for the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-02T20:45:56.102+0000","updated":"2015-04-02T20:45:56.102+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14393412","id":"14393412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-trunk-Commit #7497 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/7497/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-02T21:06:19.006+0000","updated":"2015-04-02T21:06:19.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14393476","id":"14393476","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~ragarwal] for valuable feedback and filing this issue. Thanks [~sandyr]  for valuable feedback and committing the patch! Greatly appreciated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-02T21:33:13.096+0000","updated":"2015-04-02T21:33:13.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14394313","id":"14394313","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #152 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/152/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-03T11:31:10.231+0000","updated":"2015-04-03T11:31:10.231+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14394335","id":"14394335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Yarn-trunk #886 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/886/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-03T11:47:53.902+0000","updated":"2015-04-03T11:47:53.902+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14394507","id":"14394507","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #143 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/143/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-03T14:41:57.681+0000","updated":"2015-04-03T14:41:57.681+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14394522","id":"14394522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk #2084 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2084/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-03T14:46:18.098+0000","updated":"2015-04-03T14:46:18.098+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14394822","id":"14394822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #153 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/153/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-03T18:16:33.720+0000","updated":"2015-04-03T18:16:33.720+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12786434/comment/14394876","id":"14394876","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk #2102 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2102/])\nYARN-3415. Non-AM containers can be counted towards amResourceUsage of a fairscheduler queue (Zhihai Xu via Sandy Ryza) (sandy: rev 6a6a59db7f1bfda47c3c14fb49676a7b22d2eb06)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/TestFairScheduler.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSLeafQueue.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairScheduler.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FSAppAttempt.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-03T18:36:51.180+0000","updated":"2015-04-03T18:36:51.180+0000"}],"maxResults":28,"total":28,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-3415/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i27hpb:"}}