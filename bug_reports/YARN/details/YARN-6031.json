{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13030824","self":"https://issues.apache.org/jira/rest/api/2/issue/13030824","key":"YARN-6031","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334216","id":"12334216","description":"2.9.0 release","name":"2.9.0","archived":false,"released":true,"releaseDate":"2017-11-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339182","id":"12339182","name":"3.0.0-alpha4","archived":false,"released":true,"releaseDate":"2017-07-07"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12340356","id":"12340356","name":"2.8.2","archived":false,"released":true,"releaseDate":"2017-10-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-12-28T06:22:40.483+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jul 26 13:53:52 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_2_*:*_1136478680_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_2_*:*_2509611995","customfield_12312321":null,"resolutiondate":"2017-02-08T10:36:59.357+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-6031/watchers","watchCount":13,"isWatching":false},"created":"2016-12-28T05:48:48.739+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"8.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329059","id":"12329059","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"}],"issuelinks":[{"id":"12489928","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12489928","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"13030930","key":"YARN-6035","self":"https://issues.apache.org/jira/rest/api/2/issue/13030930","fields":{"summary":"Add -force-recovery option to yarn resourcemanager","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}},{"id":"12489922","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12489922","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12917078","key":"YARN-4401","self":"https://issues.apache.org/jira/rest/api/2/issue/12917078","fields":{"summary":"A failed app recovery should not prevent the RM from starting","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}},{"id":"12505826","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12505826","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12922347","key":"YARN-4465","self":"https://issues.apache.org/jira/rest/api/2/issue/12922347","fields":{"summary":"SchedulerUtils#validateRequest for Label check should happen only when nodelabel enabled","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-07-26T13:53:52.703+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319325","id":"12319325","name":"scheduler"}],"timeoriginalestimate":null,"description":"Here is the repro steps:\nEnable node label, restart RM, configure CS properly, and run some jobs;\nDisable node label, restart RM, and the following exception thrown:\n{noformat}\nCaused by: org.apache.hadoop.yarn.exceptions.InvalidLabelResourceRequestException: Invalid resource request, node label not enabled but request contains label expression\n        at org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerUtils.normalizeAndValidateRequest(SchedulerUtils.java:225)\n        at org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerUtils.normalizeAndValidateRequest(SchedulerUtils.java:248)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.validateAndCreateResourceRequest(RMAppManager.java:394)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.createAndPopulateNewRMApp(RMAppManager.java:339)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.recoverApplication(RMAppManager.java:319)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.recover(RMAppManager.java:436)\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.recover(ResourceManager.java:1165)\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$RMActiveServices.serviceStart(ResourceManager.java:574)\n        at org.apache.hadoop.service.AbstractService.start(AbstractService.java:193)\n        ... 10 more\n{noformat}\nDuring RM restart, application recovery failed due to that application had node label expression specified while node label has been disabled.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12844911","id":"12844911","filename":"YARN-6031.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-28T10:13:34.793+0000","size":3014,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12844911/YARN-6031.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12845976","id":"12845976","filename":"YARN-6031.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-06T09:22:57.488+0000","size":4100,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12845976/YARN-6031.002.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12846536","id":"12846536","filename":"YARN-6031.003.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-10T09:22:22.737+0000","size":9132,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12846536/YARN-6031.003.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12846735","id":"12846735","filename":"YARN-6031.004.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T03:54:44.294+0000","size":9207,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12846735/YARN-6031.004.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12846768","id":"12846768","filename":"YARN-6031.005.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T07:47:49.408+0000","size":8938,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12846768/YARN-6031.005.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12846782","id":"12846782","filename":"YARN-6031.006.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T09:08:11.588+0000","size":8992,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12846782/YARN-6031.006.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12848469","id":"12848469","filename":"YARN-6031.007.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-20T06:17:44.609+0000","size":8991,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12848469/YARN-6031.007.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12851578","id":"12851578","filename":"YARN-6031-branch-2.8.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-02-08T07:32:14.298+0000","size":9775,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12851578/YARN-6031-branch-2.8.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Application recovery has failed when node label feature is turned off during RM recovery","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15782197","id":"15782197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~Ying Zhang] for raising this issue.\n\nWith the help of {{isRecovery}} flag, we can try skip the recovery of the application if below conditions are met\n- Node Labels are disabled\n- AM resource request has Node Label Expression associated with it\n\nIn this scenario, we can skip the recovery of app just skipping the recovery loop.\n\nOur target could be to continue recovery for other apps and RM has to come up active. Make sense?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-28T06:22:40.483+0000","updated":"2016-12-28T06:22:40.483+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15782566","id":"15782566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Uploaded a patch, which is based on [~leftnoteasy]'s comment on YARN-4465:   swallow the InvalidResourceRequest exception when recovering, only fail the recovery for this application and print a error message, then let the rest of the recovery continue.\n\n[~sunilg], your suggestion also makes sense to me. Actually, the code change using your approach would be made at the same place as in this patch with small modification: in function recover(), inside the for loop,  if the conditions are met, skip calling \"recoverApplication\" and log a message like \"skip recover application ...\" instead. Difference is that using this approach we'll always check for these conditions even though it might not be a normal case, while using the approach in the patch, we just need to react when the exception happens. I'm ok with each approach since the overhead is not that big.\n\nLet's see what others think:-) [~leftnoteasy], [~bibinchundatt]\n\nJust want to clarify. The current fact is (with or without this fix): application submitted with node label expression explicitly specified will fail during recovery, while application submitted without node label expression specified will succeed, no matter whether or not there is default node label expression for the target queue. This is due to the following code snippet, the calling for \"checkQueueLabelInLabelManager\"  which will check if node label exists in node label manager(node label manager has no label at all if Node Label being disabled) has been skipped for recovery:\n{code:title=SchedulerUtils.java|borderStyle=solid}\n  public static void normalizeAndValidateRequest(ResourceRequest resReq,\n      Resource maximumResource, String queueName, YarnScheduler scheduler,\n      boolean isRecovery, RMContext rmContext, QueueInfo queueInfo)\n      throws InvalidResourceRequestException {\n    ... ...\n\n    SchedulerUtils.normalizeNodeLabelExpressionInRequest(resReq, queueInfo);\n    if (!isRecovery) {\n      validateResourceRequest(resReq, maximumResource, queueInfo, rmContext);  // calling checkQueueLabelInLabelManager\n    }\n{code}\n\nThis is not exactly the same as what happens when submitting a job in normal case (i.e., not during recovery). While in normal case, when there is default node label expression defined for queue with node label disabled, the application will also get rejected due to invalid resource request even if it doesn't specify node label expression. I believe this will get fixed after YARN-4652 being addressed.\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-28T10:13:10.616+0000","updated":"2016-12-28T10:22:02.080+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15782814","id":"15782814","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~Ying Zhang],\n\nOverall approach makes sense to me. You are basically trying to act on checking for label disabled check etc only when an exception is thrown. Its more or less same as the earlier suggestion. So its ok.\n\nHowever few more points. With this patch, now the app recovery will continue.\n- If App's AM resource request was not having any specific node label, but other containers may have. Since we send InvalidResourceRequest on those case, it might be fine for now.\n- In above case, what will happen to ongoing containers (w.r.t RM's data structure)?. If its a running app w/o any outstanding requests, we might need to consider running containers as for NO_LABEL. I am not sure whether this will happen as of today. I ll also check.\n\nThese could be out of scope for this ticket. However lets check opinion from other folks as well.\n\n*Note*: Please add more test cases to cover this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-28T12:40:41.475+0000","updated":"2016-12-28T13:04:39.278+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15782984","id":"15782984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"body":"Yep, tests are needed.  Love the long explanatory comment.  Do you think we can make the log message a bit more explicit, i.e. say that the failure was because node labels have been disabled and point out the property that the admin should use to disable/enable node labels?\n\nAlso, what happens to the app in the state store?  If we fail to recover it and just ignore it, it will sit there forever, I suspect.  It's probably a bad thing if the RM and state store don't agree on what apps are active.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-28T14:25:33.336+0000","updated":"2016-12-28T14:25:33.336+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15782995","id":"15782995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Yes [~templedf]. You are correct. We will end up having many flaky apps in state store. Offline had a chat with [~bibinchundatt] also, and there may be a potential problem with that too. max_applications may hit and valid apps may get emitted at some point of time.\nWe can forcefully remove state store, however we may loose information abt it as its a failed app. With clear logging, we can evict such apps from state store. I am not so sure whether we need to delete immediately or can put to an async monitor to delete later. Thoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-28T14:31:27.462+0000","updated":"2016-12-28T14:31:27.462+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15783025","id":"15783025","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. max_applications may hit and valid apps may get emitted at some point of time.\n\nExactly my concern.  So far, the answer has been that the recovery should just fail, and the admin should clear the app.  See your comments in YARN-4401.\n\nPersonally, I think that's a bad experience for the admin, but resolving it will require a bit of infrastructure work to make something useful happen.  I think a {{-force-recovery}} option that purges the bad apps after dumping full info to the logs would be a good start.  It would also help to have an option to dump the info about an app from the state store without having the RM running, so that when using {{-remove-application-from-state-store}} you know what you're purging.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-28T14:48:40.178+0000","updated":"2016-12-28T14:48:40.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15783073","id":"15783073","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Yes. Makes sense. This is more less a work for admin then. I am not so sure whether RM can take a call and internally remove. But it may be costly as we are deleting a user record. But if necessary informations are pushed to logs, then we may be good to remove data internally itself. Thoughts'?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-28T15:11:00.531+0000","updated":"2016-12-28T15:11:00.531+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15783232","id":"15783232","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"body":"I agree that {{-force-recovery}} could cause a significant information loss, but it's something that the admin has to do explicitly, and it's only application information, so it's not the end of the world.  With a {{-dump-application-information}} option, the admin has the choice to either 1) look at each app that fails the recovery and decide whether to purge it or do something else (like turn node labels back on), or 2) do a bulk purge with {{-force-recovery}}.\n\nIt might also be good to have another option, something like {{-dry-run-recovery}}, that would tell the admin the IDs of all the applications that will fail during recovery so that she doesn't have to keep doing them one at a time.  In fact, I could even see making that the default behavior before failing the resource manager.\n\nIn any case, I don't think the approach proposed in this JIRA, to just ignore the failed app, is going to work out.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-28T16:36:08.921+0000","updated":"2016-12-28T16:36:08.921+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15783397","id":"15783397","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"body":"As [~sunilg] mentioned earlier ignoring application could create stale application in state store.\n\n[~Ying Zhang] IIUC ignore validation on recovery also should work.\n\n{code}\n  private static void validateResourceRequest(ResourceRequest resReq,\n      Resource maximumResource, QueueInfo queueInfo, RMContext rmContext)\n      throws InvalidResourceRequestException {\n    Configuration conf = rmContext.getYarnConfiguration();\n    // If Node label is not enabled throw exception\n    if (null != conf && !YarnConfiguration.areNodeLabelsEnabled(conf)) {\n      String labelExp = resReq.getNodeLabelExpression();\n      if (!(RMNodeLabelsManager.NO_LABEL.equals(labelExp)\n          || null == labelExp)) {\n        throw new InvalidLabelResourceRequestException(\n            \"Invalid resource request, node label not enabled \"\n                + \"but request contains label expression\");\n      }\n    }\n{code}\n\nThoughts??\n\n{quote}\nThe current fact is (with or without this fix): application submitted with node label expression explicitly specified will fail during recovery\n{quote}\nIMHO should be acceptable since any application submitted with labels when feature is disabled gets rejected.\n\nSolution 2:\nWe could ignore/reset  labels  to default in  resourcerequest when nodelabels are disabled. Havn't looked at impact of the same. \nAn elaborate testing would be needed to see how metrics are impacted. Disadvantage is client will never get to know that reset happened in RM side\n\nYARN-4562 will try to handle  ignore loading label configuration when disabled.\n\n[~templedf] i do agree that admin would require some way to get application info when recovery fails so that bulk update in state store is possible.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-28T18:05:48.554+0000","updated":"2016-12-28T18:31:31.222+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15783546","id":"15783546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. IIUC ignore validation on recovery also should work.\n\nThen you end up with unschedulable apps in the system, which can't be good.\n\nbq. We could ignore/reset labels to default in resourcerequest when nodelabels are disabled.\n\nThe issue there is that the labels may have some important meaning to the job, so defaulting the labels may be bad.  As applications can have side-effects, I think it's better to have the failure up front than let the application potentially fail somewhere down the line.  The admin is then immediately made aware that he screwed up by disabling a feature that was still in use.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-28T19:22:21.542+0000","updated":"2016-12-28T19:22:32.808+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15784327","id":"15784327","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"{quote}\nWe could ignore/reset labels to default in resourcerequest when nodelabels are disabled.\n{quote}\nAgree with Daniel, reset might not be a good idea. Admin should be aware of the failure and take proper action.\n{quote}\nIIUC ignore validation on recovery also should work.\n{quote}\nI was thinking the same at the first place (see my comment at YARN-4465). Then I agree what [~sunilg] said for the same reason as above. We should not hide the failure/wrong configuration.\n{quote}\nIMHO should be acceptable since any application submitted with labels when feature is disabled gets rejected.\n{quote}\nYes, you're right. I agree with the current way, just want to clarify so that everyone is on the same page:-)\n\n\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-29T02:46:31.413+0000","updated":"2016-12-29T02:46:31.413+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15784332","id":"15784332","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"So what's the next move? I'm a little confused. Are we going to address this issue by the general approach proposed by [~templedf] and [~sunilg]?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-29T02:49:01.519+0000","updated":"2016-12-29T02:49:01.519+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15784349","id":"15784349","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"{quote}\nDo you think we can make the log message a bit more explicit, i.e. say that the failure was because node labels have been disabled and point out the property that the admin should use to disable/enable node labels?\n{quote}\nHi [~templedf], the following error message will be printed in RM log:\n{noformat}\n2016-12-28 01:00:22,694 WARN  resourcemanager.RMAppManager (RMAppManager.java:validateAndCreateResourceRequest(400)) - RM app submission failed in validating AM resource request for application application_xxxxxx\norg.apache.hadoop.yarn.exceptions.InvalidLabelResourceRequestException: Invalid resource request, node label not enabled but request contains label expression\n        at org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerUtils.normalizeAndValidateRequest(SchedulerUtils.java:225)\n        at org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerUtils.normalizeAndValidateRequest(SchedulerUtils.java:248)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.validateAndCreateResourceRequest(RMAppManager.java:396)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.createAndPopulateNewRMApp(RMAppManager.java:341)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.recoverApplication(RMAppManager.java:321)\n        at org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.recover(RMAppManager.java:439)\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.recover(ResourceManager.java:1165)\n        at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$RMActiveServices.serviceStart(ResourceManager.java:574)\n... ...\n2016-12-28 01:00:22,694 ERROR resourcemanager.RMAppManager (RMAppManager.java:recover(455)) - Failed to recover application application_xxxxxx\n{noformat}\nThe first error message is printed by the check which we fail at the first place, the second error message is printed by the code in the patch. I'm thinking this would be enough hint for the root cause.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-29T02:59:39.454+0000","updated":"2016-12-29T03:03:33.157+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15784719","id":"15784719","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"body":"[~templedf]\n\n{quote}\nso that when using -remove-application-from-state-store you know what you're purging.\n{quote}\n\nAnother concern about removal of application from store is  already running AM will be in dormant state. But if we allow  application to recover and make sure the application is killed from scheduler then application will be killed with a reason. \n\nCurrently in MR side if AM is running and request for non available label MR AM kills application the same could be implemented in all application.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-29T07:10:20.888+0000","updated":"2016-12-29T07:10:20.888+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15784818","id":"15784818","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"I gave a second thought. \n\nIf we skip and continue, then we will be loosing the record of that app from RM end (It will be there in Store still). We may be pushing detail information to logs, but user/admin need not have to take a look in logs as recovery went smooth (discarding few apps). If those apps are considered as failed, then user/admin can take some actions as mentioned by Daniel.\n\nI think if we can create RMAppImpl object and push transition into FAILED (with clear diags), then user/admin can easily know what happened (can then take action to remove from statestore or not). But not all apps may fail. For eg\n- An app which was running and there are no more outstanding requests (AM Container will be going to default label). Old containers may belong some specific label. \n- An app which was running and there are more outstanding requests to some labels (AM Container will be going to default label) \n\nIn first case, app will still continue running. In second case, its upto the app to decide when they get InvalidResourceRequestException in allocate call.\n\nI feel we can consider accepting the app and then mark as failed with a validation once RMAppImpl transitions are started (need not to be done from scheduler, we can do in RECOVER event if possible). Thoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-29T08:09:23.277+0000","updated":"2016-12-29T08:09:23.277+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15784929","id":"15784929","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"It makes sense to me.\n{quote}\nIf we skip and continue, then we will be loosing the record of that app from RM end (It will be there in Store still). We may be pushing detail information to logs, but user/admin need not have to take a look in logs as recovery went smooth (discarding few apps). \n{quote}\nYes, that's true, those app doesn't show up in the application list in RM UI after recovery. Just information in log saying what's going on.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-12-29T09:20:59.444+0000","updated":"2016-12-29T09:20:59.444+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15785845","id":"15785845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftnoteasy","name":"leftnoteasy","key":"leftnoteasy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=leftnoteasy&avatarId=18647","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=leftnoteasy&avatarId=18647","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=leftnoteasy&avatarId=18647","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=leftnoteasy&avatarId=18647"},"displayName":"Wangda Tan","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~Ying Zhang] for updating patch, and thanks comments from [~templedf] / [~sunilg].\n\nI agree with approach suggested by [~sunilg]. We can create RMAppImpl when InvalidResourceRequest thrown (For example, create a null ResourceRequest), and print proper error message \n\nAfter {{createAndPopulateNewRMApp}}, we can check if (amRequest == null) and (not unmanaged-am), if yes, send APP_REJECTED message, just like handling errors when credential parse error found, see {{submitApplication}}.\n\nThoughts?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftnoteasy","name":"leftnoteasy","key":"leftnoteasy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=leftnoteasy&avatarId=18647","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=leftnoteasy&avatarId=18647","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=leftnoteasy&avatarId=18647","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=leftnoteasy&avatarId=18647"},"displayName":"Wangda Tan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-29T18:39:12.052+0000","updated":"2016-12-29T18:39:12.052+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15794548","id":"15794548","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~leftnoteasy], I have a quick question here, if we just want to send APP_REJECTED message, why do we need to create RMAppImpl anyway? It looks like we just need to catch the InvalidResourceRequest exception in recoverApplicaiton and then send reject message. Or is it for printing proper error message? This can also be done in recoverApplication().","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-03T08:52:57.385+0000","updated":"2017-01-03T09:00:35.710+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15794578","id":"15794578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"If we are not creating RMAppImpl object and starting the app transitions, we will not have the app in RM to track as failed. {{RMAppManager.createAndPopulateNewRMApp}} ensures that the app object is added to {{rmContext.getRMApps()}}.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-03T09:07:46.676+0000","updated":"2017-01-03T09:07:46.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15794582","id":"15794582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Oh I see, thanks. Will update the patch soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-03T09:11:08.875+0000","updated":"2017-01-03T09:11:08.875+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15804106","id":"15804106","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"I've uploaded a new patch YARN-6031.002.patch with the suggested approach. Please kindly review and see if this is what we wanted. I'm working on adding test case now. Thank you.\n[~sunilg], for your comment below:\n{quote}\nI think if we can create RMAppImpl object and push transition into FAILED (with clear diags), then user/admin can easily know what happened (can then take action to remove from statestore or not). But not all apps may fail. For eg\nAn app which was running and there are no more outstanding requests (AM Container will be going to default label). Old containers may belong some specific label.\nAn app which was running and there are more outstanding requests to some labels (AM Container will be going to default label)\n{quote}\nI'm not sure how to achieve this. With current patch, all applications with specified node label expression will be rejected and fail during recovery (including those which had already successfully finished before we disabling Node label and restarting RM.) Please share your thoughts if you think this should be improved.:-)\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-06T09:32:00.488+0000","updated":"2017-01-06T09:32:41.390+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15804114","id":"15804114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Since RMAppImpl handles APP_REJECTED event and we can move app from NEW to FAILED (via FINAL_SAVING), I think its fine. Currently you are validating resource request and doing an assert. I suggest you can raise YarnException with more meaningful message.\nFor test cases, i suggest you can look {{TestWorkPreservingRMRestartForNodeLabel}}.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-06T09:37:03.069+0000","updated":"2017-01-06T09:37:03.069+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15814463","id":"15814463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~sunilg].\nUploaded a new patch with test case added.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-10T09:29:41.835+0000","updated":"2017-01-10T09:29:41.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15814625","id":"15814625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 14s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 12m 58s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 32s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 21s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 36s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 16s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  3s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 20s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 20s{color} | {color:orange} hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager: The patch generated 3 new + 115 unchanged - 0 fixed = 118 total (was 115) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 34s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  8s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 19s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 39m 13s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 17s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 60m 46s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesDelegationTokens |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12846536/YARN-6031.003.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux c0da29707a81 3.13.0-103-generic #150-Ubuntu SMP Thu Nov 24 10:34:17 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 9594c35 |\n| Default Java | 1.8.0_111 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-YARN-Build/14621/artifact/patchprocess/diff-checkstyle-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/14621/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14621/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14621/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-10T10:39:44.748+0000","updated":"2017-01-10T10:39:44.748+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15815505","id":"15815505","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Patch looks generally fine.\n\nFew minor nits:\n\n1.\n{noformat}\nString message = \"Failed to recover application \" + appId\n  + \". Node label not enabled but request contains label expression \"\n  + labelExp + \".\";\n{noformat}\nI think it could be written as \"Failed to recover application <appId>. NodeLabel is not enabled in cluster, but AM resource request contains a label expression.\"\n2. amReqInAppContext -> amReqFromAppContext\n3. In line with comment 1, please update the exception message in createAndPopulateNewRMApp.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-10T17:02:02.626+0000","updated":"2017-01-10T17:02:02.626+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817078","id":"15817078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks very much [~sunilg] for the quick review. Comments addressed in the new patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T03:55:25.031+0000","updated":"2017-01-11T03:55:25.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817180","id":"15817180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 13m  8s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 34s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 22s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 36s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 16s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 59s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 20s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 31s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 30s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 30s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 20s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 13s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  1m  5s{color} | {color:red} hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager generated 1 new + 0 unchanged - 0 fixed = 1 total (was 0) {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 18s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 38m 55s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 16s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 60m 30s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| FindBugs | module:hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n|  |  Redundant nullcheck of amReq which is known to be null in org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.createAndPopulateNewRMApp(ApplicationSubmissionContext, long, String, boolean, long)  Redundant null check at RMAppManager.java:is known to be null in org.apache.hadoop.yarn.server.resourcemanager.RMAppManager.createAndPopulateNewRMApp(ApplicationSubmissionContext, long, String, boolean, long)  Redundant null check at RMAppManager.java:[line 404] |\n| Failed junit tests | hadoop.yarn.server.resourcemanager.TestRMRestart |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12846735/YARN-6031.004.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 4060267ed344 3.13.0-95-generic #142-Ubuntu SMP Fri Aug 12 17:00:09 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 4db119b |\n| Default Java | 1.8.0_111 |\n| findbugs | v3.0.0 |\n| findbugs | https://builds.apache.org/job/PreCommit-YARN-Build/14635/artifact/patchprocess/new-findbugs-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.html |\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/14635/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14635/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14635/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-11T04:59:33.113+0000","updated":"2017-01-11T04:59:33.113+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817265","id":"15817265","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"For findbugs error, it might be good to keep the null check in case later code change breaks the assumption.\nTest failure is known and tracked by YARN-5548.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T05:43:36.837+0000","updated":"2017-01-11T05:43:36.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817317","id":"15817317","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~Ying Zhang]\nWhen InvalidResourceRequestException is thrown from {{validateAndCreateResourceRequest}}, its sure that {{amReq}} is not updated. Hence {{amReq}} will be null. I think you can write a debug log and come out. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-11T06:06:03.176+0000","updated":"2017-01-11T06:06:03.176+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817555","id":"15817555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~sunilg]. Done and uploaded a new patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T07:48:43.611+0000","updated":"2017-01-11T07:49:00.540+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817589","id":"15817589","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Quick correction: Could u also pls add {{LOG.isDebugEnabled()}} before logging.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-11T08:03:08.469+0000","updated":"2017-01-11T08:03:24.353+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817714","id":"15817714","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (/) *{color:green}+1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 23s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 14m 24s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 35s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 23s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 37s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 17s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  5s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 23s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 33s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 34s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 34s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 21s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 35s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 10s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 19s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 41m 14s{color} | {color:green} hadoop-yarn-server-resourcemanager in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 18s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 64m 50s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12846768/YARN-6031.005.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux ee8bf4a7ffe6 3.13.0-105-generic #152-Ubuntu SMP Fri Dec 2 15:37:11 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 467f5f1 |\n| Default Java | 1.8.0_111 |\n| findbugs | v3.0.0 |\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14638/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14638/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-11T08:54:07.806+0000","updated":"2017-01-11T08:54:07.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817747","id":"15817747","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~sunilg]. Done. I was thinking that LOG.debug can do this check on its own, but we can always do it beforehand and follow the current code style in RM:-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-11T09:11:01.158+0000","updated":"2017-01-11T09:11:01.158+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817767","id":"15817767","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Patch generally looks fie for me. Will wait for jenkins to kick off.\nAlso will wait for a day if any others have some comments as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-11T09:20:27.292+0000","updated":"2017-01-11T09:20:27.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15817878","id":"15817878","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  1s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 13m  4s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 33s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 22s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 36s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 16s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  0s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 21s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 31s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 33s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 33s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 20s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  5s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 19s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 39m 41s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 16s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 61m 19s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.yarn.server.resourcemanager.TestRMRestart |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12846782/YARN-6031.006.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 808f0406b80d 3.13.0-95-generic #142-Ubuntu SMP Fri Aug 12 17:00:09 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / be529da |\n| Default Java | 1.8.0_111 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/14639/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14639/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14639/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-11T10:10:19.237+0000","updated":"2017-01-11T10:10:19.237+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15819959","id":"15819959","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Failed test case (TestRMRestart.testFinishedAppRemovalAfterRMRestart) is known and tracked by YARN-5548.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-12T02:40:18.790+0000","updated":"2017-01-12T02:41:02.055+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15831197","id":"15831197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~sunilg], would you please help to push this forward?:-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-01-20T05:10:45.148+0000","updated":"2017-01-20T05:10:45.148+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15831210","id":"15831210","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Yes. It fell off from my radar.\n\nHowever patch looks stale. Could you please rebase to trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-20T05:26:43.641+0000","updated":"2017-01-20T05:26:43.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15831288","id":"15831288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"+1 for latest patch. Pending jenkins.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-20T06:39:13.737+0000","updated":"2017-01-20T06:39:13.737+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15831338","id":"15831338","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (/) *{color:green}+1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 14m 49s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 37s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 24s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 52s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 20s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 39s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 30s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 50s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 49s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 49s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 27s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 50s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 17s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  1s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 46s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 27s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 41m 59s{color} | {color:green} hadoop-yarn-server-resourcemanager in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 21s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 68m 47s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12848469/YARN-6031.007.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 15390e066e0a 3.13.0-105-generic #152-Ubuntu SMP Fri Dec 2 15:37:11 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / b01514f |\n| Default Java | 1.8.0_111 |\n| findbugs | v3.0.0 |\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14720/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14720/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-20T07:27:30.124+0000","updated":"2017-01-20T07:27:30.124+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15833981","id":"15833981","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Committed to trunk/branch-2. However patch is not getting cleanly applied to branch-2.8. [~Ying Zhang], please help to share branch-2.8 patch. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-23T06:56:54.994+0000","updated":"2017-01-23T06:56:54.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15833997","id":"15833997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #11159 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/11159/])\nYARN-6031. Application recovery has failed when node label feature is (sunilg: rev 3fa0d540dfca579f3c2840a959b748a7528b02ed)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/RMAppManager.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/TestRMRestart.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-23T07:14:16.227+0000","updated":"2017-01-23T07:14:16.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857371","id":"15857371","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~sunilg], sorry for the late reply (was out for the Spring Festival holiday). Here is the patch for branch-2.8, please have a look.\nI've found a problem with the test case when making the patch for branch-2.8. TestRMRestart runs all test cases for CapacityScheduler and FairScheduler respectively, and this test case can only run successfully for CapacityScheduler since it involves running application with node label specified. On trunk, we don't see this problem because due to YARN-4805, TestRMRestart now only runs for CapacityScheduler. I've modified the test case a little bit to just run when it is CapacityScheduler.\n{code}\n  public void testRMRestartAfterNodeLabelDisabled() throws Exception {\n    // Skip this test case if it is not CapacityScheduler since NodeLabel is\n    // not fully supported yet for FairScheduler and others.\n    if (!getSchedulerType().equals(SchedulerType.CAPACITY)) {\n      return;\n    }\n...\n{code}\nWe should probably make this change to trunk too. Let me know you want to make the change through this JIRA, or I need to open another JIRA to address it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-02-08T04:21:44.502+0000","updated":"2017-02-08T04:21:44.502+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857547","id":"15857547","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Or do we need to backport YARN-4805 to branch-2.8 ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-02-08T07:10:04.092+0000","updated":"2017-02-08T07:10:04.092+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857562","id":"15857562","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"body":"I'm thinking it is a separate question. No matter we backport YARN-4805 or not, the test case itself can be improved to avoid running with FairScheduler:-) ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ying+Zhang","name":"Ying Zhang","key":"ying zhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ying+zhang&avatarId=26746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ying+zhang&avatarId=26746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ying+zhang&avatarId=26746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ying+zhang&avatarId=26746"},"displayName":"Ying Zhang","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-02-08T07:17:41.458+0000","updated":"2017-02-08T07:18:48.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857587","id":"15857587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~Ying Zhang] for the clarification. Makes sense for me.\n\nNew ticket could be raised to track test case improvement. I will wait for jenkins to branch-2.8 patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-02-08T07:49:48.691+0000","updated":"2017-02-08T07:49:48.691+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857757","id":"15857757","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 27s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 53s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 34s{color} | {color:green} branch-2.8 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 32s{color} | {color:green} branch-2.8 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 19s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 37s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 16s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 10s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 20s{color} | {color:green} branch-2.8 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 24s{color} | {color:green} branch-2.8 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 30s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 26s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 26s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 29s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 29s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 16s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 36s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 23s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 21s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 21s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 75m 29s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed with JDK v1.7.0_121. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 20s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}168m 19s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_121 Failed junit tests | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestCapacitySchedulerSurgicalPreemption |\n|   | hadoop.yarn.server.resourcemanager.TestClientRMTokens |\n|   | hadoop.yarn.server.resourcemanager.TestAMAuthorization |\n| JDK v1.7.0_121 Failed junit tests | hadoop.yarn.server.resourcemanager.TestClientRMTokens |\n|   | hadoop.yarn.server.resourcemanager.TestAMAuthorization |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:5af2af1 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12851556/YARN-6031-branch-2.8.001.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 034939e402a1 3.13.0-107-generic #154-Ubuntu SMP Tue Dec 20 09:57:27 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.8 / 2bbcaa8 |\n| Default Java | 1.7.0_121 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/14859/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager-jdk1.7.0_121.txt |\n| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14859/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14859/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-08T10:07:51.621+0000","updated":"2017-02-08T10:07:51.621+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857781","id":"15857781","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Test case failures are know and not related to the patch for branch-2.8 (jdk 7).\n\nCommitting to branch-2.8","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-02-08T10:18:53.985+0000","updated":"2017-02-08T10:18:53.985+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857813","id":"15857813","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~Ying Zhang] for the contribution and thanks [~templedf] [~leftnoteasy] and [~bibinchundatt]  for additional review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-02-08T10:36:59.393+0000","updated":"2017-02-08T10:36:59.393+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/15857871","id":"15857871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 19s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 57s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 31s{color} | {color:green} branch-2.8 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 34s{color} | {color:green} branch-2.8 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 20s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 39s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 18s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 13s{color} | {color:green} branch-2.8 passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 21s{color} | {color:green} branch-2.8 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 25s{color} | {color:green} branch-2.8 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 31s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 27s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 27s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 32s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 17s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 15s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 25s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 19s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 22s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 76m 51s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed with JDK v1.7.0_121. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 18s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}171m  2s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_121 Failed junit tests | hadoop.yarn.server.resourcemanager.TestAMAuthorization |\n|   | hadoop.yarn.server.resourcemanager.TestClientRMTokens |\n| JDK v1.7.0_121 Failed junit tests | hadoop.yarn.server.resourcemanager.TestAMAuthorization |\n|   | hadoop.yarn.server.resourcemanager.TestClientRMTokens |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:5af2af1 |\n| JIRA Issue | YARN-6031 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12851578/YARN-6031-branch-2.8.001.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 1d714a427b8a 3.13.0-105-generic #152-Ubuntu SMP Fri Dec 2 15:37:11 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.8 / 2bbcaa8 |\n| Default Java | 1.7.0_121 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/14860/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager-jdk1.7.0_121.txt |\n| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/14860/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/14860/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-08T11:50:32.965+0000","updated":"2017-02-08T11:50:32.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/16041683","id":"16041683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"2.8.1 became a security release. Moving fix-version to 2.8.2 after the fact.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-06-07T21:40:50.041+0000","updated":"2017-06-07T21:40:50.041+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/16099180","id":"16099180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"Ran into this patch when debugging same issue, got few questions:\ncc [~sunilg], [~Ying Zhang] \n1. Below code catches InvalidLabelResourceRequestException and assumes that the error is because node-label becomes disabled, but the same InvalidLabelResourceRequestException can be thrown for other reasons too, right ? in that case, the following logic becomes invalid. \n\n{code}\n      amReqs = validateAndCreateResourceRequest(submissionContext, isRecovery);\n    } catch (InvalidLabelResourceRequestException e) {\n      // This can happen if the application had been submitted and run\n      // with Node Label enabled but recover with Node Label disabled.\n      // Thus there might be node label expression in the application's\n      // resource requests. If this is the case, create RmAppImpl with\n      // null amReq and reject the application later with clear error\n      // message. So that the application can still be tracked by RM\n      // after recovery and user can see what's going on and react accordingly.\n      if (isRecovery &&\n          !YarnConfiguration.areNodeLabelsEnabled(this.conf)) {\n        if (LOG.isDebugEnabled()) {\n          LOG.debug(\"AMResourceRequest is not created for \" + applicationId\n              + \". NodeLabel is not enabled in cluster, but AM resource \"\n              + \"request contains a label expression.\");\n        }\n      } else {\n        throw e;\n      }\n{code}\n\n2. Below code directly transitions app to failed by using a Rejected event.  The attempt state is not moved to failed, it'll be stuck there ? I think we need to send KILL event instead of REJECT event\n{code}\n      if (labelExp != null &&\n          !labelExp.equals(RMNodeLabelsManager.NO_LABEL)) {\n        String message = \"Failed to recover application \" + appId\n            + \". NodeLabel is not enabled in cluster, but AM resource request \"\n            + \"contains a label expression.\";\n        LOG.warn(message);\n        application.handle(\n            new RMAppEvent(appId, RMAppEventType.APP_REJECTED, message));\n        return;\n      }\n{code}\n\n3. Is it ok to let the app continue in this scenario, it's less disruptive to the apps. What's the disadvantage if we let app continue ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-24T22:07:39.356+0000","updated":"2017-07-24T22:15:56.695+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/16099594","id":"16099594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~jianhe]\nFew doubts here,\n\nbq.1. Below code catches InvalidLabelResourceRequestException and assumes that the error is because node-label becomes disabled\nThis code snippet catches InvalidLabelResourceRequestException and suppress the same only in case of recovery. If AMResourceRequest was stored in statestore, which means that {{validateAndCreateResourceRequest}} was successful when app was submitted. Now during recovery, same will throw error only when node labels are disables by conf. If its in store, we can assume that the am request is sane enough. Could you please give more context where some other scenario can also throw same exception during recovery.\nOn an another note, if not recovery {{throw e;}}, we throw same exception back.\n\nbq.2. Below code directly transitions app to failed by using a Rejected event. The attempt state is not moved to failed\nIn RMAppManager#createAndPopulateNewRMApp, app is just created whether its in submission/recovery mode. Attempt is not yet created. Hence I think this wont be a problem.\n\nbq.3. Is it ok to let the app continue in this scenario, it's less disruptive to the apps.\nCurrently exception was thrown and RM was loosing the context of such an app. To record and track such an app, we create the app nd move it to fail state. Hence recovery for other apps will also continue and we will have context of this app as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-07-25T06:56:03.899+0000","updated":"2017-07-25T06:56:03.899+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/16100766","id":"16100766","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. In RMAppManager#createAndPopulateNewRMApp, app is just created whether its in submission/recovery mode. Attempt is not yet created. Hence I think this wont be a problem.\nThe scenario is this: the RMApp is now transitioned to failed and the state is persisted in store, but attempt state is still null. If next time the admin re-enables node label, RMApp will be recovered as FAILED, but attempt state will be NULL.\n\nbq.  Hence recovery for other apps will also continue and we will have context of this app as well.\nKilling an app for a mistake of admin may be harsh from the perspective of service app, as all service containers will be killed. I was thinking whether we can let the app continue to run - existing containers will be running fine, the new requests with label will be rejected. I guess we can surface this as a diagnostics to the user ? \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-25T20:54:03.484+0000","updated":"2017-07-25T20:54:03.484+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13030824/comment/16101682","id":"16101682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"bq.I was thinking whether we can let the app continue to run\nThanks [~jianhe]. We can let the app run and account resource under NO_LABEL. I will open a new jira to track same.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-07-26T13:53:52.703+0000","updated":"2017-07-26T13:53:52.703+0000"}],"maxResults":55,"total":55,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-6031/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3825r:"}}