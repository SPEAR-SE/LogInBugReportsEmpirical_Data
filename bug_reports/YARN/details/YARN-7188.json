{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13101912","self":"https://issues.apache.org/jira/rest/api/2/issue/13101912","key":"YARN-7188","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2017-09-13T15:58:58.360+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Sep 13 17:57:03 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_28080926_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2017-09-13T17:57:03.645+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-7188/watchers","watchCount":3,"isWatching":false},"created":"2017-09-13T10:09:02.771+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vrushalic","name":"vrushalic","key":"vrushalic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10433"},"displayName":"Vrushali C","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-09-13T17:57:03.692+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"In hbase-1.2.6 which is by default, TimelineSchemaCreator fails to create flow run table. \n\n{noformat}\n2017-09-13 15:15:54,934 ERROR storage.TimelineSchemaCreator: Error in creating hbase tables:\norg.apache.hadoop.hbase.DoNotRetryIOException: org.apache.hadoop.hbase.DoNotRetryIOException: File does not exist: /hbase/coprocessor/hadoop-yarn-server-timelineservice.jar Set hbase.table.sanity.checks to false at conf or table descriptor if you want to bypass sanity checks\n\tat org.apache.hadoop.hbase.master.HMaster.warnOrThrowExceptionForFailure(HMaster.java:1754)\n\tat org.apache.hadoop.hbase.master.HMaster.sanityCheckTableDescriptor(HMaster.java:1615)\n\tat org.apache.hadoop.hbase.master.HMaster.createTable(HMaster.java:1541)\nCaused by: org.apache.hadoop.hbase.ipc.RemoteWithExtrasException(org.apache.hadoop.hbase.DoNotRetryIOException): org.apache.hadoop.hbase.DoNotRetryIOException: File does not exist: /hbase/coprocessor/hadoop-yarn-server-timelineservice.jar Set hbase.table.sanity.checks to false at\n{noformat}\n\nThis is because coprocessor jar is always expected to be there always in hdfs location. By default it is configured to \n{code}\n  public static final String FLOW_RUN_COPROCESSOR_JAR_HDFS_LOCATION =\n      TIMELINE_SERVICE_PREFIX\n      + \"hbase.coprocessor.jar.hdfs.location\";\n\n  /** default hdfs location for flowrun coprocessor jar. */\n  public static final String DEFAULT_HDFS_LOCATION_FLOW_RUN_COPROCESSOR_JAR =\n      \"/hbase/coprocessor/hadoop-yarn-server-timelineservice.jar\";\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12338418","id":"12338418","description":"3.0.0-beta1 release","name":"3.0.0-beta1","archived":false,"released":true,"releaseDate":"2017-10-03"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"TimelineSchemaCreator fails to create flowrun table","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13101912/comment/16164439","id":"16164439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"It fails because while creating a table it except file location to be present in hdfs location. \n{noformat}\n2017-09-13 15:21:39,051 INFO  [main] flow.FlowRunTable: CoprocessorJarPath=/hbase/coprocessor/hadoop-yarn-server-timelineservice.jar\n2017-09-13 15:21:39,083 WARN  [main] storage.TimelineSchemaCreator: Skip and continue on: org.apache.hadoop.hbase.DoNotRetryIOException: File does not exist: /hbase/coprocessor/hadoop-yarn-server-timelineservice.jar Set hbase.table.sanity.checks to false at conf or table descriptor if you want to bypass sanity checks\n{noformat}\n\nI remember it used to work in lower versions of hbase without failing table creation. May be some modifications from HBase causing this issue! cc:/ [~vrushalic] [~varun_saxena]\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-09-13T10:20:19.392+0000","updated":"2017-09-13T10:20:19.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13101912/comment/16164872","id":"16164872","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=varun_saxena","name":"varun_saxena","key":"varun_saxena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Saxena","active":true,"timeZone":"Asia/Kolkata"},"body":"Is it a problem?\nWe mention in the documentation that you have to place the jar in the said location.\nAnd flow run coprocessor is required to retrieve values correctly from flow run table.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=varun_saxena","name":"varun_saxena","key":"varun_saxena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Saxena","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-09-13T15:58:58.360+0000","updated":"2017-09-13T15:58:58.360+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13101912/comment/16164880","id":"16164880","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vrushalic","name":"vrushalic","key":"vrushalic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10433"},"displayName":"Vrushali C","active":true,"timeZone":"Etc/UTC"},"body":"The coprocessor jar was earlier picked up from the classpath since  it was a statically loaded coprocessor which was enabled for all tables. Hence we had special defensive checks in the coprocessor to ensure it works on flow run table only. Had the jar not been in the classpath, we would have likely had the same error during schema creation as well as during region server restart. \n\nAs part of YARN-6094, we have updated the coprocessor to be a dynamically loaded, table level one. The documentation changes have also been made.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vrushalic","name":"vrushalic","key":"vrushalic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10433"},"displayName":"Vrushali C","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-13T16:03:37.525+0000","updated":"2017-09-13T16:03:37.525+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13101912/comment/16165039","id":"16165039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"body":"thanks [~vrushalic] for pointing out about YARN-6094. I see in the doc section _Enable the coprocessor_ as well that clearly says about flow run co-processor able creation. Closing as Not a problem!\nApologies for missing this point earlier and spamming!!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"created":"2017-09-13T17:57:03.686+0000","updated":"2017-09-13T17:57:03.686+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-7188/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3k0f3:"}}