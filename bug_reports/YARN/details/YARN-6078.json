{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13033304","self":"https://issues.apache.org/jira/rest/api/2/issue/13033304","key":"YARN-6078","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341435","id":"12341435","description":"3.0.0 GA release","name":"3.0.0","archived":false,"released":true,"releaseDate":"2017-12-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2017-01-10T08:40:01.249+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Feb 07 16:10:14 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_25691221020_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_956906253","customfield_12312321":null,"resolutiondate":"2017-11-14T18:46:18.857+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-6078/watchers","watchCount":16,"isWatching":false},"created":"2017-01-10T08:30:51.668+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12519222","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12519222","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"13115466","key":"YARN-7426","self":"https://issues.apache.org/jira/rest/api/2/issue/13115466","fields":{"summary":"Interrupt does not work when LocalizerRunner is reading from InputStream","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12526512","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12526512","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13135650","key":"YARN-7873","self":"https://issues.apache.org/jira/rest/api/2/issue/13135650","fields":{"summary":"Revert YARN-6078","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12519224","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12519224","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13004600","key":"YARN-5641","self":"https://issues.apache.org/jira/rest/api/2/issue/13004600","fields":{"summary":"Localizer leaves behind tarballs after container is complete","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-02-07T18:25:21.625+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I encountered an interesting issue in one of our Yarn clusters (where the containers are stuck in localizing phase).\n\nOur AM requests a container, and starts a process using the NMClient.\n\nAccording to the NM the container is in LOCALIZING state:\n{code}\n1. 2017-01-09 22:06:18,362 [INFO] [AsyncDispatcher event handler] container.ContainerImpl.handle(ContainerImpl.java:1135) - Container container_e03_1481261762048_0541_02_000060 transitioned from NEW to LOCALIZING\n2017-01-09 22:06:18,363 [INFO] [AsyncDispatcher event handler] localizer.ResourceLocalizationService$LocalizerTracker.handle(ResourceLocalizationService.java:711) - Created localizer for container_e03_1481261762048_0541_02_000060\n2017-01-09 22:06:18,364 [INFO] [LocalizerRunner for container_e03_1481261762048_0541_02_000060] localizer.ResourceLocalizationService$LocalizerRunner.writeCredentials(ResourceLocalizationService.java:1191) - Writing credentials to the nmPrivate file /../..//.nmPrivate/container_e03_1481261762048_0541_02_000060.tokens. Credentials list:\n{code}\n\nAccording to the RM the container is in RUNNING state:\n{code}\n2017-01-09 22:06:17,110 [INFO] [IPC Server handler 19 on 8030] rmcontainer.RMContainerImpl.handle(RMContainerImpl.java:410) - container_e03_1481261762048_0541_02_000060 Container Transitioned from ALLOCATED to ACQUIRED\n2017-01-09 22:06:19,084 [INFO] [ResourceManager Event Processor] rmcontainer.RMContainerImpl.handle(RMContainerImpl.java:410) - container_e03_1481261762048_0541_02_000060 Container Transitioned from ACQUIRED to RUNNING\n{code}\n\nWhen I click the Yarn RM UI to view the logs for the container,  I get an error\nthat\n{code}\nNo logs were found. state is LOCALIZING\n{code}\n\nThe Node manager 's stack trace seems to indicate that the NM's LocalizerRunner is stuck waiting to read from the sub-process's outputstream.\n\n{code}\n\"LocalizerRunner for container_e03_1481261762048_0541_02_000060\" #27007081 prio=5 os_prio=0 tid=0x00007fa518849800 nid=0x15f7 runnable [0x00007fa5076c3000]\n   java.lang.Thread.State: RUNNABLE\n\tat java.io.FileInputStream.readBytes(Native Method)\n\tat java.io.FileInputStream.read(FileInputStream.java:255)\n\tat java.io.BufferedInputStream.read1(BufferedInputStream.java:284)\n\tat java.io.BufferedInputStream.read(BufferedInputStream.java:345)\n\t- locked <0x00000000c6dc9c50> (a java.lang.UNIXProcess$ProcessPipeInputStream)\n\tat sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)\n\tat sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)\n\tat sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)\n\t- locked <0x00000000c6dc9c78> (a java.io.InputStreamReader)\n\tat java.io.InputStreamReader.read(InputStreamReader.java:184)\n\tat java.io.BufferedReader.fill(BufferedReader.java:161)\n\tat java.io.BufferedReader.read1(BufferedReader.java:212)\n\tat java.io.BufferedReader.read(BufferedReader.java:286)\n\t- locked <0x00000000c6dc9c78> (a java.io.InputStreamReader)\n\tat org.apache.hadoop.util.Shell$ShellCommandExecutor.parseExecResult(Shell.java:786)\n\tat org.apache.hadoop.util.Shell.runCommand(Shell.java:568)\n\tat org.apache.hadoop.util.Shell.run(Shell.java:479)\n\tat org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:773)\n\tat org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.startLocalizer(LinuxContainerExecutor.java:237)\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.ResourceLocalizationService$LocalizerRunner.run(ResourceLocalizationService.java:1113)\n\n{code}\n\nI did a {code}ps aux{code} and confirmed that there was no container-executor process running with INITIALIZE_CONTAINER that the localizer starts. It seems that the output stream pipe of the process is still not closed (even though the localizer process is no longer present).\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341436","id":"12341436","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341762","id":"12341762","description":"2.9.1 release","name":"2.9.1","archived":false,"released":true,"releaseDate":"2018-05-03"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12895888","id":"12895888","filename":"YARN-6078.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-03T16:57:19.460+0000","size":2199,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12895888/YARN-6078.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12896785","id":"12896785","filename":"YARN-6078.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-09T01:48:16.692+0000","size":9601,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12896785/YARN-6078.002.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12897100","id":"12897100","filename":"YARN-6078.003.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-10T15:37:19.931+0000","size":9752,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12897100/YARN-6078.003.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12897419","id":"12897419","filename":"YARN-6078-branch-2.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-14T01:34:23.349+0000","size":10004,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12897419/YARN-6078-branch-2.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Containers stuck in Localizing state","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jagadish1989%40gmail.com","name":"jagadish1989@gmail.com","key":"jagadish1989@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jagadish","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jagadish1989%40gmail.com","name":"jagadish1989@gmail.com","key":"jagadish1989@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jagadish","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/15814343","id":"15814343","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Naganarasimha","name":"Naganarasimha","key":"naganarasimha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naganarasimha G R","active":true,"timeZone":"Asia/Kolkata"},"body":"version ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Naganarasimha","name":"Naganarasimha","key":"naganarasimha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naganarasimha G R","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-01-10T08:40:01.249+0000","updated":"2017-01-10T08:40:01.249+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/15960466","id":"15960466","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Feng+Yuan","name":"Feng Yuan","key":"feng yuan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=feng+yuan&avatarId=29897","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=feng+yuan&avatarId=29897","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=feng+yuan&avatarId=29897","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=feng+yuan&avatarId=29897"},"displayName":"Feng Yuan","active":true,"timeZone":"Etc/UTC"},"body":"The NM stack trace seem indicate the localizerRunner thread stuck at the read pipe from process stdout.\nCan you make sure the container-localizer process have start?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Feng+Yuan","name":"Feng Yuan","key":"feng yuan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=feng+yuan&avatarId=29897","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=feng+yuan&avatarId=29897","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=feng+yuan&avatarId=29897","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=feng+yuan&avatarId=29897"},"displayName":"Feng Yuan","active":true,"timeZone":"Etc/UTC"},"created":"2017-04-07T08:21:11.593+0000","updated":"2017-04-07T08:21:11.593+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16235308","id":"16235308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Prabhu+Joseph","name":"Prabhu Joseph","key":"prabhu joseph","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prabhu Joseph","active":true,"timeZone":"Etc/UTC"},"body":"We have hit this issue recently. Below are the analysis\r\n\r\nWhen the NodeManager is overloaded and ContainerLocalizer processes are hanging, the containers will timeout and cleaned up. The LocalizerRunner thread will be interrupted during cleanup but the interrupt does not work when it is reading from FileInputStream. LocalizerRunner threads and ContainerLocalizer process keeps on accumulating which makes the node completely unresponsive. \r\n\r\nThere are below options which will help to avoid this:\r\n\r\n1. ShellCommandExecutor parseExecResult currently uses blocking read() which can be changed into below to use non blocking available() + sleep for some time.\r\n\r\n{code}\r\nwhile(running)\r\n{\r\n    if(in.available() > 0)\r\n    {\r\n        n = in.read(buffer);\r\n        //do stuff with the buffer\r\n    }\r\n    else\r\n    {\r\n        Thread.sleep(500);\r\n    }\r\n}\r\n{code}\r\n\r\n2. Add a timeout for shell command similar to HADOOP-13817, timeout value can be set by AM same as container timeout.\r\n\r\n\r\nContainerLocalizer JVM stacktrace:\r\n\r\n{code}\r\n\"main\" #1 prio=5 os_prio=0 tid=0x00007fd8ec019000 nid=0xc295 runnable [0x00007fd8f3956000]\r\n   java.lang.Thread.State: RUNNABLE\r\n\tat java.util.zip.ZipFile.open(Native Method)\r\n\tat java.util.zip.ZipFile.<init>(ZipFile.java:219)\r\n\tat java.util.zip.ZipFile.<init>(ZipFile.java:149)\r\n\tat java.util.jar.JarFile.<init>(JarFile.java:166)\r\n\tat java.util.jar.JarFile.<init>(JarFile.java:103)\r\n\tat sun.misc.URLClassPath$JarLoader.getJarFile(URLClassPath.java:893)\r\n\tat sun.misc.URLClassPath$JarLoader.access$700(URLClassPath.java:756)\r\n\tat sun.misc.URLClassPath$JarLoader$1.run(URLClassPath.java:838)\r\n\tat sun.misc.URLClassPath$JarLoader$1.run(URLClassPath.java:831)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat sun.misc.URLClassPath$JarLoader.ensureOpen(URLClassPath.java:830)\r\n\tat sun.misc.URLClassPath$JarLoader.<init>(URLClassPath.java:803)\r\n\tat sun.misc.URLClassPath$3.run(URLClassPath.java:530)\r\n\tat sun.misc.URLClassPath$3.run(URLClassPath.java:520)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat sun.misc.URLClassPath.getLoader(URLClassPath.java:519)\r\n\tat sun.misc.URLClassPath.getLoader(URLClassPath.java:492)\r\n\t- locked <0x000000076ac75058> (a sun.misc.URLClassPath)\r\n\tat sun.misc.URLClassPath.getNextLoader(URLClassPath.java:457)\r\n\t- locked <0x000000076ac75058> (a sun.misc.URLClassPath)\r\n\tat sun.misc.URLClassPath.getResource(URLClassPath.java:211)\r\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:365)\r\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:362)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:361)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\r\n\t- locked <0x000000076ac7f960> (a java.lang.Object)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\r\n\tat sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:495)\r\n{code}\r\n\r\nNodeManager LocalizerRunner thread which is not interrupted:\r\n\r\n{code}\r\n\"LocalizerRunner for container_e746_1508665985104_601806_01_000005\" #3932753 prio=5 os_prio=0 tid=0x00007fb258d5f800 nid=0x11091 runnable [0x00007fb153946000]\r\n   java.lang.Thread.State: RUNNABLE\r\n        at java.io.FileInputStream.readBytes(Native Method)\r\n        at java.io.FileInputStream.read(FileInputStream.java:255)\r\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:284)\r\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:345)\r\n        - locked <0x0000000718502b80> (a java.lang.UNIXProcess$ProcessPipeInputStream)\r\n        at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)\r\n        at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)\r\n        at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)\r\n        - locked <0x0000000718502bd8> (a java.io.InputStreamReader)\r\n        at java.io.InputStreamReader.read(InputStreamReader.java:184)\r\n        at java.io.BufferedReader.fill(BufferedReader.java:161)\r\n        at java.io.BufferedReader.read1(BufferedReader.java:212)\r\n        at java.io.BufferedReader.read(BufferedReader.java:286)\r\n        - locked <0x0000000718502bd8> (a java.io.InputStreamReader)\r\n        at org.apache.hadoop.util.Shell$ShellCommandExecutor.parseExecResult(Shell.java:1155)\r\n        at org.apache.hadoop.util.Shell.runCommand(Shell.java:930)\r\n        at org.apache.hadoop.util.Shell.run(Shell.java:848)\r\n        at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:1142)\r\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.linux.privileged.PrivilegedOperationExecutor.executePrivilegedOperation(PrivilegedOperationExecutor.java:151)\r\n        at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.startLocalizer(LinuxContainerExecutor.java:264)\r\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.ResourceLocalizationService$LocalizerRunner.run(ResourceLocalizationService.java:1114)\r\nNM log shows the LocalizerRunner is suppose to \r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Prabhu+Joseph","name":"Prabhu Joseph","key":"prabhu joseph","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prabhu Joseph","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-02T07:18:41.503+0000","updated":"2017-11-02T07:18:41.503+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16237879","id":"16237879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"I found an additional option, which is to destroy the child process as enabled by YARN-5641 and HADOOP-13709.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-03T16:41:14.210+0000","updated":"2017-11-03T16:41:14.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16238113","id":"16238113","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  9m 44s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 16m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 48s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 21s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 37s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m 43s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 50s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 21s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 31s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 44s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 44s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 16s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 28s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m  6s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 51s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 19s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 16m  0s{color} | {color:green} hadoop-yarn-server-nodemanager in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 21s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 70m 35s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |\r\n| JIRA Issue | YARN-6078 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12895888/YARN-6078.001.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux d9dc69378b78 3.13.0-123-generic #172-Ubuntu SMP Mon Jun 26 18:04:35 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / c417284 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_131 |\r\n| findbugs | v3.1.0-RC1 |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18339/testReport/ |\r\n| Max. process+thread count | 335 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18339/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-03T18:12:43.631+0000","updated":"2017-11-03T18:12:43.631+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16240548","id":"16240548","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"body":"Thank you [~Prabhu Joseph] for analysis\r\n\r\n  [~billie.rinaldi]  \r\nOver all approach looks good to me. Additional options by YARN-5641 should help in solving the issue.\r\nIs it possible to add testcase in {{TestResourceLocalizationService}} for the same. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-11-06T16:50:40.787+0000","updated":"2017-11-06T16:50:40.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16245099","id":"16245099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"In the new patch I have added a unit test. I also discovered an issue with the previous patch, which is that if destroying the child shell causes the LocalizerRunner run method to reach its finally block before the subsequent super.interrupt() occurs, the interrupt may prevent the rest of the cleanup from being performed. The new patch only propagates the interrupt when a shell hasn't successfully been destroyed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-09T01:55:10.024+0000","updated":"2017-11-09T01:55:10.024+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16245153","id":"16245153","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (/) *{color:green}+1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 17m  7s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 18m 24s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 56s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 22s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m 37s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 58s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 23s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 33s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 53s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 53s{color} | {color:green} the patch passed {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 23s{color} | {color:orange} hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager: The patch generated 1 new + 214 unchanged - 0 fixed = 215 total (was 214) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 30s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m  5s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 19s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 17m  3s{color} | {color:green} hadoop-yarn-server-nodemanager in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 19s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 81m 24s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |\r\n| JIRA Issue | YARN-6078 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12896785/YARN-6078.002.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 6dd257586488 3.13.0-123-generic #172-Ubuntu SMP Mon Jun 26 18:04:35 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / f2df6b8 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-YARN-Build/18414/artifact/out/diff-checkstyle-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-nodemanager.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18414/testReport/ |\r\n| Max. process+thread count | 321 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18414/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-09T03:23:23.673+0000","updated":"2017-11-09T03:23:23.673+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16246713","id":"16246713","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djp","name":"djp","key":"djp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=djp&avatarId=16954","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=djp&avatarId=16954","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=djp&avatarId=16954","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=djp&avatarId=16954"},"displayName":"Junping Du","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~billie.rinaldi] for updating the patch! A quick question here:\r\nbq. The new patch only propagates the interrupt when a shell hasn't successfully been destroyed.\r\nWhat's impact for {{super.interrupt();}} in case shell process get destroyed? Like you said, it may prevent the rest of the cleanup from being performed for process destroying. Any side effect if we totally skip this?\r\n\r\nOther than this question, the patch looks good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djp","name":"djp","key":"djp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=djp&avatarId=16954","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=djp&avatarId=16954","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=djp&avatarId=16954","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=djp&avatarId=16954"},"displayName":"Junping Du","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-11-09T22:52:33.355+0000","updated":"2017-11-09T22:52:33.355+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16246741","id":"16246741","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"Thanks for taking a look, [~djp]! This is a good question. As far as I can tell, the purpose of the interrupt is to end the LocalizerRunner thread. I have not been able to think of a case where this wouldn't be accomplished by destroying the shell. But in the case where there is no shell found, I think it is safer to keep the interrupt. Perhaps there could be a situation where the LocalizerRunner is interrupted before the shell has been executed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-09T23:07:18.333+0000","updated":"2017-11-09T23:07:18.333+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16247029","id":"16247029","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"body":"Thank you [~billie.rinaldi] for explanation\r\n\r\nSome minor comments:\r\n\r\n# Since we have only one shell instance per {{LocalizerRunner}}  we can break the loop once condition is met.\r\n{code}\r\n1197\t        for (Shell shell : Shell.getAllShells()) {\r\n1198\t          try {\r\n1199\t            if (shell.getProcess() != null &&\r\n1200\t                shell.getWaitingThread() != null &&\r\n1201\t                shell.getWaitingThread().equals(this)) {\r\n1202\t              LOG.info(\"Destroying shell process for \" + localizerId);\r\n1203\t              shell.getProcess().destroy();\r\n1204\t              destroyedShell = true;\r\n1205\t            }\r\n1206\t          } catch (Exception e) {\r\n1207\t            LOG.warn(\"Failed to destroy shell for \" + localizerId, e);\r\n1208\t          }\r\n1209\t        }\r\n{code}\r\n# Thoughts on  double check of {{shell.getProcess().isAlive()}} too in condition ? \r\n#  Since {{localizerId}} is same as  containerId better to change log to  {{Destroying localization shell process for + localizerId}}\r\n{code}\r\n       LOG.info(\"Destroying shell process for \" + localizerId);\r\n{code}\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-11-10T05:26:58.128+0000","updated":"2017-11-10T05:26:58.128+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16247665","id":"16247665","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"Thanks for the review, [~bibinchundatt]! Those are good suggestions. I'm attaching patch 003 that includes the new changes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-10T15:42:00.039+0000","updated":"2017-11-10T15:42:00.039+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16248322","id":"16248322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (/) *{color:green}+1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 21m 20s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 53s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 22s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m 46s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 54s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 25s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 36s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 51s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 51s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 19s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 31s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m 59s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 20s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 16m 47s{color} | {color:green} hadoop-yarn-server-nodemanager in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 21s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 67m 13s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |\r\n| JIRA Issue | YARN-6078 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12897100/YARN-6078.003.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 5c30e908abfd 3.13.0-117-generic #164-Ubuntu SMP Fri Apr 7 11:05:26 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 796a0d3 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18438/testReport/ |\r\n| Max. process+thread count | 336 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18438/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-11T04:32:43.620+0000","updated":"2017-11-11T04:32:43.620+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16249109","id":"16249109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"body":"Thank you [~billie.rinaldi] for latest patch\r\n\r\n+1 LGTM for latest patch.\r\n[~djp] Any comments from your side?. I will wait for  1-2 days more before commit .","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-11-13T05:07:13.392+0000","updated":"2017-11-13T05:07:13.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16250478","id":"16250478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djp","name":"djp","key":"djp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=djp&avatarId=16954","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=djp&avatarId=16954","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=djp&avatarId=16954","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=djp&avatarId=16954"},"displayName":"Junping Du","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks [~bibinchundatt] for review and comments. +1 on 03 patch as well. Bump up the priority to critical given we have hit this problem with serious impact. Committing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djp","name":"djp","key":"djp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=djp&avatarId=16954","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=djp&avatarId=16954","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=djp&avatarId=16954","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=djp&avatarId=16954"},"displayName":"Junping Du","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-11-13T23:22:45.306+0000","updated":"2017-11-13T23:22:45.306+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16250505","id":"16250505","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #13232 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/13232/])\nYARN-6078. Containers stuck in Localizing state. Contributed by Billie (junping_du: rev e14f03dfbf078de63126a1e882261081b9ec6778)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceLocalizationService.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-13T23:46:02.891+0000","updated":"2017-11-13T23:46:02.891+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16250643","id":"16250643","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"Process#isAlive doesn't exist in Java 1.7, so we need a different method for branch-2.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-11-14T01:35:43.807+0000","updated":"2017-11-14T01:35:43.807+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16250704","id":"16250704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (/) *{color:green}+1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 25m  1s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} branch-2 Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  9m 16s{color} | {color:green} branch-2 passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 43s{color} | {color:green} branch-2 passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 18s{color} | {color:green} branch-2 passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 32s{color} | {color:green} branch-2 passed {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 55s{color} | {color:green} branch-2 passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 22s{color} | {color:green} branch-2 passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 29s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 41s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 41s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 17s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 30s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 18s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 16m  3s{color} | {color:green} hadoop-yarn-server-nodemanager in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 19s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 57m 44s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:17213a0 |\r\n| JIRA Issue | YARN-6078 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12897419/YARN-6078-branch-2.001.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 07c4c29dc783 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | branch-2 / f894eef |\r\n| maven | version: Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-10T16:41:47+00:00) |\r\n| Default Java | 1.7.0_151 |\r\n| findbugs | v3.0.0 |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18471/testReport/ |\r\n| Max. process+thread count | 156 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18471/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-14T02:40:53.906+0000","updated":"2017-11-14T02:40:53.906+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16251928","id":"16251928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm resolving this for release notes generation, please reopen if you need another precommit run.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-11-14T18:46:18.911+0000","updated":"2017-11-14T18:46:18.911+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16252163","id":"16252163","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djp","name":"djp","key":"djp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=djp&avatarId=16954","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=djp&avatarId=16954","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=djp&avatarId=16954","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=djp&avatarId=16954"},"displayName":"Junping Du","active":true,"timeZone":"Asia/Shanghai"},"body":"+1 on branch-2 patch. I have commit the patch to trunk, branch-3.0, branch-2 and branch-2.9. Thanks [~billie.rinaldi] for the patch and [~bibinchundatt] for review!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djp","name":"djp","key":"djp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=djp&avatarId=16954","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=djp&avatarId=16954","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=djp&avatarId=16954","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=djp&avatarId=16954"},"displayName":"Junping Du","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-11-14T20:53:35.180+0000","updated":"2017-11-14T20:53:35.180+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16280984","id":"16280984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"[~bibinchundatt] [~djp] It should be noted that the LocalizerRunner thread in the NM will not actually be able to kill the ContainerLocalizer shell process, because it is running as a different user. However, performing destroy on the process may still have some effect in the LocalizerRunner, since destroy may try to close the stdout/stderr streams in addition to attempting to kill the process.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2017-12-06T21:56:02.281+0000","updated":"2017-12-06T21:56:02.281+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16349585","id":"16349585","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"[~bibinchundatt] [~djp] I am planning to revert this commit in YARN-7873.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2018-02-02T00:35:04.034+0000","updated":"2018-02-02T00:35:04.034+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16351396","id":"16351396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"body":"[~billie.rinaldi] \r\n I think since the Jira is already gone in as part of 3.0.0  its better to raise another to fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bibinchundatt","name":"bibinchundatt","key":"bibinchundatt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bibinchundatt&avatarId=29912","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bibinchundatt&avatarId=29912","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bibinchundatt&avatarId=29912","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bibinchundatt&avatarId=29912"},"displayName":"Bibin A Chundatt","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-02-03T13:25:26.180+0000","updated":"2018-02-03T13:26:05.964+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16351420","id":"16351420","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"body":"Thanks [~bibinchundatt]. I've opened YARN-7873 for the revert. If you have any concerns, please comment there as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billie.rinaldi","name":"billie.rinaldi","key":"billie.rinaldi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billie.rinaldi&avatarId=30233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billie.rinaldi&avatarId=30233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billie.rinaldi&avatarId=30233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billie.rinaldi&avatarId=30233"},"displayName":"Billie Rinaldi","active":true,"timeZone":"America/New_York"},"created":"2018-02-03T15:47:35.080+0000","updated":"2018-02-03T15:47:35.080+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13033304/comment/16355646","id":"16355646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #13628 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/13628/])\nRevert \"YARN-6078. Containers stuck in Localizing state. Contributed by (billie: rev 266da25c048aef352cfc7306e44e4d62b21a9e8a)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceLocalizationService.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2018-02-07T16:10:14.560+0000","updated":"2018-02-07T16:10:14.560+0000"}],"maxResults":25,"total":25,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-6078/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i38hfz:"}}