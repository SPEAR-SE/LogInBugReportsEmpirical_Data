{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13017595","self":"https://issues.apache.org/jira/rest/api/2/issue/13017595","key":"YARN-5827","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2016-11-03T17:59:29.745+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Nov 21 14:37:16 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1567852384_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-11-21T14:38:24.004+0000","workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-5827/watchers","watchCount":6,"isWatching":false},"created":"2016-11-03T11:07:33.254+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":864000,"aggregatetimeoriginalestimate":864000,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329059","id":"12329059","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"}],"issuelinks":[{"id":"12487071","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12487071","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12928205","key":"YARN-4553","self":"https://issues.apache.org/jira/rest/api/2/issue/12928205","fields":{"summary":"Add cgroups support for docker containers","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-11-21T14:38:25.614+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319323","id":"12319323","name":"nodemanager"}],"timeoriginalestimate":864000,"description":"When I use DockerLinuxContainer, I found that the function of limiting cpu usage doesn't make effect. Because DockerLinuxContainer regard the exitCode of  \"docker inpsect\" as pid. But When I got this pid, the command of \"launch.sh\" has started, then we can't add the child process or threads into the cgroup, so the restrictions of cpu usage doesn't make effectã€‚","customfield_10010":null,"timetracking":{"originalEstimate":"240h","remainingEstimate":"240h","originalEstimateSeconds":864000,"remainingEstimateSeconds":864000},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":864000,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"DockerLinuxContainer can't limit the cpu usage","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":864000,"percent":0},"customfield_12311024":null,"environment":"CentOS7.1","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10430","value":"Patch","id":"10430"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10431","value":"Important","id":"10431"}],"progress":{"progress":0,"total":864000,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15633663","id":"15633663","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Cgroup support is already added via YARN-4553. Can this be closed as dup?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-11-03T17:59:29.745+0000","updated":"2016-11-03T17:59:29.745+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15680979","id":"15680979","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"body":"Thanks! I tried Yarn-4553! I think that's a reasonable way to solve this problem! But my docker only supports the name like \"xxx.slice\" as the parameter of \"--cgroup-parent\", and yarn will set the parameter of \"--cgroup-parent\" like \"--cgroup-parent=/hadoop-yarn/container_1479368276135_0020_02_000001\". So my YarnChild will report the following error:\nException message: docker: Error response from daemon: cgroup-parent for systemd cgroup should be a valid slice named as \"xxx.slice\".\n\nnotes: docker version is \nClient:\n Version:         1.10.3\n API version:     1.22\n Package version: docker-common-1.10.3-46.el7.centos.14.x86_64\n Go version:      go1.6.3\n Git commit:      cb079f6-unsupported\n Built:           Fri Sep 16 13:24:25 2016\n OS/Arch:         linux/amd64\n\nServer:\n Version:         1.10.3\n API version:     1.22\n Package version: docker-common-1.10.3-46.el7.centos.14.x86_64\n Go version:      go1.6.3\n Git commit:      cb079f6-unsupported\n Built:           Fri Sep 16 13:24:25 2016\n OS/Arch:         linux/amd64\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"created":"2016-11-20T11:08:45.262+0000","updated":"2016-11-20T11:08:45.262+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15681173","id":"15681173","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"body":"[~zhengchenyu] - It sounds like you are using systemd cgroup driver for docker. Systemd was the default in Docker 1.10/11 but was changed back to cgroupfs in 1.12 due to the many issues it caused. Can you try running docker with {{--exec-opt native.cgroupdriver=cgroupfs}} and see if that fixes the problem for you?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"created":"2016-11-20T13:39:59.383+0000","updated":"2016-11-20T13:39:59.383+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15682331","id":"15682331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"body":"Sorry, I reconfigurated and restarted docker by your way. still report \"systemd cgroup should be a valid slice named as \"xxx.slice\"\". It is necessary to ending with \"xxx.slice\". ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"created":"2016-11-21T03:04:36.095+0000","updated":"2016-11-21T03:04:36.095+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15683535","id":"15683535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"body":"Can you give me the steps you took to reconfigure docker? What does {{ps -ef | grep docker}} return? Do you see the exec-opt in the ps output? \n\n_systemd cgroup_ in the error output indicates that systemd is in use still, so it doesn't sound like docker was reconfigured correctly. Let me know the steps you took and I can try to advise.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"created":"2016-11-21T13:04:26.043+0000","updated":"2016-11-21T13:04:26.043+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15683593","id":"15683593","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"body":"Oh, my god! I found \"/usr/lib/systemd/system/docker.service\" has this option \"--exec-opt native.cgroupdriver=systemd \". I configured this file(/etc/sysconfig/docker) just now. Thank you for you advice, I reconfigure the file(/usr/lib/systemd/system/docker.service), then I can success!Thank you again! ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhengchenyu","name":"zhengchenyu","key":"zhengchenyu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhengchenyu","active":true,"timeZone":"Asia/Harbin"},"created":"2016-11-21T13:40:51.148+0000","updated":"2016-11-21T13:40:51.148+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13017595/comment/15683724","id":"15683724","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"body":"Great news, [~zhengchenyu] - I will go ahead and close this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shanekumpf%40gmail.com","name":"shanekumpf@gmail.com","key":"shanekumpf@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shane Kumpf","active":true,"timeZone":"America/Denver"},"created":"2016-11-21T14:37:16.571+0000","updated":"2016-11-21T14:37:16.571+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-5827/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i35sin:"}}