{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13178688","self":"https://issues.apache.org/jira/rest/api/2/issue/13178688","key":"YARN-8656","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12342758","id":"12342758","name":"3.2.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12343433","id":"12343433","description":"","name":"3.1.2","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2018-08-14T14:43:08.001+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Aug 16 15:33:02 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_62769028_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_179618767","customfield_12312321":null,"resolutiondate":"2018-08-16T15:16:04.377+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-8656/watchers","watchCount":5,"isWatching":false},"created":"2018-08-13T19:56:16.617+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["Docker"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-16T15:33:02.161+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"If cgroups are enabled, we pass the {{--cgroup-parent}} option to {{docker run}} to ensure that all processes for the container are placed into a cgroup under (for example) {{/sys/fs/cgroup/cpu/cgroups.hierarchy/container_id}}. Docker creates a cgroup there with the docker container id as the name and all of the processes in the container go into that cgroup.\r\n\r\ncontainer-executor has code in {{launch_docker_container_as_user()}} that then cherry-picks the PID of the docker container (usually the launch shell) and writes that into the {{/sys/fs/cgroup/cpu/cgroups.hierarchy/container_id/tasks}} file, effectively moving it from {{/sys/fs/cgroup/cpu/cgroups.hierarchy/container_id/docker_container_id}} to {{/sys/fs/cgroup/cpu/cgroups.hierarchy/container_id}}.  So you end up with one process out of the container in the {{container_id}} cgroup, and the rest in the {{container_id/docker_container_id}} cgroup.\r\n\r\nSince we are passing the {{--cgroup-parent}} to docker, there is no need to manually write the container pid to the tasks file - we can just remove the code that does this in the docker case.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12935538","id":"12935538","filename":"YARN-8656.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"created":"2018-08-14T13:22:14.716+0000","size":1446,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12935538/YARN-8656.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12935631","id":"12935631","filename":"YARN-8656.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"created":"2018-08-14T22:14:07.783+0000","size":10663,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12935631/YARN-8656.002.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"container-executor should not write cgroup tasks files for docker containers","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16579893","id":"16579893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 32s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 28m 53s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  1s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 38s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 41m 43s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 35s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 56s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  0m 56s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 56s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 33s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 12m 30s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 18m  8s{color} | {color:green} hadoop-yarn-server-nodemanager in the patch passed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 24s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 75m 52s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:ba1ab08 |\r\n| JIRA Issue | YARN-8656 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12935538/YARN-8656.001.patch |\r\n| Optional Tests |  asflicense  compile  cc  mvnsite  javac  unit  |\r\n| uname | Linux fa752e9d5c85 3.13.0-153-generic #203-Ubuntu SMP Thu Jun 14 08:52:28 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / d1830d8 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_171 |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/21596/testReport/ |\r\n| Max. process+thread count | 336 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/21596/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-14T14:43:08.001+0000","updated":"2018-08-14T14:43:08.001+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16579978","id":"16579978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"body":"I have tested this by running test-container-executor, cetest, and nodemanager unit tests.  I've also run some jobs on a single node cluster and manually verified that with Docker the single PID is no longer written to the {{/sys/fs/cgroup/cpu/cgroups.hierarchy/container_id/tasks}} file. All PIDs for the container appear in the {{/sys/fs/cgroup/cpu/cgroups.hierarchy/container_id/docker_container_id/tasks}} file, which is managed by docker.\r\n\r\nI do have one question: should I remove the resources_values argument from {{launch_docker_container_as_user()}}, since it is no longer used? Could also remove it from DockerLinuxContainerRuntime.buildLaunchOp().\r\n\r\n[~jlowe], [~ebadger], [~eyang], [~shanekumpf@gmail.com] - thoughts?\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"created":"2018-08-14T15:46:55.036+0000","updated":"2018-08-14T15:46:55.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16580007","id":"16580007","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Thanks for the patch!\r\n\r\nbq. should I remove the resources_values argument from launch_docker_container_as_user(), since it is no longer used? Could also remove it from DockerLinuxContainerRuntime.buildLaunchOp().\r\n\r\n+1 for that proposal.  I see no reason we would want to cherry-pick process IDs from the docker-created cgroup, especially when those processes are running asynchronously to the process trying to perform the migration.  I thought it might be useful for YARN-8648, but the cgroup parent argument is already passed by a separate mechanism.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2018-08-14T16:11:15.184+0000","updated":"2018-08-14T16:11:15.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16580562","id":"16580562","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 23s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 33m  6s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  5s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 15s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 12m 39s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  3s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 25s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 39s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 58s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} cc {color} | {color:green}  0m 58s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 58s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 11s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 35s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 12m 27s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 11s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 18m 33s{color} | {color:red} hadoop-yarn-server-nodemanager in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 27s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 85m 13s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.yarn.server.nodemanager.containermanager.TestContainerManager |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:ba1ab08 |\r\n| JIRA Issue | YARN-8656 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12935631/YARN-8656.002.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  cc  |\r\n| uname | Linux 5c32327fe2e7 3.13.0-153-generic #203-Ubuntu SMP Thu Jun 14 08:52:28 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 75fc515 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_171 |\r\n| findbugs | v3.1.0-RC1 |\r\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/21602/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-nodemanager.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/21602/testReport/ |\r\n| Max. process+thread count | 336 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/21602/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-15T00:06:30.288+0000","updated":"2018-08-15T00:06:30.288+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16581110","id":"16581110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"body":"I am unable to repro the unit test failure in TestContainerManager#testLocalingResourceWhileContainerRunning.   I don't think it is related to my change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jim_Brennan","name":"Jim_Brennan","key":"jim_brennan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10440","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10440","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10440","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10440"},"displayName":"Jim Brennan","active":true,"timeZone":"America/Chicago"},"created":"2018-08-15T14:02:47.147+0000","updated":"2018-08-15T14:02:47.147+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16582663","id":"16582663","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Thanks for updating the patch!\r\n\r\n+1 lgtm.  I agree the unit test failure appears to be unrelated, and I can get it to fail locally without this change.  Looks like something is asynchronously cleaning out a containers tokens just as a new localizer starts.  I filed YARN-8672 to track the issue.\r\n\r\nCommitting this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2018-08-16T15:04:56.819+0000","updated":"2018-08-16T15:04:56.819+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16582682","id":"16582682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Thanks, [~Jim_Brennan]!  I committed this to trunk and branch-3.1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2018-08-16T15:16:04.400+0000","updated":"2018-08-16T15:16:04.400+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13178688/comment/16582707","id":"16582707","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #14782 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/14782/])\nYARN-8656. container-executor should not write cgroup tasks files for (jlowe: rev cb21eaa026d80a2c9836030d959c0dd7f87c4d6b)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/linux/runtime/DockerLinuxContainerRuntime.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/native/container-executor/impl/container-executor.c\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/native/container-executor/impl/main.c\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/native/container-executor/impl/container-executor.h\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/linux/runtime/TestDockerContainerRuntime.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-16T15:33:02.161+0000","updated":"2018-08-16T15:33:02.161+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-8656/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3x03j:"}}