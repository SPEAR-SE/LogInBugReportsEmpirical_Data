{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12664200","self":"https://issues.apache.org/jira/rest/api/2/issue/12664200","key":"YARN-1076","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2013-08-20T01:10:09.669+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Aug 23 20:54:12 UTC 2013","customfield_12310420":"344201","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_538768065_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-08-23T20:54:48.076+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-1076/watchers","watchCount":4,"isWatching":false},"created":"2013-08-17T15:15:20.042+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12374285","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12374285","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12659426","key":"YARN-957","self":"https://issues.apache.org/jira/rest/api/2/issue/12659426","fields":{"summary":"Capacity Scheduler tries to reserve the memory more than what node manager reports.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-08-23T20:54:48.092+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319322","id":"12319322","name":"resourcemanager"}],"timeoriginalestimate":null,"description":"LeafQueue#assignToQueue rejects newly available containers if potentialNewCapacity > absoluteMaxCapacity:\n{code:java}\n  private synchronized boolean assignToQueue(Resource clusterResource, \n      Resource required) {\n    // Check how of the cluster's absolute capacity we are currently using...\n    float potentialNewCapacity = \n        Resources.divide(\n            resourceCalculator, clusterResource, \n            Resources.add(usedResources, required), \n            clusterResource);\n    if (potentialNewCapacity > absoluteMaxCapacity) {\n      //... \n      return false;\n    }\n    return true;\n  }\n{code}\n\nThe usedResources, which is used to computed potentialNewCapacity, is composed of both actual and reserved containers. So, a prior reservation could causes RM to reject newly available containers, despite the starvation report.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12599121","id":"12599121","filename":"YARN-1076.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-21T06:05:11.550+0000","size":4898,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12599121/YARN-1076.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"344501","customfield_12312823":null,"summary":"RM gets stuck with a reservation, ignoring new containers","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12664200/comment/13744583","id":"13744583","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~maysamyabandeh] did you see this issue by code walk through? or you faced this in your cluster? related YARN-957 ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-20T01:10:09.669+0000","updated":"2013-08-20T01:10:09.669+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12664200/comment/13744683","id":"13744683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~ojoshi]. I am observing the problem with a unit test using MiniYarnCluster. The explanation however is based solely on code walk through. I did not submit the test case since the problem did not always show up--due to the non-determinism in MiniYarnCluster.\n\nAnyway, I see that you have already covered that in the objectives of YARN-957:\n\n| Say 2048MB is reserved on nm1 but nm2 comes back with 2048MB available memory. In this case if the original request was made without any locality then scheduler should unreserve memory on nm1 and allocate requested 2048MB container on nm2.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-20T04:06:59.614+0000","updated":"2013-08-20T04:06:59.614+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12664200/comment/13744690","id":"13744690","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"body":"if it is similar then we can close it as duplicate.. can you try patch YARN-957 locally and see if it fixes your problem too?? thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-20T04:19:38.727+0000","updated":"2013-08-20T04:19:38.727+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12664200/comment/13745809","id":"13745809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"body":"I am attaching a unit test that shows the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-21T06:05:11.553+0000","updated":"2013-08-21T06:05:11.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12664200/comment/13745817","id":"13745817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ojoshi], I applied the latest patch of YARN-957 and it makes the unit test pass. So, I guess we can close this jira since YARN-957 is already taking care of it.\n\nI also attached the new unit test just for the record. I also updated the jira description based on the scenario in which the unit test fails.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maysamyabandeh","name":"maysamyabandeh","key":"maysamyabandeh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maysamyabandeh&avatarId=17671","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maysamyabandeh&avatarId=17671","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maysamyabandeh&avatarId=17671","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maysamyabandeh&avatarId=17671"},"displayName":"Maysam Yabandeh","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-21T06:15:31.770+0000","updated":"2013-08-21T06:15:31.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12664200/comment/13748978","id":"13748978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~maysamyabandeh] . Will close it as a duplicate.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ojoshi","name":"ojoshi","key":"ojoshi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ojoshi&avatarId=16634","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ojoshi&avatarId=16634","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ojoshi&avatarId=16634","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ojoshi&avatarId=16634"},"displayName":"Omkar Vinit Joshi","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-08-23T20:54:12.179+0000","updated":"2013-08-23T20:54:12.179+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-1076/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1ncvz:"}}