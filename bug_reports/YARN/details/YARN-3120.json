{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12771411","self":"https://issues.apache.org/jira/rest/api/2/issue/12771411","key":"YARN-3120","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-01-31T04:59:14.990+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jun 06 11:36:19 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-3120/watchers","watchCount":7,"isWatching":false},"created":"2015-01-30T19:33:56.276+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327197","id":"12327197","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-06-06T11:36:19.139+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Hi,\n\nI tried to follow the instructiosn in http://wiki.apache.org/hadoop/Hadoop2OnWindows and have setup hadoop-2.6.0.jar in my windows system.\n\nI was able to start everything properly but when i try to run the job wordcount as given in the above URL , the job fails with the below exception .\n15/01/30 12:56:09 INFO localizer.ResourceLocalizationService: Localizer failed\norg.apache.hadoop.yarn.exceptions.YarnRuntimeException: Failed to setup local di\nr /tmp/hadoop-haremangala/nm-local-dir, which was marked as good.\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.\nResourceLocalizationService.getInitializedLocalDirs(ResourceLocalizationService.\njava:1372)\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.\nResourceLocalizationService.access$900(ResourceLocalizationService.java:137)\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.\nResourceLocalizationService$LocalizerRunner.run(ResourceLocalizationService.java\n:1085)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"YarnException on windows + org.apache.hadoop.yarn.exceptions.YarnRuntimeException: Failed to setup local dirnm-local-dir, which was marked as good.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Pranatharthiharan","name":"Pranatharthiharan","key":"pranatharthiharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"vaidhyanathan","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Pranatharthiharan","name":"Pranatharthiharan","key":"pranatharthiharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"vaidhyanathan","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows 8 , Hadoop 2.6.0","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771411/comment/14299111","id":"14299111","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Pranatharthiharan","name":"Pranatharthiharan","key":"pranatharthiharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"vaidhyanathan","active":true,"timeZone":"Etc/UTC"},"body":"I tried to change the folder permission for nmprivate manually by using chmod 700 as its expecting but the issue doesnt see to be resolved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Pranatharthiharan","name":"Pranatharthiharan","key":"pranatharthiharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"vaidhyanathan","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-30T19:34:48.286+0000","updated":"2015-01-30T19:34:48.286+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771411/comment/14299677","id":"14299677","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"Are you running everything on your install drive(C:)? Windows has special security permissions on the install drive. Try creating another partition and set the local dirs on that partition.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-01-31T04:59:14.990+0000","updated":"2015-01-31T04:59:14.990+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771411/comment/14309867","id":"14309867","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Pranatharthiharan","name":"Pranatharthiharan","key":"pranatharthiharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"vaidhyanathan","active":true,"timeZone":"Etc/UTC"},"body":"Hi Varun,\n\nThanks for responding. I started running the yarn cmd files by running as administrator and it worked . Also i opened the command prompt and ran it in the administrator mode.\n\nThe word count example worked fine for the first time but now im facing a different issue , When i run it now with the earlier setup , job doesnt proceed after this step '15/02/06 15:38:26 INFO mapreduce.Job: Running job: job_1423255041751_0001' and when i check the consolde the status is 'Accepted' and the final status is 'Undefined'","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Pranatharthiharan","name":"Pranatharthiharan","key":"pranatharthiharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"vaidhyanathan","active":true,"timeZone":"Etc/UTC"},"created":"2015-02-06T20:41:24.595+0000","updated":"2015-02-06T20:41:24.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771411/comment/15128253","id":"15128253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kumarlearner","name":"kumarlearner","key":"kumarlearner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"kumar ranganathan","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\nI have facing the same problem in Hadoop-2.7.2 in Windows. I have found the logs in nodemanager as below and it should be the actual root cause\n\n{panel}\nWARN localizer.ResourceLocalizationService: Failed to setup local dir /tmp/hadoop-SYSTEM/nm-local-dir, which was marked as good.\norg.apache.hadoop.yarn.exceptions.YarnRuntimeException: Permissions incorrectly set for dir /tmp/hadoop-SYSTEM/nm-local-dir/usercache, should be rwxr-xr-x, actual value = rwxrwxr-x\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.ResourceLocalizationService.checkLocalDir(ResourceLocalizationService.java:1443)\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.ResourceLocalizationService.getInitializedLocalDirs(ResourceLocalizationService.java:1410)\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.ResourceLocalizationService.access$800(ResourceLocalizationService.java:140)\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.ResourceLocalizationService$LocalizerRunner.run(ResourceLocalizationService.java:1110)\n16/02/02 18:50:45 INFO localizer.ResourceLocalizationService: Localizer failed\norg.apache.hadoop.yarn.exceptions.YarnRuntimeException: Failed to setup local dir /tmp/hadoop-SYSTEM/nm-local-dir, which was marked as good.\n{panel}\n\nI found another jira task related to this issue\n[https://issues.apache.org/jira/browse/YARN-3962]\n\nEven though i applied patch, the problem isn't resolved. So i have changed the code manually by commenting the condition check as below,\n\n{code:title=ResourceLocalizationService.java|borderStyle=solid}\nprivate boolean checkLocalDir(String localDir) {\n\n    Map<Path, FsPermission> pathPermissionMap = getLocalDirsPathPermissionsMap(localDir);\n\n    for (Map.Entry<Path, FsPermission> entry : pathPermissionMap.entrySet()) {\n      FileStatus status;\n      try {\n        status = lfs.getFileStatus(entry.getKey());\n      } catch (Exception e) {\n        String msg =\n            \"Could not carry out resource dir checks for \" + localDir\n                + \", which was marked as good\";\n        LOG.warn(msg, e);\n        throw new YarnRuntimeException(msg, e);\n      }\n\n//      if (!status.getPermission().equals(entry.getValue())) {\n//        String msg =\n//            \"Permissions incorrectly set for dir \" + entry.getKey()\n//                + \", should be \" + entry.getValue() + \", actual value = \"\n//                + status.getPermission();\n//        LOG.warn(msg);\n//        throw new YarnRuntimeException(msg);\n//      }\n    }\n    return true;\n  }\n{code}\n\nNow it works fine without any issue. It seems we can ignore this condition for virtual account in windows.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kumarlearner","name":"kumarlearner","key":"kumarlearner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"kumar ranganathan","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-02T13:35:23.863+0000","updated":"2016-02-02T13:35:23.863+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771411/comment/16038679","id":"16038679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aksonkar%40gmail.com","name":"aksonkar@gmail.com","key":"aksonkar@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Animesh Sonkar","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\nI had setup hadoop 2.8.0 an using the steps mentioned in hadoop2onwindows wiki, was trying to setup the same.\nI am facing the same issue.\nI do not have the source and cant make changes as done by kumar ranganathan. I just want to get the setup working to learn hadoop.\nWas this fixed in 2.8.0? Id there any workaround available other than changing the source?\n\nI tried changing permissions of the dir for domain users and Administrators in windows, but it did not work.\n\nThanks,\nAnimesh Kumar Sonkar","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aksonkar%40gmail.com","name":"aksonkar@gmail.com","key":"aksonkar@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Animesh Sonkar","active":true,"timeZone":"Etc/UTC"},"created":"2017-06-06T11:36:19.139+0000","updated":"2017-06-06T11:36:19.139+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-3120/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i250tb:"}}