{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12909002","self":"https://issues.apache.org/jira/rest/api/2/issue/12909002","key":"YARN-4319","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2015-10-29T19:14:44.373+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Oct 29 20:32:34 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_5008460_*|*_4_*:*_1_*:*_26239_*|*_5_*:*_2_*:*_246773","customfield_12312321":null,"resolutiondate":"2015-10-29T20:33:00.285+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-4319/watchers","watchCount":3,"isWatching":false},"created":"2015-10-29T19:04:58.837+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["newbie"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12331976","id":"12331976","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-29T20:33:00.306+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319323","id":"12319323","name":"nodemanager"}],"timeoriginalestimate":null,"description":"When the file indicated in yarn.resourcemanager.nodes.include-path is nor empty, the resource manager decommision all the nodemanagers\n\n{{2015-10-29 18:51:51,900 INFO org.apache.hadoop.util.HostsFileReader: Setting the includes file to /opt/yarn/hadoop/etc/hadoop/yarn.include}}\n{{2015-10-29 18:51:51,900 INFO org.apache.hadoop.util.HostsFileReader: Setting the excludes file to /opt/yarn/hadoop/etc/hadoop/yarn.exclude}}\n{{2015-10-29 18:51:51,900 INFO org.apache.hadoop.util.HostsFileReader: Refreshing hosts (include/exclude) list}}\n{{2015-10-29 18:51:51,900 INFO org.apache.hadoop.util.HostsFileReader: Adding a to the list of included hosts from /opt/yarn/hadoop/etc/hadoop/yarn.include}}\n{{2015-10-2918:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.RMAuditLogger: USER=hdmaster IP=10.0.0.10 OPERATION=refreshNodes TARGET=AdminService RESULT=SUCCESS}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: Deactivating Node ip-10-0-0-106.ec2.internal:33747 as it is now DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: ip-10-0-0-106.ec2.internal:33747 Node Transitioned from RUNNING to DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: Deactivating Node ip-10-0-0-105.ec2.internal:57257 as it is now DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: ip-10-0-0-105.ec2.internal:57257 Node Transitioned from RUNNING to DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: Deactivating Node ip-10-0-0-104.ec2.internal:48645 as it is now DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: ip-10-0-0-104.ec2.internal:48645 Node Transitioned from RUNNING to DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: Deactivating Node ip-10-0-0-107.ec2.internal:33115 as it is now DECOMMISSIONED}}\n{{2015-10-29 18:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeImpl: ip-10-0-0-107.ec2.internal:33115 Node Transitioned from RUNNING to DECOMMISSIONED}}\n{{2015-10-29 18:51:51,902 INFO org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler: Removed node ip-10-0-0-106.ec2.internal:33747 clusterResource: <memory:9216, vCores:3>}}\n{{2015-10-29 18:51:51,902 INFO org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler: Removed node ip-10-0-0-105.ec2.internal:57257 clusterResource: <memory:6144, vCores:2>}}\n{{2015-10-29 18:51:51,902 INFO org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler: Removed node ip-10-0-0-104.ec2.internal:48645 clusterResource: <memory:3072, vCores:1>}}\n{{2015-10-29 18:51:51,902 INFO org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler: Removed node ip-10-0-0-107.ec2.internal:33115 clusterResource: <memory:0, vCores:0>}}\n{{2015-10-29 18:51:52,006 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService: Disallowed NodeManager nodeId: ip-10-0-0-105.ec2.internal:57257 hostname: ip-10-0-0-105.ec2.internal}}\n{{2015-10-29 18:51:52,683 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService: Disallowed NodeManager nodeId: ip-10-0-0-106.ec2.internal:33747 hostname: ip-10-0-0-106.ec2.internal}}\n{{2015-10-29 18:51:52,734 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService: Disallowed NodeManager nodeId: ip-10-0-0-107.ec2.internal:33115 hostname: ip-10-0-0-107.ec2.internal}}\n{{2015-10-29 18:51:52,891 INFO org.apache.hadoop.yarn.server.resourcemanager.ResourceTrackerService: Disallowed NodeManager nodeId: ip-10-0-0-104.ec2.internal:48645 hostname: ip-10-0-0-104.ec2.internal}}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Nodemanagers are decommissioned when the the list of included hosts is not empty","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tarabelo","name":"tarabelo","key":"tarabelo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomas F. Pena","active":true,"timeZone":"Europe/Madrid"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tarabelo","name":"tarabelo","key":"tarabelo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomas F. Pena","active":true,"timeZone":"Europe/Madrid"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Hadoop 2.7.1\nAmazon Linux AMI 2015.09 (HVM)\njava version \"1.7.0_85\"\nOpenJDK Runtime Environment (amzn-2.6.1.3.61.amzn1-x86_64 u85-b01)\nOpenJDK 64-Bit Server VM (build 24.85-b03, mixed mode)\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12909002/comment/14981091","id":"14981091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"If the include list is provided it specifies the list of nodes that are allowed to participate in the cluster.  Any node not in that list is not allowed to register with the cluster, and any node actively part of the cluster that is not in that list will be decomissioned.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-10-29T19:14:44.373+0000","updated":"2015-10-29T19:14:44.373+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12909002/comment/14981133","id":"14981133","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tarabelo","name":"tarabelo","key":"tarabelo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomas F. Pena","active":true,"timeZone":"Europe/Madrid"},"body":"That is supposed to be. But when I put in the include list the name of the nodes and refresh with yarn rmadmin -refreshNodes all the nodemanagers in the list are immediately decommissioned.\n\n$ cat yarn.include\nip-10-0-0-104\nip-10-0-0-105\nip-10-0-0-106\nip-10-0-0-107\n$ yarn rmadmin -refreshNodes\n\nand the four running nodemanagers are killed.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tarabelo","name":"tarabelo","key":"tarabelo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomas F. Pena","active":true,"timeZone":"Europe/Madrid"},"created":"2015-10-29T19:45:12.348+0000","updated":"2015-10-29T19:45:12.348+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12909002/comment/14981149","id":"14981149","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Ah, it wasn't clear to me from the log above that the file had the nodes in the include list.  According to the log above, it only contained the line \"a\" per this log snippet:\n{noformat}\n2015-10-29 18:51:51,900 INFO org.apache.hadoop.util.HostsFileReader: Refreshing hosts (include/exclude) list\n2015-10-29 18:51:51,900 INFO org.apache.hadoop.util.HostsFileReader: Adding a to the list of included hosts from /opt/yarn/hadoop/etc/hadoop/yarn.include\n2015-10-2918:51:51,901 INFO org.apache.hadoop.yarn.server.resourcemanager.RMAuditLogger: USER=hdmaster IP=10.0.0.10 OPERATION=refreshNodes TARGET=AdminService RESULT=SUCCESS\n{noformat}\n\nI think you're include list should have qualified names like ip-10-0-0-106.ec2.internal instead of just ip-10-0-0-106.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-10-29T19:57:34.038+0000","updated":"2015-10-29T19:57:34.038+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12909002/comment/14981202","id":"14981202","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tarabelo","name":"tarabelo","key":"tarabelo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomas F. Pena","active":true,"timeZone":"Europe/Madrid"},"body":"Thank you! Using FQDM is working. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tarabelo","name":"tarabelo","key":"tarabelo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomas F. Pena","active":true,"timeZone":"Europe/Madrid"},"created":"2015-10-29T20:28:04.881+0000","updated":"2015-10-29T20:28:04.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12909002/comment/14981207","id":"14981207","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Reopening to fix resolution type.  Fixed is normally reserved for JIRAs that have corresponding code changes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-10-29T20:32:34.065+0000","updated":"2015-10-29T20:32:34.065+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-4319/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2nphj:"}}