{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12993350","self":"https://issues.apache.org/jira/rest/api/2/issue/12993350","key":"YARN-5445","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-08-04T11:13:59.081+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Sep 06 05:45:24 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-5445/watchers","watchCount":6,"isWatching":false},"created":"2016-07-28T20:03:38.789+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["oct16-easy"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12331976","id":"12331976","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-10-27T18:44:58.762+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12322905","id":"12322905","name":"log-aggregation","description":"Log aggregation feature"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12319323","id":"12319323","name":"nodemanager"}],"timeoriginalestimate":null,"description":"Log aggregation is enabled and configured to write applogs to different cluster or different namespace (NN federation). In these cases, would like to have some configs on attempts or retries to fail fast in case the other cluster is completely down.\n\nCurrently it takes default {{dfs.client.failover.max.attempts}} as 15 and hence adding a latency of 2 to 2.5 mins in each container launch (per node manager).","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12822026","id":"12822026","filename":"YARN-5445-1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-04T09:31:23.861+0000","size":3671,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12822026/YARN-5445-1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Log aggregation configured to different namenode can fail fast","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15398141","id":"15398141","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"Environment : HDP-2.4 (hadoop-2.7.1)\n\nThe usecase is as follows :- \n\nCluster is of size 1200 nodes and on average around 15k jobs running per day. Hence keeping applogs in the same cluster adds too much pressure on NN because of small files problem. Around 5Million files created per day (normal load) leading to 10Million FS objects for keeping one day logs itself. The requirement is to maintain atleast 1 week of log and hence decided to move it to different cluster or different namespace (NN federation).\n\nIn these cases, expecting minimal latency on jobs if the other cluster is completely down (though configured with HA). In such situation, would want to have minimal impact on applications running in cluster. But currently it does 15 attempts {{dfs.client.failover.max.attempts}} to connect to NN before giving it up. Hence adding a latency of 2 to 2.5 mins on each container launch (per node manager) and hence affecting over all job completion time.\n\n(Aware of YARN-2942 which is still in progress and MAPREDUCE-6415 is in 2.8.0)\n\nCan we have a new config to pass it as {{dfs.client.failover.max.attempts}} while creating FileSystem instance in LogAggregationService so that we can configure it to fail fast? Or any configs already available to handle this case?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-07-28T20:22:30.173+0000","updated":"2016-07-28T20:22:30.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15407479","id":"15407479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"Attached a patch where LogAggregationService creates a new yarn config and overrides {{dfs.client.failover.max.attempts}} to create FileSystem instance.\n\nThere are two open points to discuss :\n\n* \"dfs.client.failover.max.attempts\" is hardcoded in LogAggregationService because this config param is present in hadoop-hdfs (DFSConfigKeys.java) project. And hadoop-yarn-server-nodemanager (LogAggregationService) does not have dependency on hadoop-hdfs. \"DFS_CLIENT_FAILOVER_MAX_ATTEMPTS_KEY\" to be moved from DFSConfigKeys.java (hadoop-hdfs) to CommonConfigurationKeys.java (hadoop-common). Any other way? \n* Only one new config is introduced {{yarn.nodemanager.remote-app-log-dfs-client-failover-max-attempts}} considering that Namenode is setup in HA mode. Need to check for other configs like \"dfs.client.retry.max.attempts\" for non-ha setup. \n\nPlease check whether this is the correct way to handle? If not, please give suggestion. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-04T09:31:23.865+0000","updated":"2016-08-04T09:31:23.865+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15407481","id":"15407481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"Attached initial patch. Please review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-04T09:32:23.706+0000","updated":"2016-08-04T09:32:23.706+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15407583","id":"15407583","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 16s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red} 0m 0s {color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue} 1m 1s {color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 8m 41s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 46s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 41s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 32s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 40s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 3m 5s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 4s {color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue} 0m 9s {color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 1m 18s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 2m 35s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 2m 35s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 41s {color} | {color:red} hadoop-yarn-project/hadoop-yarn: The patch generated 13 new + 232 unchanged - 0 fixed = 245 total (was 232) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 20s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 31s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch has 5 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red} 0m 0s {color} | {color:red} The patch 3 line(s) with tabs. {color} |\n| {color:green}+1{color} | {color:green} xml {color} | {color:green} 0m 2s {color} | {color:green} The patch has no ill-formed XML file. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 2m 55s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 59s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 0m 26s {color} | {color:green} hadoop-yarn-api in the patch passed. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 2m 27s {color} | {color:red} hadoop-yarn-common in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 13m 34s {color} | {color:green} hadoop-yarn-server-nodemanager in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 20s {color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 48m 0s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.yarn.logaggregation.TestAggregatedLogFormat |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:9560f25 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12822026/YARN-5445-1.patch |\n| JIRA Issue | YARN-5445 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  xml  |\n| uname | Linux 5d7a2e22061b 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 08e3338 |\n| Default Java | 1.8.0_101 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-YARN-Build/12644/artifact/patchprocess/diff-checkstyle-hadoop-yarn-project_hadoop-yarn.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/12644/artifact/patchprocess/whitespace-eol.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/12644/artifact/patchprocess/whitespace-tabs.txt |\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/12644/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-common.txt |\n| unit test logs |  https://builds.apache.org/job/PreCommit-YARN-Build/12644/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-common.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/12644/testReport/ |\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager U: hadoop-yarn-project/hadoop-yarn |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/12644/console |\n| Powered by | Apache Yetus 0.3.0   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-08-04T11:13:59.081+0000","updated":"2016-08-04T11:13:59.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15426700","id":"15426700","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"body":"Moving {{DFS_CLIENT_FAILOVER_MAX_ATTEMPTS_KEY}} to {{CommonConfigurationKeys}} doesn't sound like the right solution.  If the log aggregation code is going to depend on specific behavior of HDFS why shouldn't the project depend on hadoop-hdfs?\n\nAs you pointed out, there are other JIRAs that are attempting to resolve the base issue that is prompting your unusual cluster config.  I don't think introducing a new configuration parameter to deal with a temporary issue is a good idea.  Config params, like diamonds, are forever, and we already have entirely too many.\n\nI haven't looked at the code for log aggregation.  What happens what the DFS connection fails?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=templedf","name":"templedf","key":"templedf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=templedf&avatarId=24879","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=templedf&avatarId=24879","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=templedf&avatarId=24879","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=templedf&avatarId=24879"},"displayName":"Daniel Templeton","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-08-18T16:03:16.086+0000","updated":"2016-08-18T16:03:16.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15434691","id":"15434691","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"[~templedf] Thanks for taking a look at this.\n\n{quote}\nMoving DFS_CLIENT_FAILOVER_MAX_ATTEMPTS_KEY to CommonConfigurationKeys doesn't sound like the right solution. If the log aggregation code is going to depend on specific behavior of HDFS why shouldn't the project depend on hadoop-hdfs?\n{quote}\n\nYes It makes sense. But I thought that adding dependency to hadoop-hdfs is a major change. If this can be done, then good.\n\n{quote}\nAs you pointed out, there are other JIRAs that are attempting to resolve the base issue that is prompting your unusual cluster config. I don't think introducing a new configuration parameter to deal with a temporary issue is a good idea. Config params, like diamonds, are forever, and we already have entirely too many\n{quote}\n\nYes, agreed on not introducing a new config for workaround. But recently we moved the applogs to different namenode (federated cluster) and seeing a benefit out of it as it reduces client/service rpc queue length and also rpc latencies. Also LogAggregationService is designed to write applogs to different filesystem. Hence thinking adding a config here might be worthy. But I am open to get input from you on this.\n\n{quote}\nI haven't looked at the code for log aggregation. What happens what the DFS connection fails?\n{quote}\n\nSeems this been handled in ConfiguredFailoverProxyProvider where {{ipc.client.connect.max.retries}} is set to 0 (default of {{dfs.client.failover.connection.retries}} . Please correct me If I am missing out something here.\n{code:title=ConfiguredFailoverProxyProvider.java|borderStyle=solid}\npublic ConfiguredFailoverProxyProvider(Configuration conf, URI uri,\n      Class<T> xface) {\n    int maxRetries = this.conf.getInt(\n        DFSConfigKeys.DFS_CLIENT_FAILOVER_CONNECTION_RETRIES_KEY,\n        DFSConfigKeys.DFS_CLIENT_FAILOVER_CONNECTION_RETRIES_DEFAULT);\n    this.conf.setInt(\n        CommonConfigurationKeysPublic.IPC_CLIENT_CONNECT_MAX_RETRIES_KEY,\n        maxRetries);\n}\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-24T10:48:16.222+0000","updated":"2016-08-24T10:48:16.222+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12993350/comment/15466498","id":"15466498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"body":"Request to have a look at the patch and give suggestion. Thanks in advance.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chackra","name":"chackra","key":"chackra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chackaravarthy","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-06T05:45:24.085+0000","updated":"2016-09-06T05:45:24.085+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-5445/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i31n67:"}}