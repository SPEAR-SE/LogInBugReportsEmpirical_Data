{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13124489","self":"https://issues.apache.org/jira/rest/api/2/issue/13124489","key":"YARN-7645","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341436","id":"12341436","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2017-12-12T23:31:03.479+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jan 05 22:14:12 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_400208_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_2075355682","customfield_12312321":null,"resolutiondate":"2018-01-05T21:55:49.002+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-7645/watchers","watchCount":2,"isWatching":false},"created":"2017-12-12T21:19:53.162+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341435","id":"12341435","description":"3.0.0 GA release","name":"3.0.0","archived":false,"released":true,"releaseDate":"2017-12-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-01-05T22:14:12.750+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324324","id":"12324324","name":"test"}],"timeoriginalestimate":null,"description":"We've noticed some flakiness in {{TestContainerResourceUsage#testUsageAfterAMRestartWithMultipleContainers}} when using {{FairScheduler}}:\r\n{noformat}\r\njava.lang.AssertionError: Attempt state is not correct (timeout). expected:<ALLOCATED> but was:<SCHEDULED>\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.TestContainerResourceUsage.amRestartTests(TestContainerResourceUsage.java:275)\r\n\tat org.apache.hadoop.yarn.server.resourcemanager.TestContainerResourceUsage.testUsageAfterAMRestartWithMultipleContainers(TestContainerResourceUsage.java:254)\r\n{noformat}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341436","id":"12341436","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12901769","id":"12901769","filename":"YARN-7645.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-12-12T21:26:26.397+0000","size":1509,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12901769/YARN-7645.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"TestContainerResourceUsage#testUsageAfterAMRestartWithMultipleContainers is flakey with FairScheduler","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13124489/comment/16288290","id":"16288290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"body":"When the test passes, we see this sequence of log messages:\r\n{noformat}\r\n2017-12-11 11:21:36,837 INFO  [AsyncDispatcher event handler] attempt.RMAppAttemptImpl (RMAppAttemptImpl.java:handle(919)) - appattempt_1513020094849_0001_000001 State change from SUBMITTED to SCHEDULED on event = ATTEMPT_ADDED\r\n2017-12-11 11:21:36,837 DEBUG [AsyncDispatcher event handler] event.AsyncDispatcher (AsyncDispatcher.java:dispatch(188)) - Dispatching the event org.apache.hadoop.yarn.server.resourcemanager.rmapp.RMAppNodeUpdateEvent.EventType: NODE_UPDATE\r\n2017-12-11 11:21:36,837 DEBUG [AsyncDispatcher event handler] rmapp.RMAppImpl (RMAppImpl.java:handle(870)) - Processing event for application_1513020094849_0001 of type NODE_UPDATE\r\n2017-12-11 11:21:36,837 DEBUG [AsyncDispatcher event handler] rmapp.RMAppImpl (RMAppImpl.java:processNodeUpdate(986)) - Received node update event:NODE_USABLE for node:127.0.0.1:1234 with state:RUNNING\r\n2017-12-11 11:21:36,837 INFO  [Thread-1] resourcemanager.MockRM (MockRM.java:waitForState(283)) - App State is : ACCEPTED\r\n2017-12-11 11:21:36,838 INFO  [Thread-1] resourcemanager.MockRM (MockRM.java:waitForState(357)) - Attempt State is : SCHEDULED\r\n2017-12-11 11:21:36,838 INFO  [Thread-1] resourcemanager.MockRM (MockRM.java:launchAM(1168)) - Launch AM appattempt_1513020094849_0001_000001\r\n2017-12-11 11:21:36,979 DEBUG [AsyncDispatcher event handler] event.AsyncDispatcher (AsyncDispatcher.java:dispatch(188)) - Dispatching the event org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeStatusEvent.EventType: STATUS_UPDATE\r\n2017-12-11 11:21:36,979 DEBUG [Thread-1] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(322)) - The updated demand for root.default is <memory:0, vCores:0>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-11 11:21:36,979 DEBUG [Thread-1] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(324)) - The updated fairshare for root.default is <memory:0, vCores:0>\r\n2017-12-11 11:21:36,979 DEBUG [Thread-1] fair.FSParentQueue (FSParentQueue.java:updateDemand(133)) - Counting resource from root.default <memory:0, vCores:0>; Total resource demand for root now <memory:0, vCores:0>\r\n2017-12-11 11:21:36,979 DEBUG [AsyncDispatcher event handler] rmnode.RMNodeImpl (RMNodeImpl.java:handle(666)) - Processing 127.0.0.1:1234 of type STATUS_UPDATE\r\n2017-12-11 11:21:36,985 DEBUG [AsyncDispatcher event handler] event.AsyncDispatcher (AsyncDispatcher.java:dispatch(188)) - Dispatching the event org.apache.hadoop.yarn.server.resourcemanager.scheduler.event.NodeUpdateSchedulerEvent.EventType: NODE_UPDATE\r\n2017-12-11 11:21:36,986 DEBUG [Thread-1] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(322)) - The updated demand for root.user is <memory:1024, vCores:1>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-11 11:21:36,986 DEBUG [Thread-1] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(324)) - The updated fairshare for root.user is <memory:10240, vCores:0>\r\n2017-12-11 11:21:36,986 DEBUG [Thread-1] fair.FSParentQueue (FSParentQueue.java:updateDemand(133)) - Counting resource from root.user <memory:1024, vCores:1>; Total resource demand for root now <memory:1024, vCores:1>\r\n2017-12-11 11:21:36,986 DEBUG [Thread-1] fair.FSParentQueue (FSParentQueue.java:updateDemand(144)) - The updated demand for root is <memory:1024, vCores:1>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-11 11:21:36,986 DEBUG [Thread-1] fair.FSQueue (FSQueue.java:setFairShare(293)) - The updated fairShare for root is <memory:10240, vCores:10>\r\n2017-12-11 11:21:36,987 DEBUG [AsyncDispatcher event handler] scheduler.AbstractYarnScheduler (AbstractYarnScheduler.java:nodeUpdate(1083)) - nodeUpdate: 127.0.0.1:1234 cluster capacity: <memory:10240, vCores:10>\r\n2017-12-11 11:21:36,987 DEBUG [AsyncDispatcher event handler] scheduler.AbstractYarnScheduler (AbstractYarnScheduler.java:nodeUpdate(1116)) - Node being looked for scheduling 127.0.0.1:1234 availableResource: <memory:10240, vCores:10>\r\n2017-12-11 11:21:36,988 DEBUG [AsyncDispatcher event handler] fair.FSLeafQueue (FSLeafQueue.java:assignContainer(333)) - Node 127.0.0.1 offered to queue: root.user fairShare: <memory:10240, vCores:0>\r\n2017-12-11 11:21:37,049 DEBUG [AsyncDispatcher event handler] scheduler.AppSchedulingInfo (AppSchedulingInfo.java:updateMetricsForAllocatedContainer(589)) - allocate: applicationId=application_1513020094849_0001 container=container_1513020094849_0001_01_000001 host=127.0.0.1:1234 user=user resource=<memory:1024, vCores:1> type=OFF_SWITCH\r\n{noformat}\r\nWhen it fails, we see this:\r\n{noformat}\r\n2017-12-08 11:58:46,248 INFO  [AsyncDispatcher event handler] attempt.RMAppAttemptImpl (RMAppAttemptImpl.java:handle(919)) - appattempt_1512763125850_0001_000001 State change from SUBMITTED to SCHEDULED on event = ATTEMPT_ADDED\r\n2017-12-08 11:58:46,249 DEBUG [AsyncDispatcher event handler] event.AsyncDispatcher (AsyncDispatcher.java:dispatch(188)) - Dispatching the event org.apache.hadoop.yarn.server.resourcemanager.rmapp.RMAppNodeUpdateEvent.EventType: NODE_UPDATE\r\n2017-12-08 11:58:46,249 DEBUG [AsyncDispatcher event handler] rmapp.RMAppImpl (RMAppImpl.java:handle(870)) - Processing event for application_1512763125850_0001 of type NODE_UPDATE\r\n2017-12-08 11:58:46,249 DEBUG [AsyncDispatcher event handler] rmapp.RMAppImpl (RMAppImpl.java:processNodeUpdate(986)) - Received node update event:NODE_USABLE for node:127.0.0.1:1234 with state:RUNNING\r\n2017-12-08 11:58:46,254 INFO  [Thread-2] resourcemanager.MockRM (MockRM.java:waitForState(283)) - App State is : ACCEPTED\r\n2017-12-08 11:58:46,254 INFO  [Thread-2] resourcemanager.MockRM (MockRM.java:waitForState(357)) - Attempt State is : SCHEDULED\r\n2017-12-08 11:58:46,254 INFO  [Thread-2] resourcemanager.MockRM (MockRM.java:launchAM(1168)) - Launch AM appattempt_1512763125850_0001_000001\r\n2017-12-08 11:58:46,280 DEBUG [AsyncDispatcher event handler] event.AsyncDispatcher (AsyncDispatcher.java:dispatch(188)) - Dispatching the event org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeStatusEvent.EventType: STATUS_UPDATE\r\n2017-12-08 11:58:46,280 DEBUG [AsyncDispatcher event handler] rmnode.RMNodeImpl (RMNodeImpl.java:handle(666)) - Processing 127.0.0.1:1234 of type STATUS_UPDATE\r\n2017-12-08 11:58:46,281 DEBUG [AsyncDispatcher event handler] event.AsyncDispatcher (AsyncDispatcher.java:dispatch(188)) - Dispatching the event org.apache.hadoop.yarn.server.resourcemanager.scheduler.event.NodeUpdateSchedulerEvent.EventType: NODE_UPDATE\r\n2017-12-08 11:58:46,281 DEBUG [AsyncDispatcher event handler] scheduler.AbstractYarnScheduler (AbstractYarnScheduler.java:nodeUpdate(1083)) - nodeUpdate: 127.0.0.1:1234 cluster capacity: <memory:10240, vCores:10>\r\n2017-12-08 11:58:46,282 DEBUG [AsyncDispatcher event handler] scheduler.AbstractYarnScheduler (AbstractYarnScheduler.java:nodeUpdate(1116)) - Node being looked for scheduling 127.0.0.1:1234 availableResource: <memory:10240, vCores:10>\r\n2017-12-08 11:58:46,282 DEBUG [AsyncDispatcher event handler] fair.FSLeafQueue (FSLeafQueue.java:assignContainer(333)) - Node 127.0.0.1 offered to queue: root.default fairShare: <memory:0, vCores:0>\r\n2017-12-08 11:58:46,282 DEBUG [AsyncDispatcher event handler] fair.FSLeafQueue (FSLeafQueue.java:assignContainer(333)) - Node 127.0.0.1 offered to queue: root.user fairShare: <memory:10240, vCores:0>\r\n2017-12-08 11:58:46,283 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(322)) - The updated demand for root.default is <memory:0, vCores:0>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-08 11:58:46,283 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(324)) - The updated fairshare for root.default is <memory:0, vCores:0>\r\n2017-12-08 11:58:46,283 DEBUG [Thread-2] fair.FSParentQueue (FSParentQueue.java:updateDemand(133)) - Counting resource from root.default <memory:0, vCores:0>; Total resource demand for root now <memory:0, vCores:0>\r\n2017-12-08 11:58:46,284 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(322)) - The updated demand for root.user is <memory:1024, vCores:1>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-08 11:58:46,284 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(324)) - The updated fairshare for root.user is <memory:10240, vCores:0>\r\n2017-12-08 11:58:46,284 DEBUG [Thread-2] fair.FSParentQueue (FSParentQueue.java:updateDemand(133)) - Counting resource from root.user <memory:1024, vCores:1>; Total resource demand for root now <memory:1024, vCores:1>\r\n2017-12-08 11:58:46,284 DEBUG [Thread-2] fair.FSParentQueue (FSParentQueue.java:updateDemand(144)) - The updated demand for root is <memory:1024, vCores:1>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-08 11:58:46,285 DEBUG [Thread-2] fair.FSQueue (FSQueue.java:setFairShare(293)) - The updated fairShare for root is <memory:10240, vCores:10>\r\n2017-12-08 11:58:46,287 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(322)) - The updated demand for root.default is <memory:0, vCores:0>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-08 11:58:46,287 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(324)) - The updated fairshare for root.default is <memory:0, vCores:0>\r\n2017-12-08 11:58:46,287 DEBUG [Thread-2] fair.FSParentQueue (FSParentQueue.java:updateDemand(133)) - Counting resource from root.default <memory:0, vCores:0>; Total resource demand for root now <memory:0, vCores:0>\r\n2017-12-08 11:58:46,287 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(322)) - The updated demand for root.user is <memory:1024, vCores:1>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-08 11:58:46,287 DEBUG [Thread-2] fair.FSLeafQueue (FSLeafQueue.java:updateDemand(324)) - The updated fairshare for root.user is <memory:10240, vCores:0>\r\n2017-12-08 11:58:46,288 DEBUG [Thread-2] fair.FSParentQueue (FSParentQueue.java:updateDemand(133)) - Counting resource from root.user <memory:1024, vCores:1>; Total resource demand for root now <memory:1024, vCores:1>\r\n2017-12-08 11:58:46,288 DEBUG [Thread-2] fair.FSParentQueue (FSParentQueue.java:updateDemand(144)) - The updated demand for root is <memory:1024, vCores:1>; the max is <memory:9223372036854775807, vCores:2147483647>\r\n2017-12-08 11:58:46,288 DEBUG [Thread-2] fair.FSQueue (FSQueue.java:setFairShare(293)) - The updated fairShare for root is <memory:10240, vCores:10>\r\n2017-12-08 11:58:46,289 INFO  [Thread-2] resourcemanager.MockRM (MockRM.java:waitForState(351)) - AppAttempt : appattempt_1512763125850_0001_000001 State is : SCHEDULED Waiting for state : ALLOCATED\r\n2017-12-08 11:58:46,299 INFO  [Thread-2] resourcemanager.MockRM (MockRM.java:waitForState(351)) - AppAttempt : appattempt_1512763125850_0001_000001 State is : SCHEDULED Waiting for state : ALLOCATED\r\n...\r\n{noformat}\r\nIn the bad case, it times out waiting for ALLOCATED.\r\n\r\nThere seems to be a race condition in {{MockRM#launchAM}} between the node heartbeat, which is called asynchronously, and the scheduler update, which is not.  We can easily fix this by adding another node heartbeat after the scheduler update to ensure that the scheduling actually happens.  This isn't a problem in a real cluster because nodes will be periodically heartbeating.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-12-12T21:20:23.439+0000","updated":"2017-12-12T21:20:23.439+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13124489/comment/16288296","id":"16288296","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"body":"The patch add a heartbeat after the scheduler update.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-12-12T21:26:27.150+0000","updated":"2017-12-12T21:26:27.150+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13124489/comment/16288470","id":"16288470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  4m 27s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 16m 56s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 37s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 28s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 41s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m 13s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m  5s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 25s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 40s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 35s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 35s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 38s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 11m  9s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 11s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 23s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 68m 33s{color} | {color:red} hadoop-yarn-server-resourcemanager in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 57s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}120m  7s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| Failed junit tests | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestNodeLabelContainerAllocation |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |\r\n| JIRA Issue | YARN-7645 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12901769/YARN-7645.001.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 858bc1266d1b 3.13.0-129-generic #178-Ubuntu SMP Fri Aug 11 12:48:20 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 06f0eb2 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_151 |\r\n| findbugs | v3.1.0-RC1 |\r\n| unit | https://builds.apache.org/job/PreCommit-YARN-Build/18893/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/18893/testReport/ |\r\n| Max. process+thread count | 878 (vs. ulimit of 5000) |\r\n| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager |\r\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/18893/console |\r\n| Powered by | Apache Yetus 0.7.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2017-12-12T23:31:03.479+0000","updated":"2017-12-12T23:31:03.479+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13124489/comment/16313888","id":"16313888","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rchiang","name":"rchiang","key":"rchiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ray Chiang","active":true,"timeZone":"America/Los_Angeles"},"body":"+1.\r\n\r\nI'm having difficulty reproducing the original error on my setup, but I'm not seeing any test issues with the new patch either.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rchiang","name":"rchiang","key":"rchiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ray Chiang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-01-05T21:08:52.994+0000","updated":"2018-01-05T21:08:52.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13124489/comment/16313974","id":"16313974","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the review [~rchiang].  Committed to trunk!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rkanter","name":"rkanter","key":"rkanter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Kanter","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-01-05T21:55:49.039+0000","updated":"2018-01-05T21:55:49.039+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13124489/comment/16314009","id":"16314009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #13455 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/13455/])\nYARN-7645. (rkanter: rev 2aa4f0a55936239d35babd84da2a0d1a261bc9bd)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/MockRM.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-05T22:14:12.750+0000","updated":"2018-01-05T22:14:12.750+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-7645/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3ntqf:"}}