{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12828009","self":"https://issues.apache.org/jira/rest/api/2/issue/12828009","key":"YARN-3591","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12313722","id":"12313722","key":"YARN","name":"Hadoop YARN","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329059","id":"12329059","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335735","id":"12335735","description":"3.0.0-alpha1 release","name":"3.0.0-alpha1","archived":false,"released":true,"releaseDate":"2016-09-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-05-07T14:02:55.245+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jun 08 13:03:04 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_3_*:*_314401639_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_3_*:*_10288572149","customfield_12312321":null,"resolutiondate":"2015-09-07T06:08:07.937+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-3591/watchers","watchCount":17,"isWatching":false},"created":"2015-05-07T12:51:54.360+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"10.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327585","id":"12327585","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-06-08T13:03:04.524+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"It happens when a resource is localised on the disk, after localising that disk has gone bad. NM keeps paths for localised resources in memory.  At the time of resource request isResourcePresent(rsrc) will be called which calls file.exists() on the localised path.\n\nIn some cases when disk has gone bad, inodes are stilled cached and file.exists() returns true. But at the time of reading, file will not open.\n\nNote: file.exists() actually calls stat64 natively which returns true because it was able to find inode information from the OS.\n\nA proposal is to call file.list() on the parent path of the resource, which will call open() natively. If the disk is good it should return an array of paths with length at-least 1.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329059","id":"12329059","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12731394","id":"12731394","filename":"0001-YARN-3591.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-08T08:16:32.768+0000","size":1158,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12731394/0001-YARN-3591.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12731169","id":"12731169","filename":"0001-YARN-3591.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-07T12:56:49.968+0000","size":1158,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12731169/0001-YARN-3591.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12732494","id":"12732494","filename":"YARN-3591.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-13T06:41:22.146+0000","size":1839,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12732494/YARN-3591.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12733804","id":"12733804","filename":"YARN-3591.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-19T12:56:57.608+0000","size":11113,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12733804/YARN-3591.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12734083","id":"12734083","filename":"YARN-3591.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-20T07:27:27.746+0000","size":11178,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12734083/YARN-3591.4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12740121","id":"12740121","filename":"YARN-3591.5.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-06-17T14:22:34.010+0000","size":12943,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12740121/YARN-3591.5.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12749233","id":"12749233","filename":"YARN-3591.6.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-08-07T10:21:24.495+0000","size":1843,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12749233/YARN-3591.6.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12749253","id":"12749253","filename":"YARN-3591.7.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-08-07T11:59:13.091+0000","size":2172,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12749253/YARN-3591.7.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12753729","id":"12753729","filename":"YARN-3591.8.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-09-02T09:22:49.504+0000","size":12611,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12753729/YARN-3591.8.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12753942","id":"12753942","filename":"YARN-3591.9.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-09-03T09:00:30.601+0000","size":16182,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12753942/YARN-3591.9.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Resource localization on a bad disk causes subsequent containers failure ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"subtasks":[{"id":"12836133","key":"YARN-3781","self":"https://issues.apache.org/jira/rest/api/2/issue/12836133","fields":{"summary":"Add api for getErrorDirs()","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}},{"id":"12836134","key":"YARN-3782","self":"https://issues.apache.org/jira/rest/api/2/issue/12836134","fields":{"summary":"Add api for storing/getting Error dirs from NMStateStore","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}},{"id":"12836135","key":"YARN-3783","self":"https://issues.apache.org/jira/rest/api/2/issue/12836135","fields":{"summary":"Modify onChangeDir() to remove cached resources from the memory. ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14532567","id":"14532567","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"example: \n>>stat /data/d3/yarn/local\nFile: `/data/d3/yarn/local'\nSize: 4096      Blocks: 8          IO Block: 4096   directory\nDevice: 830h/2096d\tInode: 107307009   Links: 3\nAccess: (0755/drwxr-xr-x)  Uid: (  110/ yarn)   Gid: (  118/  hadoop)\nAccess: 2014-11-18 13:57:19.000000000 +0000\nModify: 2014-11-19 11:15:15.000000000 +0000\nChange: 2014-11-19 11:15:15.000000000 +0000\nBirth: -\n\n>> ls /data/d3/yarn/local\nls: reading directory /data/d3/yarn/local: Input/output error","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-07T12:59:06.804+0000","updated":"2015-05-07T12:59:06.804+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14532675","id":"14532675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  14m 38s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:red}-1{color} | tests included |   0m  0s | The patch doesn't appear to include any new or modified tests.  Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. |\n| {color:green}+1{color} | javac |   7m 35s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 36s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 36s | The applied patch generated  2 new checkstyle issues (total was 19, now 20). |\n| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 34s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m  2s | The patch does not introduce any new Findbugs (version 2.0.3) warnings. |\n| {color:green}+1{color} | yarn tests |   6m  2s | Tests passed in hadoop-yarn-server-nodemanager. |\n| | |  42m  1s | |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12731169/0001-YARN-3591.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / 8e991f4 |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/7759/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/7759/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/7759/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf902.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/7759/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-07T14:02:55.245+0000","updated":"2015-05-07T14:02:55.245+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14540715","id":"14540715","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~lavkesh], thanks for working on this issue. It looks like a good catch. The parent directory is generated by {{uniqueNumberGenerator}} for each LocalizedResource, so most likely fileList.length will be one.\nSome comments about your patch:\n{{getParentFile}} may return null, Should we check whether it is null to avoid NPE?\nCan we add comments in the code about the change?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-12T20:58:30.314+0000","updated":"2015-05-12T20:58:30.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14541464","id":"14541464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~zxu] for comments. \nadded a null check and a few comments in the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-13T06:42:21.744+0000","updated":"2015-05-13T06:42:21.744+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14541525","id":"14541525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  14m 40s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:red}-1{color} | tests included |   0m  0s | The patch doesn't appear to include any new or modified tests.  Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. |\n| {color:green}+1{color} | javac |   7m 35s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 34s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 35s | The applied patch generated  2 new checkstyle issues (total was 19, now 20). |\n| {color:red}-1{color} | whitespace |   0m  0s | The patch has 2  line(s) that end in whitespace. Use git apply --whitespace=fix. |\n| {color:green}+1{color} | install |   1m 35s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 32s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m  2s | The patch does not introduce any new Findbugs (version 2.0.3) warnings. |\n| {color:green}+1{color} | yarn tests |   6m  0s | Tests passed in hadoop-yarn-server-nodemanager. |\n| | |  41m 59s | |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12732494/YARN-3591.2.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / fcd0702 |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/7913/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/7913/artifact/patchprocess/whitespace.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/7913/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/7913/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf901.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/7913/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-13T07:32:58.174+0000","updated":"2015-05-13T07:32:58.174+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14541705","id":"14541705","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"[~zxu], [~lavkesh] - instead of checking listing the directory contents every time, can we use the signalling mechanism that [~zxu] added in YARN-3491? When a local dir goes bad, the trackers listener gets called and it remove all the localized resources from the data structure. That way we are re-using the existing checks to make sure that a directory is good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-05-13T10:33:21.599+0000","updated":"2015-05-13T10:33:21.599+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14542291","id":"14542291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"[~vvasudev] Thanks for the review:\nThis is a good idea. This will prevent listing every time a resource is needed.\nAs far as my understanding goes DirectoryCollection#checkDirs() will be called by diskhealthchecker periodically, and we can plug the resource removal code when there is a change in the list of good disks.. Is it okay?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-13T17:37:20.700+0000","updated":"2015-05-13T17:37:20.700+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14542347","id":"14542347","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~vvasudev], that is a good suggestion, which will give better performance.\n[~lavkesh], YARN-3491 implemented a signaling mechanism: DirsChangeListener.\nWe can register a DirsChangeListener for localDirs in LocalResourcesTrackerImpl by calling LocalDirsHandlerService#registerLocalDirsChangeListener. We can plug the resource removal code in the DirsChangeListener#onDirsChanged","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-13T18:13:20.216+0000","updated":"2015-05-13T18:13:20.216+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14543304","id":"14543304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks for the comment [~zxu] and [~vvasudev]. I will put out a patch with signalling mechanism.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-14T07:00:51.978+0000","updated":"2015-05-14T07:00:51.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14543886","id":"14543886","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"LocalResourcesTrackerImpl keeps a ref count for resources. remove(LocalizedResource req, DeletionService delService)\nwill fail when the reference count is non-zero. In the case of non-zero ref count,It will not remove that resource. And in the future there is no way to remove the localized resource unless again localdirs are changed.\nShould we mark these resources as not-usable if we are not able to remove it? In this case we need to check if a resource is localized and it is not marked as not-usable before passing it to a new container. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-14T15:47:22.102+0000","updated":"2015-05-14T15:47:22.102+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14544708","id":"14544708","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"I think the current code call {{removeResource}} instead of {{remove}} to remove a localized resource which can't be accessed due to disk error.\nWe may do the same because all the containers which use the localized resources on a bad disk may fail and removing these resources early looks like reasonable.\nBut I think we should be careful for the disks which are full, It may not be good to remove localized resources on the full disks because full disks may become good disks after files are removed by CacheCleanup. Need more thoughts for the full disks, maybe We can add a new signaling for disks becoming bad in DirectoryCollection.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-15T01:09:24.874+0000","updated":"2015-05-15T01:09:24.874+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14545250","id":"14545250","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"What about zombie files lying in the various paths..In the case of disk becoming good, they will be there forever. Do we not care? \nAlso I was thinking to remove resources which have public and user level visibility, because app level resources will be deleted automatically. Thoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-15T09:59:29.470+0000","updated":"2015-05-15T09:59:29.470+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14546211","id":"14546211","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Canceling patch while we continue discussion.\n\nThe easiest way to do this IMO is for the failing ResourceLocalization code to request LocalDirsHandlerService/DirectoryCollection to actively trigger a disk-check outside of the regular cycle. Thoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-15T21:40:37.558+0000","updated":"2015-05-15T21:40:37.558+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14546213","id":"14546213","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Essentially keeping the ownership of turning disks good or bad in one single place.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-15T21:41:10.719+0000","updated":"2015-05-15T21:41:10.719+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14546461","id":"14546461","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~vinodkv], yes, keeping the ownership of turning disks good or bad in one single place is a very good suggestion. So it is reasonable to keep all the disk checking at DirectoryCollection.\nNormally CacheCleanup thread will periodically send CACHE_CLEANUP event to cleanup these localized files in LocalResourcesTrackerImpl.\nIf we only remove these localized resources on the \"bad\" disk which can't be recovered, it will be ok. Here \"bad\" disk is different from \"full\" disk. I suppose all the files on the \"bad\" disk will be lost/deleted when it becomes good. Keeping app level resources sounds reasonable to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-16T01:01:00.983+0000","updated":"2015-05-16T01:01:00.983+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14546568","id":"14546568","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"[~vinodkv]: The concern here is, If a resource is present in the LocalResourcesTrackerImpl cache(in memory), It will go and just check file.exists() and it is retuning true even if the disk is not readable. We wanted to remove this cache and the state-store so that it will be missing when it is requested so it could be downloaded again. This is not a case of localization failure.\n[~zxu] In other case when a disk goes bad while it has resources and other container related files, will they ever be deleted when that disk becomes good? \nI understand that the resources will be deleted (from disk) which least recently used when the max cache size is reached or limit on the  number of directories is reached.\n\nIMO If above cache clean up(from disk) is acceptable then we can just call removeResource() instead of remove() in the case of a resource is found on a bad disk, which will remove it from the memory and state store.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-16T05:30:07.901+0000","updated":"2015-05-16T05:30:07.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14546590","id":"14546590","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~lavkesh], Currently DirectoryCollection supports {{fullDirs}} and {{errorDirs}}. Both are not good dirs. IMO {{fullDirs}} is the disk which can become good when the localized files are deleted by above cache-clean-up and {{errorDirs}} is the corrupted disk which can't become good until somebody fix it manually. Calling removeResource for localized resource in {{errorDirs}} sounds reasonable to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-16T06:29:41.167+0000","updated":"2015-05-16T06:29:41.167+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14550566","id":"14550566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  14m 51s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 1 new or modified test files. |\n| {color:green}+1{color} | javac |   7m 35s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 50s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 21s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 37s | The applied patch generated  3 new checkstyle issues (total was 174, now 177). |\n| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 35s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 32s | The patch built with eclipse:eclipse. |\n| {color:red}-1{color} | findbugs |   1m  4s | The patch appears to introduce 2 new Findbugs (version 3.0.0) warnings. |\n| {color:green}+1{color} | yarn tests |   6m 10s | Tests passed in hadoop-yarn-server-nodemanager. |\n| | |  42m 40s | |\n\\\\\n\\\\\n|| Reason || Tests ||\n| FindBugs | module:hadoop-yarn-server-nodemanager |\n|  |  File.separator used for regular expression in org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.LocalResourcesTrackerImpl.isParent(String, String)  At LocalResourcesTrackerImpl.java:in org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.LocalResourcesTrackerImpl.isParent(String, String)  At LocalResourcesTrackerImpl.java:[line 483] |\n|  |  File.separator used for regular expression in org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.LocalResourcesTrackerImpl.isParent(String, String)  At LocalResourcesTrackerImpl.java:in org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.LocalResourcesTrackerImpl.isParent(String, String)  At LocalResourcesTrackerImpl.java:[line 484] |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12733804/YARN-3591.3.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / de30d66 |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/7999/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/7999/artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-server-nodemanager.html |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/7999/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/7999/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf904.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/7999/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T14:55:14.235+0000","updated":"2015-05-19T14:55:14.235+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14551976","id":"14551976","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (/) *{color:green}+1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  14m 42s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 1 new or modified test files. |\n| {color:green}+1{color} | javac |   7m 33s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 37s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |\n| {color:green}+1{color} | checkstyle |   0m 20s | There were no new checkstyle issues. |\n| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 33s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m  2s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:green}+1{color} | yarn tests |   6m 28s | Tests passed in hadoop-yarn-server-nodemanager. |\n| | |  42m 15s | |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12734083/YARN-3591.4.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / ce53c8e |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8019/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8019/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf907.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8019/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-20T08:12:44.728+0000","updated":"2015-05-20T08:12:44.728+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14553777","id":"14553777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"[~lavkesh], thanks for the new patch. It looks like your new patch will also call removeResource on DirectoryCollection.fullDirs. Most likely the files in fullDirs can still be used, Dir in fullDirs may become good after the files in it are deleted by CacheCleanup. If a localized resource is in fullDirs, reusing it for same LocalResourceRequest will be better than removing it. Another problem is these files are still at the disks, when the NM restart, we will hit the issue YARN-2624. LocalResourcesTrackerImpl#getPathForLocalization may allocate same name directory, which cause localization failure. This issue looks like much more complicated than we thought.\nIMHO, we can add two parameters in onDirsChanged: dirs(newErrorDirs) which are changed from localDirs and fullDirs to errorDirs , dirs(newRepairedDirs) which are changed from errorDirs to localDirs or fullDirs. We can call removeResource for the localized resources in newErrorDirs.\nWe can call cleanUpLocalDir to delete the obsolete files in newRepairedDirs. With this change, we may solve your previous concern \"What about zombie files lying in the various paths\". Also we should save the errorDirs in StateStore for NM recovery, so we can delete the obsolete files in these errorDirs after  NM restart.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-21T07:23:34.828+0000","updated":"2015-05-21T07:23:34.828+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14553981","id":"14553981","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"The code shows that full dirs are both readable and writable. So a resource can still be read from the full disk. \nWe should just call checkLocalizedResources() on both goodirs and fulldirs. Then resources in cache will deleted which are localized on bad disk. \nIn addition we can actually try to remove resources from the disk by calling remove().\nthoughts ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-21T09:39:56.442+0000","updated":"2015-05-21T09:39:56.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14555187","id":"14555187","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Calling checkLocalizedResources() on both goodirs and fulldirs is similar as calling removeResource for the localized resources in newErrorDirs(please refer to my previous comment).\nBut calling remove() may not work for errorDirs because firstly remove won't delete the file when the reference count is non-zero and secondly the delete very likely won't succeed on the errorDirs. So it will be better to delete the files in the errorDirs after these dirs in errorDirs become goodirs or fulldirs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-21T22:40:41.359+0000","updated":"2015-05-21T22:40:41.359+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14555819","id":"14555819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Hm.. Got you point.\nIs DirectoryCollection class a good place to add newErrorDirs and newRepairedDirs ?\nSo finally this is my understanding: please correct me if I am wrong. \nDef:\nnewErrorDirs -> Dirs which turned bad from localdirs or fulldirs.\nnewRepairedDirs -> Dirs which turned good from errorDirs.\nAfter calling checkLocalizedResources() with localdirs and fulldirs, we can call  {code}cleanUpLocalDir(lfs, del, localDir);{code} on newRepairedDirs. \nWe will put newErrorDirs to statestore so that when nm restarts it can do a cleanup. Also We need to remove them from statestore if they become repaired.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-22T08:14:53.952+0000","updated":"2015-05-22T08:14:53.952+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14555961","id":"14555961","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"typo:  cleanUpLocalDir(lfs, del, newRepairedDirs);\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-22T10:44:44.529+0000","updated":"2015-05-22T10:44:44.529+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14555996","id":"14555996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"For adding newErrorDirs do we have to create a new protobuf message and implement methods for storing and loading in all statestores?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-05-22T11:11:18.511+0000","updated":"2015-05-22T11:11:18.511+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14558727","id":"14558727","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Yes, I think we can get newErrorDirs and newRepairedDirs by comparing {{postCheckOtherDirs}} and {{preCheckOtherErrorDirs}} in {{DirectoryCollection#checkDirs}}.\nCan we use {{String}} to store {{DirectoryCollection#errorDirs}} in statestore similar as {{storeContainerDiagnostics}}?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-26T06:23:31.966+0000","updated":"2015-05-26T06:23:31.966+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14568834","id":"14568834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"[~zxu] :Can we get away without storing into NMstateStore? Other changes seems to be okay.\nIt's not a big change in terms of the code, but adding in NMstate could be debatable.\n[~vvasudev]: Thoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-06-02T09:31:20.490+0000","updated":"2015-06-02T09:31:20.490+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14569480","id":"14569480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"body":"If we have a new api which returns the present set of error dirs alone (w/o full dirs) \n{code}\nsynchronized List<String> getErrorDirs() \n{code}\nthen could we modify LocalResourcesTrackerImpl#checkLocalizedResources in such a way that we call *removeResource* on those localized resources whose parent is present in ErrorDirs.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunilg","name":"sunilg","key":"sunilg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunil Govindan","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-06-02T17:43:59.881+0000","updated":"2015-06-02T17:43:59.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14569727","id":"14569727","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~lavkesh], I think we can create a separate JIRA for storing local Error directories in NM state store, which will be a good enhancement.\nthanks [~sunilg]! Adding a new API to get local error directories is also a good suggestion. But I think it will be enough to just check newErrorDirs instead of all errorDirs.\n\nTo better support NM recovery and make DirsChangeListener interface simple, I propose the following changes:\n\n1.In DirectoryCollection, notify listener when any set of dirs(localDirs, errorDirs and fullDirs) are changed\nThe code change at {{DirectoryCollection#checkDirs}} looks like the following:\n{code}\nbool needNotifyListener = false;\nneedNotifyListener = setChanged;\n    for (String dir : preCheckFullDirs) {\n      if (postCheckOtherDirs.contains(dir)) {\n        needNotifyListener = true;\n        LOG.warn(\"Directory \" + dir + \" error \"\n            + dirsFailedCheck.get(dir).message);\n      }\n    }\n    for (String dir : preCheckOtherErrorDirs) {\n      if (postCheckFullDirs.contains(dir)) {\n        needNotifyListener = true;\n        LOG.warn(\"Directory \" + dir + \" error \"\n            + dirsFailedCheck.get(dir).message);\n      }\n    }\n    if (needNotifyListener) {\n      for (DirsChangeListener listener : dirsChangeListeners) {\n        listener.onDirsChanged();\n      }\n    }\n{code}\n\n2.  add an API to get local error directories.\nAs [~sunilg] suggested, We can add an API {{synchronized List<String> getErrorDirs()}} in DirectoryCollection.java\nWe also need add an API {{public List<String> getLocalErrorDirs()}} in LocalDirsHandlerService.java, which will call {{DirectoryCollection#getErrorDirs}}\n\n3. add a field {{Set<String> preLocalErrorDirs}} in ResourceLocalizationService.java to store previous local error directories.\n{{ResourceLocalizationService#preLocalErrorDirs}} should be loaded from state store at the beginning if we support storing local Error directories in NM state store.\n\n4.The following is pseudo code for {{localDirsChangeListener#onDirsChanged}}:\n{code}\nSet<String> curLocalErrorDirs = new HashSet<String>(dirsHandler.getLocalErrorDirs());\nList<String> newErrorDirs = new ArrayList<String>();\nList<String> newRepairedDirs = new ArrayList<String>();\n    for (String dir : curLocalErrorDirs) {\n      if (!preLocalErrorDirs.contains(dir)) {\n        newErrorDirs.add(dir);\n      }\n    }\n    for (String dir : preLocalErrorDirs) {\n      if (!curLocalErrorDirs.contains(dir)) {\n        newRepairedDirs.add(dir);\n      }\n    }\nfor (String localDir : newRepairedDirs) {\ncleanUpLocalDir(lfs, delService, localDir);\n}\nif (!newErrorDirs.isEmpty()) {\n//As Sunil suggested, checkLocalizedResources will call removeResource on those localized resources whose parent is present in newErrorDirs.\npublicRsrc.checkLocalizedResources(newErrorDirs);\nfor (LocalResourcesTracker tracker : privateRsrc.values()) {\ntracker.checkLocalizedResources(newErrorDirs);\n}\n}\nif (!newErrorDirs.isEmpty() || !newRepairedDirs.isEmpty()) {\npreLocalErrorDirs = curLocalErrorDirs;\nstateStore.storeLocalErrorDirs(StringUtils.arrayToString(curLocalErrorDirs.toArray(new String[0])));\n}\ncheckAndInitializeLocalDirs();\n{code}\n\n5. It will be better to move {{verifyDirUsingMkdir(testDir)}} right after {{DiskChecker.checkDir(testDir)}} in {{DirectoryCollection#testDirs}}, so we can detect the error directory before detecting the full directory.\n\nPlease feel free to change or add more to my proposal.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-02T20:46:44.842+0000","updated":"2015-06-02T20:46:44.842+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14570652","id":"14570652","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~sunilg] and [~zxu] for comments and review. I did slightly differently. I added newRepairedDirs and newErrorDirs into DirectoryCollection.  \nIn this version checkLocalizedResources(dirsTocheck) takes the list of good dirs.\n\n{code:title=DirectoryCollection.java|borderStyle=solid}\n+  private List<String> newErrorDirs;\n+  private List<String> newRepariedDirs;\n \n   private int numFailures;\n   \n@@ -159,6 +161,8 @@ public DirectoryCollection(String[] dirs,\n     localDirs = new CopyOnWriteArrayList<String>(dirs);\n     errorDirs = new CopyOnWriteArrayList<String>();\n     fullDirs = new CopyOnWriteArrayList<String>();\n+    newErrorDirs = new CopyOnWriteArrayList<String>();\n+    newRepariedDirs = new CopyOnWriteArrayList<String>();\n \n     \n@@ -213,6 +217,20 @@ synchronized int getNumFailures() {\n   }\n \n   /**\n+   * @return Recently discovered error dirs\n+   */\n+  synchronized List<String> getNewErrorDirs() {\n+    return newErrorDirs;\n+  }\n+\n+  /**\n+   * @return Recently discovered repaired dirs\n+   */\n+  synchronized List<String> getNewRepairedDirs() {\n+    return newRepariedDirs;\n+  }\n+\n\n@@ -259,6 +277,8 @@ synchronized boolean checkDirs() {\n     localDirs.clear();\n     errorDirs.clear();\n     fullDirs.clear();\n+    newRepariedDirs.clear();\n+    newErrorDirs.clear();\n \n     for (Map.Entry<String, DiskErrorInformation> entry : dirsFailedCheck\n       .entrySet()) {\n@@ -292,6 +312,11 @@ synchronized boolean checkDirs() {\n     }\n     Set<String> postCheckFullDirs = new HashSet<String>(fullDirs);\n     Set<String> postCheckOtherDirs = new HashSet<String>(errorDirs);\n+    for (String dir : preCheckGoodDirs) {\n+      if (postCheckOtherDirs.contains(dir)) {\n+        newErrorDirs.add(dir);\n+      }\n+    }\n     for (String dir : preCheckFullDirs) {\n       if (postCheckOtherDirs.contains(dir)) {\n         LOG.warn(\"Directory \" + dir + \" error \"\n@@ -304,6 +329,9 @@ synchronized boolean checkDirs() {\n         LOG.warn(\"Directory \" + dir + \" error \"\n             + dirsFailedCheck.get(dir).message);\n       }\n+      if (localDirs.contains(dir) || postCheckFullDirs.contains(dir)) {\n+        newRepariedDirs.add(dir);\n+      }\n     }\n{code}\n\n{code:title=LocalDirsHandlerService.java|borderStyle=solid}\n+   * @return Recently added error dirs\n+   */\n+  public List<String> getDiskNewErrorDirs() {\n+    return localDirs.getNewErrorDirs();\n+  }\n+\n+  /**\n+   * @return Recently added repaired dirs\n+   */\n+  public List<String> getDiskNewRepairedDirs() {\n+    return localDirs.getNewRepairedDirs();\n+  }\n{code}\n\n{code:title=ResourceLocalizationService.java|borderStyle=solid}\n       @Override\n       public void onDirsChanged() {\n         checkAndInitializeLocalDirs();\n+        List<String> dirsTocheck =\n+            new ArrayList<String>(dirsHandler.getLocalDirs());\n+        dirsTocheck.addAll(dirsHandler.getDiskFullLocalDirs());\n+        // checks if resources are present in the dirsTocheck\n+        publicRsrc.checkLocalizedResources(dirsTocheck);\n         for (LocalResourcesTracker tracker : privateRsrc.values()) {\n+          tracker.checkLocalizedResources(dirsTocheck);\n+        }\n+        List<String> newRepairedDirs = dirsHandler.getDiskNewRepairedDirs();\n+        // Delete any resources found in the newly repaired Dirs.\n+        for (String dir : newRepairedDirs) {\n+          cleanUpLocalDir(lfs, delService, dir);\n         }\n+        // Add code here to add errordirs to statestore.\n       }\n     };\n{code}\n\n{code:title=DirectoryCollection.java|borderStyle=solid}\n  synchronized List<String> getErrorDirs() {\n    return Collections.unmodifiableList(errorDirs);\n  }\n{code}\nWe can use getErroeDirs() and keep it in the NMstate as suggested and upon start we can do a cleanUpLocalDir on the errordirs.\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-06-03T10:55:13.042+0000","updated":"2015-06-03T10:55:13.042+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14576761","id":"14576761","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~lavkesh], thanks for the update.\nIMHO, although storing local error directories in NM state store will be implemented in a separate follow-up JIRA, it will be good to make this patch to accommodate with it. Upon NM start, we can consider the previous error Dirs is the error Dirs stored in NM state store.\n{{DirectoryCollection#checkDirs}} is already called at {{LocalDirsHandlerService#serviceInit}} before {{registerLocalDirsChangeListener}} is called at {{ResourceLocalizationService#serviceStart}}. {{onDirsChanged}} will be called in {{registerLocalDirsChangeListener}} for the first time. You can see we already have previous error Dirs when {{onDirsChanged}} is called for the first time, we just need current error Dirs to calculate newErrorDirs and newRepairedDirs, which is implemented at my proposal #4.\nSo instead of adding three APIs({{getDiskNewErrorDirs}}, {{getDiskNewRepairedDirs}} and {{getErrorDirs}}) in DirectoryCollection, we can just add one API {{getErrorDirs}}. It will make the interface simpler and make the code cleaner.\nAnd also even you have three APIs, when {{onDirsChanged}} is called for the first time, you still need to recalculate newErrorDirs and newRepairedDirs based on the errors Dirs stored in NM state store.\n\nbq. upon start we can do a cleanUpLocalDir on the errordirs.\nwe needn't do it because we can handle it in {{onDirsChanged}}\n\nAs [~sunilg] suggested, changing checkLocalizedResources implementation to call removeResource on those localized resources whose parent is present in newErrorDirs will be better. Because it will give better performance.\n\nBy the way, {{checkAndInitializeLocalDirs}} should be called after {{cleanUpLocalDir}}, because once the directory is cleaned up, it need be reinitialized.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-08T08:48:54.639+0000","updated":"2015-06-08T08:48:54.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14577124","id":"14577124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"[~zxu]: Thanks for the review and comments. \nI have added subtasks for more clarity. Please feel free to suggest changes. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-06-08T12:53:12.043+0000","updated":"2015-06-08T12:53:12.043+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14583524","id":"14583524","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"Sorry for the late response. In my opinion, there's little benefit to storing the bad local dirs in the state store. We can just pass the LocalDirHandlerService to LocalResourcesTrackerImpl when it's created and incoming requests can be checked against the know error dirs in the isResourcePresent function.\n\n[~lavkesh], would that solve the problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-06-12T14:49:31.435+0000","updated":"2015-06-12T14:49:31.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14583925","id":"14583925","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~vvasudev], thanks for the suggestion.\nIt looks like your suggestion is similar as [~lavkesh]'s original patch 0001-YARN-3591.patch. Compared to [~lavkesh]'s original patch, your suggestion sometimes may not detect the disk failure because LocalDirHandlerService only calls {{checkDirs}} every 2 minutes by default and if the disk failure happens right after {{checkDirs}} is called and before {{isResourcePresent}} is called, your suggestion won't detect the disk failure but [~lavkesh]'s original patch can detect the disk failure. So it looks like [~lavkesh]'s original patch is better than your suggestion. It is my understanding, and please correct me if I am wrong.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-12T19:17:34.696+0000","updated":"2015-06-12T19:17:34.696+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14587682","id":"14587682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"Lavkesh's original patch did the test regardless of whether the directory was known to be good or bad. We want the LocalDirHandlerService to be a central place for the state of the local dirs. If there is a test that improves our detection of bad disks, we should add it to the DirectoryCollection class. However in this case, the local dirs were detected as bad. In spite of being known to bad, we still tried to serve jars from them. If the frequency of the checks is too small, admins can change it to suit their liking.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-06-16T08:35:51.258+0000","updated":"2015-06-16T08:35:51.258+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14590484","id":"14590484","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~vvasudev], thanks for the explanation.\nIMHO, If we want the LocalDirHandlerService to be a central place for the state of the local dirs, doing it in {{DirsChangeListener#onDirsChanged}} will be better. IIUC, it is also your suggestion.\nThe benefits for doing this are:\n1. It will give better performance. because you will do it only when some Dirs become bad, which should happen rarely,\nyou won't waste your time to do it for every localization request.\n2. It will also help the issue \"What about zombie files lying in the various paths\" which [~lavkesh] found, a similar issue as YARN-2624.\n3. {{checkLocalizedResources}}/{{removeResource}} called by {{onDirsChanged}} will be done inside {{LocalDirsHandlerService#checkDirs}} without any delay.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-17T20:11:26.392+0000","updated":"2015-06-17T20:11:26.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14590576","id":"14590576","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  16m 14s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 1 new or modified test files. |\n| {color:green}+1{color} | javac |   7m 46s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 52s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 36s | The applied patch generated  2 new checkstyle issues (total was 172, now 174). |\n| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 35s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m 13s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:green}+1{color} | yarn tests |   6m 11s | Tests passed in hadoop-yarn-server-nodemanager. |\n| | |  44m 29s | |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12740121/YARN-3591.5.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / 6e3fcff |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/8272/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8272/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8272/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf904.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8272/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-06-17T20:51:58.230+0000","updated":"2015-06-17T20:51:58.230+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14591612","id":"14591612","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"[~zxu] can you explain how using onChange will help with the zombie issue?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-06-18T10:29:46.751+0000","updated":"2015-06-18T10:29:46.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14592560","id":"14592560","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~vvasudev],\nbq. can you explain how using onChange will help with the zombie issue?\nIf a disk becomes bad, the files in it may not be deleted correctly until the disk becomes good later. Also in LocalResourcesTrackerImpl.java, after the LocalizedResource is detected in bad disk by {{isResourcePresent}}, {{removeResource}} is called to remove it from {{LocalResourcesTrackerImpl#localrsrc}} and NM state store but it is not deleted from the bad disk, these localized files will become zombie files after the bad disks are repaired.\nThe following code in my proposal #4, which is called inside {{onDirsChanged}}, may solve this issue:\n{code}\nfor (String localDir : newRepairedDirs) {\ncleanUpLocalDir(lfs, delService, localDir);\n}\n{code}\nPlease let me know if I am missing something.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-18T21:31:56.315+0000","updated":"2015-06-18T21:31:56.315+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14593472","id":"14593472","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"One potential issue with that approach is long-running containers and \"partially bad\" disks.  A bad disk can still have readable files on it.  If we blindly remove all the files on a repaired disk then we risk removing the files from underneath a running container.  On UNIX/Linux this may be less of an issue if the container is referencing the files with file descriptors that don't close, but it would cause problems if the container re-opens the files at some point or is running on an OS that doesn't reference-count files before removing the data.\n\nThis is off the top of my head and is probably not the most efficient solution, but I think it could work:\n# We support mapping LocalResourceRequests to a collection of LocalizedResource.  This allows us to track duplicate localizations.\n# When a resource request maps to only LocalizedResource entries that correspond to bad disks, we make the worst-case assumption that the file is inaccessible on those bad disks and re-localize it as another LocalizeResource entry (i.e.: a duplicate).\n# When a container completes, we decrement the refcount on the appropriate LocalizedResources.  We're already tracking the references by container ID, so we can scan the collection to determine which one of the duplicates the container was referencing.\n# When a refcount of a resource for a bad disk goes to zero we don't delete it (since the disk is probably read-only at that point) and instead just remove the LocalizedResource entry from the map (or potentially leave it around with a zero refcount to make the next step a bit cheaper).\n# When a disk is repaired, we scan it for any local directory that doesn't correspond to a LocalizedResource resource we know about.  Those local directories can be removed, while directories that map to \"active\" resources are preserved.\n\nOne issue with this approach is NM restart.  We currently don't track container references in the state store since we can reconstruct them on startup due to the assumed one-to-one mapping of ResourceRequests to LocalizedResources.  This proposal violates that assumption, so we'd have to start tracking container references explicitly in the state store to do this approach.\n\nA much simpler but harsher approach is to kill containers that are referencing resources on bad disks with the assumption they will fail or be too slow when accessing the files there in the interest of \"failing fast.\"  However in practice I could see many containers having at least one resource that's on the bad disk, and that could end up killing most/all the containers on a node just because one disk failed.  Again a disk going bad doesn't necessarily mean all of the data is inaccessible, so we could be killing containers that otherwise wouldn't know or care about the bad disk (e.g.: they could have cached the resource in memory before the disk went bad).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-06-19T14:40:55.922+0000","updated":"2015-06-19T14:40:55.922+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14595250","id":"14595250","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~jlowe], thanks for the thorough analysis.\nMy assumption is that the files on a bad disk are most likely inaccessible, it looks like my assumption is wrong.\nIt looks like your first approach is better with fewer side effects. Item 5 may be very time-consuming.\nI can think of the following possible improvements for your first approach:\n# Cache all the local directories which are used by running containers for LocalizedResource with non-zero refcount. This may speed up item 5. We only need keep all the cached directories on a disk which is just repaired.\n# Maybe we can remove the LocalizedResource entry with zero refcount for a bad disk from the map in {{onDirsChanged}}. We should also remove it when handling {{RELEASE}} ResourceEvent.\n# It looks like we still need store the bad local dirs in the state store, so we can track disks, which are repaired, during NM recovery.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-22T00:09:52.916+0000","updated":"2015-06-22T00:09:52.916+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14608089","id":"14608089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~jlowe] and [~zxu] for detailed analysis and reviews. \n\nHonestly it has become more evolved than I thought. \nFew comments:\n1. I wrote a sample program to just check the penalty we will hit in terms of time. File.exists() along with listing on the parent(initial patch) virtually adds nothing. Combined time taken for both calls is around 0.1 ms. (This patch we applied in our production). This will just remove the entry from the map, which will not affect the running containers. This solves the problem of failing new containers. \n2. The latest patch which checks if the resource path exists in one of the good disks (basically some string comparison) has major performance implications. It takes around 40 ms. No way we could incur that.\n3. If the file does not exists or it is localized on a bad disk. We need to keep track of those as well to remove them from the disk as suggested in the Jason's comment. We can't delete blindly from the disk if refcount is greater than one. \nCan we logically separate the original problem and related problem of zombie files and address them in separate JIRA?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-06-30T10:31:44.354+0000","updated":"2015-06-30T10:31:44.354+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14634635","id":"14634635","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Hi [~jlowe], Can we get some input on the previous comment?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-07-21T07:04:51.001+0000","updated":"2015-07-21T07:04:51.001+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14635292","id":"14635292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Sorry for the delay, as I was on vacation and am still working through the backlog.  An incremental improvement where we try to avoid using bad/non-existent resources for future containers but still fail to cleanup old resources on bad disks sounds fine to me.  IIUC it fixes some problems we have today without creating new ones.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-07-21T15:49:23.369+0000","updated":"2015-07-21T15:49:23.369+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14635499","id":"14635499","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 for [~jlowe]'s comment. Yes, It fixes some problems we have today without creating new ones.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zxu","name":"zxu","key":"zxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhihai xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-21T18:00:11.794+0000","updated":"2015-07-21T18:00:11.794+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14661604","id":"14661604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Updated the patch with the initial solution.\n1. It does not add any overhead. Hardly few microseconds.\n2. It does not introduce new problems.\n3. it solves the use case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-08-07T10:21:24.499+0000","updated":"2015-08-07T10:21:24.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14661606","id":"14661606","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Marking sub-tasks to be invalid.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-08-07T10:24:11.977+0000","updated":"2015-08-07T10:24:11.977+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14661674","id":"14661674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  16m 14s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:red}-1{color} | tests included |   0m  0s | The patch doesn't appear to include any new or modified tests.  Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. |\n| {color:green}+1{color} | javac |   7m 45s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 54s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 39s | The applied patch generated  2 new checkstyle issues (total was 20, now 21). |\n| {color:red}-1{color} | whitespace |   0m  0s | The patch has 1  line(s) that end in whitespace. Use git apply --whitespace=fix. |\n| {color:green}+1{color} | install |   1m 20s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 32s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m 13s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:red}-1{color} | yarn tests |   6m  8s | Tests failed in hadoop-yarn-server-nodemanager. |\n| | |  44m 10s | |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed unit tests | hadoop.yarn.server.nodemanager.TestDeletionService |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12749233/YARN-3591.6.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / b6265d3 |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/8787/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/8787/artifact/patchprocess/whitespace.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8787/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8787/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf904.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8787/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-07T11:22:13.135+0000","updated":"2015-08-07T11:22:13.135+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14661836","id":"14661836","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  16m  9s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:red}-1{color} | tests included |   0m  0s | The patch doesn't appear to include any new or modified tests.  Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. |\n| {color:green}+1{color} | javac |   7m 46s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |   9m 41s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |\n| {color:green}+1{color} | checkstyle |   0m 37s | There were no new checkstyle issues. |\n| {color:red}-1{color} | whitespace |   0m  0s | The patch has 2  line(s) that end in whitespace. Use git apply --whitespace=fix. |\n| {color:green}+1{color} | install |   1m 21s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 34s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m 16s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:red}-1{color} | yarn tests |   6m  6s | Tests failed in hadoop-yarn-server-nodemanager. |\n| | |  43m 57s | |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed unit tests | hadoop.yarn.server.nodemanager.TestNodeStatusUpdaterForLabels |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12749253/YARN-3591.7.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / b6265d3 |\n| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/8789/artifact/patchprocess/whitespace.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8789/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8789/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf909.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8789/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-07T13:42:39.764+0000","updated":"2015-08-07T13:42:39.764+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14727058","id":"14727058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Updating the patch after discussing with [~vvasudev] offline.\nThanks Varun for suggestions. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-09-02T09:22:49.507+0000","updated":"2015-09-02T09:22:49.507+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14727155","id":"14727155","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  19m 33s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 1 new or modified test files. |\n| {color:green}+1{color} | javac |  10m 43s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |  12m 13s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 25s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 48s | The applied patch generated  2 new checkstyle issues (total was 172, now 174). |\n| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 54s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 41s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m 29s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:green}+1{color} | yarn tests |   8m 10s | Tests passed in hadoop-yarn-server-nodemanager. |\n| | |  56m  0s | |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12753729/YARN-3591.8.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / 095ab9a |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/8970/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8970/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8970/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf901.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8970/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-02T10:41:46.047+0000","updated":"2015-09-02T10:41:46.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14727698","id":"14727698","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the latest patch Lavkesh! Couple of comments -\n1.\nInstead of \n{code}\n+    this.dirsHandler = dirHandler;\n{code}\nin the new constructors you added, can you add that line to\n{code}\nLocalResourcesTrackerImpl(String user, ApplicationId appId,\n      Dispatcher dispatcher,\n      ConcurrentMap<LocalResourceRequest,LocalizedResource> localrsrc,\n      boolean useLocalCacheDirectoryManager, Configuration conf,\n      NMStateStoreService stateStore)\n{code}\nand have the other constructors call this one? Pass null for the directory handler if the existing constructors are called.\n\n2.\n{code}\n+      ret |= isParent(rsrc.getLocalPath().toUri().getPath(), dir);\n{code}\nWe don't need to iterate through all the local dirs. Once ret is true we can break the loop and return.\n\nRest of the patch looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-09-02T17:38:19.104+0000","updated":"2015-09-02T17:38:19.104+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14728722","id":"14728722","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~vvasudev] for comments.\nUpdated the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2015-09-03T09:00:30.605+0000","updated":"2015-09-03T09:00:30.605+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14729674","id":"14729674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  16m 36s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  1s | The patch does not contain any @author tags. |\n| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 2 new or modified test files. |\n| {color:green}+1{color} | javac |   7m 52s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |  10m  0s | There were no new javadoc warning messages. |\n| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |\n| {color:red}-1{color} | checkstyle |   0m 37s | The applied patch generated  1 new checkstyle issues (total was 171, now 169). |\n| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 28s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 34s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   1m 15s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:red}-1{color} | yarn tests |   7m 30s | Tests failed in hadoop-yarn-server-nodemanager. |\n| | |  46m 20s | |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed unit tests | hadoop.yarn.server.nodemanager.TestNodeStatusUpdaterForLabels |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12753942/YARN-3591.9.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / 53c38cc |\n| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/9002/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |\n| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9002/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9002/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf907.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9002/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-03T19:55:32.081+0000","updated":"2015-09-03T19:55:32.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14730374","id":"14730374","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"+1 for the latest patch. I'll commit this tomorrow if no one objects.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-09-04T06:18:17.740+0000","updated":"2015-09-04T06:18:17.740+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733275","id":"14733275","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"body":"Committed to trunk and branch-2. Thanks [~lavkesh]!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvasudev","name":"vvasudev","key":"vvasudev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varun Vasudev","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-09-07T06:08:08.031+0000","updated":"2015-09-07T06:08:08.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733280","id":"14733280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-trunk-Commit #8409 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/8409/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T06:14:31.972+0000","updated":"2015-09-07T06:14:31.972+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733321","id":"14733321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk #2300 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2300/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T07:11:47.752+0000","updated":"2015-09-07T07:11:47.752+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733353","id":"14733353","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #357 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/357/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T07:48:49.395+0000","updated":"2015-09-07T07:48:49.395+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733372","id":"14733372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #351 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/351/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T08:15:48.432+0000","updated":"2015-09-07T08:15:48.432+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733419","id":"14733419","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Hadoop-Yarn-trunk #1089 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/1089/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T08:47:55.177+0000","updated":"2015-09-07T08:47:55.177+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733462","id":"14733462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk #2278 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2278/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T09:35:27.461+0000","updated":"2015-09-07T09:35:27.461+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/14733471","id":"14733471","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #339 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/339/])\nYARN-3591. Resource localization on a bad disk causes subsequent containers failure. Contributed by Lavkesh Lahngir. (vvasudev: rev 1dbd8e34a7d97c4d8586da79c980d8f2e0aad61d)\n* hadoop-yarn-project/CHANGES.txt\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/LocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/ResourceLocalizationService.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestLocalResourcesTrackerImpl.java\n* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/localizer/TestResourceRetention.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-07T09:42:01.253+0000","updated":"2015-09-07T09:42:01.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12828009/comment/16042656","id":"16042656","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kwx417842","name":"kwx417842","key":"kwx417842","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kiran N","active":true,"timeZone":"Etc/UTC"},"body":"Can this be backported to 2.7.4..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kwx417842","name":"kwx417842","key":"kwx417842","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kiran N","active":true,"timeZone":"Etc/UTC"},"created":"2017-06-08T13:03:04.524+0000","updated":"2017-06-08T13:03:04.524+0000"}],"maxResults":64,"total":64,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/YARN-3591/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2ef6f:"}}