{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Jian He",
            "key": "jianhe",
            "name": "jianhe",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jianhe",
            "timeZone": "America/Los_Angeles"
        },
        "components": [{
            "id": "12319323",
            "name": "nodemanager",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12319323"
        }],
        "created": "2013-06-20T17:55:04.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=criccomini&avatarId=27141",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=criccomini&avatarId=27141",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=criccomini&avatarId=27141",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=criccomini&avatarId=27141"
            },
            "displayName": "Chris Riccomini",
            "key": "criccomini",
            "name": "criccomini",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=criccomini",
            "timeZone": "America/Los_Angeles"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2013-06-20T18:24:07.290+0000",
        "customfield_12310222": "1_*:*_1_*:*_2424907252_*|*_5_*:*_1_*:*_0",
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "3.0",
        "customfield_12310320": null,
        "customfield_12310420": "334252",
        "customfield_12310920": "334578",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i1lnr3:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jul 18 19:30:11 UTC 2013",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "Hey Guys,\n\nI'm running YARN 2.0.5-alpha with CGroups and stateful RM turned on, and I'm seeing containers getting leaked by the NMs. I'm not quite sure what's going on -- has anyone seen this before? I'm concerned that maybe it's a mis-understanding on my part about how YARN's lifecycle works.\n\nWhen I look in my AM logs for my app (not an MR app master), I see:\n\n2013-06-19 05:34:22 AppMasterTaskManager [INFO] Got an exit code of -100. This means that container container_1371141151815_0008_03_000002 was killed by YARN, either due to being released by the application master or being 'lost' due to node failures etc.\n2013-06-19 05:34:22 AppMasterTaskManager [INFO] Released container container_1371141151815_0008_03_000002 was assigned task ID 0. Requesting a new container for the task.\n\nThe AM has been running steadily the whole time. Here's what the NM logs say:\n\n{noformat}\n05:34:59,783  WARN AsyncDispatcher:109 - Interrupted Exception while stopping\njava.lang.InterruptedException\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Thread.join(Thread.java:1143)\n        at java.lang.Thread.join(Thread.java:1196)\n        at org.apache.hadoop.yarn.event.AsyncDispatcher.stop(AsyncDispatcher.java:107)\n        at org.apache.hadoop.yarn.service.CompositeService.stop(CompositeService.java:99)\n        at org.apache.hadoop.yarn.service.CompositeService.stop(CompositeService.java:89)\n        at org.apache.hadoop.yarn.server.nodemanager.NodeManager.stop(NodeManager.java:209)\n        at org.apache.hadoop.yarn.server.nodemanager.NodeManager.handle(NodeManager.java:336)\n        at org.apache.hadoop.yarn.server.nodemanager.NodeManager.handle(NodeManager.java:61)\n        at org.apache.hadoop.yarn.event.AsyncDispatcher.dispatch(AsyncDispatcher.java:130)\n        at org.apache.hadoop.yarn.event.AsyncDispatcher$1.run(AsyncDispatcher.java:77)\n        at java.lang.Thread.run(Thread.java:619)\n05:35:00,314  WARN ContainersMonitorImpl:463 - org.apache.hadoop.yarn.server.nodemanager.containermanager.monitor.ContainersMonitorImpl is interrupted. Exiting.\n05:35:00,434  WARN CgroupsLCEResourcesHandler:166 - Unable to delete cgroup at: /cgroup/cpu/hadoop-yarn/container_1371141151815_0006_01_001598\n05:35:00,434  WARN CgroupsLCEResourcesHandler:166 - Unable to delete cgroup at: /cgroup/cpu/hadoop-yarn/container_1371141151815_0008_03_000002\n05:35:00,434  WARN ContainerLaunch:247 - Failed to launch container.\njava.io.IOException: java.lang.InterruptedException\n        at org.apache.hadoop.util.Shell.runCommand(Shell.java:205)\n        at org.apache.hadoop.util.Shell.run(Shell.java:129)\n        at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:322)\n        at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:230)\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:242)\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:68)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n05:35:00,434  WARN ContainerLaunch:247 - Failed to launch container.\njava.io.IOException: java.lang.InterruptedException\n        at org.apache.hadoop.util.Shell.runCommand(Shell.java:205)\n        at org.apache.hadoop.util.Shell.run(Shell.java:129)\n        at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:322)\n        at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:230)\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:242)\n        at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:68)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n{noformat}\n\nAnd, if I look on the machine that's running container_1371141151815_0008_03_000002, I see:\n\n{noformat}\n$ ps -ef | grep container_1371141151815_0008_03_000002\ncriccomi  5365 27915 38 Jun18 ?        21:35:05 /export/apps/jdk/JDK-1_6_0_21/bin/java -cp /path-to-yarn-data-dir/usercache/criccomi/appcache/application_1371141151815_0008/container_1371141151815_0008_03_000002/...\n{noformat}\n\nThe same holds true for container_1371141151815_0006_01_001598. When I look in the container logs, it's just happily running. No kill signal appears to be sent, and no error appears.\n\nLastly, the RM logs show no major events around the time of the leak (5:35am). I am able to reproduce this simply by waiting about 12 hours, or so, and it seems to have started happening after I switched over to CGroups and LCE, and turned on stateful RM (using file system).\n\nAny ideas what's going on?\n\nThanks!\nChris",
        "duedate": null,
        "environment": "YARN 2.0.5-alpha with patches applied for YARN-799 and YARN-600.",
        "fixVersions": [],
        "issuelinks": [{
            "id": "12372315",
            "outwardIssue": {
                "fields": {
                    "issuetype": {
                        "avatarId": 21133,
                        "description": "A problem which impairs or prevents the functions of the product.",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                        "id": "1",
                        "name": "Bug",
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                        "subtask": false
                    },
                    "priority": {
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                        "id": "3",
                        "name": "Major",
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
                    },
                    "status": {
                        "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                        "id": "6",
                        "name": "Closed",
                        "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                        "statusCategory": {
                            "colorName": "green",
                            "id": 3,
                            "key": "done",
                            "name": "Done",
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
                        }
                    },
                    "summary": "Containers not cleaned up when NM received SHUTDOWN event from NodeStatusUpdater"
                },
                "id": "12647870",
                "key": "YARN-688",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/12647870"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12372315",
            "type": {
                "id": "12310000",
                "inward": "is duplicated by",
                "name": "Duplicate",
                "outward": "duplicates",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
            }
        }],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12313722&avatarId=15135",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12313722&avatarId=15135",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12313722&avatarId=15135",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12313722&avatarId=15135"
            },
            "id": "12313722",
            "key": "YARN",
            "name": "Hadoop YARN",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12313722"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=criccomini&avatarId=27141",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=criccomini&avatarId=27141",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=criccomini&avatarId=27141",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=criccomini&avatarId=27141"
            },
            "displayName": "Chris Riccomini",
            "key": "criccomini",
            "name": "criccomini",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=criccomini",
            "timeZone": "America/Los_Angeles"
        },
        "resolution": {
            "description": "The problem is a duplicate of an existing issue.",
            "id": "3",
            "name": "Duplicate",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/3"
        },
        "resolutiondate": "2013-07-18T19:30:11.000+0000",
        "status": {
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "id": "5",
            "name": "Resolved",
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "YARN NM leaking containers with CGroups",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2013-07-18T19:30:11.000+0000",
        "versions": [{
            "archived": false,
            "description": "maintenance release on branch-2.0-alpha",
            "id": "12324429",
            "name": "2.0.5-alpha",
            "releaseDate": "2013-06-06",
            "released": false,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12324429"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/YARN-864/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/YARN-864/watchers",
            "watchCount": 17
        },
        "workratio": -1
    },
    "id": "12653975",
    "key": "YARN-864",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12653975"
}