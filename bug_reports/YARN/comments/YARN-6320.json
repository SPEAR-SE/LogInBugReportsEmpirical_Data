[Excellent idea. That's something we've been kicking around for a while.  YARN-5139 proposes that model for the capacity scheduler.  Have a look at the specs there for a sense of scope., As Daniel mentioned, we have been thinking about something like this for a while now.

One thing to watch out for is the list of apps maintained needs to be sorted appropriately. If this list is not sorted, we might end up giving the same app multiple containers probably ignoring a more deserving app. In a queue hierarchy with FAIR, DRF and FIFO policies, this global sorting of apps is hard. , [~kasha] thank you for sharing your comment.
I try to do like that, we compute resource deficit for every app considering policies in updateThread. In the list of apps maintained, we sort apps by the amount of resource deficit.  And generally we try to assign container to apps with the most resource deficit in each nodeUpdate., I think I have solved the problem and in my test environment the scheduler can assign over 5000 containers per second.]