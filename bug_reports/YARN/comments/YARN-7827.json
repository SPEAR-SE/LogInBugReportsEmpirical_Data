[Thanks [~yeshavora].

Native service end point is changed post branch merge. I will upload a patch shortly., Does this work if ATSv2 is disabled? , Sorry [~vrushalic]. Missed ur comments. This is not related to ATSv2. Native service REST end point was changed, and hence this issue came.

 

[~leftnoteasy] I have used dr.who as user to submit services. Could you please help to check the same., The change looks straightforward, but I'm not sure if there's anything else we need to do for native services. [~jianhe] could u please share ur thoughts here?, | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 24s{color} | {color:blue} Docker mode activated. {color} |
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
|| || || || {color:brown} trunk Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m 16s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 24m 35s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  9m 51s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 16s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 35m 27s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:5b98639 |
| JIRA Issue | YARN-7827 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12908290/YARN-7827.001.patch |
| Optional Tests |  asflicense  shadedclient  |
| uname | Linux 0f9576e7ae03 4.4.0-89-generic #112-Ubuntu SMP Mon Jul 31 19:38:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / f666e7c |
| maven | version: Apache Maven 3.3.9 |
| Max. process+thread count | 417 (vs. ulimit of 5000) |
| modules | C: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui U: hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/19521/console |
| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, User.name shouldn't be hard code to dr.who.  The end username should be passed in the request for simple security and without user.name parameter for Kerberos enabled browser.  See the section "Accessing the server using curl" in hadoop auth [example|https://hadoop.apache.org/docs/current/hadoop-auth/Examples.html]. 
, Patch is cancelled as it is not very correct to pass user.name form UI. However native service needs user.name in all type of cases (Secure/non-secure/single user etc). Once that is fixed, this Jira will be resumed., # user.name will be asked to user while submitting a new service. user can enter this service will be deployed as per this user
 # for stop/delete, app owner name will be appended from UI always.
 # for secure cluster also, we ll send this info for now.

[~jianhe] is this enough to handle all scenarios?, Hi [~sunilg], the comment looks good.  Can you also change hadoop.http.cross-origin.allowed-methods = GET,POST,PUT,DELETE?  Without properly setting CORS filter, the new UI will encounter permission denied when using the new REST API methods.  Thanks, In kerberos enabled environment, if CORS filter is enabled, we also need to make sure that {{hadoop.http.cross-origin.allowed-headers}} is configured properly to include: {{WWW-Authenticate,X-Requested-With,Content-Type,Accept,Origin,Accept-Encoding,Transfer-Encoding}}.  There could be more filters required that I haven't discovered.

, Thanks [~eyang].

I changed hadoop.http.cross-origin.allowed-methods to add these methods in my cluster while testing. [https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/HttpAuthentication.html] mentions about this configuration in apache, so based on that i changed. I dont think we need to change this doc, correct.

For UI perspective, we will add these information to the doc so that cluster admin could take care of same., Hi [~sunilg],

Thank you for the patch.  Overall, the patch is in the right direction.  One nit pick about having User Name for service, this properly should not be a user input.  It can be refined to an ajax call to resource manager to figure out who is the currently connected user for simple security., [~sunilg] For supporting knox, it would be good for javascript to detect the url entering /ui2 and process user.name property.  If there isn't one found, then proceed with ajax call to resource manager to find out who is the current user to pass the parameter along the rest api calls., Thanks [~eyang]

bq.It can be refined to an ajax call to resource manager to figure out who is the currently connected user for simple security.

UI when it send the requests, server wont be knowing connected user. So as a stop-gap solution till get a better model, I thought of having this option. Does it make sense?

bq.For supporting knox, it would be good for javascript to detect the url entering /ui2 and process user.name property. 

This makes sense. I ll check that feasibility, but if its need more change, i ll handle in other Jira so that this could be unblocked.

 , I committed the patch to trunk, we can open separate jira to unblock the issue.
, YARN-7912 is raised to handle KNOX scenario., SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #13637 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/13637/])
YARN-7827. Stop and Delete Yarn Service from RM UI fails with HTTP ERROR (jianhe: rev ddec08d7ccc8e43492fca2784203bd8af5e968cc)
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/controllers/yarn-app/info.js
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/components/deploy-service.js
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/templates/components/deploy-service.hbs
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/templates/yarn-app/info.hbs
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/adapters/yarn-servicedef.js
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/controllers/yarn-deploy-service.js
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/controllers/yarn-app.js
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/templates/yarn-app.hbs
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/app/utils/info-seeder.js
* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-ui/src/main/webapp/config/default-config.js
]