[{color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12688081/YARN-2936.001.patch
  against trunk revision 389f881.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:red}-1 findbugs{color}.  The patch appears to introduce 39 new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager:

                  org.apache.hadoop.yarn.server.resourcemanager.TestWorkPreservingRMRestart
                  org.apache.hadoop.yarn.server.resourcemanager.TestRM

                                      The following test timeouts occurred in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager:

org.apache.hadoop.yarn.server.resourcemanager.TestRMRestart

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6147//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-YARN-Build/6147//artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-server-resourcemanager.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-YARN-Build/6147//artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-common.html
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6147//console

This message is automatically generated., [~zjshen], [~jianhe], kindly review.

Findbugs to be handled by YARN-2937 to YARN-2940.
Test failure unrelated and all these tests are passing in my local setup., [~varun_saxena], thanks for taking on this !

Maybe a simply way is to do this: 
{code}
  public YARNDelegationTokenIdentifierProto getProto() {
    builder.setOwner(getOwner().toString());
    builder.setRenewer(getRenewer().toString());
    builder.setRealUser(getRealUser().toString());
    builder.setIssueDate(getIssueDate());
    builder.setMaxDate(getMaxDate());
    builder.setSequenceNumber(getSequenceNumber());
    builder.setMasterKeyId(getMasterKeyId());
    return builder.build();
  }
{code}
and create a common method for these setters , bq. Maybe a simply way is to do this.
Hmm...Sounds better. Will make the change., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12689215/YARN-2936.002.patch
  against trunk revision 1454efe.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6198//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6198//console

This message is automatically generated., thanks, looks good, mind writing a unit test? TestYARNTokenIdentifier.java has some existing tests., [~jianhe], kindly review. Added some test code. Although its quite similar to preceding test code in the test case., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12689248/YARN-2936.003.patch
  against trunk revision 1454efe.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6199//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6199//console

This message is automatically generated., Weird. How is it -1 overall when its +1 for everything, bq. Maybe a simply way is to do this:

If either write() is called before getProto() or vice versa, the builder object is set twice. Is it better to recover the override setters/getters, and implement them properly as well as getProto? Similar to what we have done in a XXXXPBImpl?, Or to keep simple, for
{code}
    builder.setOwner(getOwner().toString());
    builder.setRenewer(getRenewer().toString());
    builder.setRealUser(getRealUser().toString());
    builder.setIssueDate(getIssueDate());
    builder.setMaxDate(getMaxDate());
    builder.setSequenceNumber(getSequenceNumber());
    builder.setMasterKeyId(getMasterKeyId());
{code}
Can we do something like
{code}
    if (builder.getOwner() is not equal to getOwner()) {
         builder.setOwner(getOwner().toString());
    }
{code}
To only set builder when the value is updated., bq. Can we do something like
thanks Zhijie !  +1 for this, [~zjshen], thanks for the suggestion. Uploading a new patch, {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12689373/YARN-2936.004.patch
  against trunk revision 241d3b3.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6203//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6203//console

This message is automatically generated., looks good, one nit:
{{builder.getOwner().toString()}} already returns String type, so the toString is unnecessary, similar for getRenewer and getUser., [~jianhe], correct. Uploading a new patch, just one more thing, the newly added test is passing without the core change. could you update the test to pass with the core change but fail without the change ?, {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12689373/YARN-2936.004.patch
  against trunk revision 249cc90.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6204//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6204//console

This message is automatically generated., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12689383/YARN-2936.005.patch
  against trunk revision 249cc90.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:red}-1 eclipse:eclipse{color}.  The patch failed to build with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in .

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6206//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6206//console

This message is automatically generated., eclipse:eclipse failing due to some problem in Jenkins. Below message is coming.
/home/jenkins/jenkins-slave/workspace/PreCommit-YARN-Build@2/dev-support/test-patch.sh: line 692: /home/jenkins/jenkins-slave/workspace/PreCommit-YARN-Build@2/../patchprocess/patchEclipseOutput.txt: No such file or directory, eclipse:eclipse passes in my local build, bq. the newly added test is passing without the core change. could you update the test to pass with the core change but fail without the change ?
thanks for updating. could you see if my last comment make sense ? thanks, [~jianhe], sorry couldnt get you. What do you mean by core change ? The newly added test code calls getProto and that is where the change is., sorry for confusion, I meant the core/production code (not test code) change., Oh you mean, the newly added test code passes even without the change. Will look at it and change test accordingly., [~jianhe], changed the test. Kindly review., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12690457/YARN-2936.006.patch
  against trunk revision 788ee35.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/6261//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/6261//console

This message is automatically generated., Committed to trunk and branch-2,  thanks [~varun_saxena] !, FAILURE: Integrated in Hadoop-trunk-Commit #6825 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/6825/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
* hadoop-yarn-project/CHANGES.txt
, FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #67 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/67/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
, SUCCESS: Integrated in Hadoop-Yarn-trunk #801 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/801/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
* hadoop-yarn-project/CHANGES.txt
, SUCCESS: Integrated in Hadoop-Hdfs-trunk #1999 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1999/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
, SUCCESS: Integrated in Hadoop-Hdfs-trunk-Java8 #64 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/64/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #68 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/68/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #2018 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2018/])
YARN-2936. Changed YARNDelegationTokenIdentifier to set proto fields on getProto method. Contributed by Varun Saxena (jianhe: rev 2638f4d0f0da375b0dd08f3188057637ed0f32d5)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/security/TestYARNTokenIdentifier.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/YARNDelegationTokenIdentifier.java
]