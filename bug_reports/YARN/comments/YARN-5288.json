[Thanks for reporting this issue [~yufeigu]! Can YARN-3727 fix your issue? YARN-3727 will delete the leftover files and move to the next directory if the leftover files is there., [~zxu], thanks a lot for comments. Seems like YARN-3727 can solve the issue on-the-fly. But these leftover files are not supposed to there anyway. 
Besides the NM restart issue, did you observe any other reason to cause file leftover in user cache?]