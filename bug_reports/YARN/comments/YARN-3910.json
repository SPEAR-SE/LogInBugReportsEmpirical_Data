[We were not waiting for app attempt start related transitions to finish, {noformat}
2015-07-10 07:45:23,412 INFO  [main] security.AMRMTokenSecretManager (AMRMTokenSecretManager.java:<init>(94)) - AMRMTokenKeyRollingInterval: 86400000ms and AMRMTokenKeyActivationDelay: 900000 ms
2015-07-10 07:45:23,412 INFO  [main] security.RMContainerTokenSecretManager (RMContainerTokenSecretManager.java:<init>(77)) - ContainerTokenKeyRollingInterval: 86400000ms and ContainerTokenKeyActivationDelay: 900000ms
2015-07-10 07:45:23,413 INFO  [main] security.NMTokenSecretManagerInRM (NMTokenSecretManagerInRM.java:<init>(75)) - NMTokenKeyRollingInterval: 86400000ms and NMTokenKeyActivationDelay: 900000ms
2015-07-10 07:45:23,421 INFO  [main] event.AsyncDispatcher (AsyncDispatcher.java:register(197)) - Registering class org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStoreEventType for class org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore$ForwardingEventHandler
2015-07-10 07:45:23,422 INFO  [main] event.AsyncDispatcher (AsyncDispatcher.java:register(197)) - Registering class org.apache.hadoop.yarn.server.resourcemanager.rmapp.attempt.RMAppAttemptEventType for class org.apache.hadoop.yarn.server.resourcemanager.rmapp.TestRMAppTransitions$TestApplicationAttemptEventDispatcher
2015-07-10 07:45:23,422 INFO  [main] event.AsyncDispatcher (AsyncDispatcher.java:register(197)) - Registering class org.apache.hadoop.yarn.server.resourcemanager.rmapp.RMAppEventType for class org.apache.hadoop.yarn.server.resourcemanager.rmapp.TestRMAppTransitions$TestApplicationEventDispatcher
2015-07-10 07:45:23,422 INFO  [main] event.AsyncDispatcher (AsyncDispatcher.java:register(197)) - Registering class org.apache.hadoop.yarn.server.resourcemanager.RMAppManagerEventType for class org.apache.hadoop.yarn.server.resourcemanager.rmapp.TestRMAppTransitions$TestApplicationManagerEventDispatcher
2015-07-10 07:45:23,422 INFO  [main] event.AsyncDispatcher (AsyncDispatcher.java:register(197)) - Registering class org.apache.hadoop.yarn.server.resourcemanager.scheduler.event.SchedulerEventType for class org.apache.hadoop.yarn.server.resourcemanager.rmapp.TestRMAppTransitions$TestSchedulerEventDispatcher
2015-07-10 07:45:23,423 INFO  [main] rmapp.TestRMAppTransitions (TestRMAppTransitions.java:testAppAcceptedAttemptKilled(725)) - --- START: testAppAcceptedAttemptKilled ---
2015-07-10 07:45:23,423 WARN  [main] rmapp.RMAppImpl (RMAppImpl.java:<init>(414)) - The specific max attempts: 0 for application: 33 is invalid, because it is out of the range [1, 2]. Use the global max attempts instead.
2015-07-10 07:45:23,425 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:transition(1042)) - Storing application with id application_1436514322006_0033
2015-07-10 07:45:23,425 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:handle(768)) - application_1436514322006_0033 State change from NEW to NEW_SAVING
2015-07-10 07:45:23,425 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:handle(768)) - application_1436514322006_0033 State change from NEW_SAVING to SUBMITTED
2015-07-10 07:45:23,426 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:handle(768)) - application_1436514322006_0033 State change from SUBMITTED to ACCEPTED
2015-07-10 07:45:23,427 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:rememberTargetTransitionsAndStoreState(1061)) - Updating application application_1436514322006_0033 with final state: KILLED
2015-07-10 07:45:23,427 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:handle(768)) - application_1436514322006_0033 State change from ACCEPTED to FINAL_SAVING
2015-07-10 07:45:23,428 INFO  [main] rmapp.RMAppImpl (RMAppImpl.java:handle(768)) - application_1436514322006_0033 State change from FINAL_SAVING to KILLED
2015-07-10 07:45:23,428 INFO  [AsyncDispatcher event handler] resourcemanager.ApplicationMasterService (ApplicationMasterService.java:registerAppAttempt(699)) - Registering app attempt : appattempt_1436514322006_0033_000001
2015-07-10 07:45:23,429 INFO  [AsyncDispatcher event handler] attempt.RMAppAttemptImpl (RMAppAttemptImpl.java:handle(793)) - appattempt_1436514322006_0033_000001 State change from NEW to SUBMITTED
{noformat}, Hi Varun,

Its possible that the schedulerDispatcher.lastSchedulerEvent is null if its not been set yet. Check for not null as well in the while loop would be good in that case. 
It would be nicer to reduce the sleep to 100 instead of 1000. , \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |   6m 48s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 1 new or modified test files. |
| {color:green}+1{color} | javac |   7m 46s | There were no new javac warning messages. |
| {color:green}+1{color} | release audit |   0m 21s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   0m 36s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 21s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 31s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   1m 27s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |
| {color:red}-1{color} | yarn tests |  50m 53s | Tests failed in hadoop-yarn-server-resourcemanager. |
| | |  69m 47s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.yarn.server.resourcemanager.scheduler.fair.TestAllocationFileLoaderService |
| Timed out tests | org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.TestContainerAllocation |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12744782/YARN-3910.001.patch |
| Optional Tests | javac unit findbugs checkstyle |
| git revision | trunk / 47f4c54 |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8501/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8501/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf903.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8501/console |


This message was automatically generated., [~adhoot], updated patch after addressing your comments, \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | pre-patch |   5m 38s | Findbugs (version ) appears to be broken on trunk. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 1 new or modified test files. |
| {color:green}+1{color} | javac |   7m 39s | There were no new javac warning messages. |
| {color:green}+1{color} | release audit |   0m 19s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   0m 22s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 22s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 31s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   1m 26s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |
| {color:red}-1{color} | yarn tests |  51m 26s | Tests failed in hadoop-yarn-server-resourcemanager. |
| | |  68m 46s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.yarn.server.resourcemanager.TestApplicationCleanup |
|   | hadoop.yarn.server.resourcemanager.TestResourceTrackerService |
|   | hadoop.yarn.server.resourcemanager.applicationsmanager.TestAMRMRPCNodeUpdates |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12744879/YARN-3910.02.patch |
| Optional Tests | javac unit findbugs checkstyle |
| git revision | trunk / 1ea3629 |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/8506/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/8506/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf905.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/8506/console |


This message was automatically generated., LGTM. Tried out the changes and even if I force slow down the scheduler dispatcher thread to simulate a slow machine it still passes., Thanks [~adhoot] for reviewing. Found out the root cause which is causing other test failures as well. Raised YARN-3916 for it., Closing this as duplicate]