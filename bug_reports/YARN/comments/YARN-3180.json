[The tests makes the assumption that "bin" is a valid user. The real problem was triggered for "hdfs". 

If you do not apply the patch to container-executor.c test-container-executor dies. , Is this a dup of YARN-2847?, Seems like it. The fix to the logic is the same. The test is different. I do test the exact environment, the other test does test much more than simply the check_user() call.

The patch does not apply on git trunk.

please apply either .]