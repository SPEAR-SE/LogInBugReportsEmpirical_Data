[Andy - can you pls add a testcase for DCE for the fix you made via MAPREDUCE-2374? Thanks., Arun,

I commented on MAPREDUCE-2374, but I guess this is a better forum.
# I'd be happy to add a testcase, but how would you suggest that we detect the race condition? Note that the ETXTBSY failure happens only on some systems, only under load, and only if a script is written from the daemon and then executed by the shell.
# note that if we simply add a testcase which reproduces the failure scenario, it will continue to pass even if the bug is reintroduced.  It will only fail if the race condition is triggered, which seems to be impossible on some Linux versions (I never managed to reproduce ETXTBSY on Debian or Ubuntu for example).
# There are other legitimate uses of "bash -c" where that's the only reasonable way to get the desired behavior, so we can't just prohibit the construct.

Thoughts?, Andy - Sorry, I was thinking along simpler lines - pull the cmd construction code into a utility function and just test the string for absence of "-c". This way, in future, if someone adds it back inadvertently we catch it. The reason I'm worried is that we've used 'bash -c' for a very long time in MR now, and hence is a bit of a worry. Makes sense? Thanks., Fair enough, I'll do that., I believe we are hitting this (or something similar) in the 2.3 branch. Has it been resolved somewhere?, Don't think this has been fixed in YARN. [~adi2], can I take this up?, From what I know, this is fixed via YARN-1271 + YARN-1295. Resolving as dup. Please reopen if you disagree.]