[This is expected. There's a difference between application state and application final status. Application state means the application state from YARN's perspective, while final status means the final finish status which AM provides.  AM provides final status to RM via unregister.  RM will think an app as FINISHED if it successfully unregisters, FAILED otherwise., [~jianhe] thanks for your explanation. If the state and final state are different, then the problem becomes that the queueMetrics.finishApp() uses 'state' to calculate number of failed apps. This means if an app failed but unregistered with RM successfully, its state will become FINISHED, and queueMetrics will consider this app as a completed app not a failed app.

Is this also expected?, that's right. , If this is expected, then it doesn't quite make sense. Because, there are many failed apps with successful unregistration, and from the queue metrics, it will not show any failed jobs., bq. there are many failed apps with successful unregistration, and from the queue metrics, it will not show any failed jobs.
The queue metrics will see successfully unregistered apps as completed, which is in line with what you are saying ?, yes, queue metrics currently will see this as completed jobs. However, in this case, should queue metrics see it as failed jobs? Since the final states are FAILED, Here,  queue metrics completed state equals to the FINISHED state we mentioned before. RM thinks the job as FINISHED, that's why queue metrics shows as completed., I see, thank you [~jianhe]]