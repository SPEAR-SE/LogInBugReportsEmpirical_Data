[Please add details of which processes are using the ports in question. In addition to that, what configuration value was set to make use of port 50010 and/or 44871?

, Nevermind, 50010 is the default datanode port. What process is opening up 44871? If it is the node manager, do you have log aggregation enabled? Could you try running the test with log aggregation disabled and let us know if the problem is still reproducible? , It sounds to me almost like it is log aggregation. If you launch lots of these in a tight loop it is likely that you are still aggregating the logs from the first few, while launching new ones very quickly.  If log aggregation cannot keep up you will run out of file descriptors.  Try turning off log aggregation and see what happens., Agree with analysis from [~hitesh] and [~revans2]. Resolving this as won't fix.

May be YARN-220 can help though, if we come around to having a fix there.]