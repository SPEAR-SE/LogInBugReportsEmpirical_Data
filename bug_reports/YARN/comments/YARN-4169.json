[This may be a transient race condition, but it is caused by {{resourceTracker.labels}} being null.

{code}
    assertNLCollectionEquals(resourceTracker.labels,
        dummyLabelsProviderRef
            .getNodeLabels());
{code}

Even if this isn't replicable
# the assert is getting the equals test wrong: expected comes first
# the {{assertNLCollectionEquals}} check needs some {{assertNotNull()}} checks with meaningful errors on its arguments, Hi [~steve_l]
This test is passing locally i will try to analyze more and also fix other issues which you mentioned .

, Hi [~stevel@apache.org],
   Was able to reproduce this test failure (NPE) during debug testing, and it was due to improper handling of race condition, basically after sending {{hearbeat}} we need to wait for a short duration in the test case for the HB thread in Node status updater, till it goes into wait state. If some sleep is not added then notify of {{sendOutofBandHeartBeat}} will be called even before HB thread  goes to wait state. Also have corrected other review comments which you had mentioned., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |  10m 26s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   8m 54s | There were no new javac warning messages. |
| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   2m 35s | There were no new checkstyle issues. |
| {color:red}-1{color} | whitespace |   0m  1s | The patch has 3  line(s) that end in whitespace. Use git apply --whitespace=fix. |
| {color:green}+1{color} | install |   1m 38s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 36s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   4m 41s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | yarn tests |   2m  9s | Tests passed in hadoop-yarn-common. |
| {color:red}-1{color} | yarn tests |   7m 48s | Tests failed in hadoop-yarn-server-nodemanager. |
| {color:green}+1{color} | yarn tests |  56m 20s | Tests passed in hadoop-yarn-server-resourcemanager. |
| | |  95m 35s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.yarn.server.nodemanager.containermanager.localizer.TestResourceLocalizationService |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12761714/YARN-4169.v1.001.patch |
| Optional Tests | javac unit findbugs checkstyle |
| git revision | trunk / cc2b473 |
| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/9237/artifact/patchprocess/whitespace.txt |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9237/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9237/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9237/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9237/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf907.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9237/console |


This message was automatically generated., I'm not the person to review YARN patches, I'm afraid.

Looking at the tests briefly
# you can use Java 7 <> tags in constructors; the old code was for java 6 and can be upgraded on the changed lines.
# no need to catch InterruptedExceptions and {{AssertFail()}}. Simply have the test declare it throws {{InterruptedException}} and JUnit will do the rest., Thanks for the comments [~stevel@apache.org], Will try to get it reviewed from either [~wangda] / [~rohithsharma] for YARN specific modifications.
But i dint get which part of modifications(class and line number) were you referring to for the first comment !, Attaching a patching fixing the both of [~steve_l] comments. Missed to understand the first comment earlier!
[~rohithsharma], can you please take a look at the patch, \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |   9m 20s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   7m 46s | There were no new javac warning messages. |
| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   2m 24s | There were no new checkstyle issues. |
| {color:red}-1{color} | whitespace |   0m  0s | The patch has 3  line(s) that end in whitespace. Use git apply --whitespace=fix. |
| {color:green}+1{color} | install |   1m 28s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 32s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   4m 13s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |
| {color:red}-1{color} | yarn tests |   1m 59s | Tests failed in hadoop-yarn-common. |
| {color:red}-1{color} | yarn tests |   8m  4s | Tests failed in hadoop-yarn-server-nodemanager. |
| {color:red}-1{color} | yarn tests |  54m 48s | Tests failed in hadoop-yarn-server-resourcemanager. |
| | |  91m  1s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.yarn.logaggregation.TestAggregatedLogsBlock |
|   | hadoop.yarn.server.nodemanager.webapp.TestNMWebServicesContainers |
|   | hadoop.yarn.server.nodemanager.webapp.TestNMWebServices |
|   | hadoop.yarn.server.nodemanager.webapp.TestNMWebServicesApps |
|   | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestChildQueueOrder |
|   | hadoop.yarn.server.resourcemanager.scheduler.fair.TestAllocationFileLoaderService |
|   | hadoop.yarn.server.resourcemanager.scheduler.TestAbstractYarnScheduler |
|   | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestNodeLabelContainerAllocation |
| Timed out tests | org.apache.hadoop.yarn.server.resourcemanager.TestAMAuthorization |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12762611/YARN-4169.v1.002.patch |
| Optional Tests | javac unit findbugs checkstyle |
| git revision | trunk / f0f984e |
| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/9278/artifact/patchprocess/whitespace.txt |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9278/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9278/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9278/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9278/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf905.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9278/console |


This message was automatically generated., Hi [~Naganarasimha],
Quickly gone through the patch.. some comments.
# I see many sleep int the tests. I have doubt that just adding sleep would solve random failure permanently. Again it depends on the machine it is running and other several factors. If wants to check NodeStausUpdator is in waiting state, probably can get thread state OR wait for thread state.
# Not related to this JIRA, can you add timeout for the tests., # If there is a way to query the state of the updater, then that is better to block on. If there isn't a way to query it, then maybe a way to check the status should be provided (e.g some AtomicBoolean).
# Even so, what we have here should be better than before? How about we start with this patch (with some minor changes) and then see how well it works?

Two needed changes
# {{timeout=}} attribute in the @Test.
# lower-case "l" values in Long integers are considered dangerous; better to have {{50L}} over {{50l}}, because the latter can look like 501 in some fonts. In {{Thread.sleep}} we can just have {{50}} without worrying about the L value at all, Thanks for the comments [~rohithsharma] & [~steve_l], 
Uploading a patch with incorporating both of your comments.
bq.  If wants to check NodeStausUpdator is in waiting state, probably can get thread state OR wait for thread state.
Yes this would be a better option as it would be more deterministic, thanks for the approach. 

But in general i think this is not just test case issue but also issue with {{NodeStatusUpdaterImpl.sendOutofBandHeartBeat}} which is not only called by the Testcases but also when *container is killed*. Suppose in large cluster we have HB as 5 seconds and when current call is in progress then call to {{sendOutofBandHeartBeat}} has no impact and the information of completed container is not shared till the next interval. So in my opinion sendOutofBandHeartBeat should return {{boolean}} informing the caller weather its successfull or not and also we can support some additional logic to push NM's HB earlier than the interval suggested by RM when outOfBandHB was not successful. Thoughts ? , Hi [~steve_l] & [~rohithsharma],
Any thoughts about the approach and the issue being discussed in the earlier comment  , Hi [~steve_l] & [~rohithsharma],
Any updates on the last patch or the comment ?, —just asked on YARN dev for some more expert review, [~Naganarasimha] / [~steve_l].

Thanks for looking at this issue.
IIUC, the problem is heartbeatMonitor has some racing conditions, which is caused by send OOB wait/notify implementation.

Looked at the patch, I think maybe do a small refactoring can avoid lots of complexities in your test:
- Pull updating logic from startStatusUpdater() to a separated method, for example: doStatusUpdate, it should be synchronized to make sure there's only one thread can access it. lastHeartbeatID needs to be a member variable.
- startStatusUpdater will use doStatusUpdate.
- Use doStatusUpdater in your test, since you have a synchronized ResourceTrackerService implementation, you don't need waitHeartbeat, etc.

Thoughts?, Thanks [~stevel@apache.org] for pointing this issue in yarn-dev and [~wangda] for the comments.
[~wangda] though initially me and Rohith thought about a similar approach we did not go for it as it was a critical path and we did not want to hold a synchronization locks just for the purpose of test case. 
Yes the approach you mentioned greatly simplifies the test case but may be we need to still wait for very first heartbeat to be completed and then we try to call {{doStatusUpdate}} to *avoid race conditions between them to set the NodeLabels*. so may be it will not completely solve the problem as we need some approach to identify first HB is over and thread is waiting. Also the current approach taken seems to solve the issue.
Besides as explained in earlier [comment|https://issues.apache.org/jira/browse/YARN-4169?focusedCommentId=14933149&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14933149] i feel the behavior of {{NodeStatusUpdaterImpl.sendOutofBandHeartBeat}} is not appropriate, your thoughts on it ?, Any thoughts on the above comment, [~rohithsharma] & [~wangda] ?, [~Naganarasimha], sorry for my late response, I think the approach in your latest patch looks good, we'd better not do major refactoring to NodeStatusUpdater. Rekicking Jenkins.., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | patch |   0m  0s | The patch command could not apply the patch during dryrun. |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12763997/YARN-4169.v1.003.patch |
| Optional Tests | javac unit findbugs checkstyle javadoc |
| git revision | trunk / 4c0bae2 |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9527/console |


This message was automatically generated., Hi [~wangda], haved rebased the patch , pls check ., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | pre-patch |  17m 29s | Findbugs (version ) appears to be broken on trunk. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   7m 53s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |  10m 23s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |
| {color:red}-1{color} | checkstyle |   1m 20s | The applied patch generated  1 new checkstyle issues (total was 30, now 31). |
| {color:red}-1{color} | whitespace |   0m  1s | The patch has 3  line(s) that end in whitespace. Use git apply --whitespace=fix. |
| {color:green}+1{color} | install |   1m 34s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |
| {color:red}-1{color} | findbugs |   4m 21s | The patch appears to introduce 3 new Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | yarn tests |   2m  1s | Tests passed in hadoop-yarn-common. |
| {color:green}+1{color} | yarn tests |   8m 57s | Tests passed in hadoop-yarn-server-nodemanager. |
| {color:red}-1{color} | yarn tests |  60m 30s | Tests failed in hadoop-yarn-server-resourcemanager. |
| | | 115m 42s | |
\\
\\
|| Reason || Tests ||
| FindBugs | module:hadoop-yarn-common |
| Failed unit tests | hadoop.yarn.server.resourcemanager.TestClientRMTokens |
|   | hadoop.yarn.server.resourcemanager.security.TestClientToAMTokens |
|   | hadoop.yarn.server.resourcemanager.security.TestAMRMTokens |
|   | hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairSchedulerQueueACLs |
|   | hadoop.yarn.server.resourcemanager.TestRMAdminService |
|   | hadoop.yarn.server.resourcemanager.scheduler.TestSchedulerUtils |
|   | hadoop.yarn.server.resourcemanager.TestAMAuthorization |
|   | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestCapacitySchedulerQueueACLs |
|   | hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairScheduler |
|   | hadoop.yarn.server.resourcemanager.TestApplicationACLs |
|   | hadoop.yarn.server.resourcemanager.scheduler.capacity.TestCapacityScheduler |
|   | hadoop.yarn.server.resourcemanager.TestClientRMService |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12768309/YARN-4169.v1.004.patch |
| Optional Tests | javac unit findbugs checkstyle javadoc |
| git revision | trunk / 35a303d |
| Pre-patch Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/trunkFindbugsWarningshadoop-yarn-server-nodemanager.html |
| checkstyle |  https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/diffcheckstylehadoop-yarn-server-nodemanager.txt |
| whitespace | https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/whitespace.txt |
| Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-common.html |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9548/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9548/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf905.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9548/console |


This message was automatically generated., Thanks for explanations, [~Naganarasimha]. Fix looks good and safe. Not sure if failed tests relate to changes, rekicking Jenkins., [~wangda], Test failures seems to be not related to the patch, Findbugs showed here is related to the YARN-1897 (can take care in this patch if ok as its a small fix !)
reuploading the patch after white space issues (not from modified lines again ! ) and check style issue, Oops dint see this message, triggered by new patch !, Oops dint see this message, triggered by new patch !, Oops dint see this message, triggered by new patch !, \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | pre-patch |  17m 44s | Findbugs (version ) appears to be broken on trunk. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   7m 59s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |  10m 26s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   1m 57s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 32s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 34s | The patch built with eclipse:eclipse. |
| {color:red}-1{color} | findbugs |   4m 20s | The patch appears to introduce 3 new Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | yarn tests |   2m  2s | Tests passed in hadoop-yarn-common. |
| {color:red}-1{color} | yarn tests |   8m 45s | Tests failed in hadoop-yarn-server-nodemanager. |
| {color:red}-1{color} | yarn tests |  50m 22s | Tests failed in hadoop-yarn-server-resourcemanager. |
| | | 106m  8s | |
\\
\\
|| Reason || Tests ||
| FindBugs | module:hadoop-yarn-common |
| Failed unit tests | hadoop.yarn.server.nodemanager.TestNodeStatusUpdaterForLabels |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesAppsModification |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesDelegationTokens |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesCapacitySched |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesNodeLabels |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesForCSWithPartitions |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesApps |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServices |
|   | hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesNodes |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12768459/YARN-4162.v2.005.patch |
| Optional Tests | javac unit findbugs checkstyle javadoc |
| git revision | trunk / 86c9222 |
| Pre-patch Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9558/artifact/patchprocess/trunkFindbugsWarningshadoop-yarn-server-nodemanager.html |
| Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9558/artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-common.html |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9558/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9558/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9558/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9558/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf906.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9558/console |


This message was automatically generated., TestNodeStatusUpdaterForLabels failing

{code}
Error Message: Heartbeat dint receive even after waiting


java.lang.AssertionError: Heartbeat dint receive even after waiting
	at org.junit.Assert.fail(Assert.java:88)
	at org.apache.hadoop.yarn.server.nodemanager.TestNodeStatusUpdaterForLabels$ResourceTrackerForLabels.waitTillHeartbeat(TestNodeStatusUpdaterForLabels.java:126)
	at org.apache.hadoop.yarn.server.nodemanager.TestNodeStatusUpdaterForLabels.testNodeStatusUpdaterForNodeLabels(TestNodeStatusUpdaterForLabels.java:285)
{code}, Hi [~steve_l] & [~wangda],
   bq. TestNodeStatusUpdaterForLabels failing
Thanks for informing, After yarn-4176, there was one more test case which was added which i had to cover. After fixing that it seems run fine. 
Also i have fixed the find bug induced from YARN-1897. , Other test failures related to *Bind exception* which are not related to this jira !, There is already a JIRA for findbugs issue, YARN-4223, \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | pre-patch |  19m 41s | Pre-patch trunk has 4 extant Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   7m 54s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |  10m 22s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 24s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   2m 18s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 30s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 34s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   4m 15s | The patch does not introduce any new Findbugs (version 3.0.0) warnings, and fixes 1 pre-existing warnings. |
| {color:green}+1{color} | yarn tests |   2m  0s | Tests passed in hadoop-yarn-common. |
| {color:green}+1{color} | yarn tests |   8m 55s | Tests passed in hadoop-yarn-server-nodemanager. |
| {color:green}+1{color} | yarn tests |  62m  2s | Tests passed in hadoop-yarn-server-resourcemanager. |
| | | 120m  0s | |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12768594/YARN-4162.v1.006.patch |
| Optional Tests | javac unit findbugs checkstyle javadoc |
| git revision | trunk / ab8eb87 |
| Pre-patch Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9564/artifact/patchprocess/trunkFindbugsWarningshadoop-yarn-common.html |
| Pre-patch Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9564/artifact/patchprocess/trunkFindbugsWarningshadoop-yarn-server-nodemanager.html |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9564/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9564/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9564/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9564/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf905.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9564/console |


This message was automatically generated., Thanks [~varun_saxena] for pointing it out, attaching with out fix for fundbugs issue !, \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | pre-patch |  19m 41s | Pre-patch trunk has 4 extant Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   8m  2s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |  10m 28s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 24s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   1m 48s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 33s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 34s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   4m 17s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | yarn tests |   2m  1s | Tests passed in hadoop-yarn-common. |
| {color:green}+1{color} | yarn tests |   9m  4s | Tests passed in hadoop-yarn-server-nodemanager. |
| {color:green}+1{color} | yarn tests |  62m  5s | Tests passed in hadoop-yarn-server-resourcemanager. |
| | | 120m  2s | |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12768602/YARN-4162.v1.007.patch |
| Optional Tests | javac unit findbugs checkstyle javadoc |
| git revision | trunk / ab8eb87 |
| Pre-patch Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9566/artifact/patchprocess/trunkFindbugsWarningshadoop-yarn-common.html |
| Pre-patch Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9566/artifact/patchprocess/trunkFindbugsWarningshadoop-yarn-server-nodemanager.html |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9566/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9566/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9566/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9566/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf905.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9566/console |


This message was automatically generated., Reattaching the same patch as the patch name was wrong , \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | pre-patch |  16m 53s | Findbugs (version ) appears to be broken on trunk. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 4 new or modified test files. |
| {color:green}+1{color} | javac |   7m 54s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |  10m 28s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   1m 13s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 34s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |
| {color:red}-1{color} | findbugs |   4m 23s | The patch appears to introduce 4 new Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | yarn tests |   2m  3s | Tests passed in hadoop-yarn-common. |
| {color:green}+1{color} | yarn tests |   8m 58s | Tests passed in hadoop-yarn-server-nodemanager. |
| {color:green}+1{color} | yarn tests |  62m 16s | Tests passed in hadoop-yarn-server-resourcemanager. |
| | | 116m 42s | |
\\
\\
|| Reason || Tests ||
| FindBugs | module:hadoop-yarn-common |
| FindBugs | module:hadoop-yarn-server-nodemanager |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12768610/YARN-4169.v1.007.patch |
| Optional Tests | javac unit findbugs checkstyle javadoc |
| git revision | trunk / ab8eb87 |
| Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9569/artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-common.html |
| Findbugs warnings | https://builds.apache.org/job/PreCommit-YARN-Build/9569/artifact/patchprocess/newPatchFindbugsWarningshadoop-yarn-server-nodemanager.html |
| hadoop-yarn-common test log | https://builds.apache.org/job/PreCommit-YARN-Build/9569/artifact/patchprocess/testrun_hadoop-yarn-common.txt |
| hadoop-yarn-server-nodemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9569/artifact/patchprocess/testrun_hadoop-yarn-server-nodemanager.txt |
| hadoop-yarn-server-resourcemanager test log | https://builds.apache.org/job/PreCommit-YARN-Build/9569/artifact/patchprocess/testrun_hadoop-yarn-server-resourcemanager.txt |
| Test Results | https://builds.apache.org/job/PreCommit-YARN-Build/9569/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf905.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-YARN-Build/9569/console |


This message was automatically generated., Hi [~wangda] /[~rohithsharma], findbugs issues are not related to this jira and already jira's has been raised for them. Can one of you take a look at this jira ?, Patch looks good to me, committing..., Committed to trunk/branch-2, thanks [~Naganarasimha] and review from [~steve_l]!, FAILURE: Integrated in Hadoop-trunk-Commit #8711 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/8711/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
* hadoop-yarn-project/CHANGES.txt
, FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #600 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/600/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
, SUCCESS: Integrated in Hadoop-Yarn-trunk #1324 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/1324/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk #2478 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2478/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #2531 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2531/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #589 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/589/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
* hadoop-yarn-project/CHANGES.txt
, FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #541 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/541/])
YARN-4169. Fix racing condition of TestNodeStatusUpdaterForLabels. (wangda: rev 6f606214e734d9600bc0f25a63142714f0fea633)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/NodeLabelTestBase.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/TestRMNodeLabelsManager.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/test/java/org/apache/hadoop/yarn/nodelabels/TestCommonNodeLabelsManager.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/test/java/org/apache/hadoop/yarn/server/nodemanager/TestNodeStatusUpdaterForLabels.java
]