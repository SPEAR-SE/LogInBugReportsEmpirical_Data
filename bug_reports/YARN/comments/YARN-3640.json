[Attaching the thread of 2 NM's. , Attached the nodemanager log file. It contains log from stopping the services., I'v encounter the same problem, and filed YARN-3585.

I think it's related with leveldb thread. I also see it in your thread out., It looks similar, but I did not get how did you taken *jni leveldb thread stack* which mentioned in YARN-3585, I missed this issue, thanks for pointing out. , I use pstack to get it, Closing as duplicate., I am able to reproduce this always..!!!]