[The decode then re-encode issue is not really specific to ContainerTokenIdentifier.  Any token that is re-encoded in such a way where unknown fields are either omitted or not guaranteed to be serialized in the same order as done by the token creator could be problematic for upgrade scenarios.]