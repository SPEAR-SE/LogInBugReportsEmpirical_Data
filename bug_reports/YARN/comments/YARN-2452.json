[I uploaded a patch YARN-2452.000.patch for review.
This patch is to enable "assignmultiple", so FairScheduler can assign multiple containers on each Node HeartBeat otherwise by default FairScheduler can only assign one container on each Node HeartBeat., {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12664310/YARN-2452.000.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/4730//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/4730//console

This message is automatically generated., Thanks for your contribution, [~zxu]. This is just my anticipation, but I think some tests depend on CapacityScheduler. Should we fix all of them?

About a patch itself, It's better to use FairSchedulerConfiguration.ASSIGN_MULTIPLE instead of hard coding property.
{code}
+    conf.setBoolean("yarn.scheduler.fair.assignmultiple", true);
{code}
, [~Tsuyoshi OZAWA] thanks for the review. I try to use FairSchedulerConfiguration.ASSIGN_MULTIPLE at the beginning. then I get compilation error, it is because ASSIGN_MULTIPLE is protected, which can't be accessed by the test.
{code}
protected static final String  ASSIGN_MULTIPLE = CONF_PREFIX + "assignmultiple";
{code}
Can I  change "protected" to "public" at above code?, Thanks for your explanation. I don't know why this property is protected.

[~kkambatl], [~sandyr], can we make FairSchedulerConfiguration.ASSIGN_MULTIPLE public? Or shouldn't we do that?, I uploaded a new patch "YARN-2452.001.patch". It splits testRMWritingMassiveHistory into two tests: testRMWritingMassiveHistoryForFairSche and testRMWritingMassiveHistoryForCapacitySche.One for fair scheduler and one for Capacity scheduler. So we can test both schedulers., {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12664426/YARN-2452.001.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/4735//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/4735//console

This message is automatically generated., Making  FairSchedulerConfiguration.ASSIGN_MULTIPLE public sounds reasonable to me.  FairSchedulerConfiguration is still marked @Private, so users shouldn't be able to get at it., Thanks for your comment, Sandy. [~zxu], could you update a patch based on Sandy's comment?, Hi [~ozawa], Yes, I will upload a new patch shortly., I uploaded a new patch YARN-2452.002.patch which use FairSchedulerConfiguration.ASSIGN_MULTIPLE and make FairSchedulerConfiguration.ASSIGN_MULTIPLE public. Please review it.
thanks
, {color:green}+1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12668301/YARN-2452.002.patch
  against trunk revision 469ea3d.

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-YARN-Build/4915//testReport/
Console output: https://builds.apache.org/job/PreCommit-YARN-Build/4915//console

This message is automatically generated., Patch looks reasonable to me, can't think of an easier way to get the test to work with FS. +1. Committing this. , Thanks Zhihai for the patch, Tsuyoshi and Sandy for the reviews. 

Just committed this to trunk and branch-2. , FAILURE: Integrated in Hadoop-Yarn-trunk #688 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/688/])
YARN-2452. TestRMApplicationHistoryWriter fails with FairScheduler. (Zhihai Xu via kasha) (kasha: rev c50fc92502934aa2a8f84ea2466d4da1e3eace9d)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairSchedulerConfiguration.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/ahs/TestRMApplicationHistoryWriter.java
, SUCCESS: Integrated in Hadoop-Hdfs-trunk #1879 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1879/])
YARN-2452. TestRMApplicationHistoryWriter fails with FairScheduler. (Zhihai Xu via kasha) (kasha: rev c50fc92502934aa2a8f84ea2466d4da1e3eace9d)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/ahs/TestRMApplicationHistoryWriter.java
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairSchedulerConfiguration.java
* hadoop-yarn-project/CHANGES.txt
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #1904 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1904/])
YARN-2452. TestRMApplicationHistoryWriter fails with FairScheduler. (Zhihai Xu via kasha) (kasha: rev c50fc92502934aa2a8f84ea2466d4da1e3eace9d)
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/scheduler/fair/FairSchedulerConfiguration.java
* hadoop-yarn-project/CHANGES.txt
* hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/test/java/org/apache/hadoop/yarn/server/resourcemanager/ahs/TestRMApplicationHistoryWriter.java
]