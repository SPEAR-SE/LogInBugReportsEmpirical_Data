{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": null,
        "components": [{
            "id": "12313892",
            "name": "Broker",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12313892"
        }],
        "created": "2011-03-01T05:17:07.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Oleg Kiorsak",
            "key": "kiorsak",
            "name": "kiorsak",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kiorsak",
            "timeZone": "Etc/UTC"
        },
        "customfield_10010": null,
        "customfield_12310041": null,
        "customfield_12310080": null,
        "customfield_12310220": "2011-03-01T11:10:08.410+0000",
        "customfield_12310222": "1_*:*_1_*:*_14119521133_*|*_6_*:*_1_*:*_0",
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "0.0",
        "customfield_12310420": "65456",
        "customfield_12310920": "172237",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i0tuf3:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Aug 11 15:22:28 UTC 2011",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "Here is the setup:\n \nActiveMQ 5.4.2 using JDBC persistence (MSSQLServerExpress DB)... (just one server connect - no \"master/slave cluster\"...)\n \n1000 simulated clients send persistent messages every 10 seconds - 10 messages each\n \nso in total they enqueue 10000 messages into INBOUND queue (via a virtual destination 'MDT.INBOUND' that does a bit of \"forking\")\n<compositeQueue name=\"MDT.INBOUND\" forwardOnly=\"true\">\n<forwardTo>\n                                                <queue physicalName=\"INBOUND\" />\n                                                <queue physicalName=\"ARCHIVING-DST\" />\n                        <\/forwardTo>\n \n \nSo within a minute or so - I can see 10000 messages all in 'INBOUND' via SQL Server queries \nmessages TTL is set to 5 mins, so within 5 mins messages start expiriring...\n \nBUT only some messages would end up in ActiveMQ.DLQ, whilst the others seem to disappear in thin air (!!)\n \ninterestingly, the JMX counters (e.g. via jConsole) will actually show the missing number of messages as being in the 'INBOUND' queue\nbut as a matter of fact they are NOT there (which can be confirmed by SQL queries as well)\n \nthis happens sporadically... i.e. sometimes it would actually work ok - as expected - all expired messages ending up in DLQ,\nbut other times always about a hundred or so messages were missing\n \n \nFor example I just ran this 5 times - 2 times then restarted ActiveMQ (very \"gently\" - via the 'stop' command in jConsole) and ran again twice\n \nHere are the numbers (see attached xls as well)\n \n\t\t\t\t\t\tAfter ActiveMQ RESTART\t\t\t\t\n\t\tAfter 1st run\t\tAfter 2nd run\t\tand 3rd run\t\tafter 4th run\t\tafter 5th run\n\t\t\t\t\t\t\t\t\t\t\nJMX\tArchiving-Q' QueueSize\t10000\t\t20000\t\t30000\t\t40000\t\t50000\n\tActiveMQ.DLQ 'QueueSize\t10000\t\t19589\t\t29589\t\t39589\t\t48848\n\tINBOUND' QueueSize\t0\t\t411\t??\t0\thm... were did those 411 go?!!\t0\t\t741\n\tINBOUND' EnqueCount\t10000\t\t20000\t\t10000\t\t20000\t\t30000\n\tINBOUND' DequeCount\t10000\t\t19589\t\t10000\t\t20000\t\t29259\n\tINBOUND' ExpiredCpount\t10000\t\t19589\t\t10000\t\t20000\t\t29259\n\t\t\t\t\t\t\t\t\t\t\nDB\tArchiving-Q\t10000\t\t20000\t\t30000\t\t40000\t\t50000\n\tActiveMQ.DLQ\t10000\t\t19589\t\t29589\t\t39589\t\t48848\n\tINBOUND\t0\t\t0\t\t0\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t\n \n",
        "duedate": null,
        "environment": "Java 1.6, Sun Solaris",
        "fixVersions": [],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "id": "2",
            "name": "Critical",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011"
            },
            "id": "12311210",
            "key": "AMQ",
            "name": "ActiveMQ",
            "projectCategory": {
                "description": "ActiveMQ",
                "id": "11160",
                "name": "ActiveMQ",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/11160"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12311210"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Oleg Kiorsak",
            "key": "kiorsak",
            "name": "kiorsak",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kiorsak",
            "timeZone": "Etc/UTC"
        },
        "resolution": {
            "description": "The problem is not completely described.",
            "id": "4",
            "name": "Incomplete",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/4"
        },
        "resolutiondate": "2011-08-11T15:22:28.000+0000",
        "status": {
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "id": "6",
            "name": "Closed",
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "persistent messages disappear (lost!!) upon expiry rather than ending up in a DLQ",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2011-08-11T15:22:28.000+0000",
        "versions": [{
            "archived": false,
            "description": "",
            "id": "12315625",
            "name": "5.4.2",
            "releaseDate": "2010-12-02",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12315625"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-3194/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-3194/watchers",
            "watchCount": 2
        },
        "workratio": -1
    },
    "id": "12500006",
    "key": "AMQ-3194",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12500006"
}