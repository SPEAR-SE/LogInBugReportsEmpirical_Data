{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": null,
        "components": [{
            "description": "LevelDB based message store",
            "id": "12320200",
            "name": "activemq-leveldb-store",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12320200"
        }],
        "created": "2016-02-18T16:19:24.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Sunil Vishwanath",
            "key": "sunilasfvish",
            "name": "sunilasfvish",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sunilasfvish",
            "timeZone": "Etc/UTC"
        },
        "customfield_10010": null,
        "customfield_12310041": null,
        "customfield_12310080": null,
        "customfield_12310220": "2016-05-18T16:26:20.071+0000",
        "customfield_12310222": "1_*:*_1_*:*_30578611614_*|*_6_*:*_1_*:*_0",
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "0.0",
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i2t0c7:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Feb 06 14:22:56 UTC 2017",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "Currently I am testing the following setup:\n\nActiveMQ 5.13.0 with LevelDB (3 node cluster).\nZookeeper 3.4.6 (3 node cluster).\nFile system: NFSv3\n\nStarted up all 3 Zookeeper nodes. (aamqzk1, aamqzk2 and aamqzk3)\nStarted up all 5 ActiveMQ nodes. (aamql1, aamql2, aamql3, aamql4 and aamql5)\nI started aamql1 first and all others in order. aamql1 is the master and I am able to see all the queue statistics for aamql1 via ActiveMQ Web Console.\n\nI am also watching all 5 AMQ's \"application.log\" file using \"tail -f application.log\u201d command.\n\nThe message producer starts sending messages (about 120,000 of them).  While the messages are being queued and also being consumed, I stopped the master instance (aamql1).  Now aamql2 becomes the master. About 10 seconds later after all the slave aamq reports to the new master, aamql2 throws the following exception and the instance dies.  This keeps repeating as it failover to the next instance.\n2016-02-17T15:43:48.358885-08:00 aamql2.bus.jetqa1.syseng.tmcs severity=INFO datetime=2016-02-17 15:43:48,354 thread=LevelDB IOException handler. category=org.apache.activemq.util.DefaultIOExceptionHandler Stopping BrokerService[localhost] due to exception, java.io.EOFException: File '/aamql/local/activemq/data/leveldb/0000000038409848.log' offset: 477491777\n2016-02-17T15:43:48.370881-08:00 aamql2.bus.jetqa1.syseng.tmcs java.io.EOFException: File '/aamql/local/activemq/data/leveldb/0000000038409848.log' offset: 477491777\n2016-02-17T15:43:48.371003-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.RecordLog$LogReader.read(RecordLog.scala:389)\n2016-02-17T15:43:48.371082-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.RecordLog$$anonfun$read$2.apply(RecordLog.scala:654)\n2016-02-17T15:43:48.371148-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.RecordLog$$anonfun$read$2.apply(RecordLog.scala:654)\n2016-02-17T15:43:48.371219-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.RecordLog.get_reader(RecordLog.scala:644)\n2016-02-17T15:43:48.371380-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.RecordLog.read(RecordLog.scala:654)\n2016-02-17T15:43:48.371454-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient.getMessage(LevelDBClient.scala:1335)\n2016-02-17T15:43:48.371526-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$queueCursor$1.apply(LevelDBClient.scala:1274)\n2016-02-17T15:43:48.371604-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$queueCursor$1.apply(LevelDBClient.scala:1271)\n2016-02-17T15:43:48.371675-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$collectionCursor$1$$anonfun$apply$mcV$sp$12.apply(LevelDBClient.scala:1359)\n2016-02-17T15:43:48.371746-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$collectionCursor$1$$anonfun$apply$mcV$sp$12.apply(LevelDBClient.scala:1358)\n2016-02-17T15:43:48.371818-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$RichDB.check$4(LevelDBClient.scala:323)\n2016-02-17T15:43:48.371888-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$RichDB.cursorRange(LevelDBClient.scala:325)\n2016-02-17T15:43:48.371960-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$collectionCursor$1.apply$mcV$sp(LevelDBClient.scala:1358)\n2016-02-17T15:43:48.372034-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$collectionCursor$1.apply(LevelDBClient.scala:1358)\n2016-02-17T15:43:48.372104-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$collectionCursor$1.apply(LevelDBClient.scala:1358)\n2016-02-17T15:43:48.372175-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient.usingIndex(LevelDBClient.scala:1038)\n2016-02-17T15:43:48.372259-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient$$anonfun$might_fail_using_index$1.apply(LevelDBClient.scala:1044)\n2016-02-17T15:43:48.372334-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient.might_fail(LevelDBClient.scala:549)\n2016-02-17T15:43:48.372406-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient.might_fail_using_index(LevelDBClient.scala:1044)\n2016-02-17T15:43:48.372488-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient.collectionCursor(LevelDBClient.scala:1357)\n2016-02-17T15:43:48.372573-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBClient.queueCursor(LevelDBClient.scala:1271)\n2016-02-17T15:43:48.372635-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.DBManager.cursorMessages(DBManager.scala:735)\n2016-02-17T15:43:48.372705-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.leveldb.LevelDBStore$LevelDBMessageStore.recoverNextMessages(LevelDBStore.scala:860)\n2016-02-17T15:43:48.372774-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.cursors.QueueStorePrefetch.doFillBatch(QueueStorePrefetch.java:120)\n2016-02-17T15:43:48.372844-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.cursors.AbstractStoreCursor.fillBatch(AbstractStoreCursor.java:406)\n2016-02-17T15:43:48.372913-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.cursors.AbstractStoreCursor.reset(AbstractStoreCursor.java:149)\n2016-02-17T15:43:48.372990-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.cursors.StoreQueueCursor.reset(StoreQueueCursor.java:169)\n2016-02-17T15:43:48.373060-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.Queue.doPageInForDispatch(Queue.java:1938)\n2016-02-17T15:43:48.373130-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.Queue.pageInMessages(Queue.java:2149)\n2016-02-17T15:43:48.373201-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.Queue.doBrowse(Queue.java:1137)\n2016-02-17T15:43:48.373275-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.Queue.expireMessages(Queue.java:917)\n2016-02-17T15:43:48.373344-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.Queue.access$100(Queue.java:103)\n2016-02-17T15:43:48.373413-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.broker.region.Queue$2.run(Queue.java:146)\n2016-02-17T15:43:48.373484-08:00 aamql2.bus.jetqa1.syseng.tmcs     at org.apache.activemq.thread.SchedulerTimerTask.run(SchedulerTimerTask.java:33)\n2016-02-17T15:43:48.373553-08:00 aamql2.bus.jetqa1.syseng.tmcs     at java.util.TimerThread.mainLoop(Timer.java:555)\n2016-02-17T15:43:48.373622-08:00 aamql2.bus.jetqa1.syseng.tmcs     at java.util.TimerThread.run(Timer.java:505)\n",
        "duedate": null,
        "environment": "Virtual type detected as xen-para.\nLast rubix: Mon Feb  1 11:02:37 2016 release: 74867 version: 2.0.7\nInstalled kernel: 2.6.18-308.0.0.0.1.el5xen x86_64",
        "fixVersions": [],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "id": "2",
            "name": "Critical",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011"
            },
            "id": "12311210",
            "key": "AMQ",
            "name": "ActiveMQ",
            "projectCategory": {
                "description": "ActiveMQ",
                "id": "11160",
                "name": "ActiveMQ",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/11160"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12311210"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Sunil Vishwanath",
            "key": "sunilasfvish",
            "name": "sunilasfvish",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sunilasfvish",
            "timeZone": "Etc/UTC"
        },
        "resolution": {
            "description": "The problem described is an issue which will never be fixed.",
            "id": "2",
            "name": "Won't Fix",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/2"
        },
        "resolutiondate": "2017-02-06T14:22:56.000+0000",
        "status": {
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "id": "6",
            "name": "Closed",
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "LevelDB gets corrupted when Primary ActiveMQ server is shutdown while messages are queued to it",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2017-02-06T14:22:56.000+0000",
        "versions": [{
            "archived": false,
            "id": "12329848",
            "name": "5.13.0",
            "releaseDate": "2015-12-03",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12329848"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-6174/votes",
            "votes": 5
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-6174/watchers",
            "watchCount": 8
        },
        "workratio": -1
    },
    "id": "12940190",
    "key": "AMQ-6174",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12940190"
}