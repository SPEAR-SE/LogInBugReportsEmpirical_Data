{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942"
            },
            "displayName": "Rob Davies",
            "key": "rajdavies",
            "name": "rajdavies",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rajdavies",
            "timeZone": "Etc/UTC"
        },
        "components": [],
        "created": "2009-09-11T19:47:06.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Chad Showalter",
            "key": "chadshowalter",
            "name": "chadshowalter",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=chadshowalter",
            "timeZone": "Etc/UTC"
        },
        "customfield_10010": null,
        "customfield_12310041": null,
        "customfield_12310080": null,
        "customfield_12310220": "2009-09-14T13:59:51.042+0000",
        "customfield_12310222": "1_*:*_1_*:*_238364811_*|*_5_*:*_1_*:*_0",
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "2.0",
        "customfield_12310420": "96089",
        "customfield_12310920": "255253",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i182s7:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Sep 15 17:13:14 UTC 2009",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "When persistent=true for the broker, a fast producer / slow consumer may cause ActiveMQ to block on a SocketWrite0() call.  The following thread dump signature results:\n\n...\n\"ActiveMQ Transport: tcp://localhost/127.0.0.1:61610\" prio=5 tid=0x0000000101942000 nid=0x1548c4000 waiting for monitor entry [0x00000001548c3000..0x00000001548c3a50]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n\tat org.apache.activemq.transport.InactivityMonitor.oneway(InactivityMonitor.java:220)\n\t- waiting to lock <0x0000000107d29848> (a java.util.concurrent.atomic.AtomicBoolean)\n\tat org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:185)\n\tat org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:84)\n\tat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:203)\n\tat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:185)\n\tat java.lang.Thread.run(Thread.java:637) \n...\n\"main\" prio=5 tid=0x0000000101805000 nid=0x101201000 runnable [0x0000000101200000..0x0000000101200ba0]\n   java.lang.Thread.State: RUNNABLE\n\tat java.net.SocketOutputStream.socketWrite0(Native Method)\n\tat java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n\tat java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n\tat org.apache.activemq.transport.tcp.TcpBufferedOutputStream.flush(TcpBufferedOutputStream.java:115)\n\tat java.io.DataOutputStream.flush(DataOutputStream.java:106)\n\tat org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:167)\n\tat org.apache.activemq.transport.InactivityMonitor.oneway(InactivityMonitor.java:233)\n\t- locked <0x0000000107d29848> (a java.util.concurrent.atomic.AtomicBoolean)\n\tat org.apache.activemq.transport.TransportFilter.oneway(TransportFilter.java:83)\n\tat org.apache.activemq.transport.WireFormatNegotiator.oneway(WireFormatNegotiator.java:100)\n\tat org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n\t- locked <0x0000000107d299b0> (a java.lang.Object)\n\tat org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:60)\n\tat org.apache.activemq.ActiveMQConnection.doAsyncSendPacket(ActiveMQConnection.java:1214)\n\tat org.apache.activemq.ActiveMQConnection.asyncSendPacket(ActiveMQConnection.java:1208)\n\tat org.apache.activemq.ActiveMQSession.send(ActiveMQSession.java:1643)\n\t- locked <0x0000000107d35a68> (a java.lang.Object)\n\tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:227)\n\tat org.apache.activemq.ActiveMQMessageProducerSupport.send(ActiveMQMessageProducerSupport.java:300)\n\tat com.chad.test.ActiveMQSpamTest1.runTest(ActiveMQSpamTest1.java:73)\n\t- locked <0x0000000107ca6680> (a org.apache.activemq.ActiveMQMessageProducer)\n\tat com.chad.test.ActiveMQSpamTest1.main(ActiveMQSpamTest1.java:117)\n\nThe attached test instantiates an embedded broker and consistently duplicates the problem on my machine (Macbook Pro running Leopard).  The test duplicates behavior we see in production code, which is running an embedded broker on Debian Linux.\n\nI run the test in Eclipse with -Xmx1100mb.  The output I see (after a minute or so) is:\n\n...\nSENT a (mod 10000) message: i=0\nSENT a (mod 10000) message: i=10000\nSENT a (mod 10000) message: i=20000\nSENT a (mod 10000) message: i=30000\nSENT a (mod 10000) message: i=40000\nSENT a (mod 10000) message: i=50000\nSep 11, 2009 3:28:13 PM org.apache.activemq.kaha.impl.KahaStore initialize\nINFO: Kaha Store using data directory activemq-data/localhost/tmp_storage\nRECEIVED a (mod 10000) message: i=10000\nRECEIVED a (mod 10000) message: i=20000\nRECEIVED a (mod 10000) message: i=30000\nRECEIVED a (mod 10000) message: i=40000\nRECEIVED a (mod 10000) message: i=50000 \n\nafter which no further messages are processed, and a thread dump includes the signature shown above.  Uncommenting the line\n\nbroker.setPersistent(false);\n\nresults in the test running to completion (all messages are sent/consumed), with the following output:\n\nSENT a (mod 10000) message: i=0\nSENT a (mod 10000) message: i=10000\nSENT a (mod 10000) message: i=20000\nSENT a (mod 10000) message: i=30000\nSENT a (mod 10000) message: i=40000\nSENT a (mod 10000) message: i=50000\nSENT a (mod 10000) message: i=60000\nRECEIVED a (mod 10000) message: i=10000\nDONE sending messages\nRECEIVED a (mod 10000) message: i=20000\nRECEIVED a (mod 10000) message: i=30000\nRECEIVED a (mod 10000) message: i=40000\nRECEIVED a (mod 10000) message: i=50000\nRECEIVED a (mod 10000) message: i=60000\n\n\n\n",
        "duedate": null,
        "environment": "$ cat /proc/version\nLinux version 2.6.18-6-amd64 (Debian 2.6.18.dfsg.1-23etch1) (dannf@debian.org) (gcc version 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)) #1 SMP Fri Dec 12 05:49:32 UTC 2008\n\nOS X",
        "fixVersions": [{
            "archived": false,
            "description": "",
            "id": "12315620",
            "name": "5.3.0",
            "releaseDate": "2009-10-13",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12315620"
        }],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011"
            },
            "id": "12311210",
            "key": "AMQ",
            "name": "ActiveMQ",
            "projectCategory": {
                "description": "ActiveMQ",
                "id": "11160",
                "name": "ActiveMQ",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/11160"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12311210"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Chad Showalter",
            "key": "chadshowalter",
            "name": "chadshowalter",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=chadshowalter",
            "timeZone": "Etc/UTC"
        },
        "resolution": {
            "description": "The described issue is not actually a problem - it is as designed.",
            "id": "8",
            "name": "Not A Problem",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/8"
        },
        "resolutiondate": "2009-09-14T13:59:51.000+0000",
        "status": {
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "id": "5",
            "name": "Resolved",
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "ActiveMQ hangs on SocketWrite0() with fast producer / slow consumer after MemoryLimit is reached",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2009-09-15T17:13:14.000+0000",
        "versions": [{
            "archived": false,
            "description": "",
            "id": "12315619",
            "name": "5.2.0",
            "releaseDate": "2008-11-20",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12315619"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-2389/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-2389/watchers",
            "watchCount": 1
        },
        "workratio": -1
    },
    "id": "12483015",
    "key": "AMQ-2389",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12483015"
}