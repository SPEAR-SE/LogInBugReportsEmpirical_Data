[Assembling your suggestions into a patch would make it easier to review, Upload patch v1.]