[rev 729835 adds consistency checks to Valve and removes the unbalanced decrement.  IMO this should be reviewed by a more knowledgeable developer before closing... Hiram can you take a look or suggest someone who could?, Looks good.  Perhaps we should change those consistency checks to assert calls so that users can avoid doing them in production since they are being done in synchronized blocks.]