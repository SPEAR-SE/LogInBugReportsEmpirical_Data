[Recommend you create a unit test to demonstrate the problem., I attempted to recreate this but could not.  Added a parallel connection test on master everything seems to work as expected., Hey Timothy - does the MQTT code in question go through the following code by any chance?

{noformat}
org.apache.qpid.amqp_1_0.framing.ConnectionHandler$BytesOutputHandler.run(ConnectionHandler.java:403)
{noformat}

I haven't had time to follow-up, but I found from past excessively slow tests that this QPID code appears to be using busy waits, and somehow gets into a state in which it never gets what it wants.  I'll attach a screen shot showing the same using almost 100% of all 8 cores of my system for a long time.

If it's the same code, let me know and I'll paste full stack dumps taken during the time of the problem., screen shot showing the excessive CPU usage during tests that trace back into qpid code., No, the MQTT code does not move through the AMQP code.  There are issues with the legacy AMQP 1.0 JMS client that we use for testing, some of which are fixed in the upcoming 0.32 release but in general that client is not heavily maintained or tested.  The is a new one in the works that myself and [~gemmellr] are working on which will be compliant with the JMS over AMQP mapping spec we are also working on.  Once there is an initial release of that we will probably switch ActiveMQ to using that in its tests to resolve those problems. , Have not been able to reproduce this at all.  If a means of reproducing it becomes available please reopen. , I see - thank you for the clarification.  MQTT and AMQP are still vague in my mind and hence I lump them together - I need to find time to learn them.]