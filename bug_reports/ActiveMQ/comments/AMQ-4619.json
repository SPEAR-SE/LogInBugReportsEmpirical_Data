[Your client can not ensure if the transaction is successful or not since it cannot receive a response of the commit request from the broker when fail over happens.The exception message 'Transaction completion in doubt due to failover' has told you that the transaction completion is in doubt and now it's up to you to decide what to do next. You can continue to start a new transaction to resend messages, but you may see duplicate messages in your consumer.
You can also just ignore it but you may lose messages in the doubt transaction., In our scenario, there are many consumers to receive messages,if we send duplicate messages  or losing messages,there isn't a good way to make consumers to know which message is duplicate or losing.
I noticed there is a rollback methed in session.I plan to use it when producer throw exception,then resend message ,so the consumer can receive messages perfectly neither more or less. However, after I tested, the rollback methed can't destroy the message ,it worked not  as JDBC rollback. Is there something wrong in this solution? 
Thanks for your help.]