[Extract from the ActiveMQ log file with the exceptions. , Attached the TestNG test case., Added a log file which shows that the error also occurs with prefetch size 1., Just had a quick look at this test to see if it could easily be validated for 5.4, I notice the use of a pooled connection factory. For producers this makes sense, but for consumers it can lead to dangling prefetched messages if the consumers are added back to the pool. Just wanted to add this in case it is related to the problem.]