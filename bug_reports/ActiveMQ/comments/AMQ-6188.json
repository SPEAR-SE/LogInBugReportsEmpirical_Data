[GitHub user bdjdev opened a pull request:

    https://github.com/apache/activemq/pull/170

    https://issues.apache.org/jira/browse/AMQ-6188 - reset BaseDestinatioâ€¦

    Fix and test for https://issues.apache.org/jira/browse/AMQ-6188

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/bdjdev/activemq AMQ-6188

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/activemq/pull/170.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #170
    
----
commit c88bcedff0e498667db53af561ab01d03b286e0c
Author: Brian D. Johnson <brian@thejohnsonfamily.name>
Date:   2016-02-26T20:19:50Z

    https://issues.apache.org/jira/browse/AMQ-6188 - reset BaseDestination.lastActiveTime each time a message is delivered to the broker.

----
, I think you could assume passing faster in the test so long as the send causes the canGC to once again return false instead of doing the hard sleep, This looks good to me but I think it would also be a good idea to add an extra failsafe check to the canGC method and make sure that the message count is still 0 before returning true., Updated commit to remove sleep and assert canGC is false following message send., Also added the extra failsafe check to the canGC method., Commit 552c0f0f7a7502c0337b13699de51a11b29723a2 in activemq's branch refs/heads/master from [~brianjohnson]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=552c0f0 ]

https://issues.apache.org/jira/browse/AMQ-6188 - reset BaseDestination.lastActiveTime each time a message is delivered to the broker.
, Commit 012e4d0a1c85a17f90391b264617b4c9f0683d23 in activemq's branch refs/heads/master from [~cshannon]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=012e4d0 ]

https://issues.apache.org/jira/browse/AMQ-6188

Patch applied with thanks to Brian D. Johnson
, Github user asfgit closed the pull request at:

    https://github.com/apache/activemq/pull/170
, Commit 5dfd8cdfa806ae6cf708e3dc3ee8b174655a89dd in activemq's branch refs/heads/activemq-5.13.x from [~brianjohnson]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=5dfd8cd ]

https://issues.apache.org/jira/browse/AMQ-6188 - reset BaseDestination.lastActiveTime each time a message is delivered to the broker.

(cherry picked from commit 552c0f0f7a7502c0337b13699de51a11b29723a2)
, Patch applied, thanks.]