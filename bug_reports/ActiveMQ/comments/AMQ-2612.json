[Attaching an activemq-core patch with test that reproduces the issue., This issue should be resolved by AMQ-2877, Fix for AMQ-2877 should resolve this issue as well., still doesn't work if i specify my broker url to failover:(tcp://host:61616?jms.prefetchPolicy.queuePrefetch=1,tcp://s2hb-pmt-stg-svc4:61616?jms.prefetchPolicy.queuePrefetch=1)?randomize=false

When I start my consumer, it doesn't consume any messages. In the activemq web console, it show zero consumers. But it works if i put queuePrefetch="1" property in the activemq.xml.

 <destinationPolicy>
            <policyMap>
              <policyEntries>
                <policyEntry topic=">" producerFlowControl="true" memoryLimit="1mb">
                  <dispatchPolicy>
                    <roundRobinDispatchPolicy />
                  </dispatchPolicy>
                  <pendingSubscriberPolicy>
                    <vmCursor />
                  </pendingSubscriberPolicy>
                  <subscriptionRecoveryPolicy>
                    <noSubscriptionRecoveryPolicy />
                  </subscriptionRecoveryPolicy>
                </policyEntry>
                <policyEntry queue=">" producerFlowControl="true" memoryLimit="1mb" queuePrefetch="1">
                  <deadLetterStrategy>
                    <individualDeadLetterStrategy
                            queuePrefix="DLQ." useQueueForQueueMessages="true" />
                  </deadLetterStrategy>
                  <dispatchPolicy>
                    <roundRobinDispatchPolicy />
                  </dispatchPolicy>
                  <subscriptionRecoveryPolicy>
                    <noSubscriptionRecoveryPolicy />
                  </subscriptionRecoveryPolicy>
                </policyEntry>
              </policyEntries>
            </policyMap>
        </destinationPolicy>

]