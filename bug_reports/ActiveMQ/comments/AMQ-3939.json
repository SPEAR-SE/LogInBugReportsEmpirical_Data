[It's a git diff against trunk, hope that's ok, Fix applied with thanks. , Found an additional case of leakage, fixed now on trunk. ]