[fix and test in further refinement in http://git-wip-us.apache.org/repos/asf/activemq/commit/27b3a7c3
]