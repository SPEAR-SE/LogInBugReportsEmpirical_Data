[Applied a fix for this, although I did it in a slightly different way than the patch.  

{code}
String contentType = request.getContentType();
if (answer == null && contentType != null && contentType.toLowerCase().startsWith("text/xml")) {
{code}, Even better.]