[How do you call this page. This check is introduced to prevent csrf attacks, so that "purge" link can only be clicked from the webapp page. It works all fine here., I call the purge link from the browser through a ssh tunnel on the machine where the activemq is., On a second look, the exception looks strange. We throw UnsupportedOperationException. Wonder if it is related to JVM being used. Did you try with Sun jre?, We are using sun jre. Maybe is related to the SSH tunnel? This began to happen yesterday after the update from 5.4.1, all the other elements in the scenario (java vm, ssh forwarded port, machines, queues..) are the same., That check is implemented for 5.4.0 and there weren't any other changes later on. So it should be the same on 5.4.1 and 5.5.0, I also experienced this issue.  Using a browser, no SSH involved.  
Actually, it stopped happening while I was typing this, so this is very strange.]