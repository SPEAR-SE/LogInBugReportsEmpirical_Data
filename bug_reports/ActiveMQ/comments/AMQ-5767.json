[The code can't use Principal only as the context can contain both UserPrincipal or GroupPrincipal so you could end up with the wrong value in the userID if you didn't check for the user principal as the code is written now.  ]