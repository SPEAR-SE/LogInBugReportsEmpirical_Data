[I do see the same behavior on JBoss 4.0.3RC2 with AMQ 3.1. I started a durable topic subscriber and received all expected messages, acknowledging them right after. Stopping the client (subscriber.close(), session.close(), connection.close()) and reconnecting does, however, *not* seem to trigger the redelivery. Only after shutting down JBoss and starting it up again, AMQ delivers once more what has been acknowledged before., I should probably add that the client always connects using the same client-id; kinda useful for durable subscribers ;-) The puzzling part for me is that there are multiple tries to deregister the client upon AMQ shutdown. I never had mor than one client (with the same client-id) connected at once. I attached the JBoss log.

, JBoss log with multiple client deregistration entries, Could you see if your still having the same issues with ActiveMQ 4.0?  The queue browsing has been improved tremendously since 3.x, AFAIK this is all working now in 4.0.1 - let us know if you can still reproduce on 4.0.1 and we can reopen, the same problem in 4.0.1,i meet it. , Could you please provide a test case that shows this in action?, resolved it .... 

 in customer , 

session = connection.createSession(true, Session.CLIENT_ACKNOWLEDGE);  
===>
session = connection.createSession(false, Session.CLIENT_ACKNOWLEDGE); 

true -> false

but i dont know "false" will link to anther problom or not....
]