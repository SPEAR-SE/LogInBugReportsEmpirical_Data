[Attached stacktrace of hanged program and source code., You should have a look at the broker log to see what's happening there, and also check if there any known issues in your Java runtime for things like this.  , This doesn't appear to be a broker side issue.  ]