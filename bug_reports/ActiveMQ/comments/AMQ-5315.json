[Test logs of bridge failure
{code}
2014-08-07 23:01:10,467       INFO  ceUtil-StartThread-1 o.a.a.broker.BrokerService     activemq.broker=testBroker-T1oFi-LDN-1 Apache ActiveMQ 5.10.0 (testBroker-T1oFi-LDN-1, ID:leeimac.local-57747-1407452432914-0:48) is starting
2014-08-07 23:01:10,467       INFO  ceUtil-StartThread-1 o.a.a.b.BrokerPluginSupport    activemq.broker=testBroker-T1oFi-LDN-1 Broker Plugin com.x.jms.AbstractActiveMQTest$BrokerEventListener started
2014-08-07 23:01:10,468       INFO  ceUtil-StartThread-1 t.TransportServerThreadSupport activemq.broker=testBroker-T1oFi-LDN-1 Listening for connections at: tcp://localhost:57986?socket.tcpNoDelay=true&soTimeout=60000&closeAsync=false
2014-08-07 23:01:10,468       INFO  ceUtil-StartThread-1 o.a.a.b.TransportConnector     activemq.broker=testBroker-T1oFi-LDN-1 Connector tcp://localhost:57986?socket.tcpNoDelay=true&soTimeout=60000&closeAsync=false started
2014-08-07 23:01:10,468       INFO  ceUtil-StartThread-1 .a.n.DiscoveryNetworkConnector activemq.broker=testBroker-T1oFi-LDN-1 Establishing network connection from vm://testBroker-T1oFi-LDN-1?async=false&network=true to tcp://localhost:57985?socket.tcpNoDelay=true&soTimeout=60000&closeAsync=false
2014-08-07 23:01:10,469       INFO  ceUtil-StartThread-1 o.a.a.b.TransportConnector     activemq.broker=testBroker-T1oFi-LDN-1 Connector vm://testBroker-T1oFi-LDN-1 started
2014-08-07 23:01:10,470       INFO  ceUtil-StartThread-1 o.a.a.network.NetworkConnector activemq.broker=testBroker-T1oFi-LDN-1 Network Connector DiscoveryNetworkConnector:NC-LOCAL-localhost:BrokerService[testBroker-T1oFi-LDN-1] started
2014-08-07 23:01:10,470       INFO  ceUtil-StartThread-1 .a.n.DiscoveryNetworkConnector activemq.broker=testBroker-T1oFi-LDN-1 Establishing network connection from vm://testBroker-T1oFi-LDN-1?async=false&network=true to failover:(tcp://localhost:57987,tcp://localhost:57988)?nested.socket.tcpNoDelay=true&nested.soTimeout=60000&nested.closeAsync=false&randomize=false&maxReconnectAttempts=0
2014-08-07 23:01:10,471       INFO  ceUtil-StartThread-1 o.a.a.network.NetworkConnector activemq.broker=testBroker-T1oFi-LDN-1 Network Connector DiscoveryNetworkConnector:NC-WAN-NYC-DefaultDynamic-0:BrokerService[testBroker-T1oFi-LDN-1] started
2014-08-07 23:01:10,471       INFO  ceUtil-StartThread-1 o.a.a.broker.BrokerService     activemq.broker=testBroker-T1oFi-LDN-1 Apache ActiveMQ 5.10.0 (testBroker-T1oFi-LDN-1, ID:leeimac.local-57747-1407452432914-0:48) started
2014-08-07 23:01:10,471       INFO  ceUtil-StartThread-1 o.a.a.broker.BrokerService     activemq.broker=testBroker-T1oFi-LDN-1 For help or more information please see: http://activemq.apache.org
2014-08-07 23:01:10,471       WARN  ceUtil-StartThread-1 o.a.a.broker.BrokerService     activemq.broker=testBroker-T1oFi-LDN-1 Store limit is 102400 mb (current store usage is 0 mb). The data directory: /var/folders/zd/s8yvndzs0tb08zq2hbm5h89r0000gn/T/testBroker-T1oFi-LDN-1/testBroker-T1oFi-LDN-1/KahaDB only has 38816 mb of usable space - resetting to maximum available disk space: 38816 mb
2014-08-07 23:01:10,471       ERROR ActiveMQ Task-1      o.a.a.t.f.FailoverTransport    activemq.broker=testBroker-T1oFi-LDN-1 Failed to connect to [tcp://localhost:57987, tcp://localhost:57988] after: 1 attempt(s)
2014-08-07 23:01:10,472       INFO  oker-T1oFi-LDN-1#190 .DemandForwardingBridgeSupport activemq.broker=testBroker-T1oFi-LDN-1 Network connection between vm://testBroker-T1oFi-LDN-1#190 and tcp://localhost/127.0.0.1:57985@57994 (testBroker-T1oFi-LDN-0) has been established.
2014-08-07 23:01:10,472       INFO  oker-T1oFi-LDN-1#192 .DemandForwardingBridgeSupport activemq.broker=testBroker-T1oFi-LDN-1 Network connection between vm://testBroker-T1oFi-LDN-1#192 and unconnected shutdown due to a local error: {}
java.lang.NullPointerException: null
	at org.apache.activemq.network.DemandForwardingBridgeSupport.collectBrokerInfos(DemandForwardingBridgeSupport.java:365) [activemq-broker-5.10.0.jar:5.10.0]
	at org.apache.activemq.network.DemandForwardingBridgeSupport.access$400(DemandForwardingBridgeSupport.java:105) [activemq-broker-5.10.0.jar:5.10.0]
	at org.apache.activemq.network.DemandForwardingBridgeSupport$5.run(DemandForwardingBridgeSupport.java:331) [activemq-broker-5.10.0.jar:5.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [na:1.7.0_60]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [na:1.7.0_60]
	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_60]
2014-08-07 23:01:10,472       INFO  -T1oFi-LDN-1] Task-3 .DemandForwardingBridgeSupport activemq.broker=testBroker-T1oFi-LDN-1 testBroker-T1oFi-LDN-1 bridge to Unknown stopped
{code}, One case that looks like a possibility is in the collectBrokerInfos method:

{code}
        try {
            remoteBrokerInfo = futureRemoteBrokerInfo.get();
            if (remoteBrokerInfo == null) {
                fireBridgeFailed();
            }
        } catch (Exception e) {
            serviceRemoteException(e);
            return;
        }
{code}

we should probably be returning after the call to fireBridgeFailed otherwise the method would continue on with the remoteBrokerInfo being null which could lead to this error.  The futureRemoteBrokerInfo future is cancelled in transport listener set in the start method.  , Added a fix for an NPE case, That results in a different NPE at:

as the idGeneratory will be null, usually set org/apache/activemq/network/DemandForwardingBridgeSupport.java:383 or org/apache/activemq/network/DemandForwardingBridgeSupport.java:385

java.lang.NullPointerException: null
        at org.apache.activemq.network.DemandForwardingBridgeSupport.startLocalBridge(DemandForwardingBridgeSupport.java:441) [activemq-broker-5.10.0-MAHI.jar:5.10.0-MAHI]
        at org.apache.activemq.network.DemandForwardingBridgeSupport.doStartLocalAndRemoteBridges(DemandForwardingBridgeSupport.java:422) [activemq-broker-5.10.0-MAHI.jar:5.10.0-MAHI]
        at org.apache.activemq.network.DemandForwardingBridgeSupport.access$500(DemandForwardingBridgeSupport.java:105) [activemq-broker-5.10.0-MAHI.jar:5.10.0-MAHI], Suggest you work on a unit test that can reproduce otherwise we will just keep stabbing in the dark. , Unit test attached, recreates NPE in log output, Should be fixed now, thanks for the test case. ]