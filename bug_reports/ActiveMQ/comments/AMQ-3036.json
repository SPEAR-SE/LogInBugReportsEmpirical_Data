[patch file, Verified the issue, patches applied.  Many thanks for the unit tests.  ]