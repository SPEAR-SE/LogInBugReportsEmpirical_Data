[Did anybody get a chance to look at this ?, I had a quick peek just now, it looks like we could improve this, we track the enqueue/dequeue count for a topic sub but don't subtract the difference from the destination inflight when the consumer goes away with pending acks. As it stands, one abortive consumer can skew the metric for the destination which otherwise would be some indication of how slow consumers are. However for topics the broker does not really care b/c there is no broker side state for non durable topic subs., fix in http://git-wip-us.apache.org/repos/asf/activemq/commit/b136df17

client ack is now respected for topics subs - and counters decremented on ack rather than on delivered ack.
expired case now has its own ack type so it can be separate from delivered ack.]