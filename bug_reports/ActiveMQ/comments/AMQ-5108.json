[Patch to fix cleansession behavior and improvements to tests, also marked testResendMessageId() as ignored as it causes unexplained failures as mentioned in AMQ-4712. , with that patch applied i often see:{code}Tests run: 29, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 41.505 sec <<< FAILURE! - in org.apache.activemq.transport.mqtt.MQTTTest
testReceiveMessageSentWhileOffline(org.apache.activemq.transport.mqtt.MQTTTest)  Time elapsed: 0.328 sec  <<< ERROR!
java.net.ProtocolException: Command from server contained an invalid message id: 1
	at org.fusesource.mqtt.client.CallbackConnection.completeRequest(CallbackConnection.java:723)
	at org.fusesource.mqtt.client.CallbackConnection.processFrame(CallbackConnection.java:762)
	at org.fusesource.mqtt.client.CallbackConnection.access$1500(CallbackConnection.java:51)
	at org.fusesource.mqtt.client.CallbackConnection$6.onTransportCommand(CallbackConnection.java:392)
	at org.fusesource.hawtdispatch.transport.TcpTransport.drainInbound(TcpTransport.java:709)
	at org.fusesource.hawtdispatch.transport.TcpTransport$6.run(TcpTransport.java:588)
	at org.fusesource.hawtdispatch.internal.NioDispatchSource$3.run(NioDispatchSource.java:209)
	at org.fusesource.hawtdispatch.internal.SerialDispatchQueue.run(SerialDispatchQueue.java:100)
	at org.fusesource.hawtdispatch.internal.pool.SimpleThread.run(SimpleThread.java:77){code} this needs some investigation. But it works standalone so may just be some inter test interactions., patch applied with thanks - http://git-wip-us.apache.org/repos/asf/activemq/commit/bf8eb0e6, Think this one might be sorted, all tests appear to be enabled and passing now. , This appears to be fixed now tests run without any issues]