[Xid comparisions to use equals - and updated ActiveMQXid equals method, I see that you now use Xid.equals() to do the testing, but how can you be sure that Xid.equals() does indeed test the formatID, global transaction id and branch qualifier for equality? It's not required by the JTA spec (as far as I can tell), so to avoid surprises, I would recommend doing the testing with a custom static boolean equals(Xid a, Xid b) method., It's a fair cop guv, I was just cutting corners. ActiveMQXaSession now uses a static method on ActiveMQXid to test for equality ... :-)]