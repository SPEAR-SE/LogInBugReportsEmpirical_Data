[this points to pfc and transactions not working well. the send is blocked and resumed while the transaction completes.

think pfc should be disabled for transactions and the connection should block, such that the commit/rollback is serialized.
pfc or sendfailIfNoSpace should mark the transaction as rollback only, to indicate the lack of coordination between the sends and completion., using org.apache.activemq.ActiveMQConnectionFactory#setAlwaysSyncSend will also avoid this, looking more at this, seems the transacted case of pfc should (does) not block, so there is something else in the mix here.]