[Fixed up the tests, they weren't quite right.  All passing now. ]