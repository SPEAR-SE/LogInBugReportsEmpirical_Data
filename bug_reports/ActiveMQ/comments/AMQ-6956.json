[I think that is just a race between the client sending its shutdown command and then closing its end of the socket and the broker reacting to that shutdown command and getting to close it's end of the socket first.Â 

It is like the broker is reacting too fast which is positive.

5.x does the close async in case it will block, but Artemis is already non blocking so it can happen quickly in the normal case., Java checks the socket after every write, even after the very last write. So if the broker closes the socket very quickly, there would be one more call to checkWrite() from AppOutputStream.write(AppOutputStream.java:124) and that would throw. See https://github.com/keerath/openjdk-8-source/blob/5f6e9d42a9f6b6736100c9c6f43f5f5ea1570cfb/jdk/src/share/classes/sun/security/ssl/AppOutputStream.java#L124 for relevant source code.]