[[~gtully],

It looks like you had made the change for this and I don't want to back it out as it would cause a regression for AMQ-4000.  However, I'm not sure how else to recover the messages on a complete rebuild of the index if the KahaSubscriptionCommand is skipped at that point., [~cshannon] thanks for the heads up. That does look like a problem. I will peek at it in the next day or so and figure out what the correct fix is., Thanks [~gtully]. I'd like to back port this to 5.12.1 if there is a good solution for it., Commit dc06c8dc7540233aad6722afe554c2ea505754e2 in activemq's branch refs/heads/master from [~gtully]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dc06c8d ]

https://issues.apache.org/jira/browse/AMQ-5994 https://issues.apache.org/jira/browse/AMQ-4000 - proper fix for duplicate sub info from the store on recovery failure from AMQ2149Test. Additional test from Christopher L
, [~cshannon] thanks for the test!, Commit 8ef31b91e6db5a10cebc79785f075649d8ba0a56 in activemq's branch refs/heads/activemq-5.12.x from [~gtully]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8ef31b9 ]

https://issues.apache.org/jira/browse/AMQ-5994 https://issues.apache.org/jira/browse/AMQ-4000 - proper fix for duplicate sub info from the store on recovery failure from AMQ2149Test. Additional test from Christopher L

(cherry picked from commit dc06c8dc7540233aad6722afe554c2ea505754e2)
, Thanks Gary, I went ahead and cherry picked the fix to 5.12.x as well.]