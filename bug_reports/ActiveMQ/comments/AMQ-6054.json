[AMQ web console snapshot before and after restart, Are you using KahaDB? I recommend that you submit a test case to demonstrate this issue so we can see if there is something specific about your configuration that is causing this because this is a very common use case and there are many tests to make sure that this works properly.  One example is the test class DurableSubscriptionOfflineTestBase (and all children classes) which test various cases of durables being able to be consumed after being offline and after a broker restart.

The KahaDB index keeps track of durable subscriptions and and which messages were acked so it should be able to recover messages on restart., Sorry, I tried it again and everything goes well. There must be something wrong with my previous operations.]