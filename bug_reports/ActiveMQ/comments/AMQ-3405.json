[It would be really helpful if you could take a stab at creating a JUnit test to reproduce the issue, this will also ensure that if it gets fixed it won't break again., I can confirm that this issue also affects version 5.5.0. It also occurs for any message created by the admin console, they just never go to the DLQ at all.


Does anyone know of a workaround?, The reason the Message do not reappear in the DLQ is due to Message Audit on the DLQ filtering what would be duplicate messages.  I've created a test case and included it in trunk to show that if Audit is disabled on the DLQ then the Messages are moved back in.  The Move operation places the message onto the destination without modifying its Message Id so any Audited resource will filter it as a duplicate if it was delivered to that destination previously. , Working as designed.  See AMQ3405Test.java in trunk for an example., Timothy, I have found that any message I create through the admin console will also not be sent to the DLQ, even if I set it as persistent. Do you know the cause for this?, While we can work around this with disable of the Audit, it would be better to fix this so that the Audit of the Message is rolled back as messages are moved out of the DLQ., Fixed now on trunk, when a message is moved out of a DLQ its rolled back from the DLQ's Audit so subsequent failures will result in it reappearing in the DLQ.  , Commit 1ebf1862795286505dc2ce2d36e91008029061a3 in activemq's branch refs/heads/master from gtully
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=1ebf186 ]

AMQ-3405 - rework fix to use original destination strategy which may be different from the default shared strategy. new test
]