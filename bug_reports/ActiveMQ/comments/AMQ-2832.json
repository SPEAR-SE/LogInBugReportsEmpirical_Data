[resolved in  r964804 KahaDB store and  r964866 AMQ store

Data files containing only acks for messages in referenced data files are now excluded from cleanup till the dependent message file is eligible for cleanup., Unfortunately this wasn't really fully fixed.  The tracking of acks isn't persistent so a broker restart between the acks and the recovery can lose track of the ack and allow its data file to be deleted resulting in a recovered message that was previously consumed to be redispatched. , Both share the issue of losing track of an ack in a data file that's GC'd, New fix and tests on trunk]