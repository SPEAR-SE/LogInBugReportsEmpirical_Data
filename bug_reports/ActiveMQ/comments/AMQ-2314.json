[just a hunch, but it looks like the order of super.clear() in org.apache.activemq.kaha.impl.container.ListContainerImpl.clear() could be the problem here. A test case would help of course. Think the super.clear whacks the index and the local doClear has nothing to do., Giovani, do you have a test case or xml configuration that you use to reproduce this?, pending messages are now removed when a sub is removed allowing the temp store to be reclaimed. Issue with memory usage management for pending messages spooled to disk list and retrieved is also resolved. , last thought, validate that the test case I used meets your requirements, see activemq-core/src/test/java/org/apache/activemq/bugs/AMQ2314Test.java 
The test verify the temp store usage increased and decreased as expected. Note, some temp store usage increase is expected, till an in use file is no longer referenced (the current write file cannot be removed), but long term use will be steady., Gary,

I looked at the logic in the test case and it makes sense for the problem we saw.

I'll try a snapshot build on monday and check the fix is ok.

cheers,

James]