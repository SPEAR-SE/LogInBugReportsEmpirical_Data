[I see frequent concurrency errors due to the dispose method not synchronizing on the deliveredMessages linkedList.  Here is a patch that I think addresses the issue:

Attaching patch file, Patch to synchronize on deliveredMessages, Patch applied in svn revision 646248]