[patch attached., patch applied with thanks to r880696]