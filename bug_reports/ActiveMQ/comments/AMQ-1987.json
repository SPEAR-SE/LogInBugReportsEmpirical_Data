[With "processExpired" set to "false" I do not get NullPointerExceptions, but the slave has higher message counts than the master.

Could this cause a problem when failover happens after some expired messages arrived?, No test case provided to help reproduce.  Issue is against a SNAPSHOT build, suggest moving to a newer release and retesting.]