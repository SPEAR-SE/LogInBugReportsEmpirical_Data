[Updated code to check for and properly handle connection exceptions.]