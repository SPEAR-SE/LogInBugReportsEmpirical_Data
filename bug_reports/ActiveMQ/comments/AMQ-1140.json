[Added test case and fixed., Fix in trunk rev 501506 and fixed in 4.1 branch in rev 501500]