[I'm seeing a socket leak that is hanging my server that I think is related to this bug, given Hiram's comment. My producers connect by stomp to my broker. I believe a firewall in between the producers and the broker drops the connection when it's quiet for longer than a timeout. When the producers try to send another message, they see the dead socket and reopen a new one. However, my broker still sees the original connections as ESTABLISHED. This game plays out on any stomp connection that is quiet for longer than the firewall's timeout, which gives me about 25-35 leaked sockets a day until I hit the ulimit for file descriptors. At this time, my broker is hung: it cannot accept new connections, but has not crashed.

I have several suggestions:
1) bump the priority of this ticket
2) implement keep alives and the maxInactivityDuration parameter for stomp
3) when sockets are maxed out, kill old sockets LRU style so as to always accept new connections, Problems like this can be resolved by using Stomp v1.1 clients with heartbeats.  AMQ-3449 adds Stomp 1.1, reopen to set fix version to 5.6, closing again with correct fix version]