[Files necessary for reproducing the bug have been attached.  Files depend on ActiveMQ M3 and log4j to build and run.  TestProducer and TestConsumer are the classes with main() methods to run.  Run the broker service "out of the box" with a journaled Derby DB instance.  Let both the producer and consumer run, see memory usage creep up.  Eventually, broker service with quit with an "out of Java heap space" error., Actually, I'm only getting the out of memory error on 4.0 M3.  3.2.1 seems to work fine when I self-throttle the number of messages produced., Unable to replicate the issue using the latest snapshot from svn.  I ran the test for an hour  and the memory usage was normal.  I'm running it on a Pentium M 1.73G, 1 GB machine.

There  was a few bugs that were fixed after M3 release  that might have already fixed this issue (ie. http://forums.logicblaze.com/posts/list/69.page). 



]