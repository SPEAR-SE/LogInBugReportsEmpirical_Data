[Fix in trunk, the change to messageId to share the dataLocation in a copy breaks:
{code}org.apache.activemq.broker.JdbcXARecoveryBrokerTest#testQueuePersistentCommited2PhaseMessagesNotLostOnRestart{code} which changes the dataLocation on the fly, so it needs to be a unique reference after a copy.

What is the nature of the leveldb npe? Is it a case that the dataLocation is updated after the copy?
The jdbc store caches data in this value, maybe it can use something else., yeah perhaps the entryLocator.  That should be unique per queue the message is in., Fix was applied to the jdbc impl.]