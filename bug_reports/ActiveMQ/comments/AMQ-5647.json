[Here is a cooked protocol trace. Again, this test works find going to a qpidd C++ broker., Attach html and not pcapng, Some similarities in behavior of both issues, I've tried to reproduce this one and so far cannot.  It might be worth trying out your tests again using a current 5.12 SNAPSHOT build which you can get here, there are quite a few AMQP fixes in there.

https://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.12-SNAPSHOT/
, This is resolved by the addition of proper drain support and removal of the old drainCheck method which could lead to a race that removed all credit from the link before any message was dispatched. ]