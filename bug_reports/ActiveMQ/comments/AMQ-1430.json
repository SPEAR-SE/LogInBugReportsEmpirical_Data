[I ran into this issue with ActiveMQ in the 4.1.1 branch and found that it had been fixed in changeset 646880 (I manually bisected about 12 changesets to find this).

The brokerSequenceId for a Message is used as its unique identifier in the persistence store. In code preceding 646880 the brokerSequenceId is never changed for a message after it has been copied (as by CompositeQueue), so it is possible to have an ID collision in the database. 646880 resolved this by setting a new brokerSequenceId (the regionBroker's sequence ID) immediately before sending the message to the persistence store in the Queue (and Topic) class.
, Fixed by AMQ-1656. ]