[Patch applied, tests all passing.  Thanks.]