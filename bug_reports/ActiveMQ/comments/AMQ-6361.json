[Commit cd5ea6c27fa92a57dc68cd9632572a77b36c446c in activemq's branch refs/heads/master from [~tabish121]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=cd5ea6c ]

https://issues.apache.org/jira/browse/AMQ-6361

Honor the expired ack from the client as the authority on expiration, There is a regression in org.apache.activemq.usecases.ExpiredMessagesTest
the problem is that the stats are off b/c the message can get processed twice for expiry. The stats reports too many expired and the dlq rejects the duplicates so the stat and dlq queue size don't match for the assertion.
expiry is one process that has shared access to the message.

peeking at adding method to messageReference to encapsulate the right to process an expired message, such that it is done once., Commit 6cc2c1190da15579a9a886bad03596e14a77a677 in activemq's branch refs/heads/master from [~gtully]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=6cc2c11 ]

AMQ-6361 - fix contention over expiry processing with expiry task and client expiry ack, unit test regression sorted.
, Commit 01cfa7727dfb6e680e3a94789fd0798c36dbc87c in activemq's branch refs/heads/master from [~gtully]
[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=01cfa77 ]

AMQ-6361 - fix additional test regression on topic sub expiry AMQ4083Test,MessageEvictionTest
]