[In light of the concerns here about OOM issues with the concurrent queue I've switched the code to use a LinkedHashMap and protected access with a R/W lock.  The existing tests show no loss of performance due to this change.  ]