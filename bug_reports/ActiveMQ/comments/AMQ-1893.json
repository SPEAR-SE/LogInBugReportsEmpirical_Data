[Run TestProducer Console, Number of Pending Message after running TestProducer, Run TestConsumer Console, Number of Pending Messages after running TestConsumer, Run TestProducer Console, ActiveMQ 4.1.2 is OK, Resolved in 5.2, Can you describe what was fixed?  

I am seeing a similar issue in 5.1, but I am not sure if it would be addressed by whatever change was made for 5.2, I'm sure Rob Davies may make a mistake. 
5.2 does not fix this bug indeed., Added the test to trunk: activemq-core/src/test/java/org/apache/activemq/bugs/AMQ1893Test.java
revision: 964051.

It works as expected, all 30000 messages are received. Can you validate a current 5.4-SNAPSHOT to be sure. Or review the test case or change is such that it shows a problem. ]