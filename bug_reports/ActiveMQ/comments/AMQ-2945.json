[Example of problem under 5.4.0, I've been working for a while now under 5.4.1 - sometimes I get slightly different errors but the good thing is that the crashes are very predictable/repeatable. The broker will not run 48 hours accumulating messages without crashing., can you try your reproducible test with the latest 5.5-SNAPSHOT?
This looks like a variant of the now resolved https://issues.apache.org/activemq/browse/AMQ-2935
https://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.5-SNAPSHOT/, I tried it and it's working well, it accumulated data for 72 hours without crashing. I think you can consider this fixed, thanks., duplicate of AMQ-2935]