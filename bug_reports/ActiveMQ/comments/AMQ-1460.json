[I think this problem might be related to a bug that resulted from the fix to AMQ-1460 (JMX-authentication). The webconsole configured with system properties or JNDI only works when the properties
  -Dwebconsole.jmx.role=a -Dwebconsole.jmx.password=a
are specified. This is due a the way spring parses the configuration.

Unfortunately there's no quick fix for this problem (esp. because of the JNDI thing), but I refactored the configuration, it now uses a special configuration class to read the configuration from. I'm attaching my "summary fix" again, it should be staightforward to just apply the configuration part. I'm not extracting this part, because I want the whole thing applied ;) [If a commiter just wants to apply this part of it then write me, I'll put together an appropriate patch)., 
Hi Mario,

 

Thanks a lot for ur instant reply..

I added the patches(activemq-web-console-complete.patch) which You
advised.

 

But while building I am getting the following compilation error..

I am using jdk1.5.0_13 for building. Maven is maven-2.0.7..

 

Error

-----

 

bash-2.05$ mvn clean install -Dmaven.test.skip=true

[INFO] Scanning for projects...

[INFO]
------------------------------------------------------------------------
----

[INFO] Building ActiveMQ :: Web Console

[INFO]    task-segment: [clean, install]

[INFO]
------------------------------------------------------------------------
----

[INFO] [clean:clean]

[INFO] Deleting directory
/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/target

[INFO] Deleting directory
/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/target/clas
ses

[INFO] Deleting directory
/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/target/test
-classes

[INFO] Deleting directory
/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/target/site

[INFO] [resources:resources]

[INFO] Using default encoding to copy filtered resources.

[INFO] [compiler:compile]

[INFO] Compiling 23 source files to
/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/target/clas
ses

[INFO]
------------------------------------------------------------------------

[ERROR] BUILD FAILURE

[INFO]
------------------------------------------------------------------------

[INFO] Compilation failure

 

/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/src/main/ja
va/org/apache/activemq/web/config/JNDIConfiguration.java:[93,25]
generics are not supported in -source 1.4

(try -source 1.5 to enable generics)

        public Collection<JMXServiceURL> getJmxUrls() {

 

/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/src/main/ja
va/org/apache/activemq/web/MessageBodyServlet.java:[39,9] annotations
are not supported in -source 1.4

(try -source 1.5 to enable annotations)

        @SuppressWarnings("unchecked")

 

/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/src/main/ja
va/org/apache/activemq/web/MessageBodyServlet.java:[43,19] generics are
not supported in -source 1.4

(try -source 1.5 to enable generics)

                Map<String, Object> context = (Map<String, Object>) req

 

/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/src/main/ja
va/org/apache/activemq/web/config/SystemPropertiesConfiguration.java:[52
,25] generics are not supported in -source 1.4

(try -source 1.5 to enable generics)

        public Collection<JMXServiceURL> getJmxUrls() {

 

/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/src/main/ja
va/org/apache/activemq/web/config/AbstractConfiguration.java:[44,25]
generics are not supported in -source 1.4

(try -source 1.5 to enable generics)

        public Collection<JMXServiceURL> getJmxUrls() {

 

/data2/sample/apache-activemq-4.1.1/src/activemq-web-console/src/main/ja
va/org/apache/activemq/web/config/AbstractConfiguration.java:[87,40]
for-each loops are not supported in -source 1.4

(try -source 1.5 to enable for-each loops)

                        for (String url : urls) {

 

 

[INFO]
------------------------------------------------------------------------

[INFO] For more information, run Maven with the -e switch

[INFO]
------------------------------------------------------------------------

[INFO] Total time: 7 seconds

[INFO] Finished at: Tue Oct 16 15:56:51 EEST 2007

[INFO] Final Memory: 8M/159M

[INFO]
------------------------------------------------------------------------

 

Can You please look in to this error?

 

Thanks

 Subin

 

 

, I'm not sure about the blank page in tomcat, but if you are building ActiveMQ 4.1.x, it is configured to be java 1.4 compatible, hence generics, annotations, etc are not supported.

You could try enabling 1.5 via:
     <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.5</source>
          <target>1.5</target>
        </configuration>
      </plugin>

or applying the patch to the 5.x branch.

HTH, 
Hi,

 

I build the war file for activemq-webconsole. I put that war file inside
my Tomcat's webapps folder and set the following System properties
inside my catalina.bat:-

 

-Dwebconsole.type=properties 

-Dwebconsole.jms.url=tcp://localhost:61616 

-Dwebconsole.jmx.url=service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi

 

I started my tomcat, but the web console page is not coming for me, it's
not giving any error also but coming as a blank page. In the tomcat log
file my " brokerURL is: null" (Value of: org.apache.activemq.brokerURL
is: null)...

What is the reason for this blank page? Is this is because of my
brokerURL is: null? If yes what is the next step for me?Could anyone
please check this ? Help will be highly appreciated...

 

Attaching my tomcat log file also with this....

 

 

Oct 23, 2007 4:16:22 PM org.apache.catalina.core.AprLifecycleListener
lifecycleE

vent

INFO: The Apache Tomcat Native library which allows optimal performance
in produ

ction environments was not found on the java.library.path: C:\Program
Files\Java

\jdk1.5.0_13\bin;.;C:\WINDOWS\system32;C:\WINDOWS;C:\Program Files\PC
Connectivi

ty
Solution\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Pro
gram

Files\Java\jdk1.5.0_13\bin;D:\dev\ant\bin;C:\maven-2.0.7\bin

Oct 23, 2007 4:16:22 PM org.apache.coyote.http11.Http11BaseProtocol init

INFO: Initializing Coyote HTTP/1.1 on http-8080

Oct 23, 2007 4:16:22 PM org.apache.catalina.startup.Catalina load

INFO: Initialization processed in 845 ms

Oct 23, 2007 4:16:22 PM org.apache.catalina.core.StandardService start

INFO: Starting service Catalina

Oct 23, 2007 4:16:22 PM org.apache.catalina.core.StandardEngine start

INFO: Starting Servlet Engine: Apache Tomcat/5.5.23

Oct 23, 2007 4:16:22 PM org.apache.catalina.core.StandardHost start

INFO: XML validation disabled

Oct 23, 2007 4:16:23 PM org.apache.catalina.startup.HostConfig deployWAR

INFO: Deploying web application archive activemq-web-console-4.1.1.war

Oct 23, 2007 4:16:24 PM org.apache.catalina.loader.WebappClassLoader
validateJar

File

INFO:
validateJarFile(C:\apache-tomcat-5.5.23\webapps\activemq-web-console-4.1
..1

\WEB-INF\lib\servlet-api-2.3.jar) - jar not loaded. See Servlet Spec
2.3, sectio

n 9.7.2. Offending class: javax/servlet/Servlet.class

2007-10-23 16:16:26,093 [main ] INFO 1] -

Loading Spring root WebApplicationContext

2007-10-23 16:16:26,640 [main ] INFO XBeanXmlBeanDefinitionReader -

Loading XML bean definitions from ServletContext resource
[/WEB-INF/activemq.xm

l]

2007-10-23 16:16:26,969 [main ] INFO ResourceXmlApplicationContext -

Bean factory for application context
[org.apache.xbean.spring.context.ResourceX

mlApplicationContext;hashCode=27754609]:
org.springframework.beans.factory.suppo

rt.DefaultListableBeanFactory defining beans
[org.apache.activemq.xbean.XBeanBro

kerService]; parent:
org.springframework.beans.factory.support.DefaultListableBe

anFactory defining beans
[placeholderConfig,brokerService,sessionPool,brokerQuer

y,queueBrowser,messageQuery]; root of BeanFactory hierarchy

2007-10-23 16:16:26,969 [main ] INFO ResourceXmlApplicationContext -

1 beans defined in application context
[org.apache.xbean.spring.context.Resourc

eXmlApplicationContext;hashCode=27754609]

2007-10-23 16:16:26,969 [main ] INFO ResourceXmlApplicationContext -

Unable to locate MessageSource with name 'messageSource': using default
[org.sp

ringframework.context.support.DelegatingMessageSource@aa0877]

2007-10-23 16:16:26,969 [main ] INFO ResourceXmlApplicationContext -

Unable to locate ApplicationEventMulticaster with name
'applicationEventMultica

ster': using default
[org.springframework.context.event.SimpleApplicationEventMu

lticaster@111ded2]

2007-10-23 16:16:27,547 [main ] INFO BrokerService -

ActiveMQ 4.1.1 JMS Message Broker (localhost) is starting

2007-10-23 16:16:27,547 [main ] INFO BrokerService -

For help or more information please see:
http://incubator.apache.org/activemq/

2007-10-23 16:16:27,625 [JMX connector ] INFO ManagementContext -

JMX consoles can connect to
service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi

 

2007-10-23 16:16:29,174 [main ] INFO JDBCPersistenceAdapter -

Database driver recognized: [apache_derby_embedded_jdbc_driver]

2007-10-23 16:16:32,254 [main ] INFO DefaultDatabaseLocker -

Attempting to acquire the exclusive lock to become the Master broker

2007-10-23 16:16:32,254 [main ] INFO DefaultDatabaseLocker -

Becoming the master on dataSource:
org.apache.derby.jdbc.EmbeddedDataSource@4ac

866

2007-10-23 16:16:32,364 [main ] INFO JournalPersistenceAdapter -

Journal Recovery Started from: Active Journal: using 5 x 20.0 Megs at:
C:\apach

e-tomcat-5.5.23\bin\activemq-data\journal

2007-10-23 16:16:32,442 [main ] INFO JournalPersistenceAdapter -

Journal Recovered: 0 message(s) in transactions recovered.

2007-10-23 16:16:32,755 [main ] INFO TransportServerThreadSupport -

Listening for connections at: tcp://dtpxp-subchan:61616

2007-10-23 16:16:32,771 [main ] INFO TransportConnector -

Connector openwire Started

2007-10-23 16:16:32,786 [main ] INFO TransportServerThreadSupport -

Listening for connections at: stomp://dtpxp-subchan:61613

2007-10-23 16:16:32,786 [main ] INFO TransportConnector -

Connector stomp Started

2007-10-23 16:16:32,817 [main ] INFO TransportServerThreadSupport -

Listening for connections at: xmpp://dtpxp-subchan:61222

2007-10-23 16:16:32,817 [main ] INFO TransportConnector -

Connector xmpp Started

2007-10-23 16:16:32,817 [main ] INFO NetworkConnector -

Network Connector defaultNetwork Started

2007-10-23 16:16:32,817 [main ] INFO BrokerService -

ActiveMQ JMS Message Broker (localhost,
ID:dtpxp-subchan-2290-1193136387062-1:0

) started

2007-10-23 16:16:32,927 [main ] INFO 1] -

AjaxServlet: Defaulting to use topics: true

2007-10-23 16:16:32,927 [main ] INFO 1] -

Value of: org.apache.activemq.brokerURL is: null

2007-10-23 16:16:32,958 [main ] INFO 1] -

SendServlet: Defaulting to use topics: true

2007-10-23 16:16:32,990 [main ] INFO 1] -

Oct 23, 2007 4:16:35 PM org.apache.catalina.loader.WebappClassLoader
validateJar

File

INFO:
validateJarFile(C:\apache-tomcat-5.5.23\webapps\activemq-web-demo-4.1.1\
WE

B-INF\lib\servlet-api-2.3.jar) - jar not loaded. See Servlet Spec 2.3,
section 9

..7.2. Offending class: javax/servlet/Servlet.class

log4j:WARN No appenders could be found for logger
(org.apache.commons.digester.D

igester.sax).

log4j:WARN Please initialize the log4j system properly.

Oct 23, 2007 4:16:39 PM org.apache.coyote.http11.Http11BaseProtocol
start

INFO: Starting Coyote HTTP/1.1 on http-8080

Oct 23, 2007 4:16:39 PM org.apache.jk.common.ChannelSocket init

INFO: JK: ajp13 listening on /0.0.0.0:8009

Oct 23, 2007 4:16:39 PM org.apache.jk.server.JkMain start

INFO: Jk running ID=0 time=0/31 config=null

Oct 23, 2007 4:16:39 PM org.apache.catalina.storeconfig.StoreLoader load

INFO: Find registry server-registry.xml at classpath resource

Oct 23, 2007 4:16:39 PM org.apache.catalina.startup.Catalina start

INFO: Server startup in 17734 ms

 

 

Thanks and Regards,

Subin

 



This message contains information that may be privileged or confidential and is the property of the Capgemini Group. It is intended only for the person to whom it is addressed. If you are not the intended recipient,  you are not authorized to read, print, retain, copy, disseminate,  distribute, or use this message or any part thereof. If you receive this  message in error, please notify the sender immediately and delete all  copies of this message.
, I've fixed a number of things and applied a number of patches in this area lately addressing various issues with the web console. The code has changed a bit in this area - I wonder if you could recreate the patches you think are still required? I found it too hard figuring out what to apply due to recent changes etc, The 4.0 line is EOL]