[Added CountdownLatches to make sure consumers have started/shutdown as required, patch applied, thanks]