[patchfile.txt
DataFile.java (which was the patch in)
TooManyFilesTest.java (JUnit), patch applied with thanks in r833074 - left test case with the jira as it requires a small disk. Works ok with the new kahaDB also which is good.]