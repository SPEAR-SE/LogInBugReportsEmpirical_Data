[Patch applied with some small modifications, Thanks!]