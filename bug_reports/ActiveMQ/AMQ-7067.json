{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Gary Tully",
            "key": "gtully",
            "name": "gtully",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=gtully",
            "timeZone": "Etc/UTC"
        },
        "components": [
            {
                "id": "12325017",
                "name": "KahaDB",
                "self": "https://issues.apache.org/jira/rest/api/2/component/12325017"
            },
            {
                "id": "12330819",
                "name": "XA",
                "self": "https://issues.apache.org/jira/rest/api/2/component/12330819"
            }
        ],
        "created": "2018-10-04T14:28:11.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107"
            },
            "displayName": "Jamie goodyear",
            "key": "jgoodyear",
            "name": "jgoodyear",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear",
            "timeZone": "America/St_Johns"
        },
        "customfield_10010": null,
        "customfield_12310041": [{
            "id": "10042",
            "self": "https://issues.apache.org/jira/rest/api/2/customFieldOption/10042",
            "value": "Patch Available"
        }],
        "customfield_12310080": null,
        "customfield_12310220": "2018-10-05T16:45:33.982+0000",
        "customfield_12310222": "1_*:*_1_*:*_1133434240_*|*_5_*:*_1_*:*_0",
        "customfield_12310250": [{
            "id": "10430",
            "self": "https://issues.apache.org/jira/rest/api/2/customFieldOption/10430",
            "value": "Patch"
        }],
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "1.0",
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i3ytzj:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Oct 24 12:56:03 UTC 2018",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "KahaDB Recovery can experience a dangling transaction when prepare and commit occur on different data files.\r\n\r\nScenario:\r\n\r\nA XA Transaction is started, message is prepared and sent into Broker.\r\n\r\nWe then send into broker enough messages to file page file (100 message with 512 * 1024 characters in message payload). This forces a new data file to be created.\r\n\r\nCommit the XA transaction. Commit will land on the new data file.\r\n\r\nRestart the Broker.\r\n\r\nUpon restart a KahaDB recovery is executed.\r\n\r\nThe prepare in PageFile 1 is not matched to Commit on PageFile 2, as such, it will appear in recovered message state.\r\n\r\nLooking deeper into this scenario, it appears that the commit message is GC'd, hence the prepare & commit can not be matched.\r\n\r\nThe MessageDatabase only checks the following for GC:\r\n\r\n{color:#808080}// Don't GC files referenced by in-progress tx{color}{color:#cc7832}if {color}(inProgressTxRange[{color:#6897bb}0{color}] != {color:#cc7832}null{color}) {\r\n {color:#cc7832}for {color}({color:#cc7832}int {color}pendingTx=inProgressTxRange[{color:#6897bb}0{color}].getDataFileId(){color:#cc7832}; {color}pendingTx <= inProgressTxRange[{color:#6897bb}1{color}].getDataFileId(){color:#cc7832}; {color}pendingTx++) {\r\n gcCandidateSet.remove(pendingTx){color:#cc7832};{color} }\r\n }\r\n\r\nWe need to become aware of where the prepare & commits occur in pagefiles with respect to GCing files.",
        "duedate": null,
        "environment": null,
        "fixVersions": [
            {
                "archived": false,
                "id": "12341032",
                "name": "5.16.0",
                "released": false,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341032"
            },
            {
                "archived": false,
                "description": "",
                "id": "12344049",
                "name": "5.15.7",
                "releaseDate": "2018-10-27",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12344049"
            }
        ],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "id": "2",
            "name": "Critical",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011"
            },
            "id": "12311210",
            "key": "AMQ",
            "name": "ActiveMQ",
            "projectCategory": {
                "description": "ActiveMQ",
                "id": "11160",
                "name": "ActiveMQ",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/11160"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12311210"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107"
            },
            "displayName": "Jamie goodyear",
            "key": "jgoodyear",
            "name": "jgoodyear",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear",
            "timeZone": "America/St_Johns"
        },
        "resolution": {
            "description": "A fix for this issue is checked into the tree and tested.",
            "id": "1",
            "name": "Fixed",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1"
        },
        "resolutiondate": "2018-10-17T17:18:45.000+0000",
        "status": {
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "id": "5",
            "name": "Resolved",
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "KahaDB Recovery can experience a dangling transaction when prepare and commit occur on different data files.",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2018-10-24T12:56:03.000+0000",
        "versions": [{
            "archived": false,
            "description": "",
            "id": "12343805",
            "name": "5.15.6",
            "releaseDate": "2018-09-07",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12343805"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-7067/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-7067/watchers",
            "watchCount": 8
        },
        "workratio": -1
    },
    "id": "13189438",
    "key": "AMQ-7067",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13189438"
}