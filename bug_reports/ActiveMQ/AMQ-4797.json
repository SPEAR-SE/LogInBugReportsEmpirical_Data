{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": null,
        "components": [],
        "created": "2013-10-10T18:32:07.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Bill Harts",
            "key": "ptrader98",
            "name": "ptrader98",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ptrader98",
            "timeZone": "America/New_York"
        },
        "customfield_10010": null,
        "customfield_12310041": null,
        "customfield_12310080": null,
        "customfield_12310220": "2013-10-10T21:55:13.058+0000",
        "customfield_12310222": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "0.0",
        "customfield_12310420": "352907",
        "customfield_12310920": "353194",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i1ouef:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Mar 26 21:47:18 UTC 2014",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "I'm using ExtJS to create two separate panels which run in one browser tab.  After loading jquery, amq_jquery_adapter.js and amq.js I call amq_init (only once).  Then each panel calls addlistener like so: \n\nPanel 1 code: \n{code}amq.addListener('testconnection1', topic://MyApp/IOIs/Simulator', myHandler1.rcvMessage);{code}\n\nPanel 2 code: \n{code}amq.addListener('testconnection2', 'topic://MyApp/IOIs/Simulator', myHandler2.rcvMessage);{code}\n\nNote that both are subscribing to the same topic.  This is because Panel 1 shows the data in a different format than Panel 2. \n\n*The Problem:*\nIf I start Panel 1 alone, it receives data from the topic without problems. But then I start Panel 2 and as soon as it executes the addlistener, Panel 2 starts receiving data but Panel 1 stops!   \n\nSo I started tracing into the network traffic and all looks fine, i.e, I can see each addlistener trigger a 'listen' request with the proper id and topic.  And I see the amq server return data to testconnection1, then stop suddenly when the 'listen' for testconnection2 is sent.  So I turned my attention to the backend code and enabled a detailed trace.  Here's what I found: \n\nWhen the Panel 1 'listen' is received, the trace shows: \n{quote}2013-10-10 09:10:09,701 | DEBUG | 0 destination=topic://MyApp/IOIs/Simulator message=testconnection1 type=listen | org.apache.activemq.web.MessageListenerServlet | qtp2088898587-51 - /demo/amq\n2013-10-10 09:10:09,701 | DEBUG | topic://MyApp/IOIs/Simulator is a org.apache.activemq.command.ActiveMQTopic | org.apache.activemq.web.MessageListenerServlet | qtp2088898587-51 - /demo/amq\n2013-10-10 09:10:09,701 | DEBUG | amq-broker adding consumer: ID:MYAPPDATA-7392-1381410590247-5:1:1:1 for destination: topic://MyApp/IOIs/Simulator | org.apache.activemq.broker.region.AbstractRegion | ActiveMQ VMTransport: vm://localhost#1-2\n2013-10-10 09:10:09,701 | DEBUG | amq-broker adding destination: topic://ActiveMQ.Advisory.Consumer.Topic.MyApp/IOIs/Simulator | org.apache.activemq.broker.region.AbstractRegion | ActiveMQ VMTransport: vm://localhost#1-2\n2013-10-10 09:10:09,717 | DEBUG | Initialized TaskRunnerFactory[ActiveMQ Session Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@2e2667db[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0] | org.apache.activemq.thread.TaskRunnerFactory | qtp2088898587-51 - /demo/amq\n2013-10-10 09:10:09,717 | DEBUG | Subscribed: ActiveMQMessageConsumer { value=ID:MYAPPDATA-7392-1381410590247-5:1:1:1, started=true } to topic://MyApp/IOIs/Simulator id=testconnection1 | org.apache.activemq.web.MessageListenerServlet | qtp2088898587-51 - /demo/amq{quote}\n\nWhen the Panel 2 'listen' is received, I see this trace: \n{quote}2013-10-10 09:10:09,888 | DEBUG | 0 destination=topic://MyApp/IOIs/Simulator message=testconnection2 type=listen | org.apache.activemq.web.MessageListenerServlet | qtp2088898587-53 - /demo/amq\n2013-10-10 09:10:09,888 | DEBUG | topic://MyApp/IOIs/Simulator is a org.apache.activemq.command.ActiveMQTopic | org.apache.activemq.web.MessageListenerServlet | qtp2088898587-53 - /demo/amq\n2013-10-10 09:10:09,888 | DEBUG | remove: ID:MYAPPDATA-7392-1381410590247-5:1:1:1, lastDeliveredSequenceId:0 | org.apache.activemq.ActiveMQMessageConsumer | qtp2088898587-53 - /demo/amq\n2013-10-10 09:10:09,888 | DEBUG | Unregistering MBean org.apache.activemq:type=Broker,brokerName=amq-broker,destinationType=Topic,destinationName=MyApp/IOIs/Simulator,endpoint=Consumer,clientId=ID_MYAPPDATA-7392-1381410590247-4_1,consumerId=ID_MYAPPDATA-7392-1381410590247-5_1_1_1 | org.apache.activemq.broker.jmx.ManagementContext | ActiveMQ VMTransport: vm://localhost#1-2\n2013-10-10 09:10:09,888 | DEBUG | amq-broker removing consumer: ID:MYAPPDATA-7392-1381410590247-5:1:1:1 for destination: topic://MyApp/IOIs/Simulator | org.apache.activemq.broker.region.AbstractRegion | ActiveMQ VMTransport: vm://localhost#1-2\n2013-10-10 09:10:09,888 | DEBUG | amq-broker adding consumer: ID:MYAPPDATA-7392-1381410590247-5:1:1:2 for destination: topic://MyApp/IOIs/Simulator | org.apache.activemq.broker.region.AbstractRegion | ActiveMQ VMTransport: vm://localhost#1-2\n2013-10-10 09:10:09,904 | DEBUG | Subscribed: ActiveMQMessageConsumer { value=ID:MYAPPDATA-7392-1381410590247-5:1:1:2, started=true } to topic://MyApp/IOIs/Simulator id=testconnection2 | org.apache.activemq.web.MessageListenerServlet | qtp2088898587-53 - /demo/amq{quote}\n\nWhat is happening is that in MessageListenerServlet.js, function doPost, line 165 is dropping any previous consumer to the same destination: \n{code}client.closeConsumer(destination); // drop any existing consumer.{code}\n\nBut why?  There doesn't seem to be a good reason for doing this--maybe it was originally put there for cleanup purposes?.  Or if there is a good reason, maybe the behavior should be to not do it if the id of the new destination (in this case 'testconnection2') is different than the id of the existing destination ('testconnection1'). \n\nI believe this can be fixed by simply removing line 165 from MessageListenerServlet.js but I'm not sure if this will break something else.",
        "duedate": null,
        "environment": "Windows Server 2008 R2 on Dell server boxes",
        "fixVersions": [],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [
            "addlistener",
            "ajax",
            "web"
        ],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011"
            },
            "id": "12311210",
            "key": "AMQ",
            "name": "ActiveMQ",
            "projectCategory": {
                "description": "ActiveMQ",
                "id": "11160",
                "name": "ActiveMQ",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/11160"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12311210"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Bill Harts",
            "key": "ptrader98",
            "name": "ptrader98",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ptrader98",
            "timeZone": "America/New_York"
        },
        "resolution": null,
        "resolutiondate": null,
        "status": {
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "id": "1",
            "name": "Open",
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "statusCategory": {
                "colorName": "blue-gray",
                "id": 2,
                "key": "new",
                "name": "To Do",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2"
            }
        },
        "subtasks": [],
        "summary": "Unable to add multiple AJAX listeners for the same topic in the same browser window",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2014-03-26T21:47:18.000+0000",
        "versions": [{
            "archived": false,
            "description": "Maintenance release with new AMQP support and smaller modules",
            "id": "12323282",
            "name": "5.8.0",
            "releaseDate": "2013-02-11",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12323282"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-4797/votes",
            "votes": 1
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/AMQ-4797/watchers",
            "watchCount": 4
        },
        "workratio": -1
    },
    "id": "12673284",
    "key": "AMQ-4797",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12673284"
}