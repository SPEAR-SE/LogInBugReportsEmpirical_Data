{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12757501","self":"https://issues.apache.org/jira/rest/api/2/issue/12757501","key":"AMQ-5453","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2014-11-24T21:02:50.175+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 27 15:03:29 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_10607264828_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-03-27T15:03:29.442+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5453/watchers","watchCount":3,"isWatching":false},"created":"2014-11-24T20:35:44.765+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315627","id":"12315627","description":"","name":"6.0.0","archived":false,"released":false}],"issuelinks":[{"id":"12402144","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12402144","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12750445","key":"AMQ-5413","self":"https://issues.apache.org/jira/rest/api/2/issue/12750445","fields":{"summary":"AMQP test client delivery/redelivery anomoly","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12404876","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12404876","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12640996","key":"QPID-4710","self":"https://issues.apache.org/jira/rest/api/2/issue/12640996","fields":{"summary":"[AMQP 1.0] Support for transactions","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-06-05T16:35:21.687+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12321807","id":"12321807","name":"AMQP","description":"AcitveMQ's AMQP Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"The drain flag on the AMQP flow performative allows a client to request confirmation that it has received the last available message that it has credit to receive.\n\nTo reproduce using the qpid-send, qpid-receive clients from http://svn.apache.org/repos/asf/qpid/trunk/qpid/. Create a JMS queue 'foo' on the active broker then run:\n\n$ qpid-send -a jms.queue.foo -b localhost:5455 --content-string XXX --connection-options='{protocol:amqp1.0}'\n$ qpid-receive -a jms.queue.foo -b localhost:5455 --connection-options='{protocol:amqp1.0}' --log-enable trace+:Protocol\n\nqpid-receive hangs, the  last line of output is:\n2014-11-24 15:15:46 [Protocol] trace [58e8ee08-0f33-426b-b77a-450f7c3d976c]: 0 -> @flow(19) [next-incoming-id=2, incoming-window=2147483647, next-outgoing-id=0, outgoing-window=0, handle=0, delivery-count=1, link-credit=1, drain=true]\n\nThis shows that qpid-receive sent a flow with drain=true but never received a response.\n\nWhy is this important? Without the drain flag it is impossible for a client to implement the simple behavior \"get the next message\" correctly. The flow response tells the client immediately \"there are no more messages available for you\". Without it the client can only use a timeout which is unreliable (if too short the client may give up while the message is in flight) and inefficient (if too long the client will wait needlessly for messages that the broker knows are not presently available)\n\nThe spec 2.6.7 is a little ambiguous about whether this is a SHOULD or a MUST behavior but without it it is impossible to implement the use cases described in the following section.\n\nAMQP 1.0 specification 2.7.6\ndrain\nThe drain flag indicates how the sender SHOULD behave when insufficient messages are available to consume the current link-credit. If set, the sender will (after sending all available messages) advance the delivery-count as much as possible, consuming all link-credit, and send the flow state to the receiver. Only the receiver can independently modify this field. The sender's value is always the last known value indicated by the receiver.\n\nIf the link-credit is less than or equal to zero, i.e., the delivery-count is the same as or greater than the delivery-limit, a sender MUST NOT send more messages. If the link-credit is reduced by the receiver when transfers are in-flight, the receiver MAY either handle the excess messages normally or detach the link with a transfer-limit-exceeded error code.\n\nFigure 2.40: Flow Control\n\n     +----------+                                    +----------+\n     |  Sender  |---------------transfer------------>| Receiver |\n     +----------+                                    +----------+\n      \\        / <----------------flow--------------- \\        /\n       +------+                                        +------+\n          |\n          |\n          |\n if link-credit <= 0 then pause \n      \nIf the sender's drain flag is set and there are no available messages, the sender MUST advance its delivery-count until link-credit is zero, and send its updated flow state to the receiver.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"AMQP interop: Active broker does not respect the \"drain\" flag.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aconway","name":"aconway","key":"aconway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aconway&avatarId=33074","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aconway&avatarId=33074","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aconway&avatarId=33074","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aconway&avatarId=33074"},"displayName":"Alan Conway","active":true,"timeZone":"America/Montreal"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aconway","name":"aconway","key":"aconway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aconway&avatarId=33074","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aconway&avatarId=33074","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aconway&avatarId=33074","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aconway&avatarId=33074"},"displayName":"Alan Conway","active":true,"timeZone":"America/Montreal"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12757501/comment/14223506","id":"14223506","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Can you clarify what version of ActiveMQ you are testing?  You've set the affected version as 6.0.0 which would be considered code from: https://github.com/apache/activemq-6 and not the 5.x tree which would be: https://github.com/apache/activemq","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-11-24T21:02:50.175+0000","updated":"2014-11-24T21:02:50.175+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12757501/comment/14224458","id":"14224458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gemmellr","name":"gemmellr","key":"gemmellr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Robbie Gemmell","active":true,"timeZone":"Europe/London"},"body":"From the ports and queue names, the report doesn't seem to be for 5.x (though it may also suffer from the issue).  Issues for ActiveMQ6 are currently being tracked at https://issues.apache.org/jira/browse/ACTIVEMQ6.\n\nThe 6.0.0 version in this JIRA project looks to have been used for Apollo in the past. Should it be renamed to avoid such confusion?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gemmellr","name":"gemmellr","key":"gemmellr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Robbie Gemmell","active":true,"timeZone":"Europe/London"},"created":"2014-11-25T12:09:43.414+0000","updated":"2014-11-25T12:09:43.414+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12757501/comment/14224459","id":"14224459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gemmellr","name":"gemmellr","key":"gemmellr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Robbie Gemmell","active":true,"timeZone":"Europe/London"},"body":"Linking AMQ-5413 which seems to be about the same underlying issue, though for ActiveMQ 5 this time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gemmellr","name":"gemmellr","key":"gemmellr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Robbie Gemmell","active":true,"timeZone":"Europe/London"},"created":"2014-11-25T12:11:02.600+0000","updated":"2014-11-25T12:19:45.196+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12757501/comment/14224623","id":"14224623","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aconway","name":"aconway","key":"aconway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aconway&avatarId=33074","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aconway&avatarId=33074","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aconway&avatarId=33074","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aconway&avatarId=33074"},"displayName":"Alan Conway","active":true,"timeZone":"America/Montreal"},"body":"I'm testing against https://github.com/apache/activemq-6. I think I saw the same thing on 5.x but I'd have to run the test again to be sure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aconway","name":"aconway","key":"aconway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aconway&avatarId=33074","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aconway&avatarId=33074","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aconway&avatarId=33074","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aconway&avatarId=33074"},"displayName":"Alan Conway","active":true,"timeZone":"America/Montreal"},"created":"2014-11-25T14:47:49.544+0000","updated":"2014-11-25T14:47:49.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12757501/comment/14226707","id":"14226707","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aconway","name":"aconway","key":"aconway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aconway&avatarId=33074","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aconway&avatarId=33074","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aconway&avatarId=33074","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aconway&avatarId=33074"},"displayName":"Alan Conway","active":true,"timeZone":"America/Montreal"},"body":"Created an active 6 bug: ACTIVEMQ6-46","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aconway","name":"aconway","key":"aconway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aconway&avatarId=33074","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aconway&avatarId=33074","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aconway&avatarId=33074","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aconway&avatarId=33074"},"displayName":"Alan Conway","active":true,"timeZone":"America/Montreal"},"created":"2014-11-26T19:40:32.442+0000","updated":"2014-11-26T19:40:32.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12757501/comment/14383962","id":"14383962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Closing this as it is directed at the ACTIVEMQ6 project which has an open issue covering this and a 5.x bug is already open AMQ-5413","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-03-27T15:03:29.523+0000","updated":"2015-03-27T15:03:29.523+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5453/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i22qbz:"}}