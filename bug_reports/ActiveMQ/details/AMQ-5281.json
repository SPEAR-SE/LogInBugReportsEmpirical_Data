{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12728178","self":"https://issues.apache.org/jira/rest/api/2/issue/12728178","key":"AMQ-5281","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324951","id":"12324951","name":"5.11.0","archived":false,"released":true,"releaseDate":"2015-02-04"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-07-21T15:55:18.666+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Aug 22 19:01:12 UTC 2014","customfield_12310420":"406283","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2704982725_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-08-18T17:25:10.627+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5281/watchers","watchCount":4,"isWatching":false},"created":"2014-07-18T10:02:07.942+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316331","id":"12316331","description":"Next unplanned v5 maintenance release","name":"5.x","archived":false,"released":false}],"issuelinks":[{"id":"12391788","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12391788","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12728177","key":"AMQ-5280","self":"https://issues.apache.org/jira/rest/api/2/issue/12728177","fields":{"summary":"Incorrect handling of unknown values in selectors","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-08-22T19:01:12.412+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Due to JmsMessage specification :\nhttp://docs.oracle.com/javaee/1.4/api/javax/jms/Message.html\nThere are rules how unknown Values evaluates. \n\nI found 4 violations of specificatoion:\n1) Equals expression \"=\".\n\"unknownProp = 0\" should evaluate to UNKNOWN.\nIn AMQ it evaluates to FALSE instead.\n2) Not equals expression \"<>\".\n\"unknownProp <> 0\" should evaluate to UNKNOWN, it evaluates to FALSE instead.\n3) Or expression \"or\".\n\"unknown or false\" should evaluate to UNKNOWN. It evaluates to FALSE instead.\n4) And expression \"and\".\n\"unknown and false\" should evaluate to FALSE. It evaluates to UNKNOWN instead.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"406304","customfield_12312823":null,"summary":"Incorrect handling of unknown values in selectors","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14068295","id":"14068295","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"body":"The is caused by org.apache.activemq.filter.LogicExpression, in this lines:\n\n{code}\n    public static BooleanExpression createAND(BooleanExpression lvalue, BooleanExpression rvalue) {\n        return new LogicExpression(lvalue, rvalue) {\n\n            public Object evaluate(MessageEvaluationContext message) throws JMSException {\n\n                Boolean lv = (Boolean)left.evaluate(message);\n\n               // Can we do an AND shortcut??\n                if (lv == null) {\n                    return null;\n                }\n                if (!lv.booleanValue()) {\n                    return Boolean.FALSE;\n                }\n\n                Boolean rv = (Boolean)right.evaluate(message);\n                return rv == null ? null : rv;\n            }\n\n            public String getExpressionSymbol() {\n                return \"AND\";\n            }\n        };\n    }\n{code}\n\nYou see comment \"//Can we do an AND shortcut??\"?\nThat's the cause of that bug.\n\nWhen left value is unknown method returns null. That's incorrect. You should check if right value is false and return false in that case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"created":"2014-07-21T07:45:58.435+0000","updated":"2014-07-21T07:45:58.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14068300","id":"14068300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"body":"I can create a pull-request on github with fix and some more test, if that OK with you.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"created":"2014-07-21T07:57:43.713+0000","updated":"2014-07-21T07:57:43.713+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14068676","id":"14068676","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"It does seem like we don't fully follow the mandated behaviour.  The first thing to do is create or add a test to the existing unit tests that demonstrates the error.  There is a selector test class (SelectorTest.java) you could add to and then supply a patch that corrects the issue.  By adding a test you have confidence that the fix will remain into the future.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-07-21T15:55:18.666+0000","updated":"2014-07-21T15:55:18.666+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14099992","id":"14099992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user traylz opened a pull request:\n\n    https://github.com/apache/activemq/pull/44\n\n    AMQ-5281: Incorrect handling of unknown values in selectors\n\n    See https://issues.apache.org/jira/browse/AMQ-5281 for details.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/traylz/activemq trunk\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/activemq/pull/44.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #44\n    \n----\ncommit b018d89875a4cc8e92b355aeb087ba112872c1e2\nAuthor: Grigory <gstraylz@gmail.com>\nDate:   2014-08-17T17:17:48Z\n\n    AMQ-5281: Incorrect handling of unknown values in selectors (=, <>, or, and)\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-17T17:24:45.365+0000","updated":"2014-08-17T17:24:45.365+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14099993","id":"14099993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"body":"Ok, I created pull-request on git-hub, please, review\nhttps://github.com/apache/activemq/pull/44.\nI will update description of JIRA now","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=traylz","name":"traylz","key":"traylz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grigroy Sobko","active":true,"timeZone":"Asia/Yerevan"},"created":"2014-08-17T17:25:42.546+0000","updated":"2014-08-17T17:25:42.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14100884","id":"14100884","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Patch applied with thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-08-18T17:25:10.656+0000","updated":"2014-08-18T17:25:10.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728178/comment/14107293","id":"14107293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user traylz closed the pull request at:\n\n    https://github.com/apache/activemq/pull/44\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-22T19:01:12.412+0000","updated":"2014-08-22T19:01:12.412+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5281/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1xwyf:"}}