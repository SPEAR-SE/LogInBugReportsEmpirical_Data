{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482693","self":"https://issues.apache.org/jira/rest/api/2/issue/12482693","key":"AMQ-2134","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-05-23T06:33:45.119+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat May 23 06:33:45 UTC 2009","customfield_12310420":"75061","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_7891721074_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-05-23T06:33:45.122+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2134/watchers","watchCount":1,"isWatching":false},"created":"2009-02-20T22:25:04.048+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-05-23T06:33:45.121+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I am creating a broker with just a multicast transport connector. Code snippet below.\n\n            try{\n\t\t\tbroker = new BrokerService();\n\t\t// configure the broker\n\t\t\tbroker.setBrokerName(\"ism\");\t\t\n\t\t\tbroker.addConnector(\"multicast://224.1.2.3:6255?loopBackMode=true\");\t\t\t\n\t\t\tbroker.start();\n\t\t}catch(Exception ex){\n\t\t\tex.printStackTrace();\n\t\t}\n\nNow I try creating a subscriber on the broker  using the following broker url \"multicast://224.1.2.3:6255?loopBackMode=true&amp;trace=true\"\nThe connection never succeeds and the following message is repeatedly thrown.\n\nDEBUG o.a.a.t.reliable.ReliableTransport - Still waiting for response on: multicast://224.1.2.3:6255?loopBackMode=true&trace=true@0 to command: ConnectionInfo {commandId = 1, responseRequired = true, connectionId = ID:JMATHAIY-WXP01-3697-1235159811727-2:0, clientId = ID:JMATHAIY-WXP01-3697-1235159811727-3:0, userName = null, password = null, brokerPath = null, brokerMasterConnector = false, manageable = true, clientMaster = true} sending replay message\n11:58:44.270 [http-8080-1] DEBUG o.a.a.t.TransportLogger.Connection:1 - SENDING: ReplayCommand {commandId = 25, firstNakNumber = 1, lastNakNumber = 1}\n\n\nThe reason to believe why this is a bug: \nI did some sniffing on the network and found that the igmp multicast join request for the broker never came through. Some digging into the code revealed that the MulticastTransport was never created in the first place. UdpTransport was being created even though the transport was multicast. The following change in the doBind method on the UdpTransportFactory.java fixed this problem.\n\n            //int port = location.getPort();\n            //OpenWireFormat openWireFormat = asOpenWireFormat(wf);\n            //UdpTransport transport = new UdpTransport(openWireFormat, port);\n            log.debug(\"Putting a custom fix for Multicast problem\");\n            UdpTransport transport = (UdpTransport)createTransport(location, wf);\n\nNow I was able to see the broker joining the multicast group, but the multicast socket gets timed out after every 5000 ms . I figured out that this is a default setting in the MulticastTransport.java (DEFAULT_IDLE_TIME) and tried changing it to 0 (open socket forever). Note : There is no way to specify this value from the uri. (or I was not able to figure that out).\n\nAfter the above two changes, I could get publisher and consumer connect to the broker and pass on the messages.\n\nPlease review the above changes and let me know if this has any other side effects or if any better fix is possible.\n\nBackground : We are actively testing out the various transports to use ActiveMQ in our application and multicast is very essential. Infact we want to integrate jgroups and I am not having any success there. Is jgroups really integrated in 5.2 ?\n\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10042","value":"Patch Available","id":"10042"}],"customfield_12310921":null,"customfield_12310920":"161465","customfield_12312823":null,"summary":"Multicast transport does not work when for a consumer or producer","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jmathaiy","name":"jmathaiy","key":"jmathaiy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jaiganesh Mathaiyan","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jmathaiy","name":"jmathaiy","key":"jmathaiy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jaiganesh Mathaiyan","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Using JMS in a spring framework","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482693/comment/12941358","id":"12941358","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Fixed in SVN revision 777806\nYou can specify the IDLE_TIMEOUT by the keepAliveInterval property in the URI","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-23T06:33:45.119+0000","updated":"2009-05-23T06:33:45.119+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2134/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0rzxj:"}}