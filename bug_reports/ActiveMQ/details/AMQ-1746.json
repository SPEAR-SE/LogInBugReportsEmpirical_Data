{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482785","self":"https://issues.apache.org/jira/rest/api/2/issue/12482785","key":"AMQ-1746","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315630","id":"12315630","description":"Issues that need to be reviewed - do we keep 'em or do we kick 'em? ","name":"NEEDS_REVIEW","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2008-06-10T09:47:00.316+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jul 14 11:19:42 UTC 2010","customfield_12310420":"95892","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_67225396067_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2010-07-14T11:19:42.938+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1746/watchers","watchCount":3,"isWatching":false},"created":"2008-05-27T09:36:26.871+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-07-14T11:19:42.933+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313893","id":"12313893","name":"Connector"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have tried this with activemq 5.0,5.1 and latest snapshot of activemq as of 20080521. I am using apacha nms.net client. On a connect it receives messages and on a regular shutdown the connection is disconnected and everything shutsdown w.r.t that connection in the server side. Now if there is network issue or when we disable and enable the network from the client side , a reconnect request is sent with a new clientid and the connection is established.But the old connection is still active which is evident from a netstat on the server machine. The client side netstat shows only the latest connection which is on port 1870.\n\ntcp        0      0 ::ffff:10.1.30.60:51616     ::ffff:10.1.30.176:1828     ESTABLISHED \ntcp        0      0 ::ffff:10.1.30.60:51616     ::ffff:10.1.30.176:1870     ESTABLISHED \n\nThe server is 10.1.30.60:51616. \n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59835","customfield_12312823":null,"summary":"ActiveMQ server does not release the connection on a reconnect","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Redhat Linux , jdk 1.5_0_6","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12939777","id":"12939777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"body":"I have been working on this for a while now.  I tried a bunch of things. \n\n1) i made changes to RegionBroker.java in the addconnection so when a new connection request comes in and there is a oldcontext associated with the clientid then to explicitly close the old connection by getting it from the oldcontext and closing it. this solves the problem of having multiple connections on the server side to a client who has one connection from his side.\n\nIn a scenario where a client is disconnected for some reason(unpluggint he cable or the system crashing) and if there is no reconnect at all, there is noway the server knows to close the connection. server keeps sending to that connection. the outqueue on the socket increases to close to 98000 and then the server does not serve the other connected clients as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-05T06:06:23.439+0000","updated":"2008-06-05T06:06:23.439+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12939765","id":"12939765","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"body":"Then also i tried to set the setKeepAlive on the socket to true and also lowered the server's timeout, keepalivetime and no of probes to low no's (in the RH linux config)so the system will knock off the connection. but even this does not seem to help.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-05T06:13:22.294+0000","updated":"2008-06-05T06:13:22.294+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12939768","id":"12939768","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gul","name":"gul","key":"gul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saira Gul","active":true,"timeZone":"Etc/UTC"},"body":"hi!!\n I am using activeMQ supports for Ajax in my application. i've created queues like amq.sendMessage(\"queueName\", message);\n and to receive a message i've added listener like amq.addListener(myId, myDestination, myHandler.revMessage);\n\n When i send request with amq.sendMessage(\"queueName\", message); it will make JMS message, fetch response and \n send the message back to myHandler. this code works fine.. \n\nthe problem is that if network connection lost, all handlers will also lost and the handlers would not be able to get response back from JMS.. requests are getting fine to activeMQ server and the response is also generating and MessageListenerServlet fail to send back response to javascript...\n\nIs there any way to activate handlers again when network connection got enabled after disabled.\n\nThank you\n\nQuoted from: \nhttp://www.nabble.com/-jira--Created%3A-%28AMQ-1746%29-ActiveMQ-server-does-not-release-the-connection-on-a-reconnect-tp17486710p17486710.html\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gul","name":"gul","key":"gul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saira Gul","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-10T09:47:00.316+0000","updated":"2008-06-10T09:47:00.316+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12939751","id":"12939751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"body":"saira, i think an exception would be thrown on the clientside when a disconnect happens, in which case you will have to manually reconnect to the server. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haribaasha","name":"haribaasha","key":"haribaasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-10T09:57:59.369+0000","updated":"2008-06-10T09:57:59.369+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12939803","id":"12939803","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gul","name":"gul","key":"gul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saira Gul","active":true,"timeZone":"Etc/UTC"},"body":"hi!! \n  \nWhen i disable the network i got the following exception at activemq console, after network connection has established again, the javascript application running on same machine (where server is running also) works fine but the other machines running same javascript application  connected to my machine(server running on my machine) unable to work properly.. in this case all handlers are lost which are establised using amq.addListener(\"id\", myTopic, myHandler); MessageListenerServlet fail to get JMS response \n\nERROR MulticastDiscoveryAgent        - Failed to advertise our service: default. \nActiveMQ-4.alive.%localhost%tcp://sgul:61616 \njava.net.NoRouteToHostException: No route to host: Datagram send failed \n        at java.net.PlainDatagramSocketImpl.send(Native Method) \n        at java.net.DatagramSocket.send(DatagramSocket.java:612) \n        at org.apache.activemq.transport.discovery.multicast.MulticastDiscoveryA \ngent.doAdvertizeSelf(MulticastDiscoveryAgent.java:361) \n        at org.apache.activemq.transport.discovery.multicast.MulticastDiscoveryA \ngent.doTimeKeepingServices(MulticastDiscoveryAgent.java:345) \n        at org.apache.activemq.transport.discovery.multicast.MulticastDiscoveryA \ngent.run(MulticastDiscoveryAgent.java:307) \n        at java.lang.Thread.run(Thread.java:595) \n\n\nQuoted from: \nhttp://www.nabble.com/-jira--Created%3A-%28AMQ-1746%29-ActiveMQ-server-does-not-release-the-connection-on-a-reconnect-tp17486710p17751779.html\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gul","name":"gul","key":"gul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saira Gul","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-10T11:30:00.352+0000","updated":"2008-06-10T11:30:00.352+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12942463","id":"12942463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"On the Ajax issue, can you upgrade to the latest release and try to use it with multicast turned off?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2010-07-13T09:50:03.130+0000","updated":"2010-07-13T09:50:03.130+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482785/comment/12942457","id":"12942457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"On the nms client reconnect issue, we didn't manage to reproduce it. can you try the latest versions of the broker and nms lib and see if you still see the problem. If you do, please provide a test case or a step-by-step guide how to reproduce it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2010-07-14T11:19:42.925+0000","updated":"2010-07-14T11:19:42.925+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1746/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0alzj:"}}