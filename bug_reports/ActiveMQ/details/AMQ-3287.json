{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12504693","self":"https://issues.apache.org/jira/rest/api/2/issue/12504693","key":"AMQ-3287","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2011-04-24T00:06:33.010+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 31 16:53:05 UTC 2011","customfield_12310420":"63017","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_11574642407_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-08-31T16:53:05.386+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3287/watchers","watchCount":1,"isWatching":false},"created":"2011-04-19T17:42:23.019+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315625","id":"12315625","description":"","name":"5.4.2","archived":false,"released":true,"releaseDate":"2010-12-02"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-08-31T16:53:05.421+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"While making use of the services and masterConnector elements in my slave config during a pubsub test (where messages are being held), the failover delays after performing a Ctrl-C.\n\nThis is the message that is seen:\n\nINFO | The connection to '/192.168.10.95:7676' is taking a long time to shutdown.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12476750","id":"12476750","filename":"image.JPG","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gliesian","name":"gliesian","key":"gliesian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gliesian&avatarId=10342","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gliesian&avatarId=10342","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gliesian&avatarId=10342","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gliesian&avatarId=10342"},"displayName":"Robert Liguori","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-19T17:43:55.413+0000","size":127431,"mimeType":"image/jpeg","content":"https://issues.apache.org/jira/secure/attachment/12476750/image.JPG"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172282","customfield_12312823":null,"summary":"Failover hangs during pubsub test (slave config with services element)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gliesian","name":"gliesian","key":"gliesian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gliesian&avatarId=10342","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gliesian&avatarId=10342","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gliesian&avatarId=10342","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gliesian&avatarId=10342"},"displayName":"Robert Liguori","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gliesian","name":"gliesian","key":"gliesian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gliesian&avatarId=10342","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gliesian&avatarId=10342","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gliesian&avatarId=10342","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gliesian&avatarId=10342"},"displayName":"Robert Liguori","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Operating System = Windows XP version 5.1 running on x86\nJava; VM; Vendor = 1.6.0_23\nRuntime = Java HotSpot(TM) Client VM 19.0-b09","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504693/comment/13023621","id":"13023621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jaskiratbhatia","name":"jaskiratbhatia","key":"jaskiratbhatia","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jaskirat Bhatia","active":true,"timeZone":"Etc/UTC"},"body":"I am also getting this same behavior, can you please attach your thread dump, so that we can verify if you have the same issue?\n\nJust to let you know, the reason why it failed for me is that failover is holding some messages which were unsent and if I try to shut this down, my application hangs.\n\nCan you please attach your thread dump?\n\n\nHere is the thread causing this issue for me:\n\"main\" prio=5 tid=101801000 nid=0x100501000 in Object.wait() [1004fe000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <7e68b03e8> (a java.lang.Object)\n\tat org.apache.activemq.transport.failover.FailoverTransport.oneway(FailoverTransport.java:513)\n\t- locked <7e68b03e8> (a java.lang.Object)\n\tat org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n\t- locked <7e68b05a8> (a java.lang.Object)\n\tat org.apache.activemq.transport.ResponseCorrelator.asyncRequest(ResponseCorrelator.java:81)\n\tat org.apache.activemq.transport.ResponseCorrelator.request(ResponseCorrelator.java:86)\n\tat org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1276)\n\tat org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1382)\n\t- locked <7e68b0b90> (a java.lang.Object)\n\tat org.apache.activemq.ActiveMQConnection.start(ActiveMQConnection.java:504)\n\tat org.mule.transport.jms.JmsConnector.doStart(JmsConnector.java:626)\n\tat org.mule.transport.AbstractConnector$2.onTransition(AbstractConnector.java:459)\n\tat org.mule.transport.AbstractConnector$2.onTransition(AbstractConnector.java:454)\n\tat org.mule.lifecycle.AbstractLifecycleManager.invokePhase(AbstractLifecycleManager.java:141)\n\tat org.mule.transport.ConnectorLifecycleManager.fireStartPhase(ConnectorLifecycleManager.java:63)\n\tat org.mule.transport.AbstractConnector.startAfterConnect(AbstractConnector.java:453)\n\t- locked <7e72203d0> (a org.mule.transport.jms.activemq.ActiveMQJmsConnector)\n\tat org.mule.transport.AbstractConnector$5.doWork(AbstractConnector.java:1601)\n\tat org.mule.retry.policies.AbstractPolicyTemplate.execute(AbstractPolicyTemplate.java:67)\n\tat org.mule.transport.AbstractConnector.connect(AbstractConnector.java:1611)\n\tat org.mule.transport.AbstractConnector.start(AbstractConnector.java:419)\n\t- locked <7e72203d0> (a org.mule.transport.jms.activemq.ActiveMQJmsConnector)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.mule.lifecycle.phases.DefaultLifecyclePhase.applyLifecycle(DefaultLifecyclePhase.java:225)\n\tat org.mule.lifecycle.RegistryLifecycleManager$RegistryLifecycleCallback.onTransition(RegistryLifecycleManager.java:276)\n\tat org.mule.lifecycle.RegistryLifecycleManager.invokePhase(RegistryLifecycleManager.java:155)\n\tat org.mule.lifecycle.RegistryLifecycleManager.fireLifecycle(RegistryLifecycleManager.java:126)\n\tat org.mule.registry.AbstractRegistryBroker.fireLifecycle(AbstractRegistryBroker.java:80)\n\tat org.mule.registry.MuleRegistryHelper.fireLifecycle(MuleRegistryHelper.java:121)\n\tat org.mule.lifecycle.MuleContextLifecycleManager$MuleContextLifecycleCallback.onTransition(MuleContextLifecycleManager.java:94)\n\tat org.mule.lifecycle.MuleContextLifecycleManager$MuleContextLifecycleCallback.onTransition(MuleContextLifecycleManager.java:90)\n\tat org.mule.lifecycle.MuleContextLifecycleManager.invokePhase(MuleContextLifecycleManager.java:72)\n\tat org.mule.lifecycle.MuleContextLifecycleManager.fireLifecycle(MuleContextLifecycleManager.java:64)\n\tat org.mule.DefaultMuleContext.start(DefaultMuleContext.java:202)\n\t- locked <7e6e15050> (a org.mule.DefaultMuleContext)\n\tat org.mule.config.builders.MuleXmlBuilderContextListener.initialize(MuleXmlBuilderContextListener.java:100)\n\tat org.mule.config.builders.MuleXmlBuilderContextListener.contextInitialized(MuleXmlBuilderContextListener.java:74)\n\tat org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4135)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:4630)\n\t- locked <7e6c80800> (a org.apache.catalina.core.StandardContext)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)\n\t- locked <7e6c49b60> (a java.util.HashMap)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:546)\n\tat org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:905)\n\tat org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:740)\n\tat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:500)\n\tat org.apache.catalina.startup.HostConfig.start(HostConfig.java:1277)\n\tat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:321)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n\t- locked <7e6c49ac8> (a org.apache.catalina.core.StandardHost)\n\tat org.apache.catalina.core.StandardHost.start(StandardHost.java:785)\n\t- locked <7e6c49ac8> (a org.apache.catalina.core.StandardHost)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n\t- locked <7e6c33ed0> (a org.apache.catalina.core.StandardEngine)\n\tat org.apache.catalina.core.StandardEngine.start(StandardEngine.java:445)\n\tat org.apache.catalina.core.StandardService.start(StandardService.java:519)\n\t- locked <7e6c33ed0> (a org.apache.catalina.core.StandardEngine)\n\tat org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n\t- locked <7e6c4f0a0> (a [Lorg.apache.catalina.Service; )\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:581)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jaskiratbhatia","name":"jaskiratbhatia","key":"jaskiratbhatia","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jaskirat Bhatia","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-24T00:06:33.010+0000","updated":"2011-04-26T20:46:46.167+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504693/comment/13023626","id":"13023626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jaskiratbhatia","name":"jaskiratbhatia","key":"jaskiratbhatia","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jaskirat Bhatia","active":true,"timeZone":"Etc/UTC"},"body":"Hi Robert\nI have never tried this on windows but here is the doc:\nhttp://www.crazysquirrel.com/computing/java/basics/java-thread-dump.jspx\n\nTry this out..Paste the entire dump here when you get it...\n\nThanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jaskiratbhatia","name":"jaskiratbhatia","key":"jaskiratbhatia","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jaskirat Bhatia","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-24T01:19:54.844+0000","updated":"2011-04-24T01:19:54.844+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504693/comment/13094682","id":"13094682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gliesian","name":"gliesian","key":"gliesian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gliesian&avatarId=10342","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gliesian&avatarId=10342","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gliesian&avatarId=10342","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gliesian&avatarId=10342"},"displayName":"Robert Liguori","active":true,"timeZone":"Etc/UTC"},"body":"I was unable to get a thread dump for this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gliesian","name":"gliesian","key":"gliesian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gliesian&avatarId=10342","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gliesian&avatarId=10342","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gliesian&avatarId=10342","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gliesian&avatarId=10342"},"displayName":"Robert Liguori","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-31T16:53:05.406+0000","updated":"2011-08-31T16:53:05.406+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3287/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tup3:"}}