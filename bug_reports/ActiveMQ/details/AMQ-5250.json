{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12724269","self":"https://issues.apache.org/jira/rest/api/2/issue/12724269","key":"AMQ-5250","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327149","id":"12327149","description":"Issues that lack any sort of test to validate.","name":"WAITING_FOR_TEST","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2014-06-30T16:17:55.799+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jul 29 16:50:40 UTC 2015","customfield_12310420":"402454","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3961921836_*|*_6_*:*_2_*:*_1395227121_*|*_4_*:*_1_*:*_23576040003","customfield_12312321":null,"resolutiondate":"2015-05-28T23:10:26.946+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5250/watchers","watchCount":6,"isWatching":false},"created":"2014-06-28T02:10:38.066+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-07-29T16:50:40.202+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We encounterred a problem when using temp queue for request/reply pattern. It worked normally but after a long time lets say several weeks, the applications using temp queue started to report errors:\n\n2014-06-25 08:25:59 [WARNING] Message back to the server failsï¼\njavax.jms.InvalidDestinationException: Cannot publish to a deleted Destination: temp-queue://ID:myserver-45345-1403492084155-1:1:259\nat org.apache.activemq.ActiveMQSession.send(ActiveMQSession.java:1748)\nat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:289)\nat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:224)\nat org.apache.activemq.ActiveMQMessageProducerSupport.send(ActiveMQMessageProducerSupport.java:300)\n\nI created a test application to test the temp when the problem happened and found this: On each connection, the temp queue worked once and the second time it failed. I also tried to monitor messages in ActiveMQ.Advisory.TempQueue. But I could only receive one message after I subsribed on it everytime. \n\nI checked the activemq log and there was nothing about the problem. Other applications not using temp queue worked fine. This happened twice in recent month. I just had to restart activemq to fix it.\nI saw a same error in mailing list but not sure if it's the same problem:\nhttp://activemq.2283324.n4.nabble.com/Getting-a-quot-Cannot-publish-to-a-deleted-Destination-quot-but-eventually-works-after-a-couple-of-rs-td4682497.html","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"402521","customfield_12312823":null,"summary":"temp queue not working after long run of activemq","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14047799","id":"14047799","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"A JUnit test case to demonstrate the issue is needed to understand the use case. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-06-30T16:17:55.799+0000","updated":"2014-06-30T16:17:55.799+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14048400","id":"14048400","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"body":"I understand but it's very hard to reproduce. The test case will pass normally and will only fail after activemq keeps running for several weeks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-01T01:28:02.554+0000","updated":"2014-07-01T01:28:02.554+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14049916","id":"14049916","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"the lifecycle of a temp queue depends on the connection lifecycle. So if the connection fails over, there will be a period when the temp destination will not exist. The activemq client tracks temp existence by listening to temp advisories, maybe you want to disable that such that the broker gets to determine if the temp exists. ( ?jms.watchTopicAdvisories=false on the connection factory url.)\nThis would eliminate any window between the client getting an advisory and the recreation of the temp.\nSo check if failover is part of the problem.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2014-07-02T13:41:33.555+0000","updated":"2014-07-02T13:41:33.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14051259","id":"14051259","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"body":"I guess it's not the specific client failing over caused the problem. Actually we have many similar clients using that pattern at the same time. When the problem happens, none of them works.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-03T09:38:46.968+0000","updated":"2014-07-03T09:38:46.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14062967","id":"14062967","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"body":"What is WAITING_FOR_TEST? This is fixed in some version?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-16T01:23:33.531+0000","updated":"2014-07-16T01:23:33.531+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14062985","id":"14062985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No, it means we are waiting for you to provide a unit test that can reproduce the problem.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-07-16T01:49:47.288+0000","updated":"2014-07-16T01:49:47.288+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14063017","id":"14063017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"body":"OK, got it. But as I stated above, I'm afraid it's very hard to provide a test case for this. Or anyone can provide any idea how to get a test case for such situation. The problem only happens after running for a very long time. \nAnyway, I'm now using 5.10 to check if the problem still exists.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-07-16T02:32:14.197+0000","updated":"2014-07-16T02:32:14.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14094820","id":"14094820","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No test case to investigate and from the description it sounds like normal temp queue behaviour as the lifetime is linked to that of its connection so if the connection goes down the Queues go away.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-08-12T22:42:39.895+0000","updated":"2014-08-12T22:42:39.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14114764","id":"14114764","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"body":"No it's definitely not normal behavior. This happened again after my activemq 5.10.0 running for about 2 months. I have written some code to test it. The main logic of the code is:\n1. Create a temp queue(tempQueue) and start a producer to send a message(setJMSReplyTo(tempQueue)) to specific queue.\n2. Start a comsumer to read the specific queue and send a response to the tempQueue.\n3. Consume the temp queue to check the repsonse message\n\nI put it in cron and run it every minute. It had been run two months without problem and suddenly it began to report the same error about every several minutes(yes, not every minutes, sometimes every minute, sometimes every 3 minutes, sometimes every 5 mintues, not constant).\n\nSince I'm not able to find a way to get the test case to reproduce the issue, I want to know if there is anything I could check to trace the root cause when the problem happens again.\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-29T02:16:27.010+0000","updated":"2014-08-29T02:16:27.010+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14115062","id":"14115062","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Try with watch topic advisories false. The error could result from the producer connection having not yet got an advisory. Having async sync dispatch on the advisory consumer may also play into this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-29T09:48:22.518+0000","updated":"2014-08-29T09:48:22.518+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14116160","id":"14116160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks. I will try that.But even this works around the problem, I think it's still worth checking what caused the issue for a long running activemq.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruralhunter","name":"ruralhunter","key":"ruralhunter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rural Hunter","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-30T01:25:12.591+0000","updated":"2014-08-30T01:25:12.591+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14305018","id":"14305018","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadrian","name":"hadrian","key":"hadrian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadrian&avatarId=13649","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadrian&avatarId=13649","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadrian&avatarId=13649","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadrian&avatarId=13649"},"displayName":"Hadrian Zbarcea","active":true,"timeZone":"America/New_York"},"body":"[~ruralhunter] You mention that you wrote a test that you're running via cron. Can you please share that and your broker config? Hopefully we'll bring this to a resolution. Otherwise we'd have to close it for lack of sufficient data. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadrian","name":"hadrian","key":"hadrian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadrian&avatarId=13649","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadrian&avatarId=13649","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadrian&avatarId=13649","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadrian&avatarId=13649"},"displayName":"Hadrian Zbarcea","active":true,"timeZone":"America/New_York"},"created":"2015-02-04T12:28:24.377+0000","updated":"2015-02-04T12:28:24.377+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14563857","id":"14563857","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No test has been provided to validate this.  From the description is sounds like standard behaviour ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-05-28T23:10:27.000+0000","updated":"2015-05-28T23:10:27.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12724269/comment/14646394","id":"14646394","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=blackstrype","name":"blackstrype","key":"blackstrype","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott M Messner","active":true,"timeZone":"Europe/Paris"},"body":"I believe I found a way to reproduce this error but I don't quite understand what's happening so I'll leave you guys with the code and you can tell me if you need more info:\n\nMy test consists of ServiceA sending a message and waiting for a response from ServiceB\nServiceB sends 5 response messages the 5th of which will be a Shutdown command.\n\nI've added a 30 second sleep to induce a FailOverTransport timeout error.\nThe first pass through the test runs fine, throwing the timeout error, but continuing gracefully (bravo ActiveMQ)\nRunning the test a second time will immediately throw the JMSException seen below. \n\n2015-07-29 18:34:35 INFO  FailoverTransport:1030 - Successfully connected to tcp://xxx.xxx.xxx.xxx:61616\n2015-07-29 18:34:35 INFO  FailoverTransport:1030 - Successfully connected to tcp://xxx.xxx.xxx.xxx:61616\n2015-07-29 18:34:38 INFO  FailoverTransport:1030 - Successfully connected to tcp://xxx.xxx.xxx.xxx:61616\n2015-07-29 18:34:38 INFO  FailoverTransport:1030 - Successfully connected to tcp://xxx.xxx.xxx.xxx:61616\n2015-07-29 18:34:38 ERROR TempDestinationTestServiceB:83 - Error treating message\ncom.blackstrype.mom.MOMException: sendReplyMapMessage JMSException : Cannot publish to a deleted Destination: temp-queue://ID:titoBox-64611-1438187511326-7:1:1\n\tat com.blackstrype.mom.CloudMOM.sendReplyMapMessage(CloudMOM.java:556)\n\tat com.blackstrype.mom.test.tempdest.TempDestinationTestServiceB$SandboxListener.onMessage(TempDestinationTestServiceB.java:72)\n\tat org.apache.activemq.ActiveMQMessageConsumer.dispatch(ActiveMQMessageConsumer.java:1321)\n\tat org.apache.activemq.ActiveMQSessionExecutor.dispatch(ActiveMQSessionExecutor.java:131)\n\tat org.apache.activemq.ActiveMQSessionExecutor.iterate(ActiveMQSessionExecutor.java:202)\n\tat org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:129)\n\tat org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:47)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: javax.jms.InvalidDestinationException: Cannot publish to a deleted Destination: temp-queue://ID:titoBox-64611-1438187511326-7:1:1\n\tat org.apache.activemq.ActiveMQSession.send(ActiveMQSession.java:1735)\n\tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:289)\n\tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:224)\n\tat org.apache.activemq.ActiveMQMessageProducerSupport.send(ActiveMQMessageProducerSupport.java:300)\n\tat com.blackstrype.mom.CloudMOM.sendReplyMapMessage(CloudMOM.java:554)\n\t... 9 more\n2015-07-29 18:34:38 INFO  TempDestinationTestServiceA:144 - Message response received: id=0, body=Response 0 to: 'abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuv'.\n2015-07-29 18:35:08 INFO  TempDestinationTestServiceA:144 - Message response received: id=1, body=Response 1 to: 'abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuv'.\n2015-07-29 18:35:38 INFO  TempDestinationTestServiceA:144 - Message response received: id=2, body=Response 2 to: 'abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuv'.\n2015-07-29 18:35:45 WARN  FailoverTransport:255 - Transport (tcp://YYY.YYY.YYY.YYY:61616) failed, reason:  org.apache.activemq.transport.InactivityIOException: Channel was inactive for too (>30000) long: tcp://YYY.YYY.YYY.YYY:61616, attempting to automatically reconnect\n2015-07-29 18:35:45 WARN  FailoverTransport:255 - Transport (tcp://YYY.YYY.YYY.YYY:61616) failed, reason:  org.apache.activemq.transport.InactivityIOException: Channel was inactive for too (>30000) long: tcp://YYY.YYY.YYY.YYY:61616, attempting to automatically reconnect\n2015-07-29 18:35:49 INFO  FailoverTransport:1032 - Successfully reconnected to tcp://xxx.xxx.xxx.xxx:61616\n2015-07-29 18:35:49 INFO  FailoverTransport:1032 - Successfully reconnected to tcp://xxx.xxx.xxx.xxx:61616\n2015-07-29 18:36:08 INFO  TempDestinationTestServiceA:144 - Message response received: id=3, body=Response 3 to: 'abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuv'.\n2015-07-29 18:36:38 INFO  TempDestinationTestServiceA:141 - Received 5 in 120.00 seconds\n2015-07-29 18:36:38 INFO  TempDestinationTestServiceA:144 - Message response received: id=4, body=SHUTDOWN\n2015-07-29 18:36:38 INFO  TempDestinationTest:77 - Sent: 5, Received: 5\n2015-07-29 18:36:38 INFO  TempDestinationTest:79 - Result is: 0\n\nAmusingly, my test continues successfully because ServiceB will reconsume the message and then finish sending the 5 responses.\nIf I reduce the sleep to 20 seconds, there are no timeouts and the second pass runs without issues. I leave it to you guys now!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=blackstrype","name":"blackstrype","key":"blackstrype","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott M Messner","active":true,"timeZone":"Europe/Paris"},"created":"2015-07-29T16:50:40.202+0000","updated":"2015-07-29T16:50:40.202+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5250/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1x9rr:"}}