{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483946","self":"https://issues.apache.org/jira/rest/api/2/issue/12483946","key":"AMQ-2056","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316331","id":"12316331","description":"Next unplanned v5 maintenance release","name":"5.x","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2009-01-08T18:36:08.490+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Oct 29 20:08:44 UTC 2012","customfield_12310420":"44201","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_120121357379_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-10-29T20:08:44.704+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2056/watchers","watchCount":1,"isWatching":false},"created":"2009-01-08T13:06:07.361+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-10-29T20:08:44.739+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313898","id":"12313898","name":"JCA Container"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I've found that if I configure Jencks with a low maxMessagesPerSessions (e.g. 3) and a higher maxSessions (e.g. 8) then my consumers hang after about 30 messages and no more messages get consumed.\n\nAny idea why this might be? I find that if I make the maxMessagesPerSessions (which AFAIK matches the queue prefetch value) higher then it seems to work. I'm happy to do this, but I'm puzzled as to why this occurs.\n\nAny help gratefully accepted - sample Spring config below. Also, I've attached sample code to this issue. Run the RequestHandler server from within Eclipse against a standalone broker, and then just use the ActiveMQ Web Console to sent 1000 messages to the queue RA.request\n\n/Ade\n\n\n    <bean id=\"listenerJcaConnector\" class=\"org.jencks.JCAConnector\">\n        <property name=\"jcaContainer\" ref=\"jencksContainer\"/>\n        <property name=\"transactionManager\" ref=\"transactionManager\"/>\n        <property name=\"activationSpec\">\n                    <bean class=\"org.apache.activemq.ra.ActiveMQActivationSpec\">\n                                <property name=\"destination\" value=\"RA.REQUEST\"/>\n                                <property name=\"destinationType\" value=\"javax.jms.Queue\"/>\n  <property name=\"maxSessions\" value=\"8\"/>\n                                <property name=\"maxMessagesPerSessions\" value=\"3\"/> <!-- effectively, this just matches the prefetch size -->\n\n                    </bean>\n        </property>\n        <property name=\"ref\" value=\"messageListener\"/>\n    </bean> ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461904","id":"12461904","filename":"jencks-blocking-consumers.tar","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"created":"2009-01-08T13:07:13.749+0000","size":40960,"mimeType":"application/x-tar","content":"https://issues.apache.org/jira/secure/attachment/12461904/jencks-blocking-consumers.tar"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59799","customfield_12312823":null,"summary":"Jencks container sometimes hangs when maxMessagesPerSessions is < maxSessions","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Mac OX/X","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483946/comment/12943300","id":"12943300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"body":"Sample code","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"created":"2009-01-08T13:07:13.804+0000","updated":"2009-01-08T13:07:13.804+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483946/comment/12940647","id":"12940647","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"body":"This looks like it might be related to AMQ-1632.  It doesn't look like I ever got a chance to compare the fix in the 4.x branch with trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-01-08T18:36:08.490+0000","updated":"2009-01-08T18:36:08.490+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483946/comment/12943308","id":"12943308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"body":"Thanks David - this looks very, very similar... do you have a fix in mind?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adrian.trenaman","name":"adrian.trenaman","key":"adrian.trenaman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adrian Trenaman","active":true,"timeZone":"Etc/UTC"},"created":"2009-01-09T10:32:08.953+0000","updated":"2009-01-09T10:32:08.953+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483946/comment/13486305","id":"13486305","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Jencks is EOL at this point.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2012-10-29T20:08:44.719+0000","updated":"2012-10-29T20:08:44.719+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2056/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0alrj:"}}