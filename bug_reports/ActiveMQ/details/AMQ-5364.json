{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12742605","self":"https://issues.apache.org/jira/rest/api/2/issue/12742605","key":"AMQ-5364","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2014-09-18 23:09:46.502","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5364/watchers","watchCount":3,"isWatching":false},"created":"2014-09-18T23:09:46.502+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["mqtt","networkofbrokers"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324951","id":"12324951","name":"5.11.0","archived":false,"released":true,"releaseDate":"2015-02-04"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-09-18T23:26:07.522+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12318701","id":"12318701","name":"MQTT","description":"MQTT Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I’m trying to make sure that if an unsubscribe() is done for an existing durable topic in any of the brokers, it takes effect in all the brokers (I.e) no further messages published to that topic (in any of the brokers) should be received by the client that unsubscribed (when it connects at a later time after publish).\n\nI’ve explained my test cases below and also I’ve attached my test code. The test numbers (from the list below) that are failing are 2, 4, 6, 7, 8, 9.\n\n/*  \n * Test if unsubscribe() works as intended in a network of brokers (two) scenario\n * \n * Setup:\n * Broker1 and Broker2 are networked. \n *          Broker1(B1)    <----->   Broker2(B2)\n * \n * B1 is running MQTT transport on 1883 and B2 on 2883 on the same machine. They have a duplex network connector between them. The MQTT transport connector uses the transport.subscriptionStrategy option as shown below:\n<transportConnector name=\"mqtt\"uri=\"mqtt://0.0.0.0:1883?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600&amp;transport.subscriptionStrategy=mqtt-virtual-topic-subscriptions”/\n * \n * General flow:\n * 1. Clear any previous durable subs in B1 and B2 (use clean_session = true)\n * 2. Create durable subscription by connecting to B1\n * 3. Publish message in B1\n * 4. Confirm that the durable subscription was created by connecting to B1 and receiving the message\n * 5. Unsubscribe in B1 or B2 or both\n * 6. Publish message in B1 or B2 or both\n * 7. Connect to B1 (and B2) and make sure message is NOT received\n * \n * In steps 5 (Unsub) and 6 (Pub), we can perform the steps in B1 or B2 or both. This gives rise to the following test cases\n *          UnsubB1     UnsubB2     PubB1       PubB2\n * -----------------------------------------------------\n * 1.       false           true            false           true\n * 2.       true            false           false           true\n * 3.       true            true            false           true\n * 4.       false           true            true            false\n * 5.       true            false           true            false\n * 6.       true            true            true            false\n * 7.       false           true            true            true\n * 8.       true            false           true            true\n * 9.       true            true            true            true\n */\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12669848","id":"12669848","filename":"ActivemqNbTests.tar.gz","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=workanandr","name":"workanandr","key":"workanandr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"AR","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-18T23:10:21.203+0000","size":3433,"mimeType":"application/x-gzip","content":"https://issues.apache.org/jira/secure/attachment/12669848/ActivemqNbTests.tar.gz"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"MQTT Unsubscribe does not work as intended in network of brokers scenario","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=workanandr","name":"workanandr","key":"workanandr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"AR","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=workanandr","name":"workanandr","key":"workanandr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"AR","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5364/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i208hj:"}}