{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482545","self":"https://issues.apache.org/jira/rest/api/2/issue/12482545","key":"AMQ-1970","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-10-13T15:28:00.086+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 06 10:47:08 UTC 2008","customfield_12310420":"75147","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_427402081_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2008-10-13T15:28:00.121+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1970/watchers","watchCount":1,"isWatching":false},"created":"2008-10-08T16:44:38.040+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-11-06T10:47:08.335+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"See the attached application. \n\nIf I run\n\n   org.activemq.jms.StandaloneApp 200 1\n\nit works fine. Tried it 5 times, so sent 1000 messages altogether\n\nIf I run\n\n  org.activemq.jms.StandaloneApp 250 1\n\nit fails. The master is fine, but the slave still has pending messages on \"queue.A\". (43 in my last run)\nIt reported 407 received messages. (the first 200 + 207 of the last run)\n\nMaster logs:\n2008-10-08 18:31:04,509 [queue://queue.A] DEBUG AMQMessageStore                - flush starting ...\n2008-10-08 18:31:04,513 [0.1.1.155:56003] DEBUG AMQMessageStore                - Journalled message add for: ID:hans-44777-1223483462760-0:1:1:1:208, at: offset = 168628, file = 1, size = 279, type = 1\n2008-10-08 18:31:04,513 [queue://queue.A] DEBUG AMQMessageStore                - Doing batch update... adding: 1 removing: 0 \n2008-10-08 18:31:04,513 [queue://queue.A] DEBUG AMQMessageStore                - Batch update done.\n.................\n2008-10-08 18:31:33,313 [0.1.1.155:56846] DEBUG TransportConnection            - Stopping connection: /10.1.1.155:56846\n2008-10-08 18:31:33,314 [0.1.1.155:56846] DEBUG TcpTransport                   - Stopping transport tcp:///10.1.1.155:56846\n2008-10-08 18:31:33,314 [0.1.1.155:56846] DEBUG TransportConnection            - Stopped transport: /10.1.1.155:56846\n2008-10-08 18:31:33,314 [0.1.1.155:56846] DEBUG TransportConnection            - Connection Stopped: /10.1.1.155:56846\n2008-10-08 18:31:33,317 [0.1.1.155:56001] ERROR MasterBroker                   - Slave Failed\njavax.jms.JMSException: Unmatched acknowledege: Could not find Message-ID null in dispatched-list (end of ack)\n        at org.apache.activemq.broker.region.PrefetchSubscription.assertAckMatchesDispatched(PrefetchSubscription.java:443)\n        at org.apache.activemq.broker.region.PrefetchSubscription.acknowledge(PrefetchSubscription.java:187)\n        at org.apache.activemq.broker.region.AbstractRegion.acknowledge(AbstractRegion.java:373)\n        at org.apache.activemq.broker.region.RegionBroker.acknowledge(RegionBroker.java:462)\n        at org.apache.activemq.broker.TransactionBroker.acknowledge(TransactionBroker.java:194)\n        at org.apache.activemq.broker.BrokerFilter.acknowledge(BrokerFilter.java:74)\n        at org.apache.activemq.broker.BrokerFilter.acknowledge(BrokerFilter.java:74)\n        at org.apache.activemq.broker.MutableBrokerFilter.acknowledge(MutableBrokerFilter.java:85)\n        at org.apache.activemq.broker.TransportConnection.processMessageAck(TransportConnection.java:456)\n        at org.apache.activemq.command.MessageAck.visit(MessageAck.java:205)\n        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:305)\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:179)\n        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:104)\n        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n        at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:205)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n2008-10-08 18:31:33,319 [0.1.1.155:56001] DEBUG AMQMessageStore                - Journalled message remove for: ID:hans-44777-1223483462760-0:1:1:1:208, at: offset = 233965, file = 1, size = 266, type = 1\n2008-10-08 18:31:33,319 [queue://queue.A] DEBUG AMQMessageStore                - Doing batch update... adding: 0 removing: 1 \n2008-10-08 18:31:33,320 [queue://queue.A] DEBUG AMQMessageStore                - Batch update done.\n\n\nSlave logs:\n2008-10-08 18:31:04,515 [.serverhost#1] ERROR Service                        - Async error occurred: javax.jms.JMSException: Slave broker out of sync with master: Dispatched message (ID:hans-44777-1223483462760-0:1:1:1:208) was not in the pending list\njavax.jms.JMSException: Slave broker out of sync with master: Dispatched message (ID:hans-44777-1223483462760-0:1:1:1:208) was not in the pending list\n        at org.apache.activemq.broker.region.PrefetchSubscription.processMessageDispatchNotification(PrefetchSubscription.java:174)\n        at org.apache.activemq.broker.region.AbstractRegion.processDispatchNotification(AbstractRegion.java:414)\n        at org.apache.activemq.broker.region.RegionBroker.processDispatchNotification(RegionBroker.java:585)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461190","id":"12461190","filename":"ASF.LICENSE.NOT.GRANTED--activemqjee-0.0.5-src.tar.gz","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-08T16:44:38.052+0000","size":7984,"mimeType":"application/x-gzip","content":"https://issues.apache.org/jira/secure/attachment/12461190/ASF.LICENSE.NOT.GRANTED--activemqjee-0.0.5-src.tar.gz"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"161797","customfield_12312823":null,"summary":"Slave in Pure Master/Slave setup not updated when more than 200 messages on a queue","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"5.2.0 RC2 in Pure Master/Slave setup with a single client\n\njava version \"1.6.0_07\"\nJava(TM) SE Runtime Environment (build 1.6.0_07-b06)\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482545/comment/12940314","id":"12940314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"I have not yet updated the client library. Which jars do I need from the RC2 binary?\n\nIn these tests I've used the activemq-all-5.2.0.jar from RC1, I think. (2622429 bytes 2008-09-10 10:29)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-09T06:37:57.680+0000","updated":"2008-10-09T06:37:57.680+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482545/comment/12940305","id":"12940305","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Found it :)\n\nhttp://people.apache.org/~gtully/staging-repos/activemq-5.2.0/org/apache/activemq/activemq-all/5.2.0/activemq-all-5.2.0.jar\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-09T06:40:43.915+0000","updated":"2008-10-09T06:40:43.915+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482545/comment/12940323","id":"12940323","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"704142. slave was not affecting the inFlight count which is used to determine how many messages to pageIn. the result, only pageSize(200) unacked messages could exist in the slave without out of sync problems. having the slave modify inFlight as expected fixes this.\nAdditional test shows the problem and will protect the fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-13T15:28:00.086+0000","updated":"2008-10-13T15:28:00.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482545/comment/12939628","id":"12939628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"These fixes will now make 5.2.0 rc3","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-06T10:47:08.333+0000","updated":"2008-11-06T10:47:08.333+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1970/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0s1zb:"}}