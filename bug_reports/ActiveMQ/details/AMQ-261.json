{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12481295","self":"https://issues.apache.org/jira/rest/api/2/issue/12481295","key":"AMQ-261","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315601","id":"12315601","name":"3.1","archived":false,"released":true}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2005-06-09T16:52:27.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jul 13 18:01:45 UTC 2005","customfield_12310420":"48982","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2429150000_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2005-07-07T17:41:13.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-261/watchers","watchCount":0,"isWatching":false},"created":"2005-06-09T14:55:23.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315600","id":"12315600","name":"3.0","archived":false,"released":true}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2005-07-13T18:01:45.000+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Cook reported that we have broker the wire Format.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"161574","customfield_12312823":null,"summary":"ActiveMQ 3.0 client does not seem to be compatible with 3.1 server.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12937221","id":"12937221","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"Dennis Cook Posted:\n\nI have a question on connection compatibility.  Having read some older post about compatibility between versions, that led me to believe that older clients could connect to a newer broker if the major version was the same.  Where version 2 to version 3 was not possible because wire protocol changed, I thought 3.0 to 3.1 should be possible.  However my recent testing has shown several failures.  Since the bug reporting system is still out of commission, I have been sending these on to Hiram as I find them.  But I would like to get a consensus viewpoint.  Should 3.0 connection clients be connection compatible with the soon to be release version 3.1, or am I just chasing after a lost cause here?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2005-06-09T14:59:16.000+0000","updated":"2005-06-09T14:59:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12936964","id":"12936964","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"I fixed one problem with ActiveMQDestination by setting it's serialVersionUID to:\nstatic final long serialVersionUID = -3300456112096957638L;\n\nOther preoblems may be left.  Still need to check.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2005-06-09T15:01:22.000+0000","updated":"2005-06-09T15:01:22.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12936894","id":"12936894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"body":"Second problem found:\n\nIn the class org.activemq.broker.impl.AdvisorySupport there are many references to the method\n\nActiveMQDestination.getDestinationBeingAdvised()\n\nsuch as the following example:\n\nActiveMQDestination match = advisory.getDestination().getDestinationBeingAdvised();\n\nThis usually followed by an unconditional use of the \"match\" member which was supposibly populated with the return value.  However this method can return a null value.  When the value is null, a NullPointerException is generated and the operation is never completed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"created":"2005-06-09T16:52:27.000+0000","updated":"2005-06-09T16:52:27.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12936961","id":"12936961","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"body":"The next problem I run into is now showing up on the 3.0 client side.  The exception conditions is as show below:\n\n17:31:56,629 WARN  ActiveMQMessageConsumer  : could not process message: ACTIVEMQ_OBJECT_MESSAGE: id = 0 ActiveMQMessage{ , jmsMessageID = ID:ctl001-36683-1117844639697-1:360685, bodyAsBytes = org.activemq.io.util.ByteArray@14df53, readOnlyMessage = true, jmsClientID = 'null' , jmsCorrelationID = 'null' , jmsDestination = ActiveMQ.Advisory.TempDestinations.TemporaryTopic-{TD{wingnut.FPM.18}TD}ID:WINGNUT-3646-1117845035072-29:0, jmsReplyTo = null, jmsDeliveryMode = 2, jmsRedelivered = false, jmsType = 'null' , jmsExpiration = 0, jmsPriority = 4, jmsTimestamp = 0, properties = null, readOnlyProperties = true, entryBrokerName = 'null' , entryClusterName = 'null' , consumerNos = [I@51f266, transactionId = 'null' , xaTransacted = false, consumerIdentifer = 'encamed002.Monitor.25.63.51' , messageConsumed = false, transientConsumed = true, sequenceNumber = 0, deliveryCount = 1, dispatchedFromDLQ = false, messageAcknowledge = org.activemq.ActiveMQSession@6cd0f9, jmsMessageIdentity = null, producerKey = null } ActiveMQObjectMessage{ object = ACTIVEMQ_CONNECTION_INFO: id = 0 ConnectionInfo{ clientId = 'log001.ResourceManager.1' , userName = 'defaultUser' , hostName = 'LOG001' , clientVersion = '3.1-SNAPSHOT' , wireFormatVersion = 3, startTime = 1117050559118, started = true, closed = false, properties = {noDelay=true} } } \njava.lang.ClassCastException: org.activemq.message.ConnectionInfo\n \tat org.activemq.advisories.TempDestinationAdvisor.onMessage(TempDestinationAdvisor.java:137)\n \tat org.activemq.ActiveMQMessageConsumer.processMessage(ActiveMQMessageConsumer.java:443)\n \tat org.activemq.ActiveMQMessageConsumer.setMessageListener(ActiveMQMessageConsumer.java:243)\n \tat org.activemq.advisories.TempDestinationAdvisor.start(TempDestinationAdvisor.java:84)\n \tat org.activemq.ActiveMQConnection.startAdvisoryForTempDestination(ActiveMQConnection.java:1973)\n \tat org.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:424)\n \tat org.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:390)\n \tat org.activemq.ActiveMQTopicPublisher.publish(ActiveMQTopicPublisher.java:177)\n \tat bevocal.platform.util.MsgOutbox.run(MsgOutbox.java:432) \n\nI am really at a loss on how to explain the existance of the ConnectionInfo message in the client queue when the advisory consumer is created.  If you have any idea on how to get around this one I would love the input.  Otherwise I am not going to be able to stage my deployment and have to change all clients and the server at the same time.  That would not be fun.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"created":"2005-06-09T16:53:37.000+0000","updated":"2005-06-09T16:53:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12936885","id":"12936885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"Hi Dennis,\n\nI just tried the producer consumer examples shipped with 3.0 against a 3.1-SNAPSHOT server and they worked correctly.  What is your test case doing that's causing this error to show up?\n\nRegards,\nHiram","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2005-06-15T18:31:43.000+0000","updated":"2005-06-15T18:31:43.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12937170","id":"12937170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"body":"Hey Hiram,\n\nThe test case that showed the problem used networked brokers. It was a request/reply (non-durable topic) where the replier was connected to one broker and the requestor connected to the other broker.  I think that both the requestor and replier were version 3.0 and both brokers version 3.1.  I created separate classes for the requetor and replier.  I will attach them tomorrow when I get to work.\n\nDennis\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"created":"2005-06-16T01:30:36.000+0000","updated":"2005-06-16T01:30:36.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12937102","id":"12937102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"body":"Dennis, is this still an issue - or can we mark it as fixed?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"created":"2005-07-06T11:41:24.000+0000","updated":"2005-07-06T11:41:24.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481295/comment/12937053","id":"12937053","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"body":"I am not sure if still incompatible of not.  I have moved everything onto the 3.1 snapshots so it is no longer a problem for me.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dennis%40bevocal.com","name":"dennis@bevocal.com","key":"dennis@bevocal.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dennis Cook","active":true,"timeZone":"Etc/UTC"},"created":"2005-07-13T18:01:45.000+0000","updated":"2005-07-13T18:01:45.000+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-261/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0s0lr:"}}