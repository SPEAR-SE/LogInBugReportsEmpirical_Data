{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12556208","self":"https://issues.apache.org/jira/rest/api/2/issue/12556208","key":"AMQ-3848","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon May 21 16:22:00 UTC 2012","customfield_12310420":"296457","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_9850810731_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-09-08T09:40:56.985+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3848/watchers","watchCount":2,"isWatching":false},"created":"2012-05-17T09:20:46.279+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315625","id":"12315625","description":"","name":"5.4.2","archived":false,"released":true,"releaseDate":"2010-12-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12318549","id":"12318549","name":"5.5.1","archived":false,"released":true,"releaseDate":"2011-10-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davsclaus","name":"davsclaus","key":"davsclaus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"},"displayName":"Claus Ibsen","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-09-08T09:40:57.007+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315705","id":"12315705","name":"activemq-camel","description":"camel activemq component"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I am using Spring 3.1 and ActiveMQ 5.5.1 with Camel 2.9.0 although I can duplicate it with various different versions.\n\nI do the following:\nPut some messages on one queue (Queue2Queue.Inbound)\nAdd a JMS header and put it on a new queue (Queue2Queue.Inbound.0)\nRead off the new queue with 20 threads\nPut them on a third queue (Queue2Queue.DLQ)\n\nHere is a snippet of the Camel setup.\n{code}\n  public void configure() throws Exception {\n    String inboundQueue = \"activemq:\" + testProperties.getProperty(Queue2QueueCamelRunner.INBOUND_MQ_QUEUE);\n    from(DIRECT_START)\n      .to(inboundQueue)\n      .process(headerEnricher)\n      .to(inboundQueue + \".0\");\n\n    String processingQueue = inboundQueue + \".0?concurrentConsumers=20\";\n    from(processingQueue)\n      .to(\"activemq:Queue2Queue.DLQ\");\n  }\n{code}\n\nMy attached test case puts 10, 100 and 1000 messages on the queue then counts them.\nThe results I get are:\n10=10\n100=100\n1000!=1000\n\nWhen I run in the embedded ActiveMQ I often see 200 messages missing.\nWhen I run it on the deployed version I will see 1110 messages listed in the Web Console but only 867 when I drill down (or if I use a browser like HermesJMS).\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528450","id":"12528450","filename":"ActiveMQIssue.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"created":"2012-05-21T16:22:00.815+0000","size":9298,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12528450/ActiveMQIssue.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"233005","customfield_12312823":null,"summary":"Messages Are Not Read With Multiple Consumers","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556208/comment/13279006","id":"13279006","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"body":"It seems that the method of counting the messages in the test case was flawed when running against the embedded version and it doesn't duplicate the issue we are seeing in production.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"created":"2012-05-18T17:41:52.193+0000","updated":"2012-05-18T17:41:52.193+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556208/comment/13280255","id":"13280255","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"body":"Cleaned up the test but can't make it fail with the embedded ActiveMQ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=opticyclic","name":"opticyclic","key":"opticyclic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"opticyclic","active":true,"timeZone":"America/Toronto"},"created":"2012-05-21T16:22:00.839+0000","updated":"2012-05-21T16:22:00.839+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3848/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i149in:"}}