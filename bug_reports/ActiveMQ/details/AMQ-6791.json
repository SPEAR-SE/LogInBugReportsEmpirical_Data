{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13093379","self":"https://issues.apache.org/jira/rest/api/2/issue/13093379","key":"AMQ-6791","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2017-08-09 06:39:45.654","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6791/watchers","watchCount":1,"isWatching":false},"created":"2017-08-09T06:39:45.654+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/5","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"labels":["easyfix"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334188","id":"12334188","name":"5.14.0","archived":false,"released":true,"releaseDate":"2016-08-05"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-08-09T06:44:23.356+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12321500","id":"12321500","name":"webconsole","description":"Web console such as the old and the new hawtio console"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"The method {{getConnection}} in {{org.apache.activemq.web.SessionPool}} swallows instances of {{JMSException}} in the catch block if line 48 {{getConnectionFactory().createConnection()}} doesn't return a connection object. \n\nThis is the case if  the transport connector for open wire isn't bound to {{0.0.0.0}} or at least to {{localhost}} and a client tries to browse a queue via ActiveMq webconsole. E.g. if activemq.xml contains the following transport connector\n\n{code:xml}\n<transportConnectors>\n         <transportConnector name=\"openwire\" uri=\"tcp://some_host_name:61616?maximumConnections=1000&amp;wireFormat.maxFrameSize=104857600\"/>            \n        </transportConnectors>\n{code}\n and a client requests the resource {{http://some_host_name/activemqweb/browse.jsp?JMSDestination=some_queue}} the error {{Exception occurred while processing this request, check the log for more information!}} is displayed in the browser. In this case the log contains the following stacktrace:\n\n{code:java}\n2017-08-09 06:30:18,198 | WARN  | tp1746037789-343 | ServletHandler                   | 276 - org.eclipse.jetty.util - 9.2.14.v20151106 | \norg.apache.jasper.JasperException: An exception occurred processing JSP page /browse.jsp at line 19\n\n16: --%>\n17: <html>\n18: <head>\n19: <c:set var=\"pageTitle\" value=\"Browse ${requestContext.queueBrowser.JMSDestination}\"/>\n20: \n21: <%@include file=\"decorators/head.jsp\" %>\n22: </head>\n\n\nStacktrace:\n\tat org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:576)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:468)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:396)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:340)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)[100:javax.servlet-api:3.1.0]\n\tat org.ops4j.pax.web.jsp.JspServletWrapper$2.call(JspServletWrapper.java:155)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.ops4j.pax.web.jsp.JspServletWrapper$2.call(JspServletWrapper.java:151)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.ops4j.pax.swissbox.core.ContextClassLoaderUtils.doWithClassLoader(ContextClassLoaderUtils.java:60)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.ops4j.pax.web.jsp.JspServletWrapper.service(JspServletWrapper.java:150)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:812)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1669)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.apache.activemq.web.SessionFilter.doFilter(SessionFilter.java:45)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.apache.activemq.web.filter.ApplicationContextFilter.doFilter(ApplicationContextFilter.java:102)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.ops4j.pax.web.service.jetty.internal.HttpServiceServletHandler.doHandle(HttpServiceServletHandler.java:70)[317:org.ops4j.pax.web.pax-web-jetty:4.2.4]\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)[272:org.eclipse.jetty.security:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.ops4j.pax.web.service.jetty.internal.HttpServiceContext.doHandle(HttpServiceContext.java:271)[317:org.ops4j.pax.web.pax-web-jetty:4.2.4]\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)[274:org.eclipse.jetty.servlet:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.ops4j.pax.web.service.jetty.internal.JettyServerHandlerCollection.handle(JettyServerHandlerCollection.java:80)[317:org.ops4j.pax.web.pax-web-jetty:4.2.4]\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.Server.handle(Server.java:499)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)[273:org.eclipse.jetty.server:9.2.14.v20151106]\n\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)[265:org.eclipse.jetty.io:9.2.14.v20151106]\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)[276:org.eclipse.jetty.util:9.2.14.v20151106]\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)[276:org.eclipse.jetty.util:9.2.14.v20151106]\n\tat java.lang.Thread.run(Thread.java:745)[:1.8.0_102]\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'queueBrowser' defined in ServletContext resource [/WEB-INF/webconsole-query.xml]: Bean instantiation via constructor failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.activemq.web.QueueBrowseQuery]: Constructor threw exception; nested exception is java.lang.NullPointerException\n\tat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:275)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1137)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1040)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:504)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:476)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractBeanFactory$2.getObject(AbstractBeanFactory.java:342)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.web.context.request.AbstractRequestAttributesScope.get(AbstractRequestAttributesScope.java:44)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:963)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.apache.activemq.web.filter.ApplicationContextFilter$2.get(ApplicationContextFilter.java:178)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat javax.el.MapELResolver.getValue(MapELResolver.java:65)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.jasper.el.JasperELResolver.getValue(JasperELResolver.java:110)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.el.parser.AstValue.getValue(AstValue.java:167)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.el.parser.AstDynamicExpression.getValue(AstDynamicExpression.java:43)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.el.parser.AstCompositeExpression.getValue(AstCompositeExpression.java:49)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:187)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.jasper.el.JspValueExpression.getValue(JspValueExpression.java:115)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat org.apache.jsp.browse_jsp._jspx_meth_c_005fset_005f0(browse_jsp.java:203)[file:/opt/kisters/energy-offer-handling/karaf/data/pax-web-jsp/activemqweb/:]\n\tat org.apache.jsp.browse_jsp._jspService(browse_jsp.java:109)[file:/opt/kisters/energy-offer-handling/karaf/data/pax-web-jsp/activemqweb/:]\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)[100:javax.servlet-api:3.1.0]\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:431)[318:org.ops4j.pax.web.pax-web-jsp:4.2.4]\n\t... 36 more\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.activemq.web.QueueBrowseQuery]: Constructor threw exception; nested exception is java.lang.NullPointerException\n\tat org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:163)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:122)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:267)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\t... 58 more\nCaused by: java.lang.NullPointerException\n\tat org.apache.activemq.web.SessionPool.getConnection(SessionPool.java:53)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.apache.activemq.web.SessionPool.createSession(SessionPool.java:114)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.apache.activemq.web.SessionPool.borrowSession(SessionPool.java:93)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat org.apache.activemq.web.QueueBrowseQuery.<init>(QueueBrowseQuery.java:40)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)[:1.8.0_102]\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)[:1.8.0_102]\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)[:1.8.0_102]\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)[:1.8.0_102]\n\tat org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)[109:org.apache.activemq.activemq-web-console:5.14.0]\n\t... 60 more\n{code}\n\nIn fact the JMSException contains the following message which would be more helpful :)\n{code:java}\nCould not connect to broker URL: tcp://localhost:61616. Reason: java.net.ConnectException: Connection refused\n{code}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"NullPointerException at org.apache.activemq.web.SessionPool.getConnection(SessionPool.java:53) hidding the real cause (JMSException)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=AlexEasterwood","name":"AlexEasterwood","key":"alexeasterwood","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=alexeasterwood&avatarId=32347","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alexeasterwood&avatarId=32347","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alexeasterwood&avatarId=32347","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alexeasterwood&avatarId=32347"},"displayName":"Alexander Osterwald","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=AlexEasterwood","name":"AlexEasterwood","key":"alexeasterwood","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=alexeasterwood&avatarId=32347","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alexeasterwood&avatarId=32347","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alexeasterwood&avatarId=32347","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alexeasterwood&avatarId=32347"},"displayName":"Alexander Osterwald","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6791/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3ikrz:"}}