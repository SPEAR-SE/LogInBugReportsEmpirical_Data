{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483436","self":"https://issues.apache.org/jira/rest/api/2/issue/12483436","key":"AMQ-1376","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315631","id":"12315631","description":"Issues that are getting ready to be kicked - review 'em once more if you like","name":"AGING_TO_DIE","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2008-03-04T02:39:55.707+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 05 18:41:54 UTC 2011","customfield_12310420":"69115","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_121381102533_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-07-05T18:41:54.875+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1376/watchers","watchCount":5,"isWatching":false},"created":"2007-08-30T21:43:32.376+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-07-05T18:41:54.892+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"This is a reproducible case of a DEAD Consumer that never gets cleaned up.\n\nI am using telnet to manually test STOMP message consumption.\n\nFirst I put a message into the queue\n\nI then connect and subscribe to that queue and get the message:\n\nCONNECT\nlogin: test\npasscode: test\n\n^@\nCONNECTED\nsession:ID:jacob-64807-1188509209664-4:3\n\n\nSUBSCRIBE\ndestination: /queue/Prescriptions\nack: client\n\n^@\n\n\nThis works and I receive the queued messages.\nThey remain in the Q because I am not send ACK\n\nIf I use the DISCONNECT command. I am properly disconnected and I can repeat this process to get the same message again. Good.\n\nIf I disconnect by killing the telnet process I see the following stack trace in MQ. AND I can still repeat the same process of re-retrieving the un-acknowledged messages:\n\tDEBUG Transport                      - Transport failed: java.io.EOFException\n\tjava.io.EOFException\n\t        at java.io.DataInputStream.readByte(DataInputStream.java:243)\n\t        at org.apache.activemq.transport.stomp.StompWireFormat.readLine(StompWireFormat.java:186)\n\t        at org.apache.activemq.transport.stomp.StompWireFormat.unmarshal(StompWireFormat.java:94)\n\t        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:196)\n\t        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:188)\n\t        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:176)\n\t        at java.lang.Thread.run(Thread.java:613)\n\tDEBUG TransportConnection            - Stopping connection: /XXXXXXXXXXXXXX:4880\n\tDEBUG TcpTransport                   - Stopping transport tcp:///XXXXXXXXXXXXXX:4880\n\tDEBUG TransportConnection            - Stopped connection: /XXXXXXXXXXXXXX:4880\n\tDEBUG TransportConnection            - Cleaning up connection resources: /XXXXXXXXXXXXXX:4880\n\tDEBUG AMQPersistenceAdapter          - Checkpoint started.\n\tDEBUG AMQPersistenceAdapter          - Checkpoint done.\n\nHOWEVER,\nIf I disconnect by repeatedly typing Control-C to close the telnet program I see the following stack trace:\n\tDEBUG Transport                      - Transport failed: org.apache.activemq.transport.stomp.ProtocolException: Unable to parser header line [????????????]\n\torg.apache.activemq.transport.stomp.ProtocolException: Unable to parser header line [????????????]\n\t        at org.apache.activemq.transport.stomp.StompWireFormat.unmarshal(StompWireFormat.java:121)\n\t        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:196)\n\t        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:188)\n\t        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:176)\n\t        at java.lang.Thread.run(Thread.java:613)\n\tDEBUG TransportConnection            - Stopping connection: /XXXXXXXXXXXXXX:64820\n\tDEBUG TcpTransport                   - Stopping transport tcp:///XXXXXXXXXXXXXX:64820\n\tDEBUG AMQPersistenceAdapter          - Checkpoint started.\n\tDEBUG AMQPersistenceAdapter          - Checkpoint done.\n\nAND, I am no longer able to retrieve the queued up messages.  Looking at the admin console I see  Number Of Consumers  = 1, leading me to believe that ActiveMQ didn't properly handle the disconnection.  In the other 2 cases (DISCONNECT and kill) the \"Number Of Consumers\" drops to zero on connection termination.\n\nI believe the correct behavior should be to properly handle and clean-up the connection on bad data.  Or perhaps periodically check each of the supposed \"Consumers\" to make sure that they are still alive.  This is clearly a reproducible case of a DEAD Consumer that never gets cleaned up.\n\nComparing the DEBUG output the follows the 2 stack traces, it is clear in the second case that ActiveMQ fails to clean up the connections resources for the unexpectedly disconnected consumer.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172196","customfield_12312823":null,"summary":"Improperly closed connections preventing message redelivery","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=igotimac","name":"igotimac","key":"igotimac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jacob Burkhart","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=igotimac","name":"igotimac","key":"igotimac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jacob Burkhart","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12939360","id":"12939360","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=theduderog","name":"theduderog","key":"theduderog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roger Hoover","active":true,"timeZone":"America/Los_Angeles"},"body":"This problem doesn't just prevent redelivery.  The thread assigned to that STOMP connection never gets released.  Over time, these unused threads build up until some limit is reached and broker becomes unresponsive.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=theduderog","name":"theduderog","key":"theduderog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roger Hoover","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-03-04T02:39:55.707+0000","updated":"2008-03-04T02:39:55.707+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12939480","id":"12939480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"I believe that the improved connection shutdown code in the current trunk should resolve this issue.  Could you re-test against trunk and let me know if you still see the same thing?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2008-04-09T14:12:33.946+0000","updated":"2008-04-09T14:12:33.946+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12941854","id":"12941854","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bsnyder","name":"bsnyder","key":"bsnyder","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruce Snyder","active":true,"timeZone":"America/Denver"},"body":"Please provide feedback regarding this issue and whether it been fixed in the latest release of ActiveMQ (5.3). If there is no feedback, this issue will be closed. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bsnyder","name":"bsnyder","key":"bsnyder","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruce Snyder","active":true,"timeZone":"America/Denver"},"created":"2009-11-20T18:39:37.952+0000","updated":"2009-11-20T18:39:37.952+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12941917","id":"12941917","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkothiyal","name":"vkothiyal","key":"vkothiyal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vipul Kothiyal","active":true,"timeZone":"Etc/UTC"},"body":"This problem still persists with 5.3.0, MQ doesn't close teh connection cleanly.\n\n2009-12-08 17:00:07,762 | DEBUG | Stopped transport: /10.52.68.200:37123 | org.apache.activemq.broker.TransportConnection | ActiveMQ Transport Stopper: /10.52.68.200:37123\n2009-12-08 17:00:07,762 | DEBUG | Cleaning up connection resources: /10.52.68.200:37123 | org.apache.activemq.broker.TransportConnection | ActiveMQ Transport Stopper: /10.52.68.200:37123\n2009-12-08 17:00:07,762 | DEBUG | Connection Stopped: /10.52.68.200:37123 | org.apache.activemq.broker.TransportConnection | ActiveMQ Transport Stopper: /10.52.68.200:37123\n2009-12-08 17:00:07,763 | DEBUG | Transport failed: java.io.EOFException | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///10.52.68.200:37122\njava.io.EOFException\n        at java.io.DataInputStream.readByte(DataInputStream.java:243)\n        at org.apache.activemq.transport.stomp.StompWireFormat.readLine(StompWireFormat.java:186)\n        at org.apache.activemq.transport.stomp.StompWireFormat.unmarshal(StompWireFormat.java:94)\n        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:210)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:202)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:185)\n        at java.lang.Thread.run(Thread.java:595)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkothiyal","name":"vkothiyal","key":"vkothiyal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vipul Kothiyal","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-08T17:20:17.329+0000","updated":"2009-12-08T17:20:17.329+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12942838","id":"12942838","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=remer","name":"remer","key":"remer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Rem","active":true,"timeZone":"Etc/UTC"},"body":"May be it exists also in 5.4.0 and in 5.4.1. After one wrong action this exception will be written in log without stop: but all messages will be processed in the same time also... only log file is growing!\n\n2010-10-04 18:17:57,649 | INFO  | Transport failed: java.io.EOFException | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///172.16.1.25:24396\njava.io.EOFException\n\tat java.io.DataInputStream.readByte(DataInputStream.java:243)\n\tat org.apache.activemq.transport.stomp.StompWireFormat.readLine(StompWireFormat.java:146)\n\tat org.apache.activemq.transport.stomp.StompWireFormat.parseAction(StompWireFormat.java:162)\n\tat org.apache.activemq.transport.stomp.StompWireFormat.unmarshal(StompWireFormat.java:92)\n\tat org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:226)\n\tat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:218)\n\tat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:201)\n\tat java.lang.Thread.run(Thread.java:595)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=remer","name":"remer","key":"remer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Rem","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-04T16:27:24.315+0000","updated":"2010-10-04T16:27:24.315+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12977751","id":"12977751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mjrehder","name":"mjrehder","key":"mjrehder","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Martin Rehder","active":true,"timeZone":"Etc/UTC"},"body":"It also exists in 5.4.1.\n\nThe exception is constantly printed in the console window where AMQ is started from.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mjrehder","name":"mjrehder","key":"mjrehder","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Martin Rehder","active":true,"timeZone":"Etc/UTC"},"created":"2011-01-05T12:10:46.512+0000","updated":"2011-01-05T12:10:46.512+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/12997527","id":"12997527","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tpurcell%40chariotsolutions.com","name":"tpurcell@chariotsolutions.com","key":"tpurcell@chariotsolutions.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tom Purcell","active":true,"timeZone":"Etc/UTC"},"body":"We have been in production with a ruby on rails app using Stomp to put messages in queues in AMQ 5.3.0 for 6 months. We never saw these messages. We are now in the process of testing an upgrade to AMQ 5.4.2 and we started to get the following:\n2011-02-21 13:13:23,464 | DEBUG | Transport failed: java.io.EOFException | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///172.20.10.127:43880\njava.io.EOFException\n        at java.io.DataInputStream.readByte(DataInputStream.java:250)\n        at org.apache.activemq.transport.stomp.StompWireFormat.readLine(StompWireFormat.java:146)\n        at org.apache.activemq.transport.stomp.StompWireFormat.parseAction(StompWireFormat.java:162)\n        at org.apache.activemq.transport.stomp.StompWireFormat.unmarshal(StompWireFormat.java:92)\n        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:227)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:219)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:202)\n        at java.lang.Thread.run(Thread.java:619)\n2011-02-21 13:13:23,470 | DEBUG | Stopping connection: /172.20.10.127:43880 | org.apache.activemq.broker.TransportConnection | ActiveMQ Task\n2011-02-21 13:13:23,470 | DEBUG | Stopping transport tcp:///172.20.10.127:43880 | org.apache.activemq.transport.tcp.TcpTransport | ActiveMQ Task\n2011-02-21 13:13:23,477 | DEBUG | Stopped transport: /172.20.10.127:43880 | org.apache.activemq.broker.TransportConnection | ActiveMQ Task\n\nThe only change in the environment is the AMQ upgrade.\n\nIn our testing we are pushing load and not seeing any lost messages. I have seen comments like this in various places (http://activemq.2283324.n4.nabble.com/Continuous-Transport-Failures-Moments-Before-STOMP-Connections-Close-tp2952079p2953913.html):\n\nthis log just indicate that connection is lost, it's no indication of\nan error. We recently raised the level of these messages to catch some\nother situations, so they now shows with the INFO level in standard\nlogs\n\nThis sounds reasonable but Can I really just ignore this? At any rate it looks like the issue still exists.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tpurcell%40chariotsolutions.com","name":"tpurcell@chariotsolutions.com","key":"tpurcell@chariotsolutions.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tom Purcell","active":true,"timeZone":"Etc/UTC"},"created":"2011-02-21T18:57:49.150+0000","updated":"2011-02-21T18:57:49.150+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483436/comment/13060067","id":"13060067","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This is in some ways related to AMQ-3393.  There is also the fact that Stomp 1.0 doesn't allow for a keep alive so sometimes connection drops aren't detected.  The processing logic for dropped connections has been improved quite a bit so the queued messages should be redelivered to another client if the dropped connection is detected.  \n\nReopen if the problem persists.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-07-05T18:41:54.882+0000","updated":"2011-07-05T18:41:54.882+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1376/votes","votes":8,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tu5z:"}}