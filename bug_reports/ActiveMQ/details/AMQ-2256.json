{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483701","self":"https://issues.apache.org/jira/rest/api/2/issue/12483701","key":"AMQ-2256","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315626","id":"12315626","description":"","name":"5.5.0","archived":false,"released":true,"releaseDate":"2011-04-01"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-08-06T09:04:27.065+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu May 07 13:18:30 UTC 2015","customfield_12310420":"14698","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_56053432965_*|*_6_*:*_1_*:*_22663420_*|*_5_*:*_1_*:*_0_*|*_4_*:*_1_*:*_2481671","customfield_12312321":null,"resolutiondate":"2011-02-26T22:53:45.956+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2256/watchers","watchCount":2,"isWatching":false},"created":"2009-05-18T21:30:47.916+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-07T13:18:30.629+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When executing TcpTransportFactory.createTransport(URI location, WireFormat wf) the following warning is incorrectly generated:\n\nWARNING: path isn't a valid local location for TcpTransport to use\njava.lang.NumberFormatException: For input string: \"/exampleTopic\"\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)\n\tat java.lang.Integer.parseInt(Integer.java:447)\n\tat java.lang.Integer.parseInt(Integer.java:497)\n\tat org.apache.activemq.transport.tcp.TcpTransportFactory.createTransport(TcpTransportFactory.java:125)\n\tat org.apache.activemq.transport.TransportFactory.doConnect(TransportFactory.java:141)\n\tat org.apache.activemq.transport.TransportFactory.doConnect(TransportFactory.java:51)\n\tat org.apache.activemq.transport.TransportFactory.connect(TransportFactory.java:80)\n\tat org.apache.activemq.ActiveMQConnectionFactory.createTransport(ActiveMQConnectionFactory.java:237)\n\tat org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:252)\n\tat org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:224)\n\tat org.apache.activemq.ActiveMQConnectionFactory.createConnection(ActiveMQConnectionFactory.java:172)\n...\n\nWith the topic name set to \"/exampleTopic\"\n\nThe code responsible for this looks like:\n\n        URI localLocation = null;\n        String path = location.getPath();\n        // see if the path is a local URI location\n        if (path != null && path.length() > 0) {\n            int localPortIndex = path.indexOf(':');\n            try {\n                Integer.parseInt(path.substring(localPortIndex + 1, path.length()));\n                String localString = location.getScheme() + \":/\" + path;\n                localLocation = new URI(localString);\n            } catch (Exception e) {\n                LOG.warn(\"path isn't a valid local location for TcpTransport to use\", e);\n            }\n        }\n        SocketFactory socketFactory = createSocketFactory();\n        return createTcpTransport(wf, socketFactory, location, localLocation);\n    }\n\n\nThe problem seems to be that for the path=\"/exampleTopic\", the following line:\n\n           int localPortIndex = path.indexOf(':');\n\nreturns -1 (no colon and no port specified in path\n\nand the subsequent line:\n\n             Integer.parseInt(path.substring(localPortIndex + 1, path.length()));\n  \ngenerates the NumberFormatException (because the path does not have any integer).\n\nIt seems that perhaps there should be some test like:\n\nif (localPortIndex != -1) {\n...\n}\n\nI will create a patch if desired.  Just LMK.\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59632","customfield_12312823":null,"summary":"Unnecessary TcpTransportFactory NumberFormatException and warning","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows XP","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/12940981","id":"12940981","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"body":"Is there any way to shut off the presentation of this NumberFormatException in 5.2.0.  Short of having it fixed, it would be very nice to at least prevent the spurious NumberFormatException and stack trace from appearing when using the tcp protocol in this manner","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-05T22:40:05.777+0000","updated":"2009-08-05T22:40:05.777+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/12940956","id":"12940956","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"could you attach a test case for this issue? Exactly what parameters are passed to the API?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-06T09:04:27.065+0000","updated":"2009-08-06T09:04:27.065+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/12940953","id":"12940953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"body":"The String path passed to the API  at org.apache.activemq.transport.tcp.TcpTransportFactory.createTransport(TcpTransportFactory.java:125)\n\nis \"/exampleTopic\".  The exact contents of the string doesn't matter.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-06T15:25:20.405+0000","updated":"2009-08-06T15:25:20.405+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/12999805","id":"12999805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Not enough information provided to construct a test case.  Can be reopened if a test case is provided so this can be validated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-02-26T15:54:40.863+0000","updated":"2011-02-26T15:54:40.863+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/12999851","id":"12999851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"body":"The test case is simply:\n\nnew ActiveMQConnectionFactory(\"tcp://localhost:61616/exampleTopic\").createConnection();\n\nThe connection is created successfully, bu the NumberFormatException is still being produced to standard error.\n\nAlthough originally reported on 5.2.0, the same problem exists on 5.3.2 as well (what I happen to be using now).\n\nAs stated in the bug, the problem is in TcpTransportFactory.createTransport.  Here is an annotated code fragment that shows the problem (modified slightly from TcpTransportFactory.createTransport)\n\nURI location = new URI(\"tcp://localhost:61616/exampleTopic\");\nString path = location.getPath();\n// path is \"/exampleTopic\"\nif (path != null && path.length() > 0) {\n  int localPortIndex = path.indexOf(':');\n// localPortIndex == -1 ...this is wrong, since //exampleTopic has no port in it\n  try {\n    Integer.parseInt(path.substring(localPortIndex + 1,path.length()));  \n// the previous line throws NumberFormatException because path.substring(0.path.length()) does not produce a number, because path is \"/exampleTopic\"\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sblewis","name":"sblewis","key":"sblewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Scott Lewis","active":true,"timeZone":"Etc/UTC"},"created":"2011-02-26T22:12:24.298+0000","updated":"2011-02-26T22:12:24.298+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/12999853","id":"12999853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Thanks, having your full URI made that much easier.  The code will suppress the full exception stack and just log a warning now unless debug logging is on.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-02-26T22:53:45.965+0000","updated":"2011-02-26T22:53:45.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/13506369","id":"13506369","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gangliu","name":"gangliu","key":"gangliu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liugang","active":true,"timeZone":"Asia/Shanghai"},"body":"sorry, But I found we still have some output which looks like:\n*[/50/data/fileIn] TcpTransportFactory            WARN  path isn't a valid local location for TcpTransport to use*\nI tested on activemq-5.7.0, it's a problem or not? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gangliu","name":"gangliu","key":"gangliu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liugang","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-11-29T10:01:44.497+0000","updated":"2012-11-29T10:01:44.497+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483701/comment/14532586","id":"14532586","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ghenry%40lswe.com","name":"ghenry@lswe.com","key":"ghenry@lswe.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Henry","active":true,"timeZone":"Europe/Berlin"},"body":"My two cents\nSame warning with amq 5.8. used with Apche Camel \nSolved by not adding a / at the end of the amq server url \ntcp://myhost:61616/  give a warning \ntcp://myhost:61616 don't !","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ghenry%40lswe.com","name":"ghenry@lswe.com","key":"ghenry@lswe.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Greg Henry","active":true,"timeZone":"Europe/Berlin"},"created":"2015-05-07T13:18:30.629+0000","updated":"2015-05-07T13:18:30.629+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2256/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0akqf:"}}