{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13207370","self":"https://issues.apache.org/jira/rest/api/2/issue/13207370","key":"AMQ-7126","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341032","id":"12341032","name":"5.16.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12344450","id":"12344450","name":"5.15.9","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2019-01-03T19:11:59.429+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jan 08 00:55:48 UTC 2019","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_75807662_*|*_3_*:*_1_*:*_24100_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2019-01-03T19:18:47.519+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-7126/watchers","watchCount":3,"isWatching":false},"created":"2019-01-02T22:14:55.787+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12344359","id":"12344359","description":"","name":"5.15.8","archived":false,"released":true,"releaseDate":"2018-11-19"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear","name":"jgoodyear","key":"jgoodyear","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107"},"displayName":"Jamie goodyear","active":true,"timeZone":"America/St_Johns"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2019-01-08T00:55:48.496+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We have some brokers that are having OOM issues (on reboot) after having accepted messages without OOM. We investigated the problem and diagnosed that this happens when we attempt to load a full page during recovery.\r\n\r\nIf we update KahaDBStore recoverNextMessage to use the following:\r\n\"if (counter >= maxReturned || !listener.hasSpace())\"\r\nTo check if we have enough space to load the next message, than our OOM is averted.\r\n\r\nAMQ-4495 had the above change that was backed out due to performance concerns, our testing does not show us a degradation - perhaps we could provide an optional parameter to use this code?","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12953670","id":"12953670","filename":"amq7126.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear","name":"jgoodyear","key":"jgoodyear","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107"},"displayName":"Jamie goodyear","active":true,"timeZone":"America/St_Johns"},"created":"2019-01-03T19:02:40.867+0000","size":4581,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12953670/amq7126.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12953540","id":"12953540","filename":"OOM.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joed","name":"joed","key":"joed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edstrom Johan","active":true,"timeZone":"America/Denver"},"created":"2019-01-02T22:33:47.957+0000","size":5757,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12953540/OOM.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Prevent OOM when recovering KahaDB and memory space is insufficient to load full page","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=heathkesler","name":"heathkesler","key":"heathkesler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Kesler","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=heathkesler","name":"heathkesler","key":"heathkesler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Kesler","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13207370/comment/16733396","id":"16733396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 2ed15d563c4e7c259deb0748e403030957a6dde3 in activemq's branch refs/heads/activemq-5.15.x from Jamie Mark Goodyear\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=2ed15d5 ]\n\n[AMQ-7126] Prevent OOM when recovering KahaDB and memory space is insufficient to load full page\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2019-01-03T19:11:59.429+0000","updated":"2019-01-03T19:11:59.429+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13207370/comment/16733404","id":"16733404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit b86c666c4058e2c4ef09e77409044732959eacb6 in activemq's branch refs/heads/master from Jamie Mark Goodyear\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=b86c666 ]\n\n[AMQ-7126] Prevent OOM when recovering KahaDB and memory space is insufficient to load full page. Thank you Heath Kesler and Johan Edstrom for investigation and patch.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2019-01-03T19:17:07.817+0000","updated":"2019-01-03T19:17:07.817+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13207370/comment/16733406","id":"16733406","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear","name":"jgoodyear","key":"jgoodyear","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107"},"displayName":"Jamie goodyear","active":true,"timeZone":"America/St_Johns"},"body":"Thank you [~heathkesler] and [~joed] for the investigation and patch supplied for this card.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear","name":"jgoodyear","key":"jgoodyear","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107"},"displayName":"Jamie goodyear","active":true,"timeZone":"America/St_Johns"},"created":"2019-01-03T19:18:10.146+0000","updated":"2019-01-03T19:18:10.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13207370/comment/16736533","id":"16736533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 9845853b6860619588e50b7a56a2f80af024d28e in activemq's branch refs/heads/activemq-5.15.x from Jamie Mark Goodyear\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=9845853 ]\n\n[AMQ-7126] Improvement to perf of 5266Test\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2019-01-08T00:51:35.448+0000","updated":"2019-01-08T00:51:35.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13207370/comment/16736534","id":"16736534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 4a21edc8d544474c477e2b38ac3f939f9873bfee in activemq's branch refs/heads/master from Jamie Mark Goodyear\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=4a21edc ]\n\n[AMQ-7126] Improvement to perf of 5266Test\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2019-01-08T00:52:48.310+0000","updated":"2019-01-08T00:52:48.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13207370/comment/16736542","id":"16736542","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear","name":"jgoodyear","key":"jgoodyear","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107"},"displayName":"Jamie goodyear","active":true,"timeZone":"America/St_Johns"},"body":"Performance did indeed appear to be an issue so submitted a change that does not affect performance","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgoodyear","name":"jgoodyear","key":"jgoodyear","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jgoodyear&avatarId=10107","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jgoodyear&avatarId=10107","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jgoodyear&avatarId=10107","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jgoodyear&avatarId=10107"},"displayName":"Jamie goodyear","active":true,"timeZone":"America/St_Johns"},"created":"2019-01-08T00:55:48.496+0000","updated":"2019-01-08T00:55:48.496+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-7126/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|u00gsg:"}}