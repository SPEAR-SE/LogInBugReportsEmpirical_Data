{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12667810","self":"https://issues.apache.org/jira/rest/api/2/issue/12667810","key":"AMQ-4717","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-09-10T15:08:01.491+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Sep 11 02:18:41 UTC 2013","customfield_12310420":"347746","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3249571_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-09-10T15:08:13.699+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4717/watchers","watchCount":2,"isWatching":false},"created":"2013-09-10T14:14:04.147+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["authentication"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318549","id":"12318549","name":"5.5.1","archived":false,"released":true,"releaseDate":"2011-10-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-09-11T02:18:41.291+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When setting the attribute populateJMSXUserID=\"true\" as documented [1] the broker should populate the JMS message with the JMSXUserID property.  However, this is not the case.  \n\nI have configured the broker to require authentication and sent a message to a Queue using the JMS producer shipped with the distribution.  The message is then inspected via JMX and the JMSXUserID property is not set.\n\n[1] http://activemq.apache.org/jmsxuserid.html","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"348045","customfield_12312823":null,"summary":"populateJMSXUserID is not setting the JMSXUserID property on the JMS message in JMX","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsherman1","name":"jsherman1","key":"jsherman1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jsherman1&avatarId=13244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jsherman1&avatarId=13244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jsherman1&avatarId=13244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jsherman1&avatarId=13244"},"displayName":"Jason Sherman","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsherman1","name":"jsherman1","key":"jsherman1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jsherman1&avatarId=13244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jsherman1&avatarId=13244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jsherman1&avatarId=13244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jsherman1&avatarId=13244"},"displayName":"Jason Sherman","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"OSX\njava version \"1.7.0_25\"","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12667810/comment/13763100","id":"13763100","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"The JMSXUserID was being set in the message but just not showing up when browsed via JMX.  I've applied fix so that JMSXUserID shows up in JMX too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2013-09-10T15:08:01.491+0000","updated":"2013-09-10T15:08:01.491+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12667810/comment/13763188","id":"13763188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsherman1","name":"jsherman1","key":"jsherman1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jsherman1&avatarId=13244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jsherman1&avatarId=13244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jsherman1&avatarId=13244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jsherman1&avatarId=13244"},"displayName":"Jason Sherman","active":true,"timeZone":"America/New_York"},"body":"After looking into this further it appears the JMSXUserID is added to the JMS message however:\n\n1) It is not visible when browsing the message via JMX\n\n2) The Message.propertyExists(String s) does not detect that the property is actually there.\n\nUsing message.getStringProperty(\"JMSXUserID\") will return the value if the property is set.\n\nThe following method was used to test this:\n\n        private void browse() throws Exception\n\t{\n\t\tActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory(user, password, url);\n        Connection connection = connectionFactory.createConnection();\n\t\tconnection.start();\n\t\t\n\t\tSession session = connection.createSession(transacted, ackMode);\n\n        Queue queue = session.createQueue(subject);\n\n\t\tQueueBrowser queueBrowser = session.createBrowser(queue);\n        Enumeration enumeration = queueBrowser.getEnumeration();\n        int received = 0;\n        while (enumeration.hasMoreElements()) {\n            Message message = (Message) enumeration.nextElement();\n\n            System.out.println(\"Browsing message \" + received+\": \"+message.getJMSMessageID());\n\n            Enumeration propertyEnum = message.getPropertyNames();\n            while(propertyEnum.hasMoreElements())\n            {\n                  System.out.println(\"Found: [\" + propertyEnum.nextElement() + \"]\");\n            }\n\n            System.out.println(\"JMSXUserID: \" + message.getStringProperty(\"JMSXUserID\"));\n\n            if(message.propertyExists(\"JMSXUserID\")){\n\t\t\t\tSystem.out.println(\"JMSXUserID Exists\");\n\t\t\t}\n\t\t\telse{\n\t\t\t\tSystem.out.println(\"JMSXUserID Not Found!\");\n            }\n\n\t    }\n      }\n\nWhich prints:\n\nBrowsing message 0: ID:fusepro.home-63724-1378830280448-1:1:1:1:1\nFound: [JMSXUserID]\nJMSXUserID: admin\nJMSXUserID Not Found!\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsherman1","name":"jsherman1","key":"jsherman1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jsherman1&avatarId=13244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jsherman1&avatarId=13244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jsherman1&avatarId=13244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jsherman1&avatarId=13244"},"displayName":"Jason Sherman","active":true,"timeZone":"America/New_York"},"created":"2013-09-10T16:42:58.708+0000","updated":"2013-09-10T16:42:58.708+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12667810/comment/13763869","id":"13763869","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsherman1","name":"jsherman1","key":"jsherman1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jsherman1&avatarId=13244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jsherman1&avatarId=13244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jsherman1&avatarId=13244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jsherman1&avatarId=13244"},"displayName":"Jason Sherman","active":true,"timeZone":"America/New_York"},"body":"I have tested this against the latest 5.9 SNAPSHOT and see the propertyExists method is now working as designed:\n\nBrowsing message 0: ID:fusepro.home-51015-1378865317020-1:1:1:1:1\nFound: [JMSXUserID]\nJMSXUserID Exists\nJMSXUserID: admin\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsherman1","name":"jsherman1","key":"jsherman1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jsherman1&avatarId=13244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jsherman1&avatarId=13244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jsherman1&avatarId=13244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jsherman1&avatarId=13244"},"displayName":"Jason Sherman","active":true,"timeZone":"America/New_York"},"created":"2013-09-11T02:18:41.291+0000","updated":"2013-09-11T02:18:41.291+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4717/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1nypb:"}}