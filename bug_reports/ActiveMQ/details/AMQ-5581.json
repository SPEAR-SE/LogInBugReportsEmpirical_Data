{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12774391","self":"https://issues.apache.org/jira/rest/api/2/issue/12774391","key":"AMQ-5581","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-02-16T18:51:53.044+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Feb 16 18:51:53 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5581/watchers","watchCount":2,"isWatching":false},"created":"2015-02-12T00:00:39.698+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324950","id":"12324950","name":"5.10.0","archived":false,"released":true,"releaseDate":"2014-06-10"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-02-16T18:51:53.044+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We had a cloud instance reboot over the weekend. When it came back up it had a different IP address. The master seems like it had given up trying to reconnect and the slaves were stuck repeating \"failed to acquire lease.  Sleeping for 10000 milli(s) before trying again...\".\n\nAt the very least if the master is going to stop retrying it seems like at some point the slaves should try a full reconnect instead of just repeating the same message for days on end.\n\nLet me know what other info you need?\n\nConfig snippets below.\n\n{code:xml}\n        <persistenceAdapter>\n            <jdbcPersistenceAdapter dataSource=\"#postgres-ds\" lockKeepAlivePeriod=\"5000\">\n              <locker>\n                <lease-database-locker lockAcquireSleepInterval=\"10000\"/>\n              </locker>\n            </jdbcPersistenceAdapter>\n        </persistenceAdapter>\n\n    <bean id=\"postgres-ds\" class=\"org.postgresql.ds.PGPoolingDataSource\">\n        <property name=\"serverName\" value=\"{{ salt['mine.get']('G@tags:mqdb and G@tags:primary', 'network.get_hostname', 'compound')|first }}\" />\n        <property name=\"databaseName\" value=\"mqdb\" />\n        <property name=\"portNumber\" value=\"5432\" />\n        <property name=\"user\" value=\"mqdb\" />\n        <property name=\"password\" value=\"{{ salt['pillar.get']('postgres:users:mqdb:password', 'password') }}\" />\n        <property name=\"dataSourceName\" value=\"postgres\" />\n        <property name=\"initialConnections\" value=\"1\" />\n        <property name=\"maxConnections\" value=\"30\" />\n    </bean>\n{code}\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Failover with jdbcPersistenceAdapter/PGPoolingDataSource doesn't fail over properly when DB server changes IP","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iggy","name":"iggy","key":"iggy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Jackson","active":true,"timeZone":"America/Chicago"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iggy","name":"iggy","key":"iggy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Jackson","active":true,"timeZone":"America/Chicago"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux, 1 master, 2 slaves, PostgreSQL persistence layer","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12774391/comment/14323140","id":"14323140","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.davis%40oncenter.com","name":"brandon.davis@oncenter.com","key":"brandon.davis@oncenter.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brandon Davis","active":true,"timeZone":"Etc/UTC"},"body":"We are having the same problem. The database that we were using for persistence failed over, but out message queues remained unavailable until we restarted the ActiveMQ service.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.davis%40oncenter.com","name":"brandon.davis@oncenter.com","key":"brandon.davis@oncenter.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brandon Davis","active":true,"timeZone":"Etc/UTC"},"created":"2015-02-16T18:51:53.044+0000","updated":"2015-02-16T18:51:53.044+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5581/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i25iif:"}}