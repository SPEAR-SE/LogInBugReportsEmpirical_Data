{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12481802","self":"https://issues.apache.org/jira/rest/api/2/issue/12481802","key":"AMQ-1188","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-03-06T11:47:50.589+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Mar 06 11:47:50 UTC 2007","customfield_12310420":"84468","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_42560463_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2007-03-06T11:47:50.642+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1188/watchers","watchCount":0,"isWatching":false},"created":"2007-03-05T23:58:30.179+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315613","id":"12315613","description":"","name":"4.1.0","archived":false,"released":true,"releaseDate":"2006-11-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-03-06T11:47:50.617+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"On a machine where the hostname contains underscores (e.g. HS_RH64_A3_1) ActiveMQ fails to initialize with the stack trace below. This seems to be a problem with the TCP protocol handler since doing new URL(\"http://HS_RH64_A3_1.godzilla.local:61616\") works fine.\n\n2007-03-05 08:30:20,076 [WrapperSimpleAppMain] ERROR (BrokerService.java:412) - Failed to start ActiveMQ JMS Message Broker. Reason: java.io.IOException: Transp\nort Connector could not be registered in JMX: Illegal character in hostname at index 8: tcp://HS_RH64_A3_1.godzilla.local:61616\njava.io.IOException: Transport Connector could not be registered in JMX: Illegal character in hostname at index 8: tcp://HS_RH64_A3_1.godzilla.local:61616\n        at org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:25)\n        at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:1079)\n        at org.apache.activemq.broker.BrokerService.startTransportConnector(BrokerService.java:1508)\n        at org.apache.activemq.broker.BrokerService.startAllConnectors(BrokerService.java:1468)\n        at org.apache.activemq.broker.BrokerService.start(BrokerService.java:402)\n        at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:47)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1062)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1029)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:420)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:245)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:141)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:242)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:156)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:290)\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:348)\n        at org.apache.xbean.spring.context.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:161)\n        at org.apache.xbean.spring.context.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:51)\n        at org.apache.activemq.xbean.XBeanBrokerFactory.createBroker(XBeanBrokerFactory.java:41)\n        at org.apache.activemq.broker.BrokerFactory.createBroker(BrokerFactory.java:57)\n        at org.apache.activemq.console.command.StartCommand.startBroker(StartCommand.java:82)\n        at org.apache.activemq.console.command.StartCommand.runTask(StartCommand.java:47)\n        at org.apache.activemq.console.command.AbstractCommand.execute(AbstractCommand.java:50)\n        at org.apache.activemq.console.command.ShellCommand.runTask(ShellCommand.java:82)\n        at org.apache.activemq.console.command.AbstractCommand.execute(AbstractCommand.java:50)\n        at org.apache.activemq.console.command.ShellCommand.main(ShellCommand.java:46)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at org.apache.activemq.console.Main.runTaskClass(Main.java:159)\n        at org.apache.activemq.console.Main.main(Main.java:91)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at org.tanukisoftware.wrapper.WrapperSimpleApp.run(WrapperSimpleApp.java:197)\n        at java.lang.Thread.run(Thread.java:595)\nCaused by: java.io.IOException: Illegal character in hostname at index 8: tcp://HS_RH64_A3_1.godzilla.local:61616\n        at org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:43)\n        at org.apache.activemq.transport.tcp.TcpTransportServer.bind(TcpTransportServer.java:94)\n        at org.apache.activemq.transport.tcp.TcpTransportFactory.doBind(TcpTransportFactory.java:56)\n        at org.apache.activemq.transport.TransportFactory.bind(TransportFactory.java:109)\n        at org.apache.activemq.broker.TransportConnector.createTransportServer(TransportConnector.java:270)\n        at org.apache.activemq.broker.TransportConnector.getServer(TransportConnector.java:122)\n        at org.apache.activemq.broker.TransportConnector.asManagedConnector(TransportConnector.java:100)\n        at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:1072)\n        ... 35 more\nCaused by: java.net.URISyntaxException: Illegal character in hostname at index 8: tcp://HS_RH64_A3_1.godzilla.local:61616\n        at java.net.URI$Parser.fail(URI.java:2816)\n        at java.net.URI$Parser.parseHostname(URI.java:3355)\n        at java.net.URI$Parser.parseServer(URI.java:3204)\n        at java.net.URI$Parser.parseAuthority(URI.java:3123)\n        at java.net.URI$Parser.parseHierarchical(URI.java:3065)\n        at java.net.URI$Parser.parse(URI.java:3021)\n        at java.net.URI.<init>(URI.java:663)\n        at org.apache.activemq.transport.tcp.TcpTransportServer.bind(TcpTransportServer.java:91)\n        ... 41 more\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"254974","customfield_12312823":null,"summary":"Illegal character in hostname error on hosts with underscores in their host names","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ygrignon","name":"ygrignon","key":"ygrignon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanik Grignon","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ygrignon","name":"ygrignon","key":"ygrignon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanik Grignon","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"RHEL4 Update 4 ES x86_64\nSun JDK 1.4.2_08","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481802/comment/12938806","id":"12938806","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ygrignon","name":"ygrignon","key":"ygrignon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanik Grignon","active":true,"timeZone":"Etc/UTC"},"body":"I reproduce the same crash using new URI() in a test program. Looking at the RFC an underscore is in fact an invalid character in a host name. However, Linux lets you name a machine with underscores in the host name, so whether or not ActiveMQ should gracefully handle this case is still a relevant question. Also, the config file used to generate this issue was using localhost not the host name but the connector initialization code would still resolve it to the fully qualified host name of the machine resulting in the stack trace above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ygrignon","name":"ygrignon","key":"ygrignon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yanik Grignon","active":true,"timeZone":"Etc/UTC"},"created":"2007-03-06T00:23:35.595+0000","updated":"2007-03-06T00:23:35.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481802/comment/12938750","id":"12938750","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"body":"FWIW a workaround is probably to use the IP address in the config file (its only when using the localhost that we try and resolve it).\n\nI've added a fix to trunk to work around this where if the URI is invalid we try to use the IP address in the URI instead. Let us know if that doesn't fix it and we can reopen this issue","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"created":"2007-03-06T11:47:50.589+0000","updated":"2007-03-06T11:47:50.589+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1188/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i18127:"}}