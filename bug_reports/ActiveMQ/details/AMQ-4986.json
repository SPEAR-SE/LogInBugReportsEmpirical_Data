{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12690250","self":"https://issues.apache.org/jira/rest/api/2/issue/12690250","key":"AMQ-4986","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2014-01-22T14:41:52.978+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Apr 21 19:34:59 UTC 2016","customfield_12310420":"369204","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_70876825888_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-04-21T19:34:59.610+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4986/watchers","watchCount":5,"isWatching":false},"created":"2014-01-22T11:34:33.838+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-04-21T19:34:59.721+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We experience this problem in combination with 5.5.1 client and the wireformat.tightEncodingEnabled=false+ failover:\n\nScenario:\n1. start standard broker\n2. start Client (with e.g. a MessageListener) with failover protocol: e.g. failover:(tcp://123.123.123.123:61616?wireformat.tightEncodingEnabled=false)\n3. wait around 30sec (default for inactivity check)\n\nResult:\nThe client closes the connection and re-tries to the broker which in turn throws the following exception:\n\n{code}\n2014-01-21 20:12:49,568 [ActiveMQ Transport: tcp:///123.123.123.123:60156@61616] DEBUG Transport  Transport Connection to: tcp://124.124.124.124:60156 failed: java.io.IOException: Unexpected error occured: java.lang.OutOfMemoryError: Java heap space\njava.io.IOException: Unexpected error occured: java.lang.OutOfMemoryError: Java heap space\n\tat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:203)\n\tat java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.OutOfMemoryError: Java heap space\n\tat org.apache.activemq.openwire.v8.BaseDataStreamMarshaller.looseUnmarshalByteSequence(BaseDataStreamMarshaller.java:638)\n\tat org.apache.activemq.openwire.v8.WireFormatInfoMarshaller.looseUnmarshal(WireFormatInfoMarshaller.java:132)\n\tat org.apache.activemq.openwire.OpenWireFormat.doUnmarshal(OpenWireFormat.java:373)\n\tat org.apache.activemq.openwire.OpenWireFormat.unmarshal(OpenWireFormat.java:285)\n\tat org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:221)\n\tat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:213)\n\tat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:196)\n\t... 1 more\n{code}\n\n\nThe problem here is that the BaseDataStreamMarshaller reads an int from the buffer and re-uses it immediately to allocate a byte array:\n{code}\nprotected byte[] looseUnmarshalByteArray(DataInput dataIn) throws IOException {\n        byte rc[] = null;\n        if (dataIn.readBoolean()) {\n            int size = dataIn.readInt();\n            rc = new byte[size];   // PROBLEM! What happens if size has been read and interpreted wrongly ? \n            dataIn.readFully(rc);\n        }\n        return rc;\n    }\n{code}\nIn our case the dadaIn.readInt() read an int number of 785.477.224 which triggers the broker to allocate blindly this amount of mem.\n\nWe do not know yet what triggers the wrong byte sequence from the client, but on the brokers side, there should be a protection against this case.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"369509","customfield_12312823":null,"summary":"tightEncoding=false + failover triggers Broker memory exhaust","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=felixehm","name":"felixehm","key":"felixehm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Felix Ehm","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=felixehm","name":"felixehm","key":"felixehm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Felix Ehm","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"java 1.7\nClient library 5.5.1\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/13878708","id":"13878708","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Are you mixing old versions of clients with newer broker versions ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-01-22T14:41:52.978+0000","updated":"2014-01-22T14:41:52.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/13878723","id":"13878723","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=felixehm","name":"felixehm","key":"felixehm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Felix Ehm","active":true,"timeZone":"Etc/UTC"},"body":"Yes. We have a very large environment with > 200 applications where we are not in the situation to be able to update client and broker setups always together (all openwire).\n\nAccording to Hiram this mixing should be ok and from my understanding the openwire protocol should at least make sure the communication is fine. But exactly here is the point where it breaks.\nAs  I wrote, we're still trying to find out why the broker reads something buggy from the wire from the client.\n\nDid I mention that the client and broker come into a CON/DISCON loop ? The client-side failover receives a invalid magic back and closes the connection, and reconnects, and so on ....\n\n\nThe workaround of course is to remove this option, which I strongly consider. Independently from this, the presented code should be looked at to prevent this allocation. What do you think?\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=felixehm","name":"felixehm","key":"felixehm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Felix Ehm","active":true,"timeZone":"Etc/UTC"},"created":"2014-01-22T14:53:26.737+0000","updated":"2014-01-22T14:53:26.737+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/14223128","id":"14223128","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mike3d3","name":"mike3d3","key":"mike3d3","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dillon","active":true,"timeZone":"Etc/UTC"},"body":"We are having similar issues as described above.  The clients are running the 5.10 library and the broker is also 5.10.  We see the client subscriber reconnecting every 30 seconds.  The difference is that we have the default setting for tightEncodingEnabled=true.  As a test we set this to false on our client and the reconnecting issue went away.  Our concern now is that we will experience the OutOfMemory issue as described above.  It would be great if we could get some guidance on this issue.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mike3d3","name":"mike3d3","key":"mike3d3","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dillon","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-24T16:55:04.948+0000","updated":"2014-11-24T16:55:04.948+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/14223146","id":"14223146","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=felixehm","name":"felixehm","key":"felixehm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Felix Ehm","active":true,"timeZone":"Etc/UTC"},"body":"In case this is of interest for you: I have removed this option from the URL and was able to upgrade slowly the brokers. \nI haven't really found a solution for this problem. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=felixehm","name":"felixehm","key":"felixehm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Felix Ehm","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-24T17:11:56.131+0000","updated":"2014-11-24T17:11:56.131+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/14260850","id":"14260850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=siddeshwar_hiremath","name":"siddeshwar_hiremath","key":"siddeshwar_hiremath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"siddeshwar_hiremath","active":true,"timeZone":"Etc/UTC"},"body":"Broker version 5.10.0\nClient version 5.10.0\n\nactivemq.xml:- \n <transportConnector  uri=\"nio://localhost:61616?keepAlive=true&amp;wireFormat.maxFrameSize=104857600\"/> \n\nClient broker url:- \n failover:(nio:// 127.0.0.1:61616?keepAlive=true&wireFormat.maxFrameSize=104857600)?jms.blobTransferPolicy.defaultUploadUrl=http://127.0.0.1:8161/fileserver/&initialReconnectDelay=10000&useExponentialBackOff=false&randomize=false\n\nI have the above setting and experiencing following error:-\nnio protocol:-\n---------------\n2014-12-29 11:52:43,145 | DEBUG | Sending: WireFormatInfo { version=10, properties={MaxFrameSize=9223372036854775807, CacheSize=1024, CacheEnabled=true, SizePrefixDisabled=false, MaxInactivityDurationInitalDelay=10000, TcpNoDelayEnabled=true, MaxInactivityDuration=30000, TightEncodingEnabled=true, StackTraceEnabled=true}, magic=[A,c,t,i,v,e,M,Q]} | org.apache.activemq.transport.WireFormatNegotiator | ActiveMQ BrokerService[localhost] Task-4\n2014-12-29 11:52:43,591 | DEBUG | Transport Connection to: tcp://127.0.0.1:51048 failed: java.io.IOException: Java heap space | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ NIO Worker 5\njava.io.IOException: Java heap space\n        at org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:39)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.nio.NIOTransport.serviceRead(NIOTransport.java:151)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.nio.NIOTransport$1.onSelect(NIOTransport.java:69)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.nio.SelectorSelection.onSelect(SelectorSelection.java:94)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.nio.SelectorWorker$1.run(SelectorWorker.java:119)[activemq-client-5.10.0.jar:5.10.0]\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)[:1.7.0_40]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)[:1.7.0_40]\n        at java.lang.Thread.run(Thread.java:724)[:1.7.0_40]\n2014-12-29 11:52:43,592 | DEBUG | Unregistering MBean org.apache.activemq:type=Broker,brokerName=localhost,connector=clientConnectors,connectorName=nio_//localhost_61616&qe;transport.keepAlive&amp;true&transport.wireFormat.maxFrameSize&amp;104857600,connectionViewType=remoteAddress,connectionName=tcp_//127.0.0.1_51048 | org.apache.activemq.broker.jmx.ManagementContext | ActiveMQ NIO Worker 5\n2014-12-29 11:52:43,605 | DEBUG | Stopping connection: tcp://127.0.0.1:51048 | org.apache.activemq.broker.TransportConnection | ActiveMQ BrokerService[localhost] Task-5\n2014-12-29 11:52:43,609 | DEBUG | Stopping transport tcp:///127.0.0.1:51048@61616 | org.apache.activemq.transport.tcp.TcpTransport | ActiveMQ BrokerService[localhost] Task-5\n2014-12-29 11:52:43,609 | DEBUG | Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: null | org.apache.activemq.thread.TaskRunnerFactory | ActiveMQ BrokerService[localhost] Task-5\n2014-12-29 11:52:43,614 | DEBUG | Closed socket Socket[unconnected] | org.apache.activemq.transport.tcp.TcpTransport | ActiveMQ Task-1\n2014-12-29 11:52:43,614 | DEBUG | Stopped transport: null | org.apache.activemq.broker.TransportConnection | ActiveMQ BrokerService[localhost] Task-5\n2014-12-29 11:52:43,614 | DEBUG | Connection Stopped: null | org.apache.activemq.broker.TransportConnection | ActiveMQ BrokerService[localhost] Task-5\n\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nWith tcp protocol:-\n---------------------\nityDurationInitalDelay=10000, TcpNoDelayEnabled=true, MaxInactivityDuration=30000, TightEncodingEnabled=true, StackTraceEnabled=true}, magic=[A,c,t,i,v,e,M,Q]} | org.apache.activemq.transport.WireFormatNegotiator | ActiveMQ BrokerService[localhost] Task-8\n2014-12-29 11:22:42,797 | DEBUG | Transport Connection to: tcp://127.0.0.1:39382 failed: java.io.IOException: Unknown data type: 13 | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///127.0.0.1:39382@61616\njava.io.IOException: Unknown data type: 13\n        at org.apache.activemq.openwire.OpenWireFormat.looseUnmarshalNestedObject(OpenWireFormat.java:460)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.openwire.v10.BaseDataStreamMarshaller.looseUnmarsalNestedObject(BaseDataStreamMarshaller.java:466)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.openwire.v10.DataResponseMarshaller.looseUnmarshal(DataResponseMarshaller.java:113)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.openwire.OpenWireFormat.doUnmarshal(OpenWireFormat.java:356)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.openwire.OpenWireFormat.unmarshal(OpenWireFormat.java:268)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:221)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:213)[activemq-client-5.10.0.jar:5.10.0]\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:196)[activemq-client-5.10.0.jar:5.10.0]\n        at java.lang.Thread.run(Thread.java:724)[:1.7.0_40]\n2014-12-29 11:22:42,799 | DEBUG | Unregistering MBean org.apache.activemq:type=Broker,brokerName=localhost,connector=clientConnectors,connectorName=tcp_//localhost_61616&qe;transport.keepAlive&amp;true&transport.wireFormat.maxFrameSize&amp;104857600,connectionViewType=remoteAddress,connectionName=tcp_//127.0.0.1_39382 | org.apache.activemq.broker.jmx.ManagementContext | ActiveMQ Transport: tcp:///127.0.0.1:39382@61616\n2014-12-29 11:22:42,804 | DEBUG | Stopping connection: tcp://127.0.0.1:39382 | org.apache.activemq.broker.TransportConnection | ActiveMQ BrokerService[localhost] Task-9\n2014-12-29 11:22:42,805 | DEBUG | Stopping transport tcp:///127.0.0.1:39382@61616 | org.apache.activemq.transport.tcp.TcpTransport | ActiveMQ BrokerService[localhost] Task-9\n2014-12-29 11:22:42,805 | DEBUG | Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: null | org.apache.activemq.thread.TaskRunnerFactory | ActiveMQ BrokerService[localhost] Task-9\n2014-12-29 11:22:42,807 | DEBUG | Closed socket Socket[addr=/127.0.0.1,port=39382,localport=61616] | org.apache.activemq.transport.tcp.TcpTransport | ActiveMQ Task-1\n2014-12-29 11:22:42,808 | DEBUG | Stopped transport: tcp://127.0.0.1:39382 | org.apache.activemq.broker.TransportConnection | ActiveMQ BrokerService[localhost] Task-9\n2014-12-29 11:22:42,809 | DEBUG | Connection Stopped: tcp://127.0.0.1:39382 | org.apache.activemq.broker.TransportConnection | ActiveMQ BrokerService[localhost] Task-9","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=siddeshwar_hiremath","name":"siddeshwar_hiremath","key":"siddeshwar_hiremath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"siddeshwar_hiremath","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-30T06:27:01.253+0000","updated":"2014-12-30T06:30:33.410+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/15241176","id":"15241176","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"body":"Btw I can see that you are victim of a different bug AMQ-6248. \nIn the original description there is log message:\n{{ActiveMQ Transport: tcp:///*123.123.123.123*:60156@61616] DEBUG Transport  Transport Connection to: tcp://*124.124.124.124*:60156 failed}}\nNotice that failure from one transport actually causes failure of another transport. This is exactly what AMQ-6248 is about.\nThe problem with memory can be related or can be completely orthogonal...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-14T13:45:08.930+0000","updated":"2016-04-14T13:45:08.930+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12690250/comment/15252519","id":"15252519","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Would need some tests that can demonstrate that there is an issue.  One recent fix in AMQ-6248 adds some additional stability to failover bits.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2016-04-21T19:34:59.683+0000","updated":"2016-04-21T19:34:59.683+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4986/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1rmvr:"}}