{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12640319","self":"https://issues.apache.org/jira/rest/api/2/issue/12640319","key":"AMQ-4428","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-04-03T21:12:13.907+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue May 07 10:53:35 UTC 2013","customfield_12310420":"320782","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3009380023_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-05-07T10:53:35.917+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4428/watchers","watchCount":3,"isWatching":false},"created":"2013-04-02T14:57:15.935+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-07T10:53:35.940+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"`setProperty` currently ends with `… catch (Throwable ignore) \\{ return false; \\}`. This can make troubleshooting invalid configuration much harder since the exception (that contains detailed information) is hidden from the user.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10042","value":"Patch Available","id":"10042"}],"customfield_12310921":null,"customfield_12310920":"321123","customfield_12312823":null,"summary":"Don't swallow errors in IntrospectionSupport.setProperty","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qerub","name":"qerub","key":"qerub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christoffer Sawicki","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qerub","name":"qerub","key":"qerub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christoffer Sawicki","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640319/comment/13621328","id":"13621328","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"I recall there are a few places where url params are applied to a bunch of components in a chain, the ones that match are removed and there is an assertion that all are consumed. So in that case, some are expected to be invalid. In that case, using info in place of error may be better.\n\nA sanity check woud be to run the unit tests in activemq-unit-tests module (mvn test) and peek at the resulting target/activemq-test.log to see how often the error shows up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-03T21:12:13.907+0000","updated":"2013-04-03T21:12:13.907+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640319/comment/13621998","id":"13621998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qerub","name":"qerub","key":"qerub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christoffer Sawicki","active":true,"timeZone":"Europe/Berlin"},"body":"(I've found that a couple of those assertions are missing, but I've filed another issue for that (AMQ-4433). I believe there is a problem even assuming all assertions are in place.)\n\nIn the context of setProperty, properties/parameters can be invalid in two ways:\n\n1. The property is missing on the target object. This situation happens a lot during normal initialization and works fine as is.\n\n2. The property does exist but calling the setter throws an exception. This is the situation I believe is exceptional and should be logged. With working assertions the property/parameter will be flagged as invalid, but the exception—which contains information about why the property value is invalid—is hidden from the user, making troubleshooting harder.\n\nFor reference: https://github.com/apache/activemq/blob/trunk/activemq-client/src/main/java/org/apache/activemq/util/IntrospectionSupport.java#L160\n\nI'll do some more research with the unit tests and get back to you.\n\nThanks for your time!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qerub","name":"qerub","key":"qerub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christoffer Sawicki","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-04T10:23:15.967+0000","updated":"2013-04-04T10:23:15.967+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640319/comment/13649649","id":"13649649","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ebudan","name":"ebudan","key":"ebudan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik Bunn","active":true,"timeZone":"Etc/UTC"},"body":"An example of where this swallowed Throwable produced considerable headache.\n\nAn embedded Broker's timeout options were not being set as expected. The first suspect was documentation wiki/code mismatch (FailoverTransport backoffMultiplier vs. reconnectDelayExponent), but this wasn't the real culprit: IntrospectionSupport has a static init of a third-party library, which had been missed by us while minimizing libraries for the embed. The IntrospectionSupport.setProperty() catch silently swallows the informative exception.\n\nI would second #2, above. \nFurther, I would suggest catching qualified exceptions rather than Throwable, which risks silencing possible fatal errors (OOM). \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ebudan","name":"ebudan","key":"ebudan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik Bunn","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-06T11:03:49.036+0000","updated":"2013-05-06T11:03:49.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640319/comment/13650069","id":"13650069","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qerub","name":"qerub","key":"qerub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christoffer Sawicki","active":true,"timeZone":"Europe/Berlin"},"body":"> Further, I would suggest catching qualified exceptions rather than Throwable [...]\n\nI agree. Here's a {{s/Throwable/Exception/}} patch:\nhttps://github.com/qerub/activemq/commit/0e09f1649a4cecb38476262a61f51acf578f64e3.patch\n\nAnd here's an updated version of the original patch:\nhttps://github.com/qerub/activemq/commit/2442b3311e7f069b93a619dd3a8821571d1d67b6.patch\n\n(Remove .patch from URL for a prettier view.)\n\nI have run the full ActiveMQ test suite with these changes and they generate no spurious log messages.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qerub","name":"qerub","key":"qerub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christoffer Sawicki","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-06T20:18:40.010+0000","updated":"2013-05-06T20:18:40.010+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640319/comment/13650708","id":"13650708","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"patch applied with thanks in http://svn.apache.org/r1479852","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-07T10:53:35.938+0000","updated":"2013-05-07T10:53:35.938+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4428/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1jcj3:"}}