{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12636075","self":"https://issues.apache.org/jira/rest/api/2/issue/12636075","key":"AMQ-4366","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-03-08T17:10:44.322+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 23 15:48:17 UTC 2017","customfield_12310420":"316567","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_11337401_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-03-08T20:07:11.703+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4366/watchers","watchCount":9,"isWatching":false},"created":"2013-03-08T16:58:14.340+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-02-23T15:48:17.083+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319603","id":"12319603","name":"activemq-pool","description":"The ActiveMQ Connection Pool"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"{{PooledConnectionFactory}} closes connections that are still referenced and should not be closed. Happens only when connection idle or expire time passes. Calling {{createConnection}} after that time will invalidate the connection and all previously obtained {{Sessions}} will behave as closed.\n\nDue to default 30 second idle timeout, it is likely not to cause problems when:\n* connection is continually in use\n* all {{PooledConnection}} s are borrowed at startup\n\nClient with session whose connection was prematurely closed will see similar stacktrace:\n{noformat}\njavax.jms.IllegalStateException: The Session is closed\n                at org.apache.activemq.ActiveMQSession.checkClosed(ActiveMQSession.java:731)\n                at org.apache.activemq.ActiveMQSession.configureMessage(ActiveMQSession.java:719)\n                at org.apache.activemq.ActiveMQSession.createBytesMessage(ActiveMQSession.java:316)\n                at org.apache.activemq.pool.PooledSession.createBytesMessage(PooledSession.java:168)\n{noformat}\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12572783","id":"12572783","filename":"poolConClose.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-08T17:07:52.445+0000","size":3126,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12572783/poolConClose.diff"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"316909","customfield_12312823":null,"summary":"PooledConnectionFactory closes connections that are in use","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13597294","id":"13597294","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"body":"Patch against 5.7.0 tag with testcase that reproduces the issue and poor fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pjanata","name":"pjanata","key":"pjanata","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Petr Janata","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-08T17:07:52.448+0000","updated":"2013-03-08T17:12:52.454+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13597298","id":"13597298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Thanks, I'll take a look.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-03-08T17:10:44.322+0000","updated":"2013-03-08T17:10:44.322+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13597425","id":"13597425","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Looking at the code a bit I think part of the problem here is that Idle timeout seems to be considered even when there are references to the ConnectionPool which would go against the stated purpose of IdleTimeout which is to close out Connection's that have sat unused.  If a reference is active then the ConnectionPool shouldn't be considered inactive since some Session is open and could be in use.  Only expiry timeout should be considered regardless of reference count if I understand that setting correctly, the doco is a bit vague. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-03-08T19:22:35.448+0000","updated":"2013-03-08T19:22:35.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13597496","id":"13597496","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Should be fixed now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-03-08T20:07:11.728+0000","updated":"2013-03-08T20:07:11.728+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13619630","id":"13619630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tmielke","name":"tmielke","key":"tmielke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Torsten Mielke","active":true,"timeZone":"Europe/Berlin"},"body":"A proper workaround for any 5.7 and 5.8 versioned clients seems to be to disable the session idle timeout on the ConnectionFactory using PooledConnectionFactory.setIdleTimeout(0).\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tmielke","name":"tmielke","key":"tmielke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Torsten Mielke","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-02T08:47:05.594+0000","updated":"2013-04-02T08:47:05.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13621564","id":"13621564","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boday","name":"boday","key":"boday","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boday&avatarId=17138","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boday&avatarId=17138","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boday&avatarId=17138","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boday&avatarId=17138"},"displayName":"Ben O'Day","active":true,"timeZone":"America/Los_Angeles"},"body":"alright, can I assume that when this occurs the message is being rolled back/replayed rather than being lost (assuming AUTO_ACK, non-tx mode)?\n\nany other side-effects of the proposed workaround of setting the idelTimeout to 0 (inefficient connection/session mgmt, etc)?\n\nany plans to backport it to a minor release of 5.7 or 5.8?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boday","name":"boday","key":"boday","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boday&avatarId=17138","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boday&avatarId=17138","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boday&avatarId=17138","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boday&avatarId=17138"},"displayName":"Ben O'Day","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-04T00:14:40.556+0000","updated":"2013-04-04T00:20:59.838+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/13626330","id":"13626330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tmielke","name":"tmielke","key":"tmielke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Torsten Mielke","active":true,"timeZone":"Europe/Berlin"},"body":"I am not aware of any side effects when applying the workaround and setting idleTimeout=0. \nAs a consequence sessions won't be invalidated just because they were idle for a specific period of time. But that should generally not be a problem. \nI had a customer testing this idleTimeout=0 in their integration test env and it did not cause any problems. \n\nAlso, its my understanding that you generally should not loose any messages due to the \"The Session is closed\" error. \nTypically the session is checked for validity right *before* sending the message. You app code of course needs to handle the error and should not assume that the msg was sent.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tmielke","name":"tmielke","key":"tmielke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Torsten Mielke","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-09T07:23:40.656+0000","updated":"2013-04-09T07:23:40.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/14343186","id":"14343186","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dvhv_sekhar","name":"dvhv_sekhar","key":"dvhv_sekhar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sekhar","active":true,"timeZone":"Etc/UTC"},"body":"we are using ActiveMQ version 5.10. Is this fix available in 5.10? or should we use the workaround of setting idleTimeout=0. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dvhv_sekhar","name":"dvhv_sekhar","key":"dvhv_sekhar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sekhar","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-02T14:27:45.040+0000","updated":"2015-03-02T14:27:45.040+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/14343384","id":"14343384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tmielke","name":"tmielke","key":"tmielke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Torsten Mielke","active":true,"timeZone":"Europe/Berlin"},"body":"Yes, 5.10 will include the fix for this bug. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tmielke","name":"tmielke","key":"tmielke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Torsten Mielke","active":true,"timeZone":"Europe/Berlin"},"created":"2015-03-02T16:58:44.038+0000","updated":"2015-03-02T16:58:44.038+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12636075/comment/15880678","id":"15880678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Raphiki","name":"Raphiki","key":"raphiki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raphiki","active":true,"timeZone":"Europe/Paris"},"body":"An expired connection is now not closed if used by an other thread but there is nothing preventing the loan of an expiryConnection isn't it ?\n\nThe [connectionPool.borrow()|http://grepcode.com/file/repo1.maven.org/maven2/org.apache.activemq/activemq-jms-pool/5.11.0/org/apache/activemq/jms/pool/PooledConnectionFactory.java#236] just call the expiryCheck() throught the [validateObject()|http://grepcode.com/file/repo1.maven.org/maven2/org.apache.activemq/activemq-jms-pool/5.11.0/org/apache/activemq/jms/pool/PooledConnectionFactory.java#135] method but it considers the connection valid (and so reusable) if it has expired but has still some remaining reference...\n\nOn my environment my expiryTimeout of 60 seconds is rarely reached (unless I assign a connection for each consumer but I can't do that in production environment).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Raphiki","name":"Raphiki","key":"raphiki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raphiki","active":true,"timeZone":"Europe/Paris"},"created":"2017-02-23T15:48:17.083+0000","updated":"2017-02-23T15:48:17.083+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4366/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1imiv:"}}