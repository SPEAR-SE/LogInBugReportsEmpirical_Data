{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483307","self":"https://issues.apache.org/jira/rest/api/2/issue/12483307","key":"AMQ-1713","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315630","id":"12315630","description":"Issues that need to be reviewed - do we keep 'em or do we kick 'em? ","name":"NEEDS_REVIEW","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2008-05-08 09:26:55.162","customfield_12310420":"65323","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_102854561457_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-08-11T20:09:36.444+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1713/watchers","watchCount":3,"isWatching":false},"created":"2008-05-08T09:26:55.162+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-08-11T20:09:36.452+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I setup ActiveMQ with the attached configuration (AMQ persistent storage). Then I start ActiveMQ, post a few object messages., Stop it via Ctrl+C, and start it again. After I start it, it recovers the messages (the consumer reads and processes them), but using the web console shows that the queue is empty.\n\nI am referring to: http://localhost:8161/admin/queues.jsp\n\nAfter the consumer processed them, it shows a negative number by the number of messages.\n\nEx. I produce 50 messages and stop the server. Now the counter on the ActiveMQ web console shows 0 \"Number of Pending Messages\". I then start ActiveMQ again and produce 5 more messages. Now \"Number of Pending Messages\" shows 5. \nThen I run the consumer and it processes 55 messages. The \"Number of Pending Messages\" is now \"-50\" (negative 50).\n\nOutput when I start ActiveMQ the second time.\nACTIVEMQ_HOME: /opt/activemq-5.0.0\nACTIVEMQ_BASE: /opt/activemq-5.0.0\nLoading message broker from: xbean:activemq.xml\nINFO  BrokerService                  - Using Persistence Adapter: AMQPersistenceAdapter(/opt/activemq-5.0.0/amqdata)\nINFO  BrokerService                  - ActiveMQ 5.0.0 JMS Message Broker (localhost) is starting\nINFO  BrokerService                  - For help or more information please see: http://activemq.apache.org/\nINFO  AMQPersistenceAdapter          - AMQStore starting using directory: /opt/activemq-5.0.0/amqdata\nINFO  ManagementContext              - JMX consoles can connect to service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi\nINFO  KahaStore                      - Kaha Store using data directory /opt/activemq-5.0.0/amqdata/kr-store/state\nINFO  AMQPersistenceAdapter          - Active data files: []\nWARN  AMQPersistenceAdapter          - The ReferenceStore is not valid - recovering ...\nINFO  KahaStore                      - Kaha Store successfully deleted data directory /opt/activemq-5.0.0/amqdata/kr-store/data\nINFO  AMQPersistenceAdapter          - Journal Recovery Started from: DataManager:(data-)\nINFO  KahaStore                      - Kaha Store using data directory /opt/activemq-5.0.0/amqdata/kr-store/data\nINFO  AMQPersistenceAdapter          - Recovered 73 operations from redo log in 0.137 seconds.\nINFO  AMQPersistenceAdapter          - Finished recovering the ReferenceStore\nINFO  TransportServerThreadSupport   - Listening for connections at: tcp://quintin:61616\nINFO  TransportConnector             - Connector openwire Started\nINFO  TransportServerThreadSupport   - Listening for connections at: ssl://quintin:61617\nINFO  TransportConnector             - Connector ssl Started\nINFO  TransportServerThreadSupport   - Listening for connections at: stomp://quintin:61613\nINFO  TransportConnector             - Connector stomp Started\nINFO  TransportServerThreadSupport   - Listening for connections at: xmpp://quintin:61222\nINFO  TransportConnector             - Connector xmpp Started\nINFO  NetworkConnector               - Network Connector org.apache.activemq.transport.discovery.multicast.MulticastDiscoveryAgent@cd83d8 Started\nINFO  BrokerService                  - ActiveMQ JMS Message Broker (localhost, ID:quintin-35665-1210174126885-0:0) started\nINFO  TransportConnector             - Connector vm://localhost Started\nINFO  log                            - Logging to org.slf4j.impl.JCLLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog\nINFO  log                            - jetty-6.1.4\nINFO  WebConsoleStarter              - ActiveMQ WebConsole initialized.\nINFO  /admin                         - Initializing Spring FrameworkServlet 'dispatcher'\nINFO  log                            - ActiveMQ Console at http://0.0.0.0:8161/admin\nINFO  log                            - ActiveMQ Web Demos at http://0.0.0.0:8161/demo\nINFO  log                            - Started SelectChannelConnector@0.0.0.0:8161\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461033","id":"12461033","filename":"ASF.LICENSE.NOT.GRANTED--activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qbeukes","name":"qbeukes","key":"qbeukes","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Quintin Beukes","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-08T09:26:55.192+0000","size":2603,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461033/ASF.LICENSE.NOT.GRANTED--activemq.xml"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59910","customfield_12312823":null,"summary":"AMQ Restore from Persistent Storage Breaks Queue Counters","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qbeukes","name":"qbeukes","key":"qbeukes","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Quintin Beukes","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qbeukes","name":"qbeukes","key":"qbeukes","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Quintin Beukes","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux quintin 2.6.20-gentoo-r6-quintin #5 SMP Tue Sep 18 15:17:40 SAST 2007 i686 Intel(R) Pentium(R) 4 CPU 3.00GHz GenuineIntel GNU/Linux\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1713/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0amg7:"}}