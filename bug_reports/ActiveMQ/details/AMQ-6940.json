{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13148529","self":"https://issues.apache.org/jira/rest/api/2/issue/13148529","key":"AMQ-6940","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341032","id":"12341032","name":"5.16.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342685","id":"12342685","description":"","name":"5.15.4","archived":false,"released":true,"releaseDate":"2018-05-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2018-03-28T22:39:14.666+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 30 16:02:00 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_96098480_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2018-03-29T13:02:45.843+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6940/watchers","watchCount":4,"isWatching":false},"created":"2018-03-28T10:21:07.398+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341947","id":"12341947","name":"5.15.3","archived":false,"released":true,"releaseDate":"2018-02-01"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-03-30T16:02:00.116+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Recently we upgraded from 5.8.0 to 5.15.3 on one of our environments and found the broker running out of memory with the old broker configurations.\r\n\r\nI suspect this may be related to the new inflight message size calculation but haven't been able to create a reproducer just yet.\r\n\r\nBroker JVM running with opts \r\n\r\n{code:java}\r\n-Xss256k -Xms600m -Xmx600m -Xmn128m -Dfile.encoding=ISO-8859-1 -Dlog4j.watchDelay=60000 -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps -XX:+PrintPromotionFailure -XX:PrintFLSStatistics=1 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+PrintClassHistogram -verbose:gc -Dsun.rmi.dgc.client.gcInterval=7200000 -Dsun.rmi.dgc.server.gcInterval=7200000\r\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916586","id":"12916586","filename":"activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T10:20:06.103+0000","size":3781,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12916586/activemq.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916857","id":"12916857","filename":"amq_5.16.0-SNAPSHOT.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:02:09.121+0000","size":51643,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12916857/amq_5.16.0-SNAPSHOT.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916856","id":"12916856","filename":"amq_5.8.0.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:02:09.109+0000","size":54865,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12916856/amq_5.8.0.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916635","id":"12916635","filename":"amq_heap2.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T15:32:42.966+0000","size":63637,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12916635/amq_heap2.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916860","id":"12916860","filename":"amq-testing.tar.xz","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:18:14.474+0000","size":18020,"mimeType":"application/x-xz","content":"https://issues.apache.org/jira/secure/attachment/12916860/amq-testing.tar.xz"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12916585","id":"12916585","filename":"messageid_analysis.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T10:20:23.001+0000","size":259929,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12916585/messageid_analysis.png"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Significant memory footprint increase from 5.8.0 to 5.15.3","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Java jdk1.8.0_144\r\n\r\nOS Linux 4.4.19-29.55.amzn1.x86_64","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10431","value":"Important","id":"10431"}],"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16417301","id":"16417301","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"Still leaking after removing the vmcursors as suggested by dejanb.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T13:05:01.398+0000","updated":"2018-03-28T13:05:01.398+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16417567","id":"16417567","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"I created a canary build of the broker and removed the dispatched array from org.apache.activemq.broker.region.TopicSubscription , the heap has more or less dropped to the old baseline but I will follow up later as it still may be too early to tell. The dispatched array is cleaned via org.apache.activemq.broker.region.TopicSubscription#updateStatsOnAck(org.apache.activemq.command.MessageAck) which is invoked every x thousand messages, the problem here is that in our cluster we have roughly 7300 consumers and 900 producers which is clearly not going to scale as well as it did in 5.8.0..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T15:37:09.924+0000","updated":"2018-03-28T17:07:52.408+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418160","id":"16418160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"Confirmed the regression is caused by https://issues.apache.org/jira/browse/AMQ-5837","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T21:36:47.117+0000","updated":"2018-03-28T21:36:47.117+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418213","id":"16418213","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"The reason why this has never come up is because you are running on a very small JVM for the number of consumers and producers you have.  600 megabytes of memory is pretty small given the number of producers and consumers is over 8000.  So yes the feature is not going to scale without proper memory allocation. The short term solution is to simply increase your heap size.\r\n\r\nA more permanent fix is to add a flag to the policy configuration to disable the inflight statistics on TopicSubscription so that the dispatched array doesn't collect objects anymore (basically what you already did).  This is something that can be added for the next patch release so you can disable the statistics.\r\n\r\n \r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-28T22:39:14.666+0000","updated":"2018-03-28T22:40:09.781+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418237","id":"16418237","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"I strongly disagree that 600 megabytes of memory is too little for over 8k producers and consumers, prior to 5.15.3 the JVM took an average of 100mb of heap (150mb max).\r\n\r\nTo be brutally honest I believe the implementation is broken, apart from it taking so much memory, it should not be storing the actual messages and their payloads for so long (or even at all for that matter) even if it is a non persistent topic, the consumer is not slow and the messages have been delivered the messages remain in the dispatched array until updateStatsOnAck is invoked which is seldom..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-28T23:24:29.312+0000","updated":"2018-03-29T10:27:42.445+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418693","id":"16418693","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"In addition, how are the inflight stats even remotely accurate if the broker keeps processed messages in memory..? They should be removed immediately to be usable.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T10:10:22.456+0000","updated":"2018-03-29T10:32:40.515+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418745","id":"16418745","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"In flight messages by definition are messages that have not been processed but have simply been dispatched to a consumer.  Messages are not \"processed\" until a consumer acknowledges the message so the broker does not drop a message until then.  \r\n\r\nThis dispatched list is not new.  It is only new for a TopicSubscription.  It has been used for 10 years for Queue subscriptions and Durable subscriptions to track in flight messages.  See https://github.com/apache/activemq/blame/master/activemq-broker/src/main/java/org/apache/activemq/broker/region/PrefetchSubscription.java#L217","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T10:46:09.580+0000","updated":"2018-03-29T10:46:09.580+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418748","id":"16418748","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"The other option that should reduce the amount of messages in that list would be to lower your prefetch configuration for your consumers.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T10:47:59.149+0000","updated":"2018-03-29T10:47:59.149+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418775","id":"16418775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"{quote}In flight messages by definition are messages that have not been processed but have simply been dispatched to a consumer. Messages are not \"processed\" until a consumer acknowledges the message so the broker does not drop a message until then.{quote}\r\n\r\nSo based on your definition shouldn't updateStatsOnAck be invoked in here? (just a shot in the dark haven't had time to test it)\r\n\r\norg.apache.activemq.broker.region.TopicSubscription#acknowledge\r\n\r\n{code:java}\r\n} else if (ack.isDeliveredAck()) {\r\n    // Message was delivered but not acknowledged: update pre-fetch counters.\r\n    expandPrefetchExtension(ack.getMessageCount());\r\n    // missing call to updateStatsOnAck?\r\n} else if (ack.isRedeliveredAck()) {\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T11:11:14.532+0000","updated":"2018-03-29T11:11:14.532+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418815","id":"16418815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"No because that method is only updating stats when the ack signals the message is being dropped because it was handled properly which means either a standard/individual ack (consumer processed it) or expired ack (broker is dropping it because it expired).  For delivered acks it's just saying that a client received it but is acking later so the inflight stats are not processed (as the message is still in flight and not actually acked) and only the prefetch is adjusted.  I think that happens when using acknowledge batch mode.\r\n\r\nI'm working on a patch now to disable tracking of those messages in the pendingList because it's not necessary for TopicSubscriptions except for the metrics case so it can be optionally disabled.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T11:39:23.758+0000","updated":"2018-03-29T11:39:23.758+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418864","id":"16418864","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"Given the only thing the dispatched list is used for is metrics why not just store the message id and payload size?  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T12:04:57.595+0000","updated":"2018-03-29T12:04:57.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418927","id":"16418927","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"I think that should be doable.  I think we would need to include the Destination as well but basically could store a list of a new type of object for dispatched messages and that new object would just contain the message id, size, and destination reference (which is already tracked in memory in another map).  I'll work on a patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T12:47:16.696+0000","updated":"2018-03-29T13:01:45.488+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418936","id":"16418936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"Also it's only going to be possible for now TopicSubscriptions.  For Queue and Durable subscriptions the message reference is used in a lot more cases from that dispatched list and is not going to be simple to remove it.  But since this is only a problem for you in the TopicSubscription case that should be ok.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T12:52:29.356+0000","updated":"2018-03-29T12:52:29.356+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418955","id":"16418955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit f69fd6f0020290752a7424479821c22d94f9b8b7 in activemq's branch refs/heads/master from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f69fd6f ]\n\nAMQ-6940 - Reduce memory footprint for inflight statistics\n\nFor the TopicSubscription case we can reduce the inflight statistics\nmemory footprint by not storing the entire message reference for in\nflight messages and instead just a subset of the information needed.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T13:02:04.234+0000","updated":"2018-03-29T13:02:04.234+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418956","id":"16418956","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit cae382063eb296eb6aef6e0952f691aa80c33031 in activemq's branch refs/heads/activemq-5.15.x from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=cae3820 ]\n\nAMQ-6940 - Reduce memory footprint for inflight statistics\n\nFor the TopicSubscription case we can reduce the inflight statistics\nmemory footprint by not storing the entire message reference for in\nflight messages and instead just a subset of the information needed.\n\n(cherry picked from commit f69fd6f0020290752a7424479821c22d94f9b8b7)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T13:02:31.555+0000","updated":"2018-03-29T13:02:31.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418993","id":"16418993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"[~cshannon] I think that makes sense, we heavily use TopicSubscription for highspeed pubsub and this performance regression is blocking us from upgrading.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T13:36:25.948+0000","updated":"2018-03-29T13:36:25.948+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418995","id":"16418995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"Now that we've determined the actual cause I will try and create a standalone reproducer to verify the patch works as expected or if we also require the config to disable inflight stats.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T13:37:21.159+0000","updated":"2018-03-29T13:37:21.159+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16418999","id":"16418999","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"[~johno] - Sounds good, hopefully this patch reduces the memory usage enough for your use case.  Otherwise I have a patch I created to disable the stats tracking that I can also commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T13:39:18.798+0000","updated":"2018-03-29T13:39:18.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419387","id":"16419387","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"[~cshannon] could I trouble you for the patch so I can test that too? Unfortunately even with the latest changes to reduce the inflight statistics memory footprint the memory is not ideal.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T16:59:27.827+0000","updated":"2018-03-29T16:59:27.827+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419391","id":"16419391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"I attached the reproducer and yourkit profiler screenshots showing the heap usage.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:03:05.046+0000","updated":"2018-03-29T17:12:31.847+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419438","id":"16419438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 65b0f2ad0d48845ad54681ac0eff832de122e2a9 in activemq's branch refs/heads/master from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=65b0f2a ]\n\nAMQ-6940 - Add flag to disable TopicSubscription in flight stats\n\nTo save memory usage in some use cases add a new flag to PolicyEntry\ncalled useTopicSubscriptionInflightStats to allow disabling the\ninflight stats\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:25:49.570+0000","updated":"2018-03-29T17:25:49.570+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419440","id":"16419440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 21a594c8e817ebb2090c1de016c5bb1f4f905e08 in activemq's branch refs/heads/activemq-5.15.x from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=21a594c ]\n\nAMQ-6940 - Add flag to disable TopicSubscription in flight stats\n\nTo save memory usage in some use cases add a new flag to PolicyEntry\ncalled useTopicSubscriptionInflightStats to allow disabling the\ninflight stats\n\n(cherry picked from commit 65b0f2ad0d48845ad54681ac0eff832de122e2a9)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:26:29.483+0000","updated":"2018-03-29T17:26:29.483+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419444","id":"16419444","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"There's a new flag on a policy that you can set called useTopicSubscriptionInflightStats.  It defaults to true but if you set it to false then it will not store those objects in the dispatched list and skip that metric.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T17:27:35.018+0000","updated":"2018-03-29T17:27:52.574+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419450","id":"16419450","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"-Does the xsd need to be updated too or is that generated automatically?- I'll create another snapshot and check it out.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:30:59.020+0000","updated":"2018-03-29T17:35:29.630+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419455","id":"16419455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"It gets generated automatically during the maven build.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T17:35:02.058+0000","updated":"2018-03-29T17:35:02.058+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419459","id":"16419459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"[~cshannon] confirmed disabling inflight stats does the trick, thanks for the quick fix!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:39:32.890+0000","updated":"2018-03-29T17:39:32.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419463","id":"16419463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"Do you have a rough idea of when 5.15.4 will be cut?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-29T17:42:23.159+0000","updated":"2018-03-29T17:42:23.159+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16419486","id":"16419486","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"There's not really a definitive date but there's enough fixes that we could probably do one in the next week or two.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-29T17:52:48.630+0000","updated":"2018-03-29T17:52:48.630+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420314","id":"16420314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"[~cshannon] looks like an extra bracket snuck into PolicyEntry (line 1104) and missing closing bracket for setUseTopicSubscriptionInflightStats on the activemq-5.15.x branch which causes a compile error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-30T09:16:16.287+0000","updated":"2018-03-30T09:19:10.985+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420358","id":"16420358","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 9346fb3638f293b585560051cd57ef7e513c0d4a in activemq's branch refs/heads/activemq-5.15.x from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=9346fb3 ]\n\nAMQ-6940 - Fix compilation\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-30T10:30:28.210+0000","updated":"2018-03-30T10:30:28.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420361","id":"16420361","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit a0a240372fda05675055cc29f35cb60a4a0311af in activemq's branch refs/heads/activemq-5.15.x from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=a0a2403 ]\n\nAMQ-6940 - fix compilation attempt 2\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-30T10:31:30.837+0000","updated":"2018-03-30T10:31:30.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420362","id":"16420362","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 84126d8a7a7eb9faf44bef687dcf647e84173f22 in activemq's branch refs/heads/master from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=84126d8 ]\n\nAMQ-6940 - test fix for AMQ6477 test\n\nNeed to remove the portion of the test that looks at the dispatched list\nfor TopicSubscription as that class no longer tracks message references\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-30T10:35:37.947+0000","updated":"2018-03-30T10:35:37.947+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420363","id":"16420363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 9683ae3f5dacdbcde470e9bc8cbb5263e465560c in activemq's branch refs/heads/activemq-5.15.x from [~cshannon]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=9683ae3 ]\n\nAMQ-6940 - test fix for AMQ6477 test\n\nNeed to remove the portion of the test that looks at the dispatched list\nfor TopicSubscription as that class no longer tracks message references\n\n(cherry picked from commit 84126d8a7a7eb9faf44bef687dcf647e84173f22)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-30T10:36:07.814+0000","updated":"2018-03-30T10:36:07.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420364","id":"16420364","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"[~johno] - Should be fixed now, Jenkins also caught a test failure that I fixed that was a side effect from the path","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2018-03-30T10:36:38.381+0000","updated":"2018-03-30T10:36:38.381+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13148529/comment/16420644","id":"16420644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"body":"[~cshannon] thanks again!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johno","name":"johno","key":"johno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johno Crawford","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-30T16:02:00.116+0000","updated":"2018-03-30T16:02:00.116+0000"}],"maxResults":35,"total":35,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6940/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3rvtz:"}}