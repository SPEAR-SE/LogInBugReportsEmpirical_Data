{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12754833","self":"https://issues.apache.org/jira/rest/api/2/issue/12754833","key":"AMQ-5433","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329258","id":"12329258","name":"5.12.0","archived":false,"released":true,"releaseDate":"2015-08-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-04-02T23:03:13.359+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Apr 02 23:03:13 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_12198652723_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-04-02T23:03:13.321+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5433/watchers","watchCount":2,"isWatching":false},"created":"2014-11-12T18:32:20.657+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324951","id":"12324951","name":"5.11.0","archived":false,"released":true,"releaseDate":"2015-02-04"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-04-02T23:03:13.370+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12321807","id":"12321807","name":"AMQP","description":"AcitveMQ's AMQP Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"[Amqp.Net Lite|https://amqpnetlite.codeplex.com/] has a set of self tests that work OK when run against a Qpidd 0.30 (proton 0.8) broker. However, when run against ActiveMQ 5.10 or 5.11 SNAPSHOT one self tests causes a batch of messages to get stuck in the broker.\nThe self test in question is [LinkTests.cs CloseBusyReceiver|https://amqpnetlite.codeplex.com/SourceControl/latest#test/Test.Amqp.NetMF/LinkTests.cs].\n\nThe test \n* opens a sender and receiver to node q1.\n* sends 20 messages. \n* when the receiver receives the first message it closes the receiver and that causes an AMQP detach. \n* then the test opens a second receiver and tries to drain the 20 messages.\nThe test fails because the second receiver never receives anything. The AMQ web console shows the 20 messages in the queue. \n\nRunning the test again without clearing the queue results in 40 messages in the queue and the self test fails because the first receiver never receives any messages and thus never closes the busy receiver. The first 20 messages jam that queue.\n\nAlso, the messages are not received by tools that normally work fine, like qpid-receive.\n\nThis effect is 100% repeatable.\n\nProtocol trace file to be attached","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12681102","id":"12681102","filename":"lite_58_amq5.11_closeBusyReceiver_run_2_times.htm..htm","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chug","name":"chug","key":"chug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chug&avatarId=32782","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chug&avatarId=32782","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chug&avatarId=32782","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chug&avatarId=32782"},"displayName":"Chuck Rolke","active":true,"timeZone":"America/New_York"},"created":"2014-11-12T18:36:07.553+0000","size":224392,"mimeType":"text/html","content":"https://issues.apache.org/jira/secure/attachment/12681102/lite_58_amq5.11_closeBusyReceiver_run_2_times.htm..htm"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"AMQP messages stuck in broker when receiver detaches while receiving","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chug","name":"chug","key":"chug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chug&avatarId=32782","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chug&avatarId=32782","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chug&avatarId=32782","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chug&avatarId=32782"},"displayName":"Chuck Rolke","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chug","name":"chug","key":"chug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chug&avatarId=32782","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chug&avatarId=32782","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chug&avatarId=32782","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chug&avatarId=32782"},"displayName":"Chuck Rolke","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"broker: snapshot apache-activemq-5.11-20141022.222801-124-bin.tar.gz\nWed Oct 22 22:28:02 UTC 2014\nhost: Linux Fedora 19 x64\nclient: Amqp.Net Lite self tests","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754833/comment/14208417","id":"14208417","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chug","name":"chug","key":"chug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chug&avatarId=32782","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chug&avatarId=32782","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chug&avatarId=32782","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chug&avatarId=32782"},"displayName":"Chuck Rolke","active":true,"timeZone":"America/New_York"},"body":"AMQP protocol trace of self test running twice. The command line was\n{noformat}\nmstest /testcontainer:.\\bin\\debug\\test.amqp.net\\test.amqp.net.dll ^\n  /test:Test.Amqp.LinkTests.TestMethod_CloseBusyReceiver ^\n  /detail:debugTrace\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chug","name":"chug","key":"chug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chug&avatarId=32782","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chug&avatarId=32782","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chug&avatarId=32782","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chug&avatarId=32782"},"displayName":"Chuck Rolke","active":true,"timeZone":"America/New_York"},"created":"2014-11-12T18:36:07.561+0000","updated":"2014-11-12T18:36:07.561+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754833/comment/14393681","id":"14393681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This is resolved with the recent addition of proper drain support and fixes to set lastDeliverSequenceId properly on receiver close.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-04-02T23:03:13.359+0000","updated":"2015-04-02T23:03:13.359+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5433/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i22alr:"}}