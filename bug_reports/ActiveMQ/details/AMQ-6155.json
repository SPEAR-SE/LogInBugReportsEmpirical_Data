{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12936420","self":"https://issues.apache.org/jira/rest/api/2/issue/12936420","key":"AMQ-6155","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2016-02-03T19:01:34.050+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 18 17:02:51 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_89439882_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-02-04T19:43:21.653+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6155/watchers","watchCount":4,"isWatching":false},"created":"2016-02-03T18:52:41.813+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329390","id":"12329390","name":"5.10.2","archived":false,"released":true,"releaseDate":"2015-02-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329848","id":"12329848","name":"5.13.0","archived":false,"released":true,"releaseDate":"2015-12-03"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-02-18T17:02:51.044+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When a new connection is opened for the purpose of sending a message to a temporary queue it sometimes fails with the following exception (stack trace is from v5.13.0):\n\n javax.jms.InvalidDestinationException: Cannot publish to a deleted Destination: temp-queue://ID:Potomac.local-59943-1454448412194-1:1:96\n \tat org.apache.activemq.ActiveMQSession.send(ActiveMQSession.java:1904)\n \tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:288)\n \tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:223)\n \tat org.apache.activemq.ActiveMQMessageProducerSupport.send(ActiveMQMessageProducerSupport.java:241)\n\n\nThe actual problem appears to be in ActiveMQConnection.isDeleted().  Because the connection being used to send to the temp queue is not the connection under which the temp queue was created, it's dependent on AdvisoryConsumer to populate the activeTempDestinations map before the send() call is made.  The AdvisoryConsumer gets called in a separate thread, asynchronous with the main thread, so this constitutes a race condition.  If the send() call is made before AdvisoryConsumer can notify the new connection of all existing temp queues then it will throw an InvalidDestinationException even though the temp queue does actually exist.\n\nCalling setWatchTopicAdvisories(false) on the sending connection's factory alleviates the problem and the program can run indefinitely with no errors.  Also, adding a delay before the MessageProducer.send() call can alleviate the error somewhat, but with a small enough delay it will still happen eventually.\n\nI noticed this first in an environment I don't have full control over.  It happened the first time, every time, for reasons I still don't quite understand.  I have written a small test program that reproduces the error outside of the original environment, but it runs in a loop and it takes a few hundred iterations for it to occur.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12786070","id":"12786070","filename":"AmqTempRaceConditionMinimalTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-03T18:55:36.051+0000","size":5568,"mimeType":"text/x-java","content":"https://issues.apache.org/jira/secure/attachment/12786070/AmqTempRaceConditionMinimalTest.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Spurious InvalidDestinationException publishing to a temp queue from a new connection","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows, OS X","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15130886","id":"15130886","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"body":"Attaching my test program that reproduces the issue.  It has three variables:\n\n - url: The URL of your local ActiveMQ server\n\n - watchTopicAdvisories: Set to 'true' to reproduce the problem, set to 'false' to test the workaround.\n\n - delay: set to '0' to reproduce the problem.  Set to at least 500-1000 to alleviate the problem, although the error can still occur.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-03T18:55:36.055+0000","updated":"2016-02-03T18:55:36.055+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15130898","id":"15130898","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This is expected behaviour given the way the test is structured.  The test creates a temp queue on one connection and then uses it on a newly created connection which is not how this work normally work in practice.  Normally the temp queue would arrive in the reply to of an incoming message (request / response pattern) in which case the advisory for creation of that temp queue would have already been dispatched to the remote consumer so it wouldn't see this problem.  The solution to the problem is just what you have done, turn off watchTopicAdvisories in the connection factory.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2016-02-03T19:01:34.050+0000","updated":"2016-02-03T19:01:34.050+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15130936","id":"15130936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"body":"Unfortunately, calling setWatchTopicAdvisories() is not an option as the original environment was using JNDI to connect to ActiveMQ.  I couldn't find any way to set that parameter through JNDI.  Our only workaround was to restructure how the application worked, which is not always an option for us.\n\nIt also seems like if I had any kind of appreciable churn on temp queues and more than handful of open connections then I would want this feature turned off purely for performance reasons.  In normal usage, only one connection is ever going to care about any given temp queue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-03T19:18:58.553+0000","updated":"2016-02-03T19:18:58.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15131056","id":"15131056","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"You can set these options on the Connection URI, for example: tcp://localhost:61616?jms.watchTopicAdvisories=false","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2016-02-03T20:18:34.641+0000","updated":"2016-02-03T20:18:34.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15132870","id":"15132870","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Things appear to be working as designed.  There is a workaround for the use case presented which is to add the watchTopicAdvisories=false to the connection URI. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2016-02-04T19:43:21.683+0000","updated":"2016-02-04T19:43:21.683+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15132882","id":"15132882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"body":"Agreed.  I'm not happy about it, but the workarounds are acceptable.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-04T19:47:50.347+0000","updated":"2016-02-04T19:47:50.347+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15151462","id":"15151462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=masc3d","name":"masc3d","key":"masc3d","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"masc","active":true,"timeZone":"Etc/UTC"},"body":"I'm seeing the same issue with a single connection creating a temporary queue and sending a request/response to a network of brokers. The  message is sporadically delivered before the temporary queue is available in the remote broker, resulting in the same error/stacktrace when sending the reply. \n\nShould the issue be reopened?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=masc3d","name":"masc3d","key":"masc3d","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"masc","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-18T00:03:51.885+0000","updated":"2016-02-18T00:03:51.885+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15151491","id":"15151491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"body":"Does adding '?jms.watchTopicAdvisories=false' or otherwise disabling the topic advisories feature on your responding connection fix the issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-18T00:28:24.435+0000","updated":"2016-02-18T00:28:24.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15151536","id":"15151536","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=masc3d","name":"masc3d","key":"masc3d","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"masc","active":true,"timeZone":"Etc/UTC"},"body":"Yes. Without topic advisories it works fine.\nHere's some interesting log entries from the receiver. The queue seems to be created prior to send. Version is 5.13.1\n...\n2016-02-18 01:15:22,683 131622 ActiveMQ VMTransport: vm://leoz-aq-86c3ca5c3a347577744055d910d00c6fa9811a53#3-3 org.apache.activemq.broker.region.AbstractRegion DEBUG - leoz-aq-86c3ca5c3a347577744055d910d00c6fa9811a53 adding destination: temp-queue://ID:agnus.o81.5-57628-1455753254297-7:1:99\n2016-02-18 01:15:22,683 131622 DefaultMessageListenerContainer-1 org.deku.leoz.node.data.sync.EntityPublisher ERROR - Cannot publish to a deleted Destination: temp-queue://ID:agnus.o81.5-57628-1455753254297-7:1:99\njavax.jms.InvalidDestinationException: Cannot publish to a deleted Destination: temp-queue://ID:agnus.o81.5-57628-1455753254297-7:1:99\n\tat org.apache.activemq.ActiveMQSession.send(ActiveMQSession.java:1904)\n\tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:288)\n\tat org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:223)\n\tat org.apache.activemq.jms.pool.PooledProducer.send(PooledProducer.java:95)\n\tat org.apache.activemq.jms.pool.PooledProducer.send(PooledProducer.java:66)\n\tat org.deku.leoz.node.data.sync.EntityPublisher.onMessage(EntityPublisher.kt:99)\n\tat sx.jms.listeners.SpringJmsListener.access$onMessage(SpringJmsListener.kt:18)\n\tat sx.jms.listeners.SpringJmsListener$start$1.onMessage(SpringJmsListener.kt:55)\n...\n2016-02-18 01:15:27,699 136638 ActiveMQ VMTransport: vm://leoz-aq-86c3ca5c3a347577744055d910d00c6fa9811a53#3-4 org.apache.activemq.broker.region.AbstractRegion DEBUG - leoz-aq-86c3ca5c3a347577744055d910d00c6fa9811a53 removing destination: temp-queue://ID:agnus.o81.5-57628-1455753254297-7:1:99\n...\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=masc3d","name":"masc3d","key":"masc3d","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"masc","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-18T01:17:51.726+0000","updated":"2016-02-18T01:17:51.726+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12936420/comment/15152610","id":"15152610","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"body":"That's a fairly damning log sequence.  But because there appear to be two threads involved, the order in which things are logged are not necessarily the order in which they occurred.  The first two lines have the same exact timestamp but different threads, so the order in which they are logged is more up to chance than anything else.\n\nStill, I think the fact that you're able to see the issue without the \"unusual\" application structure I was using is a good enough reason to reopen this.  However, I suspect the answer will be the same; to just disable watchTopicAdvisories.  I'm currently recommending to everyone who uses temp queues with ActiveMQ to add 'jms.watchTopicAdvisories=false' to their URL.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbow","name":"kbow","key":"kbow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin Bowman","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-18T17:02:51.044+0000","updated":"2016-02-18T17:02:51.044+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6155/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2sdcn:"}}