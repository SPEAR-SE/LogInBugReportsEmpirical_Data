{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12645607","self":"https://issues.apache.org/jira/rest/api/2/issue/12645607","key":"AMQ-4502","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2013-05-01T14:06:58.968+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 08 04:03:14 UTC 2013","customfield_12310420":"325968","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_112877458_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-05-02T15:01:21.918+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4502/watchers","watchCount":3,"isWatching":false},"created":"2013-05-01T07:40:04.486+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["activemq","dequeue","enqueue","expiration","expires","stomp"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-08T04:03:14.159+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315706","id":"12315706","name":"stomp"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"A producer that sends a message to a queue with no consumers will not be dequeued. The messages will never expire. This occurs with Stomp.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"326313","customfield_12312823":null,"summary":"Stomp messages with no expiration not removed from queue","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux: Ubuntu 12.04, java openjdk 1.7.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12645607/comment/13646604","id":"13646604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Can you elaborate on this, can't really see what the issue is as Message's without an expiration are not expected to be removed until they are consumed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-01T14:06:58.968+0000","updated":"2013-05-01T14:06:58.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12645607/comment/13647181","id":"13647181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"body":"Thank you for the clarification. I have read all of the ActiveMQ documentation and was not clear what the default is supposed to be. Perhaps this issue should be changed to a documentation feature request? Here is how ActiveMQ 5.8 currently works:\n\n1) When a producer sends a message to a topic using stomp and a consumer is not present, the message is silently discarded. The web console shows an increase in the enqueue count. The dequeue count is not used and is always 0. This occurs when an expires header is set to 0 and also when an expires header is not present.\n\n2) When a producer sends a message to a queue using stomp and a consumer is not present, the message is added to the queue. The web console shows an increase in the enqueue count. The message will never expire. This occurs when an expires header is set to 0 and also when an expires header is not present.\n\nAdditional Comments:\n\n1) I would expect topic and queue destinations to have the same defaults with respect to how messages are removed. Since the documentation does not state otherwise, it is not intuitive to think they would be different.\n\n2) The default for queues seems to be a problem. When a producer sends many messages to a queue periodically and no consumer is present, ActiveMQ's disk space/memory pool could be depleted. This default requires intervention/maintenance. One improperly written application written by a novice developer could bring down the entire messaging server. I would like the default for queue's to match the default for topics. In other words, messages sent to queues with no consumers are silently discarded. This is how DBUS works too.\n\n3) Messages with an expiration cause problems when the producer's clock is not synchronized with the ActiveMQ server.\n\n4) Perhaps a feature could be enabled to support an expires header with -1. -1 means the message will expire when consumers are not present.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-02T01:47:30.769+0000","updated":"2013-05-02T01:47:30.769+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12645607/comment/13647596","id":"13647596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"You need to do some additional research on the different between a Topic and Queue.  This behavior is as expected, Queues are fundamentally different beasts from Topics.\n\nSee: http://activemq.apache.org/how-does-a-queue-compare-to-a-topic.html\n\nMessages are held in the Queue regardless of there being an active subscription.  If you need the Queue to drain over time when there are no consumers then a TTL value is required.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-02T15:01:06.031+0000","updated":"2013-05-02T15:01:06.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12645607/comment/13647597","id":"13647597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Working as expected. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-02T15:01:21.939+0000","updated":"2013-05-02T15:01:21.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12645607/comment/13648104","id":"13648104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the link on Topics vs Queues.\n\nActiveMQ does not support TTL with Stomp.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-03T01:40:57.524+0000","updated":"2013-05-03T01:40:57.524+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12645607/comment/13651603","id":"13651603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"body":"ActiveMQ does support TTL with stomp after AMQ-4468 was resolved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aletheia7","name":"aletheia7","key":"aletheia7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Erik","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-08T04:03:14.159+0000","updated":"2013-05-08T04:03:14.159+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4502/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1k8iv:"}}