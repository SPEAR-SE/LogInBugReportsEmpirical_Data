{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12730898","self":"https://issues.apache.org/jira/rest/api/2/issue/12730898","key":"AMQ-5297","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2014-07-30T20:18:29.300+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Feb 08 21:12:12 UTC 2016","customfield_12310420":"408970","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_791677_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-07-30T20:18:29.264+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5297/watchers","watchCount":3,"isWatching":false},"created":"2014-07-30T20:05:17.631+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-02-08T21:12:12.035+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319603","id":"12319603","name":"activemq-pool","description":"The ActiveMQ Connection Pool"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We have a case where we are trying to startup 100s of camel routes and it appears to be causing an issue where the consumer is only partially started and the thread is stuck waiting for for the consumer to be fully created. The consumer appears to be created on the broker side so that it is getting messages enqueued and dispatched, just never serviced.\n\nCould this be due to our connection pool being too small? Could we avoid this problem with asyncSend?\n\n{quote}\n\"Camel (AppsJVM) thread #28 - JmsConsumer[response.queue]\" - Thread t@318\n   java.lang.Thread.State: WAITING\n\tat sun.misc.Unsafe.park(Native Method)\n\t- parking to wait for <ee029ee> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n\tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2043)\n\tat java.util.concurrent.ArrayBlockingQueue.take(ArrayBlockingQueue.java:374)\n\tat org.apache.activemq.transport.FutureResponse.getResult(FutureResponse.java:40)\n\tat org.apache.activemq.transport.ResponseCorrelator.request(ResponseCorrelator.java:87)\n\tat org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1380)\n\tat org.apache.activemq.ActiveMQSession.syncSendPacket(ActiveMQSession.java:1912)\n\tat org.apache.activemq.ActiveMQMessageConsumer.<init>(ActiveMQMessageConsumer.java:273)\n\tat org.apache.activemq.ActiveMQSession.createConsumer(ActiveMQSession.java:1144)\n\tat org.apache.activemq.ActiveMQSession.createConsumer(ActiveMQSession.java:1088)\n\tat org.apache.activemq.ActiveMQSession.createConsumer(ActiveMQSession.java:1001)\n\tat org.apache.activemq.pool.PooledSession.createConsumer(PooledSession.java:311)\n\tat org.springframework.jms.listener.AbstractPollingMessageListenerContainer.createConsumer(AbstractPollingMessageListenerContainer.java:503)\n\tat org.springframework.jms.listener.AbstractPollingMessageListenerContainer.createListenerConsumer(AbstractPollingMessageListenerContainer.java:224)\n\tat org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.initResourcesIfNecessary(DefaultMessageListenerContainer.java:1094)\n\tat org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1070)\n\tat org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1063)\n\tat org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:960)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\n\n   Locked ownable synchronizers:\n\t- locked <4deb7015> (a java.util.concurrent.ThreadPoolExecutor$Worker)\n{quote}\n\n{quote}\n<bean id=\"JMSPooledConnectionFactory\" class=\"org.apache.activemq.pool.PooledConnectionFactory\">\n\n        <property name=\"maxConnections\" value=\"8\" />\n\n        <property name=\"maximumActiveSessionPerConnection\" value=\"500\" />\n        <property name=\"idleTimeout\" value=\"0\" />\n        <property name=\"connectionFactory\" ref=\"JMSConnectionFactory\" />\n    </bean>\n{quote}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"408968","customfield_12312823":null,"summary":"PooledSession with lots of consumers can fail to start fully","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shendley","name":"shendley","key":"shendley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sam hendley","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shendley","name":"shendley","key":"shendley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sam hendley","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"java version \"1.7.0_51\"\nJava(TM) SE Runtime Environment (build 1.7.0_51-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 24.51-b03, mixed mode)\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730898/comment/14079896","id":"14079896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Questions should be directed to the users mailing list.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-07-30T20:18:29.300+0000","updated":"2014-07-30T20:18:29.300+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730898/comment/15137382","id":"15137382","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timkieschnick","name":"timkieschnick","key":"timkieschnick","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=timkieschnick&avatarId=26015","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=timkieschnick&avatarId=26015","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=timkieschnick&avatarId=26015","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=timkieschnick&avatarId=26015"},"displayName":"Tim Kieschnick","active":true,"timeZone":"America/Chicago"},"body":"Was this ever resolved or worked around?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timkieschnick","name":"timkieschnick","key":"timkieschnick","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=timkieschnick&avatarId=26015","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=timkieschnick&avatarId=26015","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=timkieschnick&avatarId=26015","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=timkieschnick&avatarId=26015"},"displayName":"Tim Kieschnick","active":true,"timeZone":"America/Chicago"},"created":"2016-02-08T18:11:37.361+0000","updated":"2016-02-08T18:11:37.361+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730898/comment/15137693","id":"15137693","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shendley","name":"shendley","key":"shendley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sam hendley","active":true,"timeZone":"Etc/UTC"},"body":"This still occurs for us on 5.12 in some cases. I think it is related to the size of the pool. By increasing the size of the pool dramatically it seems to have fixed this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shendley","name":"shendley","key":"shendley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sam hendley","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-08T21:12:12.035+0000","updated":"2016-02-08T21:12:12.035+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5297/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1yd93:"}}