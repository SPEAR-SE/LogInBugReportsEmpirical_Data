{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12761129","self":"https://issues.apache.org/jira/rest/api/2/issue/12761129","key":"AMQ-5485","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2014-12-12T02:43:29.007+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Apr 19 18:39:06 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_42768392018_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-04-19T18:39:06.745+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5485/watchers","watchCount":3,"isWatching":false},"created":"2014-12-11T18:32:34.803+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-04-19T18:39:06.819+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We are having issues where the storage max size is reached.  After watching the jconsole the kahadb size is growing continually. I turned on some trace output and see that with each Checkpoint the size increases.\n\nIs there a missing setting or a bug?\n\n11 Dec 2014 13:31:00,339 DEBUG MessageDatabase: Checkpoint started.\n11 Dec 2014 13:31:00,343 DEBUG MessageDatabase: Checkpoint done.\n11 Dec 2014 13:31:05,365 DEBUG MessageDatabase: Checkpoint started.\n11 Dec 2014 13:31:05,369 TRACE MessageDatabase: Last update: 1:10975, full gc candidates set: [1]\n11 Dec 2014 13:31:05,370 TRACE MessageDatabase: gc candidates after producerSequenceIdTrackerLocation:1, []\n11 Dec 2014 13:31:05,370 TRACE MessageDatabase: gc candidates after ackMessageFileMapLocation:1, []\n11 Dec 2014 13:31:05,370 TRACE MessageDatabase: gc candidates after tx range:[null, null], []\n11 Dec 2014 13:31:05,370 TRACE MessageDatabase: gc candidates: []\n11 Dec 2014 13:31:05,370 DEBUG MessageDatabase: Checkpoint done.\n11 Dec 2014 13:31:10,390 DEBUG MessageDatabase: Checkpoint started.\n11 Dec 2014 13:31:10,393 DEBUG MessageDatabase: Checkpoint done.\n11 Dec 2014 13:31:15,412 DEBUG MessageDatabase: Checkpoint started.\n11 Dec 2014 13:31:15,415 DEBUG MessageDatabase: Checkpoint done.\n11 Dec 2014 13:31:20,425 DEBUG MessageDatabase: Checkpoint started.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12687245","id":"12687245","filename":"upf-activemq-server-config.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robert.stettler%40capitalone.com","name":"robert.stettler@capitalone.com","key":"robert.stettler@capitalone.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chip Stettler","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-15T15:32:16.514+0000","size":4806,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12687245/upf-activemq-server-config.xml"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"kahadb size grows continually with no queue activity","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robert.stettler%40capitalone.com","name":"robert.stettler@capitalone.com","key":"robert.stettler@capitalone.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chip Stettler","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robert.stettler%40capitalone.com","name":"robert.stettler@capitalone.com","key":"robert.stettler@capitalone.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chip Stettler","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12761129/comment/14243626","id":"14243626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuruidey%40gmail.com","name":"liuruidey@gmail.com","key":"liuruidey@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liurui","active":true,"timeZone":"Etc/UTC"},"body":"I got the same issue ;  Version 5.10.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuruidey%40gmail.com","name":"liuruidey@gmail.com","key":"liuruidey@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liurui","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-12T02:43:29.007+0000","updated":"2014-12-12T02:43:29.007+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12761129/comment/14246731","id":"14246731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Would be good to offer some additional details on your setup, the files in KahaDB dir etc.  To little to go on as it stands so you need to do some more analysis on your end to help us understand what's going on.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-12-15T15:20:29.145+0000","updated":"2014-12-15T15:20:29.145+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12761129/comment/14246788","id":"14246788","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robert.stettler%40capitalone.com","name":"robert.stettler@capitalone.com","key":"robert.stettler@capitalone.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chip Stettler","active":true,"timeZone":"Etc/UTC"},"body":"I attached my activemq config xml.  \n\nAs I was sending this it hit me as to what maybe going on.  I dont know the internals of ActiveMQ or KahaDB, but it appears that one of the two is writing something to the DB even when idle.  If this statement is true then it also makes sense that the size will increase until a journal file is  filled up.  I had mine set to 100kb orginally.  As a test I set the journal size to 1KB.  Now is see the the initialize size was something like 54K.  It increased to 56K but never went beyound that.  It grows and shrinks betweeen 54K and 56K.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robert.stettler%40capitalone.com","name":"robert.stettler@capitalone.com","key":"robert.stettler@capitalone.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chip Stettler","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-15T16:15:25.492+0000","updated":"2014-12-15T16:15:25.492+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12761129/comment/15248383","id":"15248383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"There doesn't seem to be an issue here, the index file size will stabilize as reported, newer versions of the broker have additional fixes and improvements to release older journal logs more reliably.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2016-04-19T18:39:06.798+0000","updated":"2016-04-19T18:39:06.798+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5485/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i23bun:"}}