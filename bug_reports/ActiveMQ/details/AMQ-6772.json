{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13087515","self":"https://issues.apache.org/jira/rest/api/2/issue/13087515","key":"AMQ-6772","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-07-17T10:14:17.461+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 17 14:55:46 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6772/watchers","watchCount":2,"isWatching":false},"created":"2017-07-17T09:03:24.715+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12339772","id":"12339772","name":"5.14.5","archived":false,"released":true,"releaseDate":"2017-04-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-07-17T14:55:46.449+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12331019","id":"12331019","name":"runtime configuration plugin"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have configured the 'runtimeConfigurationPlugin' and started the Active MQ.\n\nThen added the below in policyEntries:\n<policyEntry queue=\"test.configuration.dynamic.update\"  prioritizedMessages=\"true\" useCache=\"false\" expireMessagesPeriod=\"0\" />\n\nAfter saving the config file, I am able to see that the console log got updated saying that config changes are detected and loaded.\n\nWhen tested, however, Message Priority is not being enforced as expected on the queue.\n\nI checked in JConsole, I am not able to update this particular property there either.\n\nIf I restart with the policy configured, the property is getting applied and it is working as expected. It is only not happening if I try to have it updated at run-time.\n\nTim dug into the code, and discovered that the\nPolicyEntry.update() and PolicyEntry.baseUpdate() methods (\nhttps://git-wip-us.apache.org/repos/asf?p=activemq.git;a=blob;f=activemq-broker/src/main/java/org/apache/activemq/broker/region/policy/PolicyEntry.java;h=5b7ff0e184b9e6b4be6cf61ebcacc0a845bb1a6c;hb=HEAD)\ndon't attempt to set any of the three properties being passed in. \n\nPlease fix this so that those attributes will be set when the policy entry is reloaded.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"runtimeConfigurationPlugin - prioritizedMessages property update at Runtime","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akpuvvada","name":"akpuvvada","key":"akpuvvada","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anil P.","active":true,"timeZone":"America/Kentucky/Louisville"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akpuvvada","name":"akpuvvada","key":"akpuvvada","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anil P.","active":true,"timeZone":"America/Kentucky/Louisville"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Unix","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13087515/comment/16089592","id":"16089592","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"the priority support is not a good candidate for runtime modification because not only do the in-memory messages need to  retained in priority memory, the store needs to retrieve and store messages in priority order. For this, the store needs a restart which is not practical.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2017-07-17T10:14:17.461+0000","updated":"2017-07-17T10:14:17.461+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13087515/comment/16089677","id":"16089677","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akpuvvada","name":"akpuvvada","key":"akpuvvada","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anil P.","active":true,"timeZone":"America/Kentucky/Louisville"},"body":"Hi Gary,\n\nThe requirement why we wanted to check run-time update is, if we wanted to create a new queue for a new application and the server is already running with other queues and topics already being used by other application, we don't want to have to restart the server.\nWe want to have the ability to update the configuration with the policy.\nI don't see a way to set this property while creating the queue from Admin UI.\nPlease advise.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akpuvvada","name":"akpuvvada","key":"akpuvvada","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anil P.","active":true,"timeZone":"America/Kentucky/Louisville"},"created":"2017-07-17T11:30:48.556+0000","updated":"2017-07-17T11:31:01.404+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13087515/comment/16089683","id":"16089683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"use a wildcard policy to enable prioritySupport for all queues and disable it selectively if that is required. In that way any new queue will match the wildcard and get priority support.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2017-07-17T11:34:41.663+0000","updated":"2017-07-17T11:34:41.663+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13087515/comment/16089844","id":"16089844","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akpuvvada","name":"akpuvvada","key":"akpuvvada","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anil P.","active":true,"timeZone":"America/Kentucky/Louisville"},"body":"Will disabling work at run-time if enabling does not work?\nIs it not the same Java code that set/resets the run-time configuration?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akpuvvada","name":"akpuvvada","key":"akpuvvada","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anil P.","active":true,"timeZone":"America/Kentucky/Louisville"},"created":"2017-07-17T13:44:37.299+0000","updated":"2017-07-17T13:44:37.299+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13087515/comment/16089937","id":"16089937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"it won't work at all via the runtimeConfigurationPlugin, you will need a wildcard in the default config to enable it for every queue, this then is applied for queues created at runtime in the normal way.\nif you want to selectively disable, you will need to restart. It is a performance tweak to disable it, that may not be relevant in your environment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2017-07-17T14:55:46.449+0000","updated":"2017-07-17T14:55:46.449+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6772/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3hl4n:"}}