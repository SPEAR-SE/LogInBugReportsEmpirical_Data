{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12613211","self":"https://issues.apache.org/jira/rest/api/2/issue/12613211","key":"AMQ-4131","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-11-30T16:28:17.617+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jan 16 21:25:02 UTC 2013","customfield_12310420":"250649","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3261509587_*|*_6_*:*_1_*:*_4655619_*|*_5_*:*_1_*:*_0_*|*_4_*:*_1_*:*_4073949131","customfield_12312321":null,"resolutiondate":"2013-01-16T21:25:02.319+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4131/watchers","watchCount":3,"isWatching":false},"created":"2012-10-23T22:29:48.034+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-01-16T21:25:02.358+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When adding activemq-core as a dependency in a java maven project, the activemq-core pulls in a dependency for activemq-protobuf. However, the activemq-core artifact duplicates all of the classes located in the activemq-protobuf.\n\nDoing a diff between the two jars for activemq-spring-5.7.0.jar and activemq-protobuf-1.1.jar, the following classes are duplicated:\n\n{noformat}\n[WARNING] Found duplicate classes in [org.apache.activemq:activemq-core:5.7.0,org.apache.activemq.protobuf:activemq-protobuf:1.1] :\n[WARNING]   org.apache.activemq.protobuf.AsciiBuffer\n[WARNING]   org.apache.activemq.protobuf.BaseMessage\n[WARNING]   org.apache.activemq.protobuf.Buffer\n[WARNING]   org.apache.activemq.protobuf.BufferInputStream\n[WARNING]   org.apache.activemq.protobuf.BufferOutputStream\n[WARNING]   org.apache.activemq.protobuf.CodedInputStream\n[WARNING]   org.apache.activemq.protobuf.CodedOutputStream\n[WARNING]   org.apache.activemq.protobuf.DeferredDecodeMessage\n[WARNING]   org.apache.activemq.protobuf.InvalidProtocolBufferException\n[WARNING]   org.apache.activemq.protobuf.Message\n[WARNING]   org.apache.activemq.protobuf.MessageBuffer\n[WARNING]   org.apache.activemq.protobuf.MessageBufferSupport\n[WARNING]   org.apache.activemq.protobuf.PBMessage\n[WARNING]   org.apache.activemq.protobuf.UTF8Buffer\n[WARNING]   org.apache.activemq.protobuf.UninitializedMessageException\n[WARNING]   org.apache.activemq.protobuf.WireFormat\n[WARNING]   org.apache.activemq.protobuf.compiler.AltJavaGenerator\n[WARNING]   org.apache.activemq.protobuf.compiler.CommandLineSupport\n[WARNING]   org.apache.activemq.protobuf.compiler.CompilerException\n[WARNING]   org.apache.activemq.protobuf.compiler.EnumDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.EnumFieldDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.ExtensionsDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.FieldDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.IntrospectionSupport\n[WARNING]   org.apache.activemq.protobuf.compiler.JavaGenerator\n[WARNING]   org.apache.activemq.protobuf.compiler.MessageDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.MethodDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.OptionDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.ParserSupport\n[WARNING]   org.apache.activemq.protobuf.compiler.ProtoDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.ProtoMojo\n[WARNING]   org.apache.activemq.protobuf.compiler.ServiceDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.TextFormat\n[WARNING]   org.apache.activemq.protobuf.compiler.TypeDescriptor\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.ParseException\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.ProtoParser\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.ProtoParserConstants\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.ProtoParserTokenManager\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.SimpleCharStream\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.Token\n[WARNING]   org.apache.activemq.protobuf.compiler.parser.TokenMgrError\n{noformat}\n\nactivemq-core is currently packaged incorrectly because of this. This will cause classloader issues as these classes are duplicated. However, luckily the classes are identical, but if something changes down the road it could cause unexpected behavior.\n\nCurrent workaround:\n\n{code:xml}\n<dependency>\n\t<groupId>org.apache.activemq</groupId>\n\t<artifactId>activemq-core</artifactId>\n\t<version>5.7.0</version>\n\t<exclusions>\n\t\t<exclusion>\n\t\t\t<artifactId>activemq-protobuf</artifactId>\n\t\t \t<groupId>org.apache.activemq.protobuf</groupId>\n\t\t</exclusion>\n\t</exclusions>\n</dependency>\n{code}\n\nSuggested fix is to remove the duplicated classes from activemq-core and instead bring them in through the activemq-protobuf dependency.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"62093","customfield_12312823":null,"summary":"Duplicated classes in activemq-core and activemq-protobuf artifacts","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstarker","name":"jstarker","key":"jstarker","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeffrey Starker","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstarker","name":"jstarker","key":"jstarker","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeffrey Starker","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Maven","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12613211/comment/13507421","id":"13507421","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Not sure what you have going on but there's no code overlap here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2012-11-30T16:28:17.617+0000","updated":"2012-11-30T16:28:17.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12613211/comment/13507491","id":"13507491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstarker","name":"jstarker","key":"jstarker","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeffrey Starker","active":true,"timeZone":"America/Los_Angeles"},"body":"Hello, not to be a pain, but I think there is a duplication. Here are more steps to show you what I am talking about. Sorry for being unclear before.\nSteps:\n# Download the activemq-core-5.7.0.jar and activemq-protobuf-1.1.jar via Maven. Using the central maven repository. You can also find them via the web at: http://search.maven.org/remotecontent?filepath=org/apache/activemq/activemq-core/5.7.0/activemq-core-5.7.0.jar and http://search.maven.org/remotecontent?filepath=org/apache/activemq/protobuf/activemq-protobuf/1.1/activemq-protobuf-1.1.jar respectively.\n# Expand the jar files in to a directory:\n{noformat}\njar -xvf activemq-core-5.7.0.jar\njar -xvf activemq-protobuf-1.1.jar\n{noformat}\nYou will notice that the org.apache.activemq.protobuf package is also included in activemq-core-5.7.0.jar file when expanded.\n# After extracting the two jar files, you can do a diff on any file I listed above in the previous comment to show they are identical:\n{code}\ndiff ${directory_of_core_jar_extract}/org/apache/activemq/protobuf/PBMessage.class ${directory_of_protobuf_jar_extract}/org/apache/activemq/protobuf/PBMessage.class\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstarker","name":"jstarker","key":"jstarker","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeffrey Starker","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-11-30T17:45:53.237+0000","updated":"2012-11-30T17:46:35.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12613211/comment/13555473","id":"13555473","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"v5.8 has module refactoring, and should fix any issue you might think exists here. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-01-16T21:25:02.348+0000","updated":"2013-01-16T21:25:02.348+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4131/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0azw7:"}}