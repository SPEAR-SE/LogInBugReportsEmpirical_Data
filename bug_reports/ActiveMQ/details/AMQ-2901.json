{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483551","self":"https://issues.apache.org/jira/rest/api/2/issue/12483551","key":"AMQ-2901","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2010-09-07T11:02:02.388+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Oct 25 09:57:04 UTC 2010","customfield_12310420":"65336","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_29232299680_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-08-11T18:58:27.181+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2901/watchers","watchCount":0,"isWatching":false},"created":"2010-09-07T10:53:27.572+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315623","id":"12315623","description":"version 5 feature complete","name":"5.4.0","archived":false,"released":true,"releaseDate":"2010-08-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-08-11T18:58:27.206+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"recently we upgraded our activeMq instanzes from 5.3.1 to 5.4.0. we also upgraded the client API used in our mule-based services. since that upgrade we are facing with strange reconnet errors. we have a network of brokers with two instances. they are located behinde a hardware loadbalancer over which our clients connect to the brokers. if we restart one of the brokers, the clients connected to it perform a reconnect and are getting linked to the other broker. in our services we use a lot of queues and topics.\n\nit seems that some topics are unable to reconnect randomly. on one of our client machines the reconnect to a durable topic wasn't possible anymore (Root Exception was: Durable consumer is in use for client: myUniqueConnectorName and subscriptionName: myDurableSubscriberName(JMS Code: null). Type: class javax.jms.JMSException ). on the other machine a reconnect to another, non-durable topic (Root Exception was: Channel was inactive for too long: /w.x.y.z:61616. Type: class org.apache.activemq.transport.InactivityIOException ). they did not reconnect at all until the services were restarted.\n\nwe were not having this problems with the version 5.3.1.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461831","id":"12461831","filename":"activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-07T15:26:06.072+0000","size":6763,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461831/activemq.xml"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"119681","customfield_12312823":null,"summary":"Repeating error of client on reconnect","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"redhat linux; java 1.6","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483551/comment/12942830","id":"12942830","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"can you attach the relevant broker and client logs and xml configuration? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-07T11:02:02.388+0000","updated":"2010-09-07T11:02:02.388+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483551/comment/12942876","id":"12942876","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"body":"here is an example error logged at one of our mule instances. it's allways the same error that gets logged:\n\nERROR 2010-09-07 04:03:26,844 [ActiveMQ Connection Executor: tcp:///w.x.y.z:61616] [] [] org.mule.retry.notifiers.ConnectNotifier: Failed to connect/reconnect: jms://topic:my.app.topic\n    Root Exception was: Channel was inactive for too long: /w.x.y.z:61616. Type: class org.apache.activemq.transport.InactivityIOException\n\ni cannot find any error log entry in the logs of the activemq brokers that look to be related to this problem. the xml config of the broker is attached. for the client i do not have one beside the mule configuration. do you want to see this, too?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-07T15:25:00.190+0000","updated":"2010-09-07T15:25:00.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483551/comment/12942894","id":"12942894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"are you using the failover: transport on the Mule side to connect to activemq?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-09T13:37:05.040+0000","updated":"2010-09-09T13:37:05.040+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483551/comment/12943121","id":"12943121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"body":"no we don't. mule implements its own reconnect strategy by using the mul retryPolicies construct.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-13T13:41:42.450+0000","updated":"2010-10-25T09:43:51.551+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483551/comment/12943130","id":"12943130","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"body":"the following looks interessting to me, too. we've got a durable topic consumer configured in our muleInstanze. once the broker dies the durable topic consumer is connected to, the consumer tries to reconnect and gets forwarded to the second broker by the load balancer. the second broker than refuses the connection because it thinks that there is allready a client using the specific durable topic consumer id. this looks to me like the second broker does not know that the first one has died and therefore does not clean up the clientIds which it knows are used for connections to the first broker.\n\nof course the ids used are unique through all instances that are running. heres the log entry from our mule instance:\n\nERROR 2010-10-25 08:46:35,081 [ActiveMQ Connection Executor: tcp:///w.x.y.z:61616] [] [] org.mule.retry.notifiers.ConnectNotifier: Failed to connect/reconnect: jms://topic:our.cool.topic. Root Exception was: Durable consumer is in use for client: ourSystem.activemq-connector.f542389b-624a-4eec-85a7-cecadb5ec4ae and subscriptionName: our.durable.topic.consumer#f542399b-624a-4eec-85a7-cecadb2ec4ae(JMS Code: null). Type: class javax.jms.JMSException","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-25T09:43:07.914+0000","updated":"2010-10-25T09:50:13.614+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483551/comment/12943104","id":"12943104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"body":"facing this problem we are not able to use activeMq as a reliable jms infrastructure....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dialsc","name":"dialsc","key":"dialsc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dirk Alexander Schaefer","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-25T09:57:04.962+0000","updated":"2010-10-25T09:57:04.962+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2901/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ku0n:"}}