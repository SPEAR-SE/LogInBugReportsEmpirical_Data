{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483554","self":"https://issues.apache.org/jira/rest/api/2/issue/12483554","key":"AMQ-2687","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2010-04-09T15:29:18.501+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Aug 23 21:46:56 UTC 2011","customfield_12310420":"63991","customfield_12312320":null,"customfield_12310222":"3_*:*_1_*:*_43388673082_*|*_1_*:*_1_*:*_157720509_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-08-23T21:46:56.403+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2687/watchers","watchCount":3,"isWatching":false},"created":"2010-04-06T21:33:42.827+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315621","id":"12315621","description":"","name":"5.3.1","archived":false,"released":true,"releaseDate":"2010-03-23"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315623","id":"12315623","description":"version 5 feature complete","name":"5.4.0","archived":false,"released":true,"releaseDate":"2010-08-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-08-23T21:46:56.413+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Hi!\n\nI am receiving a NullPointerException when trying to start up activemq after a crash.\n\nThis is similar to http://issues.apache.org/activemq/browse/AMQ-2512 and http://issues.apache.org/activemq/browse/AMQ-2672 with the important difference that I confirmed this happens right now with:\n   5.3.0\n   5.3.1\n   The current TRUNK revision (I tested with revision 931309 from SVN).\n\nAlso, this happens with both the default (store) cursor and fileQueueCursor. (I tried the solution given by Dariusz Szablinski at http://issues.apache.org/activemq/browse/AMQ-2512 but it did not help).\n\nI uploaded the full directory with activemq built from trunk together with the data directory (~85 megs) to: http://rapidshare.com/files/372819396/apache-activemq-5.4-SNAPSHOT_-_svn_trunk_revision_931309_with_crashing_data.tar.gz.html\n\nTo see the issue, just try to start activemq from this distribution.\n\nERROR | Failed to start ActiveMQ JMS Message Broker. Reason: java.lang.NullPointerException\njava.lang.NullPointerException\n        at org.apache.kahadb.index.BTreeNode$BTreeIterator.findNextPage(BTreeNode.java:109)\n        at org.apache.kahadb.index.BTreeNode$BTreeIterator.hasNext(BTreeNode.java:120)\n        at org.apache.activemq.store.kahadb.KahaDBStore$KahaDBMessageStore$4.execute(KahaDBStore.java:222)\n        at org.apache.kahadb.page.Transaction.execute(Transaction.java:728)\n        at org.apache.activemq.store.kahadb.KahaDBStore$KahaDBMessageStore.recover(KahaDBStore.java:219)\n        at org.apache.activemq.broker.region.Queue.initialize(Queue.java:251)\n        at org.apache.activemq.broker.region.DestinationFactoryImpl.createDestination(DestinationFactoryImpl.java:83)\n        at org.apache.activemq.broker.region.AbstractRegion.createDestination(AbstractRegion.java:472)\n        at org.apache.activemq.broker.jmx.ManagedQueueRegion.createDestination(ManagedQueueRegion.java:56)\n        at org.apache.activemq.broker.region.AbstractRegion.addDestination(AbstractRegion.java:123)\n        at org.apache.activemq.broker.region.RegionBroker.addDestination(RegionBroker.java:279)\n        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)\n        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)\n        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)\n        at org.apache.activemq.advisory.AdvisoryBroker.addDestination(AdvisoryBroker.java:157)\n        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)\n        at org.apache.activemq.broker.MutableBrokerFilter.addDestination(MutableBrokerFilter.java:149)\n        at org.apache.activemq.broker.region.AbstractRegion.start(AbstractRegion.java:95)\n        at org.apache.activemq.broker.region.RegionBroker.start(RegionBroker.java:184)\n        at org.apache.activemq.broker.jmx.ManagedRegionBroker.start(ManagedRegionBroker.java:100)\n        at org.apache.activemq.broker.BrokerFilter.start(BrokerFilter.java:155)\n        at org.apache.activemq.broker.scheduler.SchedulerBroker.start(SchedulerBroker.java:85)\n        at org.apache.activemq.broker.TransactionBroker.start(TransactionBroker.java:112)\n        at org.apache.activemq.broker.BrokerFilter.start(BrokerFilter.java:155)\n        at org.apache.activemq.broker.BrokerFilter.start(BrokerFilter.java:155)\n        at org.apache.activemq.broker.BrokerService$3.start(BrokerService.java:1743)\n        at org.apache.activemq.broker.BrokerService.start(BrokerService.java:476)\n        at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:85)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1527)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1468)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1400)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:513)\n...","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172258","customfield_12312823":null,"summary":"NullPointerException at kahadb.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=igorhvr","name":"igorhvr","key":"igorhvr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Igor Hjelmstrom Vinhas Ribeiro","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=igorhvr","name":"igorhvr","key":"igorhvr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Igor Hjelmstrom Vinhas Ribeiro","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483554/comment/12942342","id":"12942342","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"Looks like the btree index became inconsistent.  Access logic looks ok, so I'm suspecting it was the btree update logic that may be at fault.  To help me narrow down the search for the culprit.. could you let us what you were doing /w the broker and how you stopped it?  Were you only producing?  producing and consuming?  Did you stop it with a kill -9 or did you power off the box? etc. etc.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2010-04-09T15:29:18.501+0000","updated":"2010-04-09T15:29:18.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483554/comment/12942171","id":"12942171","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=igorhvr","name":"igorhvr","key":"igorhvr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Igor Hjelmstrom Vinhas Ribeiro","active":true,"timeZone":"Etc/UTC"},"body":"I was running both a producer and a consumer - both working in a queue that had roughly 300.000 messages. I then executed a \"prune\" on that queue... saw it executing for a while (it had erased a few thousand messages already), clicked on \"delete\" (for the same queue), saw the Webconsole hang/stop responding and did a kill -9 in the Java process. After that the queue would no longer start.\n\nLet me know if you need any more info, help, or want me to reproduce it again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=igorhvr","name":"igorhvr","key":"igorhvr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Igor Hjelmstrom Vinhas Ribeiro","active":true,"timeZone":"Etc/UTC"},"created":"2010-04-09T16:24:55.116+0000","updated":"2010-04-09T16:24:55.116+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483554/comment/12942384","id":"12942384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"found a bug in how the recovery log was loaded and applied.  The net effect was that it was never applied because it was always considered inconsistent. Fixed in rev 932537 in trunk.\nIt's a long shot, but it might just fix the issue.  Igor, if you get a chance could you get a trunk update and see if the situation improves?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2010-04-09T18:27:02.421+0000","updated":"2010-04-09T18:27:02.421+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483554/comment/13089791","id":"13089791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Not further reports from the user, closing this.  Reopen if there is still a problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-08-23T21:46:56.411+0000","updated":"2011-08-23T21:46:56.411+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2687/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tujr:"}}