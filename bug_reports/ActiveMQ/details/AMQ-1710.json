{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482697","self":"https://issues.apache.org/jira/rest/api/2/issue/12482697","key":"AMQ-1710","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-09-02T15:15:40.150+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Feb 13 12:00:53 UTC 2009","customfield_12310420":"84589","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_11051773873_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2008-09-10T18:04:16.932+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1710/watchers","watchCount":1,"isWatching":false},"created":"2008-05-05T20:08:03.059+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315615","id":"12315615","description":"","name":"4.1.2","archived":false,"released":true,"releaseDate":"2008-04-14"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-02-13T12:00:53.628+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Recreate steps:\n\n1) Start two brokers in JDBC Master/Slave topology\n\n2) Create an app that puts two or more messages in a queue (two messages are sufficient). Give each message a JMXGroupID to force them to go to the same consumer.\n\n3) Create another app that creates two connection to the broker and on each connection creates a session and a consumer with a unique clientID. Each should attempt to consume messages from the queue defined above.\n\n4) Run the app and when the first message is consumed stop the master. Failover will occur and the slave becomes the new master.\n\n5) Notice that when the transport resumes in the client that received the first message an exception like the following is thrown:\n     javax.jms.JMSException: Transaction 'TX:ID:HOSTNAME-3289-1210016021661-0:1:1' has not been started.\n\n6) Notice that the second consumer now recieves both messages.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461236","id":"12461236","filename":"AMQ-1710.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msiegenthaler","name":"msiegenthaler","key":"msiegenthaler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mario Siegenthaler","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-02T15:15:40.114+0000","size":2393,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461236/AMQ-1710.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461046","id":"12461046","filename":"ASF.LICENSE.NOT.GRANTED--FailoverTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-05T20:08:03.080+0000","size":7954,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461046/ASF.LICENSE.NOT.GRANTED--FailoverTest.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"161819","customfield_12312823":null,"summary":"Failing over in JDBC Master/Slave topology does not preserve transaction state","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Tested on 4.1.1 and 4.1.2","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12939624","id":"12939624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"body":"I've attached a test case that implements the recreate steps described above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-05T20:08:51.210+0000","updated":"2008-05-05T20:08:51.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12939620","id":"12939620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"body":"Forgot to mention the session is transactional. The recreate steps should be amended as follows:\nRecreate steps:\n\n1) Start two brokers in JDBC Master/Slave topology\n\n2) Create an app that puts two or more messages in a queue (two messages are sufficient). Give each message a JMXGroupID to force them to go to the same consumer.\n\n3) Create another app that creates two connections to the broker and on each connection creates a transactional session and a consumer with a unique clientID. Each client consumes messages from the queue defined above waits 60 seconds then commits the transaction.\n\n4) Run the app and when the first message is consumed stop the master before the commit occurs. Failover will occur and the slave becomes the new master.\n\n5) Notice that when the transport resumes in the client that received the first message an exception like the following is thrown:\njavax.jms.JMSException: Transaction 'TX:ID:HOSTNAME-3289-1210016021661-0:1:1' has not been started.\n\n6) Notice that the second consumer now recieves both messages.\n\nI expected the transaction (and the JMXGroupID) to survive across the failover and thus the consumer that retrieves the first message retrieves the seconds one as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=robbugh%40earthlink.net","name":"robbugh@earthlink.net","key":"robbugh@earthlink.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rob Bugh","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-05T20:15:29.366+0000","updated":"2008-05-05T20:15:29.366+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12940129","id":"12940129","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msiegenthaler","name":"msiegenthaler","key":"msiegenthaler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mario Siegenthaler","active":true,"timeZone":"Etc/UTC"},"body":"I propose the attached patch for the issue.\n\nIt allows producers to survive a failover-situation, all my tests so far were successful (all of them run with JDBC-Master/Slave).\n\nWhat I did: During the recovery of the transaction I issue a \"begin transaction\" command (TransactionInfo with TransactionInfo.BEGIN). [actually I add it to the transaction-commands on processBeginTransaction, but it gets issued in the recovery]. So all the recovery-commands following on the transaction (like send message or commit-tx) now can find their transaction and do no longer fail with \"transaction not started\".\n\nI'm not a 100-percent sure what happens in a XA-situation as I didn't have the necessary setup. I suspect it works fine, but with XA you can never be sure.\n\n(the patch applies to version 5.1.0, the problem is the same in 4.1 and 5.x)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msiegenthaler","name":"msiegenthaler","key":"msiegenthaler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mario Siegenthaler","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-02T15:15:40.150+0000","updated":"2008-09-02T15:16:38.871+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12940158","id":"12940158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vadimos","name":"vadimos","key":"vadimos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vadim Katz","active":true,"timeZone":"Etc/UTC"},"body":"Thank you for suggesting a patch, Mario.\nI have applied it but received the following exception in the slave broker\n{code}\n008-09-03 14:49:58,835 [/127.0.0.1:4038] ERROR Service                        - Async error occurred: javax.jms.JMSException: Could not correlate acknowledgment with dispatched message: MessageAck {commandId = 3709, responseRequired = false, ackType = 0, consumerId = ID:VKATZ-XP1-3975-1220478455256-0:0:4:1, firstMessageId = null, lastMessageId = ID:VKATZ-XP1-3975-1220478455256-0:0:26:1:10, destination = queue://convert.input, transactionId = TX:ID:VKATZ-XP1-3975-1220478455256-0:0:10, messageCount = 1}\njavax.jms.JMSException: Could not correlate acknowledgment with dispatched message: MessageAck {commandId = 3709, responseRequired = false, ackType = 0, consumerId = ID:VKATZ-XP1-3975-1220478455256-0:0:4:1, firstMessageId = null, lastMessageId = ID:VKATZ-XP1-3975-1220478455256-0:0:26:1:10, destination = queue://convert.input, transactionId = TX:ID:VKATZ-XP1-3975-1220478455256-0:0:10, messageCount = 1}\n\tat org.apache.activemq.broker.region.PrefetchSubscription.acknowledge(PrefetchSubscription.java:279)\n\tat org.apache.activemq.broker.region.AbstractRegion.acknowledge(AbstractRegion.java:364)\n\tat org.apache.activemq.broker.region.RegionBroker.acknowledge(RegionBroker.java:470)\n\tat org.apache.activemq.broker.TransactionBroker.acknowledge(TransactionBroker.java:194)\n\tat org.apache.activemq.broker.BrokerFilter.acknowledge(BrokerFilter.java:73)\n\tat org.apache.activemq.broker.BrokerFilter.acknowledge(BrokerFilter.java:73)\n\tat org.apache.activemq.broker.MutableBrokerFilter.acknowledge(MutableBrokerFilter.java:84)\n\tat org.apache.activemq.broker.TransportConnection.processMessageAck(TransportConnection.java:443)\n\tat org.apache.activemq.command.MessageAck.visit(MessageAck.java:196)\n\tat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:292)\n\tat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:180)\n\tat org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n\tat org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:143)\n\tat org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:206)\n\tat org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:84)\n\tat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:196)\n\tat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:183)\n\tat java.lang.Thread.run(Thread.java:619)\n{code}\nI've tested it with amq-5.1.0 and spring-2.5.5 with locally transacted session. Also, even though the slave broker becomes active it hangs after throwing the exception and stops accepting new connections.\n\nthanks,\nvadim\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vadimos","name":"vadimos","key":"vadimos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vadim Katz","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-03T22:06:35.397+0000","updated":"2008-09-03T22:07:30.089+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12940203","id":"12940203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msiegenthaler","name":"msiegenthaler","key":"msiegenthaler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mario Siegenthaler","active":true,"timeZone":"Etc/UTC"},"body":"Warning: Do not apply my patch before AMQ-1925 is resolved, else things will go badly wrong (undelivered messages are deleted from the store)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msiegenthaler","name":"msiegenthaler","key":"msiegenthaler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mario Siegenthaler","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-10T09:33:59.389+0000","updated":"2008-09-10T09:33:59.389+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12940215","id":"12940215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Patch code already applied","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-10T18:04:16.912+0000","updated":"2008-09-10T18:04:16.912+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482697/comment/12940733","id":"12940733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhirendra","name":"dhirendra","key":"dhirendra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dhirendra Rai","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\n\nI am using Activemq 5.1.0 and using the master slave configuration with shared file system.\n\nActivemq: Exception is appearing for pending requests when master goes down and slave gets up.\n\nERROR Service - Async error occurred: javax.jms.JMSException: Could not correlate acknowledgment with dispatched message: MessageAck {commandId = 192281, responseRequired = false, ackType = 3, consumerId = ID:mapgl3-49587-1233655489869-0:0:18:1, firstMessageId = null, lastMessageId = ID:mapgl3-49587-1233655489869-0:8:2:1:603, destination = queue://sybase.delivery.queue, transactionId = null, messageCount = 1}\n\njavax.jms.JMSException: Could not correlate acknowledgment with dispatched message: MessageAck {commandId = 192281, responseRequired = false, ackType = 3, consumerId = ID:mapgl3-49587-1233655489869-0:0:18:1, firstMessageId = null, lastMessageId = ID:mapgl3-49587-1233655489869-0:8:2:1:603, destination = queue://sybase.delivery.queue, transactionId = null, messageCount = 1}\n\n        at org.apache.activemq.broker.region.PrefetchSubscription.acknowledge(PrefetchSubscription.java:307)\n\n        at org.apache.activemq.broker.region.AbstractRegion.acknowledge(AbstractRegion.java:364)\n\n        at org.apache.activemq.broker.region.RegionBroker.acknowledge(RegionBroker.java:470)\n\n        at org.apache.activemq.broker.TransactionBroker.acknowledge(TransactionBroker.java:194)\n\n        at org.apache.activemq.broker.BrokerFilter.acknowledge(BrokerFilter.java:73)\n\n        at org.apache.activemq.broker.BrokerFilter.acknowledge(BrokerFilter.java:73)\n\n        at org.apache.activemq.broker.MutableBrokerFilter.acknowledge(MutableBrokerFilter.java:84)\n\n        at org.apache.activemq.broker.TransportConnection.processMessageAck(TransportConnection.java:443)\n\n        at org.apache.activemq.command.MessageAck.visit(MessageAck.java:196)\n\n        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:292)\n\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:180)\n\n        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n\n        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:143)\n\n        at org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:206)\n\n        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:84)\n\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:196)\n\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:183)\n\n        at java.lang.Thread.run(Thread.java:595)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhirendra","name":"dhirendra","key":"dhirendra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dhirendra Rai","active":true,"timeZone":"Etc/UTC"},"created":"2009-02-13T12:00:53.504+0000","updated":"2009-02-13T12:00:53.504+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1710/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0s247:"}}