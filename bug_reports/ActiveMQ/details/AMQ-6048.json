{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12914077","self":"https://issues.apache.org/jira/rest/api/2/issue/12914077","key":"AMQ-6048","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-11-18T12:44:51.020+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 19 18:53:58 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6048/watchers","watchCount":3,"isWatching":false},"created":"2015-11-18T10:37:27.458+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324951","id":"12324951","name":"5.11.0","archived":false,"released":true,"releaseDate":"2015-02-04"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-11-19T18:53:58.218+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We've encountered this incident on ActiveMQ broker wrapper logs where a disconnections happened between the broker and other ActiveMQ service. The network disconnection happened for almost a day and then an outofMemory exception started to appear. Then the connection was re-established and with the other MQ service and broker started to process one file then it hanged and no logs were found afterwards until ActiveMQ broker windows service restarted.\n\nA snap of the error appeared in wrapper.log file :\n\nINFO   | jvm 1    | 2015/10/30 07:58:39 | Exception in thread \"ActiveMQ Failover Worker: 23334009\" java.lang.OutOfMemoryError: unable to create new native thread\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat java.lang.Thread.start0(Native Method)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat java.lang.Thread.start(Thread.java:714)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.thread.TaskRunnerFactory.doExecuteNewThread(TaskRunnerFactory.java:165)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.thread.TaskRunnerFactory.execute(TaskRunnerFactory.java:155)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.thread.TaskRunnerFactory.execute(TaskRunnerFactory.java:146)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.tcp.TcpTransport.doStop(TcpTransport.java:538)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.nio.NIOTransport.doStop(NIOTransport.java:166)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.util.ServiceSupport.stop(ServiceSupport.java:71)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.tcp.TcpTransport.stop(TcpTransport.java:582)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.AbstractInactivityMonitor.stop(AbstractInactivityMonitor.java:145)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.TransportFilter.stop(TransportFilter.java:65)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.WireFormatNegotiator.stop(WireFormatNegotiator.java:91)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.failover.FailoverTransport.doReconnect(FailoverTransport.java:1079)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.transport.failover.FailoverTransport$2.iterate(FailoverTransport.java:149)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:112)\nINFO   | jvm 1    | 2015/10/30 07:58:39 | \tat org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:42)\nINFO   | jvm 1    | 2015/10/30 07:59:39 |  INFO | Successfully reconnected to nio://wps-server1.systems.qa.hsbc:61999\nINFO   | jvm 1    | 2015/10/31 07:01:13 |  INFO | *** Compressing SIF file : 'SIF_10370600_HSB_20151031_0701.CSV'\nINFO   | jvm 1    | 2015/10/31 07:01:14 |  INFO | *** Sending SIF file...\n\nAppreciate if anyone can help in identifying the root cause of the issue.\n\nRegards, ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ActiveMQ broker service hanged after re-establishing the connection with another ActiveMQ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashawish","name":"ashawish","key":"ashawish","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anas Abu Shawish","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashawish","name":"ashawish","key":"ashawish","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anas Abu Shawish","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows server 2003","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12914077/comment/15010912","id":"15010912","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"How is your failover transport configured and can you try 5.11.3 or 5.12.1 to see if that helps?  There was an issue resolved, AMQ-5951, which may or may not be related here that could be blocking the reconnect.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-11-18T12:44:51.020+0000","updated":"2015-11-18T12:46:17.731+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12914077/comment/15010930","id":"15010930","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashawish","name":"ashawish","key":"ashawish","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anas Abu Shawish","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for your reply. Below is my failover configuration as in camel.xml\n\n<bean id=\"jmsConnectionFactoryJFW\" class=\"org.apache.activemq.ActiveMQConnectionFactory\">\n\t\t<property name=\"brokerURL\" value=\"failover:(tcp://${centralipaddress1})?randomize=false&amp;maxReconnectAttempts=-1&amp;jms.prefetchPolicy.all=1\" />\n\t\t<!--<property name=\"brokerURL\" value=\"failover:(nio://192.168.1.50:61999)\">-->\n\t\t<property name=\"userName\" value=\"${centralusername}\"/>\n        <property name=\"password\" value=\"${centralpassword}\"/>\n\t\t<property name=\"redeliveryPolicy\">\n\t\t\t<bean class=\"org.apache.activemq.RedeliveryPolicy\" id=\"myRedeliveryPolicy\">\n\t\t\t\t<property name=\"maximumRedeliveries\" value=\"10\" />\n\t\t\t\t<!--<property name=\"redeliveryDelay\" value=\"60000\" />-->\n\t\t\t\t<property name=\"initialRedeliveryDelay\" value=\"2000\" />\n\t\t\t\t<property name=\"maximumRedeliveryDelay\" value=\"300000\" />\n\t\t\t\t<property name=\"useExponentialBackOff\" value=\"true\" />\n\t\t\t\t<property name=\"backOffMultiplier\" value=\"2\" />\n\t\t\t</bean>\n\t\t</property>\n\t</bean>\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashawish","name":"ashawish","key":"ashawish","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anas Abu Shawish","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-18T12:59:06.334+0000","updated":"2015-11-18T12:59:06.334+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12914077/comment/15014136","id":"15014136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Recommend you retest using the latest release of ActiveMQ v5.12.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-11-19T18:53:58.218+0000","updated":"2015-11-19T18:53:58.218+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6048/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2okmv:"}}