{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12551482","self":"https://issues.apache.org/jira/rest/api/2/issue/12551482","key":"AMQ-3811","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 16 11:27:19 UTC 2012","customfield_12310420":"236290","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2407153802_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-05-16T11:27:19.356+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3811/watchers","watchCount":2,"isWatching":false},"created":"2012-04-18T14:48:05.773+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318549","id":"12318549","name":"5.5.1","archived":false,"released":true,"releaseDate":"2011-10-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-05-16T11:27:19.550+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12315706","id":"12315706","name":"stomp"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Hi,\n\nI am running ActiveMQ brokers with Shared file system Master/Slave configuration and I am seeing the following issue.\n\n1. Start Master and slave brokers.\n2. Start a durable STOMP consumer (Perl/Python) and a producer (Perl/Python) with persistence.\n3. Kill the master broker while the producer is still sending messages.\n4. Our STOMP library takes care of failing over to the new broker automatically and the consumer replays all its subscriptions. So, producer continues to send to the slave broker and consumer also receives all the messages from slave broker.\n5. Stop the producer and consumer.\n6. Restart the consumer with same client-id and subscription name.\n\nAfter this, I see that the consumer received some messages which were already delivered.\n\nThis is easily reproducible with the above mentioned steps. I can clearly see in the broker logs that the slave broker has received acks from the consumer but for some reason it doesn't purge these messages and thinks that the consumer didn't ack them. The messages which were sent to the master broker (before it was killed) were actually getting removed and are not delivered multiple times.\n\nAny help here is greatly appreciated.\n\nThanks a lot!!","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172387","customfield_12312823":null,"summary":"Slave broker in the Master/Slave configuration doesn't process acks of running STOMP consumer and redelivers all the messages if the consumer restarts","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux operating system and Perl/Python STOMP clients.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12551482/comment/13256659","id":"13256659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"body":"Please note that we have tried similar tests with Java clients but this issue doesn't happen there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-04-18T15:50:59.294+0000","updated":"2012-04-18T15:50:59.294+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12551482/comment/13264704","id":"13264704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"body":"Any update on this please?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-04-30T07:38:59.252+0000","updated":"2012-04-30T07:38:59.252+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12551482/comment/13276665","id":"13276665","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"body":"I think this was not an issue on the broker side. I fixed client side code and it started working fine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=buchi","name":"buchi","key":"buchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=buchi&avatarId=29139","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=buchi&avatarId=29139","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=buchi&avatarId=29139","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=buchi&avatarId=29139"},"displayName":"Buchi Reddy B","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-16T11:27:19.464+0000","updated":"2012-05-16T11:27:19.464+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3811/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tvcf:"}}