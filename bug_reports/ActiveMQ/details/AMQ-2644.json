{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483945","self":"https://issues.apache.org/jira/rest/api/2/issue/12483945","key":"AMQ-2644","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2010-03-11T15:59:13.729+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Mar 07 22:00:15 UTC 2011","customfield_12310420":"74860","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_31381174520_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-03-07T22:00:15.121+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2644/watchers","watchCount":0,"isWatching":false},"created":"2010-03-09T17:00:40.617+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-03-07T22:00:15.131+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313893","id":"12313893","name":"Connector"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When attaching a String property to a Message sent on HTTP transport, the consumer gets a latin1 encoded String instead of a UTF-8 String.\n\nBasic scheme :\n\n(producer) message.setStringProperty(\"Test\", \"éèçàù\") => HTTP(s) Transport => Broker => TCP Transport => (consumer) message.getStringProperty(\"Test\")\n\nResult : Ã©Ã¨Ã§Ã Ã¹ (garbage).\n\nWorkaround :\n\nnew String(message.getStringProperty(\"Test\").getBytes(\"ISO-8859-1\"))\n\nSimple test case :\n\nimport javax.jms.Connection;\nimport javax.jms.Message;\nimport javax.jms.MessageConsumer;\nimport javax.jms.MessageProducer;\nimport javax.jms.Session;\n\nimport org.apache.activemq.ActiveMQConnectionFactory;\n\npublic static void main(String[] args) throws Exception {\n\n        String testString = \"éèçàù\";\n\n        ActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory(\"https://localhost:8443\");\n        Connection connection = connectionFactory.createConnection();\n        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n        MessageProducer producer = session.createProducer(session.createQueue(\"TEST\"));\n        connection.start();\n\n        Message message = session.createMessage();\n        message.setStringProperty(\"Test\", testString);\n        System.out.println(\"Original string : \" + testString);\n        producer.send(message);\n\n        connection.close();\n\n        connectionFactory = new ActiveMQConnectionFactory(\"tcp://localhost:9292\");\n        connection = connectionFactory.createConnection();\n        session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);\n        MessageConsumer consumer = session.createConsumer(session.createQueue(\"TEST\"));\n        connection.start();\n\n        while (true) {\n            Message messageReceiver = consumer.receive();\n\n            System.out.println(\"Result string : \" + messageReceiver.getStringProperty(\"Test\"));\n            System.out.println(\"Result string (forced UTF8) : \" + new String(messageReceiver.getStringProperty(\"Test\").getBytes(\"UTF-8\")));\n            System.out\n                    .println(\"Result string (forced ISO-8859-1) : \" + new String(messageReceiver.getStringProperty(\"Test\").getBytes(\"ISO-8859-1\")));\n\n        }\n}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172338","customfield_12312823":null,"summary":"Encoding problem (latin1) with String properties on HTTP Transport","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libert","name":"libert","key":"libert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antoine Libert","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libert","name":"libert","key":"libert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antoine Libert","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"ActiveMQ 5.3.0 win32 RELEASE\nActiveMQ 5.3.0 linux-x64 RELEASE\n\nactivemq-all-5.3.0.jar\ncommons-httpclient-3.1.jar\nxmlpull-1.1.3.4d_b4_min.jar\nxstream-1.3.jar","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483945/comment/12942329","id":"12942329","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Can you try this with the 5.4 SNAPSHOT build?  It should be fixed there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2010-03-11T15:59:13.729+0000","updated":"2010-03-11T15:59:13.729+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483945/comment/13003643","id":"13003643","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Problem seems to have been fixed in 5.4.2, reopen if you still have issues.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-03-07T22:00:15.129+0000","updated":"2011-03-07T22:00:15.129+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2644/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tv1j:"}}