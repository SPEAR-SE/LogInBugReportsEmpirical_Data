{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12738296","self":"https://issues.apache.org/jira/rest/api/2/issue/12738296","key":"AMQ-5340","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329258","id":"12329258","name":"5.12.0","archived":false,"released":true,"releaseDate":"2015-08-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-10-14T02:39:06.521+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Sep 15 12:58:19 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_26628065943_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-07-06T20:49:21.289+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5340/watchers","watchCount":6,"isWatching":false},"created":"2014-09-01T16:08:15.403+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":["QueueBrowser"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324950","id":"12324950","name":"5.10.0","archived":false,"released":true,"releaseDate":"2014-06-10"}],"issuelinks":[{"id":"12395625","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12395625","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12654150","key":"AMQ-4595","self":"https://issues.apache.org/jira/rest/api/2/issue/12654150","fields":{"summary":"QueueBrowser hangs when browsing large queues","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12434125","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12434125","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12855644","key":"AMQNET-505","self":"https://issues.apache.org/jira/rest/api/2/issue/12855644","fields":{"summary":"QueueBrowser should not ignore expired messages","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12431197","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12431197","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12845735","key":"AMQCPP-576","self":"https://issues.apache.org/jira/rest/api/2/issue/12845735","fields":{"summary":"QueueBrowser should not check for expired messages","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-09-15T12:58:19.240+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I would expect browsing a queue with only a few messages to not take a long time. Indeed it normally takes only a few ms. in my application. But sometimes the ActiveMQQueueBrowser hangs for up to 30 seconds at method before returning!\n\nWhen the issue occurs, the loop in hasMoreElements() calls waitForMessage() multiple times which times out after 2s at semaphore.wait(2000) without receiving any message from the broker. I found that when the broker's background job that checks for expired messages runs, the browser happens to be woken even if there are no expired messages. So setting the expireMessagesPeriod to a low value (e.g. 200ms) is a good workaround for this issue, but this is quite brittle because it uses internal broker implementation that may not even be related to the issue!\n\nTo reproduce:\n\n- (this is what I do in my application) create a queue, send a few message with an expiration time of 10 seconds and repeatedly browse it until it is empty. If I browse the queue after these 10 seconds have passed, the issue occurs!\n- I can always reproduce the issue by running AMQ580BrowsingBug from the related bug report AMQ-4595: this browsing test seems to always hang. I slightly adjusted the test so you can easily change the expired messages period and see the runtime differ when changing this.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12665787","id":"12665787","filename":"AMQ5340BrowsingPerformanceBug.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2014-09-01T16:12:22.785+0000","size":4967,"mimeType":"text/x-java-source","content":"https://issues.apache.org/jira/secure/attachment/12665787/AMQ5340BrowsingPerformanceBug.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12741255","id":"12741255","filename":"AMQ5340BrowsingPerformanceBugCorrected.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-23T09:21:08.591+0000","size":5742,"mimeType":"text/x-java-source","content":"https://issues.apache.org/jira/secure/attachment/12741255/AMQ5340BrowsingPerformanceBugCorrected.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12741070","id":"12741070","filename":"AMQ5340BrowsingWithSpring.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-06-22T16:57:02.122+0000","size":5097,"mimeType":"text/x-java-source","content":"https://issues.apache.org/jira/secure/attachment/12741070/AMQ5340BrowsingWithSpring.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"QueueBrowser with expired messages hangs until woken by expired messages background job","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14117526","id":"14117526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"Attached JUnit test that shows the issue. On my machine it runs in 0.7ms when sending 50 messages using EXPIRE_MESSAGES_PERIOD = 200. With EXPIRE_MESSAGES_PERIOD = 10000 and otherwise the same settings it runs in 10.5s, with EXPIRE_MESSAGES_PERIOD = 30000 in 30.5s.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2014-09-01T16:12:22.798+0000","updated":"2014-09-01T16:12:22.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14170401","id":"14170401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GercoDries","name":"GercoDries","key":"gercodries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gerco Dries","active":true,"timeZone":"America/New_York"},"body":"I'm experiencing this issue as well, but my messages are not expiring. Steps to reproduce on AMQ 5.10.0, default configuration - just unzip and run:\n\n # Send a few messages to a queue\n # Browse it repeatedly\n # Observe that on some browse attempts hasMoreMessages() takes a very long time (tens of seconds)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GercoDries","name":"GercoDries","key":"gercodries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gerco Dries","active":true,"timeZone":"America/New_York"},"created":"2014-10-14T02:39:06.521+0000","updated":"2014-10-14T02:39:06.521+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14592505","id":"14592505","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"This is not a problem and is working as intended.  Your issue is that you are using a transaction and you never call commit so your messages are never acknowledged by the broker.  Since your messages are never acknowledged, hasMoreElements() will always return true because the QueueBrowser is never notified that it is done browsing until the expire messages task runs and removes the messages.\n\nIn your test on line 115 when you create your session, if you change {{connection.createSession(true, Session.AUTO_ACKNOWLEDGE)}} to {{connection.createSession(false, Session.AUTO_ACKNOWLEDGE}} then your test will immediately finish and not hang.\n\n If you still want to use a transaction then you need to call commit on the session after you get each element or hasMoreElements() is never going to finish.  So you would change your loop to:\n\n{code:java}\nwhile (enumeration.hasMoreElements()) {\n\tTextMessage m = (TextMessage) enumeration.nextElement();\n\tbrowsed++;\n        session.commit();\n\tLOG.info(\"B[{}]: {}\", browsed, m.getText().substring(0, 100));\n}\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-06-18T21:07:06.830+0000","updated":"2015-06-18T21:07:06.830+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14593593","id":"14593593","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"After talking with [~tabish121] about this issue, I'm going to take a look and see what it would take to change the QueueBrowser behavior so it doesn't participate in a transaction since it doesn't really make sense to be transacted. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-06-19T16:28:48.586+0000","updated":"2015-06-19T16:29:08.181+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14596157","id":"14596157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"[~christopher.l.shannon], following your suggestion for either properly handling transactions or not using transactions solves the issue in the example I created.\n\nWhat is very weird is that the issue still remains in my actual application. I am using standalone Spring (3.2.5.RELEASE, no J2EE container). I use the browseSelected method of a org.springframework.jms.core.JmsTemplate that is configured with an ActiveMQConnectionFactory. As is the default, it does not use a transaction and it uses auto acknowledge.\n\nProblem also remains when I set sessionTransacted to true on the JmsTemplate and call commit after fetching each message.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-22T16:19:25.582+0000","updated":"2015-06-22T16:19:25.582+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14596221","id":"14596221","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"[~slowstrider],\n\nThat is odd because it should work fine.  I just modified your example to use a JmsTemplate and browseSelected to browse the queue and everything works as expected and finishes in less than 1 second.  I went ahead and uploaded my change so you can see what I did.   I'm using Spring version 3.2.11.RELEASE (current version in ActiveMQ's master) ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-06-22T16:58:06.249+0000","updated":"2015-06-22T16:58:06.249+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14596626","id":"14596626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"Thank you for taking the time to solve this issue. Perhaps it's some specific configuration in my setup e.g. in activemq.xml or my Spring configuration which creates the queue. I will see if I can isolate the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-22T20:56:14.895+0000","updated":"2015-06-22T20:56:14.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14597390","id":"14597390","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"I found out what I did wrong. The AMQ5340BrowsingPerformanceBug.java does not reproduce the issue and indeed contains the bug you have mentioned. It does not actually do what I am claiming in the bug description! With a small change I can reproduce the original bug I mentioned:\n\n- set a time to live of 1 second for the messages that are sent\n- set expireMessagesPeriod to 10 seconds\n- repeatedly browse the queue until it is empty, sleeping for 100ms in between\n\nOne would expect this to end after at most 1200 ms or so, but it actually runs for 10 seconds! After all messages have expired enumeration.hasMoreElements() blocks instead of immediately returning false.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-23T09:17:55.500+0000","updated":"2015-06-23T09:17:55.500+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14597396","id":"14597396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"AMQ5340BrowsingPerformanceBugCorrected actually shows the issue I'm experiencing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-23T09:21:08.596+0000","updated":"2015-06-23T09:21:08.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14597402","id":"14597402","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"In summary: after there are expired messages, the queue browser's enumeration.hasMoreElements() blocks until the expired messages are removed by the background job.\n\nThe blocking is unexpected. I would expect the enumeration to immediately return no messages at all, or perhaps alternatively immediately return the expired messages which the background job hasn't removed yet.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-23T09:29:36.074+0000","updated":"2015-06-23T09:30:29.275+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14598109","id":"14598109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"Thanks for submitting your updated test case, I can see where this an issue now.\n\n[~gtully] and [~tabish121],\n\nThis is another interesting issue relating to expired messages.  The problem with this test case is the messages are added to the subscription to be dispatched but when the subscription goes to dispatch them the logic detects the messages are expired so the QueueBrowser client never gets any messages.  Unfortunately, since the QueueBrowser never receives any messages it never sends back any acks and acks are what trigger the logic to send a NULL_MESSAGE signaling the browser is done.  This happens in the iterate method in Queue.\n\nSo basically the QueueBrowser needs some way to know that it will never receive any messages.  The QueueBrowser already calls off to waitForMessage() in the hasMoreElements() so using the pullCommand might work here as that would trigger the NULL_MESSAGE to get sent back.  However, right now a pull command is never sent if prefetch is greater than 0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-06-23T18:14:42.507+0000","updated":"2015-06-23T18:14:42.507+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14598991","id":"14598991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"When the queue has no messages at all the browser returns immediately. This is true before sending any message as well as after the expired messages have been removed by the background job.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-24T07:16:18.285+0000","updated":"2015-06-24T07:16:18.285+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14600956","id":"14600956","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"[~christopher.l.shannon]  - it does not make sense to me that a queue browser would check expiry, it should get a snapshot of messages from its creation time.\nmaybe the simplest thing is to make the expiry check from org.apache.activemq.broker.region.PrefetchSubscription#dispatchPending conditional on not being a browser:                                \n{code} if (!isBrowser()  && node!=QueueMessageReference.NULL_MESSAGE && node.isExpired()) {{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2015-06-25T10:06:40.383+0000","updated":"2015-06-25T10:06:40.383+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14601121","id":"14601121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"[~gtully],\n\nI agree, not checking expiry for browsers makes sense.  This almost works but it appears there is something else that would need to be changed too...The problem is when running the test case against this change, the last run breaks.  The {{enumeration.hasMoreElements()}} returns true but the only thing pending is the NULL control message so then {{enumeration.nextElement()}} returns null.  It's detecting that no new messages were added in the iterate() method in Queue and calling brwoser.decrementQueueRef() which sends the NULL control message.  I haven't looked at it yet to figure out why it's doing that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-06-25T13:03:43.589+0000","updated":"2015-06-25T13:03:43.589+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14614928","id":"14614928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user cshannon opened a pull request:\n\n    https://github.com/apache/activemq/pull/127\n\n    https://issues.apache.org/jira/browse/AMQ-5340\n\n    A QueueBrowser no longer checks expiry on messages to prevent a\n    browser from hanging in between the hasMoreElements check and actually\n    getting a message.  This means that if messages were in the queue when\n    the browser started it will receive messages even if they are now\n    expired. Even though the browser will get the expired message, the\n    broker will still expire it to prevent future access to it.\n\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/cshannon/activemq AMQ-5340\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/activemq/pull/127.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #127\n    \n----\ncommit ebac24a95870fda9de760709ffb5533adaa5c7f7\nAuthor: Christopher L. Shannon <christopher.l.shannon@gmail.com>\nDate:   2015-07-06T02:11:23Z\n\n    https://issues.apache.org/jira/browse/AMQ-5340\n    \n    A QueueBrowser no longer checks expiry on messages to prevent a\n    browser from hanging in between the hasMoreElements check and actually\n    getting a message.  This means that if messages were in the queue when\n    the browser started it will receive messages even if they are now\n    expired. Even though the browser will get the expired message, the\n    broker will still expire it to prevent future access to it.\n    \n    Thanks to Henno Vermeulen for providing a test case.\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-06T11:50:31.798+0000","updated":"2015-07-06T11:50:31.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14614930","id":"14614930","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"I finally got some time to come back to this.  I created a PR so that a queue browser now ignores expiration but the broker will still expire the message on dispatch.  This way the browser will get a snapshot when started and prevent it from hanging but any future calls (a new browser, etc) won't get the messages as they have expired on the broker end.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2015-07-06T11:53:14.544+0000","updated":"2015-07-06T11:53:14.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14615582","id":"14615582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/activemq/pull/127\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-06T20:23:18.735+0000","updated":"2015-07-06T20:23:18.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14615633","id":"14615633","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Fix applied, thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-07-06T20:49:21.322+0000","updated":"2015-07-06T20:49:21.322+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12738296/comment/14745411","id":"14745411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"Thank you for solving this, I upgraded to ActiveMQ 5.12.0 and my tests now succeed while they fail in 5.10.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2015-09-15T12:58:19.240+0000","updated":"2015-09-15T12:58:19.240+0000"}],"maxResults":19,"total":19,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5340/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1zk2f:"}}