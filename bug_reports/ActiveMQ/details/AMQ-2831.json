{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483467","self":"https://issues.apache.org/jira/rest/api/2/issue/12483467","key":"AMQ-2831","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315624","id":"12315624","description":"Maintenance release for 5.4.0","name":"5.4.1","archived":false,"released":true,"releaseDate":"2010-09-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-09-01T10:25:10.016+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Sep 01 10:27:38 UTC 2010","customfield_12310420":"74780","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_4055768654_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2010-09-01T10:25:10.030+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2831/watchers","watchCount":1,"isWatching":false},"created":"2010-07-16T11:49:01.376+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315622","id":"12315622","description":"","name":"5.3.2","archived":false,"released":true,"releaseDate":"2010-05-11"}],"issuelinks":[{"id":"12335024","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12335024","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"},"outwardIssue":{"id":"12483855","key":"AMQ-2764","self":"https://issues.apache.org/jira/rest/api/2/issue/12483855","fields":{"summary":"For \"duplex\" network connection,  after restart one ActiveMQ,  message is missing.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-09-01T10:27:38.315+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have a client that do a durable subscriptio to a topic.\nIt register with a static client id.\n\nAfter a connectivity loss (an so a new re-connection), this exception is thrown and connection cannot be\nre-established:\n\n2010-07-15 13:49:04,700 ERROR - javax.jms.InvalidClientIDException: Broker: localhost - Client: (SchedulerId = '1') already connected from blockingQueue_8461294\n        at org.apache.activemq.broker.region.RegionBroker.addConnection(RegionBroker.java:216)\n        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n        at org.apache.activemq.advisory.AdvisoryBroker.addConnection(AdvisoryBroker.java:77)\n        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n....\n\nThis is not possible, because is the only client with that name and previos connection was closed . .close().\n\nIf I kill all the clients an I leave active only the broker,\nIf I try to reconnect using http (or tcp) I get the same error.\nSo client is not de-registered.\nThis appens also if I use failover protocol. After client kill/restart. Same exception is raised (javax.jms.InvalidClientIDException - with the clientID of the killed client).\n\nI have to restart broker in order to register again the client. \n\nA test case is attached. \nIf you connect to http the first time, connection is ok.\nIf you kill the JVM and the try to restart the test case, 'myclid already connected from blockingQueue_' is always raised. Also after some hours. I have to restart the broker in order to have a new conection with that client id.\n\nThis test simulate a JVM crash with no resource cleanup.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461768","id":"12461768","filename":"broker-config.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"created":"2010-07-16T11:50:48.066+0000","size":3854,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461768/broker-config.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461767","id":"12461767","filename":"TestVaseClientID.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"created":"2010-07-16T11:49:50.321+0000","size":655,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461767/TestVaseClientID.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"159775","customfield_12312823":null,"summary":"Set ClientID - InvalidClientIDException with http transport","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483467/comment/12942425","id":"12942425","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"body":"Test case class","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"created":"2010-07-16T11:49:50.372+0000","updated":"2010-07-16T11:49:50.372+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483467/comment/12942424","id":"12942424","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"body":"Broker configuration","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"created":"2010-07-16T11:50:48.125+0000","updated":"2010-07-16T11:50:48.125+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483467/comment/12942810","id":"12942810","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"body":"And related to this bug, I can report a related problem.\nThe http transport maintains a cache of the connected clients and doesn't flush it. If I restart the client, It cannot reconnect until I restart the broker:\n\njavax.jms.JMSException: Could not connect to broker URL: http://server:61617/broker003. Reason: java.io.IOException: Failed to perform GET on: http://server:61617/broker003 as response was: 400\nat org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:35)\nat org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:286)\nat org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:230)\nat org.apache.activemq.ActiveMQConnectionFactory.createConnection(ActiveMQConnectionFactory.java:178)\n....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rjtokenlanring","name":"rjtokenlanring","key":"rjtokenlanring","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Colombo Marco","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-01T07:49:32.835+0000","updated":"2010-09-01T07:49:32.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483467/comment/12942808","id":"12942808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"The http transport now has an inactivity monitor, configure the http transport url with a low inactivity timeout value and the server end of the http transport will timeout when the client jvm crashes.\n\n{code}http://localhost:61617??transport.readCheckTime=4000&amp;transport.initialDelayTime=4000{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-01T10:25:10.016+0000","updated":"2010-09-01T10:25:10.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483467/comment/12942809","id":"12942809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"This issue is resolved by the fix for AMQ-2764","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-01T10:27:38.299+0000","updated":"2010-09-01T10:27:38.299+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2831/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0rphz:"}}