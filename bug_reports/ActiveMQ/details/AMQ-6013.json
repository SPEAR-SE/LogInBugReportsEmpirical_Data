{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12905534","self":"https://issues.apache.org/jira/rest/api/2/issue/12905534","key":"AMQ-6013","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12333254","id":"12333254","name":"5.11.3","archived":false,"released":true,"releaseDate":"2015-11-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329848","id":"12329848","name":"5.13.0","archived":false,"released":true,"releaseDate":"2015-12-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12333874","id":"12333874","name":"5.12.2","archived":false,"released":true,"releaseDate":"2016-01-11"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-10-16T13:46:42.732+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Apr 26 01:03:51 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_820310_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-10-16T13:53:58.122+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6013/watchers","watchCount":10,"isWatching":false},"created":"2015-10-16T13:40:17.843+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329258","id":"12329258","name":"5.12.0","archived":false,"released":true,"releaseDate":"2015-08-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-10T13:36:09.754+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"At some points we do (de)serialization of JMS Object messages inside the broker (HTTP, Stomp, Web Console, ...). We need to restrict classes that can be serialized in this way.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Restrict classes that can be serialized in ObjectMessages","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/14960723","id":"14960723","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit a7e2a44fe8d4435ae99532eb0ab852e6247f7b16 in activemq's branch refs/heads/master from [~dejanb]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=a7e2a44 ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6013 - restrict classes which can be serialized inside the broker\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-16T13:46:42.732+0000","updated":"2015-10-16T13:46:42.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/14960741","id":"14960741","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"The classes are restricted by default to the following packages\n\n{code}java.lang\njava.util\norg.apache.activemq\norg.fusesource.hawtbuf\ncom.thoughtworks.xstream.mapper{code}\n\nwhich are needed for normal functioning of http and stomp packages. If you need to send object messages via http, you need to add desired packages. You can do that with by using {{org.apache.activemq.SERIALIZABLE_PACKAGES}} system property. For example:\n\n{code}-Dorg.apache.activemq.SERIALIZABLE_PACKAGES=\"java.lang,java.util,org.apache.activemq,org.fusesource.hawtbuf,com.thoughtworks.xstream.mapper,com.mycompany.myapp\"{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2015-10-16T13:53:58.145+0000","updated":"2015-10-16T13:54:30.488+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/14964943","id":"14964943","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit e100638244c4ca5eb2a1f16bcdc671c9859c2694 in activemq's branch refs/heads/master from [~dejanb]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=e100638 ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6013 - init serializable packages statically\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-20T10:31:09.376+0000","updated":"2015-10-20T10:31:09.376+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/14978442","id":"14978442","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 6f03921b31d9fefeddb0f4fa63150ed1f94a14b1 in activemq's branch refs/heads/activemq-5.11.x from [~dejanb]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=6f03921 ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6013 - restrict classes which can be serialized inside the broker\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-28T13:43:44.323+0000","updated":"2015-10-28T13:43:44.323+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/14978443","id":"14978443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 73a0caf758f9e4916783a205c7e422b4db27905c in activemq's branch refs/heads/activemq-5.11.x from [~dejanb]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=73a0caf ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6013 - init serializable packages statically\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-28T13:43:45.274+0000","updated":"2015-10-28T13:43:45.274+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15004213","id":"15004213","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"body":"I'd expect you'd want to check if the class is allowed based on its name before loading it in case it has static initialization code that does something unwanted.\nLoading the allowed packages list only once might be considerably more efficient.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-11-13T16:28:01.771+0000","updated":"2015-11-13T16:28:01.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15004318","id":"15004318","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Hi David,\nyes, it makes sense to check security only on the class name without loading it. Thanks for that, I'll fix it on Monday. I'll need to check how XStream is doing it and if this problem exists there as well.\n\nAs for loading the list only once, it's done by the second commit so that should be in there already. Let me know if you thought of something else, or I missed something.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2015-11-13T17:15:10.089+0000","updated":"2015-11-13T17:15:10.089+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15006631","id":"15006631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Hi David,\n\nI looked at this some more and I don't think we have a problem. If you take a look at\n\nhttps://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/util/ClassLoadingAwareObjectInputStream.java#L125\n\nwe load the class without initializing it (second parameter is false), so the static code is not executed until the class if used the first time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2015-11-16T12:54:47.887+0000","updated":"2015-11-16T12:54:47.887+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15011304","id":"15011304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit d7a3b9406b8496c3f1508bebf3c7ff5367374b90 in activemq's branch refs/heads/master from [~gtully]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=d7a3b94 ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6029 - make certs available to tunnle servlet - HttpsNeedClientAuthSendAndReceiveTest regression, add javax.security so login exceptions can propogate over http - https://issues.apache.org/jira/browse/AMQ-6013\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-18T16:21:37.972+0000","updated":"2015-11-18T16:21:37.972+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15038278","id":"15038278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit e7a4b53f799685e337972dd36ba0253c04bcc01f in activemq's branch refs/heads/activemq-5.12.x from [~dejanb]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=e7a4b53 ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6013 - restrict classes which can be serialized inside the broker\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-03T18:39:09.078+0000","updated":"2015-12-03T18:39:09.078+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15038279","id":"15038279","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 7eb9b218b2705cf9273e30ee2da026e43b6dd4e0 in activemq's branch refs/heads/activemq-5.12.x from [~dejanb]\n[ https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=7eb9b21 ]\n\nhttps://issues.apache.org/jira/browse/AMQ-6013 - init serializable packages statically\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-03T18:39:09.959+0000","updated":"2015-12-03T18:39:09.959+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15040437","id":"15040437","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=3riverdev","name":"3riverdev","key":"3riverdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=3riverdev&avatarId=21636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=3riverdev&avatarId=21636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=3riverdev&avatarId=21636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=3riverdev&avatarId=21636"},"displayName":"Brett E. Meyer","active":true,"timeZone":"Etc/GMT+5"},"body":"Is there any explanation available for why this change was made?  Why are the restrictions necessary?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=3riverdev","name":"3riverdev","key":"3riverdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=3riverdev&avatarId=21636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=3riverdev&avatarId=21636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=3riverdev&avatarId=21636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=3riverdev&avatarId=21636"},"displayName":"Brett E. Meyer","active":true,"timeZone":"Etc/GMT+5"},"created":"2015-12-04T05:51:14.394+0000","updated":"2015-12-04T05:51:14.394+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15043298","id":"15043298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbechler","name":"mbechler","key":"mbechler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Moritz Bechler","active":true,"timeZone":"Europe/Berlin"},"body":"Btw, you might want to have a look at your own org.apache.activemq.web.WebClient (as this is still on the whitelist). Have not checked under which conditition the static factory gets initialized exactly (it seems to be for the web console), but one can certainly do some mischief (I'd say mainly DOS) if it is.\n\nI'd also suggest that you announce this change in a much more prominent way (maybe even get a CVE for it), as it both has very serious security implications if it goes unpatched and also very well might break some peoples code. And you should also make it very clear that one should be very careful what to add to the whitelist.\n\nTo answer Brett (as a third party):\nJava deserialization on not completely trusted input is inherently dangerous. The amount of code reachable by just deseralizing some input is insane. There are many instances where developers are careless (or even simply don't care) what can be done with their deserialization routines (also there can be nasty interactions between different pieces of code) and the default deserialization routine allows one to use anything you have on your classpath. We have seen three major libraries contain code that leads to remote arbitrary code execution. And there are more to come.\nImho, we really need to either fix the primitive or drop it from all the specs that are/allow using it in potentially dangerous way.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbechler","name":"mbechler","key":"mbechler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Moritz Bechler","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-05T12:55:59.835+0000","updated":"2015-12-05T12:55:59.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15045216","id":"15045216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=3riverdev","name":"3riverdev","key":"3riverdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=3riverdev&avatarId=21636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=3riverdev&avatarId=21636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=3riverdev&avatarId=21636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=3riverdev&avatarId=21636"},"displayName":"Brett E. Meyer","active":true,"timeZone":"Etc/GMT+5"},"body":"Fair enough on the reasoning -- makes sense.  However, I'd definitely agree that this fix needs to be announced through several channels, since it's a breaking change for many users.\n\nAlso consider supporting additional means to set org.apache.activemq.SERIALIZABLE_PACKAGES (other than a system property), perhaps through a ActiveMQComponent property, etc.\n\nAdditionally, provide logging on startup that communicates the restriction and how to customize it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=3riverdev","name":"3riverdev","key":"3riverdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=3riverdev&avatarId=21636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=3riverdev&avatarId=21636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=3riverdev&avatarId=21636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=3riverdev&avatarId=21636"},"displayName":"Brett E. Meyer","active":true,"timeZone":"Etc/GMT+5"},"created":"2015-12-07T16:44:21.893+0000","updated":"2015-12-07T16:45:29.323+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15046700","id":"15046700","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Brett, yes we already discussed this on the dev list and decided to tackle this problem. I raised [AMQ-6077] for this work and we should address it with 5.13.1 release.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-08T10:27:04.774+0000","updated":"2015-12-08T10:27:04.774+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15046701","id":"15046701","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iali","name":"iali","key":"iali","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Imran Ali","active":true,"timeZone":"Etc/UTC"},"body":"Based on [~mbechler] comment:  \nCan you please confirm if this fix is also based on \nhttp://cwe.mitre.org/data/definitions/502.html\n\nfor following CVEs\nCVE-2015-8103 and CVE-2015-4852\n\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8103\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4852\n\nIf so you are right as a note on Vulnerability Notes Database suggest following\n{quote}\nDevelopers need to re-architect their applications, and should be suspicious of deserialized data from untrusted sources\n{quote}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iali","name":"iali","key":"iali","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Imran Ali","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-08T10:27:22.090+0000","updated":"2015-12-08T10:27:22.090+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15046712","id":"15046712","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Imran, yes it's the same root of the issue. I'm working on documenting and disclosing everything, so more information will be available in the coming days.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-08T10:42:56.753+0000","updated":"2015-12-08T10:42:56.753+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15046732","id":"15046732","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbechler","name":"mbechler","key":"mbechler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Moritz Bechler","active":true,"timeZone":"Europe/Berlin"},"body":"Yes, that's correct.\n\nThere has been some discussion about how to assign CVE's for these issues on oss-security that imho has not really come to a sensible conclusion (these both directly refer to commons-collections, I think we should have a more general one). If you don't want to go through that again, I think refering to CVE-2015-4852 would be most appropriate choice (at least Oracle has suggested that they are okay with it's reuse: http://seclists.org/oss-sec/2015/q4/306). \nMaybe you should check back with the Apache Security Team to see what's their opinion on this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbechler","name":"mbechler","key":"mbechler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Moritz Bechler","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-08T10:54:45.260+0000","updated":"2015-12-08T10:54:45.260+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15047070","id":"15047070","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"This issue is related to CVE-2015-5254 as described at http://activemq.apache.org/security-advisories.data/CVE-2015-5254-announcement.txt","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-08T17:02:40.641+0000","updated":"2015-12-08T17:02:40.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12905534/comment/15983941","id":"15983941","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=trejkaz","name":"trejkaz","key":"trejkaz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trejkaz","active":true,"timeZone":"Etc/UTC"},"body":"The commit to fix this makes serializablePackages a public mutable array:\n\n{code}\n    public static final String[] serializablePackages;\n{code}\n\nThat in itself is not the best idea for security.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=trejkaz","name":"trejkaz","key":"trejkaz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trejkaz","active":true,"timeZone":"Etc/UTC"},"created":"2017-04-26T01:03:51.164+0000","updated":"2017-04-26T01:03:51.164+0000"}],"maxResults":20,"total":20,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6013/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2n4bb:"}}