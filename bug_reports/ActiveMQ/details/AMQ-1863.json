{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483079","self":"https://issues.apache.org/jira/rest/api/2/issue/12483079","key":"AMQ-1863","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315618","id":"12315618","description":"","name":"5.1.0","archived":false,"released":true,"releaseDate":"2008-05-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-08-14T17:45:07.525+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Aug 14 12:52:56 UTC 2009","customfield_12310420":"84411","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2085864049_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2008-08-14T17:45:07.527+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1863/watchers","watchCount":1,"isWatching":false},"created":"2008-07-21T14:20:43.478+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315612","id":"12315612","description":"","name":"4.0.2","archived":false,"released":true,"releaseDate":"2006-07-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-08-14T13:10:01.836+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have web client which uses jetty configured through servicemix which intermittently throws an activemq.transport.InactivityIOException. The problem is reported in a solaris environment and I have been able to reproduce this issue with Redhat Linux AdvancedServer 2.1 after an extended period of no web client activity for about 2 days.\n\nI have tried setting maxInactivityDuration = 0 (at the web client end) and have also tried applying the patch (changes to Transport.InactivityMonitor.java) mentioned in AMQ-1146 to 4.0.2 but the issue still occurs.\n\nIt appears that this issue has been ongoing as there are similar issues resolved in 5.1.\n\nIs this issue resolved in 4.1 or must I upgrade to 5.1 to resolve this issue?\n\nBelow is exception message from the servicemix.log and the activemq.xml confguration file is attached.\n\n15:25:19,414 | WARN  | btpool0-10922 | jetty                    | ervicemix.http.jetty.JCLLogger   93 | /ecli/: \njava.lang.Exception: org.springframework.jms.UncategorizedJmsException: Uncategorized exception occured during JMS processing; nested exception is org.apache.activemq.ConnectionFailedException: The JMS connection has failed: Channel was inactive for too long.; nested exception is org.apache.activemq.transport.InactivityIOException: Channel was inactive for too long.\n\tat org.apache.servicemix.http.processors.ConsumerProcessor.process(ConsumerProcessor.java:202)\n\tat org.apache.servicemix.http.HttpBridgeServlet.doPost(HttpBridgeServlet.java:71)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:615)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:688)\n\tat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:443)\n\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:356)\n\tat org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:179)\n\tat org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:615)\n\tat org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:149)\n\tat org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:123)\n\tat org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:141)\n\tat org.mortbay.jetty.Server.handle(Server.java:269)\n\tat org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:430)\n\tat org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:333)\n\tat org.mortbay.jetty.nio.HttpChannelEndPoint.run(HttpChannelEndPoint.java:270)\n\tat org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:475)\nCaused by: org.springframework.jms.UncategorizedJmsException: Uncategorized exception occured during JMS processing; nested exception is org.apache.activemq.ConnectionFailedException: The JMS connection has failed: Channel was inactive for too long.; nested exception is org.apache.activemq.transport.InactivityIOException: Channel was inactive for too long.\n\tat org.springframework.jms.support.JmsUtils.convertJmsAccessException(JmsUtils.java:194)\n\tat org.springframework.jms.support.JmsAccessor.convertJmsAccessException(JmsAccessor.java:162)\n\tat org.springframework.jms.core.JmsTemplate.execute(JmsTemplate.java:432)\n\tat org.springframework.jms.core.JmsTemplate.send(JmsTemplate.java:485)\n\tat org.springframework.jms.core.JmsTemplate.send(JmsTemplate.java:471)\n\tat org.apache.servicemix.components.jms.JmsSenderComponent.process(JmsSenderComponent.java:81)\n\tat org.apache.servicemix.components.util.OutBinding.onMessageExchange(OutBinding.java:49)\n\tat org.apache.servicemix.jbi.messaging.DeliveryChannelImpl.processInBound(DeliveryChannelImpl.java:624)\n\tat org.apache.servicemix.jbi.nmr.flow.AbstractFlow.doRouting(AbstractFlow.java:169)\n\tat org.apache.servicemix.jbi.nmr.flow.seda.SedaFlow.doRouting(SedaFlow.java:177)\n\tat org.apache.servicemix.jbi.nmr.flow.seda.SedaQueue$1.run(SedaQueue.java:227)\n\tat org.apache.geronimo.connector.work.WorkerContext.run(WorkerContext.java:291)\n\tat EDU.oswego.cs.dl.util.concurrent.PooledExecutor$Worker.run(Unknown Source)\n\tat java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.activemq.ConnectionFailedException: The JMS connection has failed: Channel was inactive for too long.\n\tat org.apache.activemq.ActiveMQConnection.checkClosedOrFailed(ActiveMQConnection.java:1171)\n\tat org.apache.activemq.ActiveMQConnection.createSession(ActiveMQConnection.java:270)\n\tat org.apache.activemq.pool.SessionPool.createSession(SessionPool.java:112)\n\tat org.apache.activemq.pool.SessionPool.makeObject(SessionPool.java:80)\n\tat org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:771)\n\tat org.apache.activemq.pool.SessionPool.borrowSession(SessionPool.java:55)\n\tat org.apache.activemq.pool.ConnectionPool.createSession(ConnectionPool.java:70)\n\tat org.apache.activemq.pool.PooledConnection.createSession(PooledConnection.java:129)\n\tat org.springframework.jms.core.JmsTemplate.createSession(JmsTemplate.java:826)\n\tat org.springframework.jms.core.JmsTemplate.execute(JmsTemplate.java:420)\n\t... 11 more\nCaused by: org.apache.activemq.transport.InactivityIOException: Channel was inactive for too long.\n\tat org.apache.activemq.transport.InactivityMonitor.readCheck(InactivityMonitor.java:101)\n\tat org.apache.activemq.transport.InactivityMonitor.access$000(InactivityMonitor.java:35)\n\tat org.apache.activemq.transport.InactivityMonitor$1.run(InactivityMonitor.java:51)\n\tat edu.emory.mathcs.backport.java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:431)\n\tat edu.emory.mathcs.backport.java.util.concurrent.FutureTask.runAndReset(FutureTask.java:198)\n\tat edu.emory.mathcs.backport.java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:189)\n\tat edu.emory.mathcs.backport.java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:213)\n\tat edu.emory.mathcs.backport.java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat edu.emory.mathcs.backport.java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\t... 1 more","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461168","id":"12461168","filename":"ASF.LICENSE.NOT.GRANTED--activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dingratta","name":"dingratta","key":"dingratta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"don ingratta","active":true,"timeZone":"Etc/UTC"},"created":"2008-07-21T14:20:43.522+0000","size":2537,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461168/ASF.LICENSE.NOT.GRANTED--activemq.xml"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"119688","customfield_12312823":null,"summary":"org.apache.activemq.transport.InactivityIOException: Channel was inactive for too long","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dingratta","name":"dingratta","key":"dingratta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"don ingratta","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dingratta","name":"dingratta","key":"dingratta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"don ingratta","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"RedHat Linux","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483079/comment/12940061","id":"12940061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"This is fixed in 5.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2008-08-14T17:45:07.525+0000","updated":"2008-08-14T17:45:07.525+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483079/comment/12941258","id":"12941258","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=activemq_user","name":"activemq_user","key":"activemq_user","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"john","active":true,"timeZone":"Etc/UTC"},"body":"You told that the bug has been fixed in 5.1 version. I'm actually using the 5.2 version and it's still not working... \nCan you confirm that it's really fixed in 5.2 version please?\n\nWe are using Mule 2.2 \nhere is my activemq config  file:\n\n<beans \n  xmlns=\"http://www.springframework.org/schema/beans\"\n  xmlns:context=\"http://www.springframework.org/schema/context\"\n  xmlns:amq=\"http://activemq.apache.org/schema/core\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"\n  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd\n  http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd\n  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core-5.2.0.xsd\">\n\n  <amq:broker brokerName=\"amqBroker\" useJmx=\"true\" persistent=\"true\">\n    \n    <amq:persistenceAdapter>\n      <amq:kahaPersistenceAdapter directory=\"activemq-data\" maxDataFileLength=\"33554432\" />\n    </amq:persistenceAdapter>\n    \n    <amq:transportConnectors>\n      <amq:transportConnector  uri=\"tcp://localhost:61616?jms.watchTopicAdvisories=false\" />\n    </amq:transportConnectors>\n  </amq:broker> \n  \n</beans>\n\n\nHere is the stack trace with activemq 4.1 :\n\nCaused by: org.apache.activemq.transport.InactivityIOException: Channel was inactive for too long.\n at org.apache.activemq.transport.InactivityMonitor.readCheck(InactivityMonitor.java:101)\n at org.apache.activemq.transport.InactivityMonitor.access$000(InactivityMonitor.java:35)\n at org.apache.activemq.transport.InactivityMonitor$1.run(InactivityMonitor.java:51)\n at edu.emory.mathcs.backport.java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:442)\n at edu.emory.mathcs.backport.java.util.concurrent.FutureTask.runAndReset(FutureTask.java:200)\n at edu.emory.mathcs.backport.java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:151)\n at edu.emory.mathcs.backport.java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:263)\n\n\nHere is the stack trace with activemq 5.2 :\n\nCaused by: org.apache.activemq.transport.InactivityIOException: Channel was inactive for too long: localhost/127.0.0.1:61616\n    at org.apache.activemq.transport.InactivityMonitor.oneway(InactivityMonitor.java:225)\n    at org.apache.activemq.transport.TransportFilter.oneway(TransportFilter.java:83)\n    at org.apache.activemq.transport.WireFormatNegotiator.oneway(WireFormatNegotiator.java:100)\n    at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n    at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:60)\n    at org.apache.activemq.ActiveMQConnection.doAsyncSendPacket(ActiveMQConnection.java:1214)\n\n\nthanks a lot for your response.\n\n  John\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=activemq_user","name":"activemq_user","key":"activemq_user","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"john","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-14T12:52:56.620+0000","updated":"2009-08-14T13:10:01.833+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1863/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ku27:"}}