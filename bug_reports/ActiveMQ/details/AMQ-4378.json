{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12637214","self":"https://issues.apache.org/jira/rest/api/2/issue/12637214","key":"AMQ-4378","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2013-04-11T20:15:20.534+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Aug 26 16:58:59 UTC 2013","customfield_12310420":"317706","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_11320533317_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-07-24T16:18:27.290+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4378/watchers","watchCount":5,"isWatching":false},"created":"2013-03-15T15:42:54.017+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":["documentation"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-08-26T16:58:59.520+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313894","id":"12313894","name":"Documentation"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313895","id":"12313895","name":"Message Store"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"The documentation at http://activemq.apache.org/shared-file-system-master-slave.html says that OCFS2 does not work, saying \n\n\"OCFS2 only supports locking with 'fcntl' and not 'lockf and flock', therefore mutex file locking from Java isn't supported.\" \n\nHowever, based on my reading of the OpenJDK source, Java uses fcntl, not flock and this statement is incorrect.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"318047","customfield_12312823":null,"summary":"Documentation on Shared File System Master Slave wrong or out of date","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jliptak","name":"jliptak","key":"jliptak","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Liptak","active":true,"timeZone":"America/Denver"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jliptak","name":"jliptak","key":"jliptak","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Liptak","active":true,"timeZone":"America/Denver"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637214/comment/13629298","id":"13629298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"If you have OCFS2 handy the only way to know for sure is to \"ask the computer\". Start two broker instances and see if they both think they are masters. I don't know history of that section of the doc, but I assume it was added in good faith based on a real test.\nwould be great to know we can work with OCFS2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-11T20:15:20.534+0000","updated":"2013-04-11T20:15:20.534+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637214/comment/13718531","id":"13718531","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No feedback from the submitter to validate these assertions. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-07-24T16:18:27.310+0000","updated":"2013-07-24T16:18:27.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637214/comment/13750217","id":"13750217","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceharris","name":"ceharris","key":"ceharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceharris&avatarId=32478","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceharris&avatarId=32478","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceharris&avatarId=32478","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceharris&avatarId=32478"},"displayName":"Carl Harris","active":true,"timeZone":"America/New_York"},"body":"\nI just ran into this issue and since the original submitter has not provided feedback, I decided to post my findings.\n\nThe cited documentation is at least somewhat incorrect, in that OCFS2 lock support is not quite as cut and dried as the documentation suggests.  Moreover, the documentation makes incorrect references to the supported lock types for OCFS2.\n\nReference [1], Section III (New Features) item 10 (Clustered flock(2)) on page 12, states that \"the flock(2) call is now cluster-aware.\"  It notes further that \"Support for clustered POSIX file locks, also known as lockf(3) or fcntl(2), has not yet been added.\"\n\nThe documentation cited in this issue should therefore be written as \"OCFS2 only supports locking with 'flock' and not 'lockf' nor 'fcntl' [...]\".  \n\nInternally, it appears that Java uses lockf/fcntl or (on some UNIX platforms in some circumstances) mmap/futex to implement locks.  Either of these mechanisms are effectively POSIX locks, and would not be supported on OCFS2 according to [1].\n\nThat said, reference [2] in a section entitled \"Cluster aware POSIX file locks\" states that POSIX lockf/fctrl is supported by OCFS2 as of Linux Kernel 2.6.28, but that \"Due to the group communication required to make these locks coherent, a userspace cluster is required.\"\n\nI'm not sure what a \"userspace cluster\" is, but apparently the default O2CB cluster stack used on my system is a \"kernel cluster\" and thus does not support POSIX locks.  That said, I think if I had a userspace cluster, ActiveMQ's shared file system master/slave would be supported.\n\nI wrote a C program to test all of the various lock types on my configuration, along with a simple Java program that uses a FileLock obtained from a FileChannel.  Others might find this useful in testing their configurations.  You can get the source from [3].\n\n\n[1] http://oss.oracle.com/projects/ocfs2/dist/documentation/v1.4/ocfs2-1_4-usersguide.pdf\n[2] https://oss.oracle.com/osswiki/OCFS2/NewFeaturesList.html\n[3] https://github.com/ceharris/ocfs2-lock-validation","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceharris","name":"ceharris","key":"ceharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceharris&avatarId=32478","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceharris&avatarId=32478","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceharris&avatarId=32478","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceharris&avatarId=32478"},"displayName":"Carl Harris","active":true,"timeZone":"America/New_York"},"created":"2013-08-26T16:34:34.800+0000","updated":"2013-08-26T16:34:34.800+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637214/comment/13750238","id":"13750238","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"body":"Awesome, Carl. Thanks for your investigation. I've added a link to this JIRA from the wiki.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"created":"2013-08-26T16:58:59.520+0000","updated":"2013-08-26T16:58:59.520+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4378/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1itjj:"}}