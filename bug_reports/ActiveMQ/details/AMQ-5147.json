{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12708601","self":"https://issues.apache.org/jira/rest/api/2/issue/12708601","key":"AMQ-5147","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2014-08-29T09:31:05.365+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu May 14 14:31:31 UTC 2015","customfield_12310420":"386924","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5147/watchers","watchCount":2,"isWatching":false},"created":"2014-04-15T19:56:10.676+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":["security"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-14T14:31:31.992+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"In my Java application, I configured secure websocket transport wss://0.0.0.0:61614 for activemq broker. In the same JVM, there is httpsclient to call web service. During handshaking process I found that the cipher suites in the ClientHello message has only one or two supported cipher suites. See example below:\n\n*** ClientHello, TLSv1\nRandomCookie:  GMT: 1397495018 bytes = { 252, 79, 14, 225, 20, 20, 242, 57, 88, 102, 9, 34, 79, 216, 165, 186, 190, 50, 213, 135, 205, 128, 229, 154, 3, 82, 78, 32 }\nSession ID:  {}\nCipher Suites: [SSL_KRB5_WITH_3DES_EDE_CBC_SHA, SSL_RENEGO_PROTECTION_REQUEST]\nCompression Methods:  { 0 }\n***\n\nI found in the org.apache.activemq.transport.https.Krb5AndCertsSslSocketConnector class static code to set the system property \"https.cipherSuites\". The HttpsClient later reads this property to get cipher suites for handshaking message. \n\nI am not sure if the static code in that class could be removed. It definitely will mess up with the HttpsClient.    \n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"387188","customfield_12312823":null,"summary":"Secure Websocket Transport causes HttpsClient handshaking fail","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xianhua","name":"xianhua","key":"xianhua","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xianhua liu","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xianhua","name":"xianhua","key":"xianhua","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xianhua liu","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows 7","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708601/comment/14115052","id":"14115052","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nannou9","name":"nannou9","key":"nannou9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Piotr Klimczak","active":true,"timeZone":"Europe/London"},"body":"As I understand from your description, your request is more about not setting system properties- to not mess properties in your JVM.\nAm I right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nannou9","name":"nannou9","key":"nannou9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Piotr Klimczak","active":true,"timeZone":"Europe/London"},"created":"2014-08-29T09:31:05.365+0000","updated":"2014-08-29T09:31:05.365+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12708601/comment/14543731","id":"14543731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xianhua","name":"xianhua","key":"xianhua","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xianhua liu","active":true,"timeZone":"Etc/UTC"},"body":"Yes. That is right. The static code to set the \"https.cipherSuites\" system property should be removed from the org.apache.activemq.transport.https.Krb5AndCertsSslSocketConnector class.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xianhua","name":"xianhua","key":"xianhua","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xianhua liu","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-14T14:31:31.992+0000","updated":"2015-05-14T14:31:31.992+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5147/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1unkv:"}}