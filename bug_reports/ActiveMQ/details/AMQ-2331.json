{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482495","self":"https://issues.apache.org/jira/rest/api/2/issue/12482495","key":"AMQ-2331","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2009-07-24T14:04:31.696+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 28 13:36:25 UTC 2009","customfield_12310420":"96066","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_357236012_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-07-28T13:38:29.700+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2331/watchers","watchCount":0,"isWatching":false},"created":"2009-07-24T10:24:33.688+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-28T13:38:29.678+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313893","id":"12313893","name":"Connector"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313891","id":"12313891","name":"Selector"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have a network of brokers configured in Hub/Spoke topology.  The Spokes connect to the Hub via duplex network connector.  Am using only Queues, and there are same set of Queues on both the Hub and the Spokes.  Each of the Queues on the Spokes have only one consumer, and the consumer subscribes to messages based on a selector.  The selector field is the Spoke ID (a simple name).  The Hub transmits messages meant for a spoke by setting the message selector in the message to the Spoke ID.  The idea is to send specific messages to the respective Spoke.  So all the messages are sure to have the message selector set to the specific Spoke ID.\n\nThe issue am facing is as follows.  Suppose I have two Spokes A and B, and connect to a Hub say H via duplex network connector.  Most times this setup works fine, but some times the messages meant for A are sent to B and vice-versa.\n\nHere is what I found in the logs:\n\n2009-07-24 15:48:21,054 DEBUG [org.apache.activemq.store.amq.AMQMessageStore] [ActiveMQ Transport: tcp:///127.0.0.1:53209]: Journalled message add for: ID:pgopal-lt-53198-1248427143033-2:6:1:97:27, at: offset = 1032207, file = 1, size = 444, type = 1\n2009-07-24 15:48:21,057 DEBUG [org.apache.activemq.store.amq.AMQMessageStore] [ActiveMQ Task]: Doing batch update... adding: 1 removing: 0 \n2009-07-24 15:48:21,057 DEBUG [org.apache.activemq.store.amq.AMQMessageStore] [ActiveMQ Task]: Batch update done.\n2009-07-24 15:48:21,062 DEBUG [org.apache.activemq.store.amq.AMQMessageStore] [ActiveMQ Transport: tcp:///172.17.0.58:2673]: Journalled message remove for: ID:pgopal-lt-53198-1248427143033-2:6:1:97:27, at: offset = 1032651, file = 1, size = 285, type = 1\n2009-07-24 15:48:21,062 DEBUG [org.apache.activemq.store.amq.AMQMessageStore] [ActiveMQ Task]: Doing batch update... adding: 0 removing: 1 \n2009-07-24 15:48:21,062 DEBUG [org.apache.activemq.store.amq.AMQMessageStore] [ActiveMQ Task]: Batch update done.\n\nThe message was meant for a consumer in the broker running on machine 172.17.0.59, whereas the message is being removed from 172.17.0.58 (line 4).\n\nIs there a workaround or patch ?\n\nThanks,\nPradeep","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"255238","customfield_12312823":null,"summary":"Message is sent to wrong broker in network of brokers inspite of using the Message selector","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gpradeep","name":"gpradeep","key":"gpradeep","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep G","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[{"id":"12482822","key":"AMQ-2104","self":"https://issues.apache.org/jira/rest/api/2/issue/12482822","fields":{"summary":" Message relay issue when have network of brokers and downstream consumers using same queue/topic but different selectors","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gpradeep","name":"gpradeep","key":"gpradeep","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep G","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"All","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482495/comment/12941789","id":"12941789","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"can you try this with a 5.3-SNAPSHOT and with conduitSubscriptions disabled. I recall a fix related to selectors and networks in the past few months.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2009-07-24T14:04:31.696+0000","updated":"2009-07-24T14:04:31.696+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482495/comment/12941796","id":"12941796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"https://issues.apache.org/activemq/browse/AMQ-2104 may be related to this behavior","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2009-07-24T14:06:15.299+0000","updated":"2009-07-24T14:06:15.299+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482495/comment/12937604","id":"12937604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gpradeep","name":"gpradeep","key":"gpradeep","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep G","active":true,"timeZone":"Asia/Kolkata"},"body":"Gary,\n\nThe 5.3 snapshot worked.  When is the 5.3 release likely to happen ?  If this is going to take a while (more than 2-3) weeks, can you provide us with a patch that I can use ?\n\nRegards,\nPradeep.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gpradeep","name":"gpradeep","key":"gpradeep","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep G","active":true,"timeZone":"Asia/Kolkata"},"created":"2009-07-28T11:17:51.106+0000","updated":"2009-07-28T11:17:51.106+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482495/comment/12937674","id":"12937674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"I would hope to cut a first release candidate towards the end of next week but the process may take a little longer. There are still a bunch of issues that need to be resolved or deferred.\n\nTo see the relevant patch checkout the subversion commits attached to the issue: https://issues.apache.org/activemq/browse/AMQ-2104?page=com.atlassian.jira.plugin.ext.subversion%3Asubversion-commits-tabpanel","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2009-07-28T13:36:25.074+0000","updated":"2009-07-28T13:36:25.074+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2331/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i182ov:"}}