{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483541","self":"https://issues.apache.org/jira/rest/api/2/issue/12483541","key":"AMQ-2920","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2010-09-16T08:38:18.055+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Sep 10 14:19:14 UTC 2013","customfield_12310420":"74764","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_45925147965_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-02-29T14:48:11.828+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2920/watchers","watchCount":3,"isWatching":false},"created":"2010-09-16T01:49:03.987+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315623","id":"12315623","description":"version 5 feature complete","name":"5.4.0","archived":false,"released":true,"releaseDate":"2010-08-17"}],"issuelinks":[{"id":"12348793","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12348793","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12544627","key":"AMQ-3747","self":"https://issues.apache.org/jira/rest/api/2/issue/12544627","fields":{"summary":" Syntax errors are not showing up in the log when the broker is started in the background","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-09-10T14:19:14.091+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"It appears that the new sysV start/init script redirects all the process output to /dev/null when starting the broker.\n\nThis leads to pain and confusion, since you will not see any error output when you have e.g. a non-compliant activemq.xml config file - the script just completes successfully but your broker has not started. To see the output you actually have to hack the init script to remove the /dev/null, or get the script to output the command line so that you can run it by hand to get the error output.\n\nThe process output should probably be redirected to some log file in the data directory.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"252523","customfield_12312823":null,"summary":"new ActiveMQ 5.4.0 sysv start script redirects process stdout and stderr to /dev/null","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zakalwe","name":"zakalwe","key":"zakalwe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mats Henrikson","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zakalwe","name":"zakalwe","key":"zakalwe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mats Henrikson","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483541/comment/12942923","id":"12942923","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"does using the console mode, \"./bin/activemq console\"  help here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-16T08:38:18.055+0000","updated":"2010-09-16T08:38:18.055+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483541/comment/13219253","id":"13219253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"console mode will help, but also the fix in https://issues.apache.org/jira/browse/AMQ-3747","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2012-02-29T14:48:11.881+0000","updated":"2012-02-29T14:48:11.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483541/comment/13690446","id":"13690446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zzantozz","name":"zzantozz","key":"zzantozz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan Stewart","active":true,"timeZone":"Etc/UTC"},"body":"This issue isn't actually resolved. My 5.8.0 broker was failing to start because of a NullPointerException (my fault in the configuration), and the error didn't appear until I changed the \">/dev/null\" to \">/opt/activemq/data/activemq.out\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zzantozz","name":"zzantozz","key":"zzantozz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan Stewart","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-21T16:26:14.994+0000","updated":"2013-06-21T16:26:14.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483541/comment/13763060","id":"13763060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"body":"I fully agree, this might be a real pain for debugging production problems.\nThreaddumps can also be collected \n\nI suppressed all messages on STDOUT/STDERR in the implementation of the new init script because this logfile cannot be rotated by log4j.\n\n\nI think it would be really useful to redirect STDOUT/STDERR to the activemq logfile.\nAs i can remember JBOSS also does this, probably the sourcecode might be useful for changing this.\nProbably a redirected logger fails i.e in situations with memory problems - i don't know how jboss handles these types of problems.\n\nAlternative way: \n * Reconfigure log4j not to log regular log messages to STDOUT/STDERR\n   (this logfile is not rotated, therefore only really essential/critical things should be logged in this file)\n * Modify sys-v init script to provide the possibility to log messages to a logfile specified in /etc/default/activemq or $HOME/.activemqrc\n   (see appended patch)\n\n\n{code}\n$ LANG=C diff -u activemq.orig activemq\n--- activemq.orig\t2013-09-10 16:02:36.221780777 +0200\n+++ activemq\t2013-09-10 16:13:38.813794912 +0200\n@@ -214,6 +214,10 @@\n     ACTIVEMQ_KILL_MAXSECONDS=30\n fi\n \n+# LOG STDERR/STDOUT to this file \n+# (be careful, because this logfile is not under logrotation)\n+ACTIVEMQ_CONSOLE_LOG=\"/dev/null\"\n+\n ## END:DEFAULTCONFIG\n \n # ------------------------------------------------------------------------\n@@ -393,6 +397,8 @@\n    fi\n    # Execute java binary\n    if [ -n \"$PIDFILE\" ] && [ \"$PIDFILE\" != \"stop\" ];then\n+\n+      echo \"INFO: redirecting activemq stderr/stdout to $ACTIVEMQ_CONSOLE_LOG\"\n       $DOIT_PREFIX \"$JAVACMD $ACTIVEMQ_OPTS $ACTIVEMQ_DEBUG_OPTS \\\n               -Dactivemq.classpath=\\\"${ACTIVEMQ_CLASSPATH}\\\" \\\n               -Dactivemq.home=\\\"${ACTIVEMQ_HOME}\\\" \\\n@@ -400,7 +406,7 @@\n               -Dactivemq.conf=\\\"${ACTIVEMQ_CONF}\\\" \\\n               -Dactivemq.data=\\\"${ACTIVEMQ_DATA}\\\" \\\n               $ACTIVEMQ_CYGWIN \\\n-              -jar \\\"${ACTIVEMQ_HOME}/bin/activemq.jar\\\" $COMMANDLINE_ARGS >/dev/null 2>&1 &\n+              -jar \\\"${ACTIVEMQ_HOME}/bin/activemq.jar\\\" $COMMANDLINE_ARGS >$ACTIVEMQ_CONSOLE_LOG 2>&1 &\n               RET=\\\"\\$?\\\"; APID=\\\"\\$!\\\";\n               echo \\$APID > $PIDFILE;\n               echo \\\"INFO: pidfile created : '$PIDFILE' (pid '\\$APID')\\\";exit \\$RET\" $DOIT_POSTFIX\n@@ -691,4 +697,4 @@\n     ;;\n   *)\n     invoke_task\n-esac\n\\ No newline at end of file\n+esac\n{code}\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-10T14:19:14.091+0000","updated":"2013-09-10T14:19:14.091+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2920/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i17lxr:"}}