{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13042082","self":"https://issues.apache.org/jira/rest/api/2/issue/13042082","key":"AMQ-6596","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-07-10T12:08:57.423+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 11 13:01:27 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6596/watchers","watchCount":4,"isWatching":false},"created":"2017-02-10T14:48:27.420+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329848","id":"12329848","name":"5.13.0","archived":false,"released":true,"releaseDate":"2015-12-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12337971","id":"12337971","name":"5.13.5","archived":false,"released":true,"releaseDate":"2016-12-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12338822","id":"12338822","name":"5.14.3","archived":false,"released":true,"releaseDate":"2016-12-22"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-07-11T13:01:27.958+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"ActiveMQ crashes during a vulnerability scanning using Qualys vulnerability scanner.\n\n{code}\n2017-02-10 14:30:18,631 [0.1:55345@61616] WARN  Transport                      - Transport Connection to: tcp://127.0.0.1:55345 failed: java.io.IOException: Unexpected error occurred: java.lang.OutOfMemoryError: Java heap space\n{code}\n\nThis OOM error is caused due to an attempt to initialize a huge byte array of 2131230728 bytes size. The problem still occurs even if we define the maxFrameSize to 100MB. \n\n\nIt seems that the first comparison with the maxFrameSize is successful (method unmarshal) but in the later evaluation of dataIn.readInt() in method  looseUnmarshalByteSequence, a huge value is evaluated (2131230728 bytes)\n\n{code}\n\n@Override\n    public Object unmarshal(DataInput dis) throws IOException {\n        DataInput dataIn = dis;\n        if (!sizePrefixDisabled) {\n            int size = dis.readInt();\n            if (size > maxFrameSize) {\n                throw IOExceptionSupport.createFrameSizeException(size, maxFrameSize);\n            }\n            // int size = dis.readInt();\n            // byte[] data = new byte[size];\n            // dis.readFully(data);\n            // bytesIn.restart(data);\n            // dataIn = bytesIn;\n        }\n        return doUnmarshal(dataIn);\n    }\n{code}\n\n{code}\n    protected ByteSequence looseUnmarshalByteSequence(DataInput dataIn) throws IOException {\n        ByteSequence rc = null;\n        if (dataIn.readBoolean()) {\n            int size = dataIn.readInt();\n            byte[] t = new byte[size];\n            dataIn.readFully(t);\n            rc = new ByteSequence(t, 0, size);\n        }\n        return rc;\n    }\n{code}\n\n\nRelevant parts of the thread dump can be found below:\n\n{code}\nWARNING : OutOfMemoryError possibly caused by 2131230728 bytes requested for object of class 081A5700 from memory space 'Flat' id=080B1898\n{code}\n\n\n{code}\nThread Name\nActiveMQ Transport: tcp:///10.4.240.10:55345@61616\nState\nRunnable\nJava Stack\nat org/apache/activemq/openwire/v12/BaseDataStreamMarshaller.looseUnmarshalByteSequence(BaseDataStreamMarshaller.java:638) \nat org/apache/activemq/openwire/v12/WireFormatInfoMarshaller.looseUnmarshal(WireFormatInfoMarshaller.java:132) \nat org/apache/activemq/openwire/OpenWireFormat.doUnmarshal(OpenWireFormat.java:367(Compiled Code)) \nat org/apache/activemq/openwire/OpenWireFormat.unmarshal(OpenWireFormat.java:278(Compiled Code)) \nat org/apache/activemq/transport/tcp/TcpTransport.readCommand(TcpTransport.java:240(Compiled Code)) \nat org/apache/activemq/transport/tcp/TcpTransport.doRun(TcpTransport.java:232(Compiled Code)) \nat org/apache/activemq/transport/tcp/TcpTransport.run(TcpTransport.java:215) \nat java/lang/Thread.run(Thread.java:863)\n{code}\n\n\nThe definition of the transportConnector without the definition of the maxFrameSize is the following :\n{code}\n        <transportConnectors>\n            <transportConnector name=\"openwire\" uri=\"tcp://0.0.0.0:61616\"/>\n        </transportConnectors>\n{code}\n\n\nThe definition of the transportConnector after the definition of the maxFrameSize  :\n\n{code}\n <transportConnectors>\n      <transportConnector name=\"openwire\" uri=\"tcp://0.0.0.0:61616?wireFormat.maxFrameSize=104857600\"/>\n    </transportConnectors>\n{code}\n\nWe have reproduced this with versions 5.13.0, 5.13.5 and 5.14.3 but this problem is probably related to other versions too.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12852061","id":"12852061","filename":"packet.raw","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-10T14:50:56.951+0000","size":200,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12852061/packet.raw"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Out Of Memory error reported on ActiveMQ client during openwire unmarshalling","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"SUSE Linux Enterprise Server 11 (x86_64), VERSION = 11, PATCHLEVEL = 3. Java Runtime: IBM Corporation 1.7.0 ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/15861360","id":"15861360","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"body":"Please find attached the packet that was responsible for this behavior (packet.raw)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-10T14:50:56.958+0000","updated":"2017-02-10T14:50:56.958+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/16080233","id":"16080233","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruffp","name":"ruffp","key":"ruffp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ruffp","active":true,"timeZone":"Europe/Zurich"},"body":"We noticed the same behavior by sending arbitrary data to the openwire port in our ActiveMQ 5.10.2.\n\nNot sure if this is related to the same bug, but executing the following bash script on the same machine:\n\n{code}\n#!/bin/bash\n\nif [ -t 0 ]; then stty -echo -icanon -icrnl time 0 min 0; fi\n\ncount=0\nkeypress=''\nwhile [ \"x$keypress\" = \"x\" ]; do\n  let count+=1\n  echo -ne $count'\\r'\n  keypress=\"`cat -v`\"\n  dd if=/dev/urandom bs=10000 count=120 > /dev/tcp/localhost/61616\ndone\n\nif [ -t 0 ]; then stty sane; fi\n\necho \"You pressed '$keypress' after $count loop iterations\"\nexit 0\n{code}\n\nmakes the OutOfMemoryError happens few times even the data are smaller (try with bs=100 instead).\n\nBy executing this script on the latest ActiveMQ 5.14.5 I get the same results.\n\nHere's a extract of the logs:\n\n{noformat}\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55550 failed: java.io.IOException: Unknown data type: -11\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55551 failed: java.io.IOException: Frame size of 1611 MB larger than max allowed 100 MB\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55553 failed: java.io.IOException: Unknown data type: -46\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55552 failed: java.io.IOException: Frame size of 361 MB larger than max allowed 100 MB\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55555 failed: java.io.IOException: Frame size of 1271 MB larger than max allowed 100 MB\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55554 failed: java.io.UTFDataFormatException: malformed input around byte 0\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55557 failed: java.io.IOException: Unexpected error occured: java.lang.OutOfMemoryError: Java heap space\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:53624 failed: java.io.IOException: Frame size of 467 MB larger than max allowed 100 MB\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55556 failed: java.io.IOException: Frame size of 1382 MB larger than max allowed 100 MB\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55548 failed: java.io.EOFException\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55543 failed: java.io.IOException: Unknown data type: -110\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55539 failed: java.io.IOException: Unknown data type: -62\nINFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55542 failed: java.io.IOException: Unknown data type: -24\n{noformat}\n\nWhen our vulnerabiliy scanner (I don't know which one it was) created such requests, our ActiveMQ has blocked unexpectedly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruffp","name":"ruffp","key":"ruffp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ruffp","active":true,"timeZone":"Europe/Zurich"},"created":"2017-07-10T12:08:57.423+0000","updated":"2017-07-10T12:08:57.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/16080250","id":"16080250","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruffp","name":"ruffp","key":"ruffp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ruffp","active":true,"timeZone":"Europe/Zurich"},"body":"... and if I \"dd\" your packet.raw with:\n\n{{dd if=packet.raw > /dev/tcp/localhost/61616 }}\n\nI get the OOME everytime (Tested with AMQ 5.10.2).\n\nI think this is more an issue in OpenWire protocol than specific to ActiveMQ.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ruffp","name":"ruffp","key":"ruffp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ruffp","active":true,"timeZone":"Europe/Zurich"},"created":"2017-07-10T12:25:24.803+0000","updated":"2017-07-10T12:27:10.567+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/16080332","id":"16080332","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"Try disabling the OpenWire caching and see if that helps.  You can set cacheEnabled to false to disable it as an option on the connection string.\n\nSee http://activemq.apache.org/configuring-wire-formats.html","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2017-07-10T13:37:59.339+0000","updated":"2017-07-10T13:37:59.339+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/16081767","id":"16081767","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"body":"I have tried to disable the OpenWire caching but it seems that the result is the same. You can find below the updated definition of the transportConnector:\n\n{code}\n    <transportConnectors> \n      <transportConnector name=\"openwire\" uri=\"tcp://0.0.0.0:61616?cacheEnabled=false\"/> \n    </transportConnectors> \n{code}\n\nRelevant part of the logs:\n\n{code}\n\n2017-07-11 09:41:28,619 [0.1:38182@61616] WARN  Transport                      - Transport Connection to: tcp://127.0.0.1:38182 failed: java.io.IOException: Unexpected error occurred: java.lang.OutOfMemoryError: Java heap space\n2017-07-11 09:41:30,279 [main           ] INFO  BrokerService                  - Apache ActiveMQ 5.13.0 (xxxxxxx, ID:xxxxxxx-45907-1499755256917-0:1) is shutting down\n2017-07-11 09:41:30,292 [://xxxxxxx#1-3] ERROR TaskRunnerFactory              - Error in thread 'ActiveMQ VMTransport: vm://xxxxxxx'\norg.apache.activemq.broker.BrokerStoppedException: Broker BrokerService[xxxxxxx] is being stopped\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:193)\n        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:116)\n        at org.apache.activemq.transport.MutexTransport.onCommand(MutexTransport.java:50)\n        at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:271)\n        at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)\n        at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1157)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:627)\n        at java.lang.Thread.run(Thread.java:863)\n2017-07-11 09:41:30,293 [main           ] WARN  Transport                      - Transport Connection to: vm://xxxxxxx failed: org.apache.activemq.transport.TransportDisposedIOException: peer (vm://xxxxxxx#0) stopped.\n2017-07-11 09:41:30,300 [main           ] INFO  TransportConnector             - Connector vm://xxxxxxx stopped\n2017-07-11 09:41:30,300 [main           ] INFO  DemandForwardingBridgeSupport  - localhost bridge to xxxxxxx stopped\n2017-07-11 09:41:30,301 [main           ] INFO  NetworkConnector               - Network Connector DiscoveryNetworkConnector:Frontend1_xxxxxxx_61616:BrokerService[xxxxxxx] stopped\n2017-07-11 09:41:30,325 [0.1:38179@61616] WARN  Transport                      - Transport Connection to: tcp://127.0.0.1:38179 failed: java.io.IOException: Unexpected error occurred: org.apache.activemq.broker.BrokerStoppedException: Broker BrokerService[xxxxxxx] is being stopped\n2017-07-11 09:41:31,419 [main           ] INFO  TransportConnector             - Connector openwire stopped\n2017-07-11 09:41:31,431 [main           ] INFO  BrokerService                  - Apache ActiveMQ 5.13.0 (xxxxxxx, ID:xxxxxxx-45907-1499755256917-0:1) uptime 34.535 seconds\n2017-07-11 09:41:31,432 [main           ] INFO  BrokerService                  - Apache ActiveMQ 5.13.0 (xxxxxxx, ID:xxxxxxx-45907-1499755256917-0:1) is shutdown\n2017-07-11 09:41:31,434 [Thread-5       ] INFO  LogLog                         - Shutting down logging and log4j subsystem\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"created":"2017-07-11T06:58:14.785+0000","updated":"2017-07-11T06:58:14.785+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/16082114","id":"16082114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"body":"I think you have to use wireFormat.cacheEnabled\n\nSo it would be:\n\n{noformat}\n <transportConnectors> \n      <transportConnector name=\"openwire\" uri=\"tcp://0.0.0.0:61616?wireFormat.cacheEnabled=false\"/> \n    </transportConnectors> \n{noformat}\n\nThis may not fix your issue but it is worth a shot as sometimes when I have seen issues with Openwire marshalling it has been related to the cache and disabling fixed it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cshannon","name":"cshannon","key":"christopher.l.shannon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=christopher.l.shannon&avatarId=24614","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=christopher.l.shannon&avatarId=24614","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=christopher.l.shannon&avatarId=24614","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=christopher.l.shannon&avatarId=24614"},"displayName":"Christopher L. Shannon","active":true,"timeZone":"America/New_York"},"created":"2017-07-11T12:02:03.191+0000","updated":"2017-07-11T12:02:03.191+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13042082/comment/16082164","id":"16082164","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"body":"Yes you are right, I forgot to use the  \"wireFormat\"  prefix . Unfortunately I still receive the same error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kpistopoulos","name":"kpistopoulos","key":"kpistopoulos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantinos Pistopoulos","active":true,"timeZone":"Etc/UTC"},"created":"2017-07-11T13:01:27.958+0000","updated":"2017-07-11T13:01:27.958+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-6596/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i39wuf:"}}