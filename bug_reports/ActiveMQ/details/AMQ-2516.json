{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482965","self":"https://issues.apache.org/jira/rest/api/2/issue/12482965","key":"AMQ-2516","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315621","id":"12315621","description":"","name":"5.3.1","archived":false,"released":true,"releaseDate":"2010-03-23"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315623","id":"12315623","description":"version 5 feature complete","name":"5.4.0","archived":false,"released":true,"releaseDate":"2010-08-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-11-27T08:23:41.233+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Dec 26 20:09:37 UTC 2009","customfield_12310420":"74911","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_65540286_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-11-27T08:23:41.317+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2516/watchers","watchCount":2,"isWatching":false},"created":"2009-11-26T14:11:21.031+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-12-26T20:09:37.442+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have enabled authentication + authorization in my broker configuration file as follows:\n\n<jaasAuthenticationPlugin configuration=\"PropertiesLogin\" />\n\n<authorizationPlugin>\n<map>\n<authorizationMap>\n<authorizationEntries>\n<authorizationEntry queue=\">\" read=\"users\" write=\"users\" admin=\"users\"/>\n<authorizationEntry topic=\"ActiveMQ.Advisory.>\" read=\"users\" write=\"users\" admin=\"users\"/>\n</authorizationEntries>\n</authorizationMap>\n</map>\n</authorizationPlugin>\n\nIf I send a message with a TTL into the queue (using provided sample configured with the right username and password) and then try to look after the message in the queue after it has expired using the Web Console, I got the following exception:\n\n\"Caught an exception sending to DLQ: Message ID:PC198829-1539-1259168148838-0:1:1:1:1 dropped=false locked=false\njava.lang.SecurityException: User is not authenticated.\"\n\nThis only occurs when the broker has to deal with the DLQ as I can successfully read/write in any queue.\n\nIt seems that the thread responsible for moving the message into the DLQ doesn't have the right to perform this action (username and password not propagated to its connexion context ? ).\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461430","id":"12461430","filename":"activemq_configuration.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-26T14:13:47.407+0000","size":3926,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461430/activemq_configuration.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461428","id":"12461428","filename":"activemq.log","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-26T14:13:47.342+0000","size":421026,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461428/activemq.log"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461429","id":"12461429","filename":"jmsproducer_sample.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-26T14:13:47.410+0000","size":1466,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461429/jmsproducer_sample.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"159829","customfield_12312823":null,"summary":"SecurityException raised when broker tries to move expired message to DLQ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows XP SP2\nJava JRE 1.6\n\nIssue found on both FUSE Message Broker 5.3.0.3 & 5.3.0.5 (based on Apache ActiveMQ 5.3)","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482965/comment/12941885","id":"12941885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"body":"Find attached the ActiveMQ configuration, the log showing the security exception and a JMS sample to send a message with TTL into the queue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-26T14:13:47.415+0000","updated":"2009-11-26T14:13:47.415+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482965/comment/12941897","id":"12941897","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"resolved in r884778\nthanks for the good description. send to dlq (when configured) now uses the brokers security context so that it is immune to authentication configuration.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-27T08:23:41.233+0000","updated":"2009-11-27T08:23:41.233+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482965/comment/12943302","id":"12943302","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selikoff","name":"selikoff","key":"selikoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"scott selikoff","active":true,"timeZone":"Etc/UTC"},"body":"@ Concombre:  Did you find a work-around for ActiveMQ 5.3.0?  I'm also using the FUSE broker and am seeing this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selikoff","name":"selikoff","key":"selikoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"scott selikoff","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-23T23:55:09.222+0000","updated":"2009-12-23T23:55:09.222+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482965/comment/12941842","id":"12941842","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"body":"@Scott: No, no workaround sorry. This issue is not a blocking one for the project I am working on so we just deal with it ignoring the errors. But we plan to upgrade to a new FUSE Message Broker release with fix for this issue as soon as possible (when available).\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nsaboy","name":"nsaboy","key":"nsaboy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Concombre Masqué","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-26T16:40:59.270+0000","updated":"2009-12-26T16:45:44.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482965/comment/12943303","id":"12943303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selikoff","name":"selikoff","key":"selikoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"scott selikoff","active":true,"timeZone":"Etc/UTC"},"body":"@Concombre:  Since this is a one line fix, the easiest solution we found was to download the fuse source and rebuild it with maven.  It takes a bit of time for maven to automatically download all the required libraries the first time it runs, but after its done you get a full build with the solution in place.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selikoff","name":"selikoff","key":"selikoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"scott selikoff","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-26T20:09:37.342+0000","updated":"2009-12-26T20:09:37.342+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2516/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0rptz:"}}