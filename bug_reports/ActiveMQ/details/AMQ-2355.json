{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483610","self":"https://issues.apache.org/jira/rest/api/2/issue/12483610","key":"AMQ-2355","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2009-08-17T16:49:05.956+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 09 13:08:53 UTC 2012","customfield_12310420":"43792","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_99278251426_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-10-09T13:08:53.604+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2355/watchers","watchCount":5,"isWatching":false},"created":"2009-08-17T11:51:22.199+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-10-09T13:08:53.622+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313893","id":"12313893","name":"Connector"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I am doing ActiveMQ validation tests for our client and we have encountered a bug that prevents us from using it with Weblogic. The issue concerns the XA support of ActiveMQ within that application server. With JBoss, the same test succeeded so this is more an integration problem of the RA with Weblogic than a real bug with the connector.\n\nI will attach the test project but here is the scenario:\n1) A message is sent to testQueue4 (that is hosted by an ActiveMQ broker).\n2) An MDB, deployed within Weblogic and listening on the queue through the connector (and the deployment descriptors of the ejb), receives the message and starts processing it within a transaction ( <transaction-type>Container</transaction-type>, <trans-attribute>Required</trans-attribute>).\n3) The processing implies the sending of a message on testQueue5 that is configured within the weblogic-ra.xml and through a ConnectionFactory that is also configured in that file (and accessed through the EJB local references).\n4) The send fails with the following stacktrace:\njavax.jms.JMSException: [JMSPool:169822]Unable to use a wrapped JMS session in the transaction because two-phase commit is not available\n\tat weblogic.deployment.jms.JMSExceptions.getJMSException(JMSExceptions.java:22)\n\tat weblogic.deployment.jms.WrappedTransactionalSession.enlistInExistingTransaction(WrappedTransactionalSession.java:153)\n\tat weblogic.deployment.jms.WrappedTransactionalSession.enlistInTransaction(WrappedTransactionalSession.java:206)\n\tat weblogic.deployment.jms.WrappedMessageProducer.send(WrappedMessageProducer.java:136)\n\tat be.fgov.minfin.ccff.fwk.application.SendingMDB.sendJMS(SendingMDB.java:77)\n\tat be.fgov.minfin.ccff.fwk.application.SendingMDB.onMessage(SendingMDB.java:36)\n\tat be.fgov.minfin.ccff.fwk.application.SendingMDB_7x60v6_MDOImpl.onMessage(SendingMDB_7x60v6_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n\nI am in contact with Fuse support and Oracle support about this case but we are stuck at the moment and no one seems to be able to fix this. So this is a cry out to the community to help us solve this issue and getter a better Weblogic support of ActiveMQ.\n\nI will reproduce this with 5.2 (ActiveMQ version, not Fuse) and will post a comment about that as soon as it is done. I do not think it is Fuse specific at this time.\n\nHere is what I figured out so far:\n- When using EJB local references, the elements that are accessed (in this case the connection factory and the queue) should be enlisted in the transaction (hence the elistInExistingTransaction method call in the stacktrace).\n- This also happens when we are using a Foreign JNDI server to make the outbound connections to ActiveMQ instead of the weblogic-ra.xml.\n- Based on what the Oracle support told us, in debug mode, they saw that the are retrieving ActiveMQConnectionFactory instance and not an ActiveMQXAConnectionFactory instance. This would confirm that the XA support is not present for the Connection Factory returned by the Connector.\n\nSo, to fix this, we would wish to know how we could instruct the connector to return an XA connection factory instead of the basic connection factory. It seems that the problem is not only present for sending but is also present for reception:\n1) Send a message to testQueue2\n2) The message is received on an MDB deployed within WL 10.3.1 with transaction support and using local EJB references\n3) We through a RuntimeException in the onMessage() to test the rollback and receive the following exception (which is fine for us):\n13:47:29,756 ERROR [ActiveMQSession] error dispatching message: \njavax.ejb.EJBException: Unexpected exception in be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage():\njava.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage(ReceptionRollbackToDLQMDB.java:23)\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n; nested exception is: java.lang.RuntimeException: Rollback to DLQ test\njava.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage(ReceptionRollbackToDLQMDB.java:23)\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\njavax.ejb.EJBException: Unexpected exception in be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage():\njava.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage(ReceptionRollbackToDLQMDB.java:23)\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n; nested exception is: java.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:93)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n4) The message is not redelivered even though the default behaviour is documented as provoking 5 deliveries before sending the message to the DLQ. Here, the message seems to be acknowledged just as if the message reception was not in a transaction.\n\nWe are not using the \"useRAManagedTransaction\" activation config property since we want the transaction to be container managed.\n\nI will attach the MDB project and the weblogic-ra.xml for this case to be reproductible.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461360","id":"12461360","filename":"MDBTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:57:18.419+0000","size":13589,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461360/MDBTest.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461343","id":"12461343","filename":"MDBTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-17T11:52:36.860+0000","size":12182,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461343/MDBTest.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461370","id":"12461370","filename":"weblogic-ra.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:58:29.908+0000","size":1017,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461370/weblogic-ra.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461344","id":"12461344","filename":"weblogic-ra.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-17T11:53:35.840+0000","size":1250,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461344/weblogic-ra.xml"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"41062","customfield_12312823":null,"summary":"Sending a message from an MDB in Weblogic 10.3.1: \"Unable to use a wrapped JMS session in the transaction because two-phase commit is not available\"","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Weblogic 10.3.1 (aka Oracle 11g), ActiveMQ 5.2.0 and Fuse ActiveMQ 5.3.0.2, ActiveMQ 5.2.0 and Fuse ActiveMQ 5.3.0.2 connector, Ubuntu 9.04","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941262","id":"12941262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"MDBTest project (Maven2)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-17T11:52:36.876+0000","updated":"2009-08-17T11:52:36.876+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941261","id":"12941261","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"Weblogic RA deployment descriptor to add in the META-INF folder of the connector. The rest of the configuration can be the default one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-17T11:53:35.869+0000","updated":"2009-08-17T11:53:35.869+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941269","id":"12941269","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"I just finished testing with ActiveMQ 5.2.0 (broker and connector).\n\nI am getting the same exceptions.\n\nWhen sending a message to testQueue2 (reception rollback test):\n14:04:14,940 ERROR [ActiveMQSession] error dispatching message: \njavax.ejb.EJBException: Unexpected exception in be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage():\njava.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage(ReceptionRollbackToDLQMDB.java:23)\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n; nested exception is: java.lang.RuntimeException: Rollback to DLQ test\njava.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage(ReceptionRollbackToDLQMDB.java:23)\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\njavax.ejb.EJBException: Unexpected exception in be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage():\njava.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB.onMessage(ReceptionRollbackToDLQMDB.java:23)\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n; nested exception is: java.lang.RuntimeException: Rollback to DLQ test\n\tat be.fgov.minfin.ccff.fwk.application.ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.onMessage(ReceptionRollbackToDLQMDB_dz4wsg_MDOImpl.java:93)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n\nWith no redelivery and an acknowledged message.\n\nFor the sending in an MDB with transaction support (sent message to testQueue4):\n<Aug 17, 2009 2:11:18 PM CEST> <Error> <WebLogicServer> <BEA-000337> <[STUCK] ExecuteThread: '0' for queue: 'weblogic.kernel.Default (self-tuning)' has been busy for \"600\" seconds working on the request \"weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl@13646d1\", which is more than the configured time (StuckThreadMaxTime) of \"600\" seconds. Stack trace:\nThread-14 \"[STUCK] ExecuteThread: '0' for queue: 'weblogic.kernel.Default (self-tuning)'\" <alive, in native, suspended, waiting, priority=1, DAEMON> {\n    -- Waiting for notification on: java.lang.Object@4504c0d[fat lock]\n    java.lang.Object.wait(Object.java:???)\n    org.apache.activemq.transport.failover.FailoverTransport.oneway(FailoverTransport.java:387)\n    org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:39)\n    ^-- Holding lock: java.lang.Object@4504c2e[thin lock]\n    org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:57)\n    org.apache.activemq.ActiveMQConnection.doAsyncSendPacket(ActiveMQConnection.java:1225)\n    org.apache.activemq.ActiveMQConnection.asyncSendPacket(ActiveMQConnection.java:1216)\n    org.apache.activemq.ActiveMQSession.send(ActiveMQSession.java:1626)\n    ^-- Holding lock: java.lang.Object@139e435[thin lock]\n    org.apache.activemq.ActiveMQMessageProducer.send(ActiveMQMessageProducer.java:196)\n    org.apache.activemq.ActiveMQMessageProducerSupport.send(ActiveMQMessageProducerSupport.java:269)\n    weblogic.deployment.jms.WrappedMessageProducer.send(WrappedMessageProducer.java:161)\n    weblogic.deployment.jms.JMSSessionPoolTester.sendQueueMessage(JMSSessionPoolTester.java:352)\n    weblogic.deployment.jms.JMSSessionPoolTester.timerExpired(JMSSessionPoolTester.java:291)\n    ^-- Holding lock: weblogic.deployment.jms.JMSSessionPoolTester@138fef3[thin lock]\n    weblogic.timers.internal.TimerImpl.run(TimerImpl.java:253)\n    weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n    weblogic.work.ExecuteThread.execute(ExecuteThread.java:198)\n    weblogic.work.ExecuteThread.run(ExecuteThread.java:165)\n}\n\nWhich is different from before. At that point, the MDB is stuck and the message reception has not been acknowledged.\n\nAfter restarting the server, I get the same exception as with fuse-5.3.0.2:\njavax.jms.JMSException: [JMSPool:169822]Unable to use a wrapped JMS session in the transaction because two-phase commit is not available\n\tat weblogic.deployment.jms.JMSExceptions.getJMSException(JMSExceptions.java:22)\n\tat weblogic.deployment.jms.WrappedTransactionalSession.enlistInExistingTransaction(WrappedTransactionalSession.java:153)\n\tat weblogic.deployment.jms.WrappedTransactionalSession.enlistInTransaction(WrappedTransactionalSession.java:206)\n\tat weblogic.deployment.jms.WrappedMessageProducer.send(WrappedMessageProducer.java:136)\n\tat be.fgov.minfin.ccff.fwk.application.SendingMDB.sendJMS(SendingMDB.java:77)\n\tat be.fgov.minfin.ccff.fwk.application.SendingMDB.onMessage(SendingMDB.java:36)\n\tat be.fgov.minfin.ccff.fwk.application.SendingMDB_7x60v6_MDOImpl.onMessage(SendingMDB_7x60v6_MDOImpl.java:49)\n\tat org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointAlive.onMessage(MessageEndpointProxy.java:123)\n\tat org.apache.activemq.ra.MessageEndpointProxy.onMessage(MessageEndpointProxy.java:64)\n\tat org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:766)\n\tat org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:169)\n\tat weblogic.connector.security.layer.WorkImpl.runIt(WorkImpl.java:108)\n\tat weblogic.connector.security.layer.WorkImpl.run(WorkImpl.java:44)\n\tat weblogic.connector.work.WorkRequest.run(WorkRequest.java:95)\n\tat weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)\n\tat weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)\n\tat weblogic.work.ExecuteThread.run(ExecuteThread.java:173)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-17T12:48:41.625+0000","updated":"2009-08-17T12:48:41.625+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941280","id":"12941280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"body":"I don't know anything about weblogic.  For instance, they might have non-spec support for jms that is getting in the way of using activemq as a j2ca compliant inbound and outbound resource adapter, or you might have deployed the activemq connectivity in some way that does not use the activemq resource adapter.  I'm extremely suspicious of this:\n\nat weblogic.deployment.jms.WrappedTransactionalSession.enlistInExistingTransaction(WrappedTransactionalSession.java:153)\nat weblogic.deployment.jms.WrappedTransactionalSession.enlistInTransaction(WrappedTransactionalSession.java:206)\nat weblogic.deployment.jms.WrappedMessageProducer.send(WrappedMessageProducer.java:136)\nat be.fgov.minfin.ccff.fwk.application.SendingMDB.sendJMS(SendingMDB.java:77)\n\nwhich looks to me as if weblogic is not using the j2ca support for xa transactions which would be enlisting the connection in the xa transaction well before your app tried to send a message, but rather expecting an XASession which is never going to be visible or available in a j2ca connector.\n\nIf you are deploying as a j2ca resource adapter, you should be getting an org.apache.activemq.ra.ActiveMQConnectionFactory instance from a jndi lookup (or some wrapped or proxied version of this class).  All the xa support is handled behind the scenes in the weblogic connection manager and the org.apache.activemq.ra.ActiveMQManagedConnectionFactory which supplies an XAResource to the transaction management internals.  Your code should definitely never see anything related to xa support and the means of enlisting in an xa transaction should not be visible to a session obtained from a connection obtained from the connection factory.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-08-17T16:49:05.956+0000","updated":"2009-08-17T16:49:05.956+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941179","id":"12941179","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"David, thanks for the comment.\n\nAbout the code that you find suspicious in Weblogic, by using local references (that later link to the ActiveMQ connector) we are enabling Weblogic to add some services when accessing the JMS components. In this case, the most important one is the transactionnal support. From what I have heard of the people of Weblogic, the MDB has the following behaviour:\n1 - It connects to the broker through the connection factory provided by the connector.\n2 - Since the connection factory does not implement javax.jms.XAConnectionFactory, it cannot create a transaction with XA support. (-> this is the issue, according to the Weblogic support; Sebastien (from Weblogic support), please feel free to contradict me if I state this wrong)\n3 - Once an access is made in the MDB to another JMS resource (to send a message), Weblogic tries to enlist this operation in the existing transaction (as you would expect of the TransactionManager). However, since we are talking about two connection factories (one for the reception and one for the send), it requires a transaction with XA support which he does not have in this case... hence the error message.\n\nDavid, you can look in the attached files the way we link to the resource adapter. This has been checked by Fuse Support (thanks Daan) and works perfectly with JBoss. The only changes that we did for Weblogic are:\n- Adding the necessary weblogic-ejb-jar.xml with the elements comparable with what is in the jboss.xml\n- Adding the weblogic-ra.xml with the elements comparable with what is in the activeMQ-jms-ds.xml (to declare the oubound queue and connection factory).\n\nOnce this will be working, I would be glad to contribute the Weblogic How-To with the sample code comparable with the one found for JBoss since I found that one very instructive. But first things first... it should work before we get to document it for others to use ;-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:08:08.956+0000","updated":"2009-08-18T06:08:08.956+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941180","id":"12941180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"In case this is not clear by now, Weblogic support told us that, in order to fix this, we would only require a way to get a connection factory with XA support from the connector and available in the JNDI. It seems that JBoss gets one by default but this is not the case for Weblogic.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:10:40.031+0000","updated":"2009-08-18T06:10:40.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941220","id":"12941220","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"Some results after some extra testing:\n\nWhen deploying the resource adapter, I get the following warnings:\n<Aug 18, 2009 8:14:53 AM CEST> <Warning> <Connector> <BEA-190155> <Compliance checking/validation of the resource adapter /home/cedric/java/oracle11g/user_projects/domains/basic_domain/apps/activemq-rar-fuse.rar resulted in the following warnings:\nThe ra.xml <resourceadapter-class> class 'org.apache.activemq.ra.ActiveMQResourceAdapter' should implement java.io.Serializable but does not.> \n<Aug 18, 2009 8:14:53 AM CEST> <Warning> <WorkManager> <BEA-002919> <Unable to find a WorkManager with name activemq-rar-fuse.rar. Dispatch policy activemq-rar-fuse.rar will map to the default WorkManager for the application activemq-rar-fuse> \n\nI am not sure how these can affect the availability of the connector elements.\n\nBased on the advise of Weblogic support, I added 3 test cases: The first one without transaction support, the second one without the EJB local references to the oubound connection factory and queue and the third one without the transaction support and without the EJB local references to the outbound JMS elements. The results of these test cases are below.\n\nMDB with <trans-attribute>NotSupported</trans-attribute>: No exception at first in Weblogic, no exception in ActiveMQ, the message reception was acknowledged but there is nothing in the outband queue...\nAfter a 46 seconds, a warning appeared in Weblogic (the first message shows you when I sent the message to launch the test case):\n08:29:12,973 PERFORMANCE [MyAction] be.fgov.minfin.ccff.fwk.logging.internal.message.PerformanceMessageImpl: DESCRIPTION = Sending 1 message(s) of 100 byte(s) to ActiveMQ -> testQueue6, UID = 8cfa31f2-add8-3e19-95e5-66cd140ee100, DOMAIN = basic_domain, DURATION = 47, SERVER = AdminServer\n<Aug 18, 2009 8:29:58 AM CEST> <Error> <JMSPool> <BEA-169805> <A pooled JMS connection is being closed because an error was detected on the connection: javax.jms.JMSException: [JMSPool:169819]There was an error with a resource pool used to pool JMS sessions: weblogic.common.resourcepool.ResourceDeadException: 0:javax.jms.IllegalStateException: The Connection is closed. Linked exception: weblogic.common.resourcepool.ResourceDeadException: 0:javax.jms.IllegalStateException: The Connection is closed>\n\nMDB with no EJB local reference to JMS outbound elements: This worked :-) I got the message in the outbound queue. The rollback of the message when a Runtime exception occurs still needs to be tested though to make sure that we get the correct behaviour. This is already great news.\n\nMDB with no EJB local reference to JMS outbound elements and with <trans-attribute>NotSupported</trans-attribute>: No exception in Weblogic but the following exception in the broker:\nERROR Service                        - Async error occurred: java.lang.NullPointerException\njava.lang.NullPointerException\n\tat org.apache.activemq.broker.TransportConnection.processRemoveSession(TransportConnection.java:589)\n\tat org.apache.activemq.command.RemoveInfo.visit(RemoveInfo.java:62)\n\tat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:305)\n\tat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:179)\n\tat org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n\tat org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:143)\n\tat org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:206)\n\tat org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:84)\n\tat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:203)\n\tat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:185)\n\tat java.lang.Thread.run(Thread.java:619)\nThe message is consummed in Weblogic and no message was added to the outbound queue.\n\nI will put the updated weblogic-ra.xml and MDB test project online (attached to this case) so that you can inspect the changes I made to support these test cases.\n\nBased on these results, I will also try the rollback scenarios with no EJB local references. I will provide the results as soon as I get them.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:54:35.004+0000","updated":"2009-08-18T06:54:35.004+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941188","id":"12941188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"MDBTests without transaction support and with no local EJB references to the outbound JMS elements","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:57:18.500+0000","updated":"2009-08-18T06:57:18.500+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941228","id":"12941228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"Weblogic RA deployment descriptor for the tests with no transaction support and no EJB local references to the JMS outbound elements.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T06:58:29.945+0000","updated":"2009-08-18T06:58:29.945+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941285","id":"12941285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"body":"I added one more test:\n- MDB with transaction support receives a message\n- It sends a message to the outbound queue in its onMessage(...)\n- It throws a RuntimeException\nThe expected behaviour is that the message will be redelivered 5 times and end up in the DLQ of ActiveMQ. Of course, no message should arrive in the outbound queue.\nThe behaviour that I notice is the same as the one for the runtime exception occuring in a simple reception of a message:\n- An runtime exception is logged in Weblogic. (-> ok)\n- The message reception is acknowledged (-> nok)\n- and there is no redelivery (-> nok)\n- The message arrives in the outbound queue (-> nok)\n\nSo... I think we progressed but we still do not have a correct behaviour in case a Runtime exception occurs. Any ideas how to achieve this in Weblogic ?\n\nBased on these findings, I would currently advise not to use local references within Weblogic. This is very annoying for applications that need to be deployabled on both Weblogic and JBoss because the advise is to use local references for JBoss and those are referenced from the ejb-jar.xml which is common for both Weblogic and JBoss (and any other application server for that matter). But at least there is a solution to make it work (except the rollback) which is already an improvement.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cedneve","name":"cedneve","key":"cedneve","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cedric Neve","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T07:22:43.075+0000","updated":"2009-08-18T07:23:21.149+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941287","id":"12941287","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm not in a position to research deployment of resource adapters into weblogic.   However, the comments from oracle support indicate to me that you may not be deploying actiivemq as a j2ca 1.5 resource adapter, or the support personell don't understand how it works.  Here's a brief attempt at a descriptions:\n\nYour app looks up a connection facotry cf in jndi.  Your app asks the cf for a connection.  The cf asks a connection manager for a suitable ManagedConnection, which may be obtained from a pool or from a ManagedConnectionFactory.  Once the ManagedConnection is obtained, the transaction machinery gets an XAResource from it.  If there is an existing jta transaction, the managed connection is immediately enrolled in it.  If a jta trahsaction is started later (such as through UserTransaction.begin()) then all the managed connections in use are enrolled in the jta transaction.  \n\nAfter the ManagedConnection is obtained, a Connection is obtained from it.  This is what your app gets.  It has some locatl transaction support, but jta transaction management is completely invisible to the connection object.\n\nSince IIUC weblogic is either j2ee 1.4 or javaee5 certified, it's required to support deployment of resource adapters, including activemq-rar, in this way.  Before j2ee 1.4 there was an attempt to provide a way to deploy jms provders in some other way that I don't recall very well.  I think that the XASession is supposed to support this deployment method.  I don't recommend it.  Perhaps you have somehow managed to deploy activemq in this way, in which case the connection pooling and jta transaction support would most likely be unavailable.\n\nI'm glad to see that whether or not any of the code I wrote for jboss remains, their j2ca support still works.\n\nIf you don't have any other resource managers involved in your mdb, activemq has an config-property to make it so an mdb will use the same connection for inbound and outbound messages to an mbd.  This would theorectially remove the need for an xa transaction, although I don't know how weblogic would detect this unless it was using the XAResource from teh ManagedConnection, in which case you would not have this problem in the first place.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-08-18T07:30:44.253+0000","updated":"2009-08-18T07:30:44.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941268","id":"12941268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\ni am Sebastien and I am part of the frontilne team of Weblogic support. \n\nThanks David for your explanations.\n\nI am currently checking how Weblogic container can force the connector to retrieve an XAConnection. Maybe some attributes specified in the descriptors are skipped if there is an issue on this side.\n\nMay you tell me what we need to pass to the connector to get such XA object?\n\nAlso I am wondering why there is no org.apache.activemq.ra.ActiveXAMQConnectionFactory that can expose directly an XAConnectionFactory?\n\nThanks\nSebastien","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-18T08:37:08.049+0000","updated":"2009-08-18T08:37:08.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941290","id":"12941290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Sebastian,\n\nPerhaps we could use fully qualiified class names to avoid misunderstandings.\n\nThe XAConnectionFactory implementation is not part of the j2ca connector, it's in activemq core.\n\norg.apache.activemq.ActiveMQXAConnectionFactory\n\nI've never used it. \n\nApparently weblogic can support jms both using the old-fashined XAConnectionFactory as well as through a j2ca connector (the latter is required by the j2ca support).  Out of curiousity, why would one choose the XAConnectionFactory approach?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-08-18T18:19:38.026+0000","updated":"2009-08-18T18:19:38.026+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941320","id":"12941320","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"body":"Hi David,\n\nQ - why would one choose the XAConnectionFactory approach?\nA - In fact, I am comparing ActiveMQ to Tibco or IBM MQ. These two JMS providers are exposing an XAConnectionFactory so we do not face this issue. However with these two providers we do not work with adapters but we acces the resoucre via JNDI.\n\nRegarding ActiveMQ, I would like to clarify one point :\n\n- How is it possible that the ActiveMQ adapter returns an XASession object? What info should WLS container pass to the adapter to get such object? \nIt will help to understand what is missing in WLS code if there is an issue on our side.\n\n- Or, do you consider that we should work with nonXA objects and WLS will emulate the 2PC?\n\nThanks\nSbastien","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-20T16:35:00.656+0000","updated":"2009-08-20T16:35:00.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941350","id":"12941350","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Sebastian,\n\nI looked into WLS documentation a little bit and it looks like the plan you supply does try to deploy activemq ra as a j2ca connector.  However the stack trace you show indicates to me that wls is completely ignoring the transaction control contracts of the j2ca spec and doing something unrelated to j2ca.  XASession has no part in transaction control in a j2ca environment.  All you should be using is the ManagedConnection (here org.apache.activemq.ra.ActiveMQManagedConnection), calling getXAResource(), and the resulting XAResource (here org.apache.activemq.ra.LocalAndXATransaction) to control xa transactions.  This is the part of the stack trace that seems contrary to j2ca to me:\n\njavax.jms.JMSException: [JMSPool:169822]Unable to use a wrapped JMS session in the transaction because two-phase commit is not available\nat weblogic.deployment.jms.JMSExceptions.getJMSException(JMSExceptions.java:22)\nat weblogic.deployment.jms.WrappedTransactionalSession.enlistInExistingTransaction(WrappedTransactionalSession.java:153)\nat weblogic.deployment.jms.WrappedTransactionalSession.enlistInTransaction(WrappedTransactionalSession.java:206)\nat weblogic.deployment.jms.WrappedMessageProducer.send(WrappedMessageProducer.java:136)\nat be.fgov.minfin.ccff.fwk.application.SendingMDB.sendJMS(SendingMDB.java:77)\n\nThe non-XASession Session instance you get from a Connection from the ra ConnectionFactory can't be used to control xa transactions.  You need to use the underlying ManagedConnection/XAResource.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djencks","name":"djencks","key":"djencks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Jencks","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-08-21T17:39:44.634+0000","updated":"2009-08-21T17:39:44.634+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12941494","id":"12941494","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"body":"\nThanks David your answer.\n\nI just opened a Bug on Oracle side and I hope we will be able progress soon.\n\nBug reference 8843814.\n\nSincerely\nSbastien","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-27T08:39:00.270+0000","updated":"2009-08-27T08:39:00.270+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/12940896","id":"12940896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"body":"Hi David, Hi Cdric\n\nWe have made some progress on Oracle side. There is an issue when using Oracle JMS Wrapper (including with resource-ref) and the connector. When the application is deployed, XA resource is checked and it is considered as non XA compliant.\n\nA workaround has been provided to avoid this behavior:\nIn ejb-jar.xml, we must declare the connection factory resource as java.lang.Object (res-type) instead of javax.jms.QueueConnectionFactory\n\nOnce this first issue was workarounded, we found a new issue related to JTA and how the container handles it. A new Bug has been created (Bug8970918) to track it. \n\nOur MDB is consuming a message from ActiveMQ, then sends a new message to an outbound queue hosted on ActiveMQ too. For test purpose, we throw a RuntimeException after the MDB sends this new message. In that case, in order to make the transaction work correctly, we need to invoke setRollbackOnly. However, based on the specifications, it is not required since RuntimeException is a system exception. If you do not specified setRollbackOnly then the first message is dequeued and the second message is sent to the otbound queue.\n\nSample code to workaround the transaction issue :\nonMessage(){\n  try{\n      //your business process here\n  }catch(Exception e){\n      messageDrivenContext.setRollbackOnly();\n      throw new RuntimeException(\"test\");\n   }\n}\n\nThanks for your help on this ! I believe this thread can be closed.\n\nSbastien","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebastek","name":"sebastek","key":"sebastek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sebastien","active":true,"timeZone":"Etc/UTC"},"created":"2009-09-30T10:43:49.665+0000","updated":"2009-09-30T10:43:49.665+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/13472199","id":"13472199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=derjust","name":"derjust","key":"derjust","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebastian J.","active":true,"timeZone":"Etc/UTC"},"body":"Thanks Sbastien for the Feedback.\nI just want to contribute that this workaround also applies for Spring/WAR deployments (and also the same error occurs).\nSetting in web.xml\n{quote}In ejb-jar.xml, we must declare the connection factory resource as java.lang.Object (res-type) instead of javax.jms.QueueConnectionFactory\n{quote} sends the message.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=derjust","name":"derjust","key":"derjust","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebastian J.","active":true,"timeZone":"Etc/UTC"},"created":"2012-10-09T07:33:56.953+0000","updated":"2012-10-09T07:33:56.953+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483610/comment/13472351","id":"13472351","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"closing this off based on comment trail, seems that the workaround for wl issue does the trick.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2012-10-09T13:08:53.619+0000","updated":"2012-10-09T13:08:53.619+0000"}],"maxResults":19,"total":19,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2355/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07e67:"}}