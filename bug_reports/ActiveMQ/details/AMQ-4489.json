{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12644804","self":"https://issues.apache.org/jira/rest/api/2/issue/12644804","key":"AMQ-4489","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324951","id":"12324951","name":"5.11.0","archived":false,"released":true,"releaseDate":"2015-02-04"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-04-29T20:40:31.253+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jan 22 22:46:48 UTC 2016","customfield_12310420":"325167","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_86533210545_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-01-22T22:46:48.842+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4489/watchers","watchCount":3,"isWatching":false},"created":"2013-04-26T09:46:38.417+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318549","id":"12318549","name":"5.5.1","archived":false,"released":true,"releaseDate":"2011-10-16"}],"issuelinks":[{"id":"12455264","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12455264","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12839153","key":"AMQ-5853","self":"https://issues.apache.org/jira/rest/api/2/issue/12839153","fields":{"summary":"JDBC store - pending high priority messages batch cannot be consumed after low priority message batch ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-01-22T22:46:48.921+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313895","id":"12313895","name":"Message Store"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We configured message prioritization according to the following page :\nhttp://activemq.apache.org/how-can-i-support-priority-queues.html\nWe use a JDBC adapter for message persistence, in an Oracle database.\nPrioritisation is enabled on the queue with the \"prioritizedMessages\" option, and we also specify a memory limit for the queue (24 MB)\nWe use ActiveMQ 5.5.1 within ServiceMix 4.4.2, and use Camel JMS producers/consumers.\nMessage can have 2 priorities : 4 (normal) for non-business hours and 9 (high) for business hours.\n\nThe scenario to reproduce the problem is the following : \n1. Enqueue 1000 \"normal\" and 1000 \"high\" messages.\n2. All \"high\" messages are consumed first.\n3. After a few \"normal\" messages are consumed, enqueue additional 1000 \"high\" messages.\n4. All \"normal\" messages\" are consumed before \"high\" messages.\n5. All additional \"high\" 1000 messages are never consumed.\n6. Restart broker.\n7. All additional \"high\" 1000 messages start getting consumed.\n\nIn production, we have a producer with high peaks during the night (10,000-100,000 messages/hour), and 6 consumers (about 5,000-10,000 messages/hour), so the queue can reach 100,000-200,000 messages at some periods of the day. Messages are small (200 bytes).\n\nWe enabled SQL query tracing on the broker (with log4jdbc), and we see that the logic with which the \"findNextMessagesByPriorityStatement\" query is called does not seem correct in the \"JDBCMessageStore.recoverNextMessages\" method :\n\nAt step 2, we see the following query being executed :\nSELECT ID, MSG FROM ACTIVEMQ_MSGS WHERE CONTAINER='priorityQueue' AND ((ID > 200 AND PRIORITY = 9) OR PRIORITY < 9) ORDER BY PRIORITY DESC, ID\n\nAt step 4, we see the following query being executed :\nSELECT ID, MSG FROM ACTIVEMQ_MSGS WHERE CONTAINER='priorityQueue' AND ((ID > 1200 AND PRIORITY = 4) OR PRIORITY < 4) ORDER BY PRIORITY DESC, ID\n\nThe problem is that the value for the last priority stored in the  \"lastRecoveredPriority\" variable of the JDBCMessageStore stays permanently to 4, until step 6, where it is reset to 9.\n\nWe tried changing the priority to constant '9' in the query.  It works OK until step 3, where only 200 messages are consumed\n\nOur understanding is that there should be one \"lastRecoveredSequenceId\" variable for each priority level, so that the last \"consumed message but not yet removed from the DB\" is memorized, and also the priority should probably also be reset to 9 every time the query is executed.\n\nCan you have a look please ?\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580962","id":"12580962","filename":"MessagePriorityTest_frozen.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-29T11:55:41.144+0000","size":21328,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12580962/MessagePriorityTest_frozen.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580961","id":"12580961","filename":"MessagePriorityTest_workaround.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-29T11:10:28.308+0000","size":21056,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12580961/MessagePriorityTest_workaround.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580955","id":"12580955","filename":"MessagePriorityTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-29T09:22:01.945+0000","size":20785,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12580955/MessagePriorityTest.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"325512","customfield_12312823":null,"summary":"Newly received messages with higher priority are never consumed, until broker is restarted","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"ServiceMix 4.4.2, using Camel producers/consumers","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13644384","id":"13644384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"body":"Problem can be reproduced in ActiveMQ 5.8.0.\nHere is a test driver to reproduce it.\nReplace the MessagePriorityTest.java in a vanilla installation and run the test :\nmvn -Dtest=JDBCMessagePriorityTest test\nNote : \"asserts\" have been disabled to avoid stop on first error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-29T09:22:01.948+0000","updated":"2013-04-29T09:22:01.948+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13644422","id":"13644422","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"body":"Here is a new version of the test driver that almost solves the problem of the priorities not taken into account.  The workaround is to  restart the broker before message consumption.  In real-life, this is of course not possible, but it can help find the root cause of the problem.  Instead of hundreds of messages not being prioritized properly, only 2 messages are not, but this minor problem can also be solved with \"queuePrefetch=0\" instead of 1.\nNote : the test driver does not reproduce the problem where the messages with high priority are never consumed anymore (this problem could not be isolated).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-29T11:10:28.311+0000","updated":"2013-04-29T11:10:28.311+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13644440","id":"13644440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"body":"A third version (_frozen) of the test driver that reproduces the \"frozen\" consumption of messages.  After 3600 messages, there are still 1200 messages in the queue, but the browser sees \"0\". The workaround to restart the broker resumes the message consumption.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-29T11:55:41.147+0000","updated":"2013-04-29T11:55:41.147+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13644843","id":"13644843","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"I just gave org.apache.activemq.store.JDBCMessagePriorityTest#testQueues (with ur modified MessagePriorityTest) a run on trunk and it works, is that the test that should show the problem?\nmaybe try against at 5.9-SNAPSHOT or did I miss something.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-29T20:40:31.253+0000","updated":"2013-04-29T20:40:31.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13645373","id":"13645373","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"body":"Gary, thanks for looking into this.\nI just tried with the ZIP from Hudson build ActiveMQ-Java7 #187 and the problem is still present.\nBeware that the \"asserts\" have been disabled in the test driver, otherwise it is impossible to see how many messages are not sorted according to priority (it aborts on the first failed one).  The easiest way to see it is to change the parameter \"redirectTestOutputToFile\" in the root pom.xml to false, and launch the following command :\nmvn -Dtest=JDBCMessagePriorityTest#testQueues test.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-30T08:04:08.852+0000","updated":"2013-04-30T08:04:08.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13686632","id":"13686632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"body":"[~gtully] : Gary, my understanding from this problem is the following : with an ActiveMQ broker configured with JDBC persistence, if the queue depth is larger than what can fit in-memory, any non-FIFO consumer on the queue may be blocked receiving messages in the queue, because messages in the JMS store are only considered for consumption after in-memory messages.  This problem can happen when JMS priorities are used, but also when JMS message selectors are used.\nIs that correct ?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2013-06-18T12:14:12.916+0000","updated":"2013-06-18T12:14:12.916+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/13686651","id":"13686651","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"@metatach I have not had the opportunity to dig deeper into your tests case but for priority, the db gets to order the messages (once it is queried). For selectors, the match only occurs on the cursor. So priority and selectors are different in the jdbc case. It may be that the db is not queried if the cursor gets filled with low priority messages due to the fill order.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-18T12:41:26.489+0000","updated":"2013-06-18T12:41:26.489+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644804/comment/15113273","id":"15113273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This cases seems to be the same as that in AMQ-5853 which is now resolved.  Tried out the attached tests and it seems they now work as best I can tell.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2016-01-22T22:46:48.879+0000","updated":"2016-01-22T22:46:48.879+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4489/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1k3lb:"}}