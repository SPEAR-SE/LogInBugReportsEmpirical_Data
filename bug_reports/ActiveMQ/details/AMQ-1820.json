{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482603","self":"https://issues.apache.org/jira/rest/api/2/issue/12482603","key":"AMQ-1820","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-06-24T13:08:18.595+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Sep 02 11:49:09 UTC 2008","customfield_12310420":"43787","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_6363012551_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2008-09-02T11:49:09.242+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1820/watchers","watchCount":4,"isWatching":false},"created":"2008-06-20T20:18:56.691+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-09-02T11:49:09.241+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Step to reproduce:\nTest 1\n1, Setup a Pure Master/Slave (master is using the original activemq.xml, slave is added masterConnectorURI=\"tcp://masterhost:62001\" shutdownOnMasterFailure=\"false\"\n2, Kill the slave\n3, Have a client to send a message to a queue.Master will not be able to function, see MasterTest1.log (WARN  TransportConnection            - Failed to add Connection\njavax.jms.JMSException: The destination topic://ActiveMQ.Advisory.Connection and admin console queues.jsp throws exceptions too)\n\nTest 2\n1. Same as Test 1\n2. Same as Test 1\n3. restart the slave. Master will throw exception( on solaris master will throw exception, slave has no exception, on xp, both will throw exception and it is an infinite loop so I have to kill both) See MasterTest2.log for the exception\n4. Have a client to send a message to a queue.Master will not be able to function, same exception as slave restart is thrown.\n\nBoth MasterTest1.log MasterTest2.log files are the tests on solaris.\nRest is a Win XP test for Test2, which has an infinite loop","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461193","id":"12461193","filename":"ASF.LICENSE.NOT.GRANTED--ActiveMQ5.1PureMasterSlaveTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yinghe0101","name":"yinghe0101","key":"yinghe0101","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ying","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-20T20:18:56.694+0000","size":8255,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461193/ASF.LICENSE.NOT.GRANTED--ActiveMQ5.1PureMasterSlaveTest.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461080","id":"12461080","filename":"masterSlaveTestCase.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nmervaillie","name":"nmervaillie","key":"nmervaillie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Mervaillie","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-24T13:08:18.508+0000","size":4085,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461080/masterSlaveTestCase.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461182","id":"12461182","filename":"patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nmervaillie","name":"nmervaillie","key":"nmervaillie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Mervaillie","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-26T16:20:58.944+0000","size":651,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461182/patch.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"114344","customfield_12312823":null,"summary":"Pure Master/Slave-kill the slave-master will not work","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yinghe0101","name":"yinghe0101","key":"yinghe0101","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ying","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yinghe0101","name":"yinghe0101","key":"yinghe0101","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ying","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Tested on both solaris 9 sparc and windows XP with release ActiveMQ 5.1 release\nTested ActiveMQ 5.1 release on xp only.\n\non solaris, master and slave are two machines. on window xp, master and slave are on one machine with different ports.\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482603/comment/12939892","id":"12939892","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nmervaillie","name":"nmervaillie","key":"nmervaillie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Mervaillie","active":true,"timeZone":"Etc/UTC"},"body":"Attaching a test case to reproduce this issue (tested on ubuntu and redhat).\n\nThis issue is critical for me as it prevents from using a cluster configuration in production. Can someone consider raising this issue priority ?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nmervaillie","name":"nmervaillie","key":"nmervaillie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Mervaillie","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-24T13:08:18.595+0000","updated":"2008-06-24T13:08:18.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482603/comment/12939881","id":"12939881","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yinghe0101","name":"yinghe0101","key":"yinghe0101","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ying","active":true,"timeZone":"Etc/UTC"},"body":"The topology we want to have is as follows:\n\nmachine A: \n masterBroker1\n slaveBroker2\n\nmachine B:\n masterBroker2\n slaveBroker1\n\nor more machines to have pure master/slave pair\n\non client machine, we want to indicate only the masters:\nfailover://(tcp://masterBroker1:port, tcp://masterBroker2:port)\nso the slaves are only used for replication purpose.\n\nif any one broker regardless of master or slave dies, its corresponding master or slave will finish what it is doing but not accepting new messages or connections and all the messages will failover to the available masters.\n\nIs this a feasible in the current release?\n\nAfter all, the goal for us is to have network of brokers to have HA and slaves only for replication so messages are not lost. Thanks \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yinghe0101","name":"yinghe0101","key":"yinghe0101","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ying","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-24T19:14:39.481+0000","updated":"2008-06-24T19:14:39.481+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482603/comment/12939889","id":"12939889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nmervaillie","name":"nmervaillie","key":"nmervaillie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Mervaillie","active":true,"timeZone":"Etc/UTC"},"body":"Took some time today on this and issued the attached patch.\nI don't know if it is correct but it seems to solve the problem.\n\nWill run the tests to check for regressions.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nmervaillie","name":"nmervaillie","key":"nmervaillie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicolas Mervaillie","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-26T16:20:59.036+0000","updated":"2008-06-26T16:20:59.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482603/comment/12940111","id":"12940111","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Patch applied by SVN revision 691206","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-02T11:49:09.241+0000","updated":"2008-09-02T11:49:09.241+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1820/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0jxf3:"}}