{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483519","self":"https://issues.apache.org/jira/rest/api/2/issue/12483519","key":"AMQ-2945","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315625","id":"12315625","description":"","name":"5.4.2","archived":false,"released":true,"releaseDate":"2010-12-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2010-10-13T09:13:54.790+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 19 11:20:39 UTC 2010","customfield_12310420":"96211","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1910749721_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2010-10-19T11:20:39.626+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2945/watchers","watchCount":1,"isWatching":false},"created":"2010-09-27T08:34:49.905+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315623","id":"12315623","description":"version 5 feature complete","name":"5.4.0","archived":false,"released":true,"releaseDate":"2010-08-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315624","id":"12315624","description":"Maintenance release for 5.4.0","name":"5.4.1","archived":false,"released":true,"releaseDate":"2010-09-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-10-19T11:20:39.599+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313895","id":"12313895","name":"Message Store"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I am finding the KahaDB on a broker is becoming corrupted after a certain time of being disconnected (or perhaps rather, after a certain amount of messages are queued up). My config is extremely simple - originally 5.4.0 and now 5.4.1 on Windows with the default config, except adding a connection to a broker on an external machine with\n<networkConnectors>\n  <networkConnector uri=\"static:(tcp://machine1:61616,tcp://machine2:61616)\"/>\n</networkConnectors>\n\nIn this case the external machine/consumer is only on during business hours whereas the broker producing the messages is on 24/7. We're finding that generally the producer instance survives weeknights, during which it accumulates about 75,000 messages and then offloads them in the morning to\nthe consumer instance, but not weekends. Last time it failed after about collecting about 160,000 messages.\n\nI get the excepton: ERROR | Failed to start ActiveMQ JMS Message Broker. Reason: java.io.EOFException: Chunk stream does not exist at page: 0 | org.apache.activemq.broker.BrokerService | WrapperSimpleAppMain - and plenty more, I'll attach the log.\n\nOn 5.4.0 I found that only after deleting the file db.data was I able to restart the broker again. On one test run on 5.4.1 I'm finding that deleting db.data is not solving the problem.\n\nI noticed two other users described experiencing exactly the same problem:\nhttp://activemq.2283324.n4.nabble.com/Kaha-corruption-in-5-4-SNAPSHOT-td2366036.html\n\nTo replicate the problem, I think it would probably suffice to start a broker with default config and let 300,000 messages accumulate without being consumed - I'm guessing the problem should occur before you get there. But perhaps you'll need to create a networkconnector as I have done and try the same thing. Will attach log...","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461873","id":"12461873","filename":"5.4.0.log","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-27T08:37:26.717+0000","size":626646,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461873/5.4.0.log"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"159787","customfield_12312823":null,"summary":"KahaDB corrupted when too many messages accumulate: EOFException","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows XP, running as service.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483519/comment/12942982","id":"12942982","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"body":"Example of problem under 5.4.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-27T08:37:26.881+0000","updated":"2010-09-27T08:37:26.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483519/comment/12943055","id":"12943055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"body":"I've been working for a while now under 5.4.1 - sometimes I get slightly different errors but the good thing is that the crashes are very predictable/repeatable. The broker will not run 48 hours accumulating messages without crashing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-13T08:20:02.552+0000","updated":"2010-10-13T08:20:02.552+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483519/comment/12943059","id":"12943059","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"can you try your reproducible test with the latest 5.5-SNAPSHOT?\nThis looks like a variant of the now resolved https://issues.apache.org/activemq/browse/AMQ-2935\nhttps://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.5-SNAPSHOT/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-13T09:13:54.790+0000","updated":"2010-10-13T09:13:54.790+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483519/comment/12943088","id":"12943088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"body":"I tried it and it's working well, it accumulated data for 72 hours without crashing. I think you can consider this fixed, thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fletchgqc","name":"fletchgqc","key":"fletchgqc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Fletcher","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-19T10:19:28.909+0000","updated":"2010-10-19T10:19:28.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483519/comment/12943081","id":"12943081","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"duplicate of AMQ-2935","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-19T11:20:39.573+0000","updated":"2010-10-19T11:20:39.573+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2945/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0rpkn:"}}