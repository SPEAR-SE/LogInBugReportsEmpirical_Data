{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483425","self":"https://issues.apache.org/jira/rest/api/2/issue/12483425","key":"AMQ-2680","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315623","id":"12315623","description":"version 5 feature complete","name":"5.4.0","archived":false,"released":true,"releaseDate":"2010-08-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-03-31T09:13:08.480+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Apr 23 15:20:52 UTC 2010","customfield_12310420":"43791","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_178033973_*|*_5_*:*_2_*:*_520271806_*|*_4_*:*_1_*:*_1398824337","customfield_12312321":null,"resolutiondate":"2010-04-23T15:20:52.321+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2680/watchers","watchCount":1,"isWatching":false},"created":"2010-03-30T08:48:42.205+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315621","id":"12315621","description":"","name":"5.3.1","archived":false,"released":true,"releaseDate":"2010-03-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-04-23T15:20:52.299+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313894","id":"12313894","name":"Documentation"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"How to reproduce:\n\n- Download ActiveMQ 5.3.1\n- Start broker with the attached configuration\n   ---\n   <systemUsage>\n       <systemUsage>\n           <memoryUsage>\n               <memoryUsage limit=\"10 mb\"/>\n           </memoryUsage>\n           <storeUsage>\n               <storeUsage limit=\"10 mb\" name=\"queue/RemoteQ\"/>\n           </storeUsage>\n           <tempUsage>\n               <tempUsage limit=\"3 gb\"/>\n           </tempUsage>\n       </systemUsage>\n   </systemUsage>\n   ---\n- Start example producer/consumer\n   cd examples\n   ant producer -Durl=tcp://127.0.0.1:61616 -Dmax=100000 -Dsubject=queue/RemoteQ -Ddurable=true -DsleepTime=2\n   sleep 600\n   ant consumer -Durl=tcp://127.0.0.1:61616  -Dsubject=queue/RemoteQ -Dmax=100000 -DsleepTime=2\n\nThe problem: \nWhen the 10mb limit is reached, the producer is blocked forever.\nThe expected behavior is, that if a consumer cleans the queue, producers are able to post more messages.\nNeither cleaning up the queue, restarting producers and restarting the broker helps :-(\n\nIt would be also a good idea to enhance the documentation about producer-flow-control:\n(http://activemq.apache.org/producer-flow-control.html)\n- expected behavior\n- what is limited in detail by using system|store|tempUsage \n\nThe entire configuration :\n---\n<beans\n  xmlns=\"http://www.springframework.org/schema/beans\"\n  xmlns:amq=\"http://activemq.apache.org/schema/core\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd\n  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd\">\n\n    <bean class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\">\n        <property name=\"locations\">\n            <value>file:${activemq.base}/conf/credentials.properties</value>\n        </property>      \n    </bean>\n\n    <broker xmlns=\"http://activemq.apache.org/schema/core\" brokerName=\"localhost\" dataDirectory=\"${activemq.data}/data\" >\n\n        <destinationPolicy>\n            <policyMap>\n              <policyEntries>\n\n                <policyEntry topic=\">\" producerFlowControl=\"true\" memoryLimit=\"10mb\">\n\n                  <deadLetterStrategy>\n                    <!--\n                      Use the prefix 'DLQ.' for the destination name, and make\n                      the DLQ a queue rather than a topic\n                    -->\n                    <individualDeadLetterStrategy\n                      queuePrefix=\"DLQ.\" useQueueForQueueMessages=\"true\" />\n                  </deadLetterStrategy>\n\n                  <pendingSubscriberPolicy>\n                    <vmCursor />\n                  </pendingSubscriberPolicy>\n                </policyEntry>\n                <policyEntry queue=\">\" producerFlowControl=\"true\" memoryLimit=\"10mb\">\n                  <!-- Use VM cursor for better latency\n                       For more information, see:\n                       \n                       http://activemq.apache.org/message-cursors.html\n                       \n                  <pendingQueuePolicy>\n                    <vmQueueCursor/>\n                  </pendingQueuePolicy>\n                  -->\n                  <deadLetterStrategy>\n                    <!--\n                      Use the prefix 'DLQ.' for the destination name, and make\n                      the DLQ a queue rather than a topic\n                    -->\n                    <individualDeadLetterStrategy\n                      queuePrefix=\"DLQ.\" useQueueForQueueMessages=\"true\" />\n                  </deadLetterStrategy>\n\n\n                </policyEntry>\n              </policyEntries>\n            </policyMap>\n        </destinationPolicy> \n \n        <systemUsage>\n            <systemUsage>\n                <memoryUsage>\n                    <memoryUsage limit=\"10 mb\"/>\n                </memoryUsage>\n                <storeUsage>\n                    <storeUsage limit=\"10 mb\" name=\"queue/RemoteQ\"/>\n                </storeUsage>\n                <tempUsage>\n                    <tempUsage limit=\"3 gb\"/>\n                </tempUsage>\n            </systemUsage>\n        </systemUsage>\n                  \n        <transportConnectors>\n            <transportConnector name=\"openwire\" uri=\"tcp://0.0.0.0:61616\"/>\n        </transportConnectors>\n\n    </broker>\n\n    <import resource=\"jetty.xml\"/>\n    \n</beans>\n---\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461643","id":"12461643","filename":"activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-03-30T08:49:53.364+0000","size":3089,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461643/activemq.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461664","id":"12461664","filename":"activemq-broken-flow-control.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-04-07T10:48:59.045+0000","size":6321,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12461664/activemq-broken-flow-control.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461646","id":"12461646","filename":"producer-flow-control-problem.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-04-08T10:32:22.761+0000","size":396169,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461646/producer-flow-control-problem.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"159805","customfield_12312823":null,"summary":"Producer Flow Control seems to be broken","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"subtasks":[{"id":"12483437","key":"AMQ-2668","self":"https://issues.apache.org/jira/rest/api/2/issue/12483437","fields":{"summary":"Allow setting storeUsage limit per individual queue/topic","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"SLES 11, IBM JDK 1.6","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942035","id":"12942035","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"I have not looked at this in detail but my guess is that this is blocked on store usage and the store is not reclaimed when the queue is drained because of the default datafile size of the store. A data file can only be reclaimed when it is not referenced any more, which requires many small data files in your case. I think, you need to configure the persistence adapter to have a data file size less that 10mb for this to work as you expect.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-31T09:13:08.480+0000","updated":"2010-03-31T09:13:08.480+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942369","id":"12942369","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"body":"Additional information:\n\nIf i execute the described steps, ActiveMQ logs the following message:\n--- \n INFO | Usage Manager Store is Full. Producer (ID:XXXXXXXXXXX-43726-1270028281473-0:0:1:1) stopped to prevent flooding queue://queue/RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 30s)\n---\nThis message appears many time, \"blocking for : XXs\" is increased by 30s steps....\n\nAfter that, it is not possible to enqueue or dequeue any message!\n\nThis also happens with the following settings:\n(datafile 32mb, storeUsage 40mb)\n---\n         <persistenceAdapter>\n            <amqPersistenceAdapter directory=\"/srv/activemq/work/data\" maxFileLength=\"32mb\" \n             persistentIndex=\"true\" indexBinSize=\"32768\" indexPageSize=\"32768\" />\n         </persistenceAdapter>\n......\n......\n        <systemUsage>\n            <systemUsage>\n                <memoryUsage>\n                    <memoryUsage limit=\"10 mb\"/>\n                </memoryUsage>\n                <storeUsage>\n                    <storeUsage limit=\"40 mb\" name=\"queue/RemoteQ\"/>\n                    <storeUsage limit=\"40 mb\" name=\"queue/RemoteQ\"/>\n                </storeUsage>\n                <tempUsage>\n                    <tempUsage limit=\"3 gb\"/>\n                </tempUsage>\n            </systemUsage>\n        </systemUsage>\n---\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-03-31T09:47:59.756+0000","updated":"2010-03-31T09:47:59.756+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942093","id":"12942093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"The problem is the configured maxFileLength, it is too large for cleanup. The ampPeristenceAdapter will not delete the first or current journal data file during store cleanup, so in order for some space to be reclaimed on a cleanup there must be at least 3 data files in the journal. For a 40mb store limit 3 15MB files does the trick. This allows cleanup to have an effect. Your scenario works as expected with the following configuration:{code}\n<persistenceAdapter>\n<amqPersistenceAdapter directory=\"${activemq.base}/data/amq\" maxFileLength=\"15mb\"\npersistentIndex=\"true\" indexBinSize=\"32768\" indexPageSize=\"32768\" />\n</persistenceAdapter>{code}\n\nBtw: for faster recovery of large stores and for more linear enqueue rates, the kahaDB store will give better results. Similar config is needed w.r.t to store data file size.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-04-01T09:32:18.508+0000","updated":"2010-04-01T09:32:18.508+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942092","id":"12942092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"The key is understanding how the store is reclaimed, it depends on a data fixe being unreferenced. In essence this means there needs to be more than one data file in operation. For the amq store, more than 2 when a store limit is reached.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-04-01T10:15:56.048+0000","updated":"2010-04-01T10:15:56.048+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942040","id":"12942040","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"body":"Thanks for the configuration hints.\n \nIt seems now working as expected.\nI strongly recommend to put some logic in the configuration handling to detect bda configurations like that - sysadmins do normally not know details about the internals of the activemq message store implementation.\n\nNevertheless it seems that there is still a bug - after some time my messagequeue stopped receiving messages:\n(mention the configuration attached as activemq-broken-flow-control.xml)\n\n- Shutdown of producer was not possible\n- Shutdown of broker was not possible (kill -KILL was the only solution)\n- After restart the blocked queue does still not have any pending messages, but the queue is still\n  blocked  by producer flow control\n  (created a threaddump with a SUN jvm, by executing kill -QUIT, see beyond)\n\nThreadump;:\n{code}\nACTIVEMQ_HOME: /srv/activemq/install/current\nACTIVEMQ_BASE: /srv/activemq/install/current\nLoading message broker from: xbean:activemq.xml\n INFO | Using Persistence Adapter: AMQPersistenceAdapter(/srv/activemq/work/data)\n INFO | AMQStore starting using directory: /srv/activemq/work/data\n INFO | Kaha Store using data directory /srv/activemq/work/data/kr-store/state\n INFO | JMX consoles can connect to service:jmx:rmi:///jndi/rmi://localhost:51109/jmxrmi\n INFO | Active data files: [1, 2, 3]\n INFO | ActiveMQ 5.3.1 JMS Message Broker (localhost) is starting\n INFO | For help or more information please see: http://activemq.apache.org/\n INFO | Kaha Store using data directory /srv/activemq/work/data/kr-store/data\n INFO | Listening for connections at: tcp://esxschnapp3-x3850.argl.iv.FOOBAR.de:61616\n INFO | Connector openwire Started\n INFO | ActiveMQ JMS Message Broker (localhost, ID:esxschnapp3-x3850.argl.iv.FOOBAR.de-48924-1270635425111-0:0) started\n INFO | Logging to org.slf4j.impl.JCLLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog\n INFO | jetty-6.1.9\n INFO | ActiveMQ WebConsole initialized.\n INFO | Initializing Spring FrameworkServlet 'dispatcher'\n INFO | ActiveMQ Console at http://0.0.0.0:8161/admin\n INFO | Initializing Spring root WebApplicationContext\n INFO | Successfully connected to tcp://localhost:61616\n INFO | Camel Console at http://0.0.0.0:8161/camel\n INFO | ActiveMQ Web Demos at http://0.0.0.0:8161/demo\n INFO | RESTful file access application at http://0.0.0.0:8161/fileserver\n INFO | Started SelectChannelConnector@0.0.0.0:8161\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-9828-1270572546517-0:17247:1:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 30s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 30s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-9828-1270572546517-0:17247:1:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 60s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 60s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 90s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 30s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 120s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 60s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 150s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 90s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 180s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 120s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 210s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 150s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 240s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 180s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 270s)\n2010-04-07 12:21:55\nFull thread dump Java HotSpot(TM) 64-Bit Server VM (14.2-b01 mixed mode):\n\n\"InactivityMonitor Async Task: java.util.concurrent.ThreadPoolExecutor$Worker@717fed4\" daemon prio=10 tid=0x00007f71b0a1e000 nid=0x4164 waiting on condition [0x00007f71b4a3e000]\n   java.lang.Thread.State: TIMED_WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71c83a2210> (a java.util.concurrent.SynchronousQueue$TransferStack)\n        at java.util.concurrent.locks.LockSupport.parkNanos(Unknown Source)\n        at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(Unknown Source)\n        at java.util.concurrent.SynchronousQueue$TransferStack.transfer(Unknown Source)\n        at java.util.concurrent.SynchronousQueue.poll(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor.getTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"InactivityMonitor Async Task: java.util.concurrent.ThreadPoolExecutor$Worker@6cfcaac5\" daemon prio=10 tid=0x00007f71b0a1d000 nid=0x4163 waiting on condition [0x00007f71af7f6000]\n   java.lang.Thread.State: TIMED_WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71c83a2210> (a java.util.concurrent.SynchronousQueue$TransferStack)\n        at java.util.concurrent.locks.LockSupport.parkNanos(Unknown Source)\n        at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(Unknown Source)\n        at java.util.concurrent.SynchronousQueue$TransferStack.transfer(Unknown Source)\n        at java.util.concurrent.SynchronousQueue.poll(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor.getTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"JMX server connection timeout 94\" daemon prio=10 tid=0x0000000040530000 nid=0x414e in Object.wait() [0x00007f71b4c40000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd665e8> (a [I)\n        at com.sun.jmx.remote.internal.ServerCommunicatorAdmin$Timeout.run(Unknown Source)\n        - locked <0x00007f71efd665e8> (a [I)\n        at java.lang.Thread.run(Unknown Source)\n\n\"RMI TCP Connection(4)-10.130.39.230\" daemon prio=10 tid=0x00000000409e8800 nid=0x414d in Object.wait() [0x00007f71af3d6000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efbd6710> (a com.sun.jmx.remote.internal.ArrayNotificationBuffer)\n        at com.sun.jmx.remote.internal.ArrayNotificationBuffer.fetchNotifications(Unknown Source)\n        - locked <0x00007f71efbd6710> (a com.sun.jmx.remote.internal.ArrayNotificationBuffer)\n        at com.sun.jmx.remote.internal.ArrayNotificationBuffer$ShareBuffer.fetchNotifications(Unknown Source)\n        at com.sun.jmx.remote.internal.ServerNotifForwarder.fetchNotifs(Unknown Source)\n        at javax.management.remote.rmi.RMIConnectionImpl$2.run(Unknown Source)\n        at javax.management.remote.rmi.RMIConnectionImpl$2.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.management.remote.rmi.RMIConnectionImpl.fetchNotifications(Unknown Source)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at sun.rmi.server.UnicastServerRef.dispatch(Unknown Source)\n        at sun.rmi.transport.Transport$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at sun.rmi.transport.Transport.serviceCall(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"RMI TCP Connection(7)-10.130.39.230\" daemon prio=10 tid=0x0000000040479800 nid=0x414c runnable [0x00007f71b6760000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(Unknown Source)\n        at java.io.BufferedInputStream.fill(Unknown Source)\n        at java.io.BufferedInputStream.read(Unknown Source)\n        - locked <0x00007f71efd8af60> (a java.io.BufferedInputStream)\n        at java.io.FilterInputStream.read(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"btpool0-8\" prio=10 tid=0x00007f71a8b72800 nid=0x4143 in Object.wait() [0x00007f71af5f4000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc85688> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:490)\n        - locked <0x00007f71efc85688> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n\n\"ActiveMQ Transport: tcp:///10.73.11.1:46264\" daemon prio=10 tid=0x00000000402f7000 nid=0x4142 in Object.wait() [0x00007f71aefd4000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c2957450> (a java.lang.Object)\n        at org.apache.activemq.usage.Usage.waitForSpace(Usage.java:100)\n        - locked <0x00007f71c2957450> (a java.lang.Object)\n        at org.apache.activemq.broker.region.Queue.waitForSpace(Queue.java:1726)\n        at org.apache.activemq.broker.region.Queue.doMessageSend(Queue.java:568)\n        - locked <0x00007f71efb09768> (a java.lang.Object)\n        at org.apache.activemq.broker.region.Queue.send(Queue.java:539)\n        at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:354)\n        at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:445)\n        at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:224)\n        at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:126)\n        at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:95)\n        at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:133)\n        at org.apache.activemq.broker.TransportConnection.processMessage(TransportConnection.java:446)\n        at org.apache.activemq.command.ActiveMQMessage.visit(ActiveMQMessage.java:631)\n        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:300)\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:178)\n        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:113)\n        at org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:216)\n        - locked <0x00007f71efc544c0> (a org.apache.activemq.transport.InactivityMonitor$1)\n        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:84)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:204)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:186)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Connection Dispatcher: /10.73.11.1:46264\" daemon prio=10 tid=0x0000000040236000 nid=0x4141 in Object.wait() [0x00007f71af0d5000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc29000> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efc29000> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"btpool0-6\" prio=10 tid=0x00007f71a8449000 nid=0x4138 in Object.wait() [0x00007f71af4f3000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc86118> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:490)\n        - locked <0x00007f71efc86118> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n\n\"btpool0-4\" prio=10 tid=0x00007f71a86dd800 nid=0x4136 in Object.wait() [0x00007f71af6f5000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc84bf8> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:490)\n        - locked <0x00007f71efc84bf8> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n\n\"btpool0-2\" prio=10 tid=0x0000000040a17800 nid=0x4134 in Object.wait() [0x00007f71af8f7000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc80150> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:490)\n        - locked <0x00007f71efc80150> (a org.mortbay.thread.BoundedThreadPool$PoolThread)\n\n\"Timer-3\" daemon prio=10 tid=0x00007f71b056c000 nid=0x4132 in Object.wait() [0x00007f71afaf9000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd143d8> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71efd143d8> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"Timer-2\" daemon prio=10 tid=0x00007f71b0103000 nid=0x4131 in Object.wait() [0x00007f71afbfa000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd67d68> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71efd67d68> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"ActiveMQ Session: ID:esxschnapp3-x3850.argl.iv.FOOBAR.de-48924-1270635425111-2:0:1\" prio=10 tid=0x00007f71a8034000 nid=0x4130 in Object.wait() [0x00007f71afcfb000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd09b68> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efd09b68> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Topic  ActiveMQ.Advisory.Consumer.Queue.example.A\" daemon prio=10 tid=0x00000000409d8000 nid=0x412f in Object.wait() [0x00007f71afdfc000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb4cc78> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb4cc78> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"DefaultMessageListenerContainer-1\" prio=10 tid=0x00000000409dc000 nid=0x412e in Object.wait() [0x00007f71b4114000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd09d90> (a java.lang.Object)\n        at org.apache.activemq.MessageDispatchChannel.dequeue(MessageDispatchChannel.java:77)\n        - locked <0x00007f71efd09d90> (a java.lang.Object)\n        at org.apache.activemq.ActiveMQMessageConsumer.dequeue(ActiveMQMessageConsumer.java:447)\n        at org.apache.activemq.ActiveMQMessageConsumer.receive(ActiveMQMessageConsumer.java:572)\n        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveMessage(AbstractPollingMessageListenerContainer.java:405)\n        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:308)\n        at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:261)\n        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:982)\n        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:974)\n        at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:876)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Transport: tcp:///127.0.0.1:52732\" daemon prio=10 tid=0x00000000403ab800 nid=0x412d runnable [0x00007f71afefd000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(Unknown Source)\n        at org.apache.activemq.transport.tcp.TcpBufferedInputStream.fill(TcpBufferedInputStream.java:50)\n        at org.apache.activemq.transport.tcp.TcpTransport$2.fill(TcpTransport.java:527)\n        at org.apache.activemq.transport.tcp.TcpBufferedInputStream.read(TcpBufferedInputStream.java:58)\n        at org.apache.activemq.transport.tcp.TcpTransport$2.read(TcpTransport.java:512)\n        at java.io.DataInputStream.readInt(Unknown Source)\n        at org.apache.activemq.openwire.OpenWireFormat.unmarshal(OpenWireFormat.java:269)\n        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:211)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:203)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:186)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Connection Dispatcher: /127.0.0.1:52732\" daemon prio=10 tid=0x00000000403a9800 nid=0x412c in Object.wait() [0x00007f71afffe000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71ef966be8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71ef966be8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"ActiveMQ Transport: tcp://localhost/127.0.0.1:61616\" prio=10 tid=0x0000000040947000 nid=0x412a runnable [0x00007f71b4215000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(Unknown Source)\n        at org.apache.activemq.transport.tcp.TcpBufferedInputStream.fill(TcpBufferedInputStream.java:50)\n        at org.apache.activemq.transport.tcp.TcpTransport$2.fill(TcpTransport.java:527)\n        at org.apache.activemq.transport.tcp.TcpBufferedInputStream.read(TcpBufferedInputStream.java:58)\n        at org.apache.activemq.transport.tcp.TcpTransport$2.read(TcpTransport.java:512)\n        at java.io.DataInputStream.readInt(Unknown Source)\n        at org.apache.activemq.openwire.OpenWireFormat.unmarshal(OpenWireFormat.java:269)\n        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:211)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:203)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:186)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Failover Worker: 1811450195\" daemon prio=10 tid=0x00007f71a8009800 nid=0x4129 in Object.wait() [0x00007f71b4316000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd11618> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efd11618> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Timer-1\" daemon prio=10 tid=0x00007f71b0780800 nid=0x411e in Object.wait() [0x00007f71b4417000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c7fdd550> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71c7fdd550> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"Timer-0\" daemon prio=10 tid=0x00007f71b0018800 nid=0x411d in Object.wait() [0x00007f71b4539000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc86ea8> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71efc86ea8> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"Topic  ActiveMQ.Advisory.Producer.Queue.queue/Initialdaten_RemoteQ\" daemon prio=10 tid=0x0000000040827000 nid=0x411c in Object.wait() [0x00007f71b463a000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb4ad20> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb4ad20> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"btpool0-0 - Acceptor0 SelectChannelConnector@0.0.0.0:8161\" prio=10 tid=0x00007f71b0137800 nid=0x411b runnable [0x00007f71b4d41000]\n   java.lang.Thread.State: RUNNABLE\n        at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n        at sun.nio.ch.EPollArrayWrapper.poll(Unknown Source)\n        at sun.nio.ch.EPollSelectorImpl.doSelect(Unknown Source)\n        at sun.nio.ch.SelectorImpl.lockAndDoSelect(Unknown Source)\n        - locked <0x00007f71efd0c458> (a sun.nio.ch.Util$1)\n        - locked <0x00007f71efd0c440> (a java.util.Collections$UnmodifiableSet)\n        - locked <0x00007f71efbda070> (a sun.nio.ch.EPollSelectorImpl)\n        at sun.nio.ch.SelectorImpl.select(Unknown Source)\n        at org.mortbay.io.nio.SelectorManager$SelectSet.doSelect(SelectorManager.java:406)\n        at org.mortbay.io.nio.SelectorManager.doSelect(SelectorManager.java:166)\n        at org.mortbay.jetty.nio.SelectChannelConnector.accept(SelectChannelConnector.java:124)\n        at org.mortbay.jetty.AbstractConnector$Acceptor.run(AbstractConnector.java:537)\n        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:450)\n\n\"Topic  ActiveMQ.Advisory.Connection\" daemon prio=10 tid=0x000000004018a000 nid=0x411a in Object.wait() [0x00007f71b4e42000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb4ea18> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb4ea18> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"InactivityMonitor WriteCheck\" daemon prio=10 tid=0x0000000040829000 nid=0x4119 in Object.wait() [0x00007f71b473b000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd31248> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71efd31248> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"InactivityMonitor ReadCheck\" daemon prio=10 tid=0x0000000040838800 nid=0x4118 in Object.wait() [0x00007f71b483c000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc87c68> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71efc87c68> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"ActiveMQ Transport: tcp:///10.73.11.1:46253\" daemon prio=10 tid=0x0000000040824800 nid=0x4117 in Object.wait() [0x00007f71b493c000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c2957450> (a java.lang.Object)\n        at org.apache.activemq.usage.Usage.waitForSpace(Usage.java:100)\n        - locked <0x00007f71c2957450> (a java.lang.Object)\n        at org.apache.activemq.broker.region.Queue.waitForSpace(Queue.java:1726)\n        at org.apache.activemq.broker.region.Queue.doMessageSend(Queue.java:568)\n        - locked <0x00007f71c3d75ff8> (a java.lang.Object)\n        at org.apache.activemq.broker.region.Queue.send(Queue.java:539)\n        at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:354)\n        at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:445)\n        at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:224)\n        at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:126)\n        at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:95)\n        at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:133)\n        at org.apache.activemq.broker.TransportConnection.processMessage(TransportConnection.java:446)\n        at org.apache.activemq.command.ActiveMQMessage.visit(ActiveMQMessage.java:631)\n        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:300)\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:178)\n        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:113)\n        at org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:216)\n        - locked <0x00007f71efad4c00> (a org.apache.activemq.transport.InactivityMonitor$1)\n        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:84)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:204)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:186)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Connection Dispatcher: /10.73.11.1:46253\" daemon prio=10 tid=0x00000000406ee000 nid=0x4115 in Object.wait() [0x00007f71b4b3f000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efab86f8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efab86f8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"ActiveMQ Transport Server: tcp://0.0.0.0:61616\" daemon prio=10 tid=0x00007f71b0456800 nid=0x4111 runnable [0x00007f71b4f43000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(Unknown Source)\n        - locked <0x00007f71efc552b8> (a java.net.SocksSocketImpl)\n        at java.net.ServerSocket.implAccept(Unknown Source)\n        at java.net.ServerSocket.accept(Unknown Source)\n        at org.apache.activemq.transport.tcp.TcpTransportServer.run(TcpTransportServer.java:280)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Transport Server Thread Handler: tcp://0.0.0.0:61616\" daemon prio=10 tid=0x00007f71b0457800 nid=0x4110 waiting on condition [0x00007f71b5044000]\n   java.lang.Thread.State: TIMED_WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71efc555a0> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.parkNanos(Unknown Source)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(Unknown Source)\n        at java.util.concurrent.LinkedBlockingQueue.poll(Unknown Source)\n        at org.apache.activemq.transport.tcp.TcpTransportServer$1.run(TcpTransportServer.java:352)\n        at java.lang.Thread.run(Unknown Source)\n\n\"Producer Flow Control Timeout Task\" prio=10 tid=0x00007f71b00c2000 nid=0x410f waiting on condition [0x00007f71b514c000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71efb0bcb8> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.park(Unknown Source)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(Unknown Source)\n        at java.util.concurrent.DelayQueue.take(Unknown Source)\n        at org.apache.activemq.broker.region.Queue$FlowControlTimeoutTask.run(Queue.java:169)\n\n\"Queue:DLQ.queue/Initialdaten_RemoteQ\" daemon prio=10 tid=0x00007f71b00c0000 nid=0x410e in Object.wait() [0x00007f71b524d000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb0b1e8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb0b1e8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Checkpoint: queue://DLQ.queue/Initialdaten_RemoteQ\" daemon prio=10 tid=0x00007f71b00be800 nid=0x410d in Object.wait() [0x00007f71b534e000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb0a5e8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb0a5e8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Producer Flow Control Timeout Task\" prio=10 tid=0x00007f71b00bc000 nid=0x410c waiting on condition [0x00007f71b544f000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71efad75c0> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.park(Unknown Source)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(Unknown Source)\n        at java.util.concurrent.DelayQueue.take(Unknown Source)\n        at org.apache.activemq.broker.region.Queue$FlowControlTimeoutTask.run(Queue.java:169)\n\n\"Queue:example.A\" daemon prio=10 tid=0x00007f71b04c5000 nid=0x410b in Object.wait() [0x00007f71b5550000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efad6588> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efad6588> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Checkpoint: queue://example.A\" daemon prio=10 tid=0x00007f71b04c3000 nid=0x410a in Object.wait() [0x00007f71b5651000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efad59d8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efad59d8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Producer Flow Control Timeout Task\" prio=10 tid=0x00007f71b04c8000 nid=0x4109 waiting on condition [0x00007f71b5752000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71efb09a10> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.park(Unknown Source)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(Unknown Source)\n        at java.util.concurrent.DelayQueue.take(Unknown Source)\n        at org.apache.activemq.broker.region.Queue$FlowControlTimeoutTask.run(Queue.java:169)\n\n\"Queue:queue/Einarbeitungsdaten_RemoteQ\" daemon prio=10 tid=0x00007f71b04c7000 nid=0x4108 in Object.wait() [0x00007f71b5853000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb08f40> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb08f40> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Checkpoint: queue://queue/Einarbeitungsdaten_RemoteQ\" daemon prio=10 tid=0x00007f71b04c6000 nid=0x4107 in Object.wait() [0x00007f71b5954000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb08330> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb08330> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Topic  ActiveMQ.Advisory.Queue\" daemon prio=10 tid=0x00007f71b0613800 nid=0x4106 in Object.wait() [0x00007f71b5a55000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efb487a8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efb487a8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Producer Flow Control Timeout Task\" prio=10 tid=0x00007f71b04c9800 nid=0x4105 waiting on condition [0x00007f71b5b56000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71c3cbded0> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.park(Unknown Source)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(Unknown Source)\n        at java.util.concurrent.DelayQueue.take(Unknown Source)\n        at org.apache.activemq.broker.region.Queue$FlowControlTimeoutTask.run(Queue.java:169)\n\n\"Queue:queue/Initialdaten_RemoteQ\" daemon prio=10 tid=0x00007f71b061e800 nid=0x4104 in Object.wait() [0x00007f71b5c57000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efac23b8> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efac23b8> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"Checkpoint: queue://queue/Initialdaten_RemoteQ\" daemon prio=10 tid=0x00007f71b04b3800 nid=0x4103 in Object.wait() [0x00007f71b5d58000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efac1990> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71efac1990> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"ActiveMQ Journal Checkpoint Worker\" daemon prio=10 tid=0x00007f71b05d0800 nid=0x4102 in Object.wait() [0x00007f71b6b72000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71ef960c48> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:105)\n        - locked <0x00007f71ef960c48> (a java.lang.Object)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\"RMI RenewClean-[10.130.18.244:35003]\" daemon prio=10 tid=0x00007f71b04d8000 nid=0x4100 in Object.wait() [0x00007f71b5f5a000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efc91e50> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        - locked <0x00007f71efc91e50> (a java.lang.ref.ReferenceQueue$Lock)\n        at sun.rmi.transport.DGCClient$EndpointEntry$RenewCleanThread.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Data File Writer\" daemon prio=10 tid=0x00007f71b83b6000 nid=0x40ff in Object.wait() [0x00007f71b655e000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c7fd9fa0> (a org.apache.activemq.kaha.impl.async.DataFileAppender$1)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.kaha.impl.async.NIODataFileAppender.processQueue(NIODataFileAppender.java:80)\n        - locked <0x00007f71c7fd9fa0> (a org.apache.activemq.kaha.impl.async.DataFileAppender$1)\n        at org.apache.activemq.kaha.impl.async.DataFileAppender$2.run(DataFileAppender.java:230)\n\n\"RMI Scheduler(0)\" daemon prio=10 tid=0x00007f71b83b7000 nid=0x40fe waiting on condition [0x00007f71b665f000]\n   java.lang.Thread.State: TIMED_WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00007f71c28fd860> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.parkNanos(Unknown Source)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(Unknown Source)\n        at java.util.concurrent.DelayQueue.take(Unknown Source)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(Unknown Source)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor.getTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"GC Daemon\" daemon prio=10 tid=0x0000000040564800 nid=0x40fc in Object.wait() [0x00007f71b6970000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c2926ee0> (a sun.misc.GC$LatencyLock)\n        at sun.misc.GC$Daemon.run(Unknown Source)\n        - locked <0x00007f71c2926ee0> (a sun.misc.GC$LatencyLock)\n\n\"RMI Reaper\" prio=10 tid=0x000000004023a000 nid=0x40fb in Object.wait() [0x00007f71b6a71000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c28fbee0> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        - locked <0x00007f71c28fbee0> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        at sun.rmi.transport.ObjectTable$Reaper.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"RMI TCP Accept-51109\" daemon prio=10 tid=0x00007f71b8333800 nid=0x40f9 runnable [0x00007f71b6c73000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(Unknown Source)\n        - locked <0x00007f71c28817a8> (a java.net.SocksSocketImpl)\n        at java.net.ServerSocket.implAccept(Unknown Source)\n        at java.net.ServerSocket.accept(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"ActiveMQ Scheduler\" daemon prio=10 tid=0x00007f71b836e800 nid=0x40f8 in Object.wait() [0x00007f71b6d74000]\n   java.lang.Thread.State: TIMED_WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c28ba498> (a java.util.TaskQueue)\n        at java.util.TimerThread.mainLoop(Unknown Source)\n        - locked <0x00007f71c28ba498> (a java.util.TaskQueue)\n        at java.util.TimerThread.run(Unknown Source)\n\n\"RMI TCP Accept-0\" daemon prio=10 tid=0x00007f71b0092000 nid=0x40f6 runnable [0x00007f71b70c6000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(Unknown Source)\n        - locked <0x00007f71c2881d38> (a java.net.SocksSocketImpl)\n        at java.net.ServerSocket.implAccept(Unknown Source)\n        at java.net.ServerSocket.accept(Unknown Source)\n        at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"RMI TCP Accept-11099\" daemon prio=10 tid=0x00007f71b0090000 nid=0x40f5 runnable [0x00007f71b71c7000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(Unknown Source)\n        - locked <0x00007f71c28821c0> (a java.net.SocksSocketImpl)\n        at java.net.ServerSocket.implAccept(Unknown Source)\n        at java.net.ServerSocket.accept(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"RMI TCP Accept-0\" daemon prio=10 tid=0x00007f71b0082000 nid=0x40f4 runnable [0x00007f71b72c8000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(Unknown Source)\n        - locked <0x00007f71c2882630> (a java.net.SocksSocketImpl)\n        at java.net.ServerSocket.implAccept(Unknown Source)\n        at java.net.ServerSocket.accept(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"CommunicatorServer\" daemon prio=10 tid=0x00007f71b003c000 nid=0x40f3 runnable [0x00007f71b73c9000]\n   java.lang.Thread.State: RUNNABLE\n        at java.net.PlainDatagramSocketImpl.receive0(Native Method)\n        - locked <0x00007f71c289e760> (a java.net.PlainDatagramSocketImpl)\n        at java.net.PlainDatagramSocketImpl.receive(Unknown Source)\n        - locked <0x00007f71c289e760> (a java.net.PlainDatagramSocketImpl)\n        at java.net.DatagramSocket.receive(Unknown Source)\n        - locked <0x00007f71c289e7d0> (a java.net.DatagramPacket)\n        - locked <0x00007f71c289e718> (a java.net.DatagramSocket)\n        at com.sun.jmx.snmp.daemon.SnmpAdaptorServer.doReceive(Unknown Source)\n        at com.sun.jmx.snmp.daemon.CommunicatorServer.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\n\"Low Memory Detector\" daemon prio=10 tid=0x00007f71b0002000 nid=0x40ef runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"CompilerThread1\" daemon prio=10 tid=0x00007f71b826c000 nid=0x40ee waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"CompilerThread0\" daemon prio=10 tid=0x00007f71b826a000 nid=0x40ed waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"JDWP Event Helper Thread\" daemon prio=10 tid=0x00007f71b8267800 nid=0x40ec runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"JDWP Transport Listener: dt_socket\" daemon prio=10 tid=0x00007f71b8264000 nid=0x40eb runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Signal Dispatcher\" daemon prio=10 tid=0x00007f71b8258000 nid=0x40ea waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Finalizer\" daemon prio=10 tid=0x00007f71b823a000 nid=0x40e9 in Object.wait() [0x00007f71b7ffe000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c2927370> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        - locked <0x00007f71c2927370> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        at java.lang.ref.Finalizer$FinalizerThread.run(Unknown Source)\n\n\"Reference Handler\" daemon prio=10 tid=0x00007f71b8238000 nid=0x40e8 in Object.wait() [0x00007f71bc1af000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71c2926ed0> (a java.lang.ref.Reference$Lock)\n        at java.lang.Object.wait(Object.java:485)\n        at java.lang.ref.Reference$ReferenceHandler.run(Unknown Source)\n        - locked <0x00007f71c2926ed0> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=10 tid=0x000000004011d800 nid=0x40d8 in Object.wait() [0x00007f71f6488000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00007f71efd33780> (a [Z)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.activemq.console.command.StartCommand.waitForShutdown(StartCommand.java:161)\n        - locked <0x00007f71efd33780> (a [Z)\n        at org.apache.activemq.console.command.StartCommand.runTask(StartCommand.java:104)\n        at org.apache.activemq.console.command.AbstractCommand.execute(AbstractCommand.java:57)\n        at org.apache.activemq.console.command.ShellCommand.runTask(ShellCommand.java:136)\n        at org.apache.activemq.console.command.AbstractCommand.execute(AbstractCommand.java:57)\n        at org.apache.activemq.console.command.ShellCommand.main(ShellCommand.java:82)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at org.apache.activemq.console.Main.runTaskClass(Main.java:251)\n        at org.apache.activemq.console.Main.main(Main.java:107)\n\n\"VM Thread\" prio=10 tid=0x00007f71b8233800 nid=0x40e7 runnable \n\n\"GC task thread#0 (ParallelGC)\" prio=10 tid=0x0000000040127800 nid=0x40da runnable \n\n\"GC task thread#1 (ParallelGC)\" prio=10 tid=0x0000000040129800 nid=0x40db runnable \n\n\"GC task thread#2 (ParallelGC)\" prio=10 tid=0x000000004012b800 nid=0x40dc runnable \n\n\"GC task thread#3 (ParallelGC)\" prio=10 tid=0x000000004012d000 nid=0x40dd runnable \n\n\"GC task thread#4 (ParallelGC)\" prio=10 tid=0x000000004012f000 nid=0x40de runnable \n\n\"GC task thread#5 (ParallelGC)\" prio=10 tid=0x0000000040131000 nid=0x40df runnable \n\n\"GC task thread#6 (ParallelGC)\" prio=10 tid=0x0000000040132800 nid=0x40e0 runnable \n\n\"GC task thread#7 (ParallelGC)\" prio=10 tid=0x0000000040134800 nid=0x40e1 runnable \n\n\"GC task thread#8 (ParallelGC)\" prio=10 tid=0x0000000040136800 nid=0x40e2 runnable \n\n\"GC task thread#9 (ParallelGC)\" prio=10 tid=0x0000000040138000 nid=0x40e3 runnable \n\n\"GC task thread#10 (ParallelGC)\" prio=10 tid=0x000000004013a000 nid=0x40e4 runnable \n\n\"GC task thread#11 (ParallelGC)\" prio=10 tid=0x000000004013c000 nid=0x40e5 runnable \n\n\"GC task thread#12 (ParallelGC)\" prio=10 tid=0x000000004013d800 nid=0x40e6 runnable \n\n\"VM Periodic Task Thread\" prio=10 tid=0x00007f71b0094800 nid=0x40f7 waiting on condition \n\nJNI global references: 6239\n\nHeap\n PSYoungGen      total 199552K, used 51797K [0x00007f71e2800000, 0x00007f71f1f10000, 0x00007f71f2800000)\n  eden space 158528K, 23% used [0x00007f71e2800000,0x00007f71e4bdcd18,0x00007f71ec2d0000)\n  from space 41024K, 36% used [0x00007f71ef700000,0x00007f71f05b8820,0x00007f71f1f10000)\n  to   space 47232K, 0% used [0x00007f71ec2d0000,0x00007f71ec2d0000,0x00007f71ef0f0000)\n PSOldGen        total 199616K, used 95454K [0x00007f71c2800000, 0x00007f71ceaf0000, 0x00007f71e2800000)\n  object space 199616K, 47% used [0x00007f71c2800000,0x00007f71c8537b48,0x00007f71ceaf0000)\n PSPermGen       total 43264K, used 43152K [0x00007f71bd400000, 0x00007f71bfe40000, 0x00007f71c2800000)\n  object space 43264K, 99% used [0x00007f71bd400000,0x00007f71bfe24138,0x00007f71bfe40000)\n\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent flooding queue://queue/Einarbeitungsdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 210s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-12587-1270572565654-0:22380:1:1) stopped to prevent flooding queue://queue/Initialdaten_RemoteQ. See http://activemq.apache.org/producer-flow-control.html for more info (blocking for: 300s)\n INFO | Usage Manager Store is Full. Producer (ID:HOST2-46261-1270635495961-0:0:6:1) stopped to prevent floodi\n{code} \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-04-07T10:47:07.960+0000","updated":"2010-04-07T11:09:10.930+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942099","id":"12942099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"body":"Retested this issue with kahadb backend and created threaddumps (IBM jvm).\n\nThe name of the blocked queue was: queue/Einarbeitungsdaten_RemoteQ\n\nThe problem also appears by using the kahadb backend:\n\n{code}\n$ unzip -l producer-flow-control-problem.zip\nArchive:  producer-flow-control-problem.zip\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n        0  2010-04-08 12:20   producer-flow-control-problem/    \n   819119  2010-04-08 12:20   producer-flow-control-problem/activemq-javacore.20100408.115629.32099.0001.txt          (Threaddump of the ActiveMQ Standalone Broker)\n   150326  2010-04-08 12:20   producer-flow-control-problem/standalone-client-javacore.20100408.115629.4914.0001.txt  (Threaddump of a standalone consumer : apache-activemq-5.3.1/example)\n     6575  2010-04-08 12:20   producer-flow-control-problem/activemq.xml                                              (Configuration of the broker)\n  2174495  2010-04-08 12:20   producer-flow-control-problem/jboss-javacore.20100408.115629.3419.0001.txt              (Threaddump of JBOSS Appserver which runs two message driven beans, consumers)  \n---------                     -------\n  3150515                     5 files\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-04-08T10:32:22.908+0000","updated":"2010-04-08T10:32:22.908+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942387","id":"12942387","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"The problem with the hang is DLQ processing. The stack trace of the broker has:{code}3XMTHREADINFO      \"ActiveMQ Transport: tcp:///127.0.0.1:53609\" TID:0x00000000010B1200, j9thread_t:0x00000000025A8890, state:CW, prio=8\n3XMTHREADINFO1            (native thread ID:0xFD2, native priority:0x8, native policy:UNKNOWN)\n4XESTACKTRACE          at java/lang/Object.wait(Native Method)\n4XESTACKTRACE          at java/lang/Object.wait(Object.java:196(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/usage/Usage.waitForSpace(Usage.java:87(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/region/Queue.waitForSpace(Queue.java:1726)\n4XESTACKTRACE          at org/apache/activemq/broker/region/Queue.doMessageSend(Queue.java:568)\n4XESTACKTRACE          at org/apache/activemq/broker/region/Queue.send(Queue.java:539)\n4XESTACKTRACE          at org/apache/activemq/broker/region/AbstractRegion.send(AbstractRegion.java:354)\n4XESTACKTRACE          at org/apache/activemq/broker/region/RegionBroker.send(RegionBroker.java:445)\n4XESTACKTRACE          at org/apache/activemq/broker/TransactionBroker.send(TransactionBroker.java:224)\n4XESTACKTRACE          at org/apache/activemq/broker/BrokerFilter.send(BrokerFilter.java:126)\n4XESTACKTRACE          at org/apache/activemq/broker/CompositeDestinationBroker.send(CompositeDestinationBroker.java:95)\n4XESTACKTRACE          at org/apache/activemq/broker/MutableBrokerFilter.send(MutableBrokerFilter.java:133)\n4XESTACKTRACE          at org/apache/activemq/util/BrokerSupport.doResend(BrokerSupport.java:65)\n4XESTACKTRACE          at org/apache/activemq/util/BrokerSupport.resendNoCopy(BrokerSupport.java:36)\n4XESTACKTRACE          at org/apache/activemq/broker/region/RegionBroker.sendToDeadLetterQueue(RegionBroker.java:727)\n4XESTACKTRACE          at org/apache/activemq/broker/region/PrefetchSubscription.sendToDLQ(PrefetchSubscription.java:457(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/region/PrefetchSubscription.acknowledge(PrefetchSubscription.java:195(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/region/AbstractRegion.acknowledge(AbstractRegion.java:373(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/region/RegionBroker.acknowledge(RegionBroker.java:470(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/TransactionBroker.acknowledge(TransactionBroker.java:194(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/BrokerFilter.acknowledge(BrokerFilter.java:74(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/BrokerFilter.acknowledge(BrokerFilter.java:74(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/MutableBrokerFilter.acknowledge(MutableBrokerFilter.java:85(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/TransportConnection.processMessageAck(TransportConnection.java:451(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/command/MessageAck.visit(MessageAck.java(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/TransportConnection.service(TransportConnection.java:300(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/broker/TransportConnection$1.onCommand(TransportConnection.java:178(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/transport/TransportFilter.onCommand(TransportFilter.java:68(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/transport/WireFormatNegotiator.onCommand(WireFormatNegotiator.java:109(Compiled Code))\n4XESTACKTRACE          at org/apache/activemq/transport/InactivityMonitor.onCommand(InactivityMonitor.java:216(Compiled Code))\n{code}\n\nA poison ack is coming from one of the consumers, the message has exceeded its redelivery quota so is is being discarded. However, the DLQ for a persistent message uses the same store that is currently full, so that ack is blocking on store usage which blocks the consumer.\n\nThere are a few options here:\n* You could use a topic for the DLQ and the persistence will be optimised out if there are no durable subs to the DLQ topic for that Destination.\n* You could disable DLQ processing for that destination\n* You could investigate the redelivery issue on the consumer to avoid the use of the DQL by configuring a redelivery policy that does not limit the redeliveries. The message will remain on the consumer till it is accepted.\n* a resolution to https://issues.apache.org/activemq/browse/AMQ-2668 would help, the test q could block a 70% leaving 30% for DLQ handling.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-04-14T11:18:33.065+0000","updated":"2010-04-14T11:18:33.065+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942392","id":"12942392","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"link to per destination store usage high water mark policy feature https://issues.apache.org/activemq/browse/AMQ-2668","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-04-14T11:19:54.785+0000","updated":"2010-04-14T11:19:54.785+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942391","id":"12942391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"body":"Very interesting - i will try to verify this with my setup...\n\nIt would e very helpful for sysadmins to get a warning message which provides information that a queue is blocked for enqueue/dequeue \nbecause of the fact that there is no space for potentially submitting messages to the dead letter queue....\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scoopex","name":"scoopex","key":"scoopex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Schöchlin","active":true,"timeZone":"Europe/Berlin"},"created":"2010-04-14T12:23:03.942+0000","updated":"2010-04-14T12:23:03.942+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483425/comment/12942514","id":"12942514","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Think the fix for https://issues.apache.org/activemq/browse/AMQ-2668 sort this. Reopen if here is any update or change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2010-04-23T15:20:52.288+0000","updated":"2010-04-23T15:20:52.288+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2680/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0rpon:"}}