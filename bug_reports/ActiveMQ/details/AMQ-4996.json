{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12692001","self":"https://issues.apache.org/jira/rest/api/2/issue/12692001","key":"AMQ-4996","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2014-01-29T16:24:29.696+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Apr 29 15:23:56 UTC 2014","customfield_12310420":"370591","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_7792970645_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-04-29T15:23:56.614+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4996/watchers","watchCount":2,"isWatching":false},"created":"2014-01-29T10:41:06.008+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318549","id":"12318549","name":"5.5.1","archived":false,"released":true,"releaseDate":"2011-10-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-04-29T15:23:56.649+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"In production we are getting org.apache.activemq.transport.RequestTimedOutIOException exceptions thrown sometimes when we execute the send command. The timeout is set to 5 seconds and it blocks for 5 seconds and then throws the exception. The message is actually sent to the broker successfully (I don't know if it's sent immediately or if there was a delay before it gets there).\nWe are communicating with the broker via TCP but it is on the localhost.\nThis happens 'every so often' with no explanation that I can find. No errors appear in the broker logs (and no clues when configured to DEBUG level). The volume is very low; a message every 20-30 seconds or so, and they are immediately handled by a consumer - the broker has not run out of storage or memory.\nIt seems to happen in bursts (e.g. it happened 4 times within 10 minutes, but not on every message, and then didn't happen again all day).\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"370901","customfield_12312823":null,"summary":"org.apache.activemq.transport.RequestTimedOutIOException thrown by producer.send() for no obvious reason. Message is actually sent.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonnygraham","name":"jonnygraham","key":"jonnygraham","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Graham","active":true,"timeZone":"Asia/Gaza"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonnygraham","name":"jonnygraham","key":"jonnygraham","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Graham","active":true,"timeZone":"Asia/Gaza"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Redhat Linux","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12692001/comment/13885481","id":"13885481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Is there something kicking in an the broker side that's causing a delay, such as GC or other high CPU tasks.  That would explain a pause that results in this error. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-01-29T16:24:29.696+0000","updated":"2014-01-29T16:24:29.696+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12692001/comment/13886365","id":"13886365","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonnygraham","name":"jonnygraham","key":"jonnygraham","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Graham","active":true,"timeZone":"Asia/Gaza"},"body":"No high CPU tasks at that time. The system is sizing to cope with processing 10s of transactions per second but we're seeing this error even at very quiet times (one transaction every 20-30 seconds) - ie producing a message every 20-30 seconds.\n\nI didn't actually check the GC but there's very little going on so it's highly unlikely that GC is causing such a long delay. Looking at my logs I can see that around that time the average time we spent on a transaction (excluding message production) is under 200ms with nothing at all above over 1.2s - if GC was causing a pause I'd expect to see that impacting those timings as well.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonnygraham","name":"jonnygraham","key":"jonnygraham","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Graham","active":true,"timeZone":"Asia/Gaza"},"created":"2014-01-30T07:57:13.235+0000","updated":"2014-01-30T07:57:13.235+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12692001/comment/13890470","id":"13890470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonnygraham","name":"jonnygraham","key":"jonnygraham","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Graham","active":true,"timeZone":"Asia/Gaza"},"body":"During the 5 seconds between the start of the send and the receipt of the timeout, the broker log is showing me that background things are happening. For example, I got a timeout at 05:08:48 (send started at 05:05:43) and the log looks like this:\n28/01/2014 05:08:42,536 (Thread-38) DEBUG : Stopping transport tcp://localhost.localdomain/127.0.0.1:2348\n28/01/2014 05:08:42,536 (ActiveMQ Task-15799) DEBUG : Stopping connection: /127.0.0.1:35791\n28/01/2014 05:08:42,537 (ActiveMQ Task-15799) DEBUG : Stopping transport tcp:///127.0.0.1:35791\n28/01/2014 05:08:42,538 (ActiveMQ Task-15799) DEBUG : Stopped transport: /127.0.0.1:35791\n28/01/2014 05:08:42,539 (ActiveMQ Task-15799) DEBUG : Connection Stopped: /127.0.0.1:35791\n28/01/2014 05:08:45,464 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@46fff62d 9999 ms elapsed since last write check.\n28/01/2014 05:08:45,653 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@3f65bc68 10001 ms elapsed since last write check.\n28/01/2014 05:08:45,753 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@48ba57c4 10001 ms elapsed since last write check.\n28/01/2014 05:08:45,905 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@c28a9ee 10001 ms elapsed since last write check.\n28/01/2014 05:08:45,982 (ActiveMQ Journal Checkpoint Worker) DEBUG : Checkpoint started.\n28/01/2014 05:08:47,105 (InactivityMonitor ReadCheck) DEBUG : 29999 ms elapsed since last read check.\n28/01/2014 05:08:47,106 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@4c28b3c3 10001 ms elapsed since last write check.\n28/01/2014 05:08:47,295 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@41383426 10000 ms elapsed since last write check.\n28/01/2014 05:08:47,295 (InactivityMonitor ReadCheck) DEBUG : 29999 ms elapsed since last read check.\n28/01/2014 05:08:49,563 (InactivityMonitor ReadCheck) DEBUG : 30000 ms elapsed since last read check.\n28/01/2014 05:08:49,563 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@6f18ba62 10000 ms elapsed since last write check.\n28/01/2014 05:08:49,638 (InactivityMonitor ReadCheck) DEBUG : 29999 ms elapsed since last read check.\n28/01/2014 05:08:49,638 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@2d1624be 10001 ms elapsed since last write check.\n28/01/2014 05:08:50,665 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@751e1ab5 10002 ms elapsed since last write check.\n28/01/2014 05:08:50,862 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@60d96f5b 10000 ms elapsed since last write check.\n28/01/2014 05:08:51,171 (InactivityMonitor WriteCheck) DEBUG : org.apache.activemq.transport.InactivityMonitor$2@6bf450a5 10001 ms elapsed since last write check.\n28/01/2014 05:08:51,268 (ActiveMQ Journal Checkpoint Worker) DEBUG : Checkpoint done.\n28/01/2014 05:08:51,771 (ActiveMQ Journal Checkpoint Worker) DEBUG : Checkpoint started.\n28/01/2014 05:08:51,798 (ActiveMQ Journal Checkpoint Worker) DEBUG : Checkpoint done.\n\nAny insight would be helpful!\nThanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonnygraham","name":"jonnygraham","key":"jonnygraham","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jonathan Graham","active":true,"timeZone":"Asia/Gaza"},"created":"2014-02-04T07:35:36.894+0000","updated":"2014-02-04T07:35:36.894+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12692001/comment/13984404","id":"13984404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No test case to reproduce this and the version is quite old so you would need to move to a supported version such as v5.9.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-04-29T15:23:56.644+0000","updated":"2014-04-29T15:23:56.644+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4996/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1rvef:"}}