{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483628","self":"https://issues.apache.org/jira/rest/api/2/issue/12483628","key":"AMQ-2293","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-09-28T05:14:05.761+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jan 24 22:36:43 UTC 2013","customfield_12310420":"44189","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_113891047293_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-01-25T07:15:27.529+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2293/watchers","watchCount":4,"isWatching":false},"created":"2009-06-17T02:51:20.269+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[{"id":"12363506","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12363506","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12613792","key":"AMQ-4140","self":"https://issues.apache.org/jira/rest/api/2/issue/12613792","fields":{"summary":"maven-activemq-plugin fails to resolve path to XBean file in multi-module builds, and does not have a skip flag","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davsclaus","name":"davsclaus","key":"davsclaus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"},"displayName":"Claus Ibsen","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-01-25T07:15:27.556+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"If one attampts to specify an absolute path the the activemq configuration file in a maven project using the maven parameters:\n{code:xml}\n<plugin>\n    <groupId>org.apache.activemq.tooling</groupId>\n    <artifactId>maven-activemq-plugin</artifactId>\n    <version>${activemq.version}</version>\n    <configuration>\n        <configUri>xbean:file:///${basedir}/src/test/activemq/conf/activemq.xml</configUri>\n    </configuration>\n</plugin>\n{code}\n\nthe broker will fail because ${basedir} in maven does not expand to a valid URI string.\n\nTried as well:\n2) Using the xbeam:conf/activemq.xml does not work either as the mojo does not contain the directory on the classpath.\n\n3) Using the base dir and setting the configURI to xbean:file:///./src/test/qctivemq/conf/activemq.xml does work when executing the test phase within a single maven project but as soon as the activemq plugin is run from a module that is part of a project (see attachment example) then the . refers to the path of the parent project and the broker fails to find the file again.\n\nAs far as I can see there is not really a sufficient workaround using the activemq.base activemq.home system properties and hence I propose to add another configuration alternative to the maven-activemq-plugin called configFile. This can then be set with the according absolute reference and the URI is properly constructred using the underlying JVM java.io.File.toURI(). Patch attached.\n\nThe logic implemented by the patch is, if a configFile is set on the activemq plugin then it will construct a xbean:file:[uri]  else it will use configUri (as usual).\n\n\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461539","id":"12461539","filename":"AMQ-2293.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"created":"2009-06-17T02:53:20.825+0000","size":2051,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461539/AMQ-2293.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12546954","id":"12546954","filename":"example.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damian+hudson","name":"damian hudson","key":"damian hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Damian Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-28T05:21:10.116+0000","size":3189,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12546954/example.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12566390","id":"12566390","filename":"pom.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"created":"2013-01-24T22:36:43.344+0000","size":4754,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12566390/pom.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461540","id":"12461540","filename":"test-project.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"created":"2009-06-17T02:56:05.191+0000","size":38058,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461540/test-project.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10042","value":"Patch Available","id":"10042"}],"customfield_12310921":null,"customfield_12310920":"59907","customfield_12312823":null,"summary":"ActiveMQ Maven plugin fails to spin up broker in multi module project","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows ONLY","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483628/comment/12941518","id":"12941518","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"body":"Patch to fix the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"created":"2009-06-17T02:53:20.911+0000","updated":"2009-06-17T02:53:20.911+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483628/comment/12941517","id":"12941517","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"body":"An example project that works after applying the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbertram","name":"nbertram","key":"nbertram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niels Bertram","active":true,"timeZone":"Etc/UTC"},"created":"2009-06-17T02:56:05.227+0000","updated":"2009-06-17T02:56:05.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483628/comment/13465359","id":"13465359","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damian+hudson","name":"damian hudson","key":"damian hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Damian Hudson","active":true,"timeZone":"Etc/UTC"},"body":"I'm seeing similar behaviour with the maven-activemq-plugin (version 5.6.0).  When I try and use the ${basedir} when setting <configUri>xbean:file:${basedir}/config/activemq.xml</configUri>, it spits out the following error \"Failed to start ActiveMQ Broker: Illegal character in opaque part at index 16\" when I run mvn activemq:run.   Seems to get upset with the backslashes in ${basedir} (eg. xbean:file:c:\\dev\\workspace\\example/config/activemq.xml)  this isn't an issue in Linux, only Windows machines.\n\nI can get around the issue by using a relative path, as Niels did, but also run into problems with Multimoduled projects.  To get around the issue I've had to use GMaven plugin to change the slashes in ${basedir} to forward slashes and feed the modified property into <configUri>, the workaround works, but it's ugly.  If a change could be made to the plugin to cater for the Windows backslashes that would resolve the issue. \n\nDOESN'T WORK.....\n<configUri>xbean:file:${basedir}/config/activemq.xml</configUri>\n<configUri>xbean:file:C:\\workspace\\activemqMavenIssue\\example\\config\\activemq.xml</configUri>\n<configUri>xbean:file:C:\\\\workspace\\\\activemqMavenIssue\\\\example\\\\config\\\\activemq.xml</configUri>\n\nWORKS.....\n<configUri>xbean:file:C:/workspace/activemqMavenIssue/example/config/activemq.xml</configUri>\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damian+hudson","name":"damian hudson","key":"damian hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Damian Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-28T05:14:05.761+0000","updated":"2012-09-28T05:14:05.761+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483628/comment/13561992","id":"13561992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"body":"Looks like Tim fixed this in https://issues.apache.org/jira/browse/AMQ-4140\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"created":"2013-01-24T21:19:14.352+0000","updated":"2013-01-24T21:19:14.352+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483628/comment/13562072","id":"13562072","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"body":"So I tried with the latest snapshot on windows and verified that it works. See the pom.xml i attached for how to point to the latest snapshot.\n\nIf someone else can confirm, so we can close this ticket....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"created":"2013-01-24T22:36:43.348+0000","updated":"2013-01-24T22:36:43.348+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2293/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0amfj:"}}