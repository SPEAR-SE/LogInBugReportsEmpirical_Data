{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483362","self":"https://issues.apache.org/jira/rest/api/2/issue/12483362","key":"AMQ-1997","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315626","id":"12315626","description":"","name":"5.5.0","archived":false,"released":true,"releaseDate":"2011-04-01"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2008-11-06T19:43:10.664+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 24 22:34:06 UTC 2011","customfield_12310420":"46506","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_72596053575_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-02-24T22:34:06.016+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1997/watchers","watchCount":1,"isWatching":false},"created":"2008-11-06T16:59:52.464+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-02-24T22:34:06.033+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Hi there,\n\nI just installed ActiveMQ 5.2, especially for the fix of the memory leak problem in broker, in version 5.1 (bug AMQ-1790), but the issue is still occurring.\n\nAfter instantiating circa 1300 temp queues I am getting the following error: java.lang.OutOfMemoryError : unable to create new native thread\n\nAlso if I go to the web admin (http://localhost:8161/admin/topics.jsp) I can see a long list of temp queues that don't go anywhere...\n\nWould you be able to advise us when the fix for this issue will be released.\n\nMany thanks\n\nN","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"235764","customfield_12312823":null,"summary":" Memory leak in broker - Temporary Queue related (relating to bug AMQ-1790)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nnzz","name":"nnzz","key":"nnzz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"NNZZ","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nnzz","name":"nnzz","key":"nnzz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"NNZZ","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"ActiveMQ broker 5.2\nSpring based application with synchronous messages (temp queue based) ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483362/comment/12940464","id":"12940464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Do you either:\n- delete the temporary queue when you do not need it anymore\n- close the connection\n\n?\nNote that connection pooling in Spring or JEE containers will generally avoid closing the connection.\n\n\nAccording to the 1.1 JMS specification temporary queues are not deleted before you do one of these.\n\nSee http://java.sun.com/j2ee/1.4/docs/api/  javax.jms.Session.createTemporaryQueue():\n\n  \"Creates a TemporaryQueue object. Its lifetime will be that of the Connection unless it is deleted earlier.\"\n\nOr section 4.4.3 \"Creating Temporary Destinations\" of Java Message Service Specification - version 1.1\nhttp://java.sun.com/products/jms/docs.html\n\n{quote}\nAlthough sessions are used to create temporary destinations, this is only for\nconvenience. Their scope is actually the entire connection. Their lifetime is that\nof their connection, and any of the connection's sessions is allowed to create a\nMessageConsumer for them.\n\n..................................\n\nSince temporary destinations may allocate resources outside the JVM, they\nshould be deleted if they are no longer needed. They will be automatically\ndeleted when they are garbage collected or when their connection is closed.\n{quote}\n\nBTW: Gary, this is not like implemented now. See AMQ-1979\nOr is the deletion triggered by garbage collection? (i.e. no references left)\nIn that case it is correct.\n\nHans\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-06T19:43:10.664+0000","updated":"2008-11-06T19:47:59.988+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483362/comment/12940469","id":"12940469","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nnzz","name":"nnzz","key":"nnzz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"NNZZ","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for that. I did not realize the temp queues remain live until the connection is closed...\n\nHowever, I am not clear of how I can delete the temp queues without closing the connection. I am using .Net (and therefore Apache.NMS.ActiveMQ), and I don't see any delete method in Apache.NMS.ActiveMQ.Commands.ActiveMQTempQueue (which is the runtime type returned when I create temp queue via the session), and  I also don't see any delete method in Apache.NMS.ITemporaryQueue interface.\n\nI digged in the code a bit and found the following method: Apache.NMS.ActiveMQ.Connection.DisposeOf which deletes the temp queue when I pass Apache.NMS.ActiveMQ.Commands.ActiveMQTempQueue to it. However, it seems to kill the connection, as when I try to connect with the broker again right after I called disposeOf I am getting the following error: \n\nSystem.Exception: Error writing to broker.  Transport connection is closed.\n  at Apache.NMS.ActiveMQ.Transport.Tcp.TcpTransport.Oneway(Command command) : Transport connection error: Error writing to broker.  Transport connection is closed.\n\nWould you be able to advise us how we can delete temp queues without closing the connection.\n\nMany thanks\n\nN\n\n\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nnzz","name":"nnzz","key":"nnzz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"NNZZ","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-07T11:09:17.350+0000","updated":"2008-11-07T15:38:10.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483362/comment/12999091","id":"12999091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"NMS.ActiveMQ Connection class has a DeleteDesination method for this.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-02-24T22:34:06.031+0000","updated":"2011-02-24T22:34:06.031+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1997/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i14qjb:"}}