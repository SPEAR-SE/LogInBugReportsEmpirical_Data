{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483325","self":"https://issues.apache.org/jira/rest/api/2/issue/12483325","key":"AMQ-1726","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315630","id":"12315630","description":"Issues that need to be reviewed - do we keep 'em or do we kick 'em? ","name":"NEEDS_REVIEW","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2013-11-06T19:11:57.818+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Nov 06 19:11:57 UTC 2013","customfield_12310420":"84787","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_173000552382_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-11-06T19:11:57.796+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1726/watchers","watchCount":1,"isWatching":false},"created":"2008-05-14T11:29:25.441+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315618","id":"12315618","description":"","name":"5.1.0","archived":false,"released":true,"releaseDate":"2008-05-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-11-06T19:11:57.821+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When time to live is set on producer and message expire then receive attemp is performed (durable Topic subscriber), message goes to ActiveMQ.DLQ. After second expired message statistic for DLQ size shows 3. After 3. message DLQ size is 6.  When purge() method on DLQ is performed, jconsole fails and shows nothing - only reconnect to jconsole repair this state (statistic on DLQ is still wrong).\n\nUse case descr.\n\n1. run ConsumerDlqTest to create durable subscription\n2. stop ConsumerDlqTest \n3. run ProducerDlqTest to send one message to Topic\n4. wait 1000ms and run ConsumerDlqTest again\n5. repeat 3.\n6. repeat 4.\n7. jconsole statistic for ActiveMQ.DLQ - QueueSize = 3 (while 2 messages are inside)\n8. press purge() (operation on ActiveMQ.DLQ)\n\nresult is shown on picture in attachment\n\n9.reconect to activemq using jconsole\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461050","id":"12461050","filename":"ASF.LICENSE.NOT.GRANTED--dlq.bmp","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=durokuruc","name":"durokuruc","key":"durokuruc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Juraj Kuruc","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-14T11:29:25.447+0000","size":586586,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12461050/ASF.LICENSE.NOT.GRANTED--dlq.bmp"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461115","id":"12461115","filename":"ASF.LICENSE.NOT.GRANTED--dlqTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=durokuruc","name":"durokuruc","key":"durokuruc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Juraj Kuruc","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-14T11:29:25.445+0000","size":4946,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12461115/ASF.LICENSE.NOT.GRANTED--dlqTest.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59837","customfield_12312823":null,"summary":"mismatched DLQ statistic using jconsole, when message expire in Topic with durable subscriber","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=durokuruc","name":"durokuruc","key":"durokuruc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Juraj Kuruc","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=durokuruc","name":"durokuruc","key":"durokuruc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Juraj Kuruc","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows XP \njava version \"1.6.0_02\"\nJava(TM) SE Runtime Environment (build 1.6.0_02-b05)\nJava HotSpot(TM) Client VM (build 1.6.0_02-b05, mixed mode, sharing)","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483325/comment/12939654","id":"12939654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=durokuruc","name":"durokuruc","key":"durokuruc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Juraj Kuruc","active":true,"timeZone":"Etc/UTC"},"body":"For addition to this isssue, if you try to start and stop durable consumer on Topic which had one expired message, DLQ message size increase every time.\n\nUse case descr.\n\n1. run ConsumerDlqTest to create durable subscription\n2. stop ConsumerDlqTest\n3. run ProducerDlqTest to send one message to Topic\n4. wait 1000ms and run ConsumerDlqTest again\n5. run ConsumerDlqTest again\n6. run ConsumerDlqTest again\n\nResult is that DLQ size in jconsole shows 6 messages.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=durokuruc","name":"durokuruc","key":"durokuruc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Juraj Kuruc","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-14T15:41:12.048+0000","updated":"2008-05-14T15:41:12.048+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483325/comment/13815168","id":"13815168","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"I couldn't reproduce this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-11-06T19:11:57.818+0000","updated":"2013-11-06T19:11:57.818+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1726/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0alzz:"}}