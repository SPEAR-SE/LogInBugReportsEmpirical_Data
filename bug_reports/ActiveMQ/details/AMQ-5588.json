{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12775365","self":"https://issues.apache.org/jira/rest/api/2/issue/12775365","key":"AMQ-5588","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2015-02-16T13:44:45.499+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu May 28 23:07:05 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1536645_*|*_6_*:*_2_*:*_93011730_*|*_4_*:*_1_*:*_8667127814","customfield_12312321":null,"resolutiondate":"2015-05-28T23:07:04.917+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5588/watchers","watchCount":2,"isWatching":false},"created":"2015-02-16T13:19:08.864+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-28T23:07:05.032+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I am having issues discussed in the 2 defects (AMQ-2114) & (AMQCPP-545)\n(AMQ-2114) Failover transport should not hang on startup if it cannot connect\n\n(AMQCPP-545) Failover transport timeout options should only operate on Message sends.\n\nIf AMQ is down while on startup, the reconnect strategy does not work and blocks there forever. \nTo overcome this blocking issue, we are setting timeout on the broker. But, this will throw a Failover timeout exception. \n\nOnce this exception occurs, the mule server is not able to deploy the applications which are depending on this connection. However, we have no issues if the connection goes down after the applications are deployed. The applications successfully reconnect to AMQ once, the connection is up.\n\nThis problem is happening if the mule server is started while the AMQ is down. The applications fail to get deployed despite the <reconnect-forever blocking=\"false\" frequency=\"3000\"/> strategy. This is because of the Failover timeout exception.\n\nHere is the part of log:\nCaused by: java.io.IOException: Failover timeout of 30000 ms reached.\n        at org.apache.activemq.transport.failover.FailoverTransport.oneway(FailoverTransport.java:532)\n        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n        at org.apache.activemq.transport.ResponseCorrelator.asyncRequest(ResponseCorrelator.java:81)\n        at org.apache.activemq.transport.ResponseCorrelator.request(ResponseCorrelator.java:86)\n        at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1284)\n\nPlease, help me with the fix. We are using Unix servers.\n\nLet me know if you need more information.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Failover transport should not hang on startup if it cannot connect & Failover transport timeout options overrides reconnection strategy","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Unix, Mule ESB, AMQ- 5.9, java","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14322769","id":"14322769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"To have the client return from the start call if no server can be reached at start you can set startupMaxReconnectAttempts to control how many tries before the client gives up.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-02-16T13:44:45.499+0000","updated":"2015-02-16T13:44:45.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14324321","id":"14324321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"body":"If I use startupMaxReconnectAttempts, failover will fail after those many attempts. \n\nYes, I would like failover transport to try reconnecting until the broker becomes available, BUT I would like it not to block! The failover transport does NOT block on later calls even if there is no connection to the broker, so why should it block on startup if the broker is down? I do not want to configure startupmaxReconnectAttempts since I want the transport to keep trying, forever.\n\nI would expect the failover transport to start, and keep trying to connect to the remote broker.\n\nBtw, what is the fix given for AMQ-2114?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"created":"2015-02-17T15:34:57.231+0000","updated":"2015-02-17T15:34:57.231+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14324329","id":"14324329","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"There was not fix applied for AMQ-2114 because like the this one the result is that it is working as designed. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-02-17T15:40:12.558+0000","updated":"2015-02-17T15:40:12.558+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14324342","id":"14324342","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for reply. But, it works fine if AMQ goes down later after the Applications are started and deployed. Applications reconnect to AMQ later once it is up. How is it handled here?\n\n Then, why is it blocking on startup? Applications cannot start and fail if AMQ is down on startup. Is there a workaround for this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"created":"2015-02-17T15:48:30.625+0000","updated":"2015-02-17T15:48:30.625+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14336465","id":"14336465","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\n\nIf I use startupMaxReconnectAttempts it throws exception and never again reconnects or attempts to connect once AMQ is up again.\nCan you fix this defect to work like \"If AMQ is down once the application is started running, applications successfully reconnect and keep sending messages\".\nHowever, if AMQ is down, before the application could be started, it throws the following exception and dies. \nException in thread \"main\" javax.jms.JMSException: Connection refused: connect\n\tat org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:72)\n\tat org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1423)\n\tat org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1510)\n\tat org.apache.activemq.ActiveMQConnection.createSession(ActiveMQConnection.java:325)\n\tat test.tutorial.QueueProducer.main(QueueProducer.java:16)\nCaused by: java.net.ConnectException: Connection refused: connect\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=savita","name":"savita","key":"savita","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Savita","active":true,"timeZone":"Etc/UTC"},"created":"2015-02-25T13:17:28.450+0000","updated":"2015-02-25T13:17:28.450+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14350937","id":"14350937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This is how it works, if startMaxReconnectAttempts is set then it will try that many times on start and fail if no broker can be connected to.  If a connection is made then goes down the behavior is controlled by maxReconnectAttempts which defaults to unlimited attempts.  The client hangs on start if no initial connection, if it didn't hang there it would have to hang on createSession or any other method as there is no connection so no local resources can be created. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-03-06T21:35:08.424+0000","updated":"2015-03-06T21:35:08.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12775365/comment/14563855","id":"14563855","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This is working as intended. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-05-28T23:07:05.003+0000","updated":"2015-05-28T23:07:05.003+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5588/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i25og7:"}}