{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12686325","self":"https://issues.apache.org/jira/rest/api/2/issue/12686325","key":"AMQ-4955","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329258","id":"12329258","name":"5.12.0","archived":false,"released":true,"releaseDate":"2015-08-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-01-08T17:03:32.398+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri May 29 21:53:49 UTC 2015","customfield_12310420":"365305","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_45020892677_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-05-29T21:53:48.969+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4955/watchers","watchCount":8,"isWatching":false},"created":"2013-12-24T20:05:36.607+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[{"id":"12426205","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12426205","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12832261","key":"AMQ-5794","self":"https://issues.apache.org/jira/rest/api/2/issue/12832261","fields":{"summary":"Cleanup connections that open but don't initiate a protocol handshake.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-29T21:53:49.107+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"TCP Connections and related thread leak.\n\nScenario\n\nActive MQ version 5.8\nNMS Client version 1.6\nOS - Windows 2008 R2\nJDK - 1.7.x\n\nactivemq.xml is attached\n\nIf a client connectivity gets lost between the time the initial socket is created and the exchange of the wire format, the active MQ server's Client's server thread gets blocked in socket read hanging out the TCP connection and the related thread\nHere are the steps to recreate\n1. Configure the Active MQ server with the activemq.xml attached.\n2. Start the client in a debugger and have a break point at a place in such a way that the client can be disconnected after the socket is established.\n3. Once the breakpoint is hit, disconnect the client machine from the network\n4. Kill the client- This basically simulates a situation where the socket tear down packets are not reached the active mq server.\n5. Open the JConsole. Look for the hanging TCP connection and the related thread.\nIs there an configurable option in Active MQ to sweep and close the connections, on regular interval, that still didn't finish the wire protocol negotiation?","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12620385","id":"12620385","filename":"activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-24T20:08:02.089+0000","size":8444,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12620385/activemq.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12626579","id":"12626579","filename":"AMQ4955Test.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2014-02-03T00:57:28.716+0000","size":3844,"mimeType":"java/*","content":"https://issues.apache.org/jira/secure/attachment/12626579/AMQ4955Test.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12620383","id":"12620383","filename":"TCP-Connection.jpg","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-24T20:06:04.442+0000","size":126410,"mimeType":"image/jpeg","content":"https://issues.apache.org/jira/secure/attachment/12620383/TCP-Connection.jpg"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12620384","id":"12620384","filename":"ThreadStack.jpg","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-24T20:06:16.642+0000","size":180957,"mimeType":"image/jpeg","content":"https://issues.apache.org/jira/secure/attachment/12620384/ThreadStack.jpg"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"365608","customfield_12312823":null,"summary":"TCP Connections and related thread leak.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows 2008 R2, Jdk 1.7.40","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13856446","id":"13856446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"body":"I have further did remote debugging on this. It points to the following area of the code.\nInactivityMonitor.configuredOk()\nThis method is coded is such a way that it returns false if the wire protocol from the client has not been received. Because of this the connection is not yet added to be monitored by the inactivity monitor so the Client connections that did not finish the wire protocol negotiation are never can be cleaned up by the Broker leaking and eventually running out of threads and memory.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-24T20:12:59.469+0000","updated":"2013-12-24T20:12:59.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13863116","id":"13863116","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"body":"1. When the server starts a transport connection, the first command it is dispatching is BrokerInfo command\nNote: BrokerInfo command is not tagged as DispatchMessage ( isMessageDispatch() is false on Broker Command)\t\n\n2. WireFormatNegotiator::oneway  method throws a IOException with Wire format negotiation timeout\n3. TransportConnection::processDispatch method ignores that IOException because the command that was sent out is not a MessageDispatch Command.\nResult is Wire format negotiation timeout is thrown out without being handled resulting the ActiveMQ Transport thread leak\n\nI have fixed this by added the following lines of code to the TransportConnection:processDispatch  's IOException handling block of code.\n            if(command.isBrokerInfo())\n                   throw e;","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2014-01-06T17:13:44.959+0000","updated":"2014-01-06T17:13:44.959+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13865645","id":"13865645","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Have you created a test case that reproduces this problem?  Have you tested against the latest code?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-01-08T17:03:32.398+0000","updated":"2014-01-08T17:03:32.398+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13866479","id":"13866479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anujkhandelwal","name":"anujkhandelwal","key":"anujkhandelwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10442","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10442","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10442","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10442"},"displayName":"Anuj Khandelwal","active":true,"timeZone":"Etc/UTC"},"body":"Hey,\nI am facing the similar issue in which I can see lot of connections from the same client ( around 100). I think connections are not getting closed properly. \n\nConfiguration:\n1. All clients are using pooled connection factory where max Connection limit is specified as 3.\n2. ActiveMQ version: 5.8\n\nI suspect that default value of 'maxInactivityDuration' is less (30 sec) and broker might not able to send/read heartbeats  for all the connections in this given specified time. So I think by increasing the value of  'maxInactivityDuration' we could avoid this issue since broker will have enough time to handle heartbeat related stuff.\n\nI think Tim might help us here.\n\nThanks,\nAnuj","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anujkhandelwal","name":"anujkhandelwal","key":"anujkhandelwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10442","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10442","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10442","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10442"},"displayName":"Anuj Khandelwal","active":true,"timeZone":"Etc/UTC"},"created":"2014-01-09T09:44:14.297+0000","updated":"2014-01-09T09:44:14.297+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13867567","id":"13867567","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"body":"Based on the description of the steps to reproduce, I tried a client program that doesn't use a connection factory, but instead just opens a socket to the server, then closes it.  This test failed to produce any sort of leak.  One difference - I'm testing 5.9.0.\n\nIs there anything else that needs to happen in the normal connection sequence that my test might miss?\n\nCan you try to reproduce the problem with 5.9.0?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"created":"2014-01-10T06:52:11.766+0000","updated":"2014-01-10T06:52:11.766+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13867796","id":"13867796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"body":"Open the socket connection, and before closing the socket disconnect your client machine from the network, so that RST or the FIN packets never makes it to the server.\nI am also planning to do the test on 5.9.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2014-01-10T13:43:53.607+0000","updated":"2014-01-10T13:43:53.607+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13868016","id":"13868016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"body":"If it's necessary to prevent RST or FIN, then doesn't that point to either a tcp/ip timeout issue or a bug in the server's tcp/ip stack?\n\nPlease check netstat on the broker system when this happens.  If the socket is listed there, then this is not an ActiveMQ bug. \n\nSent from my iPhone\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"created":"2014-01-10T17:23:53.296+0000","updated":"2014-01-10T17:23:53.296+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13873480","id":"13873480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Its not clear this is a broker problem - and not a application problem - downgrading to major","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2014-01-16T15:15:33.657+0000","updated":"2014-01-16T15:15:33.657+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13889139","id":"13889139","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"body":"Unit test","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2014-02-03T00:57:28.721+0000","updated":"2014-02-03T00:57:28.721+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13889144","id":"13889144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"body":"Attached the unit test both for the TCP and SSL. Tested on 5.9 too with no success.\nThe fix I have proposed to TransportConnection:ProcessDispatch catch block to add these lines of code at the beginning fixes only TCP connector, but not the SSL connector\n\n         boolean isBrokerInfo=command.isBrokerInfo();\n         if(isBrokerInfo)\n         \t throw e;\nPlease suggest any alternative ideas that fixes both for all the transports, I can try coding that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thodimi","name":"thodimi","key":"thodimi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Murali Mogalayapalli","active":true,"timeZone":"Etc/UTC"},"created":"2014-02-03T01:01:38.418+0000","updated":"2014-02-03T02:41:51.101+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13931311","id":"13931311","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"body":"Looking at the comments in the unit test, it appears to be attempting to avoid problems caused by opening socket connections to the broker without the broker timing them out.  Is that correct?\n\nIs that the focus of this issue now?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"created":"2014-03-12T02:43:35.030+0000","updated":"2014-03-12T02:43:35.030+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13956115","id":"13956115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"body":"Throwing an exception on dispatching a BrokerInfo in TransportConnection sounds like a major problem since BrokerInfo's do need to cross transports.\n\nWhat's the state of this issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"created":"2014-04-01T05:19:25.702+0000","updated":"2014-04-01T05:19:25.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/13956124","id":"13956124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"body":"Reading back through the comments, I see the issue being raised now -- the eaten IOException for all commands except MessageDispatch.\n\nI think the right thing to do here is to always re-throw the exception.  Can anyone think of a case in which an IOException on Broker.preProcessDispatch() or TransportConnection.dispatch() could have a non-fatal meaning?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=artnaseef","name":"artnaseef","key":"artnaseef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Arthur Naseef","active":true,"timeZone":"America/Phoenix"},"created":"2014-04-01T05:27:59.227+0000","updated":"2014-04-01T05:27:59.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12686325/comment/14565492","id":"14565492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This scenario should be addressed by enhancements in AMQ-5794 broker will close incoming connections that have not completed their negotiation after the connection attempt timeout value has been reached.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-05-29T21:53:49.077+0000","updated":"2015-05-29T21:53:49.077+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4955/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1qyrz:"}}