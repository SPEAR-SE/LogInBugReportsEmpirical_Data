{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12481933","self":"https://issues.apache.org/jira/rest/api/2/issue/12481933","key":"AMQ-1137","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2007-02-09T06:52:51.722+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 23 05:04:34 UTC 2007","customfield_12310420":"95686","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_4260409516_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2007-03-14T13:56:55.152+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1137/watchers","watchCount":0,"isWatching":false},"created":"2007-01-24T06:30:05.636+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315613","id":"12315613","description":"","name":"4.1.0","archived":false,"released":true,"releaseDate":"2006-11-13"}],"issuelinks":[{"id":"12335006","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12335006","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12482114","key":"AMQ-1156","self":"https://issues.apache.org/jira/rest/api/2/issue/12482114","fields":{"summary":"option \"wireFormat.tcpNoDelayEnabled=true\" is ignored","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-10-23T05:04:34.764+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"h2. USE CASE\n# Take 4.1.0 Release from http://people.apache.org/repo/m2-incubating-repository/org/apache/activemq/apache-activemq/4.1.0-incubator/apache-activemq-4.1.0-incubator.zip and unzip on a Linux box (SuSE 10.1, Kernel 2.6.16 with 2GB RAM and  Xeon(TM) CPU 2.80GHz\n# Edit {{conf/activemq.xml}} and disable ssl and stomp transport\n# Start broker: {{apache-activemq-4.1.0-incubator/bin> java -jar run.jar}}\n# Edit {{example/build.xml}} and set max=1000 (send 1000 messages to queue) and *transacted=true*\n# Run producer: {{ant producer}}\n\nh2. Results\n\n{code:title=broker logfile}\nACTIVEMQ_HOME: /home/janknecht/tmp/apache-activemq-4.1.0-incubator\nLoading message broker from: xbean:activemq.xml\nINFO  BrokerService                  - ActiveMQ 4.1.0-incubator JMS Message Broker (localhost) is starting\nINFO  BrokerService                  - For help or more information please see: http://incubator.apache.org/activemq/\nINFO  ManagementContext              - JMX consoles can connect to service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi\nINFO  JDBCPersistenceAdapter         - Database driver recognized: [apache_derby_embedded_jdbc_driver]\nINFO  DefaultDatabaseLocker          - Attempting to acquire the exclusive lock to become the Master broker\nINFO  DefaultDatabaseLocker          - Becoming the master on dataSource: org.apache.derby.jdbc.EmbeddedDataSource@14627a\nINFO  JournalPersistenceAdapter      - Journal Recovery Started from: Active Journal: using 5 x 20.0 Megs at: /home/janknecht/tmp/apache-activemq-4.1.0-incubator/activemq-data/journal\nINFO  JournalPersistenceAdapter      - Journal Recovered: 0 message(s) in transactions recovered.\nINFO  TransportServerThreadSupport   - Listening for connections at: tcp://acxlin.wu.ssn:61616\nINFO  TransportConnector             - Connector openwire Started\nINFO  NetworkConnector               - Network Connector default-nc Started\nINFO  BrokerService                  - ActiveMQ JMS Message Broker (localhost, ID:acxlin.wu.ssn-60609-1169619821670-1:0) started\n{code} \n\n\n{code:title=producer output}\nproducer:\n     [echo] Running producer against server at $url = tcp://localhost:61616 for subject $subject = TEST.FOO\n     [java] Connecting to URL: tcp://localhost:61616\n     [java] Publishing a Message with size 1000 to queue: TEST.FOO\n     [java] Using non-persistent messages\n     [java] Sleeping between publish 0 ms\n     [java] Sending message: Message: 0 sent at: Wed Jan 24 07:28:14 CET 2007  ...\n     [java] Sending message: Message: 1 sent at: Wed Jan 24 07:28:14 CET 2007  ...\n     [java] Sending message: Message: 2 sent at: Wed Jan 24 07:28:14 CET 2007  ...\n     [java] Sending message: Message: 3 sent at: Wed Jan 24 07:28:15 CET 2007  ...\n     [java] Sending message: Message: 4 sent at: Wed Jan 24 07:28:15 CET 2007  ...\n     [java] Sending message: Message: 5 sent at: Wed Jan 24 07:28:15 CET 2007  ...\n...\n     [java] Sending message: Message: 998 sent at: Wed Jan 24 07:28:55 CET 2007...\n     [java] Sending message: Message: 999 sent at: Wed Jan 24 07:28:55 CET 2007...\n     [java] Done.\n     [java] connection {\n     [java]   session {\n     [java]     messageCount{ count: 1000 unit: count startTime: 1169620094893 lastSampleTime: 1169620135606 description: Number of messages exchanged }\n     [java]     messageRateTime{ count: 1000 maxTime: 126 minTime: 4 totalTime: 40688 averageTime: 40.688 averageTimeExMinMax: 40.63927855711423 averagePerSecond: 24.57727093983484 averagePerSecondExMinMax: 24.606736032348735 unit: millis startTime: 1169620094893 lastSampleTime: 1169620135606 description: Time taken to process a message (thoughtput rate) }\n     [java]     pendingMessageCount{ count: 0 unit: count startTime: 1169620094893 lastSampleTime: 1169620094893 description: Number of pending messages }\n     [java]     expiredMessageCount{ count: 0 unit: count startTime: 1169620094893 lastSampleTime: 1169620094893 description: Number of expired messages }\n     [java]     messageWaitTime{ count: 0 maxTime: 0 minTime: 0 totalTime: 0 averageTime: 0.0 averageTimeExMinMax: 0.0 averagePerSecond: 0.0 averagePerSecondExMinMax: 0.0 unit: millis startTime: 1169620094893 lastSampleTime: 1169620094893 description: Time spent by a message before being delivered }\n     [java]     durableSubscriptionCount{ count: 0 unit: count startTime: 1169620094893 lastSampleTime: 1169620094893 description: The number of durable subscriptions }\n\n     [java]     producers {\n     [java]       producer queue://TEST.FOO {\n     [java]         messageCount{ count: 1000 unit: count startTime: 1169620094918 lastSampleTime: 1169620135606 description: Number of messages processed }\n     [java]         messageRateTime{ count: 1000 maxTime: 126 minTime: 4 totalTime: 40688 averageTime: 40.688 averageTimeExMinMax: 40.63927855711423 averagePerSecond: 24.57727093983484 averagePerSecondExMinMax: 24.606736032348735 unit: millis startTime: 1169620094918 lastSampleTime: 1169620135606 description: Time taken to process a message (thoughtput rate) }\n     [java]         pendingMessageCount{ count: 0 unit: count startTime: 1169620094918 lastSampleTime: 1169620094918 description: Number of pending messages }\n     [java]         messageRateTime{ count: 1000 maxTime: 126 minTime: 4 totalTime: 40688 averageTime: 40.688 averageTimeExMinMax: 40.63927855711423 averagePerSecond: 24.57727093983484 averagePerSecondExMinMax: 24.606736032348735 unit: millis startTime: 1169620094918 lastSampleTime: 1169620135606 description: Time taken to process a message (thoughtput rate) }\n     [java]         expiredMessageCount{ count: 0 unit: count startTime: 1169620094918 lastSampleTime: 1169620094918 description: Number of expired messages }\n     [java]         messageWaitTime{ count: 0 maxTime: 0 minTime: 0 totalTime: 0 averageTime: 0.0 averageTimeExMinMax: 0.0 averagePerSecond: 0.0 averagePerSecondExMinMax: 0.0 unit: millis startTime: 1169620094918 lastSampleTime: 1169620094918 description: Time spent by a message before being delivered }\n     [java]       }\n     [java]     }\n     [java]     consumers {\n     [java]     }\n     [java]   }\n     [java] }\n{code} \n\nAs you can see very bad performace, ot took about 40s to send this 1000 transacted queue messages :-(\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"254965","customfield_12312823":null,"summary":"Transactional, non persistent queing very slow under Linux","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938681","id":"12938681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"body":"I found this mailing list article: http://www.mail-archive.com/activemq-users@geronimo.apache.org/msg04020.html\nIt seems to be a similar problem.\n\nI played around also with different Java versions (1.5.0_10 and Java6/Mustang).\nI tried to run on different machines with older Linux kernel (2.6.5, SUSE LINUX Enterprise Server 9.3 with 4x Xeon(TM) MP CPU 3.66GHz and 8GB RAM)\nbut always same result. As soon as transactions are enabled sending is so slow - but only under Linux.\nwith Windows I got:\n\n{noformat}\nproducer:\n     [echo] Running producer against server at $url = tcp://localhost:61616 for subject $subject = TEST.FOO\n     [java] Connecting to URL: tcp://localhost:61616\n     [java] Publishing a Message with size 1000 to queue: TEST.FOO\n     [java] Using non-persistent messages\n     [java] Sleeping between publish 0 ms\n     [java] Sending message: Message: 0 sent at: Wed Jan 24 07:40:36 CET 2007  ...\n     [java] Sending message: Message: 1 sent at: Wed Jan 24 07:40:36 CET 2007  ... \n...\n    [java] Sending message: Message: 998 sent at: Wed Jan 24 07:40:37 CET 2007...\n     [java] Sending message: Message: 999 sent at: Wed Jan 24 07:40:37 CET 2007...\n     [java] Done.\n     [java] connection {\n     [java]   session {\n     [java]     messageCount{ count: 1000 unit: count startTime: 1169620836233 lastSampleTime: 1169620837215 description: Number of messages exchanged }\n     [java]     messageRateTime{ count: 1000 maxTime: 31 minTime: 0 totalTime: 951 averageTime: 0.951 averageTimeExMinMax: 0.9218436873747495 averagePerSecond: 1051.5247108307046 averagePerSecondExMinMax: 1084.7826086956522 unit: millis startTime: 1169620836233 lastSampleTime: 1169620837215 description: Time taken to process a message (thoughtput rate) }\n...\n{noformat}\n\nSo dramatically faster, <1s compared to 40s under Linux.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"created":"2007-01-24T06:46:53.628+0000","updated":"2007-01-24T06:46:53.628+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938743","id":"12938743","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"body":"When taking a {{jstack}} snapshot while producer is running I can see that it spents a lot of time in {{java.util.concurrent.ArrayBlockingQueue.take()}}:\n\n{noformat}\nThread 11071: (state = BLOCKED)\n - java.lang.Object.wait(long) @bci=0 (Interpreted frame)\n - java.lang.Object.wait() @bci=2, line=474 (Interpreted frame)\n - edu.emory.mathcs.backport.java.util.concurrent.locks.CondVar.await() @bci=72, line=75 (Interpreted frame)\n - edu.emory.mathcs.backport.java.util.concurrent.ArrayBlockingQueue.take() @bci=16, line=318 (Interpreted frame)\n - org.apache.activemq.transport.FutureResponse.getResult() @bci=4, line=42 (Interpreted frame)\n - org.apache.activemq.transport.ResponseCorrelator.request(java.lang.Object) @bci=8, line=75 (Interpreted frame)\n - org.apache.activemq.ActiveMQConnection.syncSendPacket(org.apache.activemq.command.Command) @bci=20, line=1171 (Interpreted frame)\n - org.apache.activemq.TransactionContext.commit() @bci=55, line=260 (Interpreted frame)\n - org.apache.activemq.ActiveMQSession.commit() @bci=25, line=464 (Interpreted frame)\n - ProducerTool.sendLoop(javax.jms.Session, javax.jms.MessageProducer) @bci=126 (Interpreted frame)\n - ProducerTool.run() @bci=353 (Interpreted frame)\n - ProducerTool.main(java.lang.String[]) @bci=52 (Interpreted frame)\n{noformat}\n\nI also tried to set \"tcp://localhost:61616?tcpNoDelay=true\" so use this TCP_NODELAY option - no improvement at all :-(","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"created":"2007-01-24T07:01:03.337+0000","updated":"2007-01-24T07:01:03.337+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938854","id":"12938854","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidmc","name":"davidmc","key":"davidmc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Martín Clavo","active":true,"timeZone":"Etc/UTC"},"body":"tcpNoDelay=true doesn't work for me to set the TCP_NODELAY option.\nneither does wireFormat.tcpNoDelayEnabled=true\nbut socket.tcpNoDelay=true DID work, so you could give it a try :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidmc","name":"davidmc","key":"davidmc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Martín Clavo","active":true,"timeZone":"Etc/UTC"},"created":"2007-02-09T06:52:51.722+0000","updated":"2007-02-09T06:52:51.722+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938716","id":"12938716","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"body":"Great tip David :-)\n\nWith {{socket.tcpNoDelay=true}} my own tests report:\n\n{noformat}\n- transient  |tx|=0   : #messages 1000 sending took 31 ms (commit: 0 ms), (32258 /s), receiving took 7 ms (commit: 0 ms), (142857 /s).\n- transient  |tx|=1   : #messages 200 sending took 88 ms (commit: 66 ms), (2272 /s), receiving took 56 ms (commit: 42 ms), (3571 /s).\n{noformat}\n\nAnd without same test on same machine:\n\n{noformat}\n- transient  |tx|=0   : #messages 1000 sending took 46 ms (commit: 0 ms), (21739 /s), receiving took 22 ms (commit: 0 ms), (45454 /s).\n- transient  |tx|=1   : #messages 200 sending took 8075 ms (commit: 8059 ms), (24 /s), receiving took 8074 ms (commit: 8042 ms), (24 /s).\n{noformat}\n\nThis {{[|tx|=0}} means transactions are not used.\n\nSo 2272/s vs. 24/s is a good result :-)\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"created":"2007-02-09T14:39:04.955+0000","updated":"2007-02-09T14:39:04.955+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12936777","id":"12936777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidmc","name":"davidmc","key":"davidmc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Martín Clavo","active":true,"timeZone":"Etc/UTC"},"body":"Hello again Helmut,\n\nI have found that the socket.tcpNoDelay=true option seems to work only with client URI connection strings, but has no effect in the activemq.xml file (when configuring the transportConnector uri).\n\nSo if you really want to disable Nagle's algorithm for sure you should add the code directly. See my comment at https://issues.apache.org/activemq/browse/AMQ-1156.\n\nBest regards, David","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidmc","name":"davidmc","key":"davidmc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Martín Clavo","active":true,"timeZone":"Etc/UTC"},"created":"2007-02-22T05:03:06.657+0000","updated":"2007-02-22T05:03:06.657+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938898","id":"12938898","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"body":"With my patch described in https://issues.apache.org/activemq/browse/AMQ-1156#action_38797 it now performs well.\n\nOne note: with Linux Kernel 2.6.16 and 2.6.17 it seems to be significant slower than with 2.6.18 or newer or with elder kernels.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"created":"2007-03-13T11:53:22.261+0000","updated":"2007-03-13T11:53:22.261+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938851","id":"12938851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"body":"Ok I found out the difference between these kernel versions, it is the value of this TCP parameter \"Appropriate Byte Count\" (ABC) defined in RFC3465.\nIn 2.6.16 and .17 default is set to 1, in 2.6.18 to 0.\n\nSo try \n\n{noformat}\n  sysctl net.ipv4.tcp_abc=0\n{noformat}\n\nThis may increase overall messaging performance when using transaction or sending acknowledgements.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"created":"2007-03-13T12:40:30.396+0000","updated":"2007-03-13T12:40:30.396+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12938886","id":"12938886","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"body":"The workaround is to use the URI...\n\n{code}\n?socket.tcpNoDelay=true\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"created":"2007-03-14T13:56:55.134+0000","updated":"2007-03-14T13:56:55.134+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481933/comment/12939198","id":"12939198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"body":"Actually this works not until V5.0, see AMQ-1156.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=janknecht","name":"janknecht","key":"janknecht","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Helmut Janknecht","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-23T05:04:34.595+0000","updated":"2007-10-23T05:04:34.595+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1137/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i18107:"}}