{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482771","self":"https://issues.apache.org/jira/rest/api/2/issue/12482771","key":"AMQ-2027","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2008-12-09T17:25:31.307+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 10 16:58:45 UTC 2008","customfield_12310420":"95981","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_86940830_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2008-12-10T16:58:45.190+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2027/watchers","watchCount":0,"isWatching":false},"created":"2008-12-09T16:49:44.360+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-12-10T16:58:45.184+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When creating an embedded broker, the BrokerService setUseJmx(false) method appears to be ignored.\n\nI was using the URI configuration technique, but even explicit setup calls seem to fail.\n\nHere's an example setup:\n\n_broker = new BrokerService();\n_broker.setBrokerName(\"testjms\");\n_broker.setPersistent(false);\n_broker.setUseJmx(false);\n_broker.addConnector(\"tcp://localhost:61616\");\n_broker.start();\n\nWhen I run the application I get the following messages (note the failure to start the JMX connector at the end):\n\n09-Dec-2008 16:29:42 org.apache.activemq.broker.BrokerService start\nINFO: Using Persistence Adapter: AMQPersistenceAdapter(activemq-data\\aftestjms)\n09-Dec-2008 16:29:42 org.apache.activemq.store.amq.AMQPersistenceAdapter start\nINFO: AMQStore starting using directory: activemq-data\\aftestjms\n09-Dec-2008 16:29:42 org.apache.activemq.kaha.impl.KahaStore initialize\nINFO: Kaha Store using data directory activemq-data\\aftestjms\\kr-store\\state\n09-Dec-2008 16:29:42 org.apache.activemq.store.amq.AMQPersistenceAdapter start\nINFO: Active data files: []\n09-Dec-2008 16:29:42 org.apache.activemq.store.amq.AMQPersistenceAdapter start\nWARNING: The ReferenceStore is not valid - recovering ...\n09-Dec-2008 16:29:42 org.apache.activemq.kaha.impl.KahaStore delete\nINFO: Kaha Store successfully deleted data directory activemq-data\\aftestjms\\kr-store\\data\n09-Dec-2008 16:29:42 org.apache.activemq.store.amq.AMQPersistenceAdapter recover\nINFO: Journal Recovery Started from: DataManager:(data-)\n09-Dec-2008 16:29:42 org.apache.activemq.store.amq.AMQPersistenceAdapter recover\nINFO: Recovered 0 operations from redo log in 0.0 seconds.\n09-Dec-2008 16:29:42 org.apache.activemq.store.amq.AMQPersistenceAdapter start\nINFO: Finished recovering the ReferenceStore\n09-Dec-2008 16:29:42 org.apache.activemq.broker.BrokerService getBroker\nINFO: ActiveMQ null JMS Message Broker (aftestjms) is starting\n09-Dec-2008 16:29:42 org.apache.activemq.broker.BrokerService getBroker\nINFO: For help or more information please see: http://activemq.apache.org/\n09-Dec-2008 16:29:42 org.apache.activemq.kaha.impl.KahaStore initialize\nINFO: Kaha Store using data directory activemq-data\\aftestjms\\kr-store\\data\n09-Dec-2008 16:29:42 org.apache.activemq.broker.BrokerService start\nINFO: ActiveMQ JMS Message Broker (aftestjms, ID:LT-BAS-EN-05004-1199-1228840182685-0:0) started\n09-Dec-2008 16:29:42 org.apache.activemq.broker.TransportConnector start\nINFO: Connector vm://aftestjms Started\nWaiting for messages...\n09-Dec-2008 16:29:45 org.apache.activemq.broker.jmx.ManagementContext$1 run\nWARNING: Failed to start jmx connector: Cannot bind to URL [rmi://localhost:1099/jmxrmi]: javax.naming.ServiceUnavailableException [Root exception is java.rmi.ConnectException: Connection refused to host: localhost; nested exception is: \n        java.net.ConnectException: Connection refused: connect]\n\n\nI will attach a sample java souce file.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461226","id":"12461226","filename":"useJmsBug.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-09T16:53:10.078+0000","size":4271,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461226/useJmsBug.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172430","customfield_12312823":null,"summary":"setUseJmx(false) ignored when creating embedded broker.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Running inside Netbeans environment on a dual-core laptop:\nProduct Version: NetBeans IDE 6.1 (Build 200805300101)\nJava: 1.6.0_10; Java HotSpot(TM) Client VM 11.0-b15\nSystem: Windows XP version 5.1 running on x86; Cp1252; en_GB (nb)","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482771/comment/12940549","id":"12940549","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"body":"Implementation of a message consumer which also contains an embedded broker. (apologies for the class name)\nDemos the bug.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-09T16:53:10.141+0000","updated":"2008-12-09T16:53:10.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482771/comment/12940544","id":"12940544","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"try: \n{code}_broker.getManagementContext().setCreateConnector(false);{code}\n\nthe reference to an MBean server (createCoonnector) and the registration of MBeans (useJMX) with a Server are different at the moment.\nI guess it would make sense if createConnector was conditional on useJMX, not sure why it is not at the moment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-09T17:25:31.307+0000","updated":"2008-12-09T17:25:31.307+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482771/comment/12940543","id":"12940543","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"body":"Yep, I tried that to no effect before submitting the bug, but I will give it another go just in case I was being a muppet.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-09T21:51:59.564+0000","updated":"2008-12-09T21:51:59.564+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482771/comment/12940566","id":"12940566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"I just tried your code and everything works fine ... I get all lines until \"Waiting for messages...\"\n\nIt seems to me that you have something else in your code that tries to use JMX API and fails because it is not started. Maybe a web console?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2008-12-10T14:13:41.852+0000","updated":"2008-12-10T14:13:41.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482771/comment/12940541","id":"12940541","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"body":"Hi Dejan and Gary,\n\nMy apologies, it appears that I am a muppet.\n\n_broker.getManagementContext().setCreateConnector(false);\n\nWorks a treat.\n\nNote the main() in the example code creates a Main class not a useJmsBug class, doh.\n\nI'll close the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-10T16:56:07.585+0000","updated":"2008-12-10T16:56:07.585+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482771/comment/12940547","id":"12940547","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"body":"This wasn't a bug, just a misunderstanding and then some class renaming problems by the bug reporter (me). It is a little odd that in order to not use JMX you have to setUseJms(false) and getManagementContext().setCreateConnector(false) on the broker.\nApologies,\nTim","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pongle","name":"pongle","key":"pongle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Harris","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-10T16:58:45.173+0000","updated":"2008-12-10T16:58:45.173+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2027/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tvlz:"}}