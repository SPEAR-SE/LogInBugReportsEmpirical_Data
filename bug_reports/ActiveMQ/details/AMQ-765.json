{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482131","self":"https://issues.apache.org/jira/rest/api/2/issue/12482131","key":"AMQ-765","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"parent":{"id":"12482373","key":"AMQ-1696","self":"https://issues.apache.org/jira/rest/api/2/issue/12482373","fields":{"summary":"Restore the setConnectionFactory() method on the ActiveMQResourceAdapter","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315618","id":"12315618","description":"","name":"5.1.0","archived":false,"released":true,"releaseDate":"2008-05-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2006-10-06T18:32:53.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Apr 16 15:46:03 UTC 2008","customfield_12310420":"84335","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_50690092723_*|*_5_*:*_2_*:*_1283139519_*|*_4_*:*_1_*:*_66669","customfield_12312321":null,"resolutiondate":"2008-02-12T13:10:55.911+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-765/watchers","watchCount":3,"isWatching":false},"created":"2006-06-21T00:09:17.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315610","id":"12315610","name":"4.0","archived":false,"released":true},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315611","id":"12315611","description":"","name":"4.0.1","archived":false,"released":true,"releaseDate":"2006-06-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-04-28T16:56:38.837+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313893","id":"12313893","name":"Connector"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I've been trying to work through an issue with a NullPointerException run using the JCA 1.5 resource adapter on Glassfish.  In the course of debugging, Siva from the Glassfish team provided this information:\n\n\"Thanks for trying out GlassFish. Since I have only the trace snippet above, I tried to debug this problem by going through ActiveMQ RA's source available at https://svn.apache.org/repos/asf/incubator/activemq/trunk/activemq-ra/src/main/java/org/apache/activemq/ra/\n\nThis is what I understand happens. Please correct me if there are errors. When ActiveMQConnectionFactory [https://svn.apache.org/repos/asf/incubator/activemq/trunk/activemq-ra/src/main/java/org/apache/activemq/ra/ActiveMQConnectionFactory.java] is created at the createConnectionFactory method of https://svn.apache.org/repos/asf/incubator/activemq/trunk/activemq-ra/src/main/java/org/apache/activemq/ra/ActiveMQManagedConnectionFactory.java, the ConnectionManager is initialized to a *transient* variable \"manager\". Since ConnectionFactory instances can be serialized/deserialized while publishing to JNDI (as is the case in Project GlassFish), the connectionManager reference is lost and hence the NPE. The fix ideally should be in the ActiveMQRA's code. You could copy me [sivakumart AT sun DOT com] while you are discussing this with ActiveMQ, if you wish. If you still have any issues, please provide a copy of your domain.xml [connector connection pool, resource configuratin information] and the entire trace in server.log.\" ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461063","id":"12461063","filename":"ASF.LICENSE.NOT.GRANTED--RA.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-14T15:50:23.546+0000","size":54952,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461063/ASF.LICENSE.NOT.GRANTED--RA.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461014","id":"12461014","filename":"finest-log.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-07T15:29:52.813+0000","size":7359,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461014/finest-log.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12460947","id":"12460947","filename":"log.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-06T23:35:12.195+0000","size":4049,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12460947/log.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"161724","customfield_12312823":null,"summary":"ActiveMQ RA serialization issue on Glassfish","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhavyn","name":"rhavyn","key":"rhavyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Conrad","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhavyn","name":"rhavyn","key":"rhavyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Conrad","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Glassfish","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12938156","id":"12938156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhavyn","name":"rhavyn","key":"rhavyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Conrad","active":true,"timeZone":"Etc/UTC"},"body":"The mailing list discussion related to this issue can be found at: http://www.nabble.com/NullPointerException-with-RA-on-Glassfish-t1814940.html#a4959128","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhavyn","name":"rhavyn","key":"rhavyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Conrad","active":true,"timeZone":"Etc/UTC"},"created":"2006-06-21T00:10:19.000+0000","updated":"2006-06-21T00:10:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12938390","id":"12938390","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zombiepeanutbutter","name":"zombiepeanutbutter","key":"zombiepeanutbutter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Hutt","active":true,"timeZone":"Etc/UTC"},"body":"The same thing happens on oracle (oc4j) 10.1.3, except that I am using ActiveMQTopicConnectionFactory, instead of the managed connection factory.\nSame error, same line.\n\nDetails:\n-I deploy the resource adapter exactly as it comes packaged in v4.0.1\n-I'm using an external broker, running on the same machine.\n-I create one topic connection factory\n-I create one topic\n\nIn the code, the context lookups for the topics go through just fine (the objects are found), but upon calling factory.createTopicConnection(), I get the NPE.  Setting UseInboundSession to true lets this go through just fine, but I'm not writing a message driven bean, so this doesn't help me out very much.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zombiepeanutbutter","name":"zombiepeanutbutter","key":"zombiepeanutbutter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Hutt","active":true,"timeZone":"Etc/UTC"},"created":"2006-10-06T18:32:53.000+0000","updated":"2006-10-06T18:32:53.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12936529","id":"12936529","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"body":"Does anyone know if this is still an issue with 4.1.1 or 5.0.0?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"created":"2007-06-12T14:51:21.685+0000","updated":"2007-06-12T14:51:21.685+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12938952","id":"12938952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"body":"It is still an issue in 4.1.1. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-06T23:31:57.391+0000","updated":"2007-11-06T23:31:57.391+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12938921","id":"12938921","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"body":"The exception log I get on ActiveMQ 4.1.1  with\nSun Java System Application Server 9.1 (build b58g-fcs)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-06T23:35:12.274+0000","updated":"2007-11-06T23:35:12.274+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939214","id":"12939214","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"body":"After further investigation :\n\nIn version 4.1.1 the manager is not transient and not null, but I think I am getting the same error with the transient managed connection factory. \n\nEverything starts here:\n\n        @Resource(mappedName = \"jms/UserUpdateConnectionFactory\")\n\tprivate ConnectionFactory jmsConnectionFactory;\n\n\t@PostConstruct\n\tpublic void jmsConfigure()\n\t{\n                        {....}\n\t\t\tjmsConnection = jmsConnectionFactory.createConnection(); //at this point the jmsConnectionFactory is of class ActiveMQConnectionFactory but it's managed connection factory is null\n                         {....}\n        }\n\nIam not sure if this because I didnt configure something or because of the fact that managed connection factory is transient.\n\nafter calling ActiveMQConnectionFactory.createConnection the null mcf is passed to ConnectionManagerImpl.allocateConnection.\n(http://fisheye5.cenqua.com/browse/glassfish/appserv-core/src/java/com/sun/enterprise/connectors/ConnectionManagerImpl.java?r=1.6#l231)\n\nin this method there is a check:\n\nif(_logger.isLoggable(Level.INFO)){\n            if (! freshMCF.equals(mcf)) {\n                _logger.info(\"conmgr.mcf_not_equal\");\n            }\n        }\n\nthe fresh mcf retrieved from pool meta data PoolMetaData pmd = registry.getPoolMetaData( poolName );   ManagedConnectionFactory freshMCF = pmd.getMCF(); is a proper activemq mcf but the value is used only for logging purposes: \n\nthis conmgr.mcf_not_equal translates to The mcf being used to allocate the connection and the MCF in the pool are not equal. in the attached log-finest.txt log file.\n\nFinally when ConnectorAllocator.createResource method is called the mcf is null :\nhttp://fisheye5.cenqua.com/browse/glassfish/appserv-core/src/java/com/sun/enterprise/resource/ConnectorAllocator.java?r=1.6#l136\n\n\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michalk","name":"michalk","key":"michalk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michal kozakiewicz","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-07T15:29:52.942+0000","updated":"2007-11-07T15:29:52.942+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939325","id":"12939325","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"body":"I have tried to work around the problem described by Michal by simply declaring the factory property of ActiveMQConnectionFactory to not be transient. However, after running my test driver for accessing a ConnectionFactory managed by the ActiveMQ RA, I ran into the following problem:\n\nCaused by: java.lang.RuntimeException: Cant copy Serializable object:\n        at com.sun.enterprise.naming.NamingUtils.makeCopyOfObject(NamingUtils.java:82)\n        at com.sun.enterprise.naming.NamingManagerImpl.lookup(NamingManagerImpl.java:842)\n        at com.sun.enterprise.naming.java.javaURLContext.lookup(javaURLContext.java:173)\n        ... 66 more\nCaused by: java.io.NotSerializableException: com.sun.enterprise.connectors.BootstrapContextImpl\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1156)\n        at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n        at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1474)\n        at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n        at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n        at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1474)\n        at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n        at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n        at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1474)\n        at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n        at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:326)\n        at com.sun.enterprise.naming.NamingUtils.makeCopyOfObject(NamingUtils.java:64)\n        ... 68 more\n\n\nAfter having spent some time looking at the RA source code of version 5.0.0 my feeling is that the ActiveMQManagedConnectionFactory violates the javax.resource.spi.ManagedConnectionFactory contract because it is not Serializable.\n\n ActiveMQManagedConnectionFactory has a property of type org.apache.activemq.ra.MessageResourceAdapter which extends the javax.resource.spi.ResourceAdapter interface which itself does NOT extend Serializable, i.e. implementors are not required to be serializable. The ActiveMQResourceAdapter implementing the MessageResourceAdapter interface, however, claims to be serializable but does have a property of type javax.resource.spi.BootstrapContext. But BootstrapContext implementations are not required to be Serializable. In case of glassfish the passed in com.sun.enterprise.connectors.BootstrapContextImpl class is NOT serializable.\n\nTherefore, declaring the factory property to NOT be transient is not working because ActiveMQManagedConnectionFactory is not serializable as mandated by the JCA spec.\n\nAny thoughts?\n\nKai","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-24T16:33:49.001+0000","updated":"2007-12-24T16:33:49.001+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939089","id":"12939089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\n\nI have spent some time fixing the Resource Adapter's serialization issue in order to make it work in glassfish v2. Therefore I made some changes to ActiveMQConnectionFactory, ActiveMQManagedConnectionFactory and ActiveMQResourceAdapter. I have also created additional test cases and updated the existing ones to reflect my changes. I have successfully tested it in my local environment using glassfish v2 and v2 UR1 on JDK 1.5.0_14. I have also attached a patch for the 5.1 SNAPSHOT code in SVN. Could someone test it against Geronimo in order to see if it's still working there?\n\nRegards,\nKai","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-14T15:49:40.484+0000","updated":"2008-01-14T15:49:40.484+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939093","id":"12939093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"body":"Patch to fix serialization issue on glassfish.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-14T15:50:23.686+0000","updated":"2008-01-14T15:50:23.686+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939021","id":"12939021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"body":"Already fixed in 5.1 instead of 5.2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-12T13:09:49.081+0000","updated":"2008-02-12T13:09:49.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939036","id":"12939036","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"body":"Resource Adapter has been fixed to support serialization of RA components as performed by glasfish.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudalla","name":"hudalla","key":"hudalla","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Hudalla","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-12T13:10:55.821+0000","updated":"2008-02-12T13:10:55.821+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939466","id":"12939466","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gdaswani","name":"gdaswani","key":"gdaswani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Daswani","active":true,"timeZone":"America/Los_Angeles"},"body":"Is this problem really fixed on the latest 5.1 snapshots?  I tried the 03/29/08 5.1-SNAPSHOT but I'm still running into the following error\n\n---------------------- CUT -------------------\njavax.jms.JMSException: Error in allocating a connection. Cause: null\n\tat org.apache.activemq.ra.ActiveMQConnectionFactory.createConnection(ActiveMQConnectionFactory.java:98)\n\tat org.apache.activemq.ra.ActiveMQConnectionFactory.createConnection(ActiveMQConnectionFactory.java:64)\n---------------------- CUT -------------------\n\nwhen trying to use outbound connections","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gdaswani","name":"gdaswani","key":"gdaswani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Daswani","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-04-01T07:59:28.330+0000","updated":"2008-04-01T07:59:28.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482131/comment/12939574","id":"12939574","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Applied patch to trunk - in SVN Committed revision 648727","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2008-04-16T15:46:03.195+0000","updated":"2008-04-16T15:46:03.195+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-765/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0s1j3:"}}