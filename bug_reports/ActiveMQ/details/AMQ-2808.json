{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482517","self":"https://issues.apache.org/jira/rest/api/2/issue/12482517","key":"AMQ-2808","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2010-08-03T14:11:55.362+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 05 18:43:05 UTC 2011","customfield_12310420":"69114","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_31955343608_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-07-05T18:43:05.437+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2808/watchers","watchCount":1,"isWatching":false},"created":"2010-06-30T22:14:01.851+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315622","id":"12315622","description":"","name":"5.3.2","archived":false,"released":true,"releaseDate":"2010-05-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-07-05T18:43:05.455+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When a client opens a connection and unexpectedly finishes the connection remains open and established on the activemq machine, follow are the steps to reproduce:\n\n1 - Start the activemq using the stomp connector or stomp+ssl \n2 - Use tcpkill -9 port 61612 (default por for stomp connector)\n3 - From another machine send a telnet connection to the stomp port like telnet <stomp_server_ip> <stomp_port>, this connection is going to be finished by tcpkill\n4 - On the activemq machine issue a netstat -pont | grep <stomp_port>\nYou should  see that a connection is still ESTABLISHED and the number of connections grows if you start more telnets to the port. To the activemq server it thinks that the clients are still connected even if they are dead.\nThis does not happens when using stomp+nio, but since there is no ssl over stomp+nio we loose the encryption.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172201","customfield_12312823":null,"summary":"connection blocked when using stomp or stomp+ssl","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rodrigovaz","name":"rodrigovaz","key":"rodrigovaz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rodrigo Sampaio Vaz","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rodrigovaz","name":"rodrigovaz","key":"rodrigovaz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rodrigo Sampaio Vaz","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux 64 bit, debian, sun java 1.6.0_20","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482517/comment/12939930","id":"12939930","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jmkgreen","name":"jmkgreen","key":"jmkgreen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Green","active":true,"timeZone":"Europe/London"},"body":"I think I'm seeing this issue.\n\nFor me I have a test script I can run at the bash shell or via apache. If I repeatedly run and then ctrl+c the script from bash it reconnects no problem. If I run via Apache, then hit the browser stop button, then reload I instantly get told that my client-id is already connected.\n\nNetstat -nat hows the client connection remains ESTABLISHED.\n\nI am using Ubuntu 10.04 32 bit with ActiveMQ 5.3.2.\n\nJust to add that I am connecting using stomp over ssl.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jmkgreen","name":"jmkgreen","key":"jmkgreen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Green","active":true,"timeZone":"Europe/London"},"created":"2010-08-03T14:11:55.362+0000","updated":"2010-08-03T14:12:29.888+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482517/comment/12999346","id":"12999346","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajabs","name":"ajabs","key":"ajabs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas JAbs","active":true,"timeZone":"Etc/UTC"},"body":"I can confirm this issue also with 5.4.2. on windows xp and server 2008\n\nHOWTO REPRODUCE:\n* start broker with stomp connector enabled\n* use any stomp client to connect and subscribe to a topic\n* kill client without a disconnect\n* reconnect client\n-> subscribe will fail\n\nIf one kills the TransportConnector associated with the client via JMX, the connect is possible.\n\nI think the bug might be somehow related to AMQ-2511\nEDIT: It might also be related to AMQ-1376\n\nThe stack trace of the failed reconnect is appended, although it is not the cause of the bug.\n\n---\nreceived an error javax.jms.InvalidClientIDException: Broker: DzDefaultbroker - Client: myclient already connected from /xx.xx.xx.xx:2743\n\n\tat org.apache.activemq.broker.region.RegionBroker.addConnection(RegionBroker.java:216)\n\n\tat org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n\n\tat org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n\n\tat org.apache.activemq.advisory.AdvisoryBroker.addConnection(AdvisoryBroker.java:77)\n\n\tat org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n\n\tat org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:82)\n\n\tat org.apache.activemq.broker.MutableBrokerFilter.addConnection(MutableBrokerFilter.java:89)\n\n\tat org.apache.activemq.broker.TransportConnection.processAddConnection(TransportConnection.java:676)\n\n\tat org.apache.activemq.broker.jmx.ManagedTransportConnection.processAddConnection(ManagedTransportConnection.java:83)\n\n\tat org.apache.activemq.command.ConnectionInfo.visit(ConnectionInfo.java:134)\n\n\tat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:300)\n\n\tat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:178)\n\n\tat org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\n\n\tat org.apache.activemq.transport.stomp.StompTransportFilter.sendToActiveMQ(StompTransportFilter.java:82)\n\n      ...\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajabs","name":"ajabs","key":"ajabs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas JAbs","active":true,"timeZone":"Etc/UTC"},"created":"2011-02-25T13:03:00.304+0000","updated":"2011-02-25T13:29:31.516+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482517/comment/13060068","id":"13060068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"This is in some ways related to AMQ-3393.  There is also the fact that Stomp 1.0 doesn't allow for a keep alive so sometimes connection drops aren't detected.\n\nReopen if the problem persists.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-07-05T18:43:05.445+0000","updated":"2011-07-05T18:43:05.445+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-2808/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tu73:"}}