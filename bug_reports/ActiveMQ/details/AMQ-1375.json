{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483255","self":"https://issues.apache.org/jira/rest/api/2/issue/12483255","key":"AMQ-1375","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315630","id":"12315630","description":"Issues that need to be reviewed - do we keep 'em or do we kick 'em? ","name":"NEEDS_REVIEW","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2007-09-04T08:01:58.175+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Feb 26 12:14:39 UTC 2014","customfield_12310420":"84546","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_111212701803_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-03-09T22:37:01.787+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1375/watchers","watchCount":8,"isWatching":false},"created":"2007-08-30T18:12:00.128+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315614","id":"12315614","description":"","name":"4.1.1","archived":false,"released":true,"releaseDate":"2007-06-08"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-02-26T12:14:39.016+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We are experiencing severe issues with AMQ blocking sending. We have a basic setup with one standalone server process and many clients. Each client has its own temp queue for P2P request/response type communication. There is also a number of topics broadcast to all clients. Our clients receive messages in an MDP fashion with each message being processed on a single threaded executor by an anonymous Runnable as follows:\n{code}\npublic void onMessage(final Message message) {\n\tthreadRunner.submit(new Runnable() {\t\t\n\t\tpublic void run() {\n\t\t\ttry {\t\t\t\t\n\t\t\t\tfor(final IReceiverListener listener : listeners) {\n\t\t\t\t\tlistener.onReceive(message);\n\t\t\t\t}\n\t\t\t} catch (Throwable e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t});\n}\n{code}\n\n\nEvery so often, the entire AMQ blocks and we cannot send anything anymore. We also cannot create any new temp queues, which means no new client can start up (each creates its own temp queue during startup). Connections are be created and from that a session, but the session.createTemporaryQueue() call alwaysy hangs. This is similar to AMQ-1278, but as we are cannot use 5.0 until stable release.......\n\nHere is the stack of the client trying to create a temp queue\nat Object.wait(long, int) line: not available [native method]\nat CondVar(Object).wait() line: 199\nat CondVar.await() line: 75\nat ArrayBlockingQueue.take() line: 318\nat FutureResponse.getResult() line: 42\nat ResponseCorrelator.request(Object) line: 75\nat ActiveMQConnection.syncSendPacket(Command) line: 1175\nat ActiveMQConnection.createTempDestination(boolean) line: 1594\nat ActiveMQSession.createTemporaryQueue() line: 1134\nat TempDestinationResolver.resolveDestinationName(Session, String, boolean) line: 16\nat SimpleMessageListenerContainer(JmsDestinationAccessor).resolveDestinationName(Session, String) line: 100\nat SimpleMessageListenerContainer.createListenerConsumer(Session) line: 188\nat SimpleMessageListenerContainer.doInitialize() line: 171\nat SimpleMessageListenerContainer(AbstractJmsListeningContainer).initialize() line: 160\nat SimpleMessageListenerContainer(AbstractJmsListeningContainer).afterPropertiesSet() line: 133\nat DefaultListableBeanFactory(AbstractAutowireCapableBeanFactory).invokeInitMethods(String, Object, RootBeanDefinition) line: 1202\nat DefaultListableBeanFactory(AbstractAutowireCapableBeanFactory).initializeBean(String, Object, RootBeanDefinition) line: 1172\nat DefaultListableBeanFactory(AbstractAutowireCapableBeanFactory).createBean(String, RootBeanDefinition, Object[]) line: 428\nat AbstractBeanFactory$1.getObject() line: 251\nat DefaultListableBeanFactory(DefaultSingletonBeanRegistry).getSingleton(String, ObjectFactory) line: 156\nat DefaultListableBeanFactory(AbstractBeanFactory).getBean(String, Class, Object[]) line: 248\nat DefaultListableBeanFactory(AbstractBeanFactory).getBean(String) line: 160\nat DefaultListableBeanFactory.preInstantiateSingletons() line: 287\nat FileSystemXmlApplicationContext(AbstractApplicationContext).refresh() line: 352\nat FileSystemXmlApplicationContext.<init>(String[], ApplicationContext) line: 93\nat FileSystemXmlApplicationContext.<init>(String[]) line: 77\nat FileSystemXmlApplicationContext.<init>(String) line: 67\nat BindingService.<init>() line: 65\nat BindingService.getInstance() line: 43\nat TopologyServiceFactory.initialize() line: 123\nat TopologyManager.initialize() line: 31\nat TopologyView$3.run(IProgressMonitor) line: 159\nat Worker.run() line: 55\n\n\nI have attached a JStack of the server  process with embedded broker also.\n\nFrom our client side the only thing I am dubious about is the retention of the reference to the message until the anonymous Runnable is executed. Could this cause issues is for some reason the execution blocked, will the messages build up in AMQ?\n\nFrom looking at JConsole for the broker, the memoryPercentageUsed is zero so it doesnt appear to be a RAM issue.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12460619","id":"12460619","filename":"jstack_basic.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=topper_harley","name":"topper_harley","key":"topper_harley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trevor Higgins","active":true,"timeZone":"Etc/UTC"},"created":"2007-08-30T18:17:12.084+0000","size":138046,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12460619/jstack_basic.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59853","customfield_12312823":null,"summary":"ActiveMQ hangs, cannot send message/create temp queue","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=topper_harley","name":"topper_harley","key":"topper_harley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trevor Higgins","active":true,"timeZone":"Etc/UTC"},"subtasks":[{"id":"12483653","key":"AMQ-2294","self":"https://issues.apache.org/jira/rest/api/2/issue/12483653","fields":{"summary":"MessageProducer hangs when using many concurrent sessions","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=topper_harley","name":"topper_harley","key":"topper_harley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trevor Higgins","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Running an embedded broker in standalone java application based on Spring framework on Solaris 10 with JVM version 1.5.0_09. Using non persisten messaging with 512MB limit in memory manager of broker.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/12938597","id":"12938597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"body":"The stack trace just implies that the current JMS connection is blocked; I suspect its due to a producer being blocked? Are you sharing the connection in spring's listener container stuff?\n\nhttp://activemq.apache.org/my-producer-blocks.html\n\nI wonder - do you have any way of reproducing this? e.g. a JUnit test case?\n\nAlso can you reproduce this on 5.0; which has much more flexible flow control which avoids blocking the entire connection if a single producer is blocked?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"created":"2007-09-04T08:01:58.175+0000","updated":"2007-09-04T08:01:58.175+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/12939016","id":"12939016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=topper_harley","name":"topper_harley","key":"topper_harley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trevor Higgins","active":true,"timeZone":"Etc/UTC"},"body":"Can you explain why a producer would be blocked if all the client does when handling the message is add it to the executor in a Runnable? The reason for doing this was specifically to avoid taking time in the handling the message to prevent blocking the producer....\n\nThere is a session & producer created for each client request in a thread local fashion, but only one connection is created on server side. We dont share connection between client and server. Server has one connection only, created using connectionFactory.createConnection(); where connectionFactory is defined as follows in a server side Spring config file:\n\n\t<bean id=\"connectionFactory\"\n\t\tclass=\"org.apache.activemq.ActiveMQConnectionFactory\" depends-on=\"broker\">\n\t\t<property name=\"brokerURL\" value=\"tcp://localhost:50057\"/>\n\t</bean>\n\n\nEach client listener is defined as follows in a separate client XML file:\n\n   <bean id=\"destinationResolver\" class=\"com.xxx.yyy.platform.core.transport.activemq.TempDestinationResolver\"/>\n    \n\t<bean id=\"connectionFactory\" class=\"org.apache.activemq.ActiveMQConnectionFactory\">\n\t\t<property name=\"brokerURL\" value=\"tcp://${jms.server}:${jms.port}\"/>\n\t</bean>\n\t\n\t<bean id=\"listenerContainer\" class=\"org.springframework.jms.listener.SimpleMessageListenerContainer\"\n        destroy-method=\"destroy\">\n\t\t<property name=\"concurrentConsumers\" value=\"1\"/>\n\t\t<property name=\"connectionFactory\" ref=\"connectionFactory\" />\n\t\t<property name=\"messageListener\" ref=\"messageListener\" />\n\t\t<property name=\"destinationName\" value=\"destination\"/>\n\t\t<property name=\"destinationResolver\" ref=\"destinationResolver\"/>\n\t</bean>\n\t\n\t<bean id=\"messageListener\" class=\"com.xxx.yyy.platform.core.transport.activemq.MessageDispatcher\"\n        destroy-method=\"dispose\">\n\t\t<property name=\"destinationFactory\" ref=\"destinationResolver\"/> \n                <property name=\"messageConverter\">\n                    <bean class=\"org.springframework.jms.support.converter.SimpleMessageConverter\"/>\n                 </property>\n\t</bean>\t\n\nHence the connections are separate entities created by the ActiveMQConnectionFactory.\n\nIm am trying to reproduce this without our GUI/server stuff, just a simple AMQ Junit............","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=topper_harley","name":"topper_harley","key":"topper_harley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Trevor Higgins","active":true,"timeZone":"Etc/UTC"},"created":"2007-09-05T07:25:35.198+0000","updated":"2007-09-05T07:25:35.198+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/12941346","id":"12941346","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vpesochi","name":"vpesochi","key":"vpesochi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vadim Pesochinskiy","active":true,"timeZone":"Etc/UTC"},"body":"I found similar stack traces in following issues like AMQ-768 and AMQ-2147. I have the same issue in production now with syncSendPacket(Command) blocking forever. I am thinking that you would have a problem anywhere this method is called, because result may never come back. In AMQ-768 it does not come back because of connection reset or a server side error, in AMQ-2147 it does not come back because of memory issues on the client side.\n\nHere is my stack trace (amq v5.1.0), which is identical to the one listed above, but is parseable by IDEA.\n\n   java.lang.Thread.State: WAITING on edu.emory.mathcs.backport.java.util.concurrent.locks.CondVar@15ee98b5\n\tat java.lang.Object.wait(Native Method)\n\tat java.lang.Object.wait(Object.java:485)\n\tat edu.emory.mathcs.backport.java.util.concurrent.locks.CondVar.await(CondVar.java:75)\n\tat edu.emory.mathcs.backport.java.util.concurrent.ArrayBlockingQueue.take(ArrayBlockingQueue.java:318)\n\tat org.apache.activemq.transport.FutureResponse.getResult(FutureResponse.java:42)\n\tat org.apache.activemq.transport.ResponseCorrelator.request(ResponseCorrelator.java:75)\n\tat org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1175)\n\tat org.apache.activemq.ActiveMQConnection.createTempDestination(ActiveMQConnection.java:1600)\n\tat org.apache.activemq.ActiveMQSession.createTemporaryQueue(ActiveMQSession.java:1134)\n\tat org.logicblaze.lingo.jms.impl.SingleThreadedRequestor.createTemporaryDestination(SingleThreadedRequestor.java:109)\n\tat org.logicblaze.lingo.jms.impl.SingleThreadedRequestor.<init>(SingleThreadedRequestor.java:56)\n\tat org.logicblaze.lingo.jms.impl.MultiplexingRequestor.<init>(MultiplexingRequestor.java:64)\n\tat org.logicblaze.lingo.jms.impl.MultiplexingRequestor.<init>(MultiplexingRequestor.java:69)\n\tat org.logicblaze.lingo.jms.impl.MultiplexingRequestor.newInstance(MultiplexingRequestor.java:55)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vpesochi","name":"vpesochi","key":"vpesochi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vadim Pesochinskiy","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-20T20:49:35.911+0000","updated":"2009-05-20T20:49:35.911+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/12941662","id":"12941662","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danttran","name":"danttran","key":"danttran","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Tran","active":true,"timeZone":"Etc/UTC"},"body":"I have a similiar case with embedded AMQ 5.2 + tomcat 6.x + java 6, where my embedded jms client ( via vm:// ...) send operation hangs when the broker is heavily processing messages from an another external jms client ( via tcp:// ) . We are using non persistent messages.  Any advice to work around this issue is greatly appreciated.\n\nhere is the stack trace\n\nDaemon Thread [Thread-14] (Suspended)\t\n\tUnsafe.park(boolean, long) line: not available [native method]\t\n\tLockSupport.park(Object) line: 158\t\n\tAbstractQueuedSynchronizer$ConditionObject.await() line: 1925\t\n\tArrayBlockingQueue<E>.take() line: 317\t\n\tFutureResponse.getResult() line: 40\t\n\tResponseCorrelator.request(Object) line: 80\t\n\tActiveMQConnection.syncSendPacket(Command) line: 1233\t\n\tActiveMQSession.send(ActiveMQMessageProducer, ActiveMQDestination, Message, int, int, long, MemoryUsage, int) line: 1659\t\n\tActiveMQMessageProducer.send(Destination, Message, int, int, long) line: 227\t\n\tActiveMQMessageProducer(ActiveMQMessageProducerSupport).send(Message) line: 241\t\n\tJmsTemplate.doSend(MessageProducer, Message) line: 597\t\n\tJmsTemplate.doSend(Session, Destination, MessageCreator) line: 574\t\n\tJmsTemplate$4.doInJms(Session) line: 551\t\n\tJmsTemplate.execute(SessionCallback, boolean) line: 471\t\n\tJmsTemplate.send(String, MessageCreator) line: 548\t\n\tOracleSGAAgentProxy(AbstractAsyncAgentProxy).sendMessageToAgent(String) line: 92\t\n\tOracleSGAAgentProxy(AbstractAsyncAgentProxy).pingAgent() line: 147\t\n\tOracleSGAAgentProxy(AbstractAsyncAgentProxy).run() line: 173\t\n\tThread.run() line: 619\t\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danttran","name":"danttran","key":"danttran","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Tran","active":true,"timeZone":"Etc/UTC"},"created":"2009-07-02T01:19:11.464+0000","updated":"2009-07-02T01:19:11.464+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/12941661","id":"12941661","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danttran","name":"danttran","key":"danttran","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Tran","active":true,"timeZone":"Etc/UTC"},"body":"and it hangs after i stop the external client and drain all of its messages","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danttran","name":"danttran","key":"danttran","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Tran","active":true,"timeZone":"Etc/UTC"},"created":"2009-07-02T01:25:49.501+0000","updated":"2009-07-02T01:25:49.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/13004844","id":"13004844","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No tests provided and no info given if this occurs with the 5.x broker.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-03-09T22:37:01.796+0000","updated":"2011-03-09T22:37:01.796+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483255/comment/13912808","id":"13912808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dorus","name":"dorus","key":"dorus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doru Sular","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\nI have the same problem by using java 7, apache-tomcat-7.0.41 and apache-activemq-5.9.0.\nThe same code is working well from a unit test,but from tomcat environment connection.start() never returns, the blocking point is the same reported in the stacktrace from Dan Tran.\nThe code sample is here:\n{code}\n   BrokerService broker = new BrokerService();\n\n        // configure the broker\n        try\n            {\n            broker.addConnector(\"tcp://localhost:61616\");\n            broker.start();\n            broker.waitUntilStarted();\n            CONNECTION_FACTORY = new ActiveMQConnectionFactory(broker.getVmConnectorURI());\n            sendConnection = CONNECTION_FACTORY.createConnection();\n            sendConnection.start();\n\n            }\n        catch (Exception e)\n            {\n            e.printStackTrace();\n            }\n{code}\nEverything blocks at *sendConnection.start()*.\nPlease suggest an workaround or add a fix for that.\nThank you","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dorus","name":"dorus","key":"dorus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doru Sular","active":true,"timeZone":"Etc/UTC"},"created":"2014-02-26T12:14:39.016+0000","updated":"2014-02-26T12:14:39.016+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1375/votes","votes":5,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0am3j:"}}