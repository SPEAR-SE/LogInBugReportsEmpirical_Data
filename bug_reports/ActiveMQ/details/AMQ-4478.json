{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12643546","self":"https://issues.apache.org/jira/rest/api/2/issue/12643546","key":"AMQ-4478","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Apr 19 10:00:48 UTC 2013","customfield_12310420":"323913","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_124201_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-04-19T10:00:48.392+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4478/watchers","watchCount":1,"isWatching":false},"created":"2013-04-19T09:58:44.233+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"}],"issuelinks":[{"id":"12367717","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12367717","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12643545","key":"AMQ-4477","self":"https://issues.apache.org/jira/rest/api/2/issue/12643545","fields":{"summary":"ActiveMQ as WebSphere JMS Provider does not reconnect after AMQ server restart","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-04-19T10:00:48.415+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I have ActiveMQ defined as WebSphere 7 JMS Provider (see configuration script below).\nI expose ActiveMQ queues to my MDBs through Message Listener Port (MLP).\n\nMDB immediately consume arriving messages until something happens to the AMQ server connection (e.g. AMQ server is restarted due to maintenance activities).\nAccording to WebSphere policy MLP attempts to reestablish connection 5 times, every one minute. In most of the cases AMQ server is back again running within 5 min and WebSphere does not report any problem - status of MLP is \"running\".\nUnfortunately MBD does not consume any arriving messages until MLP is manually restarted. \nAfter restart everything starts to work as it should.\n\n\nActiveMQ JMS Provider configuration script (JACL):\n{code}\nimport sys\n\njmsProviderUrl = \"tcp://x.x.x.x:61616\"    \n# Retrieve cell name\ncell = AdminControl.getCell()\nscope = \"Cell=\" + cell\njmsProviderName = \"ActiveMQ\"\nnode = sys.argv[0]\nserver = sys.argv[1]\n\n# ----------------\n# Add JMS Provider\n# ----------------\nattributes = [[\"description\", \"ActiveMQ JMS Provider\"], \\\n              [\"propertySet\", [[\"resourceProperties\", [ \\\n                                                       [[\"name\", \"java.naming.connectionFactoryNames\"], [\"type\", \"java.lang.String\"], [\"value\", \"ConnectionFactory,XAConnectionFactory\"]], \\\n                                                       [[\"name\", \"java.naming.queue.MXITEMIN\"], [\"type\", \"java.lang.String\"], [\"value\", \"MX.ITEM.IN\"]] \\\n                                                       ] \\\n                                ]] \\\n               ]]\nAdminJMS.createJMSProviderAtScope(scope, jmsProviderName, \\\n                                  \"org.apache.activemq.jndi.ActiveMQWASInitialContextFactory\", \\\n                                  jmsProviderUrl, attributes)\n\n# ----------------------\n# Add Connection Factory\n# ----------------------\nattributes = [[\"description\", \"ActiveMQ Queue Connection Factory\"], \\\n              [\"type\", \"UNIFIED\"], \\\n              [\"connectionPool\", [ \\\n                                  [\"connectionTimeout\", \"1800\"], \\\n                                  [\"maxConnections\", \"6\"], \\\n                                  [\"minConnections\", \"0\"], \\\n                                  [\"reapTime\", \"180\"], \\\n                                  [\"unusedTimeout\", \"1800\"], \\\n                                  [\"agedTimeout\", \"1800\"], \\\n                                  [\"purgePolicy\", \"EntirePool\"] \\\n                                  ] \\\n               ], \\\n              [\"sessionPool\", [ \\\n                                  [\"connectionTimeout\", \"1800\"], \\\n                                  [\"maxConnections\", \"1\"], \\\n                                  [\"minConnections\", \"0\"], \\\n                                  [\"reapTime\", \"10\"], \\\n                                  [\"unusedTimeout\", \"1800\"], \\\n                                  [\"agedTimeout\", \"1800\"], \\\n                                  [\"purgePolicy\", \"EntirePool\"] \\\n                                  ] \\\n            ]]\nAdminJMS.createGenericJMSConnectionFactoryAtScope(scope, jmsProviderName, \"ACTIVEMQCF\", \\\n                                                  \"if/maximo/activemq/cf\", \"XAConnectionFactory\", \\\n                                                  attributes)\n\n# ----------------------\n# Add Queues\n# ----------------------\n# 1. MX.ASSET.IN\nattributes = [[\"description\", \"ActiveMQ ASSET Queue\"], [\"type\", \"QUEUE\"]]\nAdminJMS.createGenericJMSDestinationAtScope(scope, jmsProviderName, \"MAXIMO04IN\", \\\n                                            \"if/maximo/activemq/q04cin\", \"MXASSETIN\", \\\n                                            attributes) \n\n\n# ---------------------------------------\n# Create IF-server Message Listener Ports \n# ---------------------------------------\n# PORTMAXIMO01IN\nattributes = [[\"description\", \"ActiveMQ Item\"]]\nAdminServerManagement.configureListenerPortForMessageListenerService(node, server, \"PORTMAXIMO01IN\", \\\n                                                                     \"if/maximo/activemq/cf\", \\\n                                                                     \"if/maximo/activemq/q01cin\", \\\n                                                                     1, 5, 1, attributes)\n{code}\n\n------------------\nExpected behavior:\n------------------\nAMQ client should properly reestablish connection to AMQ server and pass through incoming messages or at least report back that connection is not working properly.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"324258","customfield_12312823":null,"summary":"ActiveMQ as WebSphere JMS Provider does not reconnect after AMQ server restart","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrzej.wieclaw%40gmail.com","name":"andrzej.wieclaw@gmail.com","key":"andrzej.wieclaw@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrzej Więcław","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrzej.wieclaw%40gmail.com","name":"andrzej.wieclaw@gmail.com","key":"andrzej.wieclaw@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrzej Więcław","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows Server 2008 R2","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643546/comment/13636230","id":"13636230","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrzej.wieclaw%40gmail.com","name":"andrzej.wieclaw@gmail.com","key":"andrzej.wieclaw@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrzej Więcław","active":true,"timeZone":"Europe/Berlin"},"body":"Duplicate-POST","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrzej.wieclaw%40gmail.com","name":"andrzej.wieclaw@gmail.com","key":"andrzej.wieclaw@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrzej Więcław","active":true,"timeZone":"Europe/Berlin"},"created":"2013-04-19T10:00:48.412+0000","updated":"2013-04-19T10:00:48.412+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4478/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1jvv3:"}}