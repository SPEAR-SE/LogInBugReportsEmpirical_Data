{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12737633","self":"https://issues.apache.org/jira/rest/api/2/issue/12737633","key":"AMQ-5338","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2014-12-04T21:28:15.188+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Sep 21 15:55:28 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_33573285581_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-09-21T15:55:28.263+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5338/watchers","watchCount":6,"isWatching":false},"created":"2014-08-29T02:00:42.761+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323932","id":"12323932","name":"5.9.0","archived":false,"released":true,"releaseDate":"2013-10-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324950","id":"12324950","name":"5.10.0","archived":false,"released":true,"releaseDate":"2014-06-10"}],"issuelinks":[{"id":"12395486","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12395486","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12736502","key":"AMQ-5331","self":"https://issues.apache.org/jira/rest/api/2/issue/12736502","fields":{"summary":"Memory Leak releated to TempQueues and JaasAuthenticationBroker.JaasSecurityContext","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-09-21T15:55:28.340+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Our production environment has used ActiveMQ 5.5.1 for a long time and it works well. Recently we decided to verify ActiveMQ 5.10 for prepared for upgrade. However, after we upgrade the test environment to 5.10, the MQ is easy ran into out of memory every 7-10 days. \n\nIn order to compare the two, I use the same environment and same configuration for both 5.5.1 and 5.10.0. Finally, 5.10.0 ran into out of memory while 5.5.1 works well.\n\nIt looks like a bug for 5.10.\n\nBelow is the main part of the configration\n<destinationPolicy>\n            <policyMap>\n              <policyEntries>\n                <policyEntry topic=\">\" advisoryForConsumed=\"false\" advisoryForDelivery=\"false\" gcInactiveDestinations=\"true\" inactiveTimoutBeforeGC=\"600000\" producerFlowControl=\"true\" memoryLimit=\"3mb\">\n                  <pendingSubscriberPolicy>\n                    <vmCursor />\n                  </pendingSubscriberPolicy>\n                </policyEntry>\n                <policyEntry queue=\">\" advisoryForConsumed=\"false\" advisoryForDelivery=\"false\" gcInactiveDestinations=\"true\" inactiveTimoutBeforeGC=\"600000\" producerFlowControl=\"true\" memoryLimit=\"3mb\">\n                </policyEntry>\n              </policyEntries>\n            </policyMap>\n        </destinationPolicy>\n\n<managementContext>\n            <managementContext createConnector=\"true\"/>\n        </managementContext>\n\n<plugins>\n\t\t\t\t<simpleAuthenticationPlugin>\n\t\t\t\t\t<users>\n\t\t\t\t\t\t<authenticationUser username=\"msgmanager\" password=\"Br0c@d3s0ft\" groups=\"admins\"/>\n\t\t\t\t\t</users>\n\t\t\t\t</simpleAuthenticationPlugin>\n\t\t\t  <authorizationPlugin>\n\t\t\t\t<map>\n\t\t\t\t  <authorizationMap>\n\t\t\t\t\t<authorizationEntries>\n\t\t\t\t\t  <authorizationEntry queue=\">\" read=\"admins\" write=\"admins\" admin=\"admins\" />\n\t\t\t\t\t  <authorizationEntry topic=\">\" read=\"admins\" write=\"admins\" admin=\"admins\" />\n\t\t\t\t\t</authorizationEntries>\n\t\t\t\t  </authorizationMap>\n\t\t\t\t</map>\n\t\t\t  </authorizationPlugin>\n\t    </plugins>\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Run into Memory Leak problem after upgrade from 5.5.1 to 5.10","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows 2012 R2,  JDK 1.7.40, CPU I5, Memory 8G","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14114759","id":"14114759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"body":"I have use JConsole to monitor the OOM problem and found for 5.10, something in \"tenured gen\" can not got released after GC. And the \"tenured gen\" will grow up and up and finally caused the problem. (Actually, each time after the full GC performed, the tenured gen can release some memory but it still keep going up)\n\nAgain, the GC situation is correct in 5.5.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-08-29T02:13:53.415+0000","updated":"2014-08-29T02:13:53.415+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14117134","id":"14117134","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"body":"Bellow is result from Eclipse Memory Analyzer\n\nProblem Suspect 1\nOne instance of \"com.sun.jmx.mbeanserver.JmxMBeanServer\" loaded by \"<system class loader>\" occupies 182,127,056 (57.45%) bytes. The instance is referenced by org.apache.activemq.broker.jmx.ManagementContext @ 0xf142bc0 , loaded by \"java.net.URLClassLoader @ 0xef3bad0\". The memory is accumulated in one instance of \"java.util.HashMap$Entry[]\" loaded by \"<system class loader>\".\n\nProblem Suspect 2\n74,663 instances of \"javax.management.ObjectName\", loaded by \"<system class loader>\" occupy 62,369,904 (19.67%) bytes. These instances are referenced from one instance of \"java.lang.Object[]\", loaded by \"<system class loader>\"\n\n\nPossible Memory Waste\nDuplicate Strings\nFound 146 occurrences of char[] with at least 10 instances having identical content. Total size is 8,593,000 bytes.\n\nTop elements include:\n•22 × \\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u... (59,338 bytes)\n•4,355 × JMS Client id of the Connection the Producer is on... (120 bytes)\n•4,355 × User Name used to authorize creation of this Produ... (120 bytes)\n•4,355 × The name of the destionation the Producer is on. (112 bytes)\n•4,355 × Is the producer configured for Async Dispatch (104 bytes) ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-09-01T07:44:47.837+0000","updated":"2014-09-01T07:44:47.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14234645","id":"14234645","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tbain98","name":"tbain98","key":"tbain98","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Bain","active":true,"timeZone":"America/Denver"},"body":"What GC strategy are you using?  And which JVM implementation?  (Hotspot, OpenJDK, IBM, etc.)  And are you sure that your \"full GCs\" were actually *full* GCs rather than just GCs that collected from Old Gen?\n\nUsing G1GC in Hotspot 7u21, I've seen behavior like what you described (with an upward-sloping sawtooth pattern for Old Gen usage), but once a real full GC happened, Old Gen dropped to nearly nothing and then started the pattern again, which makes me think that what I saw was a poor implementation of the G1GC algorithm rather than anything wrong with ActiveMQ.  Did you actually let things run until you hit an OutOfMemoryError?  If not, you're just speculating that a memory leak actually existed, because the GC strategy is under no obligation to collect everything that can be GCed at any point in time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tbain98","name":"tbain98","key":"tbain98","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tim Bain","active":true,"timeZone":"America/Denver"},"created":"2014-12-04T21:28:15.188+0000","updated":"2014-12-04T21:28:15.188+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14732292","id":"14732292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"body":"Hi there,\n\nWe also use AMQ 5.10 and we are monitoring our process using JMX. we also experience such OOM and the MAT reports about the same results: \n\nProblem Suspect 1\n\nOne instance of \"com.sun.jmx.mbeanserver.Repository\" loaded by \"<system class loader>\" occupies 1,050,891,224 (33.43%) bytes. The instance is referenced by org.apache.activemq.broker.TransportConnection$2 @ 0x7bb1427b8 Async Exception Handler , loaded by \"java.net.URLClassLoader @ 0x7000430b8\". The memory is accumulated in one instance of \"java.util.HashMap$Node[]\" loaded by \"<system class loader>\".\n\n\n\nProblem Suspect 2\n\n756,250 instances of \"javax.management.ObjectName\", loaded by \"<system class loader>\" occupy 1,365,859,400 (43.45%) bytes. \n\nKeywords\njavax.management.ObjectName\n\n\nhere is our process command line :\n\n/usr/local/panorama/java/bin/java -Xms512m -Xmx3072m -XX:+HeapDumpOnOutOfMemoryError  -Djava.util.logging.config.file=logging.properties -Djava.security.auth.login.config=/usr/local/panorama/activemq/conf/login.config -Djava.rmi.server.hostname=10.x.x.22 -Dcom.sun.management.jmxremote.port=11099 -Dcom.sun.management.jmxremote.password.file=/usr/local/panorama/etc/jmx/activemq_jmx.pass -Dcom.sun.management.jmxremote.access.file=/usr/local/panorama/etc/jmx/activemq_jmx.access -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote -Djava.awt.headless=true -Djava.io.tmpdir=/usr/local/panorama/activemq/tmp -Dactivemq.classpath=/usr/local/panorama/activemq/conf; -Dactivemq.home=/usr/local/panorama/activemq -Dactivemq.base=/usr/local/panorama/activemq -Dactivemq.conf=/usr/local/panorama/activemq/conf -Dactivemq.data=/usr/local/panorama/activemq/data -jar /usr/local/panorama/activemq/bin/activemq.jar start \n\n\nwe do not specify GC algo, so i guess its the default for :\n\njava version \"1.8.0_45\"\nJava(TM) SE Runtime Environment (build 1.8.0_45-b14)\nJava HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode) \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"created":"2015-09-06T08:02:35.618+0000","updated":"2015-09-06T08:02:35.618+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14732346","id":"14732346","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"The latest release is 5.12.0.  I'd advise you to use that and if you still think you have a leak condition then create a test that can be used to reproduce and analyse the problem.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-09-06T10:58:55.009+0000","updated":"2015-09-06T10:58:55.009+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14733209","id":"14733209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi Daniel:\n I suggest you to try 5.12. I have test that several days ago and found this issue not occur in V5.12","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-09-07T02:22:21.022+0000","updated":"2015-09-07T02:22:21.022+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14733290","id":"14733290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"body":"Thank you both, \nI will do just that (move to 5.12).\nkeep you posted (for better or worse).\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"created":"2015-09-07T06:27:32.383+0000","updated":"2015-09-07T06:27:32.383+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14736731","id":"14736731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"body":"Unfortunately, this memory issue is reproduced with 5.12.\nI noticed that one of the Advisory topics has a very large number of enqueue messages but zero dequeue.\ncould this be the cause ?\nwhat are the Advisory items ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"created":"2015-09-09T12:04:11.999+0000","updated":"2015-09-09T12:04:11.999+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14736796","id":"14736796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"The advisory bit sounds normal, the client subscribes to the Topic to be informed of temp destination create / destroy etc.  Am not seeing any concrete evidence of leaks presented here.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-09-09T12:57:40.975+0000","updated":"2015-09-09T12:57:40.975+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14738047","id":"14738047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"body":"Actually, when I do the test, I set advisorySupport=\"false\". But even after this setting, I can reproduce the issue in V5.9 and V5.10. But for V5.12, I can not reproduce it with same setting. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=edwin_wang","name":"edwin_wang","key":"edwin_wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edwin Wang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-09-10T02:45:51.757+0000","updated":"2015-09-10T02:45:51.757+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14738253","id":"14738253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"body":"I am happy to say that we found the cause of the leak (well, sort of). we found some third party code that probably not closing sessions properly, and then all messages sent on that session were not released (that's a guess, not a fact). \nThe only troubling thing here is that the heap dump clearly showed a big Map of ObjectName which was very misleading in regards to finding the cause. \n\nCould someone elaborate on why there are so many ObjectName objects when such bug occur (producer not properly using the AMQ session) ?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsebbagh","name":"dsebbagh","key":"dsebbagh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Sabag","active":true,"timeZone":"Asia/Jerusalem"},"created":"2015-09-10T06:26:03.041+0000","updated":"2015-09-10T06:26:03.041+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14900874","id":"14900874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"The ObjectName instance most likely represent the JMX objects registered to allow for gathering statistics on connections, and their associated producers and consumers etc.  If you have some misbehaving client code that is opening and not closing down these resources then you are likely to see things like this.  Exploring the JMX tree via JConsole or the like would give you more insight into what is happening on your Broker instance and is the very reason for their existence.  \n\nIt doesn't sound to me like there is a bug here.  I am going to close this as not a problem, if you find a test case that shows some actual issue please open a new issue to track it.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-09-21T15:54:29.681+0000","updated":"2015-09-21T15:54:29.681+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12737633/comment/14900879","id":"14900879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Problem seems to be due to bad code on the client side not closing down connections. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2015-09-21T15:55:28.327+0000","updated":"2015-09-21T15:55:28.327+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-5338/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1zgyn:"}}