{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12532462","self":"https://issues.apache.org/jira/rest/api/2/issue/12532462","key":"AMQ-3605","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-11-23T13:04:31.294+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Dec 13 23:14:12 UTC 2011","customfield_12310420":"218195","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1767535405_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-12-13T23:14:12.254+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3605/watchers","watchCount":0,"isWatching":false},"created":"2011-11-23T12:15:16.993+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":["stomp"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315626","id":"12315626","description":"","name":"5.5.0","archived":false,"released":true,"releaseDate":"2011-04-01"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-12-13T23:14:12.366+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I'm running ActiveMQ 5.5.0 and clients using Net::Stomp 0.38_99 and I'm seeing infrequent NullPointerExceptions in TransportConnection:\n\n{noformat}\nException in thread \"ActiveMQ Connection Dispatcher: /172.31.201.11:50607\" java.lang.NullPointerException\n        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:327)\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:179)\n        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:69)\n        at org.apache.activemq.transport.stomp.StompTransportFilter.sendToActiveMQ(StompTransportFilter.java:81)\n        at org.apache.activemq.transport.stomp.StompSubscription.onMessageDispatch(StompSubscription.java:79)\n        at org.apache.activemq.transport.stomp.ProtocolConverter.onActiveMQCommand(ProtocolConverter.java:596)\n        at org.apache.activemq.transport.stomp.StompTransportFilter.oneway(StompTransportFilter.java:58)\n        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n        at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:1270)\n        at org.apache.activemq.broker.TransportConnection.processDispatch(TransportConnection.java:815)\n        at org.apache.activemq.broker.TransportConnection.iterate(TransportConnection.java:851)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:104)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:42)\n{noformat}\n\nThis seems to happen 1-2 times per month or so but the result is dire: new messages aren't delivered to the affected client (you can see the number of pending messages increasing in the admin web interface) until the client or ActiveMQ is restarted.\n\nRelevant code snippet from TransportConnection.java,\n\n{noformat}\n326         if (context != null) {\n327             if (context.isDontSendReponse()) {\n{noformat}\n\nimplies that we are dealing with a race condition. I'm not familiar with the ActiveMQ code base but it looks like it grabs a lock (serviceLock) before entering that function, so not sure what's going on.\n\nSince there's no timestamp associated with the stack trace I'm not completly sure what's going on on the client side. I've tried to reproduce it by writing a small script that uses Net::Stomp in a similar way to my real clients, but no luck so far.\n\nNo idea if it's relevant, but my affected clients have been both consuming and producing, and sending/receiving on both topics and queues.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12505618","id":"12505618","filename":"AMQ-3605-Patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-30T13:05:40.572+0000","size":6318,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12505618/AMQ-3605-Patch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12505619","id":"12505619","filename":"StompDedicatedTaskRunnerTests.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-30T13:07:21.283+0000","size":7280,"mimeType":"text/x-java","content":"https://issues.apache.org/jira/secure/attachment/12505619/StompDedicatedTaskRunnerTests.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12504890","id":"12504890","filename":"StompDedicatedTaskRunnerTests.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-23T16:18:46.960+0000","size":4736,"mimeType":"text/x-java","content":"https://issues.apache.org/jira/secure/attachment/12504890/StompDedicatedTaskRunnerTests.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"59274","customfield_12312823":null,"summary":"NullPointerException in TransportConnection","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"SLES 11 SP1\njava version \"1.6.0_23\"\nperl 5.10.0 + Net::Stomp 0.38_99","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13155832","id":"13155832","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"body":"I haven't tried the trunk version yet, but I don't see any relevant changes in svn so figured I should ask here first.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-23T12:23:10.318+0000","updated":"2011-11-23T12:23:10.318+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13155849","id":"13155849","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"please try trunk, if you reproduce it will provide a stack trace (line numbers) and context that matches trunk where it will be fixed.\nThe addition of an inactivity monitor for stomp 1.1 support has caused some tightening up of the synchronization between stomp and amq request paths, this may be relevant.\n\nAlso please attach the broker log files, it may be contention between connection tear down and dispatch. In addition, if you can reproduce, add trace level logging to TransportConnection to gather some extra information.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-23T13:04:31.294+0000","updated":"2011-11-23T13:04:31.294+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13155870","id":"13155870","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for quick reply.\n\nI saved the stack trace above from the console output, I don't see it in my activemq.log. I do see some EOFExceptions for other clients in activemq.log around that time:\n\n{noformat}\n2011-11-21 17:26:58,051 | INFO  | Transport failed: java.io.EOFException | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///172.31\n.201.11:50680\n2011-11-21 17:44:39,533 | INFO  | Transport failed: java.io.EOFException | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///172.31\n.201.11:46575\n2011-11-21 18:30:38,362 | INFO  | Transport failed: java.io.EOFException | org.apache.activemq.broker.TransportConnection.Transport | ActiveMQ Transport: tcp:///172.31\n.201.11:46577\n{noformat}\n\nI think the NullPointerException occured shortly after 17:44. As far as I can tell, EOFExceptions are normal for stomp clients in 5.5.0, and I don't see it for affected clients anyway.\n\nI'll try a trunk snapshot.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-23T13:46:35.729+0000","updated":"2011-11-23T13:46:35.729+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13155943","id":"13155943","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"I've started looking into this a bit and while I haven't been able to reproduce the NullPointerException I can cause a different exception that seems to be related.  The error seems to be coming from the auto ack of a message that's being dispatched as the connection is closed or broker on the client side.  This happens more often with a large prefetch such that the broker is busy dispatching messages when the disconnect comes in.\n\nAttaching the test case I have so far as I will be out over thanksgiving.\n\n{noformat}\n2011-11-23 10:20:42,152 [127.0.0.1:57419] - WARN  Service                        - Async error occurred: java.lang.IllegalStateException: Cannot lookup a consumer from a connection that had not been registered: ID:OfficePC-40536-1322061638124-3:1\njava.lang.IllegalStateException: Cannot lookup a consumer from a connection that had not been registered: ID:OfficePC-40536-1322061638124-3:1\n\tat org.apache.activemq.broker.SingleTransportConnectionStateRegister.lookupConnectionState(SingleTransportConnectionStateRegister.java:83)\n\tat org.apache.activemq.broker.TransportConnection.lookupConnectionState(TransportConnection.java:1434)\n\tat org.apache.activemq.broker.TransportConnection.getConsumerBrokerExchange(TransportConnection.java:1348)\n\tat org.apache.activemq.broker.TransportConnection.processMessageAck(TransportConnection.java:476)\n\tat org.apache.activemq.command.MessageAck.visit(MessageAck.java:229)\n\tat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:318)\n\tat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:181)\n\tat org.apache.activemq.transport.MutexTransport.onCommand(MutexTransport.java:45)\n\tat org.apache.activemq.transport.AbstractInactivityMonitor.onCommand(AbstractInactivityMonitor.java:229)\n\tat org.apache.activemq.transport.stomp.StompTransportFilter.sendToActiveMQ(StompTransportFilter.java:87)\n\tat org.apache.activemq.transport.stomp.StompSubscription.onMessageDispatch(StompSubscription.java:78)\n\tat org.apache.activemq.transport.stomp.ProtocolConverter.onActiveMQCommand(ProtocolConverter.java:746)\n\tat org.apache.activemq.transport.stomp.StompTransportFilter.oneway(StompTransportFilter.java:64)\n\tat org.apache.activemq.transport.AbstractInactivityMonitor.doOnewaySend(AbstractInactivityMonitor.java:262)\n\tat org.apache.activemq.transport.AbstractInactivityMonitor.oneway(AbstractInactivityMonitor.java:244)\n\tat org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:68)\n\tat org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:1281)\n\tat org.apache.activemq.broker.TransportConnection.processDispatch(TransportConnection.java:830)\n\tat org.apache.activemq.broker.TransportConnection.iterate(TransportConnection.java:866)\n\tat org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\n\tat org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-23T16:18:13.427+0000","updated":"2011-11-23T16:18:13.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13156035","id":"13156035","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"For the error I was able to reproduce the problem comes from a race between the processDispatch in TransportConnection's iterate method and the processRemoveConnection method where is does:\n\n{noformat}\n TransportConnectionState state = unregisterConnectionState(id);\n{noformat}\n\nSince the connection is removed right before the processDispatch males the loop from the Stomp transport's auto ack of the dispatched message we end up with the above error.  The NPE that the reporter has seen is probably related to something similar.  \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-23T18:29:10.782+0000","updated":"2011-11-23T18:29:10.782+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13160020","id":"13160020","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Patch the seems to resolve the issue,","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-30T13:05:40.650+0000","updated":"2011-11-30T13:05:40.650+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13160021","id":"13160021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Updated test case, not really meant for inclusion as it doesn't actually assert anything to show the exceptions but at least allows them to be seen.  Can fail as the disconnect response isn't always read fast enough due to all the prefetched messages.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-30T13:07:21.354+0000","updated":"2011-11-30T13:07:21.354+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13160023","id":"13160023","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Added a tentative patch to the TransportConnection class.  Seems to resolve the issue but I was seeing some failures in some unit tests locally and haven't fully resolved if they are related to this change or just the normal flaky tests we see fail sometimes.  Most failures seem to be in the Network bridge areas.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-11-30T13:08:55.070+0000","updated":"2011-11-30T13:08:55.070+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13167478","id":"13167478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"body":"I've done some testing against 5.6-SNAPSHOT (as of 2011-11-23). I don't see the NPE anymore but clients closing the socket in an unclean fashion seems to still be a problem. \n\nIt looks like my affected client now hangs on the SEND call. I can reproduce this problem within minutes by stressing my clients while a script repeatedly forks, connects to AMQ, subscribes to a topic and then calls _exit() (to make sure the socket isn't closed by the garbage collector).\n\nThe resulting AMQ log is 200MB+ and may contain sensitive information, so I can't attach it as it is. Just before the client hangs I see (log excerpts slightly edited, message bodies and headers are removed):\n\n{noformat}\n2011-12-12 10:56:21,776 | TRACE | Received: \nSEND\n[...]\n\n2011-12-12 10:56:21,776 | DEBUG | message is ActiveMQTextMessage {commandId = 2262, responseRequired = false, messageId = ID:dev01-54928-1323379526715-4:15980:-1:1:\n2254, originalDestination = null, originalTransactionId = null, producerId = ID:dev01-54928-1323379526715-4:15980:-1:1, destination = topic://change.TRANSFER, trans\nactionId = null, expiration = 0, timestamp = 1323683781775, arrival = 0, brokerInTime = 1323683781775, brokerOutTime = 1323683781775, correlationId = null, replyTo = n\null, persistent = false, type = EVENT.ResourceChangeEvent, priority = 4, groupID = null, groupSequence = 0, targetConsumerId = null, compressed = false, userID = null,\n content = null, marshalledProperties = null, dataStructure = null, redeliveryCounter = 0, size = 1507, properties = {[...]}, readOnlyProperties = true, readO\nnlyBody = true, droppable = false, text = <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<atom:...atom:entry>\n}\n2011-12-12 10:56:21,776 | DEBUG | Message available, but continuation is already resumed.  Buffer for next time.\n2011-12-12 10:56:21,776 | DEBUG | Transport failed: java.io.EOFException\njava.io.EOFException\n        at java.io.DataInputStream.readByte(DataInputStream.java:250)\n        at org.apache.activemq.transport.stomp.StompWireFormat.readHeaderLine(StompWireFormat.java:155)\n        at org.apache.activemq.transport.stomp.StompWireFormat.readLine(StompWireFormat.java:148)\n        at org.apache.activemq.transport.stomp.StompWireFormat.parseAction(StompWireFormat.java:170)\n        at org.apache.activemq.transport.stomp.StompWireFormat.unmarshal(StompWireFormat.java:98)\n        at org.apache.activemq.transport.tcp.TcpTransport.readCommand(TcpTransport.java:229)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:221)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:204)\n        at java.lang.Thread.run(Thread.java:662)\n2011-12-12 10:56:21,776 | DEBUG | message for ActiveMQMessageConsumer { value=ID:dev01-54928-1323379526715-8:58:1:1, started=true } continuation=org.eclipse.jetty.s\nerver.AsyncContinuation@e9b412d@IDLE,initial\n2011-12-12 10:56:21,776 | DEBUG | message for ActiveMQMessageConsumer { value=ID:dev01-54928-1323379526715-8:57:1:1, started=true } continuation=org.eclipse.jetty.s\nerver.AsyncContinuation@50afeae@IDLE,initial\n2011-12-12 10:56:21,776 | TRACE | org.apache.activemq.broker.region.cursors.QueueStorePrefetch@73a2335d:daemon.archived,batchResetNeeded=false,storeHasMessages=true,si\nze=0,cacheEnabled=true - fillBatch\n2011-12-12 10:56:21,777 | TRACE | ID:dev01-54928-1323379526715-8:58:1:1 received message: MessageDispatch {commandId = 391, responseRequired = false, consumerId = I\nD:dev01-54928-1323379526715-8:58:1:1, destination = topic://change.TRANSFER, message = ActiveMQTextMessage {commandId = 2262, responseRequired = false, messageId = \nID:dev01-54928-1323379526715-4:15980:-1:1:2254, originalDestination = null, originalTransactionId = null, producerId = ID:dev01-54928-1323379526715-4:15980:-1:1,\n destination = topic://change.TRANSFER, transactionId = null, expiration = 0, timestamp = 1323683781775, arrival = 0, brokerInTime = 1323683781775, brokerOutTime = 132\n3683781775, correlationId = null, replyTo = null, persistent = false, type = EVENT.ResourceChangeEvent, priority = 4, groupID = null, groupSequence = 0, targetConsumer\nId = null, compressed = false, userID = null, content = null, marshalledProperties = null, dataStructure = null, redeliveryCounter = 0, size = 1507, properties = {[...]},\nreadOnlyProperties = true, readOnlyBody = true, droppable = false, text = <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<atom:...atom:entry>\n}, redeliveryCounter = 0}\n2011-12-12 10:56:21,776 | DEBUG | Transport failed: java.net.SocketException: Broken pipe\njava.net.SocketException: Broken pipe\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at org.apache.activemq.transport.tcp.TcpBufferedOutputStream.flush(TcpBufferedOutputStream.java:115)\n        at java.io.DataOutputStream.flush(DataOutputStream.java:106)\n        at org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:184)\n        at org.apache.activemq.transport.stomp.StompTransportFilter.sendToStomp(StompTransportFilter.java:97)\n        at org.apache.activemq.transport.stomp.StompSubscription.onMessageDispatch(StompSubscription.java:99)\n        at org.apache.activemq.transport.stomp.ProtocolConverter.onActiveMQCommand(ProtocolConverter.java:746)\n        at org.apache.activemq.transport.stomp.StompTransportFilter.oneway(StompTransportFilter.java:64)\n        at org.apache.activemq.transport.AbstractInactivityMonitor.doOnewaySend(AbstractInactivityMonitor.java:262)\n        at org.apache.activemq.transport.AbstractInactivityMonitor.oneway(AbstractInactivityMonitor.java:244)\n        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:68)\n        at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:1281)\n        at org.apache.activemq.broker.TransportConnection.processDispatch(TransportConnection.java:830)\n        at org.apache.activemq.broker.TransportConnection.iterate(TransportConnection.java:866)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n{noformat}\n\nThe \"Received: SEND\" message is from my affected client. I see a bunch of such messages after the SocketException before the client hangs two seconds later. I assume the client hangs because some buffer at some level is full. I can't see anything obvious explaining why AMQ stops processing the client's messages.\n\nOccasionally I also see the following exception:\n\n{noformat}\njava.lang.IllegalStateException: Cannot lookup a producer from a connection that had not been registered: ID:dev01-54928-1323379526715-4:59\n        at org.apache.activemq.broker.SingleTransportConnectionStateRegister.lookupConnectionState(SingleTransportConnectionStateRegister.java:93)\n        at org.apache.activemq.broker.TransportConnection.lookupConnectionState(TransportConnection.java:1438)\n        at org.apache.activemq.broker.TransportConnection.getProducerBrokerExchange(TransportConnection.java:1314)\n        at org.apache.activemq.broker.TransportConnection.processMessage(TransportConnection.java:468)\n        at org.apache.activemq.command.ActiveMQMessage.visit(ActiveMQMessage.java:681)\n        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:318)\n        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:181)\n        at org.apache.activemq.transport.MutexTransport.onCommand(MutexTransport.java:45)\n        at org.apache.activemq.transport.AbstractInactivityMonitor.onCommand(AbstractInactivityMonitor.java:229)\n        at org.apache.activemq.transport.stomp.StompTransportFilter.sendToActiveMQ(StompTransportFilter.java:87)\n        at org.apache.activemq.transport.stomp.ProtocolConverter.sendToActiveMQ(ProtocolConverter.java:166)\n        at org.apache.activemq.transport.stomp.ProtocolConverter.onStompSend(ProtocolConverter.java:292)\n        at org.apache.activemq.transport.stomp.ProtocolConverter.onStompCommand(ProtocolConverter.java:204)\n        at org.apache.activemq.transport.stomp.StompTransportFilter.onCommand(StompTransportFilter.java:76)\n        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)\n        at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:222)\n        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:204)\n{noformat}\n\nThis exception is triggered more often when I do the stress test but sometimes it doesn't appear to have been thrown at all when the client has hanged.\n\nNot sure how useful these log excerpts are. I haven't tested the attached patch yet. If you think it will help I can try to build AMQ myself.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-12T12:50:44.551+0000","updated":"2011-12-12T14:32:58.879+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13167609","id":"13167609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"body":"I went ahead and tested the patch. It didn't apply cleanly, but the rejected hunks were only change of for-loop constructs, so I ignored those.\n\nThe patch didn't solve the issue. Perhaps not related but at 17:54:01 I see a SocketException, and at 17:54:05 there's an InactivityIOException (my client hanged at 17:54:13):\n\n{noformat}\n2011-12-12 17:54:05,045 | TRACE | Received:\nSEND\n[...]\n\n2011-12-12 17:54:05,043 | DEBUG | Transport failed: org.apache.activemq.transport.InactivityIOException: Cannot send, channel has already failed: tcp://172.31.201.1:45\n974\norg.apache.activemq.transport.InactivityIOException: Cannot send, channel has already failed: tcp://172.31.201.1:45974\n        at org.apache.activemq.transport.AbstractInactivityMonitor.doOnewaySend(AbstractInactivityMonitor.java:255)\n        at org.apache.activemq.transport.AbstractInactivityMonitor.oneway(AbstractInactivityMonitor.java:244)\n        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:68)\n        at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:1268)\n        at org.apache.activemq.broker.TransportConnection.processDispatch(TransportConnection.java:804)\n        at org.apache.activemq.broker.TransportConnection.iterate(TransportConnection.java:839)\n        at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\n        at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n{noformat}\n\nThe SEND message is from the affected client.\n\nAre there any particular messages I should look for? Or do you have any suggestions on where to put extra LOG.debug calls?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-12T17:24:02.814+0000","updated":"2011-12-12T17:24:02.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13167667","id":"13167667","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Depends somewhat on what branch of code you applied this to.  It should be applied to trunk and not a 5.5.x branch.  Testing here shows no issues of this sort so far.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-12-12T18:47:20.767+0000","updated":"2011-12-12T18:47:20.767+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13167671","id":"13167671","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"body":"The patch was applied to trunk (checkout from today, r1213236).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-12T18:52:59.130+0000","updated":"2011-12-12T19:21:49.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13167710","id":"13167710","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"From the little bit of info provided I don't see an issue here as it looks as though the client was disconnected due to inactivity.  The debug log seems fine as it indicates that the send to the client fails because it was dropped.  You didn't get any NullPointerExceptions correct?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-12-12T19:43:23.912+0000","updated":"2011-12-12T19:43:23.912+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13167774","id":"13167774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"body":"No NullPointerExceptions with 4.6-SNAPSHOT/trunk, that is correct.\n\nAccording to the \"Connections\" admin web page (and netstat), the affected client is still connected to AMQ. I assume all or most EOFExceptions, SocketExceptions and InactivityIOException are from my fork/connect/subscribe/exit script.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tomyl","name":"tomyl","key":"tomyl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tommy Lindgren","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-12T20:35:25.741+0000","updated":"2011-12-12T20:35:25.741+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12532462/comment/13168838","id":"13168838","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Fix applied in trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-12-13T23:14:12.321+0000","updated":"2011-12-13T23:14:12.321+0000"}],"maxResults":15,"total":15,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3605/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0aiiv:"}}