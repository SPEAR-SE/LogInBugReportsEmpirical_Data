{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12481939","self":"https://issues.apache.org/jira/rest/api/2/issue/12481939","key":"AMQ-962","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2006-10-10T06:31:26.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Mar 07 14:21:07 UTC 2007","customfield_12310420":"84376","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_13108335086_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2007-03-07T14:21:07.086+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-962/watchers","watchCount":0,"isWatching":false},"created":"2006-10-06T21:08:52.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315611","id":"12315611","description":"","name":"4.0.1","archived":false,"released":true,"releaseDate":"2006-06-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-03-07T14:21:07.080+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Using Spring, configured a VM message broker (non-persistant) and a message consumer that reads messages from queue.\n\nMessages are read from queue, but despite calling message.acknowledge(); messages remain on the queue (and consume memory).\n\nI turned off optimiseAcknowledge.\n\nMay be related to bug# AMQ-716.\n\n\t  <amq:broker id=\"broker\" useJmx=\"true\" persistent=\"false\">\n\t    <amq:transportConnectors>\n\t      <amq:transportConnector uri=\"tcp://localhost:0\" />\n\t    </amq:transportConnectors>\n\t  </amq:broker>\n\n\t <!-- a pooling based JMS provider -->\n\t  <bean id=\"jmsFactory\" class=\"org.apache.activemq.pool.PooledConnectionFactory\">\n\t    <property name=\"connectionFactory\">\n\t      <bean class=\"org.apache.activemq.ActiveMQConnectionFactory\">\n\t        <property name=\"brokerURL\">\n\t          <value>vm://localhost</value>\n\t        </property>\n\t        <property name=\"optimizeAcknowledge\">\n\t          <value>false</value>\n\t        </property>\t        \n\t      </bean>\n\t    </property>\n\t  </bean>\n\n\t  <bean id=\"simpleJmsTemplate\" class=\"org.springframework.jms.core.JmsTemplate\">\n\t    <property name=\"connectionFactory\">\n\t    \t<ref local=\"jmsFactory\" />\n\t    </property>\n\t  </bean>\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"161496","customfield_12312823":null,"summary":"Messages are read from queue but not removed","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rlp82","name":"rlp82","key":"rlp82","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Randy","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rlp82","name":"rlp82","key":"rlp82","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Randy","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Java Virtual Machine: Java HotSpot(TM) Server VM version 1.5.0_06-b05JIT \ncompiler:  HotSpot Server Compiler\nOperating System:  Windows XP 5.1\nArchitecture: x86\nNumber of processors:  1\nTotal physical memory:   1,048,048 kbytes\nFree physical memory:     107,240 kbytes\nCommitted virtual memory:     374,048 kbytes\nTotal swap space:   2,518,944 kbytes\nFree swap space:     721,416 kbytes\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481939/comment/12936522","id":"12936522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hbruch","name":"hbruch","key":"hbruch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Holger Bruch","active":true,"timeZone":"Etc/UTC"},"body":"I encountered a similar problem when using the PooledConnectionFactory, which is currently intended for sending messages only. In my case, it was caused by a concurrency issue when the session is closed and messages are still processed by the consumer. The PooledSession does not halt the underlying session's executor, so that messages are still delivered when the session is about to close. These messages might in your case be read, but not acknowledged.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hbruch","name":"hbruch","key":"hbruch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Holger Bruch","active":true,"timeZone":"Etc/UTC"},"created":"2006-10-10T06:31:26.000+0000","updated":"2006-10-10T06:31:26.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12481939/comment/12938832","id":"12938832","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"body":"I think this should now be fixed. Let us konw if you can still reproduce it","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jstrachan","name":"jstrachan","key":"jstrachan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"james strachan","active":true,"timeZone":"Etc/UTC"},"created":"2007-03-07T14:21:07.077+0000","updated":"2007-03-07T14:21:07.077+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-962/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0s04f:"}}