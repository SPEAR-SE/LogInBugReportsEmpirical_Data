{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482087","self":"https://issues.apache.org/jira/rest/api/2/issue/12482087","key":"AMQ-1389","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2007-10-01T20:25:57.027+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Oct 01 20:25:57 UTC 2007","customfield_12310420":"95778","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1160219670_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2007-10-01T20:25:57.566+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1389/watchers","watchCount":0,"isWatching":false},"created":"2007-09-18T10:08:57.896+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-10-01T20:25:57.550+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10091","value":"Regression","id":"10091"}],"description":"I have two consumers, having a durable subscription on a topic. If I send a persistent message to the topic, everything works ok. However, when I restart the consumers, one of them receives the message again after connecting (it seems to be the one that ACK's the message as second). Reconnecting again doesn't give any problems, the messages aren't redelivered.\n\nThis problem does not happen when only a single consumer is connected. Also, it doesn't appear if the persistent message is sent before the consumers are connected.\n\nSteps to reproduce:\nStart two consumers with a durable topic subscription (in the example/ directory):\n\n$ ant consumer -Ddurable=true -DclientId=test1 -Dtopic=true\n$ ant consumer -Ddurable=true -DclientId=test2 -Dtopic=true\n\nSend persistent messages to this topic:\n\n$ ant producer -Ddurable=true -Dtopic=true\n\nKill consumers and start them again. One of them willl receive each message again.\n\nThis also happens if I use the STOMP protocol. In ActiveMQ 4.1.1 things work as expected, but in snapshots (I tried 4.2 and 5.0), the behaviour is as above.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"255071","customfield_12312823":null,"summary":"Duplicate messages with durable subscribers and perstitent messages","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijsklont","name":"ijsklont","key":"ijsklont","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pieter","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijsklont","name":"ijsklont","key":"ijsklont","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pieter","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"linux, persistent=\"true\" in broker config","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482087/comment/12939048","id":"12939048","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijsklont","name":"ijsklont","key":"ijsklont","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pieter","active":true,"timeZone":"Etc/UTC"},"body":"This problem still exists in the 5.0 release candidate Hiram posted. I consider this a major blocker: under no circumstances acknowledged messages should be sent to a consumer again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijsklont","name":"ijsklont","key":"ijsklont","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pieter","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-01T10:24:43.263+0000","updated":"2007-10-01T10:24:43.263+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482087/comment/12939011","id":"12939011","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijsklont","name":"ijsklont","key":"ijsklont","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pieter","active":true,"timeZone":"Etc/UTC"},"body":"I think I've traced the source of the problem: it only appears when I have this persistenceAdapter configuration:\n\n<persistenceAdapter>\n          <journaledJDBC journalLogFiles=\"5\" dataDirectory=\"${activemq.base}/activemq-data\"/>\n</persistenceAdapter>\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijsklont","name":"ijsklont","key":"ijsklont","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pieter","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-01T11:15:49.880+0000","updated":"2007-10-01T11:15:49.880+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482087/comment/12938442","id":"12938442","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"Look like this was resolved when https://issues.apache.org/activemq/browse/AMQ-1095 was resolved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2007-10-01T20:25:57.027+0000","updated":"2007-10-01T20:25:57.027+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1389/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i181nr:"}}