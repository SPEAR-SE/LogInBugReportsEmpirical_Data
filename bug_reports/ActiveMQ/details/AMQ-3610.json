{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12533069","self":"https://issues.apache.org/jira/rest/api/2/issue/12533069","key":"AMQ-3610","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2011-12-07T04:52:40.816+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 07 07:41:45 UTC 2011","customfield_12310420":"218797","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1140690714_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-12-12T10:55:59.766+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3610/watchers","watchCount":3,"isWatching":false},"created":"2011-11-29T06:04:29.152+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["activemq","broker"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315626","id":"12315626","description":"","name":"5.5.0","archived":false,"released":true,"releaseDate":"2011-04-01"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-12-12T10:55:59.824+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Hi,\nAm using AMQ 5.5. I would like to disable the option of sending dead letters to ActiveMQ.DLQ destination and completely discard (automatically) the messages that would be sent there otherwise. To do this I had configured the broker as below:\n\n{code:xml}\n        <amq:destinationPolicy>\n            <amq:policyMap>\n              <amq:policyEntries>\n                <amq:policyEntry topic=\">\" producerFlowControl=\"false\" >\n                    <amq:deadLetterStrategy>\n                          <amq:sharedDeadLetterStrategy processExpired=\"false\" />\n                    </amq:deadLetterStrategy>\n                </amq:policyEntry>\n                <amq:policyEntry queue=\">\" producerFlowControl=\"false\">\n                    <amq:deadLetterStrategy>\n                          <amq:sharedDeadLetterStrategy processExpired=\"false\" />\n                    </amq:deadLetterStrategy>\n                </amq:policyEntry>\n\n              </amq:policyEntries>\n            </amq:policyMap>\n        </amq:destinationPolicy>\n{code}\n\nHowever, I still see that the messages are getting stored in DLQ. Can you please let me know what could be causing this?\nDo I need to fix anything in the config?\n\nThanks\nHari","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"81682","customfield_12312823":null,"summary":"sharedDeadLetterStrategy is not discarding the DLQ messages.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164131","id":"13164131","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"body":"Can somebody please help me with this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-07T04:31:34.351+0000","updated":"2011-12-07T04:31:34.351+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164147","id":"13164147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"body":"There has been a broker plugin available which does what you want.\nJust add the plugin into plugins of broker like this:\n    \t<amq:plugins>\n    \t\t<amq:discardingDLQBrokerPlugin dropAll=\"true\"/>\n    \t</amq:plugins>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-12-07T04:52:40.816+0000","updated":"2011-12-07T04:52:40.816+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164150","id":"13164150","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"body":"@SuoNayi, thanks for the suggestion. \nJust out of curiosity, do you know why the configuration which I was using wasn't working?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-07T05:01:42.237+0000","updated":"2011-12-07T05:01:42.237+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164157","id":"13164157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"body":"With your configuration nonpersistent or expired messages will be discared while persistent messages will be saved.\nThe plugin will do what you want, it will discard all messages with dropAll being true.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-12-07T05:15:27.003+0000","updated":"2011-12-07T05:15:27.003+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164159","id":"13164159","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"body":"I tried taking a look at discardingDLQBrokerPlugin.java and found a couple of properties like dropTemporaryQueue and dropTemporaryTopic being set to 'true' by default. Since we use temp queues I would like to know what these properties actually mean and do. Unfortunately there wasn't much doc related to this. Would you know what they do?\n\nSince I will be making this fix in our production broker, I would really like to make sure this plugin would not break anything else which is using temp queues and topics. Sincerely appreciate your help.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-07T05:31:37.849+0000","updated":"2011-12-07T05:31:37.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164192","id":"13164192","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Property dropTemporaryQueue being set to 'true' means the message should be discarded if the destination of the message is a temporary queue.Similarly Property dropTemporaryTopic means if the destination of the message is a temporary topic the message should be discarded.\nMaybe you want to discard other messages such as persistents messages which reside in common queues or topics.\nSo for more handily,enabling dropAll will discard all DLQ messages.\nAFAIK,it's safe to apply this plugin in your production broker and you can take off the old deadLetterStrategy as well.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-12-07T07:02:00.418+0000","updated":"2011-12-07T07:02:00.418+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12533069/comment/13164211","id":"13164211","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"body":"Thank you. I'll use this plugin as suggested.\n\nRegards\nHari","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harimharan","name":"harimharan","key":"harimharan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hariharan","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-07T07:41:45.553+0000","updated":"2011-12-07T07:41:45.553+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3610/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ebun:"}}