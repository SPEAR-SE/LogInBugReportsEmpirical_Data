{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482329","self":"https://issues.apache.org/jira/rest/api/2/issue/12482329","key":"AMQ-1490","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315618","id":"12315618","description":"","name":"5.1.0","archived":false,"released":true,"releaseDate":"2008-05-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-11-13T22:10:43.243+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Mar 04 15:52:15 UTC 2008","customfield_12310420":"84682","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_941559832_*|*_6_*:*_2_*:*_3125280599_*|*_5_*:*_2_*:*_2908330_*|*_4_*:*_3_*:*_3967626228","customfield_12312321":null,"resolutiondate":"2008-02-13T10:24:39.161+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1490/watchers","watchCount":7,"isWatching":false},"created":"2007-11-12T09:48:24.172+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-03-04T15:52:15.665+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"For some time now there have been various bug reports about ActiveMQ \"blocking\", \"not receiving messages\", \"running into a deadlock\" etc. Since I encoutered such deadlocks now and then, too, I eventually wrote up a JUnit testing scenario for this stuff. I found out that deadlocks can be quite easily reproduced. The symptoms are that the producer thread is sending or committing while the consumer thread is receiving or committing - and none of them can advance. One of the threads is always stuck in a blocking queue.\n\nHere's a sample output of my testing class:\n An ActiveMQ deadlock has been discovered. The following threads seem to be involved:\n\n Thread \"producer\" is inactive since 16 seconds after 358719 status changes. The current status is COMMITTING\n sun.misc.Unsafe.park(Native Method)\n java.util.concurrent.locks.LockSupport.park(LockSupport.java:158)\n  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1889)\n java.util.concurrent.ArrayBlockingQueue.take(ArrayBlockingQueue.java:317)\n org.apache.activemq.transport.FutureResponse.getResult(FutureResponse.java:40)\n org.apache.activemq.transport.ResponseCorrelator.request(ResponseCorrelator.java:76)\n org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1172)\n org.apache.activemq.TransactionContext.commit(TransactionContext.java:259)\n org.apache.activemq.ActiveMQSession.commit(ActiveMQSession.java:494)\n de.rainer_klute.activemq.ProducerThread.run(ProducerThread.java:162)\n\n Thread \"consumer\" is inactive since 16 seconds after 1807 status changes. The current status is RECEIVING\n java.lang.Object.wait(Native Method)\n java.lang.Object.wait(Object.java:485)\n org.apache.activemq.MessageDispatchChannel.dequeue(MessageDispatchChannel.java:75)\n org.apache.activemq.ActiveMQMessageConsumer.dequeue(ActiveMQMessageConsumer.java:404)\n org.apache.activemq.ActiveMQMessageConsumer.receive(ActiveMQMessageConsumer.java:452)\n org.apache.activemq.ActiveMQMessageConsumer.receive(ActiveMQMessageConsumer.java:504)\n de.rainer_klute.activemq.ConsumerThread.run(ConsumerThread.java:183)\n\nThe following factors seem to increase the probability of a deadlock:\n* small values for memoryUsage\n* working transacted in the consumer (not always necessary but \"helps\")\n* many messages in the persistence store (to be achieved via a long delay before the consumer starts to read messages)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461012","id":"12461012","filename":"ActiveMQ_Testcases.jar","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-26T16:36:41.610+0000","size":49703,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12461012/ActiveMQ_Testcases.jar"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461018","id":"12461018","filename":"ActiveMQ_Testcases.jar","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-23T08:39:40.965+0000","size":38400,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12461018/ActiveMQ_Testcases.jar"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12460934","id":"12460934","filename":"AMQ-1490_memory-001.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-29T11:14:58.054+0000","size":54971,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12460934/AMQ-1490_memory-001.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12460974","id":"12460974","filename":"AMQ-1490_result-001.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-29T11:15:56.282+0000","size":87043,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12460974/AMQ-1490_result-001.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12460989","id":"12460989","filename":"AMQ-1490_result-002.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-25T14:58:12.643+0000","size":10978,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12460989/AMQ-1490_result-002.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"171947","customfield_12312823":null,"summary":"Deadlocks (with JUnit tests)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939173","id":"12939173","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"JUnit test cases for this issue. See file index.html or AMQ-1490.html for details.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-12T10:22:50.380+0000","updated":"2007-11-12T10:22:50.380+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939144","id":"12939144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"I just checked this issue against ActiveMQ 5.0.0 RC3 and found it still valid. And I got additional warnings like these:\n\n    [junit] INFO: ActiveMQ Message Broker (localhost, ID:xxxxxxxx-17170-1194934336239-0:0) is shutting down\n    [junit] 13.11.2007 07:13:03 org.apache.activemq.ActiveMQConnection onAsyncException\n    [junit] WARNUNG: Async exception with no exception listener: org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://localhost#1) disposed.\n    [junit] org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://localhost#1) disposed.\n    [junit]     at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:200)\n    [junit]     at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:118)\n    [junit]     at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:42)\n    [junit]     at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)\n    [junit]     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)\n    [junit]     at java.lang.Thread.run(Thread.java:619)\n    [junit] 13.11.2007 07:13:03 org.apache.activemq.AdvisoryConsumer dispose\n    [junit] INFO: Failed to send remove command: javax.jms.JMSException: Peer (vm://localhost#1) disposed.\n    [junit] javax.jms.JMSException: Peer (vm://localhost#1) disposed.\n    [junit]     at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:62)\n    [junit]     at org.apache.activemq.ActiveMQConnection.asyncSendPacket(ActiveMQConnection.java:1154)\n    [junit]     at org.apache.activemq.AdvisoryConsumer.dispose(AdvisoryConsumer.java:56)\n    [junit]     at org.apache.activemq.ActiveMQConnection.cleanup(ActiveMQConnection.java:1326)\n    [junit]     at org.apache.activemq.ActiveMQConnection.transportFailed(ActiveMQConnection.java:2027)\n    [junit]     at org.apache.activemq.ActiveMQConnection$4.run(ActiveMQConnection.java:1663)\n    [junit]     at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)\n    [junit]     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)\n    [junit]     at java.lang.Thread.run(Thread.java:619)\n    [junit] Caused by: org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://localhost#1) disposed.\n    [junit]     at org.apache.activemq.transport.vm.VMTransport.oneway(VMTransport.java:87)\n    [junit]     at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n    [junit]     at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:59)\n    [junit]     at org.apache.activemq.ActiveMQConnection.asyncSendPacket(ActiveMQConnection.java:1152)\n    [junit]     ... 7 more\n    [junit] 13.11.2007 07:13:03 org.apache.activemq.ActiveMQConnection transportFailed\n    [junit] WARNUNG: Cleanup failed\n    [junit] javax.jms.JMSException: Peer (vm://localhost#1) disposed.\n    [junit]     at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:62)\n    [junit]     at org.apache.activemq.ActiveMQConnection.asyncSendPacket(ActiveMQConnection.java:1154)\n    [junit]     at org.apache.activemq.TransactionContext.begin(TransactionContext.java:200)\n    [junit]     at org.apache.activemq.ActiveMQSession.doStartTransaction(ActiveMQSession.java:1653)\n    [junit]     at org.apache.activemq.ActiveMQMessageConsumer.acknowledge(ActiveMQMessageConsumer.java:823)\n    [junit]     at org.apache.activemq.ActiveMQMessageConsumer.dispose(ActiveMQMessageConsumer.java:651)\n    [junit]     at org.apache.activemq.ActiveMQSession.dispose(ActiveMQSession.java:575)\n    [junit]     at org.apache.activemq.ActiveMQConnection.cleanup(ActiveMQConnection.java:1332)\n    [junit]     at org.apache.activemq.ActiveMQConnection.transportFailed(ActiveMQConnection.java:2027)\n    [junit]     at org.apache.activemq.ActiveMQConnection$4.run(ActiveMQConnection.java:1663)\n    [junit]     at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)\n    [junit]     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)\n    [junit]     at java.lang.Thread.run(Thread.java:619)\n    [junit] Caused by: org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://localhost#1) disposed.\n    [junit]     at org.apache.activemq.transport.vm.VMTransport.oneway(VMTransport.java:87)\n    [junit]     at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:40)\n    [junit]     at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:59)\n    [junit]     at org.apache.activemq.ActiveMQConnection.asyncSendPacket(ActiveMQConnection.java:1152)\n    [junit]     ... 11 more\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-13T06:21:47.412+0000","updated":"2007-11-13T06:21:47.412+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939165","id":"12939165","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"body":"I reviewed you test case and noticed that your consumer uses the same connection as the producer.  It is possible to get into a deadlock situation when this occurs.  If your producer blocks due to it waiting space on the broker, it will lock up the connection.  At that point the consumer will not be able to consume anymore messages either.\n\nI believe your deadlocks will go away if you use separate connections for the consumer and producer threads.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chirino","name":"chirino","key":"chirino","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chirino&avatarId=12659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chirino&avatarId=12659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chirino&avatarId=12659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chirino&avatarId=12659"},"displayName":"Hiram Chirino","active":true,"timeZone":"America/New_York"},"created":"2007-11-13T22:10:43.243+0000","updated":"2007-11-13T22:10:43.243+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939230","id":"12939230","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Using the same connection for the producer as well as for the consumer is neither uncommon nor is it contrary to the JMS specification. I'd say since the JMS specification allows it, ActiveMQ should support it on principle.\n\nSome more rationale: With separate connections you would have to diffentiate between \"producing\" and \"consuming\" connections. This would be unnecessarily complex - not to mention the many connections' resource consumption. An application's JMS setup would be too static. It should be possible to build up complex communication scenarios all over the same connection, and it should even be possible to change the communicators' roles (producer or consumer) over time.\n\nI'd be grateful if you could address this issue.\n\nWhat can I do until then? In my project's scenario I have a few producers (at present only one) writing messages to a topic and about 200 consumers reading them based on message properties. Should I really use different connections for all of them or are two connections sufficient?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-14T05:12:06.992+0000","updated":"2007-11-14T05:12:06.992+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939232","id":"12939232","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fullung","name":"fullung","key":"fullung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Strasheim","active":true,"timeZone":"America/Los_Angeles"},"body":"This is starting to sound like an issue I reported some time back, namely AMQ-1148, which hasn't received much attention in recent months.\n\nThere is nothing in the JMS specification to indicate that one should use separate connections for producers and consumers and doing so can have various implications for the design of an application, so I would agree with Rainer Klute that this is something that should probably be looked at carefully.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fullung","name":"fullung","key":"fullung","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Strasheim","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-14T12:49:17.071+0000","updated":"2007-11-14T12:49:17.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939156","id":"12939156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Meanwhile I am pretty sure that the \"use two connections\" approach does not work. My application has two producers and a few dozens of consumers, and now - desperate as I am - each session has its own connection or, to put it the other way round, each connection has only a single session. Nevertheless I still end up with a lot of threads hanging around like shown in the original bug description (see above).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-19T19:08:24.584+0000","updated":"2007-11-19T19:08:24.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939204","id":"12939204","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"I did some further investigation and changed by JUnit test to use a configurable number of producers and consumers. The good news is that it demonstrates a bug with a very small amount of messages already. I one of the test scenarios I have 2 producers. Each one sends 2 messages to a topic. The single consumer should receive 4 messages. However, this fails depending on the combination of whether the producers or the consumers or both operate transacted or not. Increase the number of messages and other combinations fail. (I'll check in the JUnit test soon.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-21T10:08:35.153+0000","updated":"2007-11-21T10:08:35.153+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12938965","id":"12938965","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Modified JUnit tests as mentioned in the comment above. See index.html for details!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-21T10:30:28.504+0000","updated":"2007-11-21T10:30:28.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939186","id":"12939186","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Small fix in the JUnit test.\n\nIf running the test with 2 messages (i.e. 1 per producer) the test fails differently from when running with many messages (e.g. 20,000 per producer).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-21T13:44:27.939+0000","updated":"2007-11-22T05:20:33.854+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939008","id":"12939008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Just tried the stuff with a TCP transport instead of a VM transport: No substantial change except for the places where the deadlocks occur.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-21T14:05:10.659+0000","updated":"2007-11-21T14:05:10.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939217","id":"12939217","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"The consumer(s) need to be initialized before you send messages to them -\ne.g. when creating the ConsumerThreads in the ReliabilityTest - call consumer.init() - which actually creates the JMS consumer.\n\nActiveMQ only sends topic messages to consumers that exist - or have existed (if they are durable). \nAlso - please don't call inactivity a deadlock ;)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-23T07:21:03.984+0000","updated":"2007-11-23T07:21:03.984+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939152","id":"12939152","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Please look once more: I *do* initialize the consumer threads and create the consumers - see line 282 in ReliabilityTest.java.\n\nIf there were no consumers, they wouldn't receive any messages at all. However, the usually do receive some messages, but not all.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-23T07:56:10.831+0000","updated":"2007-11-23T07:56:34.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939246","id":"12939246","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"your calling init in the wrong place -  move it to line 252\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-23T08:24:10.800+0000","updated":"2007-11-23T08:24:10.800+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939221","id":"12939221","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Yup, you are right! I now moved initializing and starting the consumers before the producers. However, the behaviour is still buggy, i.e. the two producers hanging in a commit() while the consumer is in a receive(). The corrected JUnit test will follow in a minute.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-23T08:37:32.294+0000","updated":"2007-11-23T08:37:32.294+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939200","id":"12939200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Fixed JUnit tests","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-23T08:39:41.019+0000","updated":"2007-11-23T08:39:41.019+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939203","id":"12939203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Potential fix by SVN revision revision 599129\nRainer would you mind verifying please ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-28T20:21:01.259+0000","updated":"2007-11-28T20:21:01.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939231","id":"12939231","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"The good news is: Yes, it works! Great! Thanks, Rob!\n\nThe bad news is: Some test cases take a tremendous amount of heap space now. My former max memory setting of -Xmx256K was insufficient; with -Xmx1024K the test application runs. This gave me cause to investigate that behaviour more closely and I had jconsole watch the memory usage. The result you'll find in attachment AMQ-1490_memory-001.png. I did some drawing on that screenshot to demarcate the test cases. The wall clock times on the X axis you can correlate to the detailed test case protocol in AMQ-1490_result-001.txt.\n\nThe scenario is that two producers send each 100,000 messages to a topic and one consumer reads them all. The differences between them are whether producing and consuming sessions are transactional or not.\n\nInteresting results:\n* The enormous memory consumption only occurs if the producers operate transactionally and the consumer does not.\n* Test case 0001 (transactional producers) starts to consume much memory. However, after a mark-and-sweep garbage collection things stay moderate.\n* The execution times vary very much: There's a factor of 7.7 between the fastest and the slowest run.\n* The fastests test cases are those without transactional producers.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-29T11:13:53.659+0000","updated":"2007-11-29T11:13:53.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939210","id":"12939210","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Memory consumption screenshot (see last comment)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-29T11:14:58.191+0000","updated":"2007-11-29T11:14:58.191+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939227","id":"12939227","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Detailed test results (see last comment)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-29T11:15:56.481+0000","updated":"2007-11-29T11:15:56.481+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939228","id":"12939228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"There's additional fixes here by SVN revision 600891\nIf there isn't enough memory for the broker to finish a transaction the broker will block - so if you see producers pause this is the likely reason","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-04T11:31:57.576+0000","updated":"2007-12-04T11:31:57.576+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939251","id":"12939251","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"I'd be happy if that would be so. However, instead of pausing the test case still fails with an OutOfMemoryError when I specify -Xmx256M or -Xmx512M.\n\nWith 768 MB it works. The funny thing is that it runs faster with 768 MB than with 1024 MB. Maybe its swapping that disturbs in the latter case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-05T07:13:25.546+0000","updated":"2007-12-05T07:13:25.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939247","id":"12939247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Hi Rainer,\nThis has taken a while to track down - but the ack list in amq could grow excessively large. For my tests - the memory profile is good with 100,000 msgs per producer - if you get a chance - please confirm\n\nusing  svn revision 602440\n\nthanks,\n\nRob","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-08T10:06:29.628+0000","updated":"2007-12-08T10:06:29.628+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939286","id":"12939286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Hi Rob,\nnow there's another problem: When the consumer is not yet receiving messages, the producers now block after sending a bunch of messages. They should spool the messages to disk instead. (My real-world application generates dozens or hundreds of messages per second while there might be now consumer available for days.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-08T18:25:16.852+0000","updated":"2007-12-08T18:25:16.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939250","id":"12939250","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Hi Rainer,\nthe problem is the size of the transaction  - currently you need to either have smaller transactions - or enough memory to accommodate them,\nAs this problem has moved on since the original issue - can we close this and add a new feature that would allow spooling to disk for in-memory transactions?\n\nthanks,\n\nRob","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-16T22:55:03.900+0000","updated":"2007-12-16T22:55:03.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939280","id":"12939280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Rob,\nI am presently running my test cases\n* without the one with the large transaction size but\n* with more messages than before (500,000 per producer, with 2 producers and 1 consumer).\n\nThe flow control issues seems indeed to be solved, so yes, we can close this issue.\n\nHowever, with the increase of  the number of messages, I get all sorts of errors from the AMQ store, i.e.\n* notes about messages that could not have been entered into the store because of an IndexOutOfBoundException, and\n* notes about messages that could not have been recoved from the store.\nBefore creating another issue, I'll update to the very latest ActiveMQ snapshot and retry.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-17T15:17:21.066+0000","updated":"2007-12-17T15:17:21.066+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939290","id":"12939290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Oh no! With the latest snapshot (subversion revision 605158) I get blocks/deadlocks again! Producers and consumers each hanging in a commit()!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-17T16:21:17.092+0000","updated":"2007-12-18T09:52:25.580+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939283","id":"12939283","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Could you attach a stack dump of where they hang in a commit ? - I can't reproduce","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-20T00:13:13.084+0000","updated":"2007-12-20T00:13:13.084+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939241","id":"12939241","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Hm, when I tried once again to reproduce it, I couldn't. Perhaps my grace period of 15 seconds for deadlock/blocking was too short and the algorithm detected a block that wasn't one. Now it requires 2 minutes without any send/receive activity before claiming that something blocks.\n\nI'd say let's close this issue. I'll continue to stress test ActiveMQ anyway and will submit a new issue soon!\n\nRob, thanks a lot for fixing this issue!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-20T10:39:59.732+0000","updated":"2007-12-20T10:39:59.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939285","id":"12939285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Phew! Thanks Rainer for you're help!!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-20T20:45:35.744+0000","updated":"2007-12-20T20:45:35.744+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12938497","id":"12938497","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Sorry, but I have to reopen this issue again!\n\nWhile the test scenario \"multiple producers, single consumer\" seems to work fine in most cases, the scenario \"one producer, multiple consumers\" fails soon and reproducibly with just 2 consumers and as few as 6,000 messages. (In my production environment I'll have about 600 consumers and about 250 messages per second.)\n\nI shall re-submit a further development of my JUnit test case shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-25T14:48:00.401+0000","updated":"2008-01-25T14:48:00.401+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12938636","id":"12938636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Sample output of the \"1 producer, 2 consumers\" scenario","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-25T14:58:12.860+0000","updated":"2008-01-25T14:58:12.860+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12938926","id":"12938926","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"The latest version of my test cases.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-26T16:36:41.786+0000","updated":"2008-01-26T16:36:41.786+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939345","id":"12939345","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"body":"Seems to work with revision 627336 if transaction size is not too big. However, if neither producer nor consumers are transacted, performance is best.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rainer+klute","name":"rainer klute","key":"rainer klute","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rainer Klute","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-13T10:24:39.054+0000","updated":"2008-02-13T10:24:39.054+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482329/comment/12939366","id":"12939366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lhotari","name":"lhotari","key":"lhotari","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lari Hotari","active":true,"timeZone":"Etc/UTC"},"body":"I'm using Jencks Inbound/Outbound JMS configuration for consuming & producing messages and quite often there's a 2 minute delay in message delivery after the producer has replied. This happens only in ActiveMQ 5.0. I'll try nightly builds to see if they fix the problem. Maybe JCA/RA has the same issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lhotari","name":"lhotari","key":"lhotari","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lari Hotari","active":true,"timeZone":"Etc/UTC"},"created":"2008-03-04T15:52:15.602+0000","updated":"2008-03-04T15:52:15.602+0000"}],"maxResults":34,"total":34,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1490/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tsmn:"}}