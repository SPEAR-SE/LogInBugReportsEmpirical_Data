{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12537594","self":"https://issues.apache.org/jira/rest/api/2/issue/12537594","key":"AMQ-3656","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2012-01-16T23:20:48.991+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jun 12 21:15:59 UTC 2012","customfield_12310420":"223100","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_13650995656_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-06-12T21:15:59.443+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3656/watchers","watchCount":1,"isWatching":false},"created":"2012-01-06T21:19:23.902+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315626","id":"12315626","description":"","name":"5.5.0","archived":false,"released":true,"releaseDate":"2011-04-01"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-06-12T21:15:59.553+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313899","id":"12313899","name":"Performance Test","description":"Performance Testing Suite"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We have an issue with AMQ performance. In our test program, we run two amq nodes in a network cluster. Both AMQ client and server/worker consist of producers and consumers. When client makes a connection to an AMQ node, it will send messages to three queues and meanwhile listen to 2 topics and one temporary queue. In AMQ worker/server side, it will listen to three queues and send messages back to corresponding two topics and one temp queue.  During our test, We first had 10 servers/workers running at the same node as one AMQ broker was running, then started client program remotely by making 50 connections first, then repeated the 50 connections again and again. We found when the connection number reached above 650, AMQ slowed down significantly, as when we tried to send a text message through Jconsole (which run remotely also);  we couldn't get a response from Jconsole with a returned messageID.  Any message sent during that time was not enqueued in time.  Looks like there was a blocking to the producer side, but we had producer flow control turned off.  The heap memory usage looked fine to us during that time (well below 3G we assigned for JVM). But we did notice that we even couldn't do a thread dump during that time, as it kept failing to attach the process. It took some time (from 10 seconds to 15 minutes or more) for the AMQ to come back and response to the messages sent, and by then we could do thread dump without a problem.  \nIn amq configure side, I have followed suggestion by Dave Stanley http://www.pepperdust.org/?p=150. Not sure why we still have such a \"hung\" problem? I'll attach the test case program with our amq configure file latter. \n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12509718","id":"12509718","filename":"ActiveMQTest.tar.gz","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuang1etrade","name":"yhuang1etrade","key":"yhuang1etrade","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yelu huang","active":true,"timeZone":"Etc/UTC"},"created":"2012-01-06T21:45:46.243+0000","size":24392,"mimeType":"application/x-gzip","content":"https://issues.apache.org/jira/secure/attachment/12509718/ActiveMQTest.tar.gz"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"81676","customfield_12312823":null,"summary":"Activemq hung or slows down significantly when high number of connections occurs","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuang1etrade","name":"yhuang1etrade","key":"yhuang1etrade","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yelu huang","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuang1etrade","name":"yhuang1etrade","key":"yhuang1etrade","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yelu huang","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux AS5 (CentOS release 5.5),\nJava: SUNJAVA2 1.6.0r14a \n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537594/comment/13181626","id":"13181626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuang1etrade","name":"yhuang1etrade","key":"yhuang1etrade","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yelu huang","active":true,"timeZone":"Etc/UTC"},"body":"activemq.xml files are include in the attached pkg. check activemq script (also attached) for JVM options. run runpltsvr.ksh in the same node AMQ broker is running, then run runpltclt.ksh twice remotely. Run Jconsole remotely and try to send a text message to any queue, see the response from Jconsole when the high number of connection is reached. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuang1etrade","name":"yhuang1etrade","key":"yhuang1etrade","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yelu huang","active":true,"timeZone":"Etc/UTC"},"created":"2012-01-06T21:45:46.396+0000","updated":"2012-01-06T21:45:46.396+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537594/comment/13187299","id":"13187299","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"You should try testing against a 5.6-SNAPSHOT for comparison as there have been a number of fixes since 5.5.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2012-01-16T23:20:48.991+0000","updated":"2012-01-16T23:20:48.991+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537594/comment/13293928","id":"13293928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Not logs for configurations provided, not tests cases or other materials to properly analyze this to determine if there is a real problem or if the broker is just utilizing all available resources per configuration. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2012-06-12T21:15:59.508+0000","updated":"2012-06-12T21:15:59.508+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3656/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ebtb:"}}