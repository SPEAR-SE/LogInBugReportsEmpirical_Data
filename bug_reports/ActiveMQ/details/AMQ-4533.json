{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12647406","self":"https://issues.apache.org/jira/rest/api/2/issue/12647406","key":"AMQ-4533","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324950","id":"12324950","name":"5.10.0","archived":false,"released":true,"releaseDate":"2014-06-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-05-13T23:56:11.896+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 21 12:42:49 UTC 2014","customfield_12310420":"327762","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_4567169253_*|*_5_*:*_2_*:*_5771748448_*|*_4_*:*_1_*:*_16578460632","customfield_12312321":null,"resolutiondate":"2014-03-21T12:42:48.974+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4533/watchers","watchCount":7,"isWatching":false},"created":"2013-05-13T23:39:50.694+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"20.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"}],"issuelinks":[{"id":"12371613","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12371613","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12656414","key":"AMQ-4621","self":"https://issues.apache.org/jira/rest/api/2/issue/12656414","fields":{"summary":"Provide a polling SlowConsumerPolicy that uses LastAck time on a sub","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-03-21T12:42:49.024+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313896","id":"12313896","name":"JMS client"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We're  getting message stuck in queues with the \nredelivery flag set to true.\n\nWe used the following test model: put every 1 second 50 messages sequentially, and after that, the rest of 1000 msgs quickly to INPUT_QUEUE and \nwhile starting 25 listeners cosuming from INPUT_QUEUE, which takes about 30 seconds to move the message to RECEIPT_QUEUE, 10 other listeners on RECEIPT_QUEUE consume and counts them.\n\nWe tried making one of the consumer slow by setting the \nprocessing time to 100000 seconds (sleep) and putting a heavy load in \n500 threads every 1 ms to some other queues the same time.\n\nOur test case is attached, you might need to install some dependencies \nto the local maven repository manually:\n\n     mvn install:install-file -DgroupId=org.apache.activemq \n-DartifactId=activemq-core -Dversion=5.7.0-fuse-71-047 -Dpackaging=jar \n-Dfile=activemq-core-5.7.0.fuse-71-047.jar\n     mvn install:install-file -DgroupId=org.apache.kahadb \n-DartifactId=kahadb -Dversion=5.7.0-fuse-71-047 -Dpackaging=jar \n-Dfile=kahadb-5.7.0.fuse-71-047.jar\n     mvn install:install-file \n-DgroupId=org.apache.geronimo.management.specs \n-DartifactId=geronimo-j2ee-management_1.1_spec -Dversion=1.0.1 \n-Dpackaging=jar -Dfile=geronimo-j2ee-management_1.1_spec-1.0.1.jar\n     mvn install:install-file -DgroupId=org.apache.activemq.pool \n-DartifactId=activemq-pool -Dversion=5.7.0-fuse-71-047 -Dpackaging=jar \n-Dfile=activemq-pool-5.7.0.fuse-71-047.jar\n\nTo run the test, simply use the Maven test target:\n\n    mvn clean test\n\nIf the problem occurs the you'll get a message like this in the test \nresults, (target/surefire-reports):\n\n    java.lang.AssertionError: Still messages in InputQueue expected:<0> \nbut was:<365>\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602115","id":"12602115","filename":"AMQ4533_logs.ZIP","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:28:10.067+0000","size":1136326,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12602115/AMQ4533_logs.ZIP"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12589062","id":"12589062","filename":"AMQ4533Test.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-21T13:49:12.897+0000","size":21931,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12589062/AMQ4533Test.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12603477","id":"12603477","filename":"AMQ4533-test.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-16T22:52:13.019+0000","size":44181,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12603477/AMQ4533-test.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12603065","id":"12603065","filename":"AMQ4533-Test.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-13T18:06:25.257+0000","size":27892,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12603065/AMQ4533-Test.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602893","id":"12602893","filename":"AMQ4533-Test.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-12T22:33:36.267+0000","size":40317,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12602893/AMQ4533-Test.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602697","id":"12602697","filename":"AMQ4533-Test.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-11T22:59:04.361+0000","size":40324,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12602697/AMQ4533-Test.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602428","id":"12602428","filename":"AMQ4533-Test.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-10T21:42:49.971+0000","size":39146,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12602428/AMQ4533-Test.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602411","id":"12602411","filename":"AMQ4533-Test.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-10T20:45:50.932+0000","size":37353,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12602411/AMQ4533-Test.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12587104","id":"12587104","filename":"AMQ4533TestPatch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-06-10T17:35:51.458+0000","size":28090,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12587104/AMQ4533TestPatch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12585659","id":"12585659","filename":"AMQ4533TestPatch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-31T20:04:26.204+0000","size":35005,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12585659/AMQ4533TestPatch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12585272","id":"12585272","filename":"AMQ4533TestPatch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-29T18:31:06.331+0000","size":35882,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12585272/AMQ4533TestPatch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602117","id":"12602117","filename":"AMQFreeze_logs.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:34:35.156+0000","size":26843,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12602117/AMQFreeze_logs.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602590","id":"12602590","filename":"AMQFreezeFailingTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-11T14:19:21.459+0000","size":14437,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12602590/AMQFreezeFailingTest.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12603352","id":"12603352","filename":"AMQFreezeTest.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-16T15:26:12.135+0000","size":40551,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12603352/AMQFreezeTest.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12603834","id":"12603834","filename":"AMQFreezeTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-18T14:36:25.294+0000","size":10815,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12603834/AMQFreezeTest.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12602116","id":"12602116","filename":"AMQFreezeTest.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:33:25.124+0000","size":14906,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12602116/AMQFreezeTest.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12603856","id":"12603856","filename":"AMQFreezeTest-5.8.0.fuse-72-SNAPSHOT-log.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-18T16:22:12.494+0000","size":114112,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12603856/AMQFreezeTest-5.8.0.fuse-72-SNAPSHOT-log.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12603857","id":"12603857","filename":"AMQFreezeTest-5.9.0.redhat-610084-log.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-18T16:22:50.182+0000","size":1646879,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12603857/AMQFreezeTest-5.9.0.redhat-610084-log.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12584422","id":"12584422","filename":"kahaPendingMessages.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"created":"2013-05-23T01:22:55.348+0000","size":24398,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12584422/kahaPendingMessages.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12604553","id":"12604553","filename":"LOGS_FAILED_5.9.0.redhat-610-SNAPSHOT.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-23T10:34:09.201+0000","size":10481473,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12604553/LOGS_FAILED_5.9.0.redhat-610-SNAPSHOT.zip"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"328106","customfield_12312823":null,"summary":"Messages stuck in queue with redelivered=true","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Fuse Message Broker 5.7.0","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13656556","id":"13656556","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"body":"You may have forgotten to attach the test case?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceposta","name":"ceposta","key":"ceposta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceposta&avatarId=15051","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceposta&avatarId=15051","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceposta&avatarId=15051","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceposta&avatarId=15051"},"displayName":"Christian Posta","active":true,"timeZone":"America/Phoenix"},"created":"2013-05-13T23:56:11.896+0000","updated":"2013-05-13T23:56:11.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13656587","id":"13656587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"body":"Thanks Christian, I've attached it now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"created":"2013-05-14T00:30:36.416+0000","updated":"2013-05-14T00:30:36.416+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13657335","id":"13657335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Note: Test is using the depricated and removed amqPersistenceAdapter so it'll need an update if run against newer broker releases.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-14T18:30:06.604+0000","updated":"2013-05-14T18:30:06.604+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13664767","id":"13664767","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"body":"Testcase updated to use KahaDB","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"created":"2013-05-23T01:22:55.364+0000","updated":"2013-05-23T01:22:55.364+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13669546","id":"13669546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Initial cut of a thinned down version of this test as a JUnit test.  The test is pretty complex so we need to try and reduce it down as much as we can to aid debugging the issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-29T18:31:06.333+0000","updated":"2013-05-29T18:31:06.333+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13671790","id":"13671790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"some more cleanups to reduce the code size of this test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-31T20:04:26.207+0000","updated":"2013-05-31T20:04:26.207+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13671791","id":"13671791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Its not clear to me that this really shows an issue.  At the time the zero sized Queue assertions are issued there are still threads producing and consuming from these Queues so I don't see how the test can work.  Perhaps you can clean it up a bit and reduce the amount of things going on here, tests takes 30 minutes or more on my machine.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-05-31T20:05:57.910+0000","updated":"2013-05-31T20:05:57.910+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13675455","id":"13675455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"body":"This reproducer is basically a reproduction of a production scenario, and it needs to be like this, because its the only way we've found to replication the issue. If we break down what happens in the test case, hopefully you'll understand why we need so many things going on.\n\nStep 2 in the test case is critial for reproducing the problem. It simulates slow cusomer, with threads hung, or a slow database operation. Without this slow consumer, the test completes very fast, and we don't see the problem. \n\nThe test simulates the production environment where the broker is under heavy load. In the test case there is heavy load on SOME_TEST_QUEUE, all of which uses separate connections pools, message listeners, and latches. Whereas the critical messages for the test case are on INPUT_QUEUE, and RECEIPT_QUEUE, which use OtherMessageListener, and onOtherMessageLatch.\n\nThis test case is the only evidence of a problem which has been plaguing our production environment for years.\n\nHere is how the TC works:\n\n1) start AMQ brokers\n\n2) start spring consumer for consumming from INPUT_QUEUE and putting receipts to RECEIPT_QUEUE\nThis consumer is processing first message for ever.\n\t   if (isStuckOld!=isStuck) {\n\t        log4jLogger.info(\"sleep for eternity\");\n\t        Thread.sleep(100000000);\n                 }\t\nand next 49 messages longer /30 seconds/ than rest of 1000 msgs.\n\n\tif (nrProcessed<50) {\n\t\t\tThread.sleep(30000);\n\t}\n\nThe reason for it is to simulate some slow & stuck consumers which we can notice on production.\n\n3) run heavy traffic to SOME.TEST.QUEUE \na) put 1000000 messages using 50 threads to broker 1\n\nsendInThreads(QUEUE_NAME, 500000, 50, DeliveryMode.NON_PERSISTENT,getUrl1(),1);\nsendInThreads(QUEUE_NAME, 500000, 50, DeliveryMode.PERSISTENT,getUrl1(),1);\n\nb) get 900000 messages in 200 listening threads from broker 2 using OtherMessageListener\n\nlistenInThreads(QUEUE_NAME, 900000, 200,getUrl2(), mListener, otherConnections);\n\nHowever we do not wait on latches as it is not important. This is traffic to simulate heavy load only - not necessary to count them.\n\n4) send traffic to INPUT_QUEUE in 10 threads on broker 1 which triggers our spring consumer from step 2 to start consuming and to send output messages to RECEIPT_QUEUE /one receipt message sent to RECEIPT_QUEUE for one message consumed from INPUT_QUEUE/.\n\n        \tCountDownLatch latch1=sendInThreads(queueName, msgCount, threadCount, persistance,getUrl1(),500);\n\nThe latch1 is checked later in the step 6 to ensure we had all 1000 messages sent there.\n\n5) listen on RECEIPT_QUEUE in 10 threads on broker 2 using MainMessageListener with onMainMessageLatch set to 999 /one message should be stuck on consummer forever by TC design/\n\n            CountDownLatch latch=listenInThreads(queueName, msgCount, threadCount,getUrl2(),msgListener,connections);\n\n6) wait for latches - because of heavy load we had to set the timeout long enough /here 1000 seconds/ to give the system the chance to process all messages from INPUT_QUEUE /the processing might be very slow because of heavy load/\n\t\t\tonMainMessageLatch.await(1000, TimeUnit.SECONDS);\nand also we check if all messages were put into INPUT_QUEUE for processing\n\t\t\tlatch1.await(msgCount/10, TimeUnit.SECONDS); // .MINUTES\n\n7) check assertions for INPUT_QUEUE and RECEIPT_QUEUE - they should be empty\n\n\t\t    queueName = INPUT_QUEUE;\n            \n            queueSize1=queueSize(brokerService1, queueName);\n            queueSize2=queueSize(brokerService2, queueName);            \n            \n            Assert.assertEquals(\"Still messages in \"+queueName,0, queueSize1+queueSize2);\n\t\t\t\n\t\t    queueName = RECEIPT_QUEUE;\n            \n            queueSize1=queueSize(brokerService1, queueName);\n            queueSize2=queueSize(brokerService2, queueName);            \n            \n            Assert.assertEquals(\"Still messages in \"+queueName,0, queueSize1+queueSize2);\t\t\t\n\n\n8) close AMQ brokers\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"created":"2013-06-05T00:07:18.928+0000","updated":"2013-06-05T00:17:53.958+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13679662","id":"13679662","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"more cleanups inside the test, less spring dependence. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-06-10T17:35:51.460+0000","updated":"2013-06-10T17:35:51.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13681347","id":"13681347","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"from the current test case (as updated by tim) the queue depth matches the inflight count due to messages prefetched by the consumer that waits for ever. \nThis is expected. Until the waitingForever consumer closes, prefetched messages will not be consumable. Using a prefetch of 0, so making the consumers pull messages on demand will resolve this.\n\nIn the production env, does the destination with unexpected queue depth have an inflight value that matches when viewed via jmx?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-12T15:54:44.774+0000","updated":"2013-06-12T15:54:44.774+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13685658","id":"13685658","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"It might not be acceptable by customers when the app performance decreases. However if that is the case I wonder if there is any other possibility to timeout some poisoned consumer and redirect all the prefetched messages to the rest of the consumers or, at least, to deliver next messages to the fast and operational consumers to avoid the msgs stuck into invalid one. Also could you create a modified version of this test case to prove that the prefetchSize=0 will solve the issue at the cost of performance degradation in processing of messages?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-17T15:46:36.641+0000","updated":"2013-06-17T15:46:36.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13686426","id":"13686426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"body":"In the sendAndListenToWithFailower method, you call listenInThreads with 'ReceiptQueue' as the queueName. If you only wanted to set the prefetch on ReceiptQueue, you would need to refactor the sendAndListenToWithFailower method to be able to specifying the prefetch value to pass to the registerConsumerListeners methods. \n\nIn that method, you could pass the prefetch. So instead of :\n\n            MessageConsumer messageConsumer = session.createConsumer(                           \n                    session.createQueue(queueName));\n\nYou could use something like:\n\n            queue = new ActiveMQQueue(queueName + \"?consumer.prefetchSize=0\");\n            MessageConsumer messageConsumer = session.createConsumer(queue)\n\nSee this page for a reference:\n\n   http://activemq.apache.org/what-is-the-prefetch-limit-for.html\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jshepher","name":"jshepher","key":"jshepher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Shepherd","active":true,"timeZone":"Australia/Brisbane"},"created":"2013-06-18T06:05:36.897+0000","updated":"2013-06-18T06:05:36.897+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13686504","id":"13686504","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"Yes, I did but it does not work. It is illegal to set prefetch to 0 and set message listener. Could someone create working TC to prove the theory? However we will still need some mechanism to timeout poisoned consumer to move prefetch messages to others. I would like to ensure that the test case is working without setting prefetch value to 0 and even with 1000 messages blocked at one consumer for some limited or unlimited time we have the next thousands of messages flowing to other consumers. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-18T08:47:14.033+0000","updated":"2013-06-18T08:47:14.033+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13686539","id":"13686539","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Prefetch 1 is the best you can do with a listener. \nHave a look athttp://activemq.2283324.n4.nabble.com/Finding-a-slow-consumer-td4654153.html to see some detail on the abort slow consumer policy. That will ensure that stuck prefetched messages get re dispatched. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-18T09:54:47.940+0000","updated":"2013-06-18T09:54:47.940+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13686543","id":"13686543","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Some additional doc at https://access.redhat.com/site/documentation/en-US/JBoss_A-MQ/6.0/html/Tuning_Guide/files/TuningSlowConsumers.html","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-18T10:01:25.202+0000","updated":"2013-06-18T10:01:25.202+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13687900","id":"13687900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"Here is what I tried to put into spring2.xml & spring3.xml but we still have e.g. 400 messages stuck. I checked a few possible configurations for <abortSlowConsumerStrategy> and the test case is still failing.\n\n<destinationPolicy>\n  <policyMap>\n    <policyEntries>\n       <policyEntry queue=\">\" producerFlowControl=\"true\" memoryLimit=\"10mb\">\n          <slowConsumerStrategy>\n\t     <abortSlowConsumerStrategy abortConnection=\"true\" maxSlowDuration=\"30000\" />\n\t  </slowConsumerStrategy>\n\t</policyEntry>\n    </policyEntries>\n  </policyMap>\n</destinationPolicy>\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-19T11:57:44.265+0000","updated":"2013-06-19T11:57:44.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13690284","id":"13690284","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"adding the abort slow consumer policy to the input queue and setting prefetch to 10.\n\nThe prefetch is relevant b/c there are multiple consumers so messages get loadbalanced across them.\nTo be deemed slow, a consumer must have a dispatch size > than the prefetch for more than 30s and with prefetch 1000 (Default) this was not happening b/c all other consumers were very fast.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-21T13:49:12.900+0000","updated":"2013-06-21T13:49:12.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13690286","id":"13690286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"note also that in the test, autack is used, so the message that \"sleeps for eternity\" is acked before the sleep but there is no receipt.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-21T13:50:53.877+0000","updated":"2013-06-21T13:50:53.877+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13690397","id":"13690397","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"Thank you Gary for your input but apart from the fact this might be unacceptable to decrease the performance by reducing prefetchSize from 1000 to 10 I am not sure if it is going to work. It is still failing on my local machine and anyway it might happen that we need wait a long time to have full prefetch queue /1000 messages assigned to stuck consumer/ to be released. We could tune the prefetch for every queue but anyway we might really need some good working timeout for aborting such consumers /to release all prefetched messages to it/. For now the timeout is related to slow consumers only and depends on difficult mechanism of slowness detecting which does not work if there are not enough messages coming to a queue for some time. So most likely it is still necessary to have a new checking mechanism whether a consumer is still consuming messages or not. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-21T15:40:25.231+0000","updated":"2013-06-21T15:40:25.231+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13690424","id":"13690424","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"However, if there are very few messages and lots of consumers, using a prefetch > 0 will not have much impact. Prefetch is really only beneficial when consumers are very fast and when there are lots of messages in the queue or many producers. When consumers take a long or variable amount of time, it is best to leave the messages in the queue (prefecth=1) for other consumers to access.\n\nok, we may need to make the slowness determination some sort of strategy.\nHave a thought on how best to determine the 'slowness\" of a consumer, maye time since last ack. \nIt needs to a fast calculation. The decision to dispatch based on prefetch was already firing an advisory for a slow consumer so that was reused for the current abort policy. \n\nI would be interested to know if you can get the test to fail with a prefetch=1, also note that just the consumer is aborted, not the connection, abortConnection=false (Default)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-21T16:06:51.623+0000","updated":"2013-06-21T16:06:51.623+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13692885","id":"13692885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"The test case has passed for AMQ v.5.8.0 after setting the prefetchSize to 10 and abortSlowConsumerStrategy as follows:  \n          <policyEntry queue=\">\" producerFlowControl=\"true\" memoryLimit=\"10mb\" queuePrefetch=\"10\" >\n\t\t<slowConsumerStrategy>\n\t\t\t<abortSlowConsumerStrategy/>\n\t\t</slowConsumerStrategy>\n\t   </policyEntry>\t\t  \nI agree that the \"time since last ack\" would be good enough.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-25T09:27:47.699+0000","updated":"2013-06-25T09:27:47.699+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13700655","id":"13700655","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Would be good to close this out as resolved and create an enhancement issue documenting the needed improvements to cover this use case so it can get added into the road map.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-07-05T13:23:46.820+0000","updated":"2013-07-05T13:23:46.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13701102","id":"13701102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Raised https://issues.apache.org/jira/browse/AMQ-4621 to track the enhancement to the abort policy to be more deterministic.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-07-05T20:19:19.923+0000","updated":"2013-07-05T20:19:19.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13761742","id":"13761742","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"It seems that the issue has not been resolved yet by introducing the timeout in AMQ-4621. See the logs from failed TC. We have another test case AMQFreeze which fails even the timeout is set using SlowAckConsumerStrategy. I attached the new TC. We should reopen AMQ-4533.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:25:14.848+0000","updated":"2013-09-09T10:25:14.848+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13761743","id":"13761743","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"DEBUG logs for failed TC AMQ4533 ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:28:10.090+0000","updated":"2013-09-09T10:28:10.090+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13761747","id":"13761747","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"New AMQ \"freeze\" test case","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:33:25.126+0000","updated":"2013-09-09T10:33:25.126+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13761749","id":"13761749","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"logs from failed AMQFreezeTest","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-09T10:34:35.158+0000","updated":"2013-09-09T10:34:35.158+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13763121","id":"13763121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"After some additional work on 4621 yesterday the problem seems to be back to not dispatching.  Broker 2 now has some messages left in the Queue that aren't being dispatched.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-10T15:35:08.391+0000","updated":"2013-09-10T15:35:08.391+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13763488","id":"13763488","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Freeze test cleaned up a bit and in the form of a patch for easier application.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-10T20:45:50.934+0000","updated":"2013-09-10T20:45:50.934+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13763556","id":"13763556","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Updated to collect some more data in the logs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-10T21:42:49.973+0000","updated":"2013-09-10T21:42:49.973+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13764271","id":"13764271","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"During my testing today the 5.9.0.redhat-610067 resolved the AMQ4533(kahaPendingMessages) test case using \n<abortSlowAckConsumerStrategy maxSlowCount=\"1\"/> and when put enough time to consume all messages by adding Thread.sleep(30);  before checking the queue sizes                                  \nbut after adding abortConnection=\"true\" e.g. <abortSlowAckConsumerStrategy maxSlowCount=\"1\" abortConnection=\"true\"/> the TC is failing again.\n\nSo abortConnection=\"true\" is not working and AMQ cannot force the consumer connections to close but only can ask them gently to be closed. \nFor kahaPendingMessages TC it is enough because the consumer thread is in a good state /only too busy to process other messages/ \nbut for another test case (AMQFreezeTest) it is not enough because being interrupted the consumers connections are in wrong state and do not react on the close request from AMQ broker /I guess/.\nFor the second test case the abortConnection=\"true\" is necessary and for my opinion it is why the second test case is still failing.\nThe logs proves the theory as you can see at the end of it, during the broker shutdown procedure the connections are released and some consumption of the messages proceed but this is too late as AMQ had to abort those connections earlier during the slow consumer strategy procedure. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-11T13:00:14.871+0000","updated":"2013-09-11T13:00:14.871+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13764326","id":"13764326","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Can you clarify which test case you are using and what its current configuration is.  You've referenced a couple things so I'm a bit confused now on which one you are looking at.  Perhaps you can attached your current test case with the configuration that's not working so I know I'm looking at the right thing.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-11T14:03:27.186+0000","updated":"2013-09-11T14:03:27.186+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13764341","id":"13764341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"The test case still failing","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-11T14:19:21.461+0000","updated":"2013-09-11T14:19:21.461+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13764918","id":"13764918","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Updated the freeze test with additional testing logic and debug data.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-11T22:59:04.363+0000","updated":"2013-09-11T22:59:04.363+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13765962","id":"13765962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"updated","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-12T22:33:36.269+0000","updated":"2013-09-12T22:33:36.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13766739","id":"13766739","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"updated test case. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-13T18:06:25.260+0000","updated":"2013-09-13T18:06:25.260+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13768401","id":"13768401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Hi,\n\nI started investigating an AMQFreeze test in more details. One thing that seems off to me is that all consumers on the InputQueue are using the same connection. My impression is that you're trying to simulate multiple applications (using each they're own connection) is misbehaving and being reconnected. As we have it here, all the misbehaving consumers are killing the same connection multiple times very frequently. Can you please confirm what's the intention of the test and maybe modify test accordingly?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-16T15:18:13.687+0000","updated":"2013-09-16T15:18:13.687+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13768407","id":"13768407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Attached is a bit modified broker config for the test. We recommend using:\n\n- conditionalNetworkBridgeFilterFactory policy and larger ttl, as consumers can come and go to different brokers and we need to be able to pass messages back and forth\n\n- ignoreIdleConsumers=\"true\" as we don't want to kill connections of idle consumers","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-16T15:26:12.138+0000","updated":"2013-09-16T15:26:12.138+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13768449","id":"13768449","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"The configuration for ActiveMQ broker & spring consumers reflect exectly our production configuration. \nIf we should change something here just let me know.\nThis models our 25 consumers which simulatanously process the messages on the InputQueue \nand send the receipts to the ReceiptQueue.\n\nI agree it is very weird test case as we tried to simulate unsafe \"kill\" command/or \nother unexpected scenario and possibly a bug in the application which might result in ActiveMQ or queue freeze. \nI am sure that the good designed software and normal processing is working perfectly until something unusual happened \nor a bug in code. It is a very rare case when we have to remove all the messages/and restart all applications \nto let AMQ keep working but if it happens it is very serious outage.\n\nIn some our testing after upgrading to AMQ 5.8 we have experienced worse scenario yet \nwhen even restarting of AMQ and consumers did not help to keep processing. \nWe will keep trying to recreate the scenario as the upgrading does not eliminate the \"freezes\" \nand it is very serious issue. \n\nWhat we do here is we put messages to INPUT_QUEUE and the 25 consumers, this time configured to use spring, \nconsume them putting a receipt to RECEIPT_QUEUE. \nNext we have consumers which consume the messages from RECEIPT_QUEUE. \nSo after TC ends both INPUT_QUEUE & RECEIPT_QUEUE should be empty. \nIf not it indicates some freeze or TC ended too fast /we could give some sleep option to give a chance for AMQ \nto consume the messages/.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-16T16:06:46.629+0000","updated":"2013-09-16T16:06:46.629+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13768901","id":"13768901","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Modded test case using embedded brokers.  With changes to the spring response processor.  Broker restart at end clears wrong queue stats. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-16T22:52:13.021+0000","updated":"2013-09-16T22:52:13.021+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13770821","id":"13770821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"It still unusual to me to call all these interrupts, as I cannot image a scenario in real life that will do the similar thing to the application.\n\nAnyhow, I did some changes to the configuration of thins I have a test that now passes all the time for me (please find it attached). Things that are changed:\n\n- one of the most important things is to move spring consumer to client acknowlegdment (look listener.xml). The spring container will synchronosuly receive messages and pass them to listener. So in case of the long running listener, the message is acked imidiatelly, which causes problems later.\n- conditionalNetworkBridgeFilterFactory policy and larger ttl, as consumers can come and go to different brokers and we need to be able to pass messages back and forth\n- ignoreIdleConsumers=\"true\" as we don't want to kill connections of idle consumers\n- abortConnection=\"false\" as we don't want to kill the connection just a misbehaving consumer\n\nCan you guys run this version of the test and see how it works for you?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-18T14:36:25.296+0000","updated":"2013-09-18T14:36:25.296+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13770928","id":"13770928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"For me the last AMQFreezeTest.zip is still failing both using the 5.8 snapshot containing the slow abort consumer strategy and latest 5.9 binaries.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-18T16:22:12.497+0000","updated":"2013-09-18T16:22:12.497+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13770941","id":"13770941","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"Please advise why do you think the auto_acknowledge option should not be used? \n\nI managed to get the both test cases to pass using the ignoreIdleConsumers=\"false\" and abortConnection=\"true\" \nif we consider the traces only /the messages really received/ and not taking into account the wrong statistics. I got all the messages consumed by the spring consumers. The slow strategy after being triggered a few times was able to close the connections and they have been recreated by spring consumers only so I had to modify the test cases to use the spring configuration for both INPUT_QUEUE & RECEIPT_QUEUE.\nI used the original test cases in form I sent here with the mentioned modifications.\n\nWhat might be the risk for us to use the ignoreIdleConsumers=\"false\" and abortConnection=\"true\"?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-18T16:39:22.387+0000","updated":"2013-09-18T16:39:22.387+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13770952","id":"13770952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Idle consumers are consumers that have no outstanding dispatched messages.  These consumer have nothing to do and therefore would always trip the slow condition and eventually be closed.  In the case of having the abortConnection=true this means that you'd have consumer connection coming and going for no real reason which could impact performance of your application.  I don't see why you'd want to not just ignore the idle one's and only focus on consumers that have not ack'd outstanding messages in the allocated time.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-18T16:48:48.917+0000","updated":"2013-09-18T16:48:48.917+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13771114","id":"13771114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Running with Dejan's configuration I see the test passing consistently now. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2013-09-18T19:00:03.241+0000","updated":"2013-09-18T19:00:03.241+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13771636","id":"13771636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"For me it has also passed 90-95% times but I sent you the case when it failed. Also please notice the wrong statistics there. We had there above 1000 messages or even -2. Why? \nI do not want it to pass 99% but 100% because we have on the production rare case when we have to remove all the messages from all queues because of such \"freeze\" (nothing else helps). This is the reason I am a bit pushy to get it solved completly. \nAs for the parameters with ignoreIdleConsumers=\"false\" and abortConnection=\"true\" I managed to get 100% of success runs ignoring statistics however. With ignoreIdleConsumers=\"true\" none of the two test cases does not work for me every time. With abortConnection=\"false\" only kahaPendingMessages.zip is going to work, the AMQFreezeTest is failing simetimes.\nWe really need to get rid of the AMQ freezes which are very bad and cost much also as for the mainenance.\nCould you advise why ignoreIdleConsumers=\"false\" helps so much but you said it should not? Anyway I would like to avoid setting this.\n\nAlso please use the original test case as we can modify any test case to pass but I need to know reasons for any change to our application as for AUTO_ACKNOWLEDGE before puting it in the late state of our project. We need the code to reflect out production design.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-19T06:43:23.711+0000","updated":"2013-09-19T06:43:23.711+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13771703","id":"13771703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"The problem is how the spring message listener works. It doesn't use message listener like you would in a JMS app. Instead it does receive() on the session, gets the message and manually executes onMessage() on the listener. In auto acknowledge mode as soon as receive() is done, the message is acked and considered processed. So the message that sleeps forever will not be resent to other consumers when this consumer is detected slow. Turning to client acknowlement Spring actually manually acks the message when onMessage() completes. So when we close the consumer, the current long-sleeping message will be replayed to other consumers.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2013-09-19T08:54:06.333+0000","updated":"2013-09-19T08:54:06.333+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13771808","id":"13771808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"Thank you for your comment!\nWe do not care about the long-sleeping message but about all the prefetched messages for the sleeping consumer which needs to be redispatched & delivered to other consumers. This is all what needs to be guaranteed here no matter what option we are going to use in the spring listener we do not want the freeze - meaning that all pending/prefetched messages have to be re-dispatched from such slow /or frozen/ consumers to other ones. However I am still concerned about the ignoreIdleConsumers=\"false\" and abortConnection=\"true\" which is going to work for me. Why ignoreIdleConsumers=\"false\" helps so much when you said it should not? Could it be checked as we would like to avoid this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-19T11:32:14.258+0000","updated":"2013-09-19T11:32:14.258+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13774441","id":"13774441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"body":"I used the last test case from: https://fusesource.com/issues/browse/ENTMQ-409\nand tested it on my laptop.\nResults: Tests run: 20 Failed: 8\n\nI attached logs from the failed tests:\nLOGS_FAILED_5.9.0.redhat-610-SNAPSHOT.zip\n\nI have also checked it on very slow Solaris system where I was not able to get the test case passed even once/see attached logs/.\n\nAfter changing only the options to have abortConnection=\"true\" ignoreIdleConsumers=\"false\" I managed to pass the test case on the Solaris environment and got better results on the laptop with Windows OS: Tests run: 20 Failed 2\n\nSo I was able to get the test case failed even with abortConnection=\"true\" ignoreIdleConsumers=\"false\" but it behaved much better with these options.\n\nFor testing I used the oryginal TC and 5.9.0.redhat-610-SNAPSHOT from:\n\nhttp://repo.fusesource.com/nexus/content/repositories/snapshots/\n\nAs for activemq-all we had only those:\n5.9-fuse-SNAPSHOT/  Thu Jun 27 11:57:53 UTC 2013        \n5.9.0.redhat-610-SNAPSHOT/  Sat Sep 21 00:34:04 UTC 2013  \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wdudek","name":"wdudek","key":"wdudek","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wieslaw Dudek","active":true,"timeZone":"Etc/UTC"},"created":"2013-09-23T10:29:50.173+0000","updated":"2013-09-23T10:29:50.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12647406/comment/13943013","id":"13943013","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Using abortConnection=false is viable with https://issues.apache.org/jira/browse/AMQ-5114 - the broker will always see a local remove when teh sub is aborted, even if the remote sub is slow to respond or never responds.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-21T12:42:49.017+0000","updated":"2014-03-21T12:42:49.017+0000"}],"maxResults":50,"total":50,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4533/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1kjv3:"}}