{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482311","self":"https://issues.apache.org/jira/rest/api/2/issue/12482311","key":"AMQ-1950","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-09-30T13:50:49.320+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 07 17:20:48 UTC 2008","customfield_12310420":"75162","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_629377902_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_605580622","customfield_12312321":null,"resolutiondate":"2008-10-01T16:17:37.020+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1950/watchers","watchCount":0,"isWatching":false},"created":"2008-09-24T09:27:59.118+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315619","id":"12315619","description":"","name":"5.2.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-10-08T16:30:37.587+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"The deadlock occurs on the slave after sending some 30 messages. Sending a few at a time works fine.\nThe test application is a MessageDrivenBean that sends a message to another MDB with a temporary reply queue.\n\nName: TempQueue:  ID:selten.marketxs.com-40254-1222245868043-0:14:6\nState: WAITING on java.util.concurrent.locks.ReentrantLock$NonfairSync@f30862 owned by: VMTransport: vm://solow.marketxs.com#1\nTotal blocked: 0  Total waited: 1\n\nStack trace: \nsun.misc.Unsafe.park(Native Method)\njava.util.concurrent.locks.LockSupport.park(LockSupport.java:158)\njava.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:747)\njava.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:778)\njava.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1114)\njava.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:186)\njava.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:262)\norg.apache.activemq.broker.region.Queue.iterate(Queue.java:992)\n   - locked org.apache.activemq.broker.region.Queue$2@16b775f\norg.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\norg.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\nName: VMTransport: vm://solow.marketxs.com#1\nState: BLOCKED on org.apache.activemq.broker.region.Queue$2@16b775f owned by: TempQueue:  ID:selten.marketxs.com-40254-1222245868043-0:14:6\nTotal blocked: 9  Total waited: 2,684\n\nStack trace: \norg.apache.activemq.broker.region.Queue.iterate(Queue.java:952)\norg.apache.activemq.broker.region.Queue.wakeup(Queue.java:1136)\norg.apache.activemq.broker.region.Queue.addSubscription(Queue.java:249)\norg.apache.activemq.broker.region.TempQueue.addSubscription(TempQueue.java:74)\norg.apache.activemq.broker.region.AbstractRegion.addConsumer(AbstractRegion.java:275)\n   - locked java.lang.Object@1ba2be8\norg.apache.activemq.broker.region.RegionBroker.addConsumer(RegionBroker.java:378)\norg.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:86)\norg.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:86)\norg.apache.activemq.advisory.AdvisoryBroker.addConsumer(AdvisoryBroker.java:83)\norg.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:86)\norg.apache.activemq.broker.MutableBrokerFilter.addConsumer(MutableBrokerFilter.java:93)\norg.apache.activemq.broker.TransportConnection.processAddConsumer(TransportConnection.java:541)\norg.apache.activemq.command.ConsumerInfo.visit(ConsumerInfo.java:345)\norg.apache.activemq.broker.TransportConnection.service(TransportConnection.java:305)\norg.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:179)\norg.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:104)\norg.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)\norg.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:205)\norg.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\norg.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\n\n\nI'll try to reproduce the issue with a stand-alone JMS client. It also happens without JBoss clustering.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461153","id":"12461153","filename":"amq-1950.patch.2.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T10:51:18.908+0000","size":2999,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461153/amq-1950.patch.2.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461189","id":"12461189","filename":"ASF.LICENSE.NOT.GRANTED--activemqjee-0.0.4-src.tar.gz","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-06T14:09:28.881+0000","size":6556,"mimeType":"application/x-gzip","content":"https://issues.apache.org/jira/secure/attachment/12461189/ASF.LICENSE.NOT.GRANTED--activemqjee-0.0.4-src.tar.gz"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461263","id":"12461263","filename":"ASF.LICENSE.NOT.GRANTED--deadlock.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-24T09:27:59.132+0000","size":39443,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461263/ASF.LICENSE.NOT.GRANTED--deadlock.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461264","id":"12461264","filename":"StandaloneApp.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T11:13:15.224+0000","size":5469,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461264/StandaloneApp.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172014","customfield_12312823":null,"summary":"Deadlock using temporary queues in Pure Master/Slave setup","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"JBoss 4.0.5 GA with ActiveMQ resource adapter and Java 1.6 update 7\n\nI used the ActiveMQ 5.2.0 RC1 from 10th september.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940267","id":"12940267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Hans, have you had any luck reproducing this problem with trunk and with a simple jms only test. I have been attempting to reproduce with org.apache.activemq.advisory.MasterSlaveTempQueueMemoryTest, but to no avail.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T13:50:49.320+0000","updated":"2008-09-30T13:50:49.320+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940288","id":"12940288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"I first tried to run the test with a singleton MDB, but I found that my JBoss configuration failed here. It was still deploying multiple beans.\n\nI think to reproduce it stand-alone, I must instantiate several message message listener beans that forward the message to a temporary queue and receive the reply. Probably less than that will do, but this would replicate the JBoss case and I don't know which part exactly fails.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T14:10:27.833+0000","updated":"2008-09-30T14:10:27.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940273","id":"12940273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"This patch should resolve the issue, the wakeup outside of the dispatchLock makes sense in all cases, as the wakeup deals with optimized and the additional isSlave check which causes the problem in this case.\nI want to verify a full test run with this change and also see if I can generate a tests case that reproduces the problem.\nHans, if you get a chance, can you verify your jboss scenario with this fix? thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T14:20:55.395+0000","updated":"2008-09-30T14:20:55.395+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940253","id":"12940253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Removed \n\n    <dependency>\n      <groupId>${pom.groupId}</groupId>\n      <artifactId>activemq-core</artifactId>\n      <type>test-jar</type>\n      <scope>test</scope>\n    </dependency>\n\nfrom activemq-pool/pom.xml\n\nor I get:\n\nMissing:\n----------\n1) org.apache.activemq:activemq-core:test-jar:tests:5.3-SNAPSHOT\n\n  Try downloading the file manually from the project website.\n\n  Then, install it using the command: \n      mvn install:install-file -DgroupId=org.apache.activemq -DartifactId=activemq-core -Dversion=5.3-SNAPSHOT -Dclassifier=tests -Dpackaging=test-jar -Dfile=/path/to/file\n\n  Alternatively, if you host your own repository you can deploy the file there: \n      mvn deploy:deploy-file -DgroupId=org.apache.activemq -DartifactId=activemq-core -Dversion=5.3-SNAPSHOT -Dclassifier=tests -Dpackaging=test-jar -Dfile=/path/to/file -Durl=[url] -DrepositoryId=[id]\n\n  Path to dependency: \n        1) org.apache.activemq:activemq-pool:bundle:5.3-SNAPSHOT\n        2) org.apache.activemq:activemq-core:test-jar:tests:5.3-SNAPSHOT\n\n----------\n1 required artifact is missing.\n\nfor artifact: \n  org.apache.activemq:activemq-pool:bundle:5.3-SNAPSHOT\n\nSame for activemq-camel/pom.xml and some other sub poms\n\nI'm running\n\n  mvn -Dmaven.test.skip=true install\n\nbecause it takes a long time to run all tests and some often fail.\n\nMaven does not skip the test-jar dependencies, it seems.\n\nInstalled Maven 2.0.9, but it does the same :(\n\nGetting there, but it takes a while.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T14:56:45.460+0000","updated":"2008-09-30T14:56:45.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940270","id":"12940270","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"ah,{code}mvn clean install -Dtest=0{code} does the trick. The builds the tests but no tests are run as none match '0'.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T15:22:57.295+0000","updated":"2008-09-30T15:22:57.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940282","id":"12940282","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Thanks. Easier than removing all those dependencies.\n\nI've first tested with the old installation to verify that it still fails. It did. With 1 message and 10 messages it was OK, but when I sent 50 it got the deadlock at 33.\n\n\nWith the patched 700476 I do not get a dead after sending 4 times 100 messages at a time.\n\nI got some \" Slave broker out of sync with master: Dispatched message (ID:...id.) was not in the pending list\" messages, though.\nAnd, I guess as a result, the number of messages on the slave queue page were not updated to the same values as on the master.\n\nI also have a lot of temporary queues on the slave, now.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T16:06:34.574+0000","updated":"2008-09-30T16:06:34.574+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940251","id":"12940251","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Did another test with 30 messages at a time and then it happened at exactly the same total number of messages: 200\n\nDoes that ring a bell? Is there some list that gets full?\n\nMaybe I should try with a much larger message. If the same happens sooner it could be a memory buffer that gets full.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T16:26:08.105+0000","updated":"2008-09-30T16:26:08.105+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940260","id":"12940260","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"this is progress but it is pointing to the need for a standalone test case.\n200 is the default page size, but not sure if that is relevant in this case. \n\nI wonder if it is worth looking at org.apache.activemq.advisory.TempQueueMemoryTest, it is simple rpc with a temp q for the reply. I extended it to master slave to tackle an instance of \"Slave broker out of sync with master...\" in the past, hense MasterSlaveTempQueueMemoryTest. How different is the mdb scenario? If we can replicate the jms logic then I think it is only a case of ensuring that the session/connection caching is maintained and the jboss scenario can be reproduced. Do you think this is feasible?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T16:47:57.800+0000","updated":"2008-09-30T16:47:57.800+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940262","id":"12940262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Certainly feasible, but I think implementing all is a lot of work and not necessary. The problem is to identify the relevant parts.\nFor AMQ-1849 I could make a bean that is used by both.\n\nHere it's a bit more complicated, because I think that concurrency is part of the problem. I'm not sure exactly where, but I suspect creating and deleting temporary queues is at least part of it. (well, for the deadlock certainly)\n\nThe JBoss case usually works fine when I send 10 messages, that are forwarded from the first MDB to another temporary queue. When there are more pending messages, JBoss will create more MDB's, so there is more concurrency.\n\nI doubt that the test cases really catch the master/slave issues, because of variable latency between the hosts. But it's better than nothing. I'll check them again.\n\nlater\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T17:54:56.659+0000","updated":"2008-09-30T17:54:56.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940291","id":"12940291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"more complete patch, same logic needs to be applied to subscription removal as well as subscription addition as iterate can be at work in both cases.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T10:51:18.951+0000","updated":"2008-10-01T10:51:18.951+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940293","id":"12940293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Do you think the patch to avoid the deadlock can be applied to 5.2.0 RC1 ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T11:38:02.035+0000","updated":"2008-10-01T11:38:02.035+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940264","id":"12940264","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"yea, I will cut rc2 from trunk before the end of the week with a bit of luck and commit the deadlock fixes once I track down some further regressions with the unit tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T11:53:44.061+0000","updated":"2008-10-01T11:53:44.061+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940298","id":"12940298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Committed revision 700823 slight revision to patch to gate on isSlave to reflect wakeup inline call to iterate. This allows immediate dispatch to new subscription.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T16:17:36.989+0000","updated":"2008-10-01T16:17:36.989+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940285","id":"12940285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Surprising result (for me, at least) with the patched RC1(Sep 30) : it also happens when the MDB's are deployed as singleton.\n\nI sent 50 messages at a time. Fine up to 200, so 4 times.\n\nOn the 5th it works as expected on the master, but the slave has:\n\n|| queue      || Pending   || Received ||\n| queue.ReplyA | 250     | 0 |\n|  queue.A \t     | 50       | 200 |\n|  queue.B \t     | 50   | 200 | \n\nA stand-alone test application using a single bean is quite easy to make, if it's still necessary.\n\nHave not tried the latest trunk, yet.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-03T19:09:34.903+0000","updated":"2008-10-03T19:22:20.954+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940274","id":"12940274","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"I've created a JMSMessageHandler (a MessageListener) and a kind of container for it.\n\nSee activemqjee-0.0.4-src.tar.gz\n\nIt can be deployed on JBoss 4, Glassfish or stand-alone. (tested all three)\n\nTo run it stand-alone, do something like:\n\njava -classpath conf:lib/activemq-all-5.2.0.jar:lib/activemqjee-0.0.4.jar:lib/log4j-1.2.14.jar org.activemq.jms.StandaloneApp \n\nthat is, on a unix with a directory structure:\n conf/jndi.properties  \n conf/log4j.xml\n lib/activemq-all-5.2.0.jar  \n lib/activemqjee-0.0.4.jar\n lib/log4j-1.2.14.jar\n\nOptional parameters:\n  a number = the number of concurrent beans (message listeners)  (default 1)\n  a second number =  the number of milliseconds to use for time-to-live / timeout. (default 1000 ms)\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-06T14:09:28.883+0000","updated":"2008-10-06T14:09:28.883+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940308","id":"12940308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Hans, this looks like progress, thanks. Standalone app runs fine. Can u post your handy client? thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-06T15:06:10.593+0000","updated":"2008-10-06T15:06:10.593+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940303","id":"12940303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"I don't know, what you mean. StandaloneApp is my handy client. (I think)\n\n\nIt works by posting a message to 'queue.A' with the ActiveMQ console (or anyway you like, of course) with a reply queue (I use \"queue.ReplyA\"). \n\nThen the first message handler (handler A) forwards the message to 'queue.B'  to which the second message handler is listening.\n\nThe second message handler replies to the first through the reply queue (set by handler A).\n\nThe first (handler A) replies to the reply you've specified in the first request.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-06T15:35:01.619+0000","updated":"2008-10-06T15:35:01.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940304","id":"12940304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Also works on JBoss 4.2.3.GA. (the other was 4.0.5)\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T10:12:28.893+0000","updated":"2008-10-07T10:12:28.893+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940327","id":"12940327","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Added a little test driver, startBroker(), doWork() that submits 250 messages, both maser and slave show the expected processed messages via jconsole.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T11:13:15.254+0000","updated":"2008-10-07T11:13:15.254+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940322","id":"12940322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Hans, ok, I added the code to start a master slave pair and produce 250 messages to StandaloneApp, see attachement. The test works are expected. Are you happy that this issues is resolved?\n\nThe 'surprising' result you mention above (on the 3rd), in what circumstances does this happen in the standalone app?\nI will try some additional values of \"the number of concurrent beans (message listeners) (default 1)\" in the next few minutes it hope of reproducing the problem. \nOtherwise, can we consider this issue closed?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T11:18:24.501+0000","updated":"2008-10-07T11:18:24.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940295","id":"12940295","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"That result was against the same version as I had tested before.\n\nI'll test again. I should use the latest 5.3.0-SNAPSHOT ?\n\nOr is there a new RC already?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T15:48:43.456+0000","updated":"2008-10-07T15:48:43.456+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940310","id":"12940310","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"wait for the new rc, I am working on it now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T16:29:37.682+0000","updated":"2008-10-07T16:29:37.682+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482311/comment/12940325","id":"12940325","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"body":"Your test does not test concurrency. The receiver waits until it gets the previously posted message and then the next message is produced. \n\nI've modified it to first produce all messages with a correlationid and then try to receive the same number of messages and checking the received ids.\n\nAlso added copying the correlationid in the handler. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hansb","name":"hansb","key":"hansb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hans Bausewein","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T17:20:48.475+0000","updated":"2008-10-07T17:20:48.475+0000"}],"maxResults":23,"total":23,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1950/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tt1j:"}}