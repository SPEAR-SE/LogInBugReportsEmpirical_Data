{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12537523","self":"https://issues.apache.org/jira/rest/api/2/issue/12537523","key":"AMQ-3654","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321258","id":"12321258","description":"Next v5 maintenance release","name":"5.7.0","archived":false,"released":true,"releaseDate":"2012-10-08"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-01-06T16:33:37.330+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Aug 20 11:31:56 UTC 2012","customfield_12310420":"223029","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_13761847864_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-06-13T21:55:49.455+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3654/watchers","watchCount":10,"isWatching":false},"created":"2012-01-06T15:11:41.672+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315626","id":"12315626","description":"","name":"5.5.0","archived":false,"released":true,"releaseDate":"2011-04-01"}],"issuelinks":[{"id":"12347364","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12347364","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12539772","key":"AMQ-3681","self":"https://issues.apache.org/jira/rest/api/2/issue/12539772","fields":{"summary":"DatabaseLocker should first cancel locking SQL statement before closing the SQL connection","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12347363","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12347363","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12483313","key":"AMQ-1958","self":"https://issues.apache.org/jira/rest/api/2/issue/12483313","fields":{"summary":"JDBC master/slave deadlock when connection is lost","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-08-20T11:31:56.404+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Our configuration is JDBC Master/Slave with one master and one slave. When the master is started, he acquire the database lock.\nThen when the slave is started, he wait to acquire the database lock. When the master loose the network connection to the database, the lock in the database is not removed and the slave connot acquire the database lock. In this situation, the master is unable to respond to client (due to network failure)\nand the slave is not started because he can't acquire the database lock.\n\nWhen the master is killed, the slave can't acquire the database lock too. After the network connection is restored, when the master starts, it cannot\nacquire lock to the database (because the lod lock is always present) so now, we have two slaves and no master.\n\nPlease, refer to this issue which is the same problem : AMQ-1958 ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"58987","customfield_12312823":null,"summary":"JDBC Master/Slave : Slave cannot acquire lock when the master loose database connection.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rmartin","name":"rmartin","key":"rmartin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard Martin","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rmartin","name":"rmartin","key":"rmartin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard Martin","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Unix/Redhat 5.6\nActiveMQ 5.5.0\nOracle 10G","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13181422","id":"13181422","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"body":"\nI guess When the master loose the network connection to the database,the underlying jdbc connection can not detect the network connection is broken in time.\nYou can try to set the value of property lockKeepAlivePeriod of jdbcPersistenceAdapter to be smaller than default value(default 30s).\nIf it works please let me know,thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2012-01-06T16:33:37.330+0000","updated":"2012-01-06T16:33:37.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13182642","id":"13182642","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rmartin","name":"rmartin","key":"rmartin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard Martin","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for the suggestion, i tried to set the property lockKeepAlivePeriod to 3s with this configuration :\n\n<jdbcPersistenceAdapter lockKeepAlivePeriod=\"3000\"  dataDirectory=\"${activemq.base}/data\" dataSource=\"#oracle-ds\" />\n\nBut it didn't work. When the network connection on the master is lost, the lock is still present in the database. Any other idea which can solve the network failure test ?\n\nDo you think, i can use the jdbc mode configured with useDatabaseLock=\"false\" ? It seem to be a master/master solution. We need to have a HA Solution with no message lost. With the shared database, the message are stored in the same place. So if the master1 fail, the message is stored in the database and our client switch to the master2 and he can consume the message. Is it correct or i must use a Jdbc master/slave with useDatabaseLock=\"true\" to have a HA solution ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rmartin","name":"rmartin","key":"rmartin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard Martin","active":true,"timeZone":"Etc/UTC"},"created":"2012-01-09T17:21:17.110+0000","updated":"2012-01-09T17:21:17.110+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13182979","id":"13182979","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Seem it's the business for oracle to handle this situation because it doest not detect the broken connection and release the row lock in time.\nYou can consult your DBA for more advice.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2012-01-10T01:16:22.816+0000","updated":"2012-01-10T01:16:22.816+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13193863","id":"13193863","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"body":"If the database connection is abruptly lost (no TCP FIN nor RST), for instance when the network cable is unplugged, the DB client application cannot release the lock anymore.\nThe DB server itself needs to detect the dead connection.\nOn Oracle the parameter \"SQLNET.EXPIRE_TIME\" can be used.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=metatech","name":"metatech","key":"metatech","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"metatech","active":true,"timeZone":"Europe/Berlin"},"created":"2012-01-26T14:35:52.327+0000","updated":"2012-01-26T14:35:52.327+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13205353","id":"13205353","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kimmking","name":"kimmking","key":"kimmking","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"kimm king","active":true,"timeZone":"Asia/Shanghai"},"body":"metatech's suggestion is nice.\n\nExclusive Lock in this point is magic and dangerous way.\n Under certain conditions, this error will occur.\n   And if a storage do not support the lock like this, sadness happens.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kimmking","name":"kimmking","key":"kimmking","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"kimm king","active":true,"timeZone":"Asia/Shanghai"},"created":"2012-02-10T10:47:18.976+0000","updated":"2012-02-10T10:47:18.976+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13274504","id":"13274504","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ranpeng","name":"ranpeng","key":"ranpeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ranpeng","active":true,"timeZone":"Etc/UTC"},"body":"i use the mysql database to store messages ,and i met the same problem. When the master loose the network connection to the database, the lock in the database is not removed and the slave connot acquire the database lock.after the network recovery connection ,the master still can't acquire lock to the database  so now, we have two slaves and no master.period of time , the master process automatically exit,remaining a slave.Any other idea which can solve the network failure test ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ranpeng","name":"ranpeng","key":"ranpeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ranpeng","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-14T08:26:26.721+0000","updated":"2012-05-14T08:26:26.721+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13294679","id":"13294679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"Added a lease based data base locker. Use as follows from xml config with the 5.7-SNAPSHOT{code}       <ioExceptionHandler>\n            <jDBCIOExceptionHandler/>\n        </ioExceptionHandler>\n\n        <persistenceAdapter>\n            <jdbcPersistenceAdapter lockKeepAlivePeriod=\"1000\" lockAcquireSleepInterval=\"2000\">\n                <databaseLocker>\n                    <lease-database-locker/>\n                </databaseLocker>\n            </jdbcPersistenceAdapter>\n        </persistenceAdapter>\n{code}\nThe optional IOExceptionHandler will pause/resume the transport connectors on any IO exception related to access to the DB.\nThe lease based lock is acquired by blocking at start and retained by the keepAlivePeriod. To retain, the lease is extended by the lockAcquireSleepInterval, so in theory the master is always {code}lockAcquireSleepInterval-lockKeepAlivePeriod{code} ahead of the slave w.r.t the lease.\nThe lease is dropped on normal shutdown.\nThe broker system clock is not in sync with the db, a maxAllowableDiffFromDBTime > 0 will adjust the lease duration if the skew exceeds the absolute maxAllowableDiffFromDBTime value, allowing the db to dictate the utc basis for the lease.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-13T21:55:49.507+0000","updated":"2012-06-13T21:55:49.507+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13294681","id":"13294681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"would appreciate if you could validate the efficacy of this lease based approach in your environment using the latest 5.7-SNAPSHOT \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-13T21:58:24.651+0000","updated":"2012-06-13T21:58:24.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13430984","id":"13430984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gshx","name":"gshx","key":"gshx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Gaurav Sharma","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Gary. What is the suggested patch back-porting process in case I want to apply this patch to my v5.6 broker running the jdbc master-slave configuration against oracle? Should I just build the core jar from source after applying the changes to v5.6 code in my local svn repo?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gshx","name":"gshx","key":"gshx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Gaurav Sharma","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-08T09:43:59.623+0000","updated":"2012-08-08T09:43:59.623+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13430990","id":"13430990","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"maybe first try a 5.7-SNAPSHOT to validate it works in your use case, but sure, an updated activemq-core is all that you will need.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-08T09:53:13.302+0000","updated":"2012-08-08T09:53:13.302+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13430996","id":"13430996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gshx","name":"gshx","key":"gshx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Gaurav Sharma","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Gary, will first test with the 5.7-SNAPSHOT.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gshx","name":"gshx","key":"gshx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Gaurav Sharma","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-08T10:13:59.413+0000","updated":"2012-08-08T10:13:59.413+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13431196","id":"13431196","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zeeiyer","name":"zeeiyer","key":"zeeiyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sreeni Iyer","active":true,"timeZone":"Etc/UTC"},"body":"+1 for the lock lease approach with the deck loaded in favor of the current leasee. That's how i have seen it work with Terracotta and many other implementations...Seems like just the implementation needs to be tested out.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zeeiyer","name":"zeeiyer","key":"zeeiyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sreeni Iyer","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-08T16:14:46.647+0000","updated":"2012-08-08T16:14:46.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13432484","id":"13432484","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gshx","name":"gshx","key":"gshx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Gaurav Sharma","active":true,"timeZone":"America/Los_Angeles"},"body":"Tested 5.7-SNAPSHOT with MySQL and the patch works just fine. The BROKER_NAME also seems to be getting populated in the lock table.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gshx","name":"gshx","key":"gshx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Gaurav Sharma","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-10T02:10:22.382+0000","updated":"2012-08-10T02:10:22.382+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13433008","id":"13433008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"body":"For row lock based database locker, I use the same configuration file for all brokers.\nThis makes deployment job simple really.\nLeaseDatabaseLocker need specify the unique lease id, by default it's broker name, \nso does this mean I have to specify different broker name for each one in the cluster?\nThe last confusion is should lockAcquireSleepInterval be greater than lockKeepAlivePeriod anyway?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wangyin","name":"wangyin","key":"wangyin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"SuoNayi","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2012-08-13T08:59:28.680+0000","updated":"2012-08-13T09:04:51.491+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12537523/comment/13437795","id":"13437795","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"@SuoNayi \nyes, either the brokerName or the lease-database-locker.leaseHolderId needs to be unique for a master/slave pair.\nAnd yes, lockAcquireSleepInterval > lockKeepAlivePeriod is necessary.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-20T11:31:56.402+0000","updated":"2012-08-20T11:31:56.402+0000"}],"maxResults":15,"total":15,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3654/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0agr3:"}}