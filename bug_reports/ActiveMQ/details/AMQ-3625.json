{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12534229","self":"https://issues.apache.org/jira/rest/api/2/issue/12534229","key":"AMQ-3625","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-12-20T14:02:52.630+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 28 19:17:58 UTC 2011","customfield_12310420":"219951","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1816221941_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-12-28T19:17:58.385+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3625/watchers","watchCount":1,"isWatching":false},"created":"2011-12-07T18:47:36.553+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318549","id":"12318549","name":"5.5.1","archived":false,"released":true,"releaseDate":"2011-10-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-12-28T19:17:58.480+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"Couple NPEs pop out when a connecting one broker to another using authentication if the authentication fails:\n\nWARN | Failed to add Connection ID:Susan-Javureks-MacBook-Pro-3.local-53150-1322608354523-5:1, reason: java.lang.SecurityException: User name [null] or password is invalid. No user for client certificate: CN=Dave Stanley, OU=FuseSource, O=Progress, L=Unknown, ST=MA, C=US\nWARN | Async error occurred: java.lang.SecurityException: User name [null] or password is invalid. No user for client certificate: CN=Dave Stanley, OU=FuseSource, O=Progress, L=Unknown, ST=MA, C=US\njava.lang.SecurityException: User name [null] or password is invalid. No user for client certificate: CN=Dave Stanley, OU=FuseSource, O=Progress, L=Unknown, ST=MA, C=US\nat org.apache.activemq.security.JaasCertificateAuthenticationBroker.addConnection(JaasCertificateAuthenticationBroker.java:102)\nat org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:85)\nat org.apache.activemq.broker.MutableBrokerFilter.addConnection(MutableBrokerFilter.java:91)\nat org.apache.activemq.broker.TransportConnection.processAddConnection(TransportConnection.java:707)\nat org.apache.activemq.broker.jmx.ManagedTransportConnection.processAddConnection(ManagedTransportConnection.java:77)\nat org.apache.activemq.command.ConnectionInfo.visit(ConnectionInfo.java:139)\nat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:318)\nat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:181)\nat org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:69)\nat org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:113)\nat org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:227)\nat org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)\nat org.apache.activemq.transport.tcp.SslTransport.doConsume(SslTransport.java:91)\nat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:223)\nat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:205)\nat java.lang.Thread.run(Thread.java:680)\nCaused by: javax.security.auth.login.FailedLoginException: No user for client certificate: CN=Dave Stanley, OU=FuseSource, O=Progress, L=Unknown, ST=MA, C=US\nat org.apache.activemq.jaas.CertificateLoginModule.login(CertificateLoginModule.java:93)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat javax.security.auth.login.LoginContext.invoke(LoginContext.java:769)\nat javax.security.auth.login.LoginContext.access$000(LoginContext.java:186)\nat javax.security.auth.login.LoginContext$4.run(LoginContext.java:683)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)\nat javax.security.auth.login.LoginContext.login(LoginContext.java:579)\nat org.apache.activemq.security.JaasCertificateAuthenticationBroker.addConnection(JaasCertificateAuthenticationBroker.java:87)\n... 15 more\n{color:red}WARN | Async error occurred: java.lang.NullPointerException\njava.lang.NullPointerException{color}\nat org.apache.activemq.broker.TransportConnection.processAddProducer(TransportConnection.java:512)\nat org.apache.activemq.command.ProducerInfo.visit(ProducerInfo.java:105)\nat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:318)\nat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:181)\nat org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:69)\nat org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:113)\nat org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:227)\nat org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)\nat org.apache.activemq.transport.tcp.SslTransport.doConsume(SslTransport.java:91)\nat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:223)\nat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:205)\nat java.lang.Thread.run(Thread.java:680)\nWARN | {color:red}Async error occurred: java.lang.NullPointerException\njava.lang.NullPointerException{color}\nat org.apache.activemq.broker.TransportConnection.processAddConsumer(TransportConnection.java:551)\nat org.apache.activemq.command.ConsumerInfo.visit(ConsumerInfo.java:349)\nat org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:318)\nat org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:181)\nat org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:69)\nat org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:113)\nat org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:227)\nat org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)\nat org.apache.activemq.transport.tcp.SslTransport.doConsume(SslTransport.java:91)\nat org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:223)\nat org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:205)\nat java.lang.Thread.run(Thread.java:680)\n\nIn this case the actual problem is the certificate doesn't match the configured password, but the two NPEs after this exception don't look good.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12506497","id":"12506497","filename":"0001-Avoid-NPE.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slewis","name":"slewis","key":"slewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=slewis&avatarId=12536","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=slewis&avatarId=12536","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=slewis&avatarId=12536","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=slewis&avatarId=12536"},"displayName":"Stan Lewis","active":true,"timeZone":"America/New_York"},"created":"2011-12-07T18:59:27.485+0000","size":18969,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12506497/0001-Avoid-NPE.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10042","value":"Patch Available","id":"10042"}],"customfield_12310921":null,"customfield_12310920":"58989","customfield_12312823":null,"summary":"NullPointer Exceptions when networked broker sends certificate with an invalid user name","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slewis","name":"slewis","key":"slewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=slewis&avatarId=12536","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=slewis&avatarId=12536","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=slewis&avatarId=12536","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=slewis&avatarId=12536"},"displayName":"Stan Lewis","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slewis","name":"slewis","key":"slewis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=slewis&avatarId=12536","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=slewis&avatarId=12536","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=slewis&avatarId=12536","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=slewis&avatarId=12536"},"displayName":"Stan Lewis","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12534229/comment/13173204","id":"13173204","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"The patch doesn't address the real issue here which is that the TransportConnection is continuing to process incoming commands from the its Transport after the detection of a Security violation from the Connection request.  It seems that the safer thing to do here would be to block processing of any additional incoming commands and terminate the connection after sending back a ConnectionError command to the connecting client.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-12-20T14:02:52.630+0000","updated":"2011-12-20T14:02:52.630+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12534229/comment/13176773","id":"13176773","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Tests all still passing on the CI box, marking as resolved now.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-12-28T19:17:58.433+0000","updated":"2011-12-28T19:17:58.433+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3625/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0agrj:"}}