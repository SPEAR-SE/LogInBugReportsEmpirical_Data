{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12556454","self":"https://issues.apache.org/jira/rest/api/2/issue/12556454","key":"AMQ-3851","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-10-02T14:00:41.414+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Oct 04 11:40:14 UTC 2012","customfield_12310420":"240022","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_11976092461_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-10-04T11:40:14.647+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3851/watchers","watchCount":4,"isWatching":false},"created":"2012-05-18T20:58:42.199+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"7.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317974","id":"12317974","description":"Next v5 maintenance release","name":"5.6.0","archived":false,"released":true,"releaseDate":"2012-05-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-10-04T11:40:14.658+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"I'm seeing a behavior that looks like a race condition of some kind. I have two brokers (MSSD5D101, MSTMIP103). MSSD5D101 has a duplex network connector connecting it to MSTMIP103. The two machines are in different US states so there is a VPN in between. I have two consumer services that reply to queued messages. One consumer (WISD5P101) connects to MSSD5D101 and the other consumer (POSD5P101) connects to MSTMIP103. I also have a web portal that sends messages out to different queues expecting a response. The web portal, and two consumers are all .NET based. \n\nWhat is happening is that after some number of messages, something goes crazy and floods the network of brokers with advisory messages pertaining to temp queues being added or removed. By restarting one or the other of the ActiveMQ servers, things return to normal. But, while the flood is happening, one of the machines will be at 100% CPU and become worthless. I will be attaching logs and some code that I'm using to interact with ActiveMQ.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528149","id":"12528149","filename":"ActiveMqMessagingProvider.cs","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:01:34.220+0000","size":13810,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12528149/ActiveMqMessagingProvider.cs"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528150","id":"12528150","filename":"ActiveMqRequestReceiver.cs","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:01:34.233+0000","size":2029,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12528150/ActiveMqRequestReceiver.cs"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528146","id":"12528146","filename":"Log.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T20:59:17.195+0000","size":160107,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12528146/Log.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528158","id":"12528158","filename":"mssd5d101-activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:14:57.930+0000","size":5745,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12528158/mssd5d101-activemq.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528159","id":"12528159","filename":"mstmip103-activemq.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:14:57.941+0000","size":5967,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12528159/mstmip103-activemq.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12530260","id":"12530260","filename":"run-2012-05-30.snapshot","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-30T19:42:43.977+0000","size":5134469,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12530260/run-2012-05-30.snapshot"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528153","id":"12528153","filename":"web-portal-code-snippet.cs","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:09:31.416+0000","size":2434,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12528153/web-portal-code-snippet.cs"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"3038","customfield_12312823":null,"summary":"Infinite TemqQueue advisory messages","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13279180","id":"13279180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"Logs","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T20:59:17.392+0000","updated":"2012-05-18T20:59:17.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13279182","id":"13279182","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"This is the code I use to wrap the ActiveMQ library that all my other software uses.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:01:34.267+0000","updated":"2012-05-18T21:01:34.267+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13279185","id":"13279185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"Snippet of code used in the web portal to send messages and receive responses.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:09:31.438+0000","updated":"2012-05-18T21:09:31.438+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13279188","id":"13279188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"ActiveMQ configuration files","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:12:10.499+0000","updated":"2012-05-18T21:12:10.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13279195","id":"13279195","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"ActiveMQ server configuration files","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-18T21:14:58.003+0000","updated":"2012-05-18T21:14:58.003+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13285952","id":"13285952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"I profiled the server instance using YourKit while the flood was taking place. I've included the trace to hopefully help in the debugging process. I've found that when I disable any kind of authorization that things seems to work fine. Looking at the trace, it looks like there might be a problem related to the AuthorizationBroker, but I'm not sure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-30T19:42:44.021+0000","updated":"2012-05-30T19:42:44.021+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13286695","id":"13286695","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"After more testing, I think there is a race condition in DefaultAuthorizationMap. Instead of going to LDAP, I defined the authorization entries in configuration and was able to reproduce the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-31T16:12:12.865+0000","updated":"2012-05-31T16:23:31.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13286904","id":"13286904","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"I've done further testing, I now think the problem is higher up than the DefaultAuthorizationMap in the AuthorizationBroker. I created a very simple class that implements AuthorizationMap that always returns a static set of ACLs and I was able to reproduce the flooding.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-05-31T20:31:52.471+0000","updated":"2012-05-31T20:31:52.471+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13467734","id":"13467734","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Hi,\n\nI see you're using some kind of a custom <solidInstanceCachedLDAPAuthorizationMap/> authorization plugin. Are you sure the problem isn't somewhere in there. \n\nCan you give Cached LDAP Authorization Module a try http://activemq.apache.org/cached-ldap-authorization-module.html and see if it helps.\n\nAlso, can you share more info on your further testings and how do you reproduce the problem","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-02T14:00:41.414+0000","updated":"2012-10-02T14:00:41.414+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13467783","id":"13467783","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"body":"No, I just made some changes so that the regular cachedLDAPAuthorizationMap would work with Active Directory. Those changes have now been put into trunk so I could still go back to using the regular one and still see the problem. In a previous comment I said that I wrote an extremely simple plugin that always returned the same ACLs and was still able to reproduce the problem. To reproduce the issue, I just setup a simple request/reply system using text messages. I believe I've attached the code I used. There was never a set number of messages I had to send before the flooding started. At first I was only able to reproduce the problem going over VPN, but eventually I was able to reproduce the problem between VMs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chrisdrobison","name":"chrisdrobison","key":"chrisdrobison","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Robison","active":true,"timeZone":"America/Denver"},"created":"2012-10-02T15:18:26.732+0000","updated":"2012-10-02T15:18:26.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13468386","id":"13468386","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbright","name":"mbright","key":"mbright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mark Brightwell","active":true,"timeZone":"Europe/Berlin"},"body":"Hi.\n\nI think we are seeing the same issue with fuse version 5.5.1-fuse-08-15 (was already the case for previous versions). We are running 2 brokers is a cluster with dynamic temporary queue forwarding. After some time, the 2 brokers get into some \"vicious circle\", whereby the same temporary queues are repeatedly added then removed from each of the brokers. As Chris mentions, this seems to use up a single thread on each process, presumably the thread removing & creating this temporary queues. It looks like the temporary queues are simply passed back and forth between the 2 brokers, and never get removed correctly. Only a restart of the brokers fixes the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbright","name":"mbright","key":"mbright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mark Brightwell","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-03T07:27:06.872+0000","updated":"2012-10-03T07:27:06.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13468391","id":"13468391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbright","name":"mbright","key":"mbright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mark Brightwell","active":true,"timeZone":"Europe/Berlin"},"body":"Forgot to add: we are using the SimpleAuthenticationPlugin with a tempDestinationAuthorizationEntry in the AuthorizationMap.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mbright","name":"mbright","key":"mbright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mark Brightwell","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-03T07:35:55.732+0000","updated":"2012-10-03T07:41:01.171+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13468440","id":"13468440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"Thanks for confirming. I see one potential problem that can cause it. I'll try to reproduce it now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-03T09:32:12.463+0000","updated":"2012-10-03T09:32:12.463+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12556454/comment/13469297","id":"13469297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"body":"It should be fixed now with svn revision 1393988.\n\nI did some refactoring of AdvisoryBroker to handle addDestinationInfo case properly.\n\nCan you test the latest snapshot\n\nhttps://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.8-SNAPSHOT/apache-activemq-5.8-20121004.112554-4-bin.tar.gz\n\nand report back if you still see the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dejanb","name":"dejanb","key":"dejanb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dejan Bosanac","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-04T11:40:14.657+0000","updated":"2012-10-04T11:40:14.657+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3851/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i00vin:"}}