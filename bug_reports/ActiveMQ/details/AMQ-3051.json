{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12483898","self":"https://issues.apache.org/jira/rest/api/2/issue/12483898","key":"AMQ-3051","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2011-01-06T12:56:39.240+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Dec 07 22:21:35 UTC 2012","customfield_12310420":"74741","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_64310125969_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-12-07T22:21:35.871+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3051/watchers","watchCount":1,"isWatching":false},"created":"2010-11-24T14:26:09.921+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315624","id":"12315624","description":"Maintenance release for 5.4.0","name":"5.4.1","archived":false,"released":true,"releaseDate":"2010-09-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-12-07T22:21:35.888+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We are consistently seeing the following exception in our Production environment.  At the current time we are seeing over 200K messages on the queue and no consumers can consume any messages.  Due to issues with the kahadb not deleting files, we are using the AMQStore for persistence.  We are using a NFS drive for the output of our persistent store.\n\nThe process cannot then be restarted as it will fail trying to load back in the file store.  The messages stored in the queue are critical, a way to recover these messages is important also.\n\n2010-11-24 08:20:44,015 | ERROR | Failed to page in more queue messages | org.apache.activemq.broker.region.Queue | Queue:Consumer.CaseManagement.VirtualTopic.intralinks.eventService\njava.lang.RuntimeException: java.lang.RuntimeException: java.io.IOException: Failed to read to journal for: offset = 168158, file = 17376, size = -1, type = 0. Reason: java.io.IOException: Could not locate data file data-17376\nat org.apache.activemq.broker.region.cursors.AbstractStoreCursor.reset(AbstractStoreCursor.java:113)\nat org.apache.activemq.broker.region.cursors.StoreQueueCursor.reset(StoreQueueCursor.java:157)\nat org.apache.activemq.broker.region.Queue.doPageIn(Queue.java:1681)\nat org.apache.activemq.broker.region.Queue.pageInMessages(Queue.java:1845)\nat org.apache.activemq.broker.region.Queue.iterate(Queue.java:1432)\nat org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:98)\nat org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:36)\nCaused by: java.lang.RuntimeException: java.io.IOException: Failed to read to journal for: offset = 168158, file = 17376, size = -1, type = 0. Reason: java.io.IOException: Could not locate data file data-17376\nat org.apache.activemq.broker.region.cursors.AbstractStoreCursor.fillBatch(AbstractStoreCursor.java:261)\nat org.apache.activemq.broker.region.cursors.AbstractStoreCursor.reset(AbstractStoreCursor.java:110)\n... 6 more\nCaused by: java.io.IOException: Failed to read to journal for: offset = 168158, file = 17376, size = -1, type = 0. Reason: java.io.IOException: Could not locate data file data-17376\nat org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:33)\nat org.apache.activemq.store.amq.AMQPersistenceAdapter.createReadException(AMQPersistenceAdapter.java:680)\nat org.apache.activemq.store.amq.AMQPersistenceAdapter.readCommand(AMQPersistenceAdapter.java:564)\nat org.apache.activemq.store.amq.AMQMessageStore.getMessage(AMQMessageStore.java:444)\nat org.apache.activemq.store.amq.RecoveryListenerAdapter.recoverMessageReference(RecoveryListenerAdapter.java:59)\nat org.apache.activemq.store.kahadaptor.KahaReferenceStore.recoverReference(KahaReferenceStore.java:89)\nat org.apache.activemq.store.kahadaptor.KahaReferenceStore.recoverNextMessages(KahaReferenceStore.java:127)\nat org.apache.activemq.store.amq.AMQMessageStore.recoverNextMessages(AMQMessageStore.java:537)\nat org.apache.activemq.broker.region.cursors.QueueStorePrefetch.doFillBatch(QueueStorePrefetch.java:97)\nat org.apache.activemq.broker.region.cursors.AbstractStoreCursor.fillBatch(AbstractStoreCursor.java:258)\n... 7 more\nCaused by: java.io.IOException: Could not locate data file data-17376\nat org.apache.activemq.kaha.impl.async.AsyncDataManager.getDataFile(AsyncDataManager.java:315)\nat org.apache.activemq.kaha.impl.async.AsyncDataManager.read(AsyncDataManager.java:637)\nat org.apache.activemq.store.amq.AMQPersistenceAdapter.readCommand(AMQPersistenceAdapter.java:561)\n... 14 more\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"81567","customfield_12312823":null,"summary":"Failed to read journal - Could not locate data file","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbrown%40intralinks.com","name":"kbrown@intralinks.com","key":"kbrown@intralinks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Brown","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbrown%40intralinks.com","name":"kbrown@intralinks.com","key":"kbrown@intralinks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Brown","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Solaris 10 running on Sparc","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483898/comment/12943253","id":"12943253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbrown%40intralinks.com","name":"kbrown@intralinks.com","key":"kbrown@intralinks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Brown","active":true,"timeZone":"Etc/UTC"},"body":"Attached broker configuration file.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbrown%40intralinks.com","name":"kbrown@intralinks.com","key":"kbrown@intralinks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Brown","active":true,"timeZone":"Etc/UTC"},"created":"2010-11-24T14:29:23.617+0000","updated":"2010-11-24T14:29:23.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483898/comment/12978302","id":"12978302","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dcheckoway","name":"dcheckoway","key":"dcheckoway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Checkoway","active":true,"timeZone":"Etc/UTC"},"body":"Any resolution to this, or at least an understanding of the cause?  We're seeing the same issue with 5.4.2.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dcheckoway","name":"dcheckoway","key":"dcheckoway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Checkoway","active":true,"timeZone":"Etc/UTC"},"created":"2011-01-06T12:56:39.240+0000","updated":"2011-01-06T12:56:39.240+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483898/comment/12978344","id":"12978344","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbrown%40intralinks.com","name":"kbrown@intralinks.com","key":"kbrown@intralinks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Brown","active":true,"timeZone":"Etc/UTC"},"body":"There has been no resolution.  We shifted to use kahadb as some of the issues we had with that were fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kbrown%40intralinks.com","name":"kbrown@intralinks.com","key":"kbrown@intralinks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Brown","active":true,"timeZone":"Etc/UTC"},"created":"2011-01-06T14:43:49.762+0000","updated":"2011-01-06T14:43:49.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483898/comment/13253161","id":"13253161","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"downgraded this to minor - because we don't recommend AMQStore anymore  - KahaDB is the default","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2012-04-13T06:19:36.581+0000","updated":"2012-04-13T06:19:36.581+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12483898/comment/13526826","id":"13526826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"As of v5.8.0 the older AMQ and Kaha stores are deprecated and moving to KahaDB or levelDB is the best way to go. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2012-12-07T22:21:35.885+0000","updated":"2012-12-07T22:21:35.885+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3051/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0eb53:"}}