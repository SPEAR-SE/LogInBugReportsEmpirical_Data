{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12482699","self":"https://issues.apache.org/jira/rest/api/2/issue/12482699","key":"AMQ-1629","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315620","id":"12315620","description":"","name":"5.3.0","archived":false,"released":true,"releaseDate":"2009-10-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-04-09T11:08:54.677+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat May 23 07:50:01 UTC 2009","customfield_12310420":"84515","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1714284780_*|*_5_*:*_2_*:*_16247860346_*|*_4_*:*_1_*:*_19077806016","customfield_12312321":null,"resolutiondate":"2009-05-23T07:50:01.042+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1629/watchers","watchCount":0,"isWatching":false},"created":"2008-03-20T14:57:29.900+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315614","id":"12315614","description":"","name":"4.1.1","archived":false,"released":true,"releaseDate":"2007-06-08"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315617","id":"12315617","description":"","name":"5.0.0","archived":false,"released":true,"releaseDate":"2007-12-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-05-23T07:50:01.041+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313892","id":"12313892","name":"Broker"}],"timeoriginalestimate":null,"customfield_12310080":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10091","value":"Regression","id":"10091"}],"description":"Version: 5.0 \n\nWe have a simple setup to test excludedDestinations config ...We are using the broker and  example producer & consumer from the binary distribution (broker instances A & B are on different hosts \n\nSetup: \n\nproducer --- A ---- B--- consumer \n\nBroker A's activemq.xml has the following for NC config (everythingelse is the same as in the orig config file):\n\n    <networkConnectors> \n      <networkConnector name=\"toB\" uri=\"static://(tcp://B.foo.com:61616)\"> \n           <excludedDestinations> \n                <queue physicalName=\"TEST.>\" /> \n           </excludedDestinations> \n     </networkConnector> \n    </networkConnectors> \n\nIssue: consumer attached to Broker B sees all the messages sent to TEST.FOO (the default messages generated by the producer)\n\nWe noticed that none of the queue or topic wildcards work, only specific topic or queue names work in the exclusion. However, http://activemq.apache.org/networks-of-brokers.html states \"N.B. You can use wildcards in inclusive , exclusive destination properties\". Are we missing anything ? \n\nThanks \n- Sridhar\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12460926","id":"12460926","filename":"amq1629.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"created":"2008-03-27T20:39:23.398+0000","size":1604,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12460926/amq1629.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461283","id":"12461283","filename":"DemandForwardingBridgeFilterTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=moczarski","name":"moczarski","key":"moczarski","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Swen Moczarski","active":true,"timeZone":"Etc/UTC"},"created":"2009-02-08T14:52:33.787+0000","size":7762,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461283/DemandForwardingBridgeFilterTest.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12461350","id":"12461350","filename":"DemandForwardingBridgeSupport.java.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=moczarski","name":"moczarski","key":"moczarski","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Swen Moczarski","active":true,"timeZone":"Etc/UTC"},"created":"2009-02-08T14:52:33.703+0000","size":2837,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12461350/DemandForwardingBridgeSupport.java.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"161820","customfield_12312823":null,"summary":"wildcards don't work in networkconnector excludeDestinations ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"linux","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482699/comment/12939412","id":"12939412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"body":"I did a little investigation and the problem appears to be here:\n\nDemandForwardingBridgeSupport.java:\n    protected boolean isPermissableDestination(ActiveMQDestination destination) {\n        // Are we not bridging temp destinations?\n        if (destination.isTemporary() && !configuration.isBridgeTempDestinations()) {\n            return false;\n        }\n\n       A****  DestinationFilter filter = DestinationFilter.parseFilter(destination);\n        ActiveMQDestination[] dests = excludedDestinations;\n        if (dests != null && dests.length > 0) {\n            for (int i = 0; i < dests.length; i++) {\n                ActiveMQDestination match = dests[i];\n                if (match != null && filter.matches(match)) {\n                    return false;\n                }\n            }\n      }\n\nThe DestinationFilter returned (A above) is SimpleDestinationFilter because the destination (TEST.FOO) is \"simple\" ==> filter.matches tries to string comparison eventually( TEST.FOO with TEST.>) and does not match it.\n        \n I am not very familiar with the code, but shouldn't  the DestinationFilter reflect wildcard/prefix in either excludedDestination or the queue/topic destination ? \nThanks\n- Sridhar\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"created":"2008-03-20T22:51:02.077+0000","updated":"2008-03-20T22:51:02.077+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482699/comment/12939419","id":"12939419","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"body":"I am attaching a  patch that works with  prefixes in the excluded & included destinations. Please review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=komandur","name":"komandur","key":"komandur","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sridhar Komandur","active":true,"timeZone":"Etc/UTC"},"created":"2008-03-27T20:38:24.165+0000","updated":"2008-03-27T20:38:24.165+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482699/comment/12939451","id":"12939451","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Patch applied in svn revision 646268","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2008-04-09T11:08:54.677+0000","updated":"2008-04-09T11:08:54.677+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482699/comment/12940330","id":"12940330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joef","name":"joef","key":"joef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joe Fernandez","active":true,"timeZone":"America/New_York"},"body":"If you have something like this, all messages get excluded; no matter their destination's name.\n\n<excludedDestinations>       \n    <queue physicalName=\"fubar.>\"/>     \n    <topic physicalName=\"fubar.>\"/>         \n</excludedDestinations>     \n\nHowever, if you change it slightly like this (just took out the 'r' in one of them), then things seem to work.\n\n<excludedDestinations>       \n     <queue physicalName=\"fubar.>\"/>     \n      <topic physicalName=\"fuba.>\"/>         \n</excludedDestinations>     \n\nIf there are no dots things seem to also work.\n \nBottom line is that this needs more attention and more thorough testing. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joef","name":"joef","key":"joef","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joe Fernandez","active":true,"timeZone":"America/New_York"},"created":"2008-10-14T12:26:34.949+0000","updated":"2008-10-14T12:26:34.949+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482699/comment/12940749","id":"12940749","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=moczarski","name":"moczarski","key":"moczarski","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Swen Moczarski","active":true,"timeZone":"Etc/UTC"},"body":"I see two problems with the current implementation (version 5.2)  for excluded- and dynamically-included destinations:\n\n1. The type of the destination (queue, topic) is not distincted:\n{code:xml}\n<excludedDestinations>  \n   <topic physicalName=\">\"/>  \n</excludedDestinations>\n{code}\nOnly topics should be excluded but all queues are also excluded.\n\n2. An entry with a wildcard in the list has a side-effect on the following entries:\n{code:xml}\n<excludedDestinations>\n   <queue physicalName=\"exclude\"/>\n</excludedDestinations>\n<dynamicallyIncludedDestinations>\n   <queue physicalName=\"foo.>\"/>\n   <queue physicalName=\"bar.x\"/>\n</dynamicallyIncludedDestinations>\n{code} \nA message to {{bar.x}} will be blocked because of the wildcard in the first entry.\n\nI've created a test case and a new patch. I would be happy for a review of test case and patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=moczarski","name":"moczarski","key":"moczarski","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Swen Moczarski","active":true,"timeZone":"Etc/UTC"},"created":"2009-02-08T14:52:33.792+0000","updated":"2009-02-08T14:52:33.792+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12482699/comment/12941364","id":"12941364","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"body":"Fixed by SVN revision 777821","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajdavies","name":"rajdavies","key":"rajdavies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rajdavies&avatarId=13942","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rajdavies&avatarId=13942","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rajdavies&avatarId=13942","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rajdavies&avatarId=13942"},"displayName":"Rob Davies","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-23T07:50:01.037+0000","updated":"2009-05-23T07:50:01.037+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-1629/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0s24f:"}}