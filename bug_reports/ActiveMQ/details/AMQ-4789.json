{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12672632","self":"https://issues.apache.org/jira/rest/api/2/issue/12672632","key":"AMQ-4789","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2013-10-07T21:19:14.713+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jun 24 19:41:37 UTC 2014","customfield_12310420":"352255","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_22467589577_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-06-24T16:25:57.137+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4789/watchers","watchCount":4,"isWatching":false},"created":"2013-10-07T15:26:07.617+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["leak"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323282","id":"12323282","description":"Maintenance release with new AMQP support and smaller modules","name":"5.8.0","archived":false,"released":true,"releaseDate":"2013-02-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-06-24T19:41:37.101+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313904","id":"12313904","name":"JMX","description":"The JMX support in ActiveMQ"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"When activemq is configured with an amqp transport and SSL, and where clients make short lived polled connections to the queue, a slow leak exists that kills the server within about 12 hours or so (for us) with the following:\n\njava.lang.OutOfMemoryError: GC overhead limit exceeded\n\nObtaining a heap dump in this state reveals that about 3/4 of our heap is used by the org.apache.activemq.broker.jmx.ManagedTransportConnection as per the attached screenshots.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12607165","id":"12607165","filename":"activemq-leak.tiff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-07T15:27:00.398+0000","size":96862,"mimeType":"image/tiff","content":"https://issues.apache.org/jira/secure/attachment/12607165/activemq-leak.tiff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12607164","id":"12607164","filename":"activemq-leak-detail.tiff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-07T15:27:00.394+0000","size":150892,"mimeType":"image/tiff","content":"https://issues.apache.org/jira/secure/attachment/12607164/activemq-leak-detail.tiff"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"352543","customfield_12312823":null,"summary":"Slow leak: org.apache.activemq.broker.jmx.ManagedTransportConnection","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"INFO   | jvm 1    | 2013/10/07 10:17:29 | Java Runtime: Sun Microsystems Inc. 1.6.0_24 /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0.x86_64/jre\nINFO   | jvm 1    | 2013/10/07 10:17:29 |   Heap sizes: current=83008k  free=78872k  max=4190080k\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/13788216","id":"13788216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"body":"Screenshots from Eclipse MAT showing leaked objects.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-07T15:27:00.401+0000","updated":"2013-10-07T15:27:00.401+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/13788587","id":"13788587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"is it possible to validate a 5.9 snapshot?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-07T21:19:14.713+0000","updated":"2013-10-07T21:19:14.713+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/13789476","id":"13789476","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"body":"5.9-SNAPSHOT can only be used with difficulty in our case.\n\nWe tried to switch the backend database from kahaDB to levelDB (as kahaDB appeared as one of the objects that was leaking the above objects) but no difference.\n\nWe cannot keep v5.8.0 up and running for more than a few hours at a time, and each time activemq hits the wall it loses all trace of messages processed, leaving us at an earlier state being forced to process messages again from scratch. Activemq is fatally broken in its current form.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-08T18:23:28.764+0000","updated":"2013-10-08T18:23:28.764+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/13789589","id":"13789589","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"body":"can you provide a simple test case so we can easily reproduce? \n\nlosing state of processed messages seems to be unrelated to a memory leak. There is something else going on here.\n\nA junit test case is ideal, find some inspiration at: https://github.com/apache/activemq/blob/trunk/activemq-amqp/src/test/java/org/apache/activemq/transport/amqp/AmqpSslTest.java\n\nIf we can easily reproduce we can easily help :-)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gtully","name":"gtully","key":"gtully","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gary Tully","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-08T19:37:02.058+0000","updated":"2013-10-08T19:37:02.058+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/13789624","id":"13789624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"body":"Obviously if we could reproduce it easily it would help, but we're seeing this manifest itself on a live system after running for many hours, so no we don't have a test case.\n\nTo explain the losing state, the leak eventually causes an out of memory condition, which causes garbage collection to take forever, in turn triggering the \"kill -9\" behaviour of the java service wrapper, in turn causing the loss of data.\n\nI have a 2.6GB heap file and can run various reports on it to show the objects being leaked.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"created":"2013-10-08T20:07:03.117+0000","updated":"2013-10-08T20:07:03.117+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/14042320","id":"14042320","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"No test provided.  Many fixes in the AMQP area since 5.8.0 so we'd need some sort of test to validate whether there is still some issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2014-06-24T16:25:57.165+0000","updated":"2014-06-24T16:25:57.165+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12672632/comment/14042580","id":"14042580","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"body":"Sorry, we dropped activemq completely a few days after raising this, we just couldn't get it to work reliably at all.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minfrin","name":"minfrin","key":"minfrin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Graham Leggett","active":true,"timeZone":"Etc/UTC"},"created":"2014-06-24T19:41:37.101+0000","updated":"2014-06-24T19:41:37.101+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-4789/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1oqef:"}}