{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12520602","self":"https://issues.apache.org/jira/rest/api/2/issue/12520602","key":"AMQ-3478","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311210","id":"12311210","key":"AMQ","name":"ActiveMQ","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311210&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311210&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311210&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311210&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11160","id":"11160","description":"ActiveMQ","name":"ActiveMQ"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/4","id":"4","description":"The problem is not completely described.","name":"Incomplete"},"customfield_12312322":null,"customfield_12310220":"2011-08-29T17:54:08.780+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Sep 30 15:08:19 UTC 2011","customfield_12310420":"41539","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2757833402_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-09-30T15:08:19.780+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3478/watchers","watchCount":0,"isWatching":false},"created":"2011-08-29T17:04:26.504+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315625","id":"12315625","description":"","name":"5.4.2","archived":false,"released":true,"releaseDate":"2010-12-02"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-09-30T15:08:19.900+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313903","id":"12313903","name":"Transport"}],"timeoriginalestimate":null,"customfield_12310080":null,"description":"We're having a consistent problem using the HTTP transport on a machine hosted on the internet and accessed through a firewall. Tests using a client on same machine work. Tests in a private network with or without firewall work. Only part of our application is having problems, i.e., we can login to the app on the hosted machine and open a project; opening a larger dataset chunk-wise fails apparently due to activity timeout. Our message payload is serialized Java object graphs.\n\nHave tried following:\n1. setting wireFormat.maxInactivityDuration=0 (illegal param w/HTTP)\n2. upping all socket timeouts to 30000\n3. enabling TimeStampingBrokerPlugin\n\nFrom what we can see in the logs, in the remote case, the client sends several messages to fetch chunks of the large dataset which never arrive. \nOne thing we noticed in the activemq logs is a lot of removing and re-adding consumers. Not sure if that is a sign of a problem.\n\nHere is a bit of the server log. The message jrflap-50115-1314636017162-1:1:3:17:1, came from the client asking for the chunk, and the server appears to send it, but the client logs has nothing.\n\nbegin server log snipit>>>>>>>>>>>>>>\n\n2011-08-29 12:43:48,527 [qtp17691874-97 ] - DEBUG TimeStampingBrokerPlugin       - Set message ID:jrflap-50115-1314636017162-1:1:3:17:1 timestamp from 1314636216258 to 1314639828527\n2011-08-29 12:43:48,527 [Thread-33      ] - TRACE ActiveMQMessageConsumer        - ID:leonardo-50364-1314639588973-3:1:2:38 received message: MessageDispatch {commandId = 0, responseRequired = false, consumerId = ID:leonardo-50364-1314639588973-3:1:2:38, destination = temp-topic://ID:leonardo-50364-1314639588973-3:1:1, message = ActiveMQTextMessage {commandId = 97, responseRequired = true, messageId = ID:jrflap-50115-1314636017162-1:1:3:17:1, originalDestination = null, originalTransactionId = null, producerId = ID:jrflap-50115-1314636017162-1:1:3:17, destination = temp-topic://ID:leonardo-50364-1314639588973-3:1:1, transactionId = null, expiration = 0, timestamp = 1314639828527, arrival = 0, brokerInTime = 1314639828527, brokerOutTime = 1314639828527, correlationId = null, replyTo = null, persistent = true, type = null, priority = 4, groupID = null, groupSequence = 0, targetConsumerId = null, compressed = false, userID = null, content = null, marshalledProperties = null, dataStructure = null, redeliveryCounter = 0, size = 1024, properties = {status=1}, readOnlyProperties = true, readOnlyBody = true, droppable = false, text = null}, redeliveryCounter = 0}\n2011-08-29 12:43:48,543 [Thread-33      ] - DEBUG ActiveMQMessageConsumer        - remove: ID:leonardo-50364-1314639588973-3:1:2:38, lastDeliveredSequenceId:640\n2011-08-29 12:43:48,558 [qtp17691874-20 ] - DEBUG AbstractRegion                 - localhost removing consumer: ID:leonardo-50364-1314639588973-3:1:2:38 for destination: temp-topic://ID:leonardo-50364-1314639588973-3:1:1\n2011-08-29 12:43:49,369 [host] Scheduler] - DEBUG Queue                          - Expiring messages ..\n2011-08-29 12:43:49,369 [host] Scheduler] - DEBUG Queue                          - TEST.QUEUE toPageIn: 0, Inflight: 0, pagedInMessages.size 0, enqueueCount: 0, dequeueCount: 0\n2011-08-29 12:43:49,369 [host] Scheduler] - TRACE AbstractStoreCursor            - fillBatch - batchResetNeeded=false, hasMessages=false, size=0\n2011-08-29 12:43:49,369 [host] Scheduler] - TRACE AbstractStoreCursor            - fillBatch - batchResetNeeded=false, hasMessages=false, size=0\n2011-08-29 12:43:49,385 [host] Scheduler] - DEBUG Queue                          - Expiring messages ..\n2011-08-29 12:43:49,385 [host] Scheduler] - DEBUG Queue                          - TEST.QUEUE toPageIn: 0, Inflight: 0, pagedInMessages.size 0, enqueueCount: 0, dequeueCount: 0\n2011-08-29 12:43:49,385 [host] Scheduler] - TRACE AbstractStoreCursor            - fillBatch - batchResetNeeded=false, hasMessages=false, size=0\n2011-08-29 12:43:49,385 [host] Scheduler] - TRACE AbstractStoreCursor            - fillBatch - batchResetNeeded=false, hasMessages=false, size=0\n2011-08-29 12:43:49,666 [itor WriteCheck] - DEBUG InactivityMonitor              - 10000 ms elapsed since last write check.\n2011-08-29 12:43:49,666 [itor WriteCheck] - TRACE InactivityMonitor              - Message sent since last write check, resetting flag\n2011-08-29 12:43:50,009 [itor WriteCheck] - DEBUG InactivityMonitor              - 10000 ms elapsed since last write check.\n2011-08-29 12:43:50,009 [itor WriteCheck] - TRACE InactivityMonitor              - Message sent since last write check, resetting flag\n2011-08-29 12:43:50,508 [itor WriteCheck] - DEBUG InactivityMonitor              - 9999 ms elapsed since last write check.\n2011-08-29 12:43:50,508 [itor WriteCheck] - TRACE InactivityMonitor              - Message sent since last write check, resetting flag\n2011-08-29 12:43:50,508 [nitor ReadCheck] - DEBUG InactivityMonitor              - 29999 ms elapsed since last read check.\n2011-08-29 12:43:50,508 [nitor ReadCheck] - TRACE InactivityMonitor              - Message received since last read check, resetting flag: \n2011-08-29 12:43:50,602 [itor WriteCheck] - DEBUG InactivityMonitor              - 10000 ms elapsed since last write check.\n2011-08-29 12:43:50,602 [itor WriteCheck] - TRACE InactivityMonitor              - Message sent since last write check, resetting flag\n2011-08-29 12:43:50,602 [nitor ReadCheck] - DEBUG InactivityMonitor              - 29999 ms elapsed since last read check.\n2011-08-29 12:43:50,602 [nitor ReadCheck] - TRACE InactivityMonitor              - A receive is in progress\n2011-08-29 12:43:51,007 [qtp17691874-97 ] - DEBUG TimeStampingBrokerPlugin       - Set message ID:jrflap-50115-1314636017162-1:1:1:2:1 timestamp from 1314636218740 to 1314639831007\n2011-08-29 12:43:51,007 [MQ Session Task] - TRACE ActiveMQSession                - ID:leonardo-50364-1314639588973-3:1:3 sending message: ActiveMQTextMessage {commandId = 0, responseRequired = false, messageId = ID:leonardo-50364-1314639588973-3:1:3:1:3, originalDestination = null, originalTransactionId = null, producerId = ID:leonardo-50364-1314639588973-3:1:3:1, destination = topic://GPDCommunity.LGMDR_LIST, transactionId = null, expiration = 0, timestamp = 1314639831007, arrival = 0, brokerInTime = 0, brokerOutTime = 0, correlationId = null, replyTo = null, persistent = true, type = null, priority = 4, groupID = null, groupSequence = 0, targetConsumerId = null, compressed = false, userID = null, content = null, marshalledProperties = null, dataStructure = null, redeliveryCounter = 0, size = 0, properties = {type=9}, readOnlyProperties = true, readOnlyBody = true, droppable = false, text = user1}\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310041":null,"customfield_12310921":null,"customfield_12310920":"172265","customfield_12312823":null,"summary":"HTTP protocol w/remote client dropping large messages","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jflowers","name":"jflowers","key":"jflowers","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jim Flowers","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jflowers","name":"jflowers","key":"jflowers","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jim Flowers","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows Server 2008 (server) on internet, port 4001 open thru Windows Firewall, Win7 client home network wireless","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12520602/comment/13093015","id":"13093015","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"A JUnit test case reproducing the problem would help in getting someone to look into this.  You might also want to try the newer version or a 5.6-SNAPSHOT build to see if the problem has already been addressed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-08-29T17:54:08.780+0000","updated":"2011-08-29T17:54:08.780+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12520602/comment/13093125","id":"13093125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jflowers","name":"jflowers","key":"jflowers","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jim Flowers","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\n\nThanks for the quick reply. I'll look at the changelist for 5.5, but just moved to 5.4.2 for same reason to no effect. Coming up with a unit test to expose the error would be hard given our code, but not impossible. First, could we get some feedback from others who worked on the HTTP transport to see if this rings a bell? Clearly similar issues have been discussed w.r.t. TCP dropping large messages. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jflowers","name":"jflowers","key":"jflowers","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jim Flowers","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-29T19:32:25.939+0000","updated":"2011-08-29T19:32:25.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12520602/comment/13118122","id":"13118122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"body":"Need a unit test to reproduce the issue, current tests all pass.  No other reports of this problem so far so a working test would be key to figuring out if there's an issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tabish121","name":"tabish121","key":"tabish121","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tabish121&avatarId=25249","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tabish121&avatarId=25249","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tabish121&avatarId=25249","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tabish121&avatarId=25249"},"displayName":"Timothy Bish","active":true,"timeZone":"America/Havana"},"created":"2011-09-30T15:08:19.818+0000","updated":"2011-09-30T15:08:19.818+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/AMQ-3478/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tulb:"}}