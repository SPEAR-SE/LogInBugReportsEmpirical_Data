[The patch works fine for me.

https://github.com/apache/storm/pull/1531, GitHub user wangperry opened a pull request:

    https://github.com/apache/storm/pull/1530

    STORM-1937 Fix WindowTridentProcessor cause NullPointerException

    I'm working with trident and try to use windows support, under the local model is fine, but in distributed mode we got the NullPointerException

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/wangperry/storm-1 1.0.x-branch

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/1530.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #1530
    
----
commit 895061868d86339f9e6bd33b81685903db06f510
Author: Xin Wang <best.wangxin@163.com>
Date:   2016-03-27T15:02:23Z

    remove flux gitignore

commit bf99ae51019c53135cbc23c7465440fc63b1299a
Author: Robert (Bobby) Evans <evans@yahoo-inc.com>
Date:   2016-03-29T16:10:55Z

    Merge branch 'ras_refactor' of https://github.com/jerrypeng/storm into STORM-1634
    
    STORM-1634: Refactoring of Resource Aware Scheduler

commit 20ba5189fdf8cc5894f163a21c194501de69542d
Author: Robert (Bobby) Evans <evans@yahoo-inc.com>
Date:   2016-03-29T16:11:28Z

    Added STORM-1634 to Changelog

commit aeb4b9d55c68bf62761831baae9d5df49e0ab99a
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-03-30T19:49:35Z

    Merge branch 'STORM-1660-1.x' of github.com:vesense/storm into 1.x-branch

commit 652d2f6eb9315a8605cbc51a3f98adc9aa13271c
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-03-30T19:50:34Z

    add STORM-1660 to changelog

commit c54162418a4a46d99ac360661f78cc5e10cb654a
Author: zhuol <zhuol@yahoo-inc.com>
Date:   2016-03-30T22:21:41Z

    [STORM-1667] Log the IO exception when deleting worker pid dir

commit be09c3c1fd05ec1ed8f8d7768c4023691946d0e2
Author: Priyank <pshah@hortonworks.com>
Date:   2016-03-30T23:23:05Z

    STORM-1668: Fix silent failing of flux for setting a non-existent property.

commit 3354cc7369a494ef9645df08d0803dedfb3d9192
Author: Roshan Naik <roshan@hortonworks.com>
Date:   2016-03-30T23:30:43Z

    Enable/disable Debug button on UI if eventloggers are enabled. Also show tooltip on Debug button

commit 81997ece6422d2b80ef02b86521772276debc03f
Author: Xin Wang <best.wangxin@163.com>
Date:   2016-03-31T04:30:35Z

    STORM-1669: Fix SolrUpdateBolt flush bug

commit bd6f2b06e81b7aa296615b4541cffba9655bcd86
Author: vesense <best.wangxin@163.com>
Date:   2016-03-17T12:51:51Z

    STORM-1573: Add batch support for MongoInsertBolt

commit fac10d78e65053e416f5d85378971a3a4f2dcafe
Author: Jungtaek Lim <kabhwan@gmail.com>
Date:   2016-03-31T05:46:41Z

    Merge branch 'STORM-1573-1.x' of https://github.com/vesense/storm into STORM-1573-1.x

commit 0e4af514d786cd8d8ad5411405de34ed07ea436a
Author: Jungtaek Lim <kabhwan@gmail.com>
Date:   2016-03-31T05:47:16Z

    add STORM-1573 to CHANGELOG.md

commit 12c504e7222183d33f52b1b3cad9a62839f8b405
Author: Satish Duggana <sduggana@hortonworks.com>
Date:   2016-03-28T07:18:40Z

    STORM-1652 Added trident windowing API documentation to Trident API doc.

commit fe50a1b558ae1ccf28854a344062a52998096840
Author: Satish Duggana <sduggana@hortonworks.com>
Date:   2016-03-29T04:42:50Z

    STORM-1652 Addressed review comments

commit b3b934a777e6a2f1ec505e63336c12549cd949c1
Author: zhuol <zhuol@yahoo-inc.com>
Date:   2016-03-31T16:12:25Z

    Back to ignore all exception

commit 7d7b3c2086a0172757af4bfc2a1a9dd9feee696c
Author: Roshan Naik <roshan@hortonworks.com>
Date:   2016-04-01T01:16:52Z

    Showing tooltip on Debug button only when disabled and event loggers are disabled. Also enable/disable of Debug button along with toltip in component page

commit f2809b4d47489f4ebef08d3b00948dac11c60def
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T02:49:48Z

    Merge branch 'STORM-1668-1.x' of https://github.com/priyank5485/storm into 1.x-branch

commit 97e7d25fe5e94f6e5dca93ad2826835db878877b
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T03:01:38Z

    Adding STORM-1668 to CHANGELOG.md

commit dd3d0b2000c41b587cb22ecf16ddfd971c0c1d00
Author: Jungtaek Lim <kabhwan@gmail.com>
Date:   2016-04-01T03:25:48Z

    STORM-1673 log4j2/worker.xml refers old package of LoggerMetricsConsumer
    
    * fix missing package changes

commit 0747c7c4178a9db30027ad3234cadc2fcd468f74
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T05:01:10Z

    Merge branch 'STORM-1669-1.x' of github.com:vesense/storm into 1.x-branch

commit 11f23153a911c5bad945740ebdf262f16630532a
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T05:02:20Z

    add STORM-1669 to changelog

commit de719aa19d0808690751edade4d7907c96ab723a
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T15:10:28Z

    Merge branch 'Storm-1667-1.x-branch' of https://github.com/zhuoliu/storm into 1.x-branch

commit dc006daae603f971535967365fd5ecb5151b3607
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T15:11:43Z

    Putting STORM-1667 in CHANGELOG.md

commit b15e6ab79a671590b878530b9734233d3a77f59b
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:35:54Z

    Merge branch 'STORM-1632' of github.com:roshannaik/storm into 1.x-branch

commit 3d19c644fd0f6310743279aa8b57da5e2500fa48
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:36:55Z

    add STORM-1632 to changelog

commit f574f3800b34b17ea25fa9393ae57989cdc43a17
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:58:20Z

    Merge branch 'STORM-1673-1.x' of github.com:HeartSaVioR/storm into 1.x-branch

commit 45b7ecac3b11fc147fa9efe060d6cadb20a55862
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:59:37Z

    add STORM-1673 to changelog

commit d988d44e4d571428a270e7585341cc8af0943335
Author: Hugo Louro <hmclouro@gmail.com>
Date:   2015-12-14T18:16:42Z

    STORM-822: Kafka Spout New Consumer API
    
    Signed-off-by: P. Taylor Goetz <ptgoetz@gmail.com>

commit 9d9d142791aab04a19cafd5f32f1155458feb3ee
Author: Hugo Louro <hmclouro@gmail.com>
Date:   2016-03-21T21:42:50Z

    STORM-822: Kafka Spout New Consumer API - Refactored code to avoid keeping records data inside spout state - Refactored code to specify output fields per stream and build tuples per topic - Implement exponential backoff retry strategy - Send one tuple per call to nextTuple
    
    Signed-off-by: P. Taylor Goetz <ptgoetz@gmail.com>

commit cf9f837e8689be8eda7e6baea7ed8bf8c88c7370
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T18:41:44Z

    add commons-cli version to pom

----
, Github user wangperry closed the pull request at:

    https://github.com/apache/storm/pull/1530
, GitHub user wangperry reopened a pull request:

    https://github.com/apache/storm/pull/1530

    STORM-1937 Fix WindowTridentProcessor cause NullPointerException

    I'm working with trident and try to use windows support, under the local model is fine, but in distributed mode we got the NullPointerException

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/wangperry/storm-1 1.0.x-branch

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/1530.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #1530
    
----
commit 895061868d86339f9e6bd33b81685903db06f510
Author: Xin Wang <best.wangxin@163.com>
Date:   2016-03-27T15:02:23Z

    remove flux gitignore

commit bf99ae51019c53135cbc23c7465440fc63b1299a
Author: Robert (Bobby) Evans <evans@yahoo-inc.com>
Date:   2016-03-29T16:10:55Z

    Merge branch 'ras_refactor' of https://github.com/jerrypeng/storm into STORM-1634
    
    STORM-1634: Refactoring of Resource Aware Scheduler

commit 20ba5189fdf8cc5894f163a21c194501de69542d
Author: Robert (Bobby) Evans <evans@yahoo-inc.com>
Date:   2016-03-29T16:11:28Z

    Added STORM-1634 to Changelog

commit aeb4b9d55c68bf62761831baae9d5df49e0ab99a
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-03-30T19:49:35Z

    Merge branch 'STORM-1660-1.x' of github.com:vesense/storm into 1.x-branch

commit 652d2f6eb9315a8605cbc51a3f98adc9aa13271c
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-03-30T19:50:34Z

    add STORM-1660 to changelog

commit c54162418a4a46d99ac360661f78cc5e10cb654a
Author: zhuol <zhuol@yahoo-inc.com>
Date:   2016-03-30T22:21:41Z

    [STORM-1667] Log the IO exception when deleting worker pid dir

commit be09c3c1fd05ec1ed8f8d7768c4023691946d0e2
Author: Priyank <pshah@hortonworks.com>
Date:   2016-03-30T23:23:05Z

    STORM-1668: Fix silent failing of flux for setting a non-existent property.

commit 3354cc7369a494ef9645df08d0803dedfb3d9192
Author: Roshan Naik <roshan@hortonworks.com>
Date:   2016-03-30T23:30:43Z

    Enable/disable Debug button on UI if eventloggers are enabled. Also show tooltip on Debug button

commit 81997ece6422d2b80ef02b86521772276debc03f
Author: Xin Wang <best.wangxin@163.com>
Date:   2016-03-31T04:30:35Z

    STORM-1669: Fix SolrUpdateBolt flush bug

commit bd6f2b06e81b7aa296615b4541cffba9655bcd86
Author: vesense <best.wangxin@163.com>
Date:   2016-03-17T12:51:51Z

    STORM-1573: Add batch support for MongoInsertBolt

commit fac10d78e65053e416f5d85378971a3a4f2dcafe
Author: Jungtaek Lim <kabhwan@gmail.com>
Date:   2016-03-31T05:46:41Z

    Merge branch 'STORM-1573-1.x' of https://github.com/vesense/storm into STORM-1573-1.x

commit 0e4af514d786cd8d8ad5411405de34ed07ea436a
Author: Jungtaek Lim <kabhwan@gmail.com>
Date:   2016-03-31T05:47:16Z

    add STORM-1573 to CHANGELOG.md

commit 12c504e7222183d33f52b1b3cad9a62839f8b405
Author: Satish Duggana <sduggana@hortonworks.com>
Date:   2016-03-28T07:18:40Z

    STORM-1652 Added trident windowing API documentation to Trident API doc.

commit fe50a1b558ae1ccf28854a344062a52998096840
Author: Satish Duggana <sduggana@hortonworks.com>
Date:   2016-03-29T04:42:50Z

    STORM-1652 Addressed review comments

commit b3b934a777e6a2f1ec505e63336c12549cd949c1
Author: zhuol <zhuol@yahoo-inc.com>
Date:   2016-03-31T16:12:25Z

    Back to ignore all exception

commit 7d7b3c2086a0172757af4bfc2a1a9dd9feee696c
Author: Roshan Naik <roshan@hortonworks.com>
Date:   2016-04-01T01:16:52Z

    Showing tooltip on Debug button only when disabled and event loggers are disabled. Also enable/disable of Debug button along with toltip in component page

commit f2809b4d47489f4ebef08d3b00948dac11c60def
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T02:49:48Z

    Merge branch 'STORM-1668-1.x' of https://github.com/priyank5485/storm into 1.x-branch

commit 97e7d25fe5e94f6e5dca93ad2826835db878877b
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T03:01:38Z

    Adding STORM-1668 to CHANGELOG.md

commit dd3d0b2000c41b587cb22ecf16ddfd971c0c1d00
Author: Jungtaek Lim <kabhwan@gmail.com>
Date:   2016-04-01T03:25:48Z

    STORM-1673 log4j2/worker.xml refers old package of LoggerMetricsConsumer
    
    * fix missing package changes

commit 0747c7c4178a9db30027ad3234cadc2fcd468f74
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T05:01:10Z

    Merge branch 'STORM-1669-1.x' of github.com:vesense/storm into 1.x-branch

commit 11f23153a911c5bad945740ebdf262f16630532a
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T05:02:20Z

    add STORM-1669 to changelog

commit de719aa19d0808690751edade4d7907c96ab723a
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T15:10:28Z

    Merge branch 'Storm-1667-1.x-branch' of https://github.com/zhuoliu/storm into 1.x-branch

commit dc006daae603f971535967365fd5ecb5151b3607
Author: Kyle Nusbaum <kylejnusbaum@gmail.com>
Date:   2016-04-01T15:11:43Z

    Putting STORM-1667 in CHANGELOG.md

commit b15e6ab79a671590b878530b9734233d3a77f59b
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:35:54Z

    Merge branch 'STORM-1632' of github.com:roshannaik/storm into 1.x-branch

commit 3d19c644fd0f6310743279aa8b57da5e2500fa48
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:36:55Z

    add STORM-1632 to changelog

commit f574f3800b34b17ea25fa9393ae57989cdc43a17
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:58:20Z

    Merge branch 'STORM-1673-1.x' of github.com:HeartSaVioR/storm into 1.x-branch

commit 45b7ecac3b11fc147fa9efe060d6cadb20a55862
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T16:59:37Z

    add STORM-1673 to changelog

commit d988d44e4d571428a270e7585341cc8af0943335
Author: Hugo Louro <hmclouro@gmail.com>
Date:   2015-12-14T18:16:42Z

    STORM-822: Kafka Spout New Consumer API
    
    Signed-off-by: P. Taylor Goetz <ptgoetz@gmail.com>

commit 9d9d142791aab04a19cafd5f32f1155458feb3ee
Author: Hugo Louro <hmclouro@gmail.com>
Date:   2016-03-21T21:42:50Z

    STORM-822: Kafka Spout New Consumer API - Refactored code to avoid keeping records data inside spout state - Refactored code to specify output fields per stream and build tuples per topic - Implement exponential backoff retry strategy - Send one tuple per call to nextTuple
    
    Signed-off-by: P. Taylor Goetz <ptgoetz@gmail.com>

commit cf9f837e8689be8eda7e6baea7ed8bf8c88c7370
Author: P. Taylor Goetz <ptgoetz@gmail.com>
Date:   2016-04-01T18:41:44Z

    add commons-cli version to pom

----
, Github user wangperry closed the pull request at:

    https://github.com/apache/storm/pull/1530
, GitHub user wangperry opened a pull request:

    https://github.com/apache/storm/pull/1531

    STORM-1937 Fix WindowTridentProcessor cause NullPointerException

    I'm working with trident and try to use windows support, under the local model is fine, but in distributed mode we got the NullPointerException

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/wangperry/storm-1 1.0.x-branch

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/1531.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #1531
    
----
commit 2d18e893d5b5a883ffbd441ef7a1a6117e33568b
Author: wangperry <339359521@163.com>
Date:   2016-06-30T10:51:08Z

    Update WindowTridentProcessor.java
    
    STORM-1937

commit b15492ead9def496ee5e5db255ac4eff4a411079
Author: wangperry <339359521@163.com>
Date:   2016-06-30T11:38:20Z

    Merge pull request #1 from wangperry/wangperry-patch-1
    
    Fix WindowTridentProcessor cause NullPointerException

----
, [~perryWang] Pl let me know if you want to raise PR to resolve the issue. , Github user satishd commented on a diff in the pull request:

    https://github.com/apache/storm/pull/1531#discussion_r69145885
  
    --- Diff: storm-core/src/jvm/org/apache/storm/trident/windowing/WindowTridentProcessor.java ---
    @@ -163,11 +163,14 @@ public void finishBatch(ProcessorContext processorContext) {
             Iterable<Object> triggerValues = null;
     
             if (retriedAttempt(batchId)) {
    -            pendingTriggerIds = (List<Integer>) windowStore.get(inprocessTriggerKey(batchTxnId));
    -            for (Integer pendingTriggerId : pendingTriggerIds) {
    -                triggerKeys.add(triggerKey(pendingTriggerId));
    +            Object triggerIds = windowStore.get(inprocessTriggerKey(batchTxnId));
    --- End diff --
    
    @wangperry Can you remove creating one more variable. You need to wrap with a simple null check like below.
    
    ```java
    if(pendingTriggerIds != null)  {
        for (Integer pendingTriggerId : pendingTriggerIds) {
          triggerKeys.add(triggerKey(pendingTriggerId));
       }
       triggerValues = windowStore.get(triggerKeys);
    }
    ```
, Github user wangperry commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    Thanks @satishd 
, Github user wangperry commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    Thanks @satishd 
, Github user satishd commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    @wangperry Can you squash the commits?
, Github user HeartSaVioR commented on a diff in the pull request:

    https://github.com/apache/storm/pull/1531#discussion_r69260206
  
    --- Diff: storm-core/src/jvm/org/apache/storm/trident/windowing/WindowTridentProcessor.java ---
    @@ -164,10 +164,12 @@ public void finishBatch(ProcessorContext processorContext) {
     
             if (retriedAttempt(batchId)) {
                 pendingTriggerIds = (List<Integer>) windowStore.get(inprocessTriggerKey(batchTxnId));
    -            for (Integer pendingTriggerId : pendingTriggerIds) {
    -                triggerKeys.add(triggerKey(pendingTriggerId));
    +            if (pendingTriggerIds != null){
    --- End diff --
    
    nit: space between ) and {
, Github user HeartSaVioR commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    @wangperry +1 except nit style comment. 
    Please squash the commits into one, and I'd recommend you to create pull request against master branch, but if you mind to do I'll take care of it.
, Github user wangperry commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    @HeartSaVioR ,  I am newbie, could you help me squash multi commits into one? Thanks
, Github user HeartSaVioR commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    @wangperry Sorry I've occupied a bit. I can handle it so you don't need to worry. :) +1
, Github user satishd commented on the issue:

    https://github.com/apache/storm/pull/1531
  
    +1
, Github user asfgit closed the pull request at:

    https://github.com/apache/storm/pull/1531
, Thanks [~perryWang], I merged to master, 1.x, 1.0.x branches.]