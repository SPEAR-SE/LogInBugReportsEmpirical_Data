[[~miguno], I am using your code to create a sliding window check to prevent DoS attack in [YARN-1547|https://issues.apache.org/jira/browse/YARN-1547].
During the implementation of it, [~yochen] found the bug and he created a UTC to verify the issue - the attached file., This is only on storm-starter, and created before Storm officially supports windowing.
I think we could just replace this to official support windowing.
[~arunmahadevan] 
RollingCountBolt in storm-starter implements sliding window internally. Could you check that we can change this to official windowing feature?
Thanks in advance!, [~kabhwan] I havent looked deeper, but it looks like the RollingCount and slot based counter could be replaced with something like,

{code:java}
    private static class RollingCountBolt extends BaseWindowedBolt {
        private OutputCollector collector;

        @Override
        public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {
            super.prepare(stormConf, context, collector);
            this.collector = collector;
        }

        @Override
        public void execute(TupleWindow inputWindow) {
            Map<Object, Long> counts = new HashMap<>();
            for (Tuple tuple : inputWindow.get()) {
                Object obj = tuple.getValue(0);
                Long count;
                if ((count = counts.get(obj)) != null) {
                    counts.put(obj, count + 1);
                } else {
                    counts.put(obj, 1L);
                }
            }

            for (Map.Entry<Object, Long> count : counts.entrySet()) {
                collector.emit(new Values(count.getKey(), count.getValue()));
            }
        }
        @Override
        public void declareOutputFields(OutputFieldsDeclarer declarer) {
            declarer.declare(new Fields("obj", "count"));
        }
    }
{code}

And,

{code:java}
builder.setBolt(counterId, new RollingCountBolt().withWindow(Duration.seconds(9), Duration.seconds(3)), 4)
          .fieldsGrouping(spoutId, new Fields("word"));
{code}]