[Thanks [~liuzhaokun],

I merged this into master.  If you want it in a different branch too please let me know.]