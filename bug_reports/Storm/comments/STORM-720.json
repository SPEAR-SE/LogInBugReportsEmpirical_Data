[GitHub user rtandonmsft opened a pull request:

    https://github.com/apache/storm/pull/476

    STORM-720: Storm.cmd should return ERRORLEVEL before exiting main block

    PR for https://issues.apache.org/jira/browse/STORM-720

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/rtandonmsft/storm master

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/476.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #476
    
----
commit 4004314203225af80474611a2084b1cade2f71ec
Author: Ravi Tandon <rtandon@microsoft.com>
Date:   2015-03-23T23:13:31Z

    STORM-720: Storm.cmd should return ERRORLEVEL before exiting main block

----
, Github user harshach commented on the pull request:

    https://github.com/apache/storm/pull/476#issuecomment-87130288
  
    +1
, Github user knusbaum commented on a diff in the pull request:

    https://github.com/apache/storm/pull/476#discussion_r42054199
  
    --- Diff: bin/storm.cmd ---
    @@ -90,6 +90,7 @@
       )
       set path=%PATH%;%STORM_BIN_DIR%;%STORM_SBIN_DIR%
       call start /b "%storm-command%" "%JAVA%" %JAVA_HEAP_MAX% %STORM_OPTS% %STORM_LOG_FILE% %CLASS% %storm-command-arguments%
    +  exit /b %ERRORLEVEL%
       goto :eof
    --- End diff --
    
    We can get rid of this `goto :eof` now, right?
, Github user rtandonmsft commented on a diff in the pull request:

    https://github.com/apache/storm/pull/476#discussion_r42408922
  
    --- Diff: bin/storm.cmd ---
    @@ -90,6 +90,7 @@
       )
       set path=%PATH%;%STORM_BIN_DIR%;%STORM_SBIN_DIR%
       call start /b "%storm-command%" "%JAVA%" %JAVA_HEAP_MAX% %STORM_OPTS% %STORM_LOG_FILE% %CLASS% %storm-command-arguments%
    +  exit /b %ERRORLEVEL%
       goto :eof
    --- End diff --
    
    @knusbaum Yes, I do not see any control flow issue of removing or keeping it with this change. I did not do it to keep the sub routine blocks consistent so that all end with goto :eof, plus this is an already deployed and working change in Apache Storm on Azure HDInsight for more than 6 months.
, Github user harshach commented on the issue:

    https://github.com/apache/storm/pull/476
  
    @knusbaum are we good to merge this?
, The PR was never merged as of STORM-2558 the batch scripts have been deleted and the storm.ps1 exits with $LastExcitCode, so this is no longer needed. I will discard the PR related to this JIRA.]