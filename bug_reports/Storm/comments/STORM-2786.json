[Great finding!

There're generally two kinds of failed tuples - explicit fail and timeout - and explicitly failed tuples will be remove from the map via https://github.com/apache/storm/blob/124acb92dff04a57b530ab4d95a698abc8ff46d9/storm-client/src/jvm/org/apache/storm/daemon/Acker.java#L120-L122 but timed-out tuples still would be leaked because of what you observed. 
Spout handles timed-out tuples independently hence only memory leak will occur which makes users not able be aware of., Yes I missed that part.  It is really confusing that when the code gets a failed tuple it adds it in, and then removes it.  But whatever it is just the rotation that is causing the issues., Merged the fix into master, 1.x 1.1.x and 1.0.x]