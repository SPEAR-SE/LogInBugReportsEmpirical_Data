[I basically know the reason why supervisor do not recognize the running workers.
storm.local.dir is set to "storm-local" by default,which is a relative path to where I start the supervisor.
if supervisor shutdown by accident and I restart it from another directory,it will create a new local directory and ignore the former one., GitHub user Renkai opened a pull request:

    https://github.com/apache/storm/pull/713

    [STORM-1005]replace default storm.local.dir value to absolute path.

    One of my supervisors shutdown by it self after running for a few weeks.After I restart the supervisor from         another directory(actually I don't remember which directory I started the supervisor at first.Then the workers running on that machine become wild.They running as usual,but the supervisor can't detect them,and I can't shutdown them with `storm kill`.When I submit a new topology,the supervisor will try to start new a worker with the port running workers already used,it will cause failure.
    
    It's hard form a typical user to know why such exception happens,so I think it's better to set storm.local.dir as a absolute path.
    
    If `storm.local.dir` can be set to `$STORM_HOME/storm-local`,it may be best.But it seems yaml file only support constant values.

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/Renkai/storm storm-1005

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/713.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #713
    
----
commit cb2f9f54aaec7ff43ee7c96d991b12de4c689168
Author: renkai <gaelookair@gmail.com>
Date:   2015-09-02T05:26:43Z

    replace default storm.local.dir value to absolute path.

----
, Github user HeartSaVioR commented on the pull request:

    https://github.com/apache/storm/pull/713#issuecomment-137288071
  
    One thing we should keep in mind is, some users are using Storm in Windows environment.
    Using absolute path, especially known *nix path to default value will make a problem for those users.
, Github user Renkai commented on the pull request:

    https://github.com/apache/storm/pull/713#issuecomment-137371641
  
    If make storm.local.dir to a relative path is better,how about make the path  relative to where storm is installed rather than where user start the storm processes.
, Github user HeartSaVioR commented on the pull request:

    https://github.com/apache/storm/pull/713#issuecomment-137568073
  
    Sounds good for me.
, GitHub user Renkai opened a pull request:

    https://github.com/apache/storm/pull/722

    [STORM-1005] set storm.local.dir relative values relative to storm.home rather thaâ€¦

    Solve the same problem with 
    https://github.com/apache/storm/pull/713
    but another way as @HeartSaVioR advised.

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/Renkai/storm storm-1005-relative

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/722.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #722
    
----
commit 180c51d0cf1017c872e87845cc356b8803e978cf
Author: renkai <gaelookair@gmail.com>
Date:   2015-09-06T03:47:02Z

    set storm.local.dir relative values relative to storm.home rather than where user run storm command

----
, Github user HeartSaVioR commented on the pull request:

    https://github.com/apache/storm/pull/722#issuecomment-138382687
  
    @Renkai 
    Great. Could you add simple unit test to check ```absolute-storm-local-dir``` works with relative / absolute path?
, Github user Renkai commented on the pull request:

    https://github.com/apache/storm/pull/722#issuecomment-138449623
  
    @HeartSaVioR I hope the unit test is good enough,but I don't have a windows environment to test the code.It seems travis-ci do not have windows environment,too.
, Github user HeartSaVioR commented on the pull request:

    https://github.com/apache/storm/pull/722#issuecomment-138698074
  
    +1
    @Renkai I think current unit test is enough.
, Github user Renkai closed the pull request at:

    https://github.com/apache/storm/pull/713
, Github user Renkai commented on the pull request:

    https://github.com/apache/storm/pull/722#issuecomment-140972231
  
    Would you like to merge these commits or they need someone else to review?
, Github user HeartSaVioR commented on the pull request:

    https://github.com/apache/storm/pull/722#issuecomment-141256305
  
    @Renkai 
    Sorry for the delay. I intended to wait for other committers to review, but since no one is reviewing I'll take care of it.
, Github user HeartSaVioR commented on a diff in the pull request:

    https://github.com/apache/storm/pull/722#discussion_r39817156
  
    --- Diff: storm-core/test/clj/backtype/storm/config_test.clj ---
    @@ -168,3 +168,24 @@
                           (catch Exception e e)))))
             (is (thrown-cause? java.lang.IllegalArgumentException
               (.validateField validator "test" 42)))))))
    +
    +(deftest test-absolute-storm-local-dir
    +  (let [storm-home-key "storm.home"
    +        old-storm-home (System/getProperty storm-home-key)
    +        conf-relative {STORM-LOCAL-DIR "storm-local"}
    +        conf-absolute {STORM-LOCAL-DIR
    +                       (if on-windows?
    +                         "C:\\storm-local"
    +                         "/var/storm-local")}]
    +    (try
    +      (System/setProperty storm-home-key (if on-windows? "C:\\storm-home" "/usr/local/storm-home"))
    --- End diff --
    
    @Renkai 
    Unfortunately I found this PR affects other tests randomly - supervisor tests are failing. 
    Please see https://travis-ci.org/apache/storm/jobs/79231189.
    Could we just use current storm.home?
, Github user HeartSaVioR commented on a diff in the pull request:

    https://github.com/apache/storm/pull/722#discussion_r39817305
  
    --- Diff: storm-core/test/clj/backtype/storm/config_test.clj ---
    @@ -168,3 +168,24 @@
                           (catch Exception e e)))))
             (is (thrown-cause? java.lang.IllegalArgumentException
               (.validateField validator "test" 42)))))))
    +
    +(deftest test-absolute-storm-local-dir
    +  (let [storm-home-key "storm.home"
    +        old-storm-home (System/getProperty storm-home-key)
    +        conf-relative {STORM-LOCAL-DIR "storm-local"}
    +        conf-absolute {STORM-LOCAL-DIR
    +                       (if on-windows?
    +                         "C:\\storm-local"
    +                         "/var/storm-local")}]
    +    (try
    +      (System/setProperty storm-home-key (if on-windows? "C:\\storm-home" "/usr/local/storm-home"))
    --- End diff --
    
    @Renkai If test should change storm.home to work correctly, let's remove test.
, Github user Renkai commented on the pull request:

    https://github.com/apache/storm/pull/722#issuecomment-141328715
  
    @HeartSaVioR It's fine to leave default `storm.home` to test,I manually set it before because I'm not sure if the value is already set when the test code was running.Now I remove the code which may cause environment changing.
, Github user asfgit closed the pull request at:

    https://github.com/apache/storm/pull/722
, Thanks [~RenkaiGe],
I merged into master and 0.10.x-branch., Github user erikdw commented on a diff in the pull request:

    https://github.com/apache/storm/pull/713#discussion_r39913602
  
    --- Diff: docs/documentation/Setting-up-a-Storm-cluster.md ---
    @@ -52,10 +52,13 @@ storm.zookeeper.servers:
     
     If the port that your Zookeeper cluster uses is different than the default, you should set **storm.zookeeper.port** as well.
     
    -2) **storm.local.dir**: The Nimbus and Supervisor daemons require a directory on the local disk to store small amounts of state (like jars, confs, and things like that). You should create that directory on each machine, give it proper permissions, and then fill in the directory location using this config. For example:
    +2) **storm.local.dir**: The Nimbus and Supervisor daemons require a directory on the local disk to store small amounts of state (like jars, confs, and things like that).
    + You should create that directory on each machine, give it proper permissions, and then fill in the directory location using this config.
    + You'd better set it to absolute path rather than relative path,otherwise it will cause unexpected behavior when you launch daemons
    + from different directories.For example:
    --- End diff --
    
    space between . and For
]