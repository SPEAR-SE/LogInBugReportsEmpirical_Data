[Thanks [~omkreddy], I merged into master and 1.x-branch., Also merged follow up patches.]