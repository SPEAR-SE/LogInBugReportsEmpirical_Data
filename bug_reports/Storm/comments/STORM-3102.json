[Nice find, great job. The change seems to come from https://issues.apache.org/jira/browse/KAFKA-5273. Seems like they removed the committed offset cache because commits can also be done by the producer now, so it was unsafe to cache the committed offsets.

The check is simply there to check that we don't reintroduce a fixed bug (https://issues.apache.org/jira/browse/STORM-2666). I felt it made sense to have, because it didn't really raise complexity, and it was an extremely cheap check. Now that calling KafkaConsumer.committed is expensive, I think the check isn't worth it anymore. I don't have a strong opinion on whether we should keep it around for testing/debugging and disable it with a flag, or delete it outright. I'd probably lean toward deleting it to avoid adding unnecessary configuration though.

[~acseidel] If you'd like to make this fix, please open a PR at https://github.com/apache/storm/pulls. , Opened PRs that remove the check for master, 1.x-branch, and 1.1.x-branch

[https://github.com/apache/storm/pull/271|https://github.com/apache/storm/pull/2716]5

[https://github.com/apache/storm/pull/2716]

https://github.com/apache/storm/pull/2717, Thanks for the fix [~acseidel], merged to master, 1.x and 1.1.x]