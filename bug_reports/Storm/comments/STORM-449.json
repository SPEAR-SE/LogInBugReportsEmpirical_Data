[GitHub user revans2 opened a pull request:

    https://github.com/apache/incubator-storm/pull/223

    STORM-449: Updated ShellBolt to not exit when shutting down.

    I modified the test that was having issues to run 100 times in a row.  Previously it would fail after 1 or 2 times through the loop.  Now it passes all of the times no problem.  I didn't include the test change because it is overkill here.

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/revans2/incubator-storm STORM-449

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/incubator-storm/pull/223.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #223
    
----
commit ee86ad9b6963722a2f2d91c04d5014c11c0a9024
Author: Robert (Bobby) Evans <bobby@apache.org>
Date:   2014-08-11T18:59:08Z

    Updated ShellBolt to not exit when shutting down.

----
, Github user d2r commented on a diff in the pull request:

    https://github.com/apache/incubator-storm/pull/223#discussion_r16433290
  
    --- Diff: storm-core/src/jvm/backtype/storm/task/ShellBolt.java ---
    @@ -293,11 +295,13 @@ private void handleMetrics(ShellMsg shellMsg) {
         }
     
         private void die(Throwable exception) {
    -        String processInfo = _process.getProcessInfoString() + _process.getProcessTerminationInfoString();
    -        _exception = new RuntimeException(processInfo, exception);
    -        LOG.error("Halting process: ShellBolt died.", exception);
    -        _collector.reportError(exception);
    -        System.exit(11);
    +        if (_running) { //Don't exit if running tests
    --- End diff --
    
    Let's change the comment to me non-specific to tests.  If we aren't running, don't bother.
, Github user d2r commented on a diff in the pull request:

    https://github.com/apache/incubator-storm/pull/223#discussion_r16433345
  
    --- Diff: storm-core/src/jvm/backtype/storm/task/ShellBolt.java ---
    @@ -293,11 +295,13 @@ private void handleMetrics(ShellMsg shellMsg) {
         }
     
         private void die(Throwable exception) {
    --- End diff --
    
    If this `Throwable` is an error, we would still want to log it somewhere as well as shut down.
, Github user d2r commented on the pull request:

    https://github.com/apache/incubator-storm/pull/223#issuecomment-52677192
  
    Done with review, to suggestions.
, Github user revans2 commented on the pull request:

    https://github.com/apache/incubator-storm/pull/223#issuecomment-52799300
  
    Review comments should be addressed now.
, Github user d2r commented on the pull request:

    https://github.com/apache/incubator-storm/pull/223#issuecomment-52800517
  
    +1 Looks good. 
, Github user ptgoetz commented on the pull request:

    https://github.com/apache/incubator-storm/pull/223#issuecomment-52815733
  
    +1
, Github user xiaokang commented on the pull request:

    https://github.com/apache/incubator-storm/pull/223#issuecomment-53178919
  
    +1 and #240 is related to this one.
, I merged this into master, Github user asfgit closed the pull request at:

    https://github.com/apache/incubator-storm/pull/223
]