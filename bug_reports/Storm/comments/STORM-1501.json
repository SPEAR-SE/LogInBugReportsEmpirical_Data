[GitHub user caofangkun opened a pull request:

    https://github.com/apache/storm/pull/1046

    [STORM-1501] launch worker process exception will cause supervisor process exited

    [util.clj/async-loop](https://github.com/apache/storm/blob/master/storm-core/src/clj/org/apache/storm/util.clj#L474) default kill-fn will kill current process  
    
    when supervisor use [util.clj/launch-process](https://github.com/apache/storm/blob/master/storm-core/src/clj/org/apache/storm/util.clj#L546) to launch worker process , if exeception occurs , supervisor process will exit.

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/caofangkun/apache-storm storm-1501-1

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/storm/pull/1046.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #1046
    
----
commit 21ef59cadbe4204a0152cef5cf58dffcd928a469
Author: caofangkun <caofangkun@gmail.com>
Date:   2016-01-26T08:04:53Z

    [STORM-1501] launch worker process exception will cause supervisor process exited

----
, Github user revans2 commented on the pull request:

    https://github.com/apache/storm/pull/1046#issuecomment-175125963
  
    I am a bit curious why we need this?  What exception/error did you see come from the worker process?
, Github user revans2 commented on a diff in the pull request:

    https://github.com/apache/storm/pull/1046#discussion_r50867596
  
    --- Diff: storm-core/src/clj/org/apache/storm/util.clj ---
    @@ -553,7 +553,8 @@
                    (catch InterruptedException e
                      (log-message log-prefix " interrupted.")))
                  (exit-code-callback (.exitValue process)))
    -           nil)))                    
    +           nil)
    +          :kill-fn (fn [error] (log-error (RuntimeException. ("launch process failed..."))))))
    --- End diff --
    
    Why are we throwing away error?
    
    What happens if this does not exit?  I assume that the heartbeat monitoring will detect it and do the right thing, but are there other places in the code besides a worker process that we use this?  Will there be problems especially around the exit-code-callback if they are not called?
, Closing due to inactivity. Looks like that patch would not be expected to pass the vote.]