[[~hmclouro] This is caused by using the subscribe API. I don't think we should try to make the code work around this. Upgrading to 1.2.0 for https://issues.apache.org/jira/browse/STORM-2640 will solve this. , [~Srdo] I understand that. The only reason I decided to put some thought into a possible fix is to cover the scenario where a customer that is in Storm 1.1.0 does not want to upgrade to 1.2.0. But my idea all along is to advise to move manual partition assignment (i.e. upgrade to Storm 1.2.0). , [~hmclouro] Okay, I just wanted to make sure you didn't spend time debugging to find out why this happens :)

Regarding fixing this, I think it might not be easy. We'd need to make sure that the spout always calls poll before commit in nextTuple, so it can trigger rebalance in case the spout has been idle for longer than the session timeout, and we'd probably also need to change the rebalance listener logic. It currently assumes that when onPartitionsRevoked runs, the spout was assigned the partitions it has offset managers for.

Users who don't want to upgrade storm-kafka-client for some reason can still work around this by setting a higher session timeout, and newer Kafka versions allow you to set it pretty high without losing fast detection of dead consumers due to KIP-62., STORM-2640 also fixes STORM-2494]