[symptoms of this problem are exactly same as in this discussion. Root of problem is not in zookeeper<->worker communication, as you can see from discussion raising timeouts did not helped, JVM is just stuck with running GC all the time, having no resources to communicate with zookeeper.

http://mail-archives.apache.org/mod_mbox/storm-user/201405.mbox/%3CBAY179-W879A8BC16B2EFB02ED8334933E0@phx.gbl%3E, its leaking backtype.storm.messaging.TaskMessage objects. I cant tell if they are incoming or outgoing. It looks like bug in flow control because in my code i have:

{code}
 conf.setMaxSpoutPending(1000)
 StormSubmitter.submitTopology("Storm-throughput-test", conf, builder.createTopology())
{code}

leaking worker is running only this small bolt:

{code}
class Rtt extends StormBolt(outputFields = List("rtt")) {

  override
  def execute(t: Tuple) = {
     val now = System.currentTimeMillis()
     val rtt = now - t.getLong(0)
     t.emit(rtt)
  }
}
{code}, Closing this as duplicate because STORM-339 better describes problem: Lack of flow control leads to OOM if message acking is disabled. Sadly enabling message acking means 10x lower throughput.]