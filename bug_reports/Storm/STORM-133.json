{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": null,
        "components": [{
            "description": "Core storm daemons and APIs including trident",
            "id": "12327950",
            "name": "storm-core",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12327950"
        }],
        "created": "2013-12-15T05:21:20.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xumingming&avatarId=18354",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xumingming&avatarId=18354",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xumingming&avatarId=18354",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xumingming&avatarId=18354"
            },
            "displayName": "James Xu",
            "key": "xumingming",
            "name": "xumingming",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=xumingming",
            "timeZone": "Asia/Shanghai"
        },
        "customfield_10010": null,
        "customfield_12310220": null,
        "customfield_12310222": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "0.0",
        "customfield_12310420": "363831",
        "customfield_12310920": "364137",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i1qppr:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "2013-12-15 05:21:20.0",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "https://github.com/nathanmarz/storm/issues/356\n\nDuring development runs with local clusters I've sometimes managed to encounter FileNotFoundException thrown from FileUtils.forceDelete during cleanup.\n\nWithout knowing the internals of Storm it feels a bit strange that clean up...\na) ...fails when trying to delete a non existing file/folder\nb) ...tries to delete a non-existant file\n\nWould suppressing FileNotFoundException from FileUtils.forceDelete or switching to FileUtils.deleteQuietly be reasonable?\n\nSample stack trace:\n\nERROR [2012-10-09 22:08:51,255] org.apache.zookeeper.server.NIOServerCnxn: Thread Thread[main,5,main] died\n! java.io.FileNotFoundException: File does not exist: /var/folders/30/4f0z00f56sqfh512yr1l61ym0000gn/T/5844d75c-3801-4757-b7ea-f20ca76e4e52/workers/08a06e4f-4cbc-4e10-b013-ff4fcb4cbf51/heartbeats/1349813330619.version\n! at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:1386)\n! at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:1044)\n! at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:977)\n! at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:1381)\n! at backtype.storm.util$rmr.invoke(util.clj:413)\n! at backtype.storm.daemon.supervisor$try_cleanup_worker.invoke(supervisor.clj:146)\n! at backtype.storm.daemon.supervisor$shutdown_worker.invoke(supervisor.clj:165)\n\n----------\nMichaelBlume: Getting the same error while trying to test with complete-topology\n\nNote: I'm using storm 0.8.1. Have reproduced on my mac and my ubuntu netbook. Can try with development version if desired.\n\nReproduced with development version. It's a really weird bug, because the code is actually checking for the existence of the path before attempting to delete it.\n\nOK, I think I partially understand. I put some logging into rmr to log out a listing of the tree it's attempting to remove. I get this:\n\n[clojure-test] 3501 [Thread-10] INFO backtype.storm.util - [\"/private/var/folders/qz/qs47vb4938bbk3djt74vrxwr0000gn/T/dadf34c4-ad02-4728-9d91-8b3300bcc926/workers/94008c8d-593e-463d-8665-d58fbb682f0e/heartbeats\" \"/private/var/folders/qz/qs47vb4938bbk3djt74vrxwr0000gn/T/dadf34c4-ad02-4728-9d91-8b3300bcc926/workers/94008c8d-593e-463d-8665-d58fbb682f0e/heartbeats/1349990601844\" \"/private/var/folders/qz/qs47vb4938bbk3djt74vrxwr0000gn/T/dadf34c4-ad02-4728-9d91-8b3300bcc926/workers/94008c8d-593e-463d-8665-d58fbb682f0e/heartbeats/1349990601844.version\" \"/private/var/folders/qz/qs47vb4938bbk3djt74vrxwr0000gn/T/dadf34c4-ad02-4728-9d91-8b3300bcc926/workers/94008c8d-593e-463d-8665-d58fbb682f0e/heartbeats/1349990602801\" \"/private/var/folders/qz/qs47vb4938bbk3djt74vrxwr0000gn/T/dadf34c4-ad02-4728-9d91-8b3300bcc926/workers/94008c8d-593e-463d-8665-d58fbb682f0e/heartbeats/1349990602801.version\"]\n[clojure-test] 3518 [main] INFO backtype.storm.util - [\"/private/var/folders/qz/qs47vb4938bbk3djt74vrxwr0000gn/T/dadf34c4-ad02-4728-9d91-8b3300bcc926/workers/94008c8d-593e-463d-8665-d58fbb682f0e/heartbeats\"]\n\nLooks like backtype.storm.util.rmr's being called on the same dir from two threads. The second call happens when the directory's just about empty, but not quite gone, but by the time rmr calls forceDelete, the directory's gone entirely and an exception gets raised. I've thrown a band-aid on this on my fork, but the proper solution would be to figure out why two threads are deleting the same directory.\n\n----------\nnathanmarz: Please attach a reproducible test case that I can run so I can look into what's going on. I run local cluster's all the time (Storm's unit tests bring clusters up and down dozens of times) and have never seen this.\n\n----------\nchids: I've not been able to create a reliable test case but the condition does occur \"regularly\". Right now I'm running the testBasicTopology code and got bitten by this a couple of times in a row. Then it stops happening.\n\n@MichaelBlume's have you tried to identify what Thread-10 is?\n\n----------\ntravis: yea, I'm seeing this regularly as well, not quite sure what the pattern is yet\n\nI got stack traces of the two threads trying to rmr:\n\n11073 [main] ERROR backtype.storm.util  - Rmr path /var/folders/ll/0csh8smd025d9mgh2nf842400000gn/T//88915881-f92a-44be-93c1-434d9be6ac28/workers/bf2411b5-830a-4549-85e8-76637dcf352b/heartbeats\njava.lang.Exception\n    at backtype.storm.util$rmr$fn__4117.invoke(util.clj:411)\n    at backtype.storm.util$rmr.invoke(util.clj:411)\n    at backtype.storm.daemon.supervisor$try_cleanup_worker.invoke(supervisor.clj:146)\n    at backtype.storm.daemon.supervisor$shutdown_worker.invoke(supervisor.clj:165)\n    at backtype.storm.daemon.supervisor$fn__4733$exec_fn__1207__auto__$reify__4742.shutdown_all_workers(supervisor.clj:368)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at clojure.lang.Reflector.invokeMatchingMethod(Reflector.java:93)\n    at clojure.lang.Reflector.invokeNoArgInstanceMember(Reflector.java:298)\n    at backtype.storm.testing$kill_local_storm_cluster.invoke(testing.clj:154)\n... (application specific stacktrack - let me know if it would be useful)\n11073 [Thread-19] ERROR backtype.storm.util  - Rmr path /var/folders/ll/0csh8smd025d9mgh2nf842400000gn/T//88915881-f92a-44be-93c1-434d9be6ac28/workers/bf2411b5-830a-4549-85e8-76637dcf352b/heartbeats\njava.lang.Exception\n    at backtype.storm.util$rmr$fn__4117.invoke(util.clj:411)\n    at backtype.storm.util$rmr.invoke(util.clj:411)\n    at backtype.storm.daemon.supervisor$try_cleanup_worker.invoke(supervisor.clj:146)\n    at backtype.storm.daemon.supervisor$shutdown_worker.invoke(supervisor.clj:165)\n    at backtype.storm.daemon.supervisor$sync_processes.invoke(supervisor.clj:223)\n    at clojure.lang.AFn.applyToHelper(AFn.java:161)\n    at clojure.lang.AFn.applyTo(AFn.java:151)\n    at clojure.core$apply.invoke(core.clj:603)\n    at clojure.core$partial$fn__4070.doInvoke(core.clj:2343)\n    at clojure.lang.RestFn.invoke(RestFn.java:397)\n    at backtype.storm.event$event_manager$fn__2484.invoke(event.clj:24)\n    at clojure.lang.AFn.run(AFn.java:24)\n        at java.lang.Thread.run(Thread.java:680)\nStill not quite sure what this all means, but getting closer. This happens pretty much every time I run tests on my mac and on our CI box.\n\nStill no test case, but I did find a workaround. I was running the topology like:\n\n(with-local-cluster [cluster]\n    (complete-topology cluster\n                       (my-topology drpc)\n                       :mock-sources {\"actions\" (map vector actions)\n                                      \"drpc-requests\" requests}))\nSleeping for 5 seconds before shutting down the cluster seems to fix it (shorter periods just made the error sporadic rather than constant:\n\n(with-local-cluster [cluster]\n  (let [results\n        (complete-topology cluster\n                           (my-topology drpc)\n                           :mock-sources {\"actions\" (map vector actions)\n                                          \"drpc-requests\" requests})]\n    (Thread/sleep 5000)\n    results))\n",
        "duedate": null,
        "environment": null,
        "fixVersions": [],
        "issuelinks": [{
            "id": "12379999",
            "outwardIssue": {
                "fields": {
                    "issuetype": {
                        "avatarId": 21133,
                        "description": "A problem which impairs or prevents the functions of the product.",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                        "id": "1",
                        "name": "Bug",
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                        "subtask": false
                    },
                    "priority": {
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                        "id": "3",
                        "name": "Major",
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
                    },
                    "status": {
                        "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                        "id": "6",
                        "name": "Closed",
                        "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                        "statusCategory": {
                            "colorName": "green",
                            "id": 3,
                            "key": "done",
                            "name": "Done",
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
                        }
                    },
                    "summary": "FileNotFoundException during supervisor cleanup due to non-existant file"
                },
                "id": "12684760",
                "key": "STORM-134",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/12684760"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12379999",
            "type": {
                "id": "12310000",
                "inward": "is duplicated by",
                "name": "Duplicate",
                "outward": "duplicates",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
            }
        }],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667"
            },
            "id": "12314820",
            "key": "STORM",
            "name": "Apache Storm",
            "projectCategory": {
                "description": "Apache Storm Related",
                "id": "13260",
                "name": "Storm",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13260"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12314820"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xumingming&avatarId=18354",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xumingming&avatarId=18354",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xumingming&avatarId=18354",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xumingming&avatarId=18354"
            },
            "displayName": "James Xu",
            "key": "xumingming",
            "name": "xumingming",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=xumingming",
            "timeZone": "Asia/Shanghai"
        },
        "resolution": null,
        "resolutiondate": null,
        "status": {
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "id": "1",
            "name": "Open",
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "statusCategory": {
                "colorName": "blue-gray",
                "id": 2,
                "key": "new",
                "name": "To Do",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2"
            }
        },
        "subtasks": [],
        "summary": "FileNotFoundException during supervisor cleanup due to non-existant file",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2015-10-09T00:16:47.000+0000",
        "versions": [],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/STORM-133/votes",
            "votes": 1
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/STORM-133/watchers",
            "watchCount": 2
        },
        "workratio": -1
    },
    "id": "12684759",
    "key": "STORM-133",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12684759"
}