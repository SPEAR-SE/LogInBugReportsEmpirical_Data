{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13098435","self":"https://issues.apache.org/jira/rest/api/2/issue/13098435","key":"STORM-2713","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":9000,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":9000,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2017-08-30 01:08:52.79","customfield_12312320":null,"customfield_12310222":null,"customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2713/watchers","watchCount":1,"isWatching":false},"created":"2017-08-30T01:08:52.790+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["pull-request-available"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuzhaokun","name":"liuzhaokun","key":"liuzhaokun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liuzhaokun","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-09-27T02:31:11.675+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"when the connection to the first zkserver is timeout,storm-kafka's kafkaspout will throw a exception without attempting to connect other zkserver,even zk can also work with one node down.","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"2.5h","remainingEstimateSeconds":0,"timeSpentSeconds":9000},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"when the connection to the first zkserver is timeout,storm-kafka's kafkaspout will throw a exception","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuzhaokun","name":"liuzhaokun","key":"liuzhaokun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liuzhaokun","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liuzhaokun","name":"liuzhaokun","key":"liuzhaokun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"liuzhaokun","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":9000,"total":9000,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":9000,"total":9000,"percent":100},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2713/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":15,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user liu-zhaokun opened a pull request:\n\n    https://github.com/apache/storm/pull/2297\n\n    [STORM-2713] when the connection to the first zkserver is timeout,storm-kafka's kafkaspout will throw a exception\n\n    [https://issues.apache.org/jira/browse/STORM-2713](https://issues.apache.org/jira/browse/STORM-2713)\n    when the connection to the first zkserver is timeout,storm-kafka's kafkaspout will throw a exception without attempting to connect other zkserver,even zk can also work with one node down.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/liu-zhaokun/storm master08300852\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/2297.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #2297\n    \n----\ncommit aa46372a6907eee3f18adafec5112998b08687b1\nAuthor: liuzhaokun <liu.zhaokun@zte.com.cn>\nDate:   2017-08-30T01:10:03Z\n\n    [STORM-2713] when the connection to the first zkserver is timeout,storm-kafka's kafkaspout will throw a exception\n\n----\n","created":"2017-08-30T01:57:24.665+0000","updated":"2017-08-30T01:57:24.665+0000","started":"2017-08-30T01:57:24.663+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51331","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51425","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136238719\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    Which value do you think this method returns when exception is caught, which action caller should take? Without proper action for failing back, it is better to throw exception and fail-fast.\n","created":"2017-08-31T03:23:22.458+0000","updated":"2017-08-31T03:23:22.458+0000","started":"2017-08-31T03:23:22.456+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51425","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136238783\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    And compilation fails on the change. Please see the result of Travis build.\n","created":"2017-08-31T03:24:05.276+0000","updated":"2017-08-31T03:24:05.276+0000","started":"2017-08-31T03:24:05.275+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51426","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136278638\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    @HeartSaVioR \n    When exception is caught,we should only print the error messages,so that users can be aware of there are some problems in their cluster such as one role of zk was down.\n","created":"2017-08-31T08:47:23.504+0000","updated":"2017-08-31T08:47:23.504+0000","started":"2017-08-31T08:47:23.503+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51455","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51456","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136279982\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    @HeartSaVioR \n    For example,one  role of zk is down in users cluster,storm-kafka will throw a exception,even storm also can connect another zk role and works.I will check the  result of Travis build.\n","created":"2017-08-31T08:53:55.264+0000","updated":"2017-08-31T08:53:55.264+0000","started":"2017-08-31T08:53:55.263+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51456","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136281189\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    When RuntimeException is propagated to call hierarchy, some place will leave a error message. (it is guaranteed when worker is crashing) \n    \n    Btw, I guess you may need to think and try to answer my questions above by yourself.\n    Please note that core principal of Storm is 'fail-fast', because in many case things are not restorable and retryable, and we had to kill the process to prevent process to go with unexpected behavior.\n","created":"2017-08-31T08:59:45.748+0000","updated":"2017-08-31T08:59:45.748+0000","started":"2017-08-31T08:59:45.747+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51457","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136283372\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    That may be viable and possible, but you may need to add retry logic rather than just removing throw statement.\n","created":"2017-08-31T09:09:56.078+0000","updated":"2017-08-31T09:09:56.078+0000","started":"2017-08-31T09:09:56.076+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51458","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136284170\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    I think it doesn't affect 'fail-fast',I just want to guarantee users' Topology can work normally.\n","created":"2017-08-31T09:13:44.278+0000","updated":"2017-08-31T09:13:44.278+0000","started":"2017-08-31T09:13:44.277+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51459","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/51462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2297#discussion_r136286746\n  \n    --- Diff: external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java ---\n    @@ -110,7 +110,7 @@ private int getNumPartitions(String topic) {\n                 List<String> children = _curator.getChildren().forPath(topicBrokersPath);\n                 return children.size();\n             } catch (Exception e) {\n    -            throw new RuntimeException(e);\n    +            LOG.error(e.getMessage(), e);\n    --- End diff --\n    \n    @HeartSaVioR \n    I mean topology should  work even we  can't connect one of the zkservers,because the data is shared  among zkservers. But if we throw a exception,storm will not attempt to connect other zkserver,and exit.\n","created":"2017-08-31T09:24:40.982+0000","updated":"2017-08-31T09:24:40.982+0000","started":"2017-08-31T09:24:40.980+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"51462","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/53065","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on the issue:\n\n    https://github.com/apache/storm/pull/2297\n  \n    I think Curator is supposed to handle retry and partial connection loss to the Zookeeper cluster for us. I'd rather we use Curator for this instead of trying to add our own retry loops around it.\n","created":"2017-09-19T20:34:35.966+0000","updated":"2017-09-19T20:34:35.966+0000","started":"2017-09-19T20:34:35.964+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"53065","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/53175","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on the issue:\n\n    https://github.com/apache/storm/pull/2297\n  \n    @srdo\n    I don't think it's related to retry, the key is how storm will do when the first zkserver is down.\n","created":"2017-09-21T02:42:11.845+0000","updated":"2017-09-21T02:42:11.845+0000","started":"2017-09-21T02:42:11.844+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"53175","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/53212","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on the issue:\n\n    https://github.com/apache/storm/pull/2297\n  \n    @liu-zhaokun Yes, that's what I'm talking about. If the first zkserver is down, I think Curator is supposed to try another server in the connection string.\n","created":"2017-09-21T16:17:14.871+0000","updated":"2017-09-21T16:17:14.871+0000","started":"2017-09-21T16:17:14.867+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"53212","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/53300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on the issue:\n\n    https://github.com/apache/storm/pull/2297\n  \n    @srdo\n    I guess you support my PR,right?\n","created":"2017-09-23T03:21:12.439+0000","updated":"2017-09-23T03:21:12.439+0000","started":"2017-09-23T03:21:12.435+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"53300","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/53311","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on the issue:\n\n    https://github.com/apache/storm/pull/2297\n  \n    @liu-zhaokun No, not as it is currently. I think Curator already handles failing over to another Zookeeper server for us, so if the user passes a zkStr with multiple servers here https://github.com/apache/storm/blob/master/external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java#L61 and sets the retry policy at https://github.com/apache/storm/blob/master/external/storm-kafka/src/jvm/org/apache/storm/kafka/DynamicBrokersReader.java#L64 to a few attempts, then I don't see why we need to add another layer of retries on top of that?\n    \n    Plus as @HeartSaVioR points out, this doesn't compile.\n","created":"2017-09-23T09:50:10.723+0000","updated":"2017-09-23T09:50:10.723+0000","started":"2017-09-23T09:50:10.718+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"53311","issueId":"13098435"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13098435/worklog/53492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user liu-zhaokun commented on the issue:\n\n    https://github.com/apache/storm/pull/2297\n  \n    @srdo \n    Thanks for your reply.I mean if curator has retried several times and failed,the code where I modify will throw a exception,and it will never attempt to connect another zkserver. Could you help me solve doubts?\n    I will check the CI later.\n","created":"2017-09-27T02:31:11.667+0000","updated":"2017-09-27T02:31:11.667+0000","started":"2017-09-27T02:31:11.663+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"53492","issueId":"13098435"}]},"customfield_12311820":"0|i3jfin:"}}