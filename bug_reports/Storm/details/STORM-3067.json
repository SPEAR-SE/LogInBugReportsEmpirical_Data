{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13158425","self":"https://issues.apache.org/jira/rest/api/2/issue/13158425","key":"STORM-3067","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2018-05-10T12:57:51.961+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri May 11 07:53:00 UTC 2018","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_79940027_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2018-05-11T07:57:56.953+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-3067/watchers","watchCount":2,"isWatching":false},"created":"2018-05-10T09:45:36.951+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341265","id":"12341265","name":"1.1.2","archived":false,"released":true,"releaseDate":"2018-02-15"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-05-11T08:00:17.353+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12331080","id":"12331080","name":"storm-kafka-client"}],"timeoriginalestimate":null,"description":"Using Kafka 10.2.1, two different behaviours were observed:\r\n\r\nStorm 1.1.0 =>\r\n{code}\r\n/opt/kafka/bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --group test.topic.consumer-group --describe\r\nNote: This will only show information about consumers that use the Java consumer API (non-ZooKeeper-based consumers).\r\n\r\n\r\nTOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID\r\ntest.topic 0 85186604 85186607 3 consumer-2-27a77d1b-e851-47a4-954e-4953ea612b72 /X.X.X.X consumer-2\r\n\r\n{code}\r\n \r\n\r\nStorm 1.1.2 =>\r\n{code:java}\r\n/opt/kafka/bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --group test.topic.consumer-group --describe\r\nNote: This will only show information about consumers that use the Java consumer API (non-ZooKeeper-based consumers).\r\n\r\n\r\n\r\nConsumer group 'test.topic.consumer-group' has no active members.\r\n\r\nTOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID\r\ntest.topic 0 85202473 85202475 2 -{code}\r\n\r\nDespite this behaviour, the topology continues to consume messages and commit offsets to Kafka. It's unclear if this lack of active clients on the consumer group affects the normal functioning of the Spout.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Kafka Spout has no active members in consumer group","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=RAbreu","name":"RAbreu","key":"rabreu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Abreu","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=RAbreu","name":"RAbreu","key":"rabreu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Abreu","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13158425/comment/16470353","id":"16470353","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"body":"[~RAbreu] This is expected behavior and shouldn't affect processing. See https://issues.apache.org/jira/browse/STORM-2542 (I know the fix version lists only 2.0.0/1.2.0, but we backported to 1.1.2 as well in https://github.com/apache/storm/pull/2549). \r\n\r\nBasically we are letting the spout manage which processes consume which partitions, rather than letting Kafka control it, and that's why you're seeing a different output. When it's referring to \"active members\" it means KafkaConsumers that are currently letting Kafka control their subscriptions. Since the spout controls the subscription manually, its consumer isn't considered an active member.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"created":"2018-05-10T12:57:51.961+0000","updated":"2018-05-10T12:57:51.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13158425/comment/16470659","id":"16470659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=RAbreu","name":"RAbreu","key":"rabreu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Abreu","active":true,"timeZone":"Etc/UTC"},"body":"Thank you for the clarification [~Srdo]. It makes sense.\r\n This can lead to some confusion if one only relies on Apache Kafka tools to inquiries about the consumers' health.\r\n What is the recommend way , other than check the lag that can even be increasing due to a slower Spout, to know if a Spout controlled subscription is active for a particular partition?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=RAbreu","name":"RAbreu","key":"rabreu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Abreu","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-10T16:27:51.619+0000","updated":"2018-05-10T16:27:51.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13158425/comment/16470740","id":"16470740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"body":"I would just use the logs https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java#L1062. If you want to know whether the topology is healthy, you can look at Storm UI.\r\n\r\nAdditionally, you can still use kafka-consumer-groups if you like. Note that it's printing the current committed offset for the consumer group, so you should be able to tell whether the topology is making progress.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"created":"2018-05-10T17:01:21.309+0000","updated":"2018-05-10T17:01:21.309+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13158425/comment/16471617","id":"16471617","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=RAbreu","name":"RAbreu","key":"rabreu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Abreu","active":true,"timeZone":"Etc/UTC"},"body":"Thank you for you time [~Srdo]]. I'll close this ticket since it's a non-issue/expected behaviour.\r\nCheers","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=RAbreu","name":"RAbreu","key":"rabreu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Abreu","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-11T07:53:00.959+0000","updated":"2018-05-11T07:53:00.959+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-3067/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3tk6v:"}}