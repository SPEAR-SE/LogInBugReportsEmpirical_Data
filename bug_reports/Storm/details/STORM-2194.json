{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13019621","self":"https://issues.apache.org/jira/rest/api/2/issue/13019621","key":"STORM-2194","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":9600,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339564","id":"12339564","name":"1.0.4","archived":false,"released":true,"releaseDate":"2017-07-28"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339656","id":"12339656","name":"1.1.1","archived":false,"released":true,"releaseDate":"2017-08-01"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341047","id":"12341047","name":"1.2.0","archived":false,"released":true,"releaseDate":"2018-02-15"}],"aggregatetimespent":9600,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-11-10T08:44:53.537+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 03 15:08:13 UTC 2017","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_10290171589_*|*_4_*:*_1_*:*_4578_*|*_5_*:*_1_*:*_0_*|*_6_*:*_1_*:*_13224","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2017-03-08T21:55:56.075+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2194/watchers","watchCount":4,"isWatching":false},"created":"2016-11-09T19:32:46.711+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335747","id":"12335747","name":"1.0.2","archived":false,"released":true,"releaseDate":"2016-08-10"}],"customfield_12312339":null,"issuelinks":[{"id":"12499650","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12499650","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"13060425","key":"STORM-2440","self":"https://issues.apache.org/jira/rest/api/2/issue/13060425","fields":{"summary":"Kafka outage can lead to lockup of topology","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoulosk","name":"ppoulosk","key":"ppoulosk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Paul Poulosky","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-07-03T15:55:38.582+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"I've been trying to track down a cause of some of our issues with some exceptions leaving Storm workers in a zombified state for some time. I believe I've isolated the bug to the behaviour in :report-error-and-die/reportErrorAndDie in the executor. Essentially:\n\n{code}\n     :report-error-and-die (fn [error]\n                             (try\n                               ((:report-error <>) error)\n                               (catch Exception e\n                                 (log-message \"Error while reporting error to cluster, proceeding with shutdown\")))\n                             (if (or\n                                    (exception-cause? InterruptedException error)\n                                    (exception-cause? java.io.InterruptedIOException error))\n                               (log-message \"Got interrupted excpetion shutting thread down...\")\n                               ((:suicide-fn <>))))\n{code}\n\nhas the grouping for the if statement slightly wrong. It shouldn't log OR die from InterruptedException/InterruptedIOException, but it should log under that condition, and ALWAYS die. \n\nBasically:\n\n{code}\n     :report-error-and-die (fn [error]\n                             (try\n                               ((:report-error <>) error)\n                               (catch Exception e\n                                 (log-message \"Error while reporting error to cluster, proceeding with shutdown\")))\n                             (if (or\n                                    (exception-cause? InterruptedException error)\n                                    (exception-cause? java.io.InterruptedIOException error))\n                               (log-message \"Got interrupted excpetion shutting thread down...\"))\n                             ((:suicide-fn <>)))\n{code}\n\nAfter digging into the Java port of this code, it looks like a different bug was introduced while porting:\n\n{code}\n        if (Utils.exceptionCauseIsInstanceOf(InterruptedException.class, e)\n                || Utils.exceptionCauseIsInstanceOf(java.io.InterruptedIOException.class, e)) {\n            LOG.info(\"Got interrupted exception shutting thread down...\");\n            suicideFn.run();\n        }\n{code}\n\nWas how this was initially ported, and STORM-2142 changed this to:\n\n{code}\n        if (Utils.exceptionCauseIsInstanceOf(InterruptedException.class, e)\n                || Utils.exceptionCauseIsInstanceOf(java.io.InterruptedIOException.class, e)) {\n            LOG.info(\"Got interrupted exception shutting thread down...\");\n        } else {\n            suicideFn.run();\n        }\n{code}\n\nHowever, I believe the correct port is as described above:\n\n{code}\n        if (Utils.exceptionCauseIsInstanceOf(InterruptedException.class, e)\n                || Utils.exceptionCauseIsInstanceOf(java.io.InterruptedIOException.class, e)) {\n            LOG.info(\"Got interrupted exception shutting thread down...\");\n        }\n        suicideFn.run();\n{code}\n\nI'll look into providing patches for the 1.x and 2.x branches shortly.","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"2h 40m","remainingEstimateSeconds":0,"timeSpentSeconds":9600},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12838608","id":"12838608","filename":"scrubbed-thread-dump.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-11T20:33:21.105+0000","size":722325,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12838608/scrubbed-thread-dump.txt"}],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ReportErrorAndDie doesn't always die","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":9600,"total":9600,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":9600,"total":9600,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15651928","id":"15651928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"This has PRs for 1.0.x-branch and master -- I'm not sure what the procedure is for 1.x-branch is. Please let me know if I should open another PR for that branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-09T20:12:08.978+0000","updated":"2016-11-09T20:12:08.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15653457","id":"15653457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Could you attach thread dump when you got zombie Storm worker? That was introduced on STORM-773 but haven't received similar report.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-11-10T08:44:53.537+0000","updated":"2016-11-10T08:44:53.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15654519","id":"15654519","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"Will do, however after looking through STORM-772 and STORM-773, it's not entirely clear what the intent was. \n\nBasically, my understand is that the exception passed here is the exception from the worker -- and {{exception-cause?}} walks the entire exception chain checking for {{InterruptedException}} or {{InterruptedIOException}} -- which may have been due to a bolt talking to an external service (e.g. {{SocketTimeoutException}} is an {{InterruptedIOException}}). \n\nSo, some options:\n\n# My understanding is incorrect, and this error is NOT from the bolt itself\n# {{exception-cause?}} doesn't walk the entire exception tree as I thought\n# This behaviour is mostly intentional, but should only be applied if error itself is {{InterruptedException}} or {{InterruptedIOException}}, but not if those appear anywhere in the chain\n\nI think #2 above is the case:\n\n{code}\nuser=> (def ex (new RuntimeException (new InterruptedException)))\n#'user/ex\n(defn exception-cause?\n  [klass ^Throwable t]\n (->> (iterate #(.getCause ^Throwable %) t)\n       (take-while identity)\n       (some (partial instance? klass))\n       boolean))\n#'user/exception-cause?\nuser=> (exception-cause? InterruptedException ex)\ntrue\nuser=>\n{code}\n\nSo, either the exception isn't the one raised by the bolt (I'll look for some evidence to support this next), the check should only be ignoring errors that are themselves {{InterruptedException}}/{{InterruptedIOException}} but not looking elsewhere in the chain, or this was intended as just a logging line, and {{sucide-fn}} should still get invoked after logging.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-10T16:48:45.257+0000","updated":"2016-11-10T16:50:59.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15654599","id":"15654599","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"It does appear to me that the executor's {{report-error-and-die}} is the fn passed to the bolt creation multimethod {{mk-threads :bolt}}, via {{executor-data}}, and this is what gets invoked in the {{async-loop}} for the outer catch clause against {{Throwable}} if the exception is an {{InterruptedIOException}}, which then applies the above logic. \n\nI don't see how this behaviour could possibly be correct now, unless there's some other mechanism for causing workers to exit -- any bolt that throws an unhandled exception that has {{InterruptedIOException}} in the chain will invoke {{:report-error-and-die}}, which then happily logs and does nothing, leaving the process otherwise running.\n\nI'm fairly certain there is at least SOME bug here, so now the question is:\n\n# Do we just log and always suicide? STORM-772 and STORM-773 indicate that we DID actually want to ignore SOME of these exceptions.\n# Do we just log and ignore if and only if {{error}} is ITSELF an {{InterruptedException}}/{{InterruptedIOException}}? This now seems to be the most likely intent given the discussion in those two other tickets.\n# There's some other mechanism for making workers exit that I'm not aware -- entirely possible, but I'm not sure how I'd go about finding it if that's the case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-10T17:21:06.464+0000","updated":"2016-11-10T17:21:06.464+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15655686","id":"15655686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"Just managed to snag a thread dump of a worker I think was exhibiting this behaviour. Will take a look at it tomorrow, and attach it here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-11T00:46:47.179+0000","updated":"2016-11-11T00:46:47.179+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15657341","id":"15657341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"Checking internally to make sure it's OK to post stacks that contain some internal information, however the dump does confirm we have the expected 24 spout threads, but only 23 bolt threads -- one of them has died but not shut down the process.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-11T15:32:52.913+0000","updated":"2016-11-11T15:32:52.913+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15658106","id":"15658106","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"Showing 24 spout threads as expected, but only 23 b-0 threads ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-11T20:33:21.113+0000","updated":"2016-11-11T20:33:21.113+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15658110","id":"15658110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"body":"I attached a scrubbed thread dump showing the issue.\n\nThis worker should have 24 spout threads, and 24 b-0 threads, however we can see that one of the b-0 threads has died, but left the worker running:\n\n{code}\nSulla:Desktop chawco$ grep spout- scrubbed-thread-dump.txt | grep -v SendThread | grep -v EventThread | wc -l\n      24\nSulla:Desktop chawco$ grep b-0- scrubbed-thread-dump.txt | wc -l\n      23\nSulla:Desktop chawco$\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chawco","name":"chawco","key":"chawco","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Hawco","active":true,"timeZone":"America/Toronto"},"created":"2016-11-11T20:33:55.265+0000","updated":"2016-11-11T20:33:55.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/15712965","id":"15712965","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sathyafmt","name":"sathyafmt","key":"sathyafmt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sathya F","active":true,"timeZone":"Etc/UTC"},"body":"Thanks Craig ! We have two problems with 1.0.2 & your patch fixes them both.\n\n1. when storm workers start & they are not able to bind to 56700 (the rmi port), they hang around and do not die. This is easy to reproduce, I started a nc -l 56700 & started the topology. With your patch, it dies & the supervisor restarts them back again.\n2016-12-01 04:24:41.721 STDERR [INFO] Error: Exception thrown by the agent : java.rmi.server.ExportException: Port already in use: 56700; nested exception is: \n2016-12-01 04:24:41.722 STDERR [INFO]   java.net.BindException: Address already in use\n\n2. the storm workers hit a SocketTimeoutException & they don't die. The log:\n2016-11-30 15:21:29.004 o.a.s.util [ERROR] Async loop died!\njava.lang.RuntimeException: org.apache.storm.kafka.FailedFetchException: java.net.SocketTimeoutException\n        at org.apache.storm.utils.DisruptorQueue.consumeBatchToCursor(DisruptorQueue.java:464) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.utils.DisruptorQueue.consumeBatchWhenAvailable(DisruptorQueue.java:430) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.disruptor$consume_batch_when_available.invoke(disruptor.clj:73) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.daemon.executor$fn__8058$fn__8071$fn__8124.invoke(executor.clj:850) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.util$async_loop$fn__624.invoke(util.clj:484) [storm-core-1.0.2.jar:1.0.2]\n        at clojure.lang.AFn.run(AFn.java:22) [clojure-1.7.0.jar:?]\n        at java.lang.Thread.run(Thread.java:745) [?:1.8.0_91]\nCaused by: org.apache.storm.kafka.FailedFetchException: java.net.SocketTimeoutException\n        at org.apache.storm.kafka.KafkaUtils.fetchMessages(KafkaUtils.java:199) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.kafka.trident.TridentKafkaEmitter.fetchMessages(TridentKafkaEmitter.java:141) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.kafka.trident.TridentKafkaEmitter.doEmitNewPartitionBatch(TridentKafkaEmitter.java:114) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.kafka.trident.TridentKafkaEmitter.failFastEmitNewPartitionBatch(TridentKafkaEmitter.java:68) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.kafka.trident.TridentKafkaEmitter.access$400(TridentKafkaEmitter.java:42) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.kafka.trident.TridentKafkaEmitter$2.emitPartitionBatchNew(TridentKafkaEmitter.java:265) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.kafka.trident.TridentKafkaEmitter$2.emitPartitionBatchNew(TridentKafkaEmitter.java:257) ~[stormjar.jar:1.0.0]\n        at org.apache.storm.trident.spout.PartitionedTridentSpoutExecutor$Emitter$1.init(PartitionedTridentSpoutExecutor.java:125) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.trident.topology.state.RotatingTransactionalState.getState(RotatingTransactionalState.java:83) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.trident.topology.state.RotatingTransactionalState.getStateOrCreate(RotatingTransactionalState.java:110) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.trident.spout.PartitionedTridentSpoutExecutor$Emitter.emitBatch(PartitionedTridentSpoutExecutor.java:121) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.trident.spout.TridentSpoutExecutor.execute(TridentSpoutExecutor.java:82) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.trident.topology.TridentBoltExecutor.execute(TridentBoltExecutor.java:383) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.daemon.executor$fn__8058$tuple_action_fn__8060.invoke(executor.clj:731) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.daemon.executor$mk_task_receiver$fn__7979.invoke(executor.clj:464) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.disruptor$clojure_handler$reify__7492.onEvent(disruptor.clj:40) ~[storm-core-1.0.2.jar:1.0.2]\n        at org.apache.storm.utils.DisruptorQueue.consumeBatchToCursor(DisruptorQueue.java:451) ~[storm-core-1.0.2.jar:1.0.2]\n        ... 6 more\n2016-11-30 15:21:29.028 o.a.s.d.executor [INFO] Got interrupted excpetion shutting thread down...\n2016-11-30 16:20:59.013 s.d.C.DBPoolDataSource-pool-ds [INFO] DBPoolDataSource-pool-ds: Destroyed connection\n2016-11-30 16:21:14.014 s.d.C.DBPoolDataSource-pool-ds [INFO] DBPoolDataSource-pool-ds: Destroyed connection\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sathyafmt","name":"sathyafmt","key":"sathyafmt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sathya F","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-01T20:17:01.023+0000","updated":"2016-12-01T20:17:01.023+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/comment/16072595","id":"16072595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Miss porting back to 1.1.x-branch. Will do.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2017-07-03T15:08:13.523+0000","updated":"2017-07-03T15:08:13.523+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2194/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":16,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/31882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user chawco opened a pull request:\n\n    https://github.com/apache/storm/pull/1767\n\n    STORM-2194: Report error and die, not report error or die\n\n    We should still kill our executor after encountering an unhandled exception. This change logs what happens as before, but also ensures we always call suicide-fn to ensure our worker exits.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/chawco/storm STORM-2194\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/1767.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #1767\n    \n----\ncommit 952fe22f0ec2dc1193f0d951d16f8ee0eb58e817\nAuthor: Craig Hawco <craig.hawco@upsight.com>\nDate:   2016-11-09T20:02:04Z\n\n    STORM-2194: Report error and die, not report error or die\n\n----\n","created":"2016-11-09T20:04:31.250+0000","updated":"2016-11-09T20:04:31.250+0000","started":"2016-11-09T20:04:31.249+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"31882","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/31883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user chawco opened a pull request:\n\n    https://github.com/apache/storm/pull/1768\n\n    STORM-2194: Report error and die, not report error or die\n\n    This appears to have just ported an existing bug from executor.clj -- this is what I believe the expected behaviour is/was.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/chawco/storm master\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/1768.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #1768\n    \n----\ncommit f3a64f08cf056f638e703f420d025c1a81af6fcc\nAuthor: Craig Hawco <craig.hawco@upsight.com>\nDate:   2016-11-09T20:07:03Z\n\n    STORM-2194: Report error and die, not report error or die\n\n----\n","created":"2016-11-09T20:09:45.039+0000","updated":"2016-11-09T20:09:45.039+0000","started":"2016-11-09T20:09:45.039+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"31883","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/1768\n  \n    -1.\n    \n    InterruptedException we often use to indicate that the process is shutting down, and we want to not blow up when we see them.  Perhaps what we want to do is to better document it.\n","created":"2016-11-21T18:30:19.537+0000","updated":"2016-11-21T18:30:19.537+0000","started":"2016-11-21T18:30:19.536+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32278","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32279","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/1767\n  \n    -1.\n    \n    InterruptedException we often use to indicate that the process is shutting down, and we want to not blow up when we see them. Perhaps what we want to do is to better document it.\n","created":"2016-11-21T18:31:09.456+0000","updated":"2016-11-21T18:31:09.456+0000","started":"2016-11-21T18:31:09.455+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32279","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user sathyafmt commented on the issue:\n\n    https://github.com/apache/storm/pull/1767\n  \n    @revans2 - His change in storm-1.0.2 is in the report-error-and-die function, so it should shutdown, correct ?\n","created":"2016-12-01T20:29:27.437+0000","updated":"2016-12-01T20:29:27.437+0000","started":"2016-12-01T20:29:27.436+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32759","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user chawco commented on the issue:\n\n    https://github.com/apache/storm/pull/1767\n  \n    So, there's some ambiguity in place here that would need to get resolved. Basically, there's two sources for InterruptedException/InterruptedIOException -- one from Storm itself, and one from the user's code (See: [STORM-2194](https://issues.apache.org/jira/browse/STORM-2194) If we want to have different behaviour from these two sources we do need some solution to disambiguate the uses.\n    \n    Basically, the problem is this: If anything in the user's thread raises these exceptions, the executor thread will terminate *but the worker will not*. This leaves the entire topology in a zombified state. I find it difficult to see that this behaviour is \"as intended\". \n    \n    @revans2 can you suggest a way we can disambiguate between Storm initiated and user initiated exceptions here? I'm having a real tough time thinking how we could accomplish that. Alternatively, can you propose an alternate implementation for signalling this shutdown? I'm happy to take on that work to make things shutdown in a more appropriate manner, as long as we get to fix this zombie topology behaviour.\n","created":"2016-12-01T21:22:35.239+0000","updated":"2016-12-01T21:22:35.239+0000","started":"2016-12-01T21:22:35.238+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32769","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32770","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user chawco commented on the issue:\n\n    https://github.com/apache/storm/pull/1768\n  \n    I've left some follow up comments in [1767](https://github.com/apache/storm/pull/1767).\n","created":"2016-12-01T21:23:33.181+0000","updated":"2016-12-01T21:23:33.181+0000","started":"2016-12-01T21:23:33.181+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32770","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32814","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/1767\n  \n    @chawco \n    \n    Okay so I understand the issue better now. SocketTimeoutException is a subclass of InterruptedIOException.\n    \n    https://docs.oracle.com/javase/7/docs/api/java/net/SocketTimeoutException.html\n    \n    I could argue that it is a mistake on the part of java and that it is wrong, but that is already set in stone so we have to deal with it.\n    \n    I see two options. \n    \n    1) We can treat a SocketTimeoutException differently from other InterruptedIOExceptions, \n    2) or we can just treat all InterruptedIOExceptions as fatal.\n    \n    We started ignoring InterruptedIOExceptions because we would occasionally run into them in the supervisor or nimbus local cluster tests and that would fail everything.  Having proper behavior is more important than having super stable unit tests, but if we can have both (option 1) I think that would be best.\n","created":"2016-12-02T16:02:31.937+0000","updated":"2016-12-02T16:02:31.937+0000","started":"2016-12-02T16:02:31.935+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32814","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/32815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/1767\n  \n    We should be able to fix this with code like.\n    \n    ```\n    (if (or\n           (exception-cause? InterruptedException error)\n           (and\n               (exception-cause? java.io.InterruptedIOException error)\n               (not (exception-cause? java.net.SocketTimeoutException))))\n    ```\n","created":"2016-12-02T16:04:53.002+0000","updated":"2016-12-02T16:04:53.002+0000","started":"2016-12-02T16:04:53.001+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"32815","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/34900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/1767\n  \n    @sathyafmt sorry I have taken so long to respond December was a really crazy month for me.  From STORM-2194 I see that the SocketTimeoutException goes through the code being changed.  The RMI code does not go through that path at all.\n    \n    ```\n    2016-12-01 04:24:41.721 STDERR [INFO] Error: Exception thrown by the agent : java.rmi.server.ExportException: Port already in use: 56700; nested exception is:\n    2016-12-01 04:24:41.722 STDERR [INFO] java.net.BindException: Address already in use\n    ```\n    \n    If it did then we would have exited because BindException and ExportException are neither InterruptedIOException nor InterruptedException. \n    \n    So this patch, nor the one I proposed would have any impact on the RMI case at all.  Something else is catching the ExportException and printing to STDERR the error message above.\n","created":"2017-01-06T16:06:39.960+0000","updated":"2017-01-06T16:06:39.960+0000","started":"2017-01-06T16:06:39.960+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"34900","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/36946","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user ppoulosk opened a pull request:\n\n    https://github.com/apache/storm/pull/1932\n\n    [STORM-2194]  Ignore socket timeout error from executor\n\n    This is a translation of the fix recommended by @revans2 here:\n    \n    https://github.com/apache/storm/pull/1767\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/ppoulosk/storm STORM-2194\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/1932.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #1932\n    \n----\ncommit 18a8286fac462c4616f1550048231f315adc45ef\nAuthor: Paul Poulosky <ppoulosk@crawlcall.corp.ne1.yahoo.com>\nDate:   2017-02-08T20:31:14Z\n\n    Ignore socket timeout error from executor\n\n----\n","created":"2017-02-08T20:34:29.141+0000","updated":"2017-02-08T20:34:29.141+0000","started":"2017-02-08T20:34:29.133+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"36946","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/36975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/1932\n  \n    +1 although I really would like to see someone else review this too.\n    \n    Also the test failure is unrelated.\n","created":"2017-02-09T15:14:45.712+0000","updated":"2017-02-09T15:14:45.712+0000","started":"2017-02-09T15:14:45.712+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"36975","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/37064","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user kishorvpatil commented on the issue:\n\n    https://github.com/apache/storm/pull/1932\n  \n    LGTM. +1. \n","created":"2017-02-13T17:13:03.335+0000","updated":"2017-02-13T17:13:03.335+0000","started":"2017-02-13T17:13:03.329+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"37064","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/37082","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user jerrypeng commented on the issue:\n\n    https://github.com/apache/storm/pull/1932\n  \n    +1\n","created":"2017-02-14T02:49:34.045+0000","updated":"2017-02-14T02:49:34.045+0000","started":"2017-02-14T02:49:34.044+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"37082","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/38690","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on the issue:\n\n    https://github.com/apache/storm/pull/1932\n  \n    +1\n","created":"2017-03-08T21:43:58.475+0000","updated":"2017-03-08T21:43:58.475+0000","started":"2017-03-08T21:43:58.474+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"38690","issueId":"13019621"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13019621/worklog/38693","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/1932\n","created":"2017-03-08T21:54:58.937+0000","updated":"2017-03-08T21:54:58.937+0000","started":"2017-03-08T21:54:58.937+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"38693","issueId":"13019621"}]},"customfield_12311820":"0|i3650n:"}}