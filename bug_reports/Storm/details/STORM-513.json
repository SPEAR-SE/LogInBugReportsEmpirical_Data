{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12745343","self":"https://issues.apache.org/jira/rest/api/2/issue/12745343","key":"STORM-513","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12328864","id":"12328864","name":"0.9.3-rc2","archived":false,"released":true}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-10-08T14:08:49.545+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Nov 16 01:10:12 UTC 2015","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3807837439_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2014-11-14T21:54:03.967+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-513/watchers","watchCount":4,"isWatching":false},"created":"2014-10-01T20:10:06.587+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326452","id":"12326452","name":"0.9.2-incubating","archived":false,"released":true,"releaseDate":"2014-06-25"}],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-11-16T01:10:12.456+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327951","id":"12327951","name":"storm-multilang","description":"Storm integration with other programming languages"}],"timeoriginalestimate":null,"description":"If I'm understanding everything correctly with how ShellBolts work, the Java ShellBolt executor is the part of the topology that sends heartbeats back to Nimbus to let it know that a particular multilang bolt is still alive.  The problem with this is that if the multilang subprocess/bolt severely hangs (i.e., it will not even respond to {{SIGALRM}} and the like), the Java ShellBolt does not seem to notice or care. Simply having the tuple get replayed when it times out will not suffice either, because the subprocess will still be stuck.\n\nThe most obvious way to handle this seem to be to add heartbeating to the multilang protocol itself, so that the ShellBolt expects a message of some kind every {{timeout}} seconds.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ShellBolt keeps sending heartbeats even when child process is hung","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dan.blanchard","name":"dan.blanchard","key":"dan.blanchard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Blanchard","active":true,"timeZone":"America/Havana"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dan.blanchard","name":"dan.blanchard","key":"dan.blanchard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dan Blanchard","active":true,"timeZone":"America/Havana"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Linux: 2.6.32-431.11.2.el6.x86_64 (RHEL 6.5)\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14163526","id":"14163526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user HeartSaVioR opened a pull request:\n\n    https://github.com/apache/storm/pull/286\n\n    STORM-513 check heartbeat from multilang subprocess\n\n    Related issue link : https://issues.apache.org/jira/browse/STORM-513\n    \n    It seems that ShellSpout and ShellBolt doesn't check subprocess, and set heartbeat with their only states.\n    Subprocess could hang, but it doesn't affect ShellSpout / ShellBolt. It just stops working on tuple.\n    It's better to check heartbeat from subprocess, and suicide if subprocess stops working.\n    \n    * Spout\n      * ShellSpout sends \"next\" to subprocess continuously\n      * subprocess sends \"sync\" to ShellSpout when \"next\" is received\n      * so we can treat \"sync\", or any messages to heartbeat\n    * Bolt\n      * ShellBolt sends tuples to subprocess if it's available\n      * so we need to send \"heartbeat\" tuple\n       * subprocess sends \"sync\" to ShellBolt when \"heartbeat\" tuple is received\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/HeartSaVioR/storm STORM-513\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/286.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #286\n    \n----\ncommit ca5874cdf11af8d835335d228b643f28aeb3f9c3\nAuthor: Jungtaek Lim <kabhwan@gmail.com>\nDate:   2014-10-08T13:48:01Z\n\n    STORM-513 check heartbeat from multilang subprocess\n    \n    * Spout\n    ** ShellSpout sends \"next\" to subprocess continuously\n    ** subprocess sends \"sync\" to ShellSpout when \"next\" is received\n    ** so we can treat \"sync\", or any messages to heartbeat\n    * Bolt\n    ** ShellBolt sends tuples to subprocess if it's available\n    ** so we need to send \"heartbeat\" tuple\n    ** subprocess sends \"sync\" to ShellBolt when \"heartbeat\" tuple is\n    received\n\ncommit 1a0d4bdd735ba0ade42f6777a4c47affec931557\nAuthor: Jungtaek Lim <kabhwan@gmail.com>\nDate:   2014-10-08T14:06:24Z\n\n    Fix mixed tab / space, remove FIXME\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-08T14:08:49.545+0000","updated":"2014-10-08T14:08:49.545+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14163530","id":"14163530","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user dan-blanchard commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-58363290\n  \n    As the person who filed the issue. Thanks for coming up with a solution so quickly!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-08T14:12:59.243+0000","updated":"2014-10-08T14:12:59.243+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14163551","id":"14163551","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-58366793\n  \n    @dan-blanchard You're welcome!\n    \n    Actually it doesn't let subprocess sends heartbeat periodically, so it can't cover some situations.\n    ex) subprocess is alive but cannot process \"heartbeat\" tuple in time \n    It can be possible if subprocess is too busy or subprocess takes long time to process \"one\" tuple.\n    Current approach is simpler than others, but if we should cover edge-case, I will try to take care of it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-08T14:33:52.752+0000","updated":"2014-10-08T14:33:52.752+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168095","id":"14168095","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741096\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +205,52 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatTimer.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1000, 1 * 1000);\n         }\n     \n         @Override\n         public void deactivate() {\n    +        heartBeatTimer.cancel();\n    +    }\n    +\n    +    private void setHeartbeat() {\n    +        lastHeartbeatTimestamp.set(System.currentTimeMillis());\n    +    }\n    +\n    +    private long getLastHeartbeat() {\n    +        return lastHeartbeatTimestamp.get();\n    +    }\n    +\n    +    private void die(Throwable exception) {\n    +        heartBeatTimer.cancel();\n    +\n    +        LOG.error(\"Halting process: ShellSpout died.\", exception);\n    +        _collector.reportError(exception);\n    +        System.exit(11);\n         }\n    +\n    +    private class SpoutHeartbeatTimerTask extends TimerTask {\n    +        private ShellSpout spout;\n    +\n    +        public SpoutHeartbeatTimerTask(ShellSpout spout) {\n    +            this.spout = spout;\n    +        }\n    +\n    +        @Override\n    +        public void run() {\n    +            long currentTimeMillis = System.currentTimeMillis();\n    +            long lastHeartbeat = getLastHeartbeat();\n    +\n    +            LOG.debug(\"current time : \" + currentTimeMillis + \", last heartbeat : \" + lastHeartbeat\n    --- End diff --\n    \n    whe doing debug logging try to refrain from using +. Either surraound with isDebugLevel()  or  use \"current time :{}, last heartbeat : {} ....\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:22:23.890+0000","updated":"2014-10-11T11:22:23.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168096","id":"14168096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741104\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +205,52 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatTimer.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1000, 1 * 1000);\n    --- End diff --\n    \n    Could you please add a  bolt configuration to diable it? Some of our python bolt are expiriemental and are unanchored. I would not want to crash the entire worker, since it would incur serious downtime.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:25:15.816+0000","updated":"2014-10-11T11:25:15.816+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168106","id":"14168106","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741180\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +205,52 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatTimer.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1000, 1 * 1000);\n         }\n     \n         @Override\n         public void deactivate() {\n    +        heartBeatTimer.cancel();\n    +    }\n    +\n    +    private void setHeartbeat() {\n    +        lastHeartbeatTimestamp.set(System.currentTimeMillis());\n    +    }\n    +\n    +    private long getLastHeartbeat() {\n    +        return lastHeartbeatTimestamp.get();\n    +    }\n    +\n    +    private void die(Throwable exception) {\n    +        heartBeatTimer.cancel();\n    +\n    +        LOG.error(\"Halting process: ShellSpout died.\", exception);\n    +        _collector.reportError(exception);\n    +        System.exit(11);\n    --- End diff --\n    \n    All of our pyton and multilang bolts have special code that intercepts the SIG_TERM singal and kill when parent process dies. This has not been contributed back since it is very linux specific and logger specific. Without it you might end up having zomie worker processes. This does not relate to your commit since you didn't invent the System.exit(11) thingy, however it would make things worse when a process is not responding. Ideally you would at least want to call process.destory() first. As process destroy is implemented without kill -9 it is not guaranteed to work (sigar's implements this per OS quite nicely).\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:47:02.603+0000","updated":"2014-10-11T11:47:02.603+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168108","id":"14168108","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741189\n  \n    --- Diff: storm-core/src/dev/resources/storm.js ---\n    @@ -243,6 +243,12 @@ BasicBolt.prototype.__emit = function(commandDetails) {\n     BasicBolt.prototype.handleNewCommand = function(command) {\n         var self = this;\n         var tup = new Tuple(command[\"id\"], command[\"comp\"], command[\"stream\"], command[\"task\"], command[\"tuple\"]);\n    +\n    +    if (tup.task == -1 && tup.stream == \"__heartbeat\") {\n    +        self.sync();\n    +        return;\n    +    }\n    +\n         var callback = function(err) {\n               if (err) {\n    --- End diff --\n    \n    storm.py , storm.rb, and storm.js are comitted three times. Each change needs to be modified in all three files. (Yeay - I know ....)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:50:28.546+0000","updated":"2014-10-11T11:50:28.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168109","id":"14168109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741196\n  \n    --- Diff: storm-core/src/dev/resources/storm.js ---\n    @@ -243,6 +243,12 @@ BasicBolt.prototype.__emit = function(commandDetails) {\n     BasicBolt.prototype.handleNewCommand = function(command) {\n         var self = this;\n         var tup = new Tuple(command[\"id\"], command[\"comp\"], command[\"stream\"], command[\"task\"], command[\"tuple\"]);\n    +\n    +    if (tup.task == -1 && tup.stream == \"__heartbeat\") {\n    --- End diff --\n    \n    In nodejs use === \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:52:35.886+0000","updated":"2014-10-11T11:52:35.886+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168112","id":"14168112","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741213\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +64,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatTimer = new Timer(context.getThisTaskId() + \"-heartbeatTimer\", true);\n    --- End diff --\n    \n    Recommended to use SingleThreadedScheduledExecutorService. see http://stackoverflow.com/questions/409932/java-timer-vs-executorservice\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:56:50.194+0000","updated":"2014-10-11T11:56:50.194+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168114","id":"14168114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741220\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +64,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatTimer = new Timer(context.getThisTaskId() + \"-heartbeatTimer\", true);\n    --- End diff --\n    \n    see also http://stackoverflow.com/questions/17419386/scheduledexecutorservice-how-to-stop-action-without-stopping-executor \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T11:58:50.559+0000","updated":"2014-10-11T11:58:50.559+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168115","id":"14168115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741231\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +64,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatTimer = new Timer(context.getThisTaskId() + \"-heartbeatTimer\", true);\n    --- End diff --\n    \n    Is there a reason you have not used tick tuples instead? http://kitmenke.com/blog/2014/08/04/tick-tuples-within-storm/ \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T12:02:38.460+0000","updated":"2014-10-11T12:02:38.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168130","id":"14168130","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741389\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +205,52 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatTimer.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1000, 1 * 1000);\n         }\n     \n         @Override\n         public void deactivate() {\n    +        heartBeatTimer.cancel();\n    +    }\n    +\n    +    private void setHeartbeat() {\n    +        lastHeartbeatTimestamp.set(System.currentTimeMillis());\n    +    }\n    +\n    +    private long getLastHeartbeat() {\n    +        return lastHeartbeatTimestamp.get();\n    +    }\n    +\n    +    private void die(Throwable exception) {\n    +        heartBeatTimer.cancel();\n    +\n    +        LOG.error(\"Halting process: ShellSpout died.\", exception);\n    +        _collector.reportError(exception);\n    +        System.exit(11);\n         }\n    +\n    +    private class SpoutHeartbeatTimerTask extends TimerTask {\n    +        private ShellSpout spout;\n    +\n    +        public SpoutHeartbeatTimerTask(ShellSpout spout) {\n    +            this.spout = spout;\n    +        }\n    +\n    +        @Override\n    +        public void run() {\n    +            long currentTimeMillis = System.currentTimeMillis();\n    +            long lastHeartbeat = getLastHeartbeat();\n    +\n    +            LOG.debug(\"current time : \" + currentTimeMillis + \", last heartbeat : \" + lastHeartbeat\n    --- End diff --\n    \n    @itaifrenkel Oh, you're right! It's slf4j so we should use {} to log effectively.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T12:45:20.357+0000","updated":"2014-10-11T12:45:20.357+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168132","id":"14168132","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741401\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +205,52 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatTimer.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1000, 1 * 1000);\n         }\n     \n         @Override\n         public void deactivate() {\n    +        heartBeatTimer.cancel();\n    +    }\n    +\n    +    private void setHeartbeat() {\n    +        lastHeartbeatTimestamp.set(System.currentTimeMillis());\n    +    }\n    +\n    +    private long getLastHeartbeat() {\n    +        return lastHeartbeatTimestamp.get();\n    +    }\n    +\n    +    private void die(Throwable exception) {\n    +        heartBeatTimer.cancel();\n    +\n    +        LOG.error(\"Halting process: ShellSpout died.\", exception);\n    +        _collector.reportError(exception);\n    +        System.exit(11);\n    --- End diff --\n    \n    @itaifrenkel I agree that we should process.destroy() before terminating itself. \n    (It has been maintained by JDK and it's implemented with JNI, so it would be OS specific.)\n    I also think storm project tries to support Windows, signal handle to SIGTERM maybe not a solution.\n    I'll change it to call process.destroy() first.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T12:53:13.499+0000","updated":"2014-10-11T12:53:13.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168144","id":"14168144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741463\n  \n    --- Diff: storm-core/src/dev/resources/storm.js ---\n    @@ -243,6 +243,12 @@ BasicBolt.prototype.__emit = function(commandDetails) {\n     BasicBolt.prototype.handleNewCommand = function(command) {\n         var self = this;\n         var tup = new Tuple(command[\"id\"], command[\"comp\"], command[\"stream\"], command[\"task\"], command[\"tuple\"]);\n    +\n    +    if (tup.task == -1 && tup.stream == \"__heartbeat\") {\n    +        self.sync();\n    +        return;\n    +    }\n    +\n         var callback = function(err) {\n               if (err) {\n    --- End diff --\n    \n    @itaifrenkel Sorry, I don't know what you say. Could you please describe more clear? I committed all changes in one commit.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T13:11:44.437+0000","updated":"2014-10-11T13:11:44.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168145","id":"14168145","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741514\n  \n    --- Diff: storm-core/src/dev/resources/storm.js ---\n    @@ -243,6 +243,12 @@ BasicBolt.prototype.__emit = function(commandDetails) {\n     BasicBolt.prototype.handleNewCommand = function(command) {\n         var self = this;\n         var tup = new Tuple(command[\"id\"], command[\"comp\"], command[\"stream\"], command[\"task\"], command[\"tuple\"]);\n    +\n    +    if (tup.task == -1 && tup.stream == \"__heartbeat\") {\n    --- End diff --\n    \n    @itaifrenkel Oh, thanks! Actually I'm not nodejs user. I'll change it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T13:14:12.778+0000","updated":"2014-10-11T13:14:12.778+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168149","id":"14168149","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741577\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +64,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatTimer = new Timer(context.getThisTaskId() + \"-heartbeatTimer\", true);\n    --- End diff --\n    \n    @itaifrenkel Users can enable tick tuple and use it to his/her purpose. Also we cannot use high tick time (N minute) for heartbeat.\n    So we shouldn't use tick tuples.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T13:32:17.196+0000","updated":"2014-10-11T13:32:17.196+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168157","id":"14168157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741678\n  \n    --- Diff: storm-core/src/dev/resources/storm.js ---\n    @@ -243,6 +243,12 @@ BasicBolt.prototype.__emit = function(commandDetails) {\n     BasicBolt.prototype.handleNewCommand = function(command) {\n         var self = this;\n         var tup = new Tuple(command[\"id\"], command[\"comp\"], command[\"stream\"], command[\"task\"], command[\"tuple\"]);\n    +\n    +    if (tup.task == -1 && tup.stream == \"__heartbeat\") {\n    +        self.sync();\n    +        return;\n    +    }\n    +\n         var callback = function(err) {\n               if (err) {\n    --- End diff --\n    \n    @itaifrenkel Oh, I see... It exists 3 times. I think only one should be existed, but I'm not sure it can be.\n    I'll apply my changes to other files.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T13:57:24.641+0000","updated":"2014-10-11T13:57:24.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168166","id":"14168166","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18741698\n  \n    --- Diff: storm-core/src/dev/resources/storm.js ---\n    @@ -243,6 +243,12 @@ BasicBolt.prototype.__emit = function(commandDetails) {\n     BasicBolt.prototype.handleNewCommand = function(command) {\n         var self = this;\n         var tup = new Tuple(command[\"id\"], command[\"comp\"], command[\"stream\"], command[\"task\"], command[\"tuple\"]);\n    +\n    +    if (tup.task == -1 && tup.stream == \"__heartbeat\") {\n    +        self.sync();\n    +        return;\n    +    }\n    +\n         var callback = function(err) {\n               if (err) {\n    --- End diff --\n    \n    @itaifrenkel OK, I applied it to all files.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T14:03:51.235+0000","updated":"2014-10-11T14:03:51.235+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168181","id":"14168181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-58752058\n  \n    @itaifrenkel Thanks for pointing out missed spots and points to improve!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T14:54:46.310+0000","updated":"2014-10-11T14:54:46.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168215","id":"14168215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18742240\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +66,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutor = new ScheduledThreadPoolExecutor(5);\n    --- End diff --\n    \n    1. You should consult the comitters if they are happy with another thread, or you are requested to use Tick tuples. A pro for another thread is the fact that maybe maybe a multilang bolt would want to use tick tuples too. But still...\n    \n    2. 1 Thread should be enough.\n    \n    3. This thread must not halt the process when main exists (as in tests), so it should be daemonized. The way to do it AFAIK is this\n    heartBeanExecutor = MoreExecutors.getExitingScheduledExecutorService(Executors.newScheduledThreadPool(1))\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T15:48:51.054+0000","updated":"2014-10-11T15:48:51.054+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168217","id":"14168217","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18742262\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +207,53 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatExecutor.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1, 1, TimeUnit.SECONDS);\n    --- End diff --\n    \n    I would recommend  scheduleWithFixedDelay since it is more explicit in how it uses a single thread. Again, ask the comitters.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-11T15:52:07.030+0000","updated":"2014-10-11T15:52:07.030+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168462","id":"14168462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18745292\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +66,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutor = new ScheduledThreadPoolExecutor(5);\n    --- End diff --\n    \n    @itaifrenkel \n    1. AFAIK, ShellSpout's nextTuple() waits infinitely if subprocess is hang (or doesn't send anything). That's what \"sync\" is for.\n    So we should check heartbeat with \"new thread\".\n    Please correct me if I'm wrong. :)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T01:56:44.116+0000","updated":"2014-10-12T01:56:44.116+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168464","id":"14168464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18745301\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +66,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutor = new ScheduledThreadPoolExecutor(5);\n    --- End diff --\n    \n    @itaifrenkel I agree that 2, 3. I'll update it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T01:58:58.829+0000","updated":"2014-10-12T01:58:58.829+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168468","id":"14168468","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18745322\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +207,53 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatExecutor.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1, 1, TimeUnit.SECONDS);\n    --- End diff --\n    \n    @itaifrenkel I don't know well about ScheduledThreadPoolExecutor, so I have a question.\n    When our runnable task runs within 1s, can task be executed by fixed rate?\n    If it is, I think scheduleAtFixedRate makes sense. I'm expecting heartbeat check exactly per 1s.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T02:06:16.886+0000","updated":"2014-10-12T02:06:16.886+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168533","id":"14168533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18745857\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -189,9 +207,53 @@ private void handleLog(ShellMsg shellMsg) {\n     \n         @Override\n         public void activate() {\n    +        LOG.info(\"Start checking heartbeat...\");\n    +        // prevent timer to check heartbeat based on last thing before activate\n    +        setHeartbeat();\n    +        heartBeatExecutor.scheduleAtFixedRate(new SpoutHeartbeatTimerTask(this), 1, 1, TimeUnit.SECONDS);\n    --- End diff --\n    \n    When having a single thread there is not much difference between the two. Even more your call back is non blocking so the difference is insignificant. Nevertheless, even if it were entirley not accurate the code logic would stay intact. There is nothing in that callback that warrants exactly one second.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T05:37:54.861+0000","updated":"2014-10-12T05:37:54.861+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168534","id":"14168534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18745860\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +67,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutorService = MoreExecutors.getExitingScheduledExecutorService(new ScheduledThreadPoolExecutor(1));\n    --- End diff --\n    \n    new ScheduledThreadPoolExecutor(1) --> Executors.newScheduledThreadPool(1)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T05:39:05.733+0000","updated":"2014-10-12T05:39:05.733+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168594","id":"14168594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18746971\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +67,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutorService = MoreExecutors.getExitingScheduledExecutorService(new ScheduledThreadPoolExecutor(1));\n    --- End diff --\n    \n    @itaifrenkel \n    MoreExecutors.getExitingScheduledExecutorService() receives ScheduledThreadPoolExecutor, not ScheduledExecutorService. I tried to change it, but compiler complained.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T11:01:27.077+0000","updated":"2014-10-12T11:01:27.077+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14168599","id":"14168599","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18747035\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +67,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutorService = MoreExecutors.getExitingScheduledExecutorService(new ScheduledThreadPoolExecutor(1));\n    --- End diff --\n    \n    You could cast, But that's ok as it is\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-12T11:15:17.850+0000","updated":"2014-10-12T11:15:17.850+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14170281","id":"14170281","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r18803104\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/spout/ShellSpout.java ---\n    @@ -56,13 +67,18 @@ public void open(Map stormConf, TopologyContext context,\n             _collector = collector;\n             _context = context;\n     \n    +        workerTimeoutMills = 1000 * RT.intCast(stormConf.get(Config.SUPERVISOR_WORKER_TIMEOUT_SECS));\n    +\n             _process = new ShellProcess(_command);\n     \n             Number subpid = _process.launch(stormConf, context);\n             LOG.info(\"Launched subprocess with pid \" + subpid);\n    +\n    +        heartBeatExecutorService = MoreExecutors.getExitingScheduledExecutorService(new ScheduledThreadPoolExecutor(1));\n    --- End diff --\n    \n    @itaifrenkel OK, I don't like explicit cast, so I'd not modify it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-14T00:17:21.004+0000","updated":"2014-10-14T00:17:21.004+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14178890","id":"14178890","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-59983717\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-21T19:26:11.619+0000","updated":"2014-10-21T19:26:11.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14182569","id":"14182569","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r19326582\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/task/ShellBolt.java ---\n    @@ -305,4 +283,95 @@ private void die(Throwable exception) {\n                 System.exit(11);\n             }\n         }\n    +\n    +    private class BoltHeartbeatTimerTask extends TimerTask {\n    +        private ShellBolt bolt;\n    +\n    +        public BoltHeartbeatTimerTask(ShellBolt bolt) {\n    +            this.bolt = bolt;\n    +        }\n    +\n    +        @Override\n    +        public void run() {\n    +            long currentTimeMillis = System.currentTimeMillis();\n    +            long lastHeartbeat = getLastHeartbeat();\n    +\n    +            LOG.debug(\"BOLT - current time : {}, last heartbeat : {}, worker timeout (ms) : {}\",\n    +                    currentTimeMillis, lastHeartbeat, workerTimeoutMills);\n    +\n    +            if (currentTimeMillis - lastHeartbeat > workerTimeoutMills) {\n    +                bolt.die(new RuntimeException(\"subprocess heartbeat timeout\"));\n    +            }\n    +\n    +            String genId = Long.toString(_rand.nextLong());\n    +            try {\n    +                _pendingWrites.put(createHeartbeatBoltMessage(genId));\n    --- End diff --\n    \n    I reread the code and think that we need here just to flip an atomicboolean (a priority queue for heartbeats of size 1). The reason is that the size of the _pendingWrites queue is Config.TOPOLOGY_SHELLBOLT_MAX_PENDING which by its name is the number of real tuples to retrieve from the disruptor queue. We set it to 1 to optimize for shortest latency... which would cause this thread to block.... which means you cannot share this thread between bolts event if you wanted too... which we need to think if this is an issue or not. A stronger argument in favor of a priority queue for heartbeats is that the rate of heartbeat messages will not be skewed by the length of the queue. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T07:52:52.274+0000","updated":"2014-10-24T07:52:52.274+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14182577","id":"14182577","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r19326747\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/task/ShellBolt.java ---\n    @@ -305,4 +283,95 @@ private void die(Throwable exception) {\n                 System.exit(11);\n             }\n         }\n    +\n    +    private class BoltHeartbeatTimerTask extends TimerTask {\n    +        private ShellBolt bolt;\n    +\n    +        public BoltHeartbeatTimerTask(ShellBolt bolt) {\n    +            this.bolt = bolt;\n    +        }\n    +\n    +        @Override\n    +        public void run() {\n    +            long currentTimeMillis = System.currentTimeMillis();\n    +            long lastHeartbeat = getLastHeartbeat();\n    +\n    +            LOG.debug(\"BOLT - current time : {}, last heartbeat : {}, worker timeout (ms) : {}\",\n    +                    currentTimeMillis, lastHeartbeat, workerTimeoutMills);\n    +\n    +            if (currentTimeMillis - lastHeartbeat > workerTimeoutMills) {\n    +                bolt.die(new RuntimeException(\"subprocess heartbeat timeout\"));\n    +            }\n    +\n    +            String genId = Long.toString(_rand.nextLong());\n    +            try {\n    +                _pendingWrites.put(createHeartbeatBoltMessage(genId));\n    --- End diff --\n    \n    @itaifrenkel Oh, I see. I didn't know that options exists. Thanks for letting me know!\n    Then we can flip heartbeat flag which means \"it's time to send heartbeat\" as you state, and let BoltWriter.run() loop takes care of it first.\n    What do you think?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T07:58:17.872+0000","updated":"2014-10-24T07:58:17.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14182628","id":"14182628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r19330106\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/task/ShellBolt.java ---\n    @@ -305,4 +283,95 @@ private void die(Throwable exception) {\n                 System.exit(11);\n             }\n         }\n    +\n    +    private class BoltHeartbeatTimerTask extends TimerTask {\n    +        private ShellBolt bolt;\n    +\n    +        public BoltHeartbeatTimerTask(ShellBolt bolt) {\n    +            this.bolt = bolt;\n    +        }\n    +\n    +        @Override\n    +        public void run() {\n    +            long currentTimeMillis = System.currentTimeMillis();\n    +            long lastHeartbeat = getLastHeartbeat();\n    +\n    +            LOG.debug(\"BOLT - current time : {}, last heartbeat : {}, worker timeout (ms) : {}\",\n    +                    currentTimeMillis, lastHeartbeat, workerTimeoutMills);\n    +\n    +            if (currentTimeMillis - lastHeartbeat > workerTimeoutMills) {\n    +                bolt.die(new RuntimeException(\"subprocess heartbeat timeout\"));\n    +            }\n    +\n    +            String genId = Long.toString(_rand.nextLong());\n    +            try {\n    +                _pendingWrites.put(createHeartbeatBoltMessage(genId));\n    --- End diff --\n    \n    That sounds very good :+1: \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T09:30:05.785+0000","updated":"2014-10-24T09:30:05.785+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14182633","id":"14182633","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-60365096\n  \n    @ptgoetz Is there a shared ScheduledExecutor in storm? It seems redundant that each bolt would dedicate a thread for the scheduler. Especially now, that the task itself would be non-blocking.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T09:35:27.424+0000","updated":"2014-10-24T09:35:27.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14182656","id":"14182656","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/286#discussion_r19332243\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/task/ShellBolt.java ---\n    @@ -305,4 +283,95 @@ private void die(Throwable exception) {\n                 System.exit(11);\n             }\n         }\n    +\n    +    private class BoltHeartbeatTimerTask extends TimerTask {\n    +        private ShellBolt bolt;\n    +\n    +        public BoltHeartbeatTimerTask(ShellBolt bolt) {\n    +            this.bolt = bolt;\n    +        }\n    +\n    +        @Override\n    +        public void run() {\n    +            long currentTimeMillis = System.currentTimeMillis();\n    +            long lastHeartbeat = getLastHeartbeat();\n    +\n    +            LOG.debug(\"BOLT - current time : {}, last heartbeat : {}, worker timeout (ms) : {}\",\n    +                    currentTimeMillis, lastHeartbeat, workerTimeoutMills);\n    +\n    +            if (currentTimeMillis - lastHeartbeat > workerTimeoutMills) {\n    +                bolt.die(new RuntimeException(\"subprocess heartbeat timeout\"));\n    +            }\n    +\n    +            String genId = Long.toString(_rand.nextLong());\n    +            try {\n    +                _pendingWrites.put(createHeartbeatBoltMessage(genId));\n    --- End diff --\n    \n    @itaifrenkel I've updated PR to reflect it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T10:32:17.995+0000","updated":"2014-10-24T10:32:17.995+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14183361","id":"14183361","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-60438795\n  \n    @itaifrenkel No, not that's available for use via the bolt API, but it's an interesting idea. You could effectively do the same by making the scheduler static (1 per worker/JVM), but that feels kind of hacky.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T19:40:29.550+0000","updated":"2014-10-24T19:40:29.550+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14183363","id":"14183363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-60438969\n  \n    Since there were additional commits added to the pull request, we need to give it more time for others to review before merging, but I am still +1 for the patch.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-24T19:41:58.712+0000","updated":"2014-10-24T19:41:58.712+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14187777","id":"14187777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-60854884\n  \n    Can PR be included to 0.9.3, or next version?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-10-29T00:20:19.011+0000","updated":"2014-10-29T00:20:19.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14196234","id":"14196234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user clockfly commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-61657845\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-04T15:35:33.868+0000","updated":"2014-11-04T15:35:33.868+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14196324","id":"14196324","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-61669206\n  \n    @HeartSaVioR  Thanks for the patch. can you upmerge the changes.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-04T16:36:49.604+0000","updated":"2014-11-04T16:36:49.604+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14196828","id":"14196828","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-61715752\n  \n    @harshach Sure. I'll upmerge it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-04T21:15:31.020+0000","updated":"2014-11-04T21:15:31.020+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14196872","id":"14196872","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-61719213\n  \n    I've got a change to discuss about this PR with @clockfly , and he also stated if subprocess is too busy, subprocess cannot send heartbeat in time, which I've stated first of this PR.\n    \n    Actually it's better to let subprocess have heartbeat thread and send heartbeat periodically.\n    But there're two things to consider.\n    1. ShellSpout runs with PING-PONG communication, and ShellSpout must wait \"sync\" from nextTuple(). So if we change ShellSpout to have reader thread, we should implement nextTuple() to wait for reading \"sync\" from reader thread, which is a little complex than current.\n    2. We should ensure that main thread and heartbeat thread don't write stdout (maybe Pipe) at the same time. GIL could let us feel free, but there will be other languages that support real (?) thread. Writing operation should be with lock.\n    \n    Since I'm not a Javascript (nodejs) guy, and I'm a beginner to Ruby, I cannot cover two things with .js. \n    So I wish to implement it to other PR when we think we can't stand its limitation, or I have some more time.\n    \n    Btw, Nimbus / Supervisor can find dead process due to subprocess hang up to SUPERVISOR_WORKER_TIMEOUT_SECS * 2 + a (maybe), cause there're two heartbeat check, ShellProcess checks subprocess (and suicide if subprocess cannot respond), Nimbus / Supervisor checks ShellProcess.\n    (Just for @clockfly )\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-04T21:37:53.819+0000","updated":"2014-11-04T21:37:53.819+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14196893","id":"14196893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-61720636\n  \n    OK, I've upmerged.\n    Btw, I found py files are diverged too so I need to copy and paste one file to another.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-04T21:47:06.630+0000","updated":"2014-11-04T21:47:06.630+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203815","id":"14203815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62294914\n  \n    @harshach @ptgoez @clockfly \n    Could we merge upmerged PR now, or PR should take care of additional modification before merge?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T07:32:08.049+0000","updated":"2014-11-09T07:32:08.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203821","id":"14203821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62295127\n  \n    Please comment on STORM-528 if you resolved the py files divergence problem.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T07:44:38.318+0000","updated":"2014-11-09T07:44:38.318+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203825","id":"14203825","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62295232\n  \n    @HeartSaVioR @clockfly  I think we need to keep the multilang protocl implementation as simple as possible. A full roundtrip of heartbeat messages is not that bad, as long as it does not add too much latency. If you would like an optimization for the rountrip messages then you could consider any emit as an heartbeat, and trigger the heartbeat rountrip only if there are not enough emits from the bolt. It makes the java code more complicated :(, but achieves similar goals, and leaves the multilang implementation simpler :). All-in-all I think this commit is good, and we could discuss various optimizations later on.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T07:50:43.368+0000","updated":"2014-11-09T07:50:43.368+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203833","id":"14203833","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62295379\n  \n    @itaifrenkel @clockfly \n    I agree @itaifrenkel because there're more implementations (but it doesn't exist on Storm project) on multilang.\n    I saw php implementation of multilang (Sorry I can't remember where it is), and there could be more.\n    If we let subprocess take care of many things, implementations should apply it and update.\n    (Actually we already force them to apply this change because bolt has to treat heartbeat tuple. ;( )\n    So we should consider trade-off, and maybe we should have documentation of multilang specification.\n    \n    AND changes of multilang protocol introduced on this PR should be documented when we announce to release 0.9.3.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T07:59:43.572+0000","updated":"2014-11-09T07:59:43.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203837","id":"14203837","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62295398\n  \n    @itaifrenkel OK, I've commented to STORM-528.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T08:00:45.724+0000","updated":"2014-11-09T08:00:45.724+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203850","id":"14203850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62295920\n  \n    Maybe we can have a discussion about multilang from mailing list or other issue.\n    There seems to leak documentation / strategy / etc. about multilang. How do you all think?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T08:30:58.406+0000","updated":"2014-11-09T08:30:58.406+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203860","id":"14203860","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62296198\n  \n    We should document this feature to http://storm.apache.org/documentation/Multilang-protocol.html\n    In bolts, bolt should handle heartbeat tuple, and send sync response ASAP.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T08:48:31.318+0000","updated":"2014-11-09T08:48:31.318+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203866","id":"14203866","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user itaifrenkel commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62296939\n  \n    @HeartSaVioR I wanted to fix the multilang docs some time ago for nodejs support, but couldn't find a way to provide a pull request ?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T09:21:22.490+0000","updated":"2014-11-09T09:21:22.490+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14203874","id":"14203874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-62298800\n  \n    AFAIK, there was a discussion about moving documents (containing website) to git, started by @ptgoetz, and +1 by many committers.\n    But it's actually not applied, so we can't fix ourselves. We can just report to dev mailing list.\n    \n    Personally I'm heavily inspired to Redis documentation. Document has been treated to same as code.\n    It's on http://github.com/antirez/redis-doc.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-09T10:39:36.143+0000","updated":"2014-11-09T10:39:36.143+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14212476","id":"14212476","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-63094779\n  \n    @HeartSaVioR  I am working on doing some tests on this PR. I tried to build the storm with your changes in and I am getting these failures. Can you please check if you see any of these issues. Thanks.\n    \n    java.lang.Exception: Shell Process Exception: Exception in bolt: undefined method `+' for nil:NilClass - tester_bolt.rb:29:in `process'\\n/private/var/folders/yb/67h7c1sx2d95r5c_x5cjdwmh0000gp/T/ddda5ca6-8167-4ed1-bfef-a1a2001f65a2/supervisor/stormdist/test-1-1415984043/resources/storm.rb:186:in `run'\\ntester_bolt.rb:37:in `<main>'\n    \tat backtype.storm.task.ShellBolt.handleError(ShellBolt.java:188) [classes/:na]\n    \tat backtype.storm.task.ShellBolt.access$1100(ShellBolt.java:69) [classes/:na]\n    \tat backtype.storm.task.ShellBolt$BoltReaderRunnable.run(ShellBolt.java:331) [classes/:na]\n    \tat java.lang.Thread.run(Thread.java:744) [na:1.7.0_51]\n    90960 [Thread-1055] ERROR backtype.storm.task.ShellBolt - Halting process: ShellBolt died.\n    java.lang.RuntimeException: backtype.storm.multilang.NoOutputException: Pipe to subprocess seems to be broken! No output read.\n    Serializer Exception:\n    \n    \n    \tat backtype.storm.utils.ShellProcess.readShellMsg(ShellProcess.java:101) ~[classes/:na]\n    \tat backtype.storm.task.ShellBolt$BoltReaderRunnable.run(ShellBolt.java:318) ~[classes/:na]\n    \tat java.lang.Thread.run(Thread.java:744) [na:1.7.0_51]\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-14T16:58:08.684+0000","updated":"2014-11-14T16:58:08.684+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14212883","id":"14212883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-63134028\n  \n    +1 (again)\n    \n    @harshach The problem you saw was due to two of the `storm.rb` files being out of sync. I will correct that at merge time.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-14T21:45:57.742+0000","updated":"2014-11-14T21:45:57.742+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14212905","id":"14212905","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"body":"merged to master and 0.9.3","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"created":"2014-11-14T21:54:04.015+0000","updated":"2014-11-14T21:54:04.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14212990","id":"14212990","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/286\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-11-14T22:40:24.608+0000","updated":"2014-11-14T22:40:24.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/14213075","id":"14213075","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Please don't forget to document and mention about multilang protocol has changed.\nThanks for merging!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2014-11-14T23:36:48.396+0000","updated":"2014-11-14T23:36:48.396+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12745343/comment/15006119","id":"15006119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hustfxj commented on the pull request:\n\n    https://github.com/apache/storm/pull/286#issuecomment-156884789\n  \n    +1 \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-16T01:10:12.456+0000","updated":"2015-11-16T01:10:12.456+0000"}],"maxResults":58,"total":58,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-513/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i20p8f:"}}