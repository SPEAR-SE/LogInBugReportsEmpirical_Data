{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12955178","self":"https://issues.apache.org/jira/rest/api/2/issue/12955178","key":"STORM-1674","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335747","id":"12335747","name":"1.0.2","archived":false,"released":true,"releaseDate":"2016-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335748","id":"12335748","name":"1.1.0","archived":false,"released":true,"releaseDate":"2017-03-29"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-04-01T03:57:43.322+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 11 21:23:22 UTC 2016","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_4292959263_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2016-05-20T20:04:27.780+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1674/watchers","watchCount":2,"isWatching":false},"created":"2016-04-01T03:35:08.565+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":"STORM-1855","customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327112","id":"12327112","name":"0.9.3","archived":false,"released":true,"releaseDate":"2014-11-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12334140","id":"12334140","name":"0.10.1","archived":false,"released":true,"releaseDate":"2016-05-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335587","id":"12335587","name":"1.0.1","archived":false,"released":true,"releaseDate":"2016-05-06"}],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mr.robert.hastings%40gmail.com","name":"mr.robert.hastings@gmail.com","key":"mr.robert.hastings@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Hastings","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-07-11T21:23:22.673+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324393","id":"12324393","name":"storm-kafka","description":"Storm Kafka Integration"}],"timeoriginalestimate":null,"description":"Discovered 30 megabits of traffic flowing between a set of KafkaSpouts\nand our kafka servers even though no Kafka messages were moving.\nUsing the wireshark kafka dissector, we were able to see that\neach FetchRequest had maxWait set to 10000\nand minBytes set to 0. When binBytes is set to 0 the kafka server\nresponds immediately when there are no messages. In turn the KafkaSpout\npolls without any delay causing a constant stream of FetchRequest/\nFetchResponse messages. Using a non-KafkaSpout client had a similar\ntraffic pattern with two key differences\n1) minBytes was 1\n2) maxWait was 100\nWith these FetchRequest parameters and no messages flowing,\nthe kafka server delays the FetchResponse by 100 ms. This reduces\nthe network traffic from megabits to the low kilobits. It also\nreduced the CPU utilization of our kafka server from 140% to 2%.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Idle KafkaSpout consumes more bandwidth than needed","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mr.robert.hastings%40gmail.com","name":"mr.robert.hastings@gmail.com","key":"mr.robert.hastings@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Hastings","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mr.robert.hastings%40gmail.com","name":"mr.robert.hastings@gmail.com","key":"mr.robert.hastings@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Hastings","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15221116","id":"15221116","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user moesol commented on the pull request:\n\n    https://github.com/apache/storm/pull/1287#issuecomment-204239216\n  \n    KafkaConfig has socketTimeoutMs which I assume maps to socket.timeout.ms. It's passed along to the SimpleConsumer's constructor.\n    \n    I'm not sure yet where rebalance.max.retries etc. would need to get applied. They are not a part of the FetchRequest. My vote is to keep this pull request focused on fixing the issue at hand and have a different pull request to implement the comprehensive list of configurations. \n    \n    Also, I thought I saw some work to create a KafkaSpout that uses the Kafka 0.9 client. Perhaps the comprehensive list of configurations should be coupled with that work.\n    \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-01T03:57:43.322+0000","updated":"2016-04-01T03:57:43.322+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15221227","id":"15221227","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user abhishekagarwal87 commented on the pull request:\n\n    https://github.com/apache/storm/pull/1287#issuecomment-204266196\n  \n    This should also go to 1.x-branch given that it is bug and can improve the network bandwidth for lower load topologies\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-01T06:16:54.899+0000","updated":"2016-04-01T06:16:54.899+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15244535","id":"15244535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user moesol commented on the pull request:\n\n    https://github.com/apache/storm/pull/1287#issuecomment-210955517\n  \n    @knusbaum I added the JIRA ticket and updated the title a while ago. Are you the person who will actually perform the merge?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-17T04:44:19.762+0000","updated":"2016-04-17T04:44:19.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15268443","id":"15268443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/1287#issuecomment-216483408\n  \n    @moesol Sorry to participate too lately.\n    Could you craft the pull request based on master, 1.x-branch, and 0.10.x-branch? If you mind to craft several pull requests for the same, you can craft only one PR which is against the master branch.\n    \n    FYI, IMO, since we release Apache Storm 1.0.0, we can't handle 4 main version lines concurrently so fixing this at 0.9.x-branch doesn't make sense for now.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-03T09:53:02.612+0000","updated":"2016-05-03T09:53:02.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15269303","id":"15269303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mr.robert.hastings%40gmail.com","name":"mr.robert.hastings@gmail.com","key":"mr.robert.hastings@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Hastings","active":true,"timeZone":"Etc/UTC"},"body":"Sure, in progress.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mr.robert.hastings%40gmail.com","name":"mr.robert.hastings@gmail.com","key":"mr.robert.hastings@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Hastings","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-03T18:28:37.156+0000","updated":"2016-05-03T18:28:37.156+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15269570","id":"15269570","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user moesol opened a pull request:\n\n    https://github.com/apache/storm/pull/1391\n\n    (STORM-1674) Idle KafkaSpout consumes more bandwidth than needed\n\n    * Allows minBytes in fetch request to be configured\n      from KafkaConfig.fetchMinBytes.\n    * Defaults new configuration KafkaConfig.fetchMinBytes to 1.\n    * Defaults fetchMaxWait to 100ms instead of 10000ms.\n    \n    Discovered 30 megabits of traffic flowing between a set of KafkaSpouts\n    and our kafka servers even though no Kafka messages were moving.\n    Using the wireshark kafka dissector, we were able to see that\n    each FetchRequest had maxWait set to 10000\n    and minBytes set to 0. When binBytes is set to 0 the kafka server\n    responds immediately when there are no messages. In turn the KafkaSpout\n    polls without any delay causing a constant stream of FetchRequest/\n    FetchResponse messages. Using a non-KafkaSpout client had a similar\n    traffic pattern with two key differences\n    1) minBytes was 1\n    2) maxWait was 100\n    With these FetchRequest parameters and no messages flowing,\n    the kafka server delays the FetchResponse by 100 ms. This reduces\n    the network traffic from megabits to the low kilobits. It also\n    reduced the CPU utilization of our kafka server from 140% to 2%.\n    \n    Hopefully the risk of this change is low because\n    the old behavior can be restored using the API by setting\n    KafkaConfig.fetchMaxWait to 10000\n    KafkaConfig.fetchMinBytes to 0\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/MoebiusSolutions/storm 0.10.x-branch\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/1391.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #1391\n    \n----\ncommit ea1d3189c8113cc2888366fa5b24579776279886\nAuthor: Robert Hastings <rhastings@moesol.com>\nDate:   2016-03-31T23:14:47Z\n\n    Addresses network flood from KafkaSpout to kafka server.\n    \n    * Allows minBytes in fetch request to be configured\n      from KafkaConfig.fetchMinBytes.\n    * Defaults new configuration KafkaConfig.fetchMinBytes to 1.\n    * Defaults fetchMaxWait to 100ms instead of 10000ms.\n    \n    Discovered 30 megabits of traffic flowing between a set of KafkaSpouts\n    and our kafka servers even though no Kafka messages were moving.\n    Using the wireshark kafka dissector, we were able to see that\n    each FetchRequest had maxWait set to 10000\n    and minBytes set to 0. When binBytes is set to 0 the kafka server\n    responds immediately when there are no messages. In turn the KafkaSpout\n    polls without any delay causing a constant stream of FetchRequest/\n    FetchResponse messages. Using a non-KafkaSpout client had a similar\n    traffic pattern with two key differences\n    1) minBytes was 1\n    2) maxWait was 100\n    With these FetchRequest parameters and no messages flowing,\n    the kafka server delays the FetchResponse by 100 ms. This reduces\n    the network traffic from megabits to the low kilobits. It also\n    reduced the CPU utilization of our kafka server from 140% to 2%.\n    \n    Hopefully the risk of this change is low because\n    the old behavior can be restored using the API by setting\n    KafkaConfig.fetchMaxWait to 10000\n    KafkaConfig.fetchMinBytes to 0\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-03T20:58:10.591+0000","updated":"2016-05-03T20:58:10.591+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15269582","id":"15269582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/storm/pull/1391#issuecomment-216663883\n  \n    @moesol there is patch that merged into 1.0 release https://github.com/apache/storm/pull/1309/files . Does that changes work for you. Any reason for the MaxWait to be at 100\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-03T21:03:25.074+0000","updated":"2016-05-03T21:03:25.074+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15269608","id":"15269608","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user moesol commented on the pull request:\n\n    https://github.com/apache/storm/pull/1391#issuecomment-216666896\n  \n    Without the MaxWait being set to 100, it is set to 10000, which means that the bolt will waiting for 10 seconds when no messages are available. On the 1.x branch, I was going to use:\n    \n    +    public int fetchMaxWait = FetchRequest.DefaultMaxWait();\n    +    public int fetchMinBytes = FetchRequest.DefaultMinBytes();\n    \n    to get Kafka default behavior of 100/1.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-03T21:15:34.029+0000","updated":"2016-05-03T21:15:34.029+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15269614","id":"15269614","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user moesol opened a pull request:\n\n    https://github.com/apache/storm/pull/1393\n\n    (STORM-1674) Idle KafkaSpout consumes more bandwidth than needed\n\n     * Allows minBytes in fetch request to be configured\n          from KafkaConfig.fetchMinBytes.\n        * Defaults new configuration KafkaConfig.fetchMinBytes to 1.\n        * Defaults fetchMaxWait to 100ms instead of 10000ms.\n    \n        Discovered 30 megabits of traffic flowing between a set of KafkaSpouts\n        and our kafka servers even though no Kafka messages were moving.\n        Using the wireshark kafka dissector, we were able to see that\n        each FetchRequest had maxWait set to 10000\n        and minBytes set to 0. When binBytes is set to 0 the kafka server\n        responds immediately when there are no messages. In turn the KafkaSpout\n        polls without any delay causing a constant stream of FetchRequest/\n        FetchResponse messages. Using a non-KafkaSpout client had a similar\n        traffic pattern with two key differences\n        1) minBytes was 1\n        2) maxWait was 100\n        With these FetchRequest parameters and no messages flowing,\n        the kafka server delays the FetchResponse by 100 ms. This reduces\n        the network traffic from megabits to the low kilobits. It also\n        reduced the CPU utilization of our kafka server from 140% to 2%.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/MoebiusSolutions/storm 1.x-branch\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/1393.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #1393\n    \n----\ncommit ff43309e39fb1db2bf2ae5a3d7d0972440880dca\nAuthor: Robert Hastings <rhastings@moesol.com>\nDate:   2016-05-03T20:40:56Z\n\n    Addresses network flood from KafkaSpout to kafka server.\n    \n    * Allows minBytes in fetch request to be configured\n      from KafkaConfig.fetchMinBytes.\n    * Defaults new configuration KafkaConfig.fetchMinBytes to 1.\n    * Defaults fetchMaxWait to 100ms instead of 10000ms.\n    \n    Discovered 30 megabits of traffic flowing between a set of KafkaSpouts\n    and our kafka servers even though no Kafka messages were moving.\n    Using the wireshark kafka dissector, we were able to see that\n    each FetchRequest had maxWait set to 10000\n    and minBytes set to 0. When binBytes is set to 0 the kafka server\n    responds immediately when there are no messages. In turn the KafkaSpout\n    polls without any delay causing a constant stream of FetchRequest/\n    FetchResponse messages. Using a non-KafkaSpout client had a similar\n    traffic pattern with two key differences\n    1) minBytes was 1\n    2) maxWait was 100\n    With these FetchRequest parameters and no messages flowing,\n    the kafka server delays the FetchResponse by 100 ms. This reduces\n    the network traffic from megabits to the low kilobits. It also\n    reduced the CPU utilization of our kafka server from 140% to 2%.\n    \n    Hopefully the risk of this change is low because\n    the old behavior can be restored using the API by setting\n    KafkaConfig.fetchMaxWait to 10000\n    KafkaConfig.fetchMinBytes to 0\n    \n    Conflicts:\n    \texternal/storm-kafka/src/jvm/storm/kafka/KafkaConfig.java\n    \texternal/storm-kafka/src/jvm/storm/kafka/KafkaUtils.java\n\ncommit d936ad78169283fcd8e0b8923eefc4063b59f074\nAuthor: Robert Hastings <rhastings@moesol.com>\nDate:   2016-05-03T21:19:21Z\n\n    Merge remote-tracking branch 'apache/1.x-branch' into 1.x-branch\n    \n    Conflicts:\n    \texternal/storm-kafka/src/jvm/org/apache/storm/kafka/KafkaUtils.java\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-03T21:22:15.603+0000","updated":"2016-05-03T21:22:15.603+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15286687","id":"15286687","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/storm/pull/1393#issuecomment-219730884\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-17T14:15:27.714+0000","updated":"2016-05-17T14:15:27.714+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15293928","id":"15293928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/1393#issuecomment-220683696\n  \n    +1 Nice catch!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-20T18:29:54.281+0000","updated":"2016-05-20T18:29:54.281+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15293987","id":"15293987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/1393#issuecomment-220692188\n  \n    I'm in the process of merging this. Other committers please hold off. More info to follow...\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-20T19:04:54.559+0000","updated":"2016-05-20T19:04:54.559+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15294052","id":"15294052","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/1393\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-20T19:46:49.600+0000","updated":"2016-05-20T19:46:49.600+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15294081","id":"15294081","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/1393#issuecomment-220705013\n  \n    Thanks @moesol I merged this into master, 1.x-branch and 1.0.x-branch.\n    \n    Note that with 1.0.x-branch this created a conflict, as `KafkaConfig.minFetchByte` had been introduced to do the same thing as your `KafkaConfig.fetchMinBytes` variable. These are public variables, so they make up part of the API.\n    \n    Since 1.0.1 had already been released with the `minFetchByte` varibable, to ensure backward compatibility I used the `minFetchByte` variable name across branches.\n    \n    While I prefer the variable name you chose, I think it's more important to ensure backward compatibility. :)\n    \n    Thanks again!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-20T20:02:39.888+0000","updated":"2016-05-20T20:02:39.888+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15294320","id":"15294320","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user moesol commented on the pull request:\n\n    https://github.com/apache/storm/pull/1393#issuecomment-220727660\n  \n    I think it's awesome that this change is getting in! I'll be looking out for the next release that contains this PR.<br> \n    \n    Robert Hastings, Lab SDL: 619-553-0826, Cell: 858-395-4436, Moebius: 858-455-5431x210 \n    SIPR: hasting@spawar.navy.smil.mil \n    JWICS: hasting@spawar.navy.ic.gov \n    \n    \n    From: \"P. Taylor Goetz\" <notifications@github.com> \n    To: \"apache/storm\" <storm@noreply.github.com> \n    Cc: \"rhastings\" <rhastings@moesol.com>, \"Mention\" <mention@noreply.github.com> \n    Sent: Friday, May 20, 2016 1:03:11 PM \n    Subject: Re: [apache/storm] (STORM-1674) Idle KafkaSpout consumes more bandwidth than needed (#1393) \n    \n    \n    \n    Thanks @moesol I merged this into master, 1.x-branch and 1.0.x-branch. \n    \n    Note that with 1.0.x-branch this created a conflict, as KafkaConfig.minFetchByte had been introduced to do the same thing as your KafkaConfig.fetchMinBytes variable. These are public variables, so they make up part of the API. \n    \n    Since 1.0.1 had already been released with the minFetchByte varibable, to ensure backward compatibility I used the minFetchByte variable name across branches. \n    \n    While I prefer the variable name you chose, I think it's more important to ensure backward compatibility. :) \n    \n    Thanks again! \n    \n    â€” \n    You are receiving this because you were mentioned. \n    Reply to this email directly or view it on GitHub \n    \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-05-20T21:54:54.942+0000","updated":"2016-05-20T21:54:54.942+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15369954","id":"15369954","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the issue:\n\n    https://github.com/apache/storm/pull/1287\n  \n    @moesol can you please close this PR . Its already merged here https://github.com/apache/storm/commit/f069cfb08099a54448bba3f96f20c5b929ea6af3\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-10T21:09:24.037+0000","updated":"2016-07-10T21:09:24.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15371660","id":"15371660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user moesol commented on the issue:\n\n    https://github.com/apache/storm/pull/1287\n  \n    Merged via different PR. Closing this PR.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-11T21:23:22.162+0000","updated":"2016-07-11T21:23:22.162+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12955178/comment/15371661","id":"15371661","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user moesol closed the pull request at:\n\n    https://github.com/apache/storm/pull/1287\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-11T21:23:22.673+0000","updated":"2016-07-11T21:23:22.673+0000"}],"maxResults":18,"total":18,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1674/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2vhuv:"}}