{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12776067","self":"https://issues.apache.org/jira/rest/api/2/issue/12776067","key":"STORM-678","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2015-02-19T04:40:42.930+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 19 17:54:31 UTC 2015","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_7714415_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2015-02-19T05:56:05.847+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-678/watchers","watchCount":2,"isWatching":false},"created":"2015-02-19T03:47:31.463+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["Security","Storm","storm-security"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327112","id":"12327112","name":"0.9.3","archived":false,"released":true,"releaseDate":"2014-11-25"}],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sriharsha","name":"sriharsha","key":"sriharsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sriharsha Chintalapani","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-05T01:04:19.711+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"I am using HDP 2.2 which includes fixes of  https://issues.apache.org/jira/browse/STORM-216. \n\nInstall STORM with Nagios and Ganglia, there is no HDFS, Hadoop installed on the cluster, cluster is made of three nodes. \nEnable security as guided by Ambari, kerberize the cluster this covers everything as specified in the https://github.com/apache/storm/blob/security/SECURITY.md . \n\nNow submit job from 'test' user principal from the gateway node. Open Storm UI in firefox or google-chrome it shows the topology running as 'test' user. \nNow kinit with another user 'test2' refresh the UI. It still says the 'test' user . Even closing and re-opening firefox /chrome doesnt help. It lets 'test2' user kill topology of 'test' user.\n\nThis behaviour is not observed when using storm kill command in command line","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":" Storm UI Spengo filter doesn't invalidate user session immediately upon kinit as a different user","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manishnema","name":"manishnema","key":"manishnema","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manish Nema","active":true,"timeZone":"Asia/Colombo"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manishnema","name":"manishnema","key":"manishnema","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manish Nema","active":true,"timeZone":"Asia/Colombo"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"CentOS 6.6 64bit\nJava jdk1.7.0_67\nKerberos enabled","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12776067/comment/14326986","id":"14326986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sriharsha","name":"sriharsha","key":"sriharsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sriharsha Chintalapani","active":true,"timeZone":"America/Los_Angeles"},"body":"[~manishknema] what you mean by \"Now kinit with another user 'test2' refresh the UI. It still says the 'test' user .\" . Do you still see the storm UI logged in as test user? although you kinited as test2 user? . Also can you please send an email on users@storm.apache.org . we can check with devs and users before opening a JIRA. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sriharsha","name":"sriharsha","key":"sriharsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sriharsha Chintalapani","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-02-19T04:40:42.930+0000","updated":"2015-02-19T04:40:42.930+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12776067/comment/14327025","id":"14327025","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sriharsha","name":"sriharsha","key":"sriharsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sriharsha Chintalapani","active":true,"timeZone":"America/Los_Angeles"},"body":"[~manishknema] Storm UI kerberos delegation works as expected. The issue here is we are using Hadoop Authentication filter for SPNEGO. This filter has a default value 10hours for the cookie which sets the \"token.validity\" .So if a user authenticated and grabbed the ticket its valid for 10hrs. Changing kinit from command line doesn't affect this. \nYou can add \"token.validity\" : \"4\"  this sets token validity to 4 seconds and you can see the change in the UI as switch between users as you change login with kinit. In general this is not a regular practice as users log in with one single principal. \n\nHere is the example config\nui.filter.params:\n   \"type\": \"kerberos\"\n   \"kerberos.principal\": \"HTTP/nimbus.witzend.com@WITZEND.COM\"\n   \"kerberos.keytab\": \"/vagrant/keytabs/http.keytab\"\n   \"kerberos.name.rules\": \"RULE:[2:$1@$0]([jt]t@.*EXAMPLE.COM)s/.*/$MAPRED_USER/ RULE:[2:$1@$0]([nd]n@.*EXAMPLE.COM)s/.*/$HDFS_USER/DEFAULT\"\n   \"token.validity\": \"4\"\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sriharsha","name":"sriharsha","key":"sriharsha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sriharsha Chintalapani","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-02-19T05:55:17.982+0000","updated":"2015-02-19T05:56:50.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12776067/comment/14327802","id":"14327802","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manishnema","name":"manishnema","key":"manishnema","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manish Nema","active":true,"timeZone":"Asia/Colombo"},"body":"[~harsha_ch] Thanks, this seems to be working as expected, \n\nThis might be required as one can dedicate few nodes as edge/gateway node where users can login and submit/view their job in secured cluster.\n\nThis change requires change in jinja scripts comes with Ambari ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manishnema","name":"manishnema","key":"manishnema","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manish Nema","active":true,"timeZone":"Asia/Colombo"},"created":"2015-02-19T17:54:31.175+0000","updated":"2015-02-19T17:54:31.175+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-678/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i25slj:"}}