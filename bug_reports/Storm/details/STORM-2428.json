{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13057959","self":"https://issues.apache.org/jira/rest/api/2/issue/13057959","key":"STORM-2428","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-04-13T16:36:43.469+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jul 26 23:54:25 UTC 2018","customfield_12312320":null,"customfield_12310222":null,"customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2428/watchers","watchCount":4,"isWatching":false},"created":"2017-03-21T16:40:17.836+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12335748","id":"12335748","name":"1.1.0","archived":false,"released":true,"releaseDate":"2017-03-29"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12337341","id":"12337341","name":"1.0.3","archived":false,"released":true,"releaseDate":"2017-02-14"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342766","id":"12342766","name":"1.2.1","archived":false,"released":true,"releaseDate":"2018-02-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342807","id":"12342807","name":"1.2.2","archived":false,"released":true,"releaseDate":"2018-06-04"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-07-26T23:54:25.751+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327322","id":"12327322","name":"Flux","description":"Flux"}],"timeoriginalestimate":null,"description":"The jar file for flux-core contains classes from /org/apache/http/. This was not the case before and causes problems with projects which rely on a different version of http-client. \nI can't see any references to http-client in the pom though.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Flux-core jar contains unpacked dependencies","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jnioche","name":"jnioche","key":"jnioche","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jnioche&avatarId=10040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jnioche&avatarId=10040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jnioche&avatarId=10040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jnioche&avatarId=10040"},"displayName":"Julien Nioche","active":true,"timeZone":"Europe/London"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jnioche","name":"jnioche","key":"jnioche","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jnioche&avatarId=10040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jnioche&avatarId=10040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jnioche&avatarId=10040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jnioche&avatarId=10040"},"displayName":"Julien Nioche","active":true,"timeZone":"Europe/London"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":"https://github.com/DigitalPebble/storm-crawler/issues/437","duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13057959/comment/15967842","id":"15967842","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matthewdfleming","name":"matthewdfleming","key":"matthewdfleming","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matthew Fleming","active":true,"timeZone":"America/Chicago"},"body":"+1 on this.. I think you should be shading those dependencies into different packages. If you look at _storm-core_, the shaded packages are under _org.apache.storm.shade_ which works really well.\n\n[~jnioche] the way I'm getting around this is the ordering within my pom.. if you put the dependency (that is in the jar but not the version you want to use) before the flux dependencies, the classpath ordering is maintained by maven. I haven't tried it in the shaded jar (for deployment) but there it's pretty ez to just strip out the non-shaded dependencies from within the flux-core jars on that but maybe the shade jar also considers the order of the dependencies (again don't know just yet)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matthewdfleming","name":"matthewdfleming","key":"matthewdfleming","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matthew Fleming","active":true,"timeZone":"America/Chicago"},"created":"2017-04-13T16:36:43.469+0000","updated":"2017-04-13T16:36:43.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13057959/comment/16366751","id":"16366751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rzo1","name":"rzo1","key":"rzo1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rzo1&avatarId=27148","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rzo1&avatarId=27148","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rzo1&avatarId=27148","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rzo1&avatarId=27148"},"displayName":"Richard Zowalla","active":true,"timeZone":"Europe/Berlin"},"body":"I solved this issue by extracting / filtering this dependencies in the shading process:\r\n{code:java}\r\n<filter>\r\n <!-- we need to exclude some shaded and old stuff here which comes in a modern version via ES artifacts-->\r\n <artifact>org.apache.storm:flux-core</artifact>\r\n <excludes>\r\n <exclude>org/apache/commons/**</exclude>\r\n <exclude>org/apache/http/**</exclude>\r\n <exclude>org/yaml/**</exclude>\r\n </excludes>\r\n</filter>{code}\r\nHowever, I think that making flux-core a fat jar with some (very old) dependencies is not a good solution.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rzo1","name":"rzo1","key":"rzo1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rzo1&avatarId=27148","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rzo1&avatarId=27148","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rzo1&avatarId=27148","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rzo1&avatarId=27148"},"displayName":"Richard Zowalla","active":true,"timeZone":"Europe/Berlin"},"created":"2018-02-16T09:11:44.517+0000","updated":"2018-02-16T09:11:44.517+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13057959/comment/16559058","id":"16559058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mal","name":"mal","key":"mal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mal Graty","active":true,"timeZone":"Etc/UTC"},"body":"Also found this being a fat jar confusing. That it includes flux-wrappers as a dependency, which the docs say should be added to your project independently if being used, is also a bit perplexing when trying to work out why build tools are getting file conflicts (even if they auto-resolve). :/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mal","name":"mal","key":"mal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mal Graty","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-26T23:54:25.751+0000","updated":"2018-07-26T23:54:25.751+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2428/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3cl8v:"}}