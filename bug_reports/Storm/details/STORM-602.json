{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12763527","self":"https://issues.apache.org/jira/rest/api/2/issue/12763527","key":"STORM-602","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2015-06-15T16:13:20.152+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Feb 05 20:58:49 UTC 2016","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_35665430068_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2016-02-09T14:32:44.642+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-602/watchers","watchCount":4,"isWatching":false},"created":"2014-12-23T19:28:54.634+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327112","id":"12327112","name":"0.9.3","archived":false,"released":true,"releaseDate":"2014-11-25"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-02-09T14:32:44.694+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324395","id":"12324395","name":"storm-hdfs","description":"Storm HDFS Integration"}],"timeoriginalestimate":null,"description":"When the hadoop nodes are not available, HdfsBolt generates the following run time error, and dies and the topology dies with it too.\n\n12154 [Thread-50-hdfsBolt2] ERROR backtype.storm.util - Halting process: (\"Worker died\")\njava.lang.RuntimeException: (\"Worker died\")\n        at backtype.storm.util$exit_process_BANG_.doInvoke(util.clj:319) [storm-core-0.9.3-SNAPSHOT.jar:0.9.3-SNAPSHOT]\n        at clojure.lang.RestFn.invoke(RestFn.java:423) [clojure-1.5.1.jar:na]\n        at backtype.storm.daemon.worker$fn__4770$fn__4771.invoke(worker.clj:452) [storm-core-0.9.3-SNAPSHOT.jar:0.9.3-SNAPSHOT]\n        at backtype.storm.daemon.executor$mk_executor_data$fn__3287$fn__3288.invoke(executor.clj:239) [storm-core-0.9.3-SNAPSHOT.jar:0.9.3-SNAPSHOT]\n        at backtype.storm.util$async_loop$fn__458.invoke(util.clj:467) [storm-core-0.9.3-SNAPSHOT.jar:0.9.3-SNAPSHOT]\n        at clojure.lang.AFn.run(AFn.java:24) [clojure-1.5.1.jar:na]\n        at java.lang.Thread.run(Thread.java:745) [na:1.7.0_65]\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"HdfsBolt dies when the hadoop node is not available","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=clayteahouse","name":"clayteahouse","key":"clayteahouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"clay teahouse","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=clayteahouse","name":"clayteahouse","key":"clayteahouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"clay teahouse","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Ubuntu 14.04","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763527/comment/14257536","id":"14257536","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=clayteahouse","name":"clayteahouse","key":"clayteahouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"clay teahouse","active":true,"timeZone":"Etc/UTC"},"body":"Further information on the issue:\n1) When starting the topology, if the hadoop nodes are not available, you get \"worker died\" message and HdfsBolt and the entire topology die.\njava.lang.RuntimeException: (\"Worker died\")\n......\n2) If the topology is running and then the hadoop nodes become unavailable, you get connection refused error. When hadoop nodes become available, the HdfsBolt never recovers. It keeps giving the following error:\n org.apache.storm.hdfs.bolt.HdfsBolt - write/sync failed.\n All datanodes ....... are bad. Aborting...\n        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1008) ~[hadoop-hdfs-2.2.0.jar:na]\n        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:823) ~[hadoop-hdfs-2.2.0.jar:na]\n        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:475) ~[hadoop-hdfs-2.2.0.jar:na]\nIf you restart the topology, everything is OK and HdfsBolt can write to the hdfs nodes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=clayteahouse","name":"clayteahouse","key":"clayteahouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"clay teahouse","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-23T21:08:39.956+0000","updated":"2014-12-23T21:08:39.956+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763527/comment/14586254","id":"14586254","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=snd","name":"snd","key":"snd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=snd&avatarId=23730","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=snd&avatarId=23730","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=snd&avatarId=23730","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=snd&avatarId=23730"},"displayName":"Tom Wesch","active":true,"timeZone":"Europe/Berlin"},"body":"We're experiencing the same problem, especially the second issue. It seems that updating {{hadoop-client}} and {{hadoop-hdfs}} in the [storm-hdfs pom.xml|https://github.com/apache/storm/blob/v0.9.3/external/storm-hdfs/pom.xml] to {{2.5.2}} (our Hadoop is Hadoop 2.5.0-cdh5.2.0) fixed the issue.\n\nCould someone verify this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=snd","name":"snd","key":"snd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=snd&avatarId=23730","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=snd&avatarId=23730","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=snd&avatarId=23730","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=snd&avatarId=23730"},"displayName":"Tom Wesch","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-15T16:13:20.152+0000","updated":"2015-06-15T16:30:42.064+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763527/comment/14934535","id":"14934535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dossett%40gmail.com","name":"dossett@gmail.com","key":"dossett@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Dossett","active":true,"timeZone":"America/Chicago"},"body":"The second problem (\"When hadoop nodes become available, the HdfsBolt never recovers.\") has been resolved by STORM-969.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dossett%40gmail.com","name":"dossett@gmail.com","key":"dossett@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Dossett","active":true,"timeZone":"America/Chicago"},"created":"2015-09-29T02:50:56.644+0000","updated":"2015-09-29T02:50:56.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763527/comment/14943408","id":"14943408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dossett%40gmail.com","name":"dossett@gmail.com","key":"dossett@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Dossett","active":true,"timeZone":"America/Chicago"},"body":"My tentative conclusion is that the first error is not a defect.  If the hadoop cluster is down at startup, failing the topology seems reasonable.  Without being able to establish a connection to HDFS and open a file there's no guarantee that the submitted configuration would ever work when Hadoop comes back online.  Failing at the outset seems like the better option.\n\nOther thoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dossett%40gmail.com","name":"dossett@gmail.com","key":"dossett@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Dossett","active":true,"timeZone":"America/Chicago"},"created":"2015-10-05T14:20:43.009+0000","updated":"2015-10-05T14:20:43.009+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763527/comment/15134975","id":"15134975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dossett%40gmail.com","name":"dossett@gmail.com","key":"dossett@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Dossett","active":true,"timeZone":"America/Chicago"},"body":"If nobody objects, I will close this ticket as \"not a problem\" based on my previous comment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dossett%40gmail.com","name":"dossett@gmail.com","key":"dossett@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Dossett","active":true,"timeZone":"America/Chicago"},"created":"2016-02-05T20:58:49.345+0000","updated":"2016-02-05T20:58:49.345+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-602/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i23qif:"}}