{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12714927","self":"https://issues.apache.org/jira/rest/api/2/issue/12714927","key":"STORM-323","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat May 31 00:53:54 UTC 2014","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1204972356_*|*_5_*:*_1_*:*_0","customfield_12310420":"393240","customfield_12312321":null,"resolutiondate":"2014-05-31T00:53:54.447+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-323/watchers","watchCount":3,"isWatching":false},"created":"2014-05-17T02:11:02.137+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326788","id":"12326788","name":"0.9.1-incubating","archived":false,"released":true,"releaseDate":"2014-02-10"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-05T02:13:17.134+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"Symptoms observed:\n1. One of the bolts not getting executed after about 5 days of run\n2. Spout gradually slows down and finally stops calling nextTuple()\n3. Topology is non-functional since there is no exchange of tuples across worker processes\n\nNotes from troubleshooting:\n1. There is a transfer of data across worker processes but the bolt is not receiving the tuples\n2. backtype.storm.messaging.netty.Server#message_queue is not getting consumed.\n3. Later on found that there are several __tick and __metrics_tick tuples piling up in memory over a period of time. This piling up is gradual and probably the reason why it takes so long for it to cause any visible problems.\n\nI have shared access to thread dumps and topology layout at https://drive.google.com/folderview?id=0B2F_3UACQZNESXpwZlA4MFlqSVU&usp=drive_web\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"393402","customfield_12312823":null,"summary":"Unacknowledged __tick and __metrics_tick tuples hangs worker processes","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Storm:\nNimbus, Supervisor and Zookeeper running on Centos 6.2 over m1.small instances (1.7G mem, 1 CPU, 1 core)\nNetty as the transport\n\nTopology:\n2 worker processes on the same supervisor instance each allocated 512 Mb of heap\nEach of the worker processes have around 30 executors running around 112 tasks.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714927/comment/14000615","id":"14000615","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"body":"The discussions over mailing list also provide some information:\nUser list:\nhttp://mail-archives.apache.org/mod_mbox/storm-user/201405.mbox/%3cCAHhx-GLJPrs-h2wUBE-aNT33UeS2-sUkAiuqR=2Kg2+jusfvjQ@mail.gmail.com%3e\n\nDev list:\nhttp://mail-archives.apache.org/mod_mbox/storm-dev/201405.mbox/ajax/%3CCAHhx-GLzaKeYZbD1B6YQQkxRfPOPxvrZUVf1v85ch3u82xriLw%40mail.gmail.com%3E","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-17T02:13:49.547+0000","updated":"2014-05-17T02:13:49.547+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714927/comment/14000629","id":"14000629","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"body":"I'm willing to provide access to an instance running jhat over the heap dumps of the worker processes if required.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-17T02:27:45.333+0000","updated":"2014-05-17T02:27:45.333+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714927/comment/14014430","id":"14014430","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"body":"This issue was debugged and the root cause was due to a spout blocking on a queue for prolonged duration of time.\nThe spout would only unblock itself upon some activity that was rarely occurring. Once this was corrected, the issue has not been seen again. Heap dumps do not show any signs of these tuples getting accumulated.\n\nOn a side note, the following would have helped in troubleshooting:\n1. Looking into the dumps, it wasn't possible to trace the spout/bolt whose RingBuffers held these unacked tuples. \n2. Some documentation on the internals like async_loop, RingBuffer, etc just for the sake of those who are not familiar with clojure","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-31T00:49:24.801+0000","updated":"2014-05-31T00:49:24.801+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714927/comment/14014431","id":"14014431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"body":"Marking this as invalid since this was due to spout blocking on a queue and not releasing storm's executor thread.\nThe javadoc for nextTuple clearly mentions that it should be non-blocking.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srinath.c","name":"srinath.c","key":"srinath.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Srinath","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-31T00:53:54.480+0000","updated":"2014-05-31T00:53:54.480+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-323/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1vpr3:"}}