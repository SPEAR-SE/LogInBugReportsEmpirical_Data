{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12924283","self":"https://issues.apache.org/jira/rest/api/2/issue/12924283","key":"STORM-1419","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329843","id":"12329843","name":"1.0.0","archived":false,"released":true,"releaseDate":"2016-04-12"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-12-25T10:35:25.936+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jan 13 17:23:39 UTC 2016","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1667552211_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2016-01-13T17:23:39.910+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1419/watchers","watchCount":3,"isWatching":false},"created":"2015-12-25T10:11:07.739+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vesense","name":"vesense","key":"vesense","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vesense&avatarId=25513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vesense&avatarId=25513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vesense&avatarId=25513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vesense&avatarId=25513"},"displayName":"Xin Wang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-01-13T17:23:39.944+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327954","id":"12327954","name":"storm-solr","description":"Storm Solr Integration"}],"timeoriginalestimate":null,"description":"Solr bolt should handle tick tuples.\nForcing solr client commit when bolt received tick tuple.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Solr bolt should handle tick tuples","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vesense","name":"vesense","key":"vesense","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vesense&avatarId=25513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vesense&avatarId=25513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vesense&avatarId=25513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vesense&avatarId=25513"},"displayName":"Xin Wang","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vesense","name":"vesense","key":"vesense","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vesense&avatarId=25513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vesense&avatarId=25513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vesense&avatarId=25513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vesense&avatarId=25513"},"displayName":"Xin Wang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15071497","id":"15071497","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user vesense opened a pull request:\n\n    https://github.com/apache/storm/pull/977\n\n    [STORM-1419] Solr bolt should handle tick tuples\n\n    \n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/vesense/storm STORM-1419\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/977.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #977\n    \n----\ncommit 397733c054c3ba120bc6670f54e5d56398969180\nAuthor: Xin Wang <best.wangxin@163.com>\nDate:   2015-12-25T10:20:42Z\n\n    solr bolt should handle tick tuples\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-25T10:35:25.936+0000","updated":"2015-12-25T10:35:25.936+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15081774","id":"15081774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-168801983\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-04T20:46:05.139+0000","updated":"2016-01-04T20:46:05.139+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15082127","id":"15082127","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48802421\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    +                commitStgy.commit();\n    --- End diff --\n    \n    Shouldn't we make it consistent with the else statement?\n    I mean, shouldn't we check the return value of commitStgy.commit() and do other actions?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T00:58:52.644+0000","updated":"2016-01-05T00:58:52.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083279","id":"15083279","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user dossett commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48859713\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    Should tick tuples be ack'd?  I believe that is an open question in another PR.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T15:58:17.485+0000","updated":"2016-01-05T15:58:17.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083280","id":"15083280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user dossett commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48859729\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    +                commitStgy.commit();\n                     solrClient.commit(solrMapper.getCollection());\n                     ackCommittedTuples();\n    +            } else {\n    +                toCommitTuples.add(tuple);\n    +                commitStgy.update();\n    +                if (commitStgy.commit()) {\n    --- End diff --\n    \n    The strategy in AbstractHdfsBolt is to set a boolean in the case of a tick tuple and then sync if that value is true or if other conditions dictate a sync.  (https://github.com/apache/storm/blob/master/external/storm-hdfs/src/main/java/org/apache/storm/hdfs/bolt/AbstractHdfsBolt.java#L154) \n    \n    The benefit of that approach is to eliminate duplicate code (i.e. that calls to ackCommittedTuples() and solrClient.commit()), which I think is a substantial benefit.\n    \n    Here that would looks something like:\n    \n    ```code\n    if (forceCommit || commitStgy.commit()) {\n      solrClient.commit(solrMapper.getCollection());\n      ackCommittedTuples();\n    }\n    ```\n    With duplicate code removed I would be +1\n    \n    A unit test would also be helpful. HdfsBolt example is here: https://github.com/apache/storm/blob/master/external/storm-hdfs/src/test/java/org/apache/storm/hdfs/bolt/TestHdfsBolt.java#L175\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T15:58:23.779+0000","updated":"2016-01-05T15:58:23.779+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083385","id":"15083385","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48869637\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    Yes, tick tuples should be ack'd.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T17:16:28.440+0000","updated":"2016-01-05T17:16:28.440+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083587","id":"15083587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169101930\n  \n    The code changes looks OK. I am not an expert on the Solr code, but I do have a few concerns. \n    \n    In response to comments from @HeartSaVioR and @dossett.  It looks like the `commitStgy.commit()` is not needed at all.  That method appears to return a true if a commit should happen. We are forcing a commit with the tick tuple so calling it and checking the response is not needed.  Which brings up my concern.  There is no documentation in CommitStrategy about how it is intended to be used.  Which methods are called when, etc.  Without them it is hard to tell if we are violating some type of contract by making this change.  For now I think this is OK, but it would be good to add in that documentation, and I would love it to see another method added to the commit strategy (perhaps beyond the scope of this code). That indicates a commit happened.  So it would look something like.\n    \n    ```\n    /**\n     * Strategy defining when the Solr Bolt should commit the request batch to Solr.\n     */\n    public interface SolrCommitStrategy extends Serializable {\n        /**\n         * @return true of a commit should happen.\n         */\n        boolean shouldCommit();\n    \n        /**\n         * Indicates that a commit occurred. This may happen even if shouldCommit returned false, or was not even called at all to indicate that a commit was forced.\n         */\n        void commitHappened();\n    \n        /**\n         * Indicates that a tuple was added to the current batch.\n         */\n        void update();\n    }\n    ```\n    \n    The current count code has issues because it does not know that the commit happened, so it uses a modulo with a check for 0, which means we could get really odd situations where a commit was forced because of a timeout, but the next batch only has a single entry in it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T19:17:12.695+0000","updated":"2016-01-05T19:17:12.695+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083783","id":"15083783","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48895950\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    +                commitStgy.commit();\n    --- End diff --\n    \n    Sorry I didn't check code deeply.\n    SolrCommitStrategy.commit() just checks whether it is time to commit or not, so in this case it shouldn't check return value.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T21:04:17.507+0000","updated":"2016-01-05T21:04:17.507+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083916","id":"15083916","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169146734\n  \n    I am not an expert on the Solr code, and Solr itself. So below comment may need to have corrections via other contributors / committers.\n    \n    Looking into SolrCommitStrategy and CountBasedCommit I feel the same thing with @revans2.\n    State for the SolrCommitStrategy could be out of sync because it cannot know `internal commit` (not requested via commit()) yet, and looking into javadoc for SolrClient, there's no way to check internal commit.\n    \n    Here's description for rollback, which describes the internal commit.\n    https://lucene.apache.org/solr/5_2_0/solr-solrj/org/apache/solr/client/solrj/SolrClient.html#rollback()\n    \n    > rollback\n    >\n    >Performs a rollback of all non-committed documents pending. Note that this is not a true rollback as in databases. Content you have previously added may have been committed due to autoCommit, buffer full, other client performing a commit etc.\n    \n    Based on internal commit, I see current code has an issue, which could be minor, or maybe major.\n    \n    > There could be some requests which are committed internally via Solr but not acked / failed via Bolt's side. (It will be resolved when SolrUpdateBolt deals with tick tuple.) It means acknowledges of some tuples can be lost though tuples are committed to Solr.\n    \n    If we intend to let requests buffered and in perfect sync with ack / fail, I think it shouldn't request for each execute() but just stores requests and do actual requests / external commit to Solr / ack & fail when commit condition has been made.\n    \n    Or if we don't need to be accurate, I'm fine with the code change.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T21:58:30.133+0000","updated":"2016-01-05T21:58:30.133+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083920","id":"15083920","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user dossett commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169147171\n  \n    I am not familiar with all the ways that bolts can receive tick tuples, but does SolrBolt also need a way to specify that it should receive tick tuples at all?  The hdfs-bolt way of doing that is here:\n    \n    https://github.com/apache/storm/blob/master/external/storm-hdfs/src/main/java/org/apache/storm/hdfs/bolt/AbstractHdfsBolt.java#L221\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T22:00:28.649+0000","updated":"2016-01-05T22:00:28.649+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083937","id":"15083937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169150861\n  \n    @dossett Yes, you're right. SolrUpdateBolt should force setting up tick tuple since without tick tuple we may get odd situation @revans2 and I stated.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T22:15:22.817+0000","updated":"2016-01-05T22:15:22.817+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15083939","id":"15083939","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169151251\n  \n    @vesense Could you handle what @dossett stated?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-05T22:17:01.163+0000","updated":"2016-01-05T22:17:01.163+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15084973","id":"15084973","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user arunmahadevan commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48927497\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    Tick tuples are not generated from a spout but inserted periodically into the executor receive-queue. Since tick-tuples are not tracked by the acker, I dont think it needs to be acked. Acking it does not cause any harm but unnecessary. Correct me if I am overlooking something.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T04:47:53.385+0000","updated":"2016-01-06T04:47:53.385+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15085076","id":"15085076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user satishd commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48931925\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    I am also not sure why tick-tuples need to be acked as @arunmahadevan mentioned. Whenever an executor is started it schedules a timer which sends tick tuples to receive queue \n    \n    ``` clojure\n    (defn setup-ticks! [worker executor-data]\n      (let [storm-conf (:storm-conf executor-data)\n            tick-time-secs (storm-conf TOPOLOGY-TICK-TUPLE-FREQ-SECS)\n            receive-queue (:receive-queue executor-data)\n            context (:worker-context executor-data)]\n        (when tick-time-secs\n          (if (or (Utils/isSystemId (:component-id executor-data))\n                  (and (= false (storm-conf TOPOLOGY-ENABLE-MESSAGE-TIMEOUTS))\n                       (= :spout (:type executor-data))))\n            (log-message \"Timeouts disabled for executor \" (:component-id executor-data) \":\" (:executor-id executor-data))\n            (schedule-recurring\n              (:user-timer worker)\n              tick-time-secs\n              tick-time-secs\n              (fn []\n                (let [val [(AddressedTuple. AddressedTuple/BROADCAST_DEST (TupleImpl. context [tick-time-secs] Constants/SYSTEM_TASK_ID Constants/SYSTEM_TICK_STREAM_ID))]]\n                  (disruptor/publish receive-queue val))))))))\n    ```\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T06:51:52.712+0000","updated":"2016-01-06T06:51:52.712+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15085112","id":"15085112","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169256465\n  \n    @hmcl  can you review this.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T07:22:54.404+0000","updated":"2016-01-06T07:22:54.404+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15085141","id":"15085141","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r48933699\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,11 +94,19 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    no need for tick tuples to be acked. We've similar thing in storm-hive and we don't ack tick tuples.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T07:36:11.738+0000","updated":"2016-01-06T07:36:11.738+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15085194","id":"15085194","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169265399\n  \n    Respond to @dossett comments:\n    > I am not familiar with all the ways that bolts can receive tick tuples, but does SolrBolt also need a way to specify that it should receive tick tuples at all?\n    \n    To my knowledge, there are two ways that bolts can receive tick tuples. One is global setting when building topology.\n    ```\n    Config config = new Config();\n    config.put(Config.TOPOLOGY_TICK_TUPLE_FREQ_SECS, 5);\n    ``` \n    \n    The other one is local setting in bolt.\n    ```\n    @Override\n    public Map<String, Object> getComponentConfiguration() {\n        Map<String, Object> conf = new HashMap<String, Object>();\n        conf.put(Config.TOPOLOGY_TICK_TUPLE_FREQ_SECS, 4);\n        return conf;\n    }\n    ```\n    \n    All bolt tasks will receive tick tuples in the same interval when existing global setting.\n    Once we set `Config.TOPOLOGY_TICK_TUPLE_FREQ_SECS` in bolt Foo `getComponentConfiguration()`, the value will override the global setting.\n    And bolt Foo tasks will receive tick tuples in a interval different with other tasks.\n    \n    So, it is not necessary to add `Config.TOPOLOGY_TICK_TUPLE_FREQ_SECS` in  `getComponentConfiguration()`. It depends on the user scenario. \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T08:27:09.539+0000","updated":"2016-01-06T08:27:09.539+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15085209","id":"15085209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169267211\n  \n    @vesense \n    Please read https://github.com/apache/storm/pull/977#issuecomment-169101930 and https://github.com/apache/storm/pull/977#issuecomment-169146734.\n    \n    Easily thinkable edge case is, Solr can commit pending requests internally, but SolrUpdateBolt still has tuples in pending state for ack. It means we should always set tick tuple to commit externally.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T08:38:31.286+0000","updated":"2016-01-06T08:38:31.286+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15085561","id":"15085561","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user dossett commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169330085\n  \n    @vesense Thanks for the info about the global configuration. Aside from the issues @HeartSaVioR brings up, I think adding bolt-level option for tick tuples to the solr bolt is necessary. Without that, the only way for a user to enable ticks for the solr bolt is to enable them for the entire topology.  That's very different than the other output bolts (hdfs, hive) that support ticks.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T14:01:35.683+0000","updated":"2016-01-06T14:01:35.683+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15086150","id":"15086150","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169436285\n  \n    I would like to suggest that we address the tick tuples as follows: \n    ![screen shot 2016-01-06 at 11 35 23 am](https://cloud.githubusercontent.com/assets/10284328/12152537/24eaab12-b46a-11e5-8513-aa568d3b2093.png)\n    \n    \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T19:39:34.374+0000","updated":"2016-01-06T19:39:34.374+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15086153","id":"15086153","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169437074\n  \n    @hmcl \n    If we think we don't need to ack tick tuple, ignoring tick tuple from execute() first would be more clearer.\n    Then we don't need to take care of tick tuple from ack().\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T19:42:38.898+0000","updated":"2016-01-06T19:42:38.898+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15086162","id":"15086162","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169438537\n  \n    @HeartSaVioR All the tuples that have already been batched will still need to be acked, therefore we cannot simply ignore the tick tuple. All I am doing is that when calling ack() I don't add the tick tuple to the queue of tuples that need to be acked.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T19:48:10.319+0000","updated":"2016-01-06T19:48:10.319+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15086166","id":"15086166","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169439287\n  \n    @hmcl You're right. My bad. :)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T19:50:38.461+0000","updated":"2016-01-06T19:50:38.461+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15086174","id":"15086174","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169440883\n  \n    What @hmcl is suggesting also fixes the bug that trying to convert tick tuple to Solr request and do actual request. Great finding.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T19:57:03.520+0000","updated":"2016-01-06T19:57:03.520+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15086184","id":"15086184","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169441633\n  \n    @revans2 your points are valid, as there may be scenarios where we may end up committing very small batches, which may cause some performance degradation, but in my opinion that would only be a concern if they are likely to happen. Nevertheless, to address your points I have created https://issues.apache.org/jira/browse/STORM-1442\n    \n    Concerning your comment \" It looks like the commitStgy.commit() is not needed at all. \" I believe we still need it to address the cases where the batch is complete, no tick tuples came in, and we want to commit the batch.\n    \n    \n    \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-06T20:00:24.526+0000","updated":"2016-01-06T20:00:24.526+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088291","id":"15088291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49136454\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,9 +108,17 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            boolean forceCommit = false;\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    +                forceCommit = true;\n    +            } else {\n    +                toCommitTuples.add(tuple);\n    +                commitStgy.update();\n    +            }\n    +\n    +            if (forceCommit || commitStgy.commit()) {\n    --- End diff --\n    \n    @vesense Can you please follow te suggestion that I gave as the code is much cleaner.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-07T22:37:14.459+0000","updated":"2016-01-07T22:37:14.459+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088292","id":"15088292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49136481\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,9 +108,17 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            boolean forceCommit = false;\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    tick tuples don't need to be acked\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-07T22:37:28.221+0000","updated":"2016-01-07T22:37:28.221+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088297","id":"15088297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49136662\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -131,6 +155,26 @@ private void failQueuedTuples(List<Tuple> failedTuples) {\n             return queuedTuples;\n         }\n     \n    +    public SolrUpdateBolt withTickIntervalSecs(int tickTupleInterval) {\n    --- End diff --\n    \n    @vesense this violates encapsulation and should be avoided\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-07T22:39:10.899+0000","updated":"2016-01-07T22:39:10.899+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088321","id":"15088321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49138053\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -59,16 +64,24 @@ public SolrUpdateBolt(SolrConfig solrConfig, SolrMapper solrMapper, SolrCommitSt\n             this.solrConfig = solrConfig;\n             this.solrMapper = solrMapper;\n             this.commitStgy = commitStgy;\n    -        logger.debug(\"Created {} with the following configuration: \" +\n    +        LOG.debug(\"Created {} with the following configuration: \" +\n                         \"[SolrConfig = {}], [SolrMapper = {}], [CommitStgy = {}]\",\n                         this.getClass().getSimpleName(), solrConfig, solrMapper, commitStgy);\n         }\n     \n    +    @Override\n         public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {\n             this.collector = collector;\n             this.solrClient = new CloudSolrClient(solrConfig.getZkHostString());\n             this.toCommitTuples = new ArrayList<>(capacity());\n     \n    +        //set default tickTupleInterval if interval is zero\n    +        if (stormConf.containsKey(\"topology.message.timeout.secs\") && tickTupleInterval == 0) {\n    --- End diff --\n    \n    @vesense  This code should go in the SolrConfig object\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-07T22:52:31.788+0000","updated":"2016-01-07T22:52:31.788+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088678","id":"15088678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49157203\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,9 +108,17 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            boolean forceCommit = false;\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    +                forceCommit = true;\n    +            } else {\n    +                toCommitTuples.add(tuple);\n    +                commitStgy.update();\n    +            }\n    +\n    +            if (forceCommit || commitStgy.commit()) {\n    --- End diff --\n    \n    OK\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T04:19:42.386+0000","updated":"2016-01-08T04:19:42.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088679","id":"15088679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49157210\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,9 +108,17 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            boolean forceCommit = false;\n    +            if (TupleUtils.isTick(tuple)) {\n    +                LOG.debug(\"TICK! forcing solr client commit\");\n    +                collector.ack(tuple);\n    --- End diff --\n    \n    OK\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T04:19:49.793+0000","updated":"2016-01-08T04:19:49.793+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088680","id":"15088680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49157240\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -131,6 +155,26 @@ private void failQueuedTuples(List<Tuple> failedTuples) {\n             return queuedTuples;\n         }\n     \n    +    public SolrUpdateBolt withTickIntervalSecs(int tickTupleInterval) {\n    --- End diff --\n    \n    OK. Thx.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T04:20:18.707+0000","updated":"2016-01-08T04:20:18.707+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088687","id":"15088687","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49157386\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -59,16 +64,24 @@ public SolrUpdateBolt(SolrConfig solrConfig, SolrMapper solrMapper, SolrCommitSt\n             this.solrConfig = solrConfig;\n             this.solrMapper = solrMapper;\n             this.commitStgy = commitStgy;\n    -        logger.debug(\"Created {} with the following configuration: \" +\n    +        LOG.debug(\"Created {} with the following configuration: \" +\n                         \"[SolrConfig = {}], [SolrMapper = {}], [CommitStgy = {}]\",\n                         this.getClass().getSimpleName(), solrConfig, solrMapper, commitStgy);\n         }\n     \n    +    @Override\n         public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {\n             this.collector = collector;\n             this.solrClient = new CloudSolrClient(solrConfig.getZkHostString());\n             this.toCommitTuples = new ArrayList<>(capacity());\n     \n    +        //set default tickTupleInterval if interval is zero\n    +        if (stormConf.containsKey(\"topology.message.timeout.secs\") && tickTupleInterval == 0) {\n    --- End diff --\n    \n    I prefer to keep this code in `prepare()` method since no `stormConf` in SolrConfig.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T04:25:24.987+0000","updated":"2016-01-08T04:25:24.987+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088696","id":"15088696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169894466\n  \n    @hmcl  comments addressed.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T04:37:59.359+0000","updated":"2016-01-08T04:37:59.359+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088712","id":"15088712","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169896957\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T04:56:15.386+0000","updated":"2016-01-08T04:56:15.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088760","id":"15088760","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49160816\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,9 +108,12 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            final boolean isTickTuple = TupleUtils.isTick(tuple);\n    +            if (!isTickTuple) {\n    --- End diff --\n    \n    Can you please add the inline comment: // Don't ack tick tuples.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T06:08:43.961+0000","updated":"2016-01-08T06:08:43.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088764","id":"15088764","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49160913\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -131,6 +150,21 @@ private void failQueuedTuples(List<Tuple> failedTuples) {\n             return queuedTuples;\n         }\n     \n    +    @Override\n    +    public Map<String, Object> getComponentConfiguration() {\n    --- End diff --\n    \n    @vesense  I noticed that the body of this method is exactly the same for AbstractHdfsBolt. Furthermore, it's very likely that many Storm connector bolts will use the same code. Can you please write a helper method in TupleUtils and call that method here and AbstractHdfsBolt. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T06:11:16.817+0000","updated":"2016-01-08T06:11:16.817+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088765","id":"15088765","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49160962\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -59,15 +63,24 @@ public SolrUpdateBolt(SolrConfig solrConfig, SolrMapper solrMapper, SolrCommitSt\n             this.solrConfig = solrConfig;\n             this.solrMapper = solrMapper;\n             this.commitStgy = commitStgy;\n    -        logger.debug(\"Created {} with the following configuration: \" +\n    +        LOG.debug(\"Created {} with the following configuration: \" +\n                         \"[SolrConfig = {}], [SolrMapper = {}], [CommitStgy = {}]\",\n                         this.getClass().getSimpleName(), solrConfig, solrMapper, commitStgy);\n         }\n     \n    +    @Override\n         public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {\n             this.collector = collector;\n             this.solrClient = new CloudSolrClient(solrConfig.getZkHostString());\n             this.toCommitTuples = new ArrayList<>(capacity());\n    +        this.tickTupleInterval = solrConfig.getTickTupleInterval();\n    +\n    +        //set default tickTupleInterval\n    +        if (stormConf.containsKey(\"topology.message.timeout.secs\") && tickTupleInterval == 0) {\n    --- End diff --\n    \n    @vesense  Please create a private method called something setDefaultTickTupleInterval() with this code and call it here.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T06:12:24.102+0000","updated":"2016-01-08T06:12:24.102+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088767","id":"15088767","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49161066\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/config/SolrConfig.java ---\n    @@ -39,4 +40,13 @@ public SolrConfig(String zkHostString) {\n         public String getZkHostString() {\n             return zkHostString;\n         }\n    +\n    +    public int getTickTupleInterval() {\n    +        return tickTupleInterval;\n    +    }\n    +\n    +    public void setTickTupleInterval(int tickTupleInterval) {\n    --- End diff --\n    \n    @vesense Can you please delete this set method and pass the tickTupleInterval in the constructor, or use a builder pattern. This object should be immutable and fully initialized once passed to the Bolt.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T06:14:47.676+0000","updated":"2016-01-08T06:14:47.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15088769","id":"15088769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-169908195\n  \n    +1 once the last few, minor, comments are addressed.\n    \n    @vesense Thanks for the great work!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-08T06:15:36.073+0000","updated":"2016-01-08T06:15:36.073+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090636","id":"15090636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49264374\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -92,9 +108,12 @@ private void ack(Tuple tuple) throws SolrServerException, IOException {\n             if (commitStgy == null) {\n                 collector.ack(tuple);\n             } else {\n    -            toCommitTuples.add(tuple);\n    -            commitStgy.update();\n    -            if (commitStgy.commit()) {\n    +            final boolean isTickTuple = TupleUtils.isTick(tuple);\n    +            if (!isTickTuple) {\n    --- End diff --\n    \n    OK\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T14:16:20.776+0000","updated":"2016-01-09T14:16:20.776+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090637","id":"15090637","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49264392\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -131,6 +150,21 @@ private void failQueuedTuples(List<Tuple> failedTuples) {\n             return queuedTuples;\n         }\n     \n    +    @Override\n    +    public Map<String, Object> getComponentConfiguration() {\n    --- End diff --\n    \n    OK. The helper method is `createComponentConfigByTickFreqSecs` in TupleUtils.\n    And I will make a new PR for other external modules.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T14:19:29.915+0000","updated":"2016-01-09T14:19:29.915+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090638","id":"15090638","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49264394\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -59,15 +63,24 @@ public SolrUpdateBolt(SolrConfig solrConfig, SolrMapper solrMapper, SolrCommitSt\n             this.solrConfig = solrConfig;\n             this.solrMapper = solrMapper;\n             this.commitStgy = commitStgy;\n    -        logger.debug(\"Created {} with the following configuration: \" +\n    +        LOG.debug(\"Created {} with the following configuration: \" +\n                         \"[SolrConfig = {}], [SolrMapper = {}], [CommitStgy = {}]\",\n                         this.getClass().getSimpleName(), solrConfig, solrMapper, commitStgy);\n         }\n     \n    +    @Override\n         public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {\n             this.collector = collector;\n             this.solrClient = new CloudSolrClient(solrConfig.getZkHostString());\n             this.toCommitTuples = new ArrayList<>(capacity());\n    +        this.tickTupleInterval = solrConfig.getTickTupleInterval();\n    +\n    +        //set default tickTupleInterval\n    +        if (stormConf.containsKey(\"topology.message.timeout.secs\") && tickTupleInterval == 0) {\n    --- End diff --\n    \n    OK\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T14:19:39.173+0000","updated":"2016-01-09T14:19:39.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090639","id":"15090639","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49264396\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/config/SolrConfig.java ---\n    @@ -39,4 +40,13 @@ public SolrConfig(String zkHostString) {\n         public String getZkHostString() {\n             return zkHostString;\n         }\n    +\n    +    public int getTickTupleInterval() {\n    +        return tickTupleInterval;\n    +    }\n    +\n    +    public void setTickTupleInterval(int tickTupleInterval) {\n    --- End diff --\n    \n    OK\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T14:19:47.334+0000","updated":"2016-01-09T14:19:47.334+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090668","id":"15090668","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-170254404\n  \n    @hmcl all comments addressed. but I met some conficts.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T15:54:54.939+0000","updated":"2016-01-09T15:54:54.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090733","id":"15090733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49266446\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -59,16 +63,29 @@ public SolrUpdateBolt(SolrConfig solrConfig, SolrMapper solrMapper, SolrCommitSt\n             this.solrConfig = solrConfig;\n             this.solrMapper = solrMapper;\n             this.commitStgy = commitStgy;\n    -        logger.debug(\"Created {} with the following configuration: \" +\n    +        LOG.debug(\"Created {} with the following configuration: \" +\n                         \"[SolrConfig = {}], [SolrMapper = {}], [CommitStgy = {}]\",\n                         this.getClass().getSimpleName(), solrConfig, solrMapper, commitStgy);\n         }\n     \n    +    @Override\n         public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {\n             this.collector = collector;\n             this.solrClient = new CloudSolrClient(solrConfig.getZkHostString());\n             this.toCommitTuples = new ArrayList<>(capacity());\n    +        this.tickTupleInterval = solrConfig.getTickTupleInterval();\n    --- End diff --\n    \n    @vesense I would suggest that all the code handling the tickTupleInterval goes inside the method setTickTupleInterval. It is cleaner then setting the field tickTupleInterval in prepare, and then have an if, and then set the field again in setTickTupleInterval. The default case should be handled there as well.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T18:22:11.413+0000","updated":"2016-01-09T18:22:11.413+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090759","id":"15090759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49267676\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/utils/TupleUtils.java ---\n    @@ -28,8 +35,21 @@ private TupleUtils() {\n     \n       public static boolean isTick(Tuple tuple) {\n         return tuple != null\n    -           && Constants.SYSTEM_COMPONENT_ID  .equals(tuple.getSourceComponent())\n    +           && Constants.SYSTEM_COMPONENT_ID.equals(tuple.getSourceComponent())\n                && Constants.SYSTEM_TICK_STREAM_ID.equals(tuple.getSourceStreamId());\n       }\n     \n    +  public static Map<String, Object> createComponentConfigByTickFreqSecs(Map<String, Object> conf, int tickFreqSecs) {\n    --- End diff --\n    \n    @vesense I would rename this method to 'putTickFreqencyIntoComponentConfig'\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-09T20:02:39.569+0000","updated":"2016-01-09T20:02:39.569+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090968","id":"15090968","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49274109\n  \n    --- Diff: external/storm-solr/src/main/java/org/apache/storm/solr/bolt/SolrUpdateBolt.java ---\n    @@ -59,16 +63,29 @@ public SolrUpdateBolt(SolrConfig solrConfig, SolrMapper solrMapper, SolrCommitSt\n             this.solrConfig = solrConfig;\n             this.solrMapper = solrMapper;\n             this.commitStgy = commitStgy;\n    -        logger.debug(\"Created {} with the following configuration: \" +\n    +        LOG.debug(\"Created {} with the following configuration: \" +\n                         \"[SolrConfig = {}], [SolrMapper = {}], [CommitStgy = {}]\",\n                         this.getClass().getSimpleName(), solrConfig, solrMapper, commitStgy);\n         }\n     \n    +    @Override\n         public void prepare(Map stormConf, TopologyContext context, OutputCollector collector) {\n             this.collector = collector;\n             this.solrClient = new CloudSolrClient(solrConfig.getZkHostString());\n             this.toCommitTuples = new ArrayList<>(capacity());\n    +        this.tickTupleInterval = solrConfig.getTickTupleInterval();\n    --- End diff --\n    \n    Done.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-10T10:22:11.130+0000","updated":"2016-01-10T10:22:11.130+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15090969","id":"15090969","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/977#discussion_r49274112\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/utils/TupleUtils.java ---\n    @@ -28,8 +35,21 @@ private TupleUtils() {\n     \n       public static boolean isTick(Tuple tuple) {\n         return tuple != null\n    -           && Constants.SYSTEM_COMPONENT_ID  .equals(tuple.getSourceComponent())\n    +           && Constants.SYSTEM_COMPONENT_ID.equals(tuple.getSourceComponent())\n                && Constants.SYSTEM_TICK_STREAM_ID.equals(tuple.getSourceStreamId());\n       }\n     \n    +  public static Map<String, Object> createComponentConfigByTickFreqSecs(Map<String, Object> conf, int tickFreqSecs) {\n    --- End diff --\n    \n    Done.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-10T10:22:18.614+0000","updated":"2016-01-10T10:22:18.614+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15091125","id":"15091125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-170373919\n  \n    +1 LGTM\n    \n    @vesense to solve the conflicts you can rebase \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-10T17:45:46.142+0000","updated":"2016-01-10T17:45:46.142+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15092132","id":"15092132","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-170588715\n  \n    +1, but the code looks like it needs to be upmerged.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-11T15:33:11.949+0000","updated":"2016-01-11T15:33:11.949+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15095719","id":"15095719","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-171195222\n  \n    @revans2 @hmcl  Conflicts resolved.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-13T06:54:16.006+0000","updated":"2016-01-13T06:54:16.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15096322","id":"15096322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-171325985\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-13T15:17:31.400+0000","updated":"2016-01-13T15:17:31.400+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15096352","id":"15096352","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hmcl commented on the pull request:\n\n    https://github.com/apache/storm/pull/977#issuecomment-171332402\n  \n    +1 LGTM\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-13T15:33:31.699+0000","updated":"2016-01-13T15:33:31.699+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15096608","id":"15096608","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/977\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-01-13T17:22:37.082+0000","updated":"2016-01-13T17:22:37.082+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12924283/comment/15096611","id":"15096611","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"body":"Merged to master/1.x-branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"created":"2016-01-13T17:23:39.937+0000","updated":"2016-01-13T17:23:39.937+0000"}],"maxResults":56,"total":56,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1419/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2qayf:"}}