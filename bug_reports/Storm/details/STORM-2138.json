{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13010450","self":"https://issues.apache.org/jira/rest/api/2/issue/13010450","key":"STORM-2138","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-06-07T13:21:46.470+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 10 09:44:54 UTC 2018","customfield_12312320":null,"customfield_12310222":null,"customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2138/watchers","watchCount":6,"isWatching":false},"created":"2016-10-07T13:09:54.948+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12335747","id":"12335747","name":"1.0.2","archived":false,"released":true,"releaseDate":"2016-08-10"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-07-10T09:44:54.691+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"We are seeing problems in our storm topology whereby all our workers crash.\n\nThe errors we see are\n\n2016-10-07 09:49:33.599 o.a.s.d.supervisor [ERROR] Error on initialization of server mk-supervisor\njava.io.FileNotFoundException: File '/opt/storm_local/supervisor/stormdist/production_2016_09_13-1-1475831938/stormconf.ser' does not exist\n        at org.apache.storm.shade.org.apache.commons.io.FileUtils.openInputStream(FileUtils.java:292)\n        at org.apache.storm.shade.org.apache.commons.io.FileUtils.readFileToByteArray(FileUtils.java:1815)\n        at org.apache.storm.config$read_supervisor_storm_conf_given_path.invoke(config.clj:142)\n        at org.apache.storm.config$read_supervisor_storm_conf.invoke(config.clj:221)\n        at org.apache.storm.daemon.supervisor$add_blob_references.invoke(supervisor.clj:495)\n        at org.apache.storm.daemon.supervisor$fn__9307$exec_fn__2466__auto____9308.invoke(supervisor.clj:795)\n        at clojure.lang.AFn.applyToHelper(AFn.java:160)\n        at clojure.lang.AFn.applyTo(AFn.java:144)\n        at clojure.core$apply.invoke(core.clj:630)\n        at org.apache.storm.daemon.supervisor$fn__9307$mk_supervisor__9352.doInvoke(supervisor.clj:763)\n        at clojure.lang.RestFn.invoke(RestFn.java:436)\n        at org.apache.storm.daemon.supervisor$_launch.invoke(supervisor.clj:1200)\n        at org.apache.storm.daemon.supervisor$_main.invoke(supervisor.clj:1233)\n        at clojure.lang.AFn.applyToHelper(AFn.java:152)\n        at clojure.lang.AFn.applyTo(AFn.java:144)\n        at org.apache.storm.daemon.supervisor.main(Unknown Source)\n2016-10-07 09:49:33.608 o.a.s.util [ERROR] Halting process: (\"Error on initialization\")\njava.lang.RuntimeException: (\"Error on initialization\")\n        at org.apache.storm.util$exit_process_BANG_.doInvoke(util.clj:341)\n        at clojure.lang.RestFn.invoke(RestFn.java:423)\n        at org.apache.storm.daemon.supervisor$fn__9307$mk_supervisor__9352.doInvoke(supervisor.clj:763)\n        at clojure.lang.RestFn.invoke(RestFn.java:436)\n        at org.apache.storm.daemon.supervisor$_launch.invoke(supervisor.clj:1200)\n        at org.apache.storm.daemon.supervisor$_main.invoke(supervisor.clj:1233)\n        at clojure.lang.AFn.applyToHelper(AFn.java:152)\n        at clojure.lang.AFn.applyTo(AFn.java:144)\n        at org.apache.storm.daemon.supervisor.main(Unknown Source)\n2016-10-07 09:49:34.668 o.a.s.d.supervisor [INFO] Removing code for storm id production_2016_09_13-1-1475831938\n\n\nWe have looked at https://github.com/apache/storm/pull/418 and https://issues.apache.org/jira/browse/STORM-130, which both show the first issue as being fixed - however we are still experiencing it in 1.0.2. The changes from the fixing commit (https://github.com/apache/storm/pull/418/commits/ccd28f8a356f468e66865fa9d9901b0a2628ec74) don't seem to be in the current version of the file (https://github.com/apache/storm/blob/v1.0.2/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj).\n\nWe get this often when resubmitting a topology, and our only workaround is to stop the topology, delete the whole /opt/storm_local directory (which is our storm.local.dir) and resubmit the topology. Often, the workers seem to be looking for stormconf.ser in the local directory of an old topology that isn't even running at the time.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"java.io.FileNotFoundException: stormconf.ser does not exist","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eddy","name":"eddy","key":"eddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eddy","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eddy","name":"eddy","key":"eddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eddy","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13010450/comment/16040866","id":"16040866","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristopherkane","name":"kristopherkane","key":"kristopherkane","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kristopher Kane","active":true,"timeZone":"America/Detroit"},"body":"I can confirm this on 1.0.2 but instead of worker failure, I see the Supervisor shut down after a time.  Inspecting the supervisor after it is noticed as down, I see that the stormconf.ser file is present, with the correct ownership, in the reported missing file location. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristopherkane","name":"kristopherkane","key":"kristopherkane","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kristopher Kane","active":true,"timeZone":"America/Detroit"},"created":"2017-06-07T13:21:46.470+0000","updated":"2017-06-07T13:21:46.470+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13010450/comment/16538330","id":"16538330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hummel.michel%40gmail.com","name":"hummel.michel@gmail.com","key":"hummel.michel@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michel hummel","active":true,"timeZone":"Etc/UTC"},"body":"Same issue with 1.0.3, sometime supervisors shutdown onÂ java.lang.RuntimeException: java.io.FileNotFoundException: File '/space/StormData/storm-data/supervisor/stormdist/MyTopo/stormconf.ser' does not exist)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hummel.michel%40gmail.com","name":"hummel.michel@gmail.com","key":"hummel.michel@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"michel hummel","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-10T09:44:54.691+0000","updated":"2018-07-10T09:44:54.691+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2138/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i34kl3:"}}