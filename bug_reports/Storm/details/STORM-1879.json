{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12975130","self":"https://issues.apache.org/jira/rest/api/2/issue/12975130","key":"STORM-1879","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335747","id":"12335747","name":"1.0.2","archived":false,"released":true,"releaseDate":"2016-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335748","id":"12335748","name":"1.1.0","archived":false,"released":true,"releaseDate":"2017-03-29"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-06-15T09:07:43.621+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 17 21:55:13 UTC 2016","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_6604510650_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2016-08-17T21:55:12.079+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1879/watchers","watchCount":9,"isWatching":false},"created":"2016-06-02T11:20:02.898+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12335587","id":"12335587","name":"1.0.1","archived":false,"released":true,"releaseDate":"2016-05-06"}],"customfield_12312339":null,"issuelinks":[{"id":"12472830","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12472830","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12984736","key":"STORM-1934","self":"https://issues.apache.org/jira/rest/api/2/issue/12984736","fields":{"summary":"Race condition between sync-supervisor and sync-processes raises several strange issues","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-08-17T21:55:13.496+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"We've run into a strange issue with a zombie worker process. It looks like the worker pid file somehow got deleted without the worker process shutting down. This causes the supervisor to try repeatedly to kill the worker unsuccessfully, and means multiple workers may be assigned to the same port. The worker root folder sticks around because the worker is still heartbeating to it.\n\nIt may or may not be related that we've seen Nimbus occasionally enter an infinite loop of printing logs similar to the below.\n\n{code}\n2016-05-19 14:55:14.196 o.a.s.b.BlobStoreUtils [ERROR] Could not update the blob with keyZendeskTicketTopology-5-1463647641-stormconf.ser\n2016-05-19 14:55:14.210 o.a.s.b.BlobStoreUtils [ERROR] Could not update the blob with keyZendeskTicketTopology-5-1463647641-stormcode.ser\n2016-05-19 14:55:14.218 o.a.s.b.BlobStoreUtils [ERROR] Could not update the blob with keyZendeskTicketTopology-5-1463647641-stormconf.ser\n2016-05-19 14:55:14.256 o.a.s.b.BlobStoreUtils [ERROR] Could not update the blob with keyZendeskTicketTopology-5-1463647641-stormcode.ser\n2016-05-19 14:55:14.273 o.a.s.b.BlobStoreUtils [ERROR] Could not update the blob with keyZendeskTicketTopology-5-1463647641-stormcode.ser\n2016-05-19 14:55:14.316 o.a.s.b.BlobStoreUtils [ERROR] Could not update the blob with keyZendeskTicketTopology-5-1463647641-stormconf.ser\n{code}\n\nWhich continues until Nimbus is rebooted. We also see repeating blocks similar to the logs below.\n\n{code}\n2016-06-02 07:45:03.656 o.a.s.d.nimbus [INFO] Cleaning up ZendeskTicketTopology-127-1464780171\n2016-06-02 07:45:04.132 o.a.s.d.nimbus [INFO] ExceptionKeyNotFoundException(msg:ZendeskTicketTopology-127-1464780171-stormjar.jar)\n2016-06-02 07:45:04.144 o.a.s.d.nimbus [INFO] ExceptionKeyNotFoundException(msg:ZendeskTicketTopology-127-1464780171-stormconf.ser)\n2016-06-02 07:45:04.155 o.a.s.d.nimbus [INFO] ExceptionKeyNotFoundException(msg:ZendeskTicketTopology-127-1464780171-stormcode.ser)\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12810821","id":"12810821","filename":"fix_missing_worker_pid.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T11:43:10.143+0000","size":1247,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12810821/fix_missing_worker_pid.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12807697","id":"12807697","filename":"nimbus-supervisor.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"created":"2016-06-02T11:23:52.304+0000","size":6734747,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12807697/nimbus-supervisor.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12810802","id":"12810802","filename":"supervisor.log","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T10:02:52.242+0000","size":1153881,"mimeType":"text/x-log","content":"https://issues.apache.org/jira/secure/attachment/12810802/supervisor.log"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Supervisor may not shut down workers cleanly","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15312147","id":"15312147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"body":"The nimbus and supervisor logs for the period. The undead worker is running ZendeskTicketTopology-127-1464780171. The initial attempt at shutting it down is at 2016-06-01 13:44:39.955 in the supervisor log.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"created":"2016-06-02T11:23:52.324+0000","updated":"2016-06-02T11:32:20.946+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15331416","id":"15331416","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"I am seeing the exact same issue. It is almost trivial to reproduce just by killing all Storm processes on one of my five workers, including the supervisor which is immediately restarted by runit.\n\nI will attach some additional supervisor logs which include DEBUG log messages for {{org.apache.storm.daemon.supervisor}} and {{org.apache.storm.util}}. Note that I have added an additional log message in order to confirm that indeed the {{pids}} for the worker are empty in the {{shutdown-worker}} function (https://github.com/apache/storm/blob/v1.0.1/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj#L277). The added line is this:\n{code}(log-message \"Killing the following pids for \" (:supervisor-id supervisor) \":\" id \" : \" (seq pids)){code}\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T09:07:43.621+0000","updated":"2016-06-15T09:18:04.214+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15331471","id":"15331471","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"The trouble starts here:\n\nbq. 2016-06-14 18:31:04.465 o.a.s.d.supervisor [INFO] Shutting down ee56fb9d-2657-4d3f-b52a-1ae4abae85f7:\n\nleading to:\n\n{quote}2016-06-14 18:31:04.471 o.a.s.util [DEBUG] Rmr path /var/lib/storm/storm-local/workers//heartbeats\n2016-06-14 18:31:04.471 o.a.s.util [DEBUG] Rmr path /var/lib/storm/storm-local/workers//pids\n2016-06-14 18:31:04.471 o.a.s.util [DEBUG] Rmr path /var/lib/storm/storm-local/workers/{quote}\n\nI am still trying to figure out why this happens, but I think an {{assert}} is in order somewhere","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T10:02:52.250+0000","updated":"2016-06-15T10:05:41.002+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15331525","id":"15331525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"Seems like the problem is this:\n\n {quote}2016-06-14 18:31:00.741 o.a.s.d.supervisor [INFO] Launching worker with assignment {:storm-id \"realtime_stats-4-1465921242\", :executors [[85 85] [39 39] [128 128]], :resources #object[org.apache.storm.generated.W\norkerResources 0x58f5aa7a \"WorkerResources(mem_on_heap:0.0, mem_off_heap:0.0, cpu:0.0)\"]} for this supervisor ee56fb9d-2657-4d3f-b52a-1ae4abae85f7 on port 6702 with id a2566676-8c17-4314-8eec-b4a5cdeb17c9\n {quote}\n\nand this\n\nbq. 2016-06-14 18:31:04.464 o.a.s.d.supervisor [DEBUG] Worker a2566676-8c17-4314-8eec-b4a5cdeb17c9 is :not-started: nil at supervisor time-secs 1465921864\n\nThis last line is right after the assignment from nimbus changed. The worker on port 6702 has different executors and therefore should be killed. But the currently running worker on port 6702 with id a2566676-8c17-4314-8eec-b4a5cdeb17c9 was only launched ~3.7s ago, and has not written any heartbeat files yet. Here https://github.com/apache/storm/blob/v1.0.1/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj#L536 the {{port->worker-id}} map is created from the worker heartbeats and there will be no entry for port 6702.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T10:48:44.801+0000","updated":"2016-06-15T10:48:44.801+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15331572","id":"15331572","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"I attached a patch that implements a preliminary workaround. Works for me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T11:42:31.723+0000","updated":"2016-06-15T11:42:31.723+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15331822","id":"15331822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevinconaway","name":"kevinconaway","key":"kevinconaway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kevinconaway&avatarId=29140","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kevinconaway&avatarId=29140","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kevinconaway&avatarId=29140","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kevinconaway&avatarId=29140"},"displayName":"Kevin Conaway","active":true,"timeZone":"Etc/UTC"},"body":"[~nico.meyer] we're seeing the same thing. Specifically:\n\n{quote}\n2016-06-14 18:31:04.465 o.a.s.d.supervisor [INFO] Shutting down ee56fb9d-2657-4d3f-b52a-1ae4abae85f7:\n{quote}\n\nIts shutting down a worker without a worker ID.  Below are the logs from one of our supervisors:\n\n{quote}\n2016-06-15 14:18:58.349 o.a.s.d.supervisor [INFO] Shutting down 0274fa9c-c271-4a76-928e-28955db4ee34:\n2016-06-15 14:18:58.349 o.a.s.config [INFO] GET worker-user\n2016-06-15 14:18:58.350 o.a.s.config [WARN] Failed to get worker user for . #error {\n :cause /var/storm/storm-local/workers-users (Is a directory)\n :via\n [{:type java.io.FileNotFoundException\n   :message /var/storm/storm-local/workers-users (Is a directory)\n   :at [java.io.FileInputStream open0 FileInputStream.java -2]}]\n :trace\n [[java.io.FileInputStream open0 FileInputStream.java -2]\n  [java.io.FileInputStream open FileInputStream.java 195]\n  [java.io.FileInputStream <init> FileInputStream.java 138]\n  [clojure.java.io$fn__9189 invoke io.clj 229]\n  [clojure.java.io$fn__9102$G__9095__9109 invoke io.clj 69]\n  [clojure.java.io$fn__9201 invoke io.clj 258]\n  [clojure.java.io$fn__9102$G__9095__9109 invoke io.clj 69]\n  [clojure.java.io$fn__9163 invoke io.clj 165]\n  [clojure.java.io$fn__9115$G__9091__9122 invoke io.clj 69]\n  [clojure.java.io$reader doInvoke io.clj 102]\n  [clojure.lang.RestFn invoke RestFn.java 410]\n  [clojure.lang.AFn applyToHelper AFn.java 154]\n  [clojure.lang.RestFn applyTo RestFn.java 132]\n  [clojure.core$apply invoke core.clj 632]\n  [clojure.core$slurp doInvoke core.clj 6653]\n  [clojure.lang.RestFn invoke RestFn.java 410]\n  [org.apache.storm.config$get_worker_user invoke config.clj 239]\n  [org.apache.storm.daemon.supervisor$shutdown_worker invoke supervisor.clj 281]\n  [org.apache.storm.daemon.supervisor$kill_existing_workers_with_change_in_components invoke supervisor.clj 536]\n  [org.apache.storm.daemon.supervisor$mk_synchronize_supervisor$this__9078 invoke supervisor.clj 595]\n  [org.apache.storm.event$event_manager$fn__8630 invoke event.clj 40]\n  [clojure.lang.AFn run AFn.java 22]\n  [java.lang.Thread run Thread.java 745]]}\n2016-06-15 14:18:58.362 o.a.s.config [INFO] REMOVE worker-user\n2016-06-15 14:18:58.362 o.a.s.d.supervisor [INFO] Shut down 0274fa9c-c271-4a76-928e-28955db4ee34:\n{quote}\n\nOn another supervisor its a different error:\n\n{quote}\n2016-06-15 14:17:45.472 o.a.s.d.supervisor [INFO] Worker 4cee7f5c-2c87-48af-a44d-c1568e472f12 failed to start\n2016-06-15 14:17:45.473 o.a.s.d.supervisor [INFO] Worker 96f8b5d5-a4e0-4fe2-90a8-7de85a5dd993 failed to start\n2016-06-15 14:17:45.504 o.a.s.d.supervisor [INFO] Shutting down and clearing state for id 414f723a-683c-4fd8-9b57-b8742a2ddade. Current supervisor time: 1466000265. State: :disallowed, Heartbeat: {:time-secs 1466000264, :storm-id \"<snipped>\", :executors [[12 12] [54 54] [156 156] [42 42] [72 72] [24 24] [144 144] [162 162] [186 186] [66 66] [120 120] [102 102] [18 18] [6 6] [96 96] [150 150] [48 48] [30 30] [-1 -1] [114 114] [84 84] [90 90] [60 60] [126 126] [138 138] [36 36] [108 108] [180 180] [132 132] [168 168] [78 78] [174 174]], :port 6701}\n2016-06-15 14:17:45.504 o.a.s.d.supervisor [INFO] Shutting down 0274fa9c-c271-4a76-928e-28955db4ee34:414f723a-683c-4fd8-9b57-b8742a2ddade\n2016-06-15 14:17:45.505 o.a.s.config [INFO] GET worker-user 414f723a-683c-4fd8-9b57-b8742a2ddade\n2016-06-15 14:17:45.507 o.a.s.config [WARN] Failed to get worker user for 414f723a-683c-4fd8-9b57-b8742a2ddade. #error {\n :cause /var/storm/storm-local/workers-users/414f723a-683c-4fd8-9b57-b8742a2ddade (No such file or directory)\n :via\n [{:type java.io.FileNotFoundException\n   :message /var/storm/storm-local/workers-users/414f723a-683c-4fd8-9b57-b8742a2ddade (No such file or directory)\n   :at [java.io.FileInputStream open0 FileInputStream.java -2]}]\n :trace\n [[java.io.FileInputStream open0 FileInputStream.java -2]\n  [java.io.FileInputStream open FileInputStream.java 195]\n  [java.io.FileInputStream <init> FileInputStream.java 138]\n  [clojure.java.io$fn__9189 invoke io.clj 229]\n  [clojure.java.io$fn__9102$G__9095__9109 invoke io.clj 69]\n  [clojure.java.io$fn__9201 invoke io.clj 258]\n  [clojure.java.io$fn__9102$G__9095__9109 invoke io.clj 69]\n  [clojure.java.io$fn__9163 invoke io.clj 165]\n  [clojure.java.io$fn__9115$G__9091__9122 invoke io.clj 69]\n  [clojure.java.io$reader doInvoke io.clj 102]\n  [clojure.lang.RestFn invoke RestFn.java 410]\n  [clojure.lang.AFn applyToHelper AFn.java 154]\n  [clojure.lang.RestFn applyTo RestFn.java 132]\n  [clojure.core$apply invoke core.clj 632]\n  [clojure.core$slurp doInvoke core.clj 6653]\n  [clojure.lang.RestFn invoke RestFn.java 410]\n  [org.apache.storm.config$get_worker_user invoke config.clj 239]\n  [org.apache.storm.daemon.supervisor$shutdown_worker invoke supervisor.clj 281]\n  [org.apache.storm.daemon.supervisor$sync_processes invoke supervisor.clj 427]\n  [clojure.core$partial$fn__4527 invoke core.clj 2492]\n  [org.apache.storm.event$event_manager$fn__8630 invoke event.clj 40]\n  [clojure.lang.AFn run AFn.java 22]\n  [java.lang.Thread run Thread.java 745]]}\n2016-06-15 14:17:45.517 o.a.s.config [INFO] REMOVE worker-user 414f723a-683c-4fd8-9b57-b8742a2ddade\n2016-06-15 14:17:45.517 o.a.s.d.supervisor [INFO] Shut down 0274fa9c-c271-4a76-928e-28955db4ee34:414f723a-683c-4fd8-9b57-b8742a2ddade\n2016-06-15 14:17:45.518 o.a.s.d.supervisor [INFO] Shutting down and clearing state for id 2eb07a90-a8b7-4a81-929c-93d6edb3c2ef. Current supervisor time: 1466000265. State: :disallowed, Heartbeat: {:time-secs 1466000265, :storm-id \"<snipped>\", :executors [[41 41] [125 125] [137 137] [53 53] [65 65] [101 101] [149 149] [161 161] [-1 -1] [5 5] [29 29] [89 89] [173 173] [77 77] [185 185] [113 113] [17 17]], :port 6700}\n2016-06-15 14:17:45.518 o.a.s.d.supervisor [INFO] Shutting down 0274fa9c-c271-4a76-928e-28955db4ee34:2eb07a90-a8b7-4a81-929c-93d6edb3c2ef\n2016-06-15 14:17:45.518 o.a.s.config [INFO] GET worker-user 2eb07a90-a8b7-4a81-929c-93d6edb3c2ef\n2016-06-15 14:17:45.519 o.a.s.config [WARN] Failed to get worker user for 2eb07a90-a8b7-4a81-929c-93d6edb3c2ef. #error {\n :cause /var/storm/storm-local/workers-users/2eb07a90-a8b7-4a81-929c-93d6edb3c2ef (No such file or directory)\n :via\n [{:type java.io.FileNotFoundException\n   :message /var/storm/storm-local/workers-users/2eb07a90-a8b7-4a81-929c-93d6edb3c2ef (No such file or directory)\n   :at [java.io.FileInputStream open0 FileInputStream.java -2]}]\n :trace\n [[java.io.FileInputStream open0 FileInputStream.java -2]\n  [java.io.FileInputStream open FileInputStream.java 195]\n  [java.io.FileInputStream <init> FileInputStream.java 138]\n  [clojure.java.io$fn__9189 invoke io.clj 229]\n  [clojure.java.io$fn__9102$G__9095__9109 invoke io.clj 69]\n  [clojure.java.io$fn__9201 invoke io.clj 258]\n  [clojure.java.io$fn__9102$G__9095__9109 invoke io.clj 69]\n  [clojure.java.io$fn__9163 invoke io.clj 165]\n  [clojure.java.io$fn__9115$G__9091__9122 invoke io.clj 69]\n  [clojure.java.io$reader doInvoke io.clj 102]\n  [clojure.lang.RestFn invoke RestFn.java 410]\n  [clojure.lang.AFn applyToHelper AFn.java 154]\n  [clojure.lang.RestFn applyTo RestFn.java 132]\n  [clojure.core$apply invoke core.clj 632]\n  [clojure.core$slurp doInvoke core.clj 6653]\n  [clojure.lang.RestFn invoke RestFn.java 410]\n  [org.apache.storm.config$get_worker_user invoke config.clj 239]\n  [org.apache.storm.daemon.supervisor$shutdown_worker invoke supervisor.clj 281]\n  [org.apache.storm.daemon.supervisor$sync_processes invoke supervisor.clj 427]\n  [clojure.core$partial$fn__4527 invoke core.clj 2492]\n  [org.apache.storm.event$event_manager$fn__8630 invoke event.clj 40]\n  [clojure.lang.AFn run AFn.java 22]\n  [java.lang.Thread run Thread.java 745]]}\n2016-06-15 14:17:45.525 o.a.s.config [INFO] REMOVE worker-user 2eb07a90-a8b7-4a81-929c-93d6edb3c2ef\n2016-06-15 14:17:45.525 o.a.s.d.supervisor [INFO] Shut down 0274fa9c-c271-4a76-928e-28955db4ee34:2eb07a90-a8b7-4a81-929c-93d6edb3c2ef\n2016-06-15 14:17:45.526 o.a.s.d.supervisor [INFO] Shutting down and clearing state for id 96f8b5d5-a4e0-4fe2-90a8-7de85a5dd993. Current supervisor time: 1466000265. State: :not-started, Heartbeat: nil\n2016-06-15 14:17:45.526 o.a.s.d.supervisor [INFO] Shutting down 0274fa9c-c271-4a76-928e-28955db4ee34:96f8b5d5-a4e0-4fe2-90a8-7de85a5dd993\n2016-06-15 14:17:45.526 o.a.s.config [INFO] GET worker-user 96f8b5d5-a4e0-4fe2-90a8-7de85a5dd993\n2016-06-15 14:17:45.527 o.a.s.config [INFO] REMOVE worker-user 96f8b5d5-a4e0-4fe2-90a8-7de85a5dd993\n2016-06-15 14:17:45.527 o.a.s.d.supervisor [INFO] Shut down 0274fa9c-c271-4a76-928e-28955db4ee34:96f8b5d5-a4e0-4fe2-90a8-7de85a5dd993\n{quote}\n\n[~kabhwan] have you seen this before?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevinconaway","name":"kevinconaway","key":"kevinconaway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kevinconaway&avatarId=29140","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kevinconaway&avatarId=29140","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kevinconaway&avatarId=29140","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kevinconaway&avatarId=29140"},"displayName":"Kevin Conaway","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-15T14:22:27.105+0000","updated":"2016-06-15T14:22:27.105+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15338136","id":"15338136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fogetti","name":"fogetti","key":"fogetti","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gergely Nagy","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi folks,\n\nI came here by accident, and to my surprise I had the very exact same problem that [~Srdo] and [~kevinconaway] is experiencing.\n\nI even created a separate JIRA ticket for Kevin's issue:\nhttps://issues.apache.org/jira/browse/STORM-1915\n\nSo it seems the two things (no worker ID) and unclean shutdown are related?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fogetti","name":"fogetti","key":"fogetti","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gergely Nagy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-06-18T19:49:12.717+0000","updated":"2016-06-18T19:49:12.717+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15342668","id":"15342668","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevinconaway","name":"kevinconaway","key":"kevinconaway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kevinconaway&avatarId=29140","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kevinconaway&avatarId=29140","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kevinconaway&avatarId=29140","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kevinconaway&avatarId=29140"},"displayName":"Kevin Conaway","active":true,"timeZone":"Etc/UTC"},"body":"[~revans2] have you seen this one or STORM-1915 before?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevinconaway","name":"kevinconaway","key":"kevinconaway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kevinconaway&avatarId=29140","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kevinconaway&avatarId=29140","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kevinconaway&avatarId=29140","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kevinconaway&avatarId=29140"},"displayName":"Kevin Conaway","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-21T20:55:43.072+0000","updated":"2016-06-21T20:55:43.072+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15342703","id":"15342703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeyendran","name":"jeyendran","key":"jeyendran","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeyendran Balakrishnan","active":true,"timeZone":"Etc/UTC"},"body":"I'm encountering this problem too, where a worker task fails due to some reason, and then the supervisor gets stuck in this mode where it repeatedly, but unsuccessfully, tries to update the blob.\nDisk activity goes to 100% (doing just write accesses), and the whole topology basically stalls.\nI have to stop the topology and restart it, and hope the problem does not recur too quickly.\nMy environment is on a single Windows 8.1 laptop on a LocalCluster, with one spout, a total of 7 bolt instances (4 different bolts), with all ACKing turned off (ACK executors = 0).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeyendran","name":"jeyendran","key":"jeyendran","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeyendran Balakrishnan","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-21T21:09:29.559+0000","updated":"2016-06-21T21:09:29.559+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15344431","id":"15344431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"I have not seen either of these issue on our clusters.\n\nI don't have a lot of time right now to try and reproduce it.  I don't know how much, if any critical information is going to be in the memory of nimbus/the supervisor for your topology, but I don't suspect that it will be very much.  If any of you are OK with taking a heap dump of both nimbus and the supervisor that is causing the issues when this happens it would probably be really helpful.\n\nThe errors above happen occasionally because the cleanup of the files does not always coincidence with shooting the worker so the worker could be relauched/come up after the supervisor removed the config file it needs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2016-06-22T15:00:39.640+0000","updated":"2016-06-22T15:00:39.640+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15344582","id":"15344582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"I am not sure about the problem Jeyendran Balakrishnan described, but I already worked out what causes the other problem.\nI described my findings in one of my last comments. Maybe I didn't describe it very well, so let me try to summarize it differently:\n\nThe problem occurs if {{kill-existing-workers-with-change-in-components}} tries to kill a worker that has been started but has not yet written a single heartbeat, so {{read-allocated-workers}} returns a state of {{:not-started}} and also no information about the port this worker is assigned to. Therefore in this line https://github.com/apache/storm/blob/v1.0.1/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj#L536 the second argument to {{shutdown-worker}} will be {{nil}}.\nThis leads to:\n# {{pids}} is empty (https://github.com/apache/storm/blob/v1.0.1/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj#L277), therefore the worker is not killed\n# {{try-cleanup-worker}} is also called with an {{id}} of {{nil}} (https://github.com/apache/storm/blob/v1.0.1/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj#L303)\n# which will delete the local state files for all workers, since {{org.apache.storm.config/worker-root conf nil}} returns for example '/var/lib/storm/workers/' and this path is deleted (https://github.com/apache/storm/blob/v1.0.1/storm-core/src/clj/org/apache/storm/daemon/supervisor.clj#L265)\n\nThe heartbeat files of the workers that are still running will eventually be recreated at the heartbeat, but the PID files are gone for good at that point, so even stopping the topology won't help. Only manually killing the worker processes will solve the problem.\n\n\nP.S: I also attached a workaround patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-22T15:54:21.067+0000","updated":"2016-06-22T15:55:11.921+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15354803","id":"15354803","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Sorry for late participating. I have been struggling with other works.\n\nI'm suspecting that many issues from supervisor are from race condition (sync-supervisor and sync-processes).\n\nOne of supervisor test is intermittently failing ([STORM-1933|https://issues.apache.org/jira/browse/STORM-1933]), and after digging I found that supervisor has race condition which can create various issues.\n(What [~nico.meyer] pointed out seems to be same to what STORM-1933 shows.)\n\nI submitted a [patch|https://github.com/apache/storm/pull/1528] to [STORM-1934|https://issues.apache.org/jira/browse/STORM-1934] so I'd be really happy if you applies my patch and see it works. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-06-29T08:35:42.507+0000","updated":"2016-06-29T08:35:42.507+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15356337","id":"15356337","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"[~Srdo] [~nico.meyer] [~kevinconaway] [~fogetti]\nSorry to mention so lately, but could anyone apply my patch to see it resolves what you're affected?\nPlease mention me with your storm version if you want to receive modified core jar instead of building your own.\nThanks in advance.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-06-30T02:27:45.889+0000","updated":"2016-06-30T02:27:45.889+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15404475","id":"15404475","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"body":"Sorry [~kabhwan], I've been out of the office for a while, and for some reason I don't get mail notifications from JIRA. 1.0.2 release seems close, so we'll keep an eye on whether this issue pops up after we upgrade. Thanks for taking a look at this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"created":"2016-08-02T17:55:59.316+0000","updated":"2016-08-02T17:55:59.316+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15424910","id":"15424910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevinconaway","name":"kevinconaway","key":"kevinconaway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kevinconaway&avatarId=29140","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kevinconaway&avatarId=29140","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kevinconaway&avatarId=29140","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kevinconaway&avatarId=29140"},"displayName":"Kevin Conaway","active":true,"timeZone":"Etc/UTC"},"body":"[~kabhwan] did this make it in to 1.0.2?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevinconaway","name":"kevinconaway","key":"kevinconaway","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kevinconaway&avatarId=29140","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kevinconaway&avatarId=29140","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kevinconaway&avatarId=29140","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kevinconaway&avatarId=29140"},"displayName":"Kevin Conaway","active":true,"timeZone":"Etc/UTC"},"created":"2016-08-17T17:01:57.409+0000","updated":"2016-08-17T17:01:57.409+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15425457","id":"15425457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"[~kevinconaway] I guess yes, since STORM-1934 is applied to 1.0.2. I just forgot to close related issues.\nPlease try out 1.0.2 and see it works without the symptom, and reopen if it's not. Thanks!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-08-17T21:54:00.864+0000","updated":"2016-08-17T21:54:00.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12975130/comment/15425459","id":"15425459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Resolving this since STORM-1934 was merged.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-08-17T21:55:13.397+0000","updated":"2016-08-17T21:55:13.397+0000"}],"maxResults":17,"total":17,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1879/votes","votes":5,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2yvu7:"}}