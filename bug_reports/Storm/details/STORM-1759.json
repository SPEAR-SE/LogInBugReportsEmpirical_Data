{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12964673","self":"https://issues.apache.org/jira/rest/api/2/issue/12964673","key":"STORM-1759","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-06-08T14:19:33.748+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 01 13:07:04 UTC 2018","customfield_12312320":null,"customfield_12310222":null,"customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1759/watchers","watchCount":4,"isWatching":false},"created":"2016-05-03T14:22:07.563+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327123","id":"12327123","description":"security feature branch","name":"0.10.0","archived":false,"released":true,"releaseDate":"2015-11-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329843","id":"12329843","name":"1.0.0","archived":false,"released":true,"releaseDate":"2016-04-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12333021","id":"12333021","name":"0.9.6","archived":false,"released":true,"releaseDate":"2015-11-05"}],"customfield_12312339":null,"issuelinks":[{"id":"12539919","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12539919","type":{"id":"10020","name":"Cloners","inward":"is cloned by","outward":"is a clone of","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10020"},"inwardIssue":{"id":"13097788","key":"STORM-2708","self":"https://issues.apache.org/jira/rest/api/2/issue/13097788","fields":{"summary":"View Logs by single point. With using Docker swarm","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/11","id":"11","description":"A formal question. Initially added for the Legal JIRA.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21130&avatarType=issuetype","name":"Question","subtask":false,"avatarId":21130}}}},{"id":"12465572","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12465572","type":{"id":"12310010","name":"Incorporates","inward":"is part of","outward":"incorporates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"},"outwardIssue":{"id":"12964672","key":"STORM-1758","self":"https://issues.apache.org/jira/rest/api/2/issue/12964672","fields":{"summary":"Distributed log search doesn't work in dockerized environment","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12465570","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12465570","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12915674","key":"STORM-1342","self":"https://issues.apache.org/jira/rest/api/2/issue/12915674","fields":{"summary":"support multiple logviewers per host for container-isolated worker logs","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-01T13:07:04.626+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12328751","id":"12328751","name":"storm-ui"}],"timeoriginalestimate":null,"description":"I run the Storm using the following docker-compose.yml\n\n{code}\nversion: '2'\n\nservices:\n    zookeeper:\n        image: jplock/zookeeper:3.4.8\n        restart: always\n\n    nimbus:\n        image: 31z4/storm:1.0.0\n        command: nimbus -c storm.log.dir=\"/logs\" -c storm.zookeeper.servers=\"[\\\"zookeeper\\\"]\" -c nimbus.host=\"nimbus\"\n        depends_on:\n            - zookeeper\n        restart: always\n        ports:\n            - 6627:6627\n        volumes:\n            - logs:/logs\n\n    supervisor:\n        image: 31z4/storm:1.0.0\n        command: supervisor -c storm.log.dir=\"/logs\" -c storm.zookeeper.servers=\"[\\\"zookeeper\\\"]\" -c nimbus.host=\"nimbus\"\n        depends_on:\n            - nimbus\n        restart: always\n        volumes:\n            - logs:/logs\n\n    logviewer:\n        image: 31z4/storm:1.0.0\n        command: logviewer -c storm.log.dir=\"/logs\"\n        restart: always\n        ports:\n            - 8000:8000\n        volumes:\n            - logs:/logs\n\n    ui:\n        image: 31z4/storm:1.0.0\n        command: ui -c storm.log.dir=\"/logs\" -c nimbus.host=\"nimbus\"\n        depends_on:\n            - nimbus\n            - logviewer\n        restart: always\n        ports:\n            - 8080:8080\n        volumes:\n            - logs:/log\n\nvolumes:\n    logs: {}\n{code}\n\nAnd opening the logs from the Storm UI doesn't work because all links are pointing to different container ids as hosts.\n\nI guess adding an ability to explicitly specify the logviewer host in the storm.yaml would solve the issue.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Viewing logs from the Storm UI doesn't work in dockerized environment","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=31z4","name":"31z4","key":"31z4","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=31z4&avatarId=23231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=31z4&avatarId=23231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=31z4&avatarId=23231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=31z4&avatarId=23231"},"displayName":"Elisey Zanko","active":true,"timeZone":"Asia/Oral"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=31z4","name":"31z4","key":"31z4","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=31z4&avatarId=23231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=31z4&avatarId=23231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=31z4&avatarId=23231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=31z4&avatarId=23231"},"displayName":"Elisey Zanko","active":true,"timeZone":"Asia/Oral"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964673/comment/15320621","id":"15320621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"I think we already have this ability.\n\nhttps://github.com/apache/storm/blob/master/storm-core/src/jvm/org/apache/storm/Config.java#L259-L268\n\nBy setting storm.local.hostname on each of the supervisors it should fix your issue, because that is what will be reported to nimbus, and is what will be used when building the URL for the logviewer.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2016-06-08T14:19:33.748+0000","updated":"2016-06-08T14:19:33.748+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964673/comment/16562565","id":"16562565","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jmoraleda","name":"jmoraleda","key":"jmoraleda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jmoraleda&avatarId=35289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jmoraleda&avatarId=35289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jmoraleda&avatarId=35289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jmoraleda&avatarId=35289"},"displayName":"Jorge Moraleda","active":true,"timeZone":"Etc/UTC"},"body":"I think routing all log viewing through a single host/port running storm ui as requested in https://issues.apache.org/jira/browse/STORM-2708 is the most desirable approach for log viewiing in a container based deployment.\r\n\r\nThe obvious alternative is  leaving storm logging as is. This forces one to either give up the convenience of accessing all logs from the browser and instead requiring to ssh into each container, or an impractically complex setup that dynamically maps and open each supervisor's logviewer port to a port accessible from outside the cluster and handles container restarts and dynamic scaling of supervisors.\r\n\r\nThis issue has in some form been going on for almost 3 years in some form https://issues.apache.org/jira/browse/STORM-1342, but I believe it is now much more urgent than it used to be since deployment in containers is a lot more common now. Moreover I believe the solution should be orchestration agnostic. In particular it should not rely on runnning under mesos. It also should also not require running additional services: Since both a zookeeper and a nimbus are already required for any deployment, that should be sufficient for coordination for storm ui to display the logs of individual supervisors at its own port.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jmoraleda","name":"jmoraleda","key":"jmoraleda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jmoraleda&avatarId=35289","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jmoraleda&avatarId=35289","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jmoraleda&avatarId=35289","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jmoraleda&avatarId=35289"},"displayName":"Jorge Moraleda","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-30T21:53:55.816+0000","updated":"2018-07-30T21:55:47.816+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964673/comment/16563706","id":"16563706","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"[~jmoraleda],\r\n\r\nIn storm 2.x the supervisor now has a thrift server running on it that nimbus/others should be able to access.  It should be totally doable to have the UI talk directly to the supervisor's thrift server and fold all of the log management/access functionality into the supervisor.  As an added bonus that would mean one less daemon that we would have to run/worry about, and would mean we could also write command line code to read the logs back out.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2018-07-31T13:56:11.378+0000","updated":"2018-07-31T13:56:11.378+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964673/comment/16565282","id":"16565282","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xofer","name":"xofer","key":"xofer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Clarke","active":true,"timeZone":"America/Havana"},"body":"In case it's helpful, here's our proxy setup that solves this pretty well: [https://gist.github.com/xofer/e2a703d80979108c76ce53e5361fbc4d]\r\n\r\nThere are a handful of links that simply couldn't be rewritten, so remain broken.\r\n\r\nOriginally posted on https://issues.apache.org/jira/browse/STORM-580","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xofer","name":"xofer","key":"xofer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Clarke","active":true,"timeZone":"America/Havana"},"created":"2018-08-01T13:07:04.626+0000","updated":"2018-08-01T13:07:04.626+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1759/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2x3tb:"}}