{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12763185","self":"https://issues.apache.org/jira/rest/api/2/issue/12763185","key":"STORM-598","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2014-12-22T08:33:02.823+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jan 26 02:31:51 UTC 2015","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1918249_*|*_3_*:*_1_*:*_3001767042_*|*_4_*:*_1_*:*_15428_*|*_6_*:*_2_*:*_22115026286","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2015-10-09T01:37:40.378+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-598/watchers","watchCount":2,"isWatching":false},"created":"2014-12-22T08:12:13.397+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12328864","id":"12328864","name":"0.9.3-rc2","archived":false,"released":true}],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-09T01:37:40.400+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"1: Set up a Storm Cluster with 1 Supervisor(4 worker slots)\n2: submit topologyA and use 4 workers \n3: submit topologyB with 4 workers \n\ntopologyB does not but should show up on the storm ui cluster page.\n\n\nSee Code Line 232ï¼š\nhttps://github.com/apache/storm/blob/master/storm-core/src/clj/backtype/storm/daemon/nimbus.clj#L1232\n\nIf assignment is null, just new Assignmnet with 0 workers and 0 tasks? \n{code:title=nimbus.clj|borderStyle=solid}\nIndex: src/clj/backtype/storm/daemon/nimbus.clj\n===================================================================\n--- src/clj/backtype/storm/daemon/nimbus.clj\t(revision 4324)\n+++ src/clj/backtype/storm/daemon/nimbus.clj\t(working copy)\n@@ -1230,7 +1230,9 @@\n               bases (topology-bases storm-cluster-state)\n               topology-summaries (dofor [[id base] bases :when base]\n \t                                  (let [assignment (.assignment-info storm-cluster-state id nil)\n-                                                topo-summ (TopologySummary. id\n+                                                topo-summ ( if (nil? assignment) \n+                                                           (TopologySummary. id  (:storm-name base) 0 0 0  (time-delta (:launch-time-secs base)) (extract-status-str base))\n+                                                           (TopologySummary. id\n                                                             (:storm-name base)\n                                                             (->> (:executor->node+port assignment)\n                                                                  keys\n@@ -1244,7 +1246,7 @@\n                                                                  set\n                                                                  count)\n                                                             (time-delta (:launch-time-secs base))\n-                                                            (extract-status-str base))]\n+                                                            (extract-status-str base)))]\n                                                (when-let [owner (:owner base)] (.set_owner topo-summ owner))\n                                                (when-let [sched-status (.get @(:id->sched-status nimbus) id)] (.set_sched_status topo-summ sched-status))\n                                                topo-summ\n{code}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Newly submitted topologies do not show up on the storm ui cluser page when the Storm Cluster run out of worker slots ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763185/comment/14255555","id":"14255555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user caofangkun opened a pull request:\n\n    https://github.com/apache/storm/pull/355\n\n    STORM-598:Newly submitted topologies do not show up on the storm ui cluser page when the Storm Cluster run out of worker slots\n\n    1: Set up a Storm Cluster with 1 Supervisor(4 worker slots)\n    2: submit topologyA and use 4 workers\n    3: submit topologyB with 4 workers\n    \n    topologyB does not but should show up on the storm ui cluster page.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/caofangkun/apache-storm storm-598\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/355.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #355\n    \n----\ncommit 97ae36e42abc961fbcc54dd77c80bafff30dce7e\nAuthor: caofangkun <caofangkun@gmail.com>\nDate:   2014-12-22T08:18:08Z\n\n    Merge pull request #2 from apache/master\n    \n    Merge from trunk to caofangkun\n\ncommit b2b7f7e0b079f01344f0efcf6a6b17365ff21cc7\nAuthor: caofangkun <caofangkun@gmail.com>\nDate:   2014-12-22T08:29:43Z\n\n    STORM-598:Newly submitted topologies do not show up on the storm ui cluser page when the Storm Cluster run out of worker slots\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-22T08:33:02.823+0000","updated":"2014-12-22T08:33:02.823+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763185/comment/14257550","id":"14257550","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/355#discussion_r22236169\n  \n    --- Diff: storm-core/src/clj/backtype/storm/daemon/nimbus.clj ---\n    @@ -1248,7 +1256,7 @@\n                                                    (when-let [owner (:owner base)] (.set_owner topo-summ owner))\n                                                    (when-let [sched-status (.get @(:id->sched-status nimbus) id)] (.set_sched_status topo-summ sched-status))\n                                                    topo-summ\n    -                                          ))]\n    +                                          )))]\n    --- End diff --\n    \n    The new ')' is in the wrong place.  It should be up on line 1255 instead.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-23T21:16:28.079+0000","updated":"2014-12-23T21:16:28.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763185/comment/14257578","id":"14257578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/storm/pull/355#issuecomment-68001550\n  \n    Also I tried to reproduce the issue on master and I am seeing the second topology come up on the ui without any issues.  Could you try to reproduce the error on master and let me know if it is still an issue?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-12-23T21:40:41.248+0000","updated":"2014-12-23T21:40:41.248+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763185/comment/14289951","id":"14289951","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/storm/pull/355#issuecomment-71263582\n  \n    The code compiles now, but I still have not been able to reproduce the original cause of this problem. am I doing something wrong?\n    ```\n    ./bin/storm dev-zookeeper &\n    ./bin/storm nimbus &\n    ./bin/storm supervisor &\n    ./bin/storm ui &\n    ./bin/storm logviewer &\n    ```\n    wait for the UI to come up\n    ```\n    ./bin/storm jar ./examples/storm-starter/storm-starter-topologies-0.10.0-SNAPSHOT.jar storm.starter.WordCountTopology wc -c topology.workers=4\n    ./bin/storm jar ./examples/storm-starter/storm-starter-topologies-0.10.0-SNAPSHOT.jar storm.starter.WordCountTopology wc-2 -c topology.workers=4\n    ```\n    \n    Both show up in the TopologySummary section of the index.html page.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-23T20:51:32.867+0000","updated":"2015-01-23T20:51:32.867+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763185/comment/14291402","id":"14291402","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user caofangkun commented on the pull request:\n\n    https://github.com/apache/storm/pull/355#issuecomment-71407839\n  \n    @revans2 \n    I have tried on master.  The UI indeed display correctly.  This should be no longer a issue. \n    Thanks for your attention and patience.\n    I will close this issue.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-26T02:31:50.864+0000","updated":"2015-01-26T02:31:50.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12763185/comment/14291403","id":"14291403","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user caofangkun closed the pull request at:\n\n    https://github.com/apache/storm/pull/355\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-26T02:31:51.266+0000","updated":"2015-01-26T02:31:51.266+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-598/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i23ofr:"}}