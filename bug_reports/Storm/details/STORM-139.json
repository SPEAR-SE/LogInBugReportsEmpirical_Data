{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12684765","self":"https://issues.apache.org/jira/rest/api/2/issue/12684765","key":"STORM-139","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327123","id":"12327123","description":"security feature branch","name":"0.10.0","archived":false,"released":true,"releaseDate":"2015-11-05"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-07-17T23:21:31.977+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jul 22 23:48:31 UTC 2015","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_50521445175_*|*_5_*:*_1_*:*_0","customfield_12310420":"363837","customfield_12312321":null,"resolutiondate":"2015-07-22T23:48:31.722+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-139/watchers","watchCount":5,"isWatching":false},"created":"2013-12-15T06:04:26.590+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagit","name":"dagit","key":"dagit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagit&avatarId=25742","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagit&avatarId=25742","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagit&avatarId=25742","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagit&avatarId=25742"},"displayName":"Derek Dagit","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-09T01:01:09.894+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"https://github.com/nathanmarz/storm/issues/245\n\nStorm should use a different hashCode method when getting the hash for a byte[] array, since the default one uses the object identity. Should check the behavior on other arrays as well\n\n----------\nxiaokang: I tested byte[] and other arrays. The hashCode of array is the array object identity.\n\nI alse tested that java.util.Arrays.hashCode(xx[]) is based of the array element's hash code. It maybe ok change the list-hash-code function of tuple.clj to fix the problem.\n\n----------\nSirwellington: you may want to read this:\nhttp://martin.kleppmann.com/2012/06/18/java-hashcode-unsafe-for-distributed-systems.html\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"364143","customfield_12312823":null,"summary":"hashCode does not work for byte[]","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xumingming","name":"xumingming","key":"xumingming","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=xumingming&avatarId=18354","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xumingming&avatarId=18354","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xumingming&avatarId=18354","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xumingming&avatarId=18354"},"displayName":"James Xu","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xumingming","name":"xumingming","key":"xumingming","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=xumingming&avatarId=18354","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xumingming&avatarId=18354","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xumingming&avatarId=18354","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xumingming&avatarId=18354"},"displayName":"James Xu","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14632090","id":"14632090","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user d2r opened a pull request:\n\n    https://github.com/apache/storm/pull/641\n\n    [STORM-139] Correctly hash byte array tuple values\n\n    * Unit test for correctness is included\n    * The following tests showed no discernible difference in latency or throughput:\n      * word_count, last 10min stats after being running > 10min\n      * word_count modified to send byte[] words instead of Strings, same conditions\n    \n    This should handle the kinds of Objects we care about: reference types, all primitive array types, and reference array types.\n    \n    \n    Using Java's .hashCode is a problem for distributed systems, as was pointed out in the JIRA.\n    \n    However, the behavior of [String#hashCode](https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#hashCode%28%29), and the implementation of [java.util.Arrays#hashCode](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Arrays.java#Arrays.hashCode%28float[]%29) for all primitive array types is defined and should be consistent across JVMs.  This leaves Objects and Object[] that are not Strings.  In these cases, this change still trusts the hashCode method provided in those classes.\n    \n    In practice, bad cases should be rare.  In the cases when hashing is inconsistent and some sort of partitioning is used, it could be very difficult to debug.\n    \n\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/d2r/storm storm-138-byte-array-hashcode\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/641.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #641\n    \n----\ncommit 46b8c9e71b4b9b3f0e8c762fe070793e3f6d4971\nAuthor: Derek Dagit <derekd@yahoo-inc.com>\nDate:   2015-07-17T21:54:32Z\n\n    Correctly hash byte array tuple values\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-17T23:21:31.977+0000","updated":"2015-07-17T23:21:31.977+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14632115","id":"14632115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user d2r closed the pull request at:\n\n    https://github.com/apache/storm/pull/641\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-17T23:42:02.762+0000","updated":"2015-07-17T23:42:02.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14632121","id":"14632121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user d2r reopened a pull request:\n\n    https://github.com/apache/storm/pull/641\n\n    [STORM-139] Correctly hash byte array tuple values\n\n    * Unit test for correctness is included\n    * The following tests showed no discernible difference in latency or throughput:\n      * word_count, last 10min stats after being running > 10min\n      * word_count modified to send byte[] words instead of Strings, same conditions\n    \n    This should handle the kinds of Objects we care about: reference types, all primitive array types, and reference array types.\n    \n    \n    Using Java's .hashCode is a problem for distributed systems, as was pointed out in the JIRA.\n    \n    However, the behavior of [String#hashCode](https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#hashCode%28%29), and the implementation of [java.util.Arrays#hashCode](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Arrays.java#Arrays.hashCode%28float[]%29) for all primitive array types is defined and should be consistent across JVMs.  This leaves Objects and Object[] that are not Strings.  In these cases, this change still trusts the hashCode method provided in those classes.\n    \n    In practice, bad cases should be rare.  In the cases when hashing is inconsistent and some sort of partitioning is used, it could be very difficult to debug.\n    \n\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/d2r/storm storm-138-byte-array-hashcode\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/641.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #641\n    \n----\ncommit b132520adb00def6d03ef020b1cb5973eb3b3519\nAuthor: Derek Dagit <derekd@yahoo-inc.com>\nDate:   2015-07-17T23:45:39Z\n\n    Correctly hash byte array tuple values\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-17T23:46:13.926+0000","updated":"2015-07-17T23:46:13.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14632256","id":"14632256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/storm/pull/641#issuecomment-122480198\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-18T04:01:15.441+0000","updated":"2015-07-18T04:01:15.441+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14634859","id":"14634859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user vesense commented on the pull request:\n\n    https://github.com/apache/storm/pull/641#issuecomment-123242642\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-21T09:42:02.354+0000","updated":"2015-07-21T09:42:02.354+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14635194","id":"14635194","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/641#discussion_r35109156\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/grouping/PartialKeyGrouping.java ---\n    @@ -65,7 +66,11 @@ public void prepare(WorkerTopologyContext context, GlobalStreamId stream, List<I\n                     List<Object> selectedFields = outFields.select(fields, values);\n                     ByteBuffer out = ByteBuffer.allocate(selectedFields.size() * 4);\n                     for (Object o: selectedFields) {\n    -                    out.putInt(o.hashCode());\n    +                    if (o instanceof Object[]) {\n    --- End diff --\n    \n    @d2r \n    Could we add same thing (converting List to Object[] by toArray, and apply Arrays.deepHashCode()) from list-hash-code to this?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-21T14:38:47.761+0000","updated":"2015-07-21T14:38:47.761+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14635303","id":"14635303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user d2r commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/641#discussion_r35120287\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/grouping/PartialKeyGrouping.java ---\n    @@ -65,7 +66,11 @@ public void prepare(WorkerTopologyContext context, GlobalStreamId stream, List<I\n                     List<Object> selectedFields = outFields.select(fields, values);\n                     ByteBuffer out = ByteBuffer.allocate(selectedFields.size() * 4);\n                     for (Object o: selectedFields) {\n    -                    out.putInt(o.hashCode());\n    +                    if (o instanceof Object[]) {\n    --- End diff --\n    \n    Yes, we need to catch the primitive array types as well somehow.\n    \n    Here `o` may not be a List.  I think we need to check not only `instanceof Object[]` but all of the other primitive array types as well.  Probably something like this?\n    \n    ```Java\n    for (Object o: selectedFields) {\n        if (o instanceof Object[]) {\n            out.putInt(Arrays.deepHashCode((Object[])o));\n        } else if (o instanceof byte[]) {\n            out.putInt(Arrays.hashCode((byte[]) o));\n        } else if (o instanceof short[]) {\n            out.putInt(Arrays.hashCode((short[]) o));\n        } else if (o instanceof int[]) {\n            out.putInt(Arrays.hashCode((int[]) o));\n        } else if (o instanceof long[]) {\n            out.putInt(Arrays.hashCode((long[]) o));\n        } else if (o instanceof char[]) {\n            out.putInt(Arrays.hashCode((char[]) o));\n        } else if (o instanceof float[]) {\n            out.putInt(Arrays.hashCode((float[]) o));\n        } else if (o instanceof double[]) {\n            out.putInt(Arrays.hashCode((double[]) o));\n        } else if (o instanceof boolean[]) {\n            out.putInt(Arrays.hashCode((boolean[]) o));\n        } else if (o != null) {\n            out.putInt(o.hashCode());\n        } else {\n          out.putInt(0);\n        }\n    ```\n    \n    This seems to be what [Arrays#deepHashCode](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Arrays.java#3709) does.\n    \n    What do you think?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-21T16:04:30.642+0000","updated":"2015-07-21T16:04:30.642+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14635322","id":"14635322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/641#discussion_r35121430\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/grouping/PartialKeyGrouping.java ---\n    @@ -65,7 +66,11 @@ public void prepare(WorkerTopologyContext context, GlobalStreamId stream, List<I\n                     List<Object> selectedFields = outFields.select(fields, values);\n                     ByteBuffer out = ByteBuffer.allocate(selectedFields.size() * 4);\n                     for (Object o: selectedFields) {\n    -                    out.putInt(o.hashCode());\n    +                    if (o instanceof Object[]) {\n    --- End diff --\n    \n    @d2r \n    I didn't think about primitive array type.\n    Actually I mean that,\n    - Does 'o' have an chance to be instance of List? \n    - If then, could we apply ```((List)o).toArray()``` to convert it Object[], and let if statement handle it?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-21T16:14:48.533+0000","updated":"2015-07-21T16:14:48.533+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14635414","id":"14635414","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user d2r commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/641#discussion_r35127032\n  \n    --- Diff: storm-core/src/jvm/backtype/storm/grouping/PartialKeyGrouping.java ---\n    @@ -65,7 +66,11 @@ public void prepare(WorkerTopologyContext context, GlobalStreamId stream, List<I\n                     List<Object> selectedFields = outFields.select(fields, values);\n                     ByteBuffer out = ByteBuffer.allocate(selectedFields.size() * 4);\n                     for (Object o: selectedFields) {\n    -                    out.putInt(o.hashCode());\n    +                    if (o instanceof Object[]) {\n    --- End diff --\n    \n    I see. Yes, I could add this.  However, since we do not currently do this in backtype.storm.tuple it would be inconsistent.\n    \n    In b.s.tuple, I always get a List<Object>.  I convert it to an array there because the call to Arrays#deepHashCode is simple.  If a tuple is _itself_ a List, then Arrays#hashCode will call List#hashCode on it.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-21T17:04:29.683+0000","updated":"2015-07-21T17:04:29.683+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14635467","id":"14635467","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user d2r commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/641#discussion_r35130923\n  \n    --- Diff: storm-core/src/clj/backtype/storm/tuple.clj ---\n    @@ -15,8 +15,11 @@\n     ;; limitations under the License.\n     \n     (ns backtype.storm.tuple\n    -  (:import [java.util List]))\n    +  (:import [java.util Arrays List]))\n     \n     (defn list-hash-code\n       [^List alist]\n    -  (.hashCode alist))\n    +  (if (nil? alist)\n    +    1\n    +    (let [^\"[Ljava.lang.Object;\" array (.toArray alist)] ;; Object[]\n    +      (Arrays/deepHashCode array))))\n    --- End diff --\n    \n    The type hint here seems to be unnecessary.  I'll remove it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-21T17:40:58.455+0000","updated":"2015-07-21T17:40:58.455+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14637349","id":"14637349","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user d2r commented on the pull request:\n\n    https://github.com/apache/storm/pull/641#issuecomment-123815242\n  \n    Ok, addressed comments.\n    \n    @HeartSaVioR, I made your suggested change as well.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-22T18:18:34.676+0000","updated":"2015-07-22T18:18:34.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14637744","id":"14637744","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user HeartSaVioR commented on the pull request:\n\n    https://github.com/apache/storm/pull/641#issuecomment-123884557\n  \n    LGTM, +1.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-22T22:13:41.073+0000","updated":"2015-07-22T22:13:41.073+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14637928","id":"14637928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/641\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-22T23:40:05.038+0000","updated":"2015-07-22T23:40:05.038+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684765/comment/14637937","id":"14637937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Thanks [~dagit].\nI merged into master.\n\nSince it affects whole version lines, I'd like to apply this to all lines, too.\nI'll add this to my list of \"backport\", and ask opinions with that list from dev mailing list.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2015-07-22T23:48:31.753+0000","updated":"2015-07-22T23:48:31.753+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-139/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1qpr3:"}}