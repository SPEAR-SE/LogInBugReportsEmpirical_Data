{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12940212","self":"https://issues.apache.org/jira/rest/api/2/issue/12940212","key":"STORM-1560","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-02-26T18:56:24.822+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu May 31 18:53:50 UTC 2018","customfield_12312320":null,"customfield_12310222":null,"customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1560/watchers","watchCount":20,"isWatching":false},"created":"2016-02-18T17:48:54.153+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329843","id":"12329843","name":"1.0.0","archived":false,"released":true,"releaseDate":"2016-04-12"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-05-31T18:53:50.286+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"In some scenarios, netty connection problems can leave a topology in an unrecoverable state. The likely culprit is the Netty {{HashedWheelTimer}} class that contains the following code:\n\n{code}\n        public void expire() {\n            if(this.compareAndSetState(0, 2)) {\n                try {\n                    this.task.run(this);\n                } catch (Throwable var2) {\n                    if(HashedWheelTimer.logger.isWarnEnabled()) {\n                        HashedWheelTimer.logger.warn(\"An exception was thrown by \" + TimerTask.class.getSimpleName() + '.', var2);\n                    }\n                }\n            }\n        }\n{code}\n\nThe exception being swallowed can be seen below:\n\n{code}\n2016-02-18 08:46:59.116 o.a.s.m.n.Client [INFO] closing Netty Client Netty-Client-/192.168.202.6:6701\n2016-02-18 08:46:59.173 o.a.s.m.n.Client [INFO] waiting up to 600000 ms to send 0 pending messages to Netty-Client-/192.168.202.6:6701\n2016-02-18 08:46:59.271 STDIO [ERROR] Feb 18, 2016 8:46:59 AM org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer\nWARNING: An exception was thrown by TimerTask.\njava.lang.RuntimeException: Giving up to scheduleConnect to Netty-Client-/192.168.202.6:6701 after 44 failed attempts. 3 messages were lost\n\tat org.apache.storm.messaging.netty.Client$Connect.run(Client.java:573)\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:546)\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$Worker.notifyExpiredTimeouts(HashedWheelTimer.java:446)\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:395)\n\tat org.apache.storm.shade.org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n\tat java.lang.Thread.run(Thread.java:745)\n{code}\n\nThe netty client then never recovers, and the follows messages repeat forever:\n\n{code}\n2016-02-18 09:42:56.251 o.a.s.m.n.Client [ERROR] discarding 1 messages because the Netty client to Netty-Client-/192.168.202.6:6701 is being closed\n2016-02-18 09:43:25.248 o.a.s.m.n.Client [ERROR] discarding 1 messages because the Netty client to Netty-Client-/192.168.202.6:6701 is being closed\n2016-02-18 09:43:55.248 o.a.s.m.n.Client [ERROR] discarding 1 messages because the Netty client to Netty-Client-/192.168.202.6:6701 is being closed\n2016-02-18 09:43:55.752 o.a.s.m.n.Client [ERROR] discarding 2 messages because the Netty client to Netty-Client-/192.168.202.6:6701 is being closed\n2016-02-18 09:43:56.252 o.a.s.m.n.Client [ERROR] discarding 1 messages because the Netty client to Netty-Client-/192.168.202.6:6701 is being closed\n2016-02-18 09:44:25.249 o.a.s.m.n.Client [ERROR] discarding 1 messages because the Netty client to Netty-Client-/192.168.202.6:6701 is being closed\n{code}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12861248","id":"12861248","filename":"fix-lockup.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-30T14:42:59.991+0000","size":6881,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12861248/fix-lockup.patch"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Topology stops processing after Netty catches/swallows Throwable","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15169541","id":"15169541","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"[~ptgoetz] \nProviding more log lines may be helpful to determine what things were occurred.\nFor example, is there any log messages \"connection attempt %s to %s failed\" before \"closing Netty Client\"?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-02-26T18:56:24.822+0000","updated":"2016-02-26T18:56:24.822+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15170084","id":"15170084","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Strange... Let's focus that Client seems to be closed but worker still call send() to that Client.\nThere're methods which closes the Client...\n\n1.  mk-refresh-connection\n\nmk-refresh-connection replaces cached-task->node+port first, and closes remove-connections, so send() shouldn't be called to that Client.\n\n2. Context.term()\n\nIt means that worker is in progress of shutdown, so eventually send() shouldn't be called.\n\n3. Connect.run()\n\nConnect.run() only calls Client.close() when closing is true, which means that either 1 or 2 should occur before this one.\n\nPlease comment new paths here which I'm missing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2016-02-26T23:23:01.639+0000","updated":"2016-02-26T23:24:28.780+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15170539","id":"15170539","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abhishek.agarwal","name":"abhishek.agarwal","key":"abhishek.agarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Abhishek Agarwal","active":true,"timeZone":"Asia/Kolkata"},"body":"I also checked without any success. One possible cause could be context returning a stale value of client. (host-port --> connections) map inside the context class is not thread safe. There are synchronized blocks but they do not guarantee visibility consistency. \nHowever, other than shutdown, I could not see any scenario wherein the put and get to this map is called from different thread. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abhishek.agarwal","name":"abhishek.agarwal","key":"abhishek.agarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Abhishek Agarwal","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-02-27T10:32:18.446+0000","updated":"2016-02-27T10:32:18.446+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15214877","id":"15214877","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"body":"Lowering priority to major and removing from 1.0 release epic since I (and others) are unable to reliably reproduce.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"created":"2016-03-28T20:56:02.746+0000","updated":"2016-03-28T20:56:02.746+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15215692","id":"15215692","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huyl08","name":"huyl08","key":"huyl08","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hu Yanglin","active":true,"timeZone":"Etc/UTC"},"body":"Similar problem as following.\n\nI got everything well when I ran topology in Eclipse LocalCluster. \n\nI used Kafka Spout/StateUpdater in Trident State.\n\n2016-03-29 16:40:36.461 b.s.m.n.Client [ERROR] connection attempt 12 to Netty-Client-bt-199-036.bta.net.cn/202.106.199.36:6702 failed: org.apache.storm.shade.org.jboss.netty.channel.ConnectTimeoutException: connection timed out: bt-199-036.bta.net.cn/202.106.199.36:6702\n2016-03-29 16:40:36.859 STDIO [ERROR] 三月 29, 2016 4:40:36 下午 org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer\n警告: An exception was thrown by TimerTask.\njava.lang.RuntimeException: Giving up to scheduleConnect to Netty-Client-bt-199-036.bta.net.cn/202.106.199.36:6702 after 12 failed attempts. 0 messages were lost\n\tat backtype.storm.messaging.netty.Client$Connect.run(Client.java:511)\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:546)\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$Worker.notifyExpiredTimeouts(HashedWheelTimer.java:446)\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:395)\n\tat org.apache.storm.shade.org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n\tat java.lang.Thread.run(Thread.java:745)\n2016-03-29 16:40:44.466 b.s.m.n.Client [ERROR] connection attempt 1 to Netty-Client-bt-199-036.bta.net.cn/202.106.199.36:6703 failed: org.apache.storm.shade.org.jboss.netty.channel.ConnectTimeoutException: connection timed out: bt-199-036.bta.net.cn/202.106.199.36:6703\n2016-03-29 16:40:54.665 b.s.m.n.Client [ERROR] connection attempt 2 to Netty-Client-bt-199-036.bta.net.cn/202.106.199.36:6703 failed:","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huyl08","name":"huyl08","key":"huyl08","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hu Yanglin","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-29T08:46:49.575+0000","updated":"2016-03-29T08:46:49.575+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15215907","id":"15215907","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Johnbaba","name":"Johnbaba","key":"johnbaba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=johnbaba&avatarId=25536","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=johnbaba&avatarId=25536","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=johnbaba&avatarId=25536","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=johnbaba&avatarId=25536"},"displayName":"John Fang","active":true,"timeZone":"Asia/Shanghai"},"body":"Connect.run() only calls Client.close() when closing is true. We see the connections calls client.close by Connect.run() from the log. So we should call the close() previously. Thus the log should print the \"closing Netty Client {}\" when calls close() previously. [~ptgoetz]   can you find the a little earlier log about close()?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Johnbaba","name":"Johnbaba","key":"johnbaba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=johnbaba&avatarId=25536","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=johnbaba&avatarId=25536","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=johnbaba&avatarId=25536","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=johnbaba&avatarId=25536"},"displayName":"John Fang","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-03-29T12:09:05.792+0000","updated":"2016-03-29T12:09:36.443+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15217214","id":"15217214","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huyl08","name":"huyl08","key":"huyl08","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hu Yanglin","active":true,"timeZone":"Etc/UTC"},"body":"Maybe this is a problem due to incompatibility of different Zookeeper versions. I solved my problem by removing Zookeeper dependencies in my $STORM_HOME/extlib. \n\nPreviously, I used Zookeeper-3.4.7 as my zk cluster and imported zookeeper-3.4.6.jar from kafka_2.11-0.8.2.2/lib, and the problem came into being. After I removed the wrong version zk jar, everything went ok with me. \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=huyl08","name":"huyl08","key":"huyl08","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hu Yanglin","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-30T01:45:03.862+0000","updated":"2016-03-30T01:45:03.862+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15218808","id":"15218808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"Zookeeper does have netty as a dependency, but in the versions we have been using it is not configured to be on.  Perhaps newer versions of zookeeper have it packaged with it somehow?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2016-03-30T20:37:47.813+0000","updated":"2016-03-30T20:37:47.813+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15218862","id":"15218862","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"body":"[~Johnbaba], unfortunately I don't. I ran into it when testing on a virtualized cluster that I've since destroyed. Next time I'll be better at saving off the log files. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"created":"2016-03-30T21:04:16.987+0000","updated":"2016-03-30T21:04:16.987+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15236936","id":"15236936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=raviraj","name":"raviraj","key":"raviraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raviraj","active":true,"timeZone":"Etc/UTC"},"body":"I have been facing a similar issue in storm. keep getting a error like \n[ERROR] discarding 1 messages because the Netty client to Netty-Client-/{host}:{port} is being closed\n\nI have seen it appear when the storm nodes had connectivity issues\n1. connectivity issues within storm nodes\n2. connectivity issues between kafka spout and kafka broker.\nEven after the connectivity is recovered , the issue still remains.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=raviraj","name":"raviraj","key":"raviraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raviraj","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-12T09:54:05.206+0000","updated":"2016-04-12T09:54:05.206+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15236940","id":"15236940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abhishek.agarwal","name":"abhishek.agarwal","key":"abhishek.agarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Abhishek Agarwal","active":true,"timeZone":"Asia/Kolkata"},"body":"That could possibly be because the topology workers are getting restarted frequently. It usually happens when there is an uncaught exception in the topology. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abhishek.agarwal","name":"abhishek.agarwal","key":"abhishek.agarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Abhishek Agarwal","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-04-12T09:57:02.651+0000","updated":"2016-04-12T09:57:02.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15238745","id":"15238745","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=raviraj","name":"raviraj","key":"raviraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raviraj","active":true,"timeZone":"Etc/UTC"},"body":"Even if the topology workers are getting restarted, why should it lead to discarding a message. Even when the worker is back up,i see these errors and some missing messgaes. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=raviraj","name":"raviraj","key":"raviraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raviraj","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-13T07:21:33.748+0000","updated":"2016-04-13T07:21:33.748+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15333566","id":"15333566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"Is it certain that this problem affects version 1.0.0? Because I observed the same problem  in 0.9.6 when workers restarted in short succession. That often happens if one worker crashes since nimbus tends to reassign tasks right around the time the crashed worker is restarted by the supervisor (most likely because by default both heartbeat timeouts are 30 second).\nI had a patch that solved it, but it is no longer necessary for 1.0.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-16T10:55:59.572+0000","updated":"2016-06-16T10:55:59.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15403830","id":"15403830","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunfanfighting%40foxmail.com","name":"yunfanfighting@foxmail.com","key":"yunfanfighting@foxmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"yf","active":true,"timeZone":"Etc/UTC"},"body":"I meet same problem in 0.9.6. Can you tell me, how you slove the problem in that version?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunfanfighting%40foxmail.com","name":"yunfanfighting@foxmail.com","key":"yunfanfighting@foxmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"yf","active":true,"timeZone":"Etc/UTC"},"created":"2016-08-02T11:51:07.857+0000","updated":"2016-08-02T11:51:07.857+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15932302","id":"15932302","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hitsdx","name":"hitsdx","key":"hitsdx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sun","active":true,"timeZone":"Etc/UTC"},"body":"Hi,Nico Meyer,the same problem appears in version 0.10.0.The situation is similar to what you say.Can I know how you solve this problem?I am Looking forward to your replay.Thanks a lot.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hitsdx","name":"hitsdx","key":"hitsdx","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sun","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-20T08:26:02.837+0000","updated":"2017-03-20T08:26:02.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15949209","id":"15949209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"Patch for 0.9.6","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-30T14:43:00.000+0000","updated":"2017-03-30T14:43:00.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/15949210","id":"15949210","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"Hi sun, sorry for the long delay, but I forgot my password and the reset function didn't work for me last week.\n\nI attached our patch against 0.9.6 (created with 'git diff') that seemed to do the trick, but no guarantees. We upgraded to 1.0.2 by now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-30T14:43:13.486+0000","updated":"2017-03-30T14:44:02.276+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16057088","id":"16057088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunny.davy","name":"sunny.davy","key":"sunny.davy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ryan.jin","active":true,"timeZone":"Asia/Shanghai"},"body":"[~nico.meyer]\n\nBecause of the Log \n\n{code:java}\n2016-02-18 08:46:59.116 o.a.s.m.n.Client [INFO] closing Netty Client Netty-Client-/192.168.202.6:6701\n{code}\n,\nthe method {color:red}close(){color} in backtype.storm.messaging.netty.Client is invoked.\n\nSo your Patch maybe to not working because reconnectingAllowed will always return {color:red}FALSE{color}.\n\n{code:java}\npublic void run(Timeout timeout)\n      throws Exception\n    {\n      if (Client.this.reconnectingAllowed())\n      {\n{code}\n\n[STORM-2561|https://issues.apache.org/jira/browse/STORM-2561]\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunny.davy","name":"sunny.davy","key":"sunny.davy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ryan.jin","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-06-21T07:23:37.074+0000","updated":"2017-06-21T07:23:37.074+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16057201","id":"16057201","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"[~sunny.davy]\n\nI don't remember the details to be honest, since I wrote this over a year ago. And we moved on to Storm 1.0.2 by now, which does not have this problem any more.\nAll I can say is, that we used the patch in production for quite some time and did not ever observe the lockup problem again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2017-06-21T08:53:08.044+0000","updated":"2017-06-21T08:53:18.171+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16057220","id":"16057220","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunny.davy","name":"sunny.davy","key":"sunny.davy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ryan.jin","active":true,"timeZone":"Asia/Shanghai"},"body":"[~nico.meyer]\n\nOkey, maybe I will upgrade to 0.10.2 firstly. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunny.davy","name":"sunny.davy","key":"sunny.davy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ryan.jin","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-06-21T09:10:09.099+0000","updated":"2017-06-21T09:10:09.099+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16057224","id":"16057224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"body":"[~sunny.davy]\nI would propose upgrading to 1.0.3 directly. It is a little bit of work to fix all the namespaces, and some other minor things. But there are a lot of other improvements in the 1.x version that warrant the time spent in my opinion.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nico.meyer","name":"nico.meyer","key":"nico.meyer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nico Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2017-06-21T09:15:19.485+0000","updated":"2017-06-21T09:15:19.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16057297","id":"16057297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunny.davy","name":"sunny.davy","key":"sunny.davy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ryan.jin","active":true,"timeZone":"Asia/Shanghai"},"body":"[~nico.meyer]\n\n:)  I will review the diff between 0.10.x and 1.0.x , thank you","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sunny.davy","name":"sunny.davy","key":"sunny.davy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ryan.jin","active":true,"timeZone":"Asia/Shanghai"},"created":"2017-06-21T10:15:37.427+0000","updated":"2017-06-21T10:15:37.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16199992","id":"16199992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurav689","name":"saurav689","key":"saurav689","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurav Suman","active":true,"timeZone":"Etc/UTC"},"body":"Hi ,\r\n\r\nI also got similar error. I am using storm 1.1.1 . Please advise.\r\n\r\n2017-10-10 13:17:47.674 o.a.s.m.n.Client client-boss-1 [ERROR] connection attempt 199 to Netty-Client-/192.168.2.195:6702 failed: java.net.ConnectException: Connection refused: /192.168.2.195:6702\r\n2017-10-10 13:17:47.674 o.a.s.u.StormBoundedExponentialBackoffRetry client-boss-1 [WARN] WILL SLEEP FOR 738ms (MAX)\r\n2017-10-10 13:17:48.474 o.a.s.m.n.Client client-boss-1 [ERROR] connection attempt 200 to Netty-Client-/192.168.2.195:6702 failed: java.net.ConnectException: Connection refused: /192.168.2.195:6702\r\n2017-10-10 13:17:48.475 o.a.s.u.StormBoundedExponentialBackoffRetry client-boss-1 [WARN] WILL SLEEP FOR 741ms (MAX)\r\n2017-10-10 13:17:48.972 o.a.s.m.n.Client refresh-connections-timer [INFO] closing Netty Client Netty-Client-/192.168.2.195:6702\r\n2017-10-10 13:17:48.977 o.a.s.m.n.Client refresh-connections-timer [INFO] waiting up to 600000 ms to send 0 pending messages to Netty-Client-/192.168.2.195:6702\r\n2017-10-10 13:17:49.271 STDIO client-schedule-service-1 [ERROR] Oct 10, 2017 1:17:49 PM org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer\r\nWARNING: An exception was thrown by TimerTask.\r\njava.lang.RuntimeException: Giving up to scheduleConnect to Netty-Client-/192.168.2.195:6702 after 200 failed attempts. 0 messages were lost\r\n\tat org.apache.storm.messaging.netty.Client$Connect.run(Client.java:606)\r\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:546)\r\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$Worker.notifyExpiredTimeouts(HashedWheelTimer.java:446)\r\n\tat org.apache.storm.shade.org.jboss.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:395)\r\n\tat org.apache.storm.shade.org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n2017-10-10 13:19:55.636 o.a.s.m.n.StormServerHandler Netty-server-localhost-6702-worker-1 [ERROR] server errors in handling the request\r\njava.io.IOException: Connection reset by peer\r\n\tat sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[?:1.8.0_131]\r\n\tat sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[?:1.8.0_131]\r\n\tat sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[?:1.8.0_131]\r\n\tat sun.nio.ch.IOUtil.read(IOUtil.java:192) ~[?:1.8.0_131]\r\n\tat sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) ~[?:1.8.0_131]\r\n\tat org.apache.storm.shade.org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:64) [storm-core-1.1.1.jar:1.1.1]\r\n\tat org.apache.storm.shade.org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108) [storm-core-1.1.1.jar:1.1.1]\r\n\tat org.apache.storm.shade.org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:318) [storm-core-1.1.1.jar:1.1.1]\r\n\tat org.apache.storm.shade.org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89) [storm-core-1.1.1.jar:1.1.1]\r\n\tat org.apache.storm.shade.org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178) [storm-core-1.1.1.jar:1.1.1]\r\n\tat org.apache.storm.shade.org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) [storm-core-1.1.1.jar:1.1.1]\r\n\tat org.apache.storm.shade.org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42) [storm-core-1.1.1.jar:1.1.1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_131]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_131]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]\r\n2017-10-10 13:28:14.369 o.a.s.m.n.StormServerHandler Netty-server-localhost-6702-worker-1 [ERROR] server errors in handling the request\r\njava.io.IOException: Connection reset by peer","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurav689","name":"saurav689","key":"saurav689","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurav Suman","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-11T09:07:04.013+0000","updated":"2017-10-11T09:07:04.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16200404","id":"16200404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"[~saurav689],\r\n\r\nIn 1.1.1 The only time that \"Giving up to schedule\" is thrown, is when the netty client is closing.  The only time that it is closing is when the scheduling has changed and we no longer have a need to that client, which is what you have in your logs with the refresh-connections-timer.\r\n\r\nFrom the logs it looks like your topology had a worker scheduled to be on 192.168.2.195:6702, but that worker never came up for some reason.  You didn't include the logs so I cannot tell.  After some time nimbus rescheduled the worker to be on a different host/port.  At that point you got an exception while we were closing the client. \r\n\r\nThe later logs for Netty-server-localhost-6702-worker-1 indicate that a worker that was connected to this worker broke the connection.  They are most likely not related to the first one.\r\n\r\nDid your topology eventually recover?  Did you ever look at the logs for 192.168.2.195:6702 to try and see why it didn't come up?  In 2.x we have added in better logging so hopefully we would be able to see which worker disconnected from the server.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2017-10-11T14:57:35.313+0000","updated":"2017-10-11T14:57:35.313+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16326055","id":"16326055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=avermeerbergen","name":"avermeerbergen","key":"avermeerbergen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexandre Vermeerbergen","active":true,"timeZone":"Europe/Paris"},"body":"Hello,\r\n\r\nFYI - We get same error about one time per month in our production Storm cluster.\r\n\r\nOur by-pass is to monitor our topologies using Storm web services and restart impacted topologies when we detect they are impacted (poor's man by pass...)\r\n\r\n \r\n\r\nBest regards,\r\n\r\nAlexandre Vermeerbergen\r\n\r\n \r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=avermeerbergen","name":"avermeerbergen","key":"avermeerbergen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexandre Vermeerbergen","active":true,"timeZone":"Europe/Paris"},"created":"2018-01-15T09:53:55.134+0000","updated":"2018-01-15T09:53:55.134+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12940212/comment/16497008","id":"16497008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"Looks similar to STORM-3055","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-05-31T18:53:50.286+0000","updated":"2018-05-31T18:53:50.286+0000"}],"maxResults":26,"total":26,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-1560/votes","votes":6,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2t0h3:"}}