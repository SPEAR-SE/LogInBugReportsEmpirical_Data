{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12685800","self":"https://issues.apache.org/jira/rest/api/2/issue/12685800","key":"STORM-180","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2013-12-20T17:44:47.726+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Dec 23 15:51:46 UTC 2013","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_271638471_*|*_5_*:*_1_*:*_0","customfield_12310420":"365134","customfield_12312321":null,"resolutiondate":"2013-12-23T15:59:55.469+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-180/watchers","watchCount":2,"isWatching":false},"created":"2013-12-20T12:32:37.027+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["nimbus","zookeeper"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-09T00:53:18.279+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"For example, If I specify three servers in config for zookeeper, and any of them not working during \n`storm nimbus`\nthen nimbus fails to start at all - \n\nCan this be avoided somehow?\nIf one of zookeeper servers failed, then I had to reconfigure all storm instances to simply start it and connect to working zk servers.\n\nBacktrace:\n\n2013-12-20 14:08:08 b.s.d.nimbus [ERROR] Error on initialization of server service-handler\njava.lang.RuntimeException: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss\n        at backtype.storm.util$wrap_in_runtime.invoke(util.clj:28) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.zookeeper$exists_node_QMARK_$fn__991.invoke(zookeeper.clj:82) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.zookeeper$exists_node_QMARK_.invoke(zookeeper.clj:78) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.zookeeper$mkdirs.invoke(zookeeper.clj:92) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.cluster$mk_distributed_cluster_state.invoke(cluster.clj:26) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.cluster$mk_storm_cluster_state.invoke(cluster.clj:201) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.daemon.nimbus$nimbus_data.invoke(nimbus.clj:51) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.daemon.nimbus$fn__5528$exec_fn__1229__auto____5529.invoke(nimbus.clj:884) ~[storm-core-0.9.0.1.jar:na]\n        at clojure.lang.AFn.applyToHelper(AFn.java:163) ~[clojure-1.4.0.jar:na]\n        at clojure.lang.AFn.applyTo(AFn.java:151) ~[clojure-1.4.0.jar:na]\n        at clojure.core$apply.invoke(core.clj:601) ~[clojure-1.4.0.jar:na]\n        at backtype.storm.daemon.nimbus$fn__5528$service_handler__5616.doInvoke(nimbus.clj:881) ~[storm-core-0.9.0.1.jar:na]\n        at clojure.lang.RestFn.invoke(RestFn.java:421) ~[clojure-1.4.0.jar:na]\n        at backtype.storm.daemon.nimbus$launch_server_BANG_.invoke(nimbus.clj:1136) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.daemon.nimbus$_launch.invoke(nimbus.clj:1167) ~[storm-core-0.9.0.1.jar:na]\n        at backtype.storm.daemon.nimbus$_main.invoke(nimbus.clj:1189) ~[storm-core-0.9.0.1.jar:na]\n        at clojure.lang.AFn.applyToHelper(AFn.java:159) ~[clojure-1.4.0.jar:na]\n        at clojure.lang.AFn.applyTo(AFn.java:151) ~[clojure-1.4.0.jar:na]\n        at backtype.storm.daemon.nimbus.main(Unknown Source) ~[storm-core-0.9.0.1.jar:na]\nCaused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss\n        at com.netflix.curator.ConnectionState.getZooKeeper(ConnectionState.java:72) ~[curator-client-1.0.1.jar:na]\n        at com.netflix.curator.CuratorZookeeperClient.getZooKeeper(CuratorZookeeperClient.java:74) ~[curator-client-1.0.1.jar:na]\n        at com.netflix.curator.framework.imps.CuratorFrameworkImpl.getZooKeeper(CuratorFrameworkImpl.java:353) ~[curator-framework-1.0.1.jar:na]\n        at com.netflix.curator.framework.imps.ExistsBuilderImpl$2.call(ExistsBuilderImpl.java:149) ~[curator-framework-1.0.1.jar:na]\n        at com.netflix.curator.framework.imps.ExistsBuilderImpl$2.call(ExistsBuilderImpl.java:138) ~[curator-framework-1.0.1.jar:na]\n        at com.netflix.curator.RetryLoop.callWithRetry(RetryLoop.java:85) ~[curator-client-1.0.1.jar:na]\n        at com.netflix.curator.framework.imps.ExistsBuilderImpl.pathInForeground(ExistsBuilderImpl.java:134) ~[curator-framework-1.0.1.jar:na]\n        at com.netflix.curator.framework.imps.ExistsBuilderImpl.forPath(ExistsBuilderImpl.java:125) ~[curator-framework-1.0.1.jar:na]\n        at com.netflix.curator.framework.imps.ExistsBuilderImpl.forPath(ExistsBuilderImpl.java:34) ~[curator-framework-1.0.1.jar:na]\n        at backtype.storm.zookeeper$exists_node_QMARK_$fn__991.invoke(zookeeper.clj:81) ~[storm-core-0.9.0.1.jar:na]\n        ... 17 common frames omitted\n2013-12-20 14:08:08 b.s.util [INFO] Halting process: (\"Error on initialization\")","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"365439","customfield_12312823":null,"summary":"Nimbus fails to start In case of non-worked zookeeper server specifed in config","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yerenkow","name":"yerenkow","key":"yerenkow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Yerenkow","active":true,"timeZone":"Europe/Helsinki"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yerenkow","name":"yerenkow","key":"yerenkow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Yerenkow","active":true,"timeZone":"Europe/Helsinki"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Storm 0.9.0.1","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12685800/comment/13854287","id":"13854287","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"How many zookeeper nodes did you have down out of how many total? Looking at the stack trace it is caused by curator saying it took too long for zookeeper to connect to the ensemble and it timed out.  In this case it is waiting for Zookeeper to call back into the watcher to say that it has syncConnected.  So this may be an issue with zookeeper, or curator has missed some other connection mode, or it could be that you actually don't have a full quorum and zk is doing the correct thing and not connecting.  Say you have 2 zk nodes and one of them is down.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2013-12-20T17:44:47.726+0000","updated":"2013-12-20T17:44:47.726+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12685800/comment/13854396","id":"13854396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yerenkow","name":"yerenkow","key":"yerenkow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Yerenkow","active":true,"timeZone":"Europe/Helsinki"},"body":"In this log I have 3 zk servers in config and one available.\n\nMaybe if it's feature - make logs look a bit clearer on what happened?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yerenkow","name":"yerenkow","key":"yerenkow","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Yerenkow","active":true,"timeZone":"Europe/Helsinki"},"created":"2013-12-20T18:35:18.902+0000","updated":"2013-12-20T18:35:18.902+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12685800/comment/13855694","id":"13855694","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"For a ZK quorum to be met you need to have more then 50% of the servers up and available.  This is a ZK feature.  If you want to file a JIRA under ZOOKEEPER or CURATOR that would be the correct place for this error message to come out.  From the storm perspective we have little knowledge as to why curator threw the exception.  I suppose we could try to do some detective work after we get the exception, but curator seems like a better place to do that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2013-12-23T15:49:36.681+0000","updated":"2013-12-23T15:49:36.681+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12685800/comment/13855696","id":"13855696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"I don't have permission to close this, if one of the committers could close this issue or if you prefer we could try to forward it to CURATOR instead.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2013-12-23T15:51:46.724+0000","updated":"2013-12-23T15:51:46.724+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-180/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1qxqf:"}}