{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13116421","self":"https://issues.apache.org/jira/rest/api/2/issue/13116421","key":"STORM-2803","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":4200,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"aggregatetimespent":4200,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2017-11-06T22:00:37.215+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Nov 08 20:41:46 UTC 2017","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_22454751_*|*_3_*:*_1_*:*_169785976_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2017-11-08T20:41:46.249+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2803/watchers","watchCount":2,"isWatching":false},"created":"2017-11-06T15:17:45.589+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["pull-request-available"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-11-08T20:41:46.307+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I have seen SlotTest fail way too frequently on travis, but it never fails off of travis.\r\n\r\nMy guess is that there is some kind of a race condition happening and on slower hardware (aka VMs or Containers on overloaded build machines) that the tests tend to fail.\r\n\r\nI'll try to find some time to look at this, but if someone else wants to steal it from me feel free to.  I don't know exactly when I will find time to do it.","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"1h 10m","remainingEstimateSeconds":0,"timeSpentSeconds":4200},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"SlotTest failing on travis frequently","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":4200,"total":4200,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":4200,"total":4200,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/comment/16240980","id":"16240980","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"body":"This is due to leaking threads from Nimbus/TimeCacheMap. I'll put up a PR tomorrow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Srdo","name":"Srdo","key":"srdo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stig Rohde Døssing","active":true,"timeZone":"Europe/Copenhagen"},"created":"2017-11-06T22:00:37.215+0000","updated":"2017-11-06T22:00:37.215+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/comment/16244694","id":"16244694","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"Thanks [~Srdo],\r\n\r\nI merged this into master","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2017-11-08T20:41:46.303+0000","updated":"2017-11-08T20:41:46.303+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2803/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":8,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56473","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user srdo opened a pull request:\n\n    https://github.com/apache/storm/pull/2403\n\n    STORM-2803: Fix leaking threads from Nimbus/TimeCacheMap, slightly refactor Time to use more final fields, replaced uses of deprecated classes/methods and added a few tests.\n\n    I'll squash once review is done. Ran this a few times on Travis, and it looks like SlotTest is stable now. The integration test is still failing occasionally. \r\n    \r\n    Changes: \r\n    * TimeCacheMap threads were leaking from Nimbus, which caused time simulation to be unreliable in later tests, because the leaked threads call Time.sleep. Made sure to kill the threads.\r\n    * Replaced TimeCacheMap with RotatingMap in ShellBasedGroupsMapping, since that class has the same problem as Nimbus but also can't be cleaned up. Also added some tests for this class.\r\n    * As part of adding tests for ShellBasedGroupsMapping, moved some static functions from ShellUtils to an interface so they can be stubbed in tests.\r\n    * Removed uses of deprecated Time.startSimulating/stopSimulating in storm-server.\r\n    * Removed duplicate sudo in travis.yml\r\n    * Slightly refactored Time so all fields are final, and field resetting happens in the constructor. It seems easier to me to reason about thread safety this way.\r\n    * Add check to SlotTest.testResourcesChanged to ensure that the worker heartbeat hasn't expired in the step from WAITING_FOR_WORKER_START to RUNNING. It's a little weird that the test is reusing the original worker heartbeat in that step, so maybe changing the test to create a second heartbeat would be better. Let me know what you think.\r\n    * Removed non-functional (as far as I could tell) Windows groups command from ShellUtils and replaced it with an exception. Running \"groups\" on Windows doesn't do anything to my knowledge.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/srdo/storm STORM-2803\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/2403.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #2403\n    \n----\ncommit 8a755d03fa4804a901fa621fc4cf9ad230a01177\nAuthor: Stig Rohde Døssing <srdo@apache.org>\nDate:   2017-11-06T17:01:52Z\n\n    STORM:2803: Fix leaking threads from Nimbus/TimeCacheMap, slightly refactor Time to use more final fields, replaced uses of deprecated classes/methods and added a few tests.\n\ncommit 176c7324ebba8fc0064d83bd8f8e7c5c14b27902\nAuthor: Stig Rohde Døssing <srdo@apache.org>\nDate:   2017-11-07T17:45:45Z\n\n    STORM-2803: Add tests for ShellBasedGroupsMapping\n\n----\n","created":"2017-11-07T18:38:48.679+0000","updated":"2017-11-07T18:38:48.679+0000","started":"2017-11-07T18:38:48.675+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56473","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2403#discussion_r149480275\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/ShellUtils.java ---\n    @@ -432,47 +437,47 @@ private void setTimedOut() {\n         }\n     \n     \n    -    /**\n    -     * Static method to execute a shell command.\n    -     * Covers most of the simple cases without requiring the user to implement\n    -     * the <code>Shell</code> interface.\n    -     * @param cmd shell command to execute.\n    -     * @return the output of the executed command.\n    -     */\n    -    public static String execCommand(String ... cmd) throws IOException {\n    -        return execCommand(null, cmd, 0L);\n    -    }\n    -\n    -    /**\n    -     * Static method to execute a shell command.\n    -     * Covers most of the simple cases without requiring the user to implement\n    -     * the <code>Shell</code> interface.\n    -     * @param env the map of environment key=value\n    -     * @param cmd shell command to execute.\n    -     * @param timeout time in milliseconds after which script should be marked timeout\n    -     * @return the output of the executed command.o\n    -     */\n    -\n    -    public static String execCommand(Map<String, String> env, String[] cmd,\n    -                                     long timeout) throws IOException {\n    -        ShellCommandExecutor exec = new ShellCommandExecutor(cmd, null, env,\n    -                                                             timeout);\n    -        exec.execute();\n    -        return exec.getOutput();\n    -    }\n    -\n    -    /**\n    -     * Static method to execute a shell command.\n    -     * Covers most of the simple cases without requiring the user to implement\n    -     * the <code>Shell</code> interface.\n    -     * @param env the map of environment key=value\n    -     * @param cmd shell command to execute.\n    -     * @return the output of the executed command.\n    -     */\n    -    public static String execCommand(Map<String,String> env, String ... cmd)\n    -        throws IOException {\n    -        return execCommand(env, cmd, 0L);\n    -    }\n    +//    /**\n    +//     * Static method to execute a shell command.\n    +//     * Covers most of the simple cases without requiring the user to implement\n    +//     * the <code>Shell</code> interface.\n    +//     * @param cmd shell command to execute.\n    +//     * @return the output of the executed command.\n    +//     */\n    +//    public static String execCommand(String ... cmd) throws IOException {\n    +//        return execCommand(null, cmd, 0L);\n    +//    }\n    +//\n    +//    /**\n    +//     * Static method to execute a shell command.\n    +//     * Covers most of the simple cases without requiring the user to implement\n    +//     * the <code>Shell</code> interface.\n    +//     * @param env the map of environment key=value\n    +//     * @param cmd shell command to execute.\n    +//     * @param timeout time in milliseconds after which script should be marked timeout\n    +//     * @return the output of the executed command.o\n    +//     */\n    +//\n    +//    public static String execCommand(Map<String, String> env, String[] cmd,\n    +//                                     long timeout) throws IOException {\n    +//        ShellCommandExecutor exec = new ShellCommandExecutor(cmd, null, env,\n    +//                                                             timeout);\n    +//        exec.execute();\n    +//        return exec.getOutput();\n    +//    }\n    +//\n    +//    /**\n    +//     * Static method to execute a shell command.\n    +//     * Covers most of the simple cases without requiring the user to implement\n    +//     * the <code>Shell</code> interface.\n    +//     * @param env the map of environment key=value\n    +//     * @param cmd shell command to execute.\n    +//     * @return the output of the executed command.\n    +//     */\n    +//    public static String execCommand(Map<String,String> env, String ... cmd)\n    +//        throws IOException {\n    +//        return execCommand(env, cmd, 0L);\n    +//    }\n    --- End diff --\n    \n    Should we remove this?\n","created":"2017-11-07T19:40:42.064+0000","updated":"2017-11-07T19:40:42.064+0000","started":"2017-11-07T19:40:42.062+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56478","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2403#discussion_r149481205\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/ShellUtils.java ---\n    @@ -135,8 +135,10 @@ protected void setWorkingDirectory(File dir) {\n     \n         /** a Unix command to get the current user's groups list */\n         public static String[] getGroupsCommand() {\n    -        return (WINDOWS)? new String[]{\"cmd\", \"/c\", \"groups\"}\n    -        : new String[]{\"bash\", \"-c\", \"groups\"};\n    --- End diff --\n    \n    Is this a regression or did it really not work?\n","created":"2017-11-07T19:40:42.067+0000","updated":"2017-11-07T19:40:42.067+0000","started":"2017-11-07T19:40:42.066+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56479","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2403#discussion_r149480035\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/ShellCommandRunner.java ---\n    @@ -0,0 +1,63 @@\n    +/*\n    + * Copyright 2017 The Apache Software Foundation.\n    + *\n    + * Licensed under the Apache License, Version 2.0 (the \"License\");\n    + * you may not use this file except in compliance with the License.\n    + * You may obtain a copy of the License at\n    + *\n    + *      http://www.apache.org/licenses/LICENSE-2.0\n    + *\n    + * Unless required by applicable law or agreed to in writing, software\n    + * distributed under the License is distributed on an \"AS IS\" BASIS,\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    + * See the License for the specific language governing permissions and\n    + * limitations under the License.\n    + */\n    +\n    +package org.apache.storm.utils;\n    +\n    +import java.io.IOException;\n    +import java.util.Map;\n    +\n    +/**\n    + * Contains convenience functions for running shell commands for cases that are too simple to need a full {@link ShellUtils} implementation.\n    + */\n    +public interface ShellCommandRunner {\n    +    \n    +    /**\n    +     * Method to execute a shell command.\n    +     * Covers most of the simple cases without requiring the user to implement\n    +     * the {@link ShellUtils} interface.\n    +     * @param cmd shell command to execute.\n    +     * @return the output of the executed command.\n    +     */\n    +    String execCommand(String ... cmd) throws IOException;\n    +\n    +    /**\n    +     * Method to execute a shell command.\n    +     * Covers most of the simple cases without requiring the user to implement\n    +     * the {@link ShellUtils} interface.\n    +     * @param env the map of environment key=value\n    +     * @param cmd shell command to execute.\n    +     * @param timeout time in milliseconds after which script should be marked timeout\n    +     * @return the output of the executed command.o\n    --- End diff --\n    \n    nit: looks like there is an extra 'o' at the end.\n","created":"2017-11-07T19:40:42.147+0000","updated":"2017-11-07T19:40:42.147+0000","started":"2017-11-07T19:40:42.146+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56480","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2403#discussion_r149482455\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/ShellUtils.java ---\n    @@ -432,47 +437,47 @@ private void setTimedOut() {\n         }\n     \n     \n    -    /**\n    -     * Static method to execute a shell command.\n    -     * Covers most of the simple cases without requiring the user to implement\n    -     * the <code>Shell</code> interface.\n    -     * @param cmd shell command to execute.\n    -     * @return the output of the executed command.\n    -     */\n    -    public static String execCommand(String ... cmd) throws IOException {\n    -        return execCommand(null, cmd, 0L);\n    -    }\n    -\n    -    /**\n    -     * Static method to execute a shell command.\n    -     * Covers most of the simple cases without requiring the user to implement\n    -     * the <code>Shell</code> interface.\n    -     * @param env the map of environment key=value\n    -     * @param cmd shell command to execute.\n    -     * @param timeout time in milliseconds after which script should be marked timeout\n    -     * @return the output of the executed command.o\n    -     */\n    -\n    -    public static String execCommand(Map<String, String> env, String[] cmd,\n    -                                     long timeout) throws IOException {\n    -        ShellCommandExecutor exec = new ShellCommandExecutor(cmd, null, env,\n    -                                                             timeout);\n    -        exec.execute();\n    -        return exec.getOutput();\n    -    }\n    -\n    -    /**\n    -     * Static method to execute a shell command.\n    -     * Covers most of the simple cases without requiring the user to implement\n    -     * the <code>Shell</code> interface.\n    -     * @param env the map of environment key=value\n    -     * @param cmd shell command to execute.\n    -     * @return the output of the executed command.\n    -     */\n    -    public static String execCommand(Map<String,String> env, String ... cmd)\n    -        throws IOException {\n    -        return execCommand(env, cmd, 0L);\n    -    }\n    +//    /**\n    +//     * Static method to execute a shell command.\n    +//     * Covers most of the simple cases without requiring the user to implement\n    +//     * the <code>Shell</code> interface.\n    +//     * @param cmd shell command to execute.\n    +//     * @return the output of the executed command.\n    +//     */\n    +//    public static String execCommand(String ... cmd) throws IOException {\n    +//        return execCommand(null, cmd, 0L);\n    +//    }\n    +//\n    +//    /**\n    +//     * Static method to execute a shell command.\n    +//     * Covers most of the simple cases without requiring the user to implement\n    +//     * the <code>Shell</code> interface.\n    +//     * @param env the map of environment key=value\n    +//     * @param cmd shell command to execute.\n    +//     * @param timeout time in milliseconds after which script should be marked timeout\n    +//     * @return the output of the executed command.o\n    +//     */\n    +//\n    +//    public static String execCommand(Map<String, String> env, String[] cmd,\n    +//                                     long timeout) throws IOException {\n    +//        ShellCommandExecutor exec = new ShellCommandExecutor(cmd, null, env,\n    +//                                                             timeout);\n    +//        exec.execute();\n    +//        return exec.getOutput();\n    +//    }\n    +//\n    +//    /**\n    +//     * Static method to execute a shell command.\n    +//     * Covers most of the simple cases without requiring the user to implement\n    +//     * the <code>Shell</code> interface.\n    +//     * @param env the map of environment key=value\n    +//     * @param cmd shell command to execute.\n    +//     * @return the output of the executed command.\n    +//     */\n    +//    public static String execCommand(Map<String,String> env, String ... cmd)\n    +//        throws IOException {\n    +//        return execCommand(env, cmd, 0L);\n    +//    }\n    --- End diff --\n    \n    Oops, yes. \n","created":"2017-11-07T19:43:39.996+0000","updated":"2017-11-07T19:43:39.996+0000","started":"2017-11-07T19:43:39.995+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56481","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56482","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2403#discussion_r149483098\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/ShellUtils.java ---\n    @@ -135,8 +135,10 @@ protected void setWorkingDirectory(File dir) {\n     \n         /** a Unix command to get the current user's groups list */\n         public static String[] getGroupsCommand() {\n    -        return (WINDOWS)? new String[]{\"cmd\", \"/c\", \"groups\"}\n    -        : new String[]{\"bash\", \"-c\", \"groups\"};\n    --- End diff --\n    \n    Running \"cmd /c groups\" or just \"groups\" on my Windows 10 install just gives me a command not found error. I googled it a bit too, and didn't turn up any references to a \"groups\" command on Windows. I don't see any references to this method in the codebase either.\n","created":"2017-11-07T19:45:51.078+0000","updated":"2017-11-07T19:45:51.078+0000","started":"2017-11-07T19:45:51.076+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56482","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56483","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2403#discussion_r149483149\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/ShellCommandRunner.java ---\n    @@ -0,0 +1,63 @@\n    +/*\n    + * Copyright 2017 The Apache Software Foundation.\n    + *\n    + * Licensed under the Apache License, Version 2.0 (the \"License\");\n    + * you may not use this file except in compliance with the License.\n    + * You may obtain a copy of the License at\n    + *\n    + *      http://www.apache.org/licenses/LICENSE-2.0\n    + *\n    + * Unless required by applicable law or agreed to in writing, software\n    + * distributed under the License is distributed on an \"AS IS\" BASIS,\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    + * See the License for the specific language governing permissions and\n    + * limitations under the License.\n    + */\n    +\n    +package org.apache.storm.utils;\n    +\n    +import java.io.IOException;\n    +import java.util.Map;\n    +\n    +/**\n    + * Contains convenience functions for running shell commands for cases that are too simple to need a full {@link ShellUtils} implementation.\n    + */\n    +public interface ShellCommandRunner {\n    +    \n    +    /**\n    +     * Method to execute a shell command.\n    +     * Covers most of the simple cases without requiring the user to implement\n    +     * the {@link ShellUtils} interface.\n    +     * @param cmd shell command to execute.\n    +     * @return the output of the executed command.\n    +     */\n    +    String execCommand(String ... cmd) throws IOException;\n    +\n    +    /**\n    +     * Method to execute a shell command.\n    +     * Covers most of the simple cases without requiring the user to implement\n    +     * the {@link ShellUtils} interface.\n    +     * @param env the map of environment key=value\n    +     * @param cmd shell command to execute.\n    +     * @param timeout time in milliseconds after which script should be marked timeout\n    +     * @return the output of the executed command.o\n    --- End diff --\n    \n    Thanks, will remove\n","created":"2017-11-07T19:46:00.814+0000","updated":"2017-11-07T19:46:00.814+0000","started":"2017-11-07T19:46:00.813+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56483","issueId":"13116421"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13116421/worklog/56597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/2403\n","created":"2017-11-08T20:41:29.962+0000","updated":"2017-11-08T20:41:29.962+0000","started":"2017-11-08T20:41:29.961+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"56597","issueId":"13116421"}]},"customfield_12311820":"0|i3mg53:"}}