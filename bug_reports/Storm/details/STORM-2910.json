{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13133432","self":"https://issues.apache.org/jira/rest/api/2/issue/13133432","key":"STORM-2910","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":4200,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"aggregatetimespent":4200,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 01 20:55:15 UTC 2018","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_704750278_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2018-02-01T20:55:15.240+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2910/watchers","watchCount":2,"isWatching":false},"created":"2018-01-24T17:09:24.987+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["pull-request-available"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":"STORM-2714","customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-02-01T20:55:15.260+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The test for me went form 17 mins to run everything up to 30 mins to run everything.\r\n\r\nI did some debugging and found that the slot is not very responsive if it cannot connect to nimbus (to send metrics back).  In those cases the connection has to time out before the slot can respond.\r\n\r\nI think we want to do 2 things here.  First we don't want slot blocking for long periods of time if it cannot talk to nimbus, so I am going to background the sync, with a queue that will throw out old metrics if the new ones want to be sent.\r\n\r\nNext I am going to figure out why the local override is not happening in the nimbus client in this situation.","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"1h 10m","remainingEstimateSeconds":0,"timeSpentSeconds":4200},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Tests taking a long time to run","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":4200,"total":4200,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":4200,"total":4200,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/comment/16349261","id":"16349261","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"I merged this into master","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2018-02-01T20:55:15.255+0000","updated":"2018-02-01T20:55:15.255+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2910/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":7,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/67989","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user revans2 opened a pull request:\n\n    https://github.com/apache/storm/pull/2534\n\n    STORM-2910: Fix metrics reporting from supervisor\n\n    \n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/revans2/incubator-storm STORM-2910\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/2534.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #2534\n    \n----\ncommit ed0548e8b61a8ea67007d906953406a264b15c99\nAuthor: Robert (Bobby) Evans <evans@...>\nDate:   2018-01-24T20:47:01Z\n\n    STORM-2910:  Override local nimbus client by default\n\ncommit 48c2fda867aa1d1123f6ba9c9f623ae80c9df280\nAuthor: Robert (Bobby) Evans <evans@...>\nDate:   2018-01-25T15:49:20Z\n\n    STORM-2910: have metrics reported in the background\n\n----\n","created":"2018-01-25T17:15:52.150+0000","updated":"2018-01-25T17:15:52.150+0000","started":"2018-01-25T17:15:52.149+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"67989","issueId":"13133432"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/67990","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/2534\n  \n    Either one of the 2 commits fixes the problem with the tests taking too long.  This first one makes it so metrics are actually reported back in local mode, which will help with tests in the future.\r\n    \r\n    The second commit decouples the metrics reporting from the slot state machine path, so it will not block when trying to communicate with nimbus, for example if nimbus is down.\n","created":"2018-01-25T17:17:44.903+0000","updated":"2018-01-25T17:17:44.903+0000","started":"2018-01-25T17:17:44.902+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"67990","issueId":"13133432"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/68014","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user agresch commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2534#discussion_r163953643\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/supervisor/OnlyLatestExecutor.java ---\n    @@ -0,0 +1,55 @@\n    +/*\n    + * Licensed to the Apache Software Foundation (ASF) under one\n    + * or more contributor license agreements.  See the NOTICE file\n    + * distributed with this work for additional information\n    + * regarding copyright ownership.  The ASF licenses this file\n    + * to you under the Apache License, Version 2.0 (the\n    + * \"License\"); you may not use this file except in compliance\n    + * with the License.  You may obtain a copy of the License at\n    + *\n    + * http://www.apache.org/licenses/LICENSE-2.0\n    + *\n    + * Unless required by applicable law or agreed to in writing, software\n    + * distributed under the License is distributed on an \"AS IS\" BASIS,\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    + * See the License for the specific language governing permissions and\n    + * limitations under the License.\n    + */\n    +\n    +package org.apache.storm.daemon.supervisor;\n    +\n    +import java.util.concurrent.ConcurrentHashMap;\n    +import java.util.concurrent.ConcurrentMap;\n    +import java.util.concurrent.Executor;\n    +\n    +/**\n    + * This allows you to submit a Runnable with a key.  If the previous submission for that key has not yet run,\n    + * it will be replaced with the latest one.\n    + */\n    +public class OnlyLatestExecutor<K> {\n    +    private final Executor exec;\n    +    private final ConcurrentMap<K, Runnable> latest;\n    +\n    +    public OnlyLatestExecutor(Executor exec) {\n    +        this.exec = exec;\n    +        latest = new ConcurrentHashMap<>();\n    +    }\n    +\n    +    /**\n    +     * Run something in the future, but replace it with the latest if it is taking too long\n    +     * @param key what to use to dedupe things.\n    +     * @param r what you want to run.\n    +     */\n    +    public void execute(final K key, Runnable r) {\n    +        Runnable old = latest.put(key, r);\n    +        if (old == null) {\n    --- End diff --\n    \n    do we care about knowing that something is dropped? Seems like we would be ignorant of any issue that requires tuning.\r\n    \r\n\n","created":"2018-01-25T20:09:16.415+0000","updated":"2018-01-25T20:09:16.415+0000","started":"2018-01-25T20:09:16.414+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"68014","issueId":"13133432"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/68370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2534#discussion_r164281767\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/supervisor/OnlyLatestExecutor.java ---\n    @@ -0,0 +1,55 @@\n    +/*\n    + * Licensed to the Apache Software Foundation (ASF) under one\n    + * or more contributor license agreements.  See the NOTICE file\n    + * distributed with this work for additional information\n    + * regarding copyright ownership.  The ASF licenses this file\n    + * to you under the Apache License, Version 2.0 (the\n    + * \"License\"); you may not use this file except in compliance\n    + * with the License.  You may obtain a copy of the License at\n    + *\n    + * http://www.apache.org/licenses/LICENSE-2.0\n    + *\n    + * Unless required by applicable law or agreed to in writing, software\n    + * distributed under the License is distributed on an \"AS IS\" BASIS,\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    + * See the License for the specific language governing permissions and\n    + * limitations under the License.\n    + */\n    +\n    +package org.apache.storm.daemon.supervisor;\n    +\n    +import java.util.concurrent.ConcurrentHashMap;\n    +import java.util.concurrent.ConcurrentMap;\n    +import java.util.concurrent.Executor;\n    +\n    +/**\n    + * This allows you to submit a Runnable with a key.  If the previous submission for that key has not yet run,\n    + * it will be replaced with the latest one.\n    + */\n    +public class OnlyLatestExecutor<K> {\n    +    private final Executor exec;\n    +    private final ConcurrentMap<K, Runnable> latest;\n    +\n    +    public OnlyLatestExecutor(Executor exec) {\n    +        this.exec = exec;\n    +        latest = new ConcurrentHashMap<>();\n    +    }\n    +\n    +    /**\n    +     * Run something in the future, but replace it with the latest if it is taking too long\n    +     * @param key what to use to dedupe things.\n    +     * @param r what you want to run.\n    +     */\n    +    public void execute(final K key, Runnable r) {\n    +        Runnable old = latest.put(key, r);\n    +        if (old == null) {\n    --- End diff --\n    \n    Yes if we are concerned about that we may want to have WARN log, and even if not, DEBUG log might be better.\n","created":"2018-01-27T21:20:04.025+0000","updated":"2018-01-27T21:20:04.025+0000","started":"2018-01-27T21:20:04.025+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"68370","issueId":"13133432"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/68372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user HeartSaVioR commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2534#discussion_r164282275\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/supervisor/OnlyLatestExecutor.java ---\n    @@ -0,0 +1,55 @@\n    +/*\n    + * Licensed to the Apache Software Foundation (ASF) under one\n    + * or more contributor license agreements.  See the NOTICE file\n    + * distributed with this work for additional information\n    + * regarding copyright ownership.  The ASF licenses this file\n    + * to you under the Apache License, Version 2.0 (the\n    + * \"License\"); you may not use this file except in compliance\n    + * with the License.  You may obtain a copy of the License at\n    + *\n    + * http://www.apache.org/licenses/LICENSE-2.0\n    + *\n    + * Unless required by applicable law or agreed to in writing, software\n    + * distributed under the License is distributed on an \"AS IS\" BASIS,\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    + * See the License for the specific language governing permissions and\n    + * limitations under the License.\n    + */\n    +\n    +package org.apache.storm.daemon.supervisor;\n    +\n    +import java.util.concurrent.ConcurrentHashMap;\n    +import java.util.concurrent.ConcurrentMap;\n    +import java.util.concurrent.Executor;\n    +\n    +/**\n    + * This allows you to submit a Runnable with a key.  If the previous submission for that key has not yet run,\n    + * it will be replaced with the latest one.\n    + */\n    +public class OnlyLatestExecutor<K> {\n    +    private final Executor exec;\n    +    private final ConcurrentMap<K, Runnable> latest;\n    +\n    +    public OnlyLatestExecutor(Executor exec) {\n    +        this.exec = exec;\n    +        latest = new ConcurrentHashMap<>();\n    +    }\n    +\n    +    /**\n    +     * Run something in the future, but replace it with the latest if it is taking too long\n    +     * @param key what to use to dedupe things.\n    +     * @param r what you want to run.\n    +     */\n    +    public void execute(final K key, Runnable r) {\n    +        Runnable old = latest.put(key, r);\n    +        if (old == null) {\n    +            //It was not there before so we need to run it.\n    +            exec.execute(() -> {\n    +                Runnable run = latest.remove(key);\n    +                if (run != null) {\n    +                    run.run();;\n    --- End diff --\n    \n    nit: double ;\n","created":"2018-01-27T21:45:52.501+0000","updated":"2018-01-27T21:45:52.501+0000","started":"2018-01-27T21:45:52.500+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"68372","issueId":"13133432"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/69433","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/2534\n  \n    @kishorvpatil @HeartSaVioR @agresch \r\n    \r\n    I have addressed all of your review comments.  Please take another look, and if it is good I'll squash the commits and merge it in.\n","created":"2018-01-31T16:18:58.190+0000","updated":"2018-01-31T16:18:58.190+0000","started":"2018-01-31T16:18:58.189+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"69433","issueId":"13133432"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13133432/worklog/69980","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/2534\n","created":"2018-02-01T20:54:12.350+0000","updated":"2018-02-01T20:54:12.350+0000","started":"2018-02-01T20:54:12.350+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"69980","issueId":"13133432"}]},"customfield_12311820":"0|i3pbaf:"}}