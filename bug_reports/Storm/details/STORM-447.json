{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12732894","self":"https://issues.apache.org/jira/rest/api/2/issue/12732894","key":"STORM-447","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327112","id":"12327112","name":"0.9.3","archived":false,"released":true,"releaseDate":"2014-11-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-08-08T18:46:15.541+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Sep 04 14:46:57 UTC 2014","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1803963381_*|*_5_*:*_1_*:*_0","customfield_12310420":"410922","customfield_12312321":null,"resolutiondate":"2014-08-29T15:39:12.476+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-447/watchers","watchCount":3,"isWatching":false},"created":"2014-08-08T18:33:09.125+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-10-09T00:42:11.455+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12327950","id":"12327950","name":"storm-core","description":"Core storm daemons and APIs including trident"}],"timeoriginalestimate":null,"description":"A number of Storm's dependencies regularly conflict with user dependencies:\n\n* Netty (tends to conflict with Cassandra and others)\n* Guava\n* httpclient\n\nShading these into storm-core.jar and doing package relocation will eliminate dependency conflicts when user code (topologies) depends on conflicting versions.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"410915","customfield_12312823":null,"summary":"shade/relocate packages of dependencies that are common causes of dependency conflicts","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ptgoetz","name":"ptgoetz","key":"ptgoetz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"P. Taylor Goetz","active":true,"timeZone":"America/Havana"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14091137","id":"14091137","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user ptgoetz opened a pull request:\n\n    https://github.com/apache/incubator-storm/pull/219\n\n    [STORM-447] shade/relocate packages of dependencies that are common causes of dependency conflicts\n\n    This shades and does package relocation of several of Storm's dependencies that frequently conflict with user code (Netty, Guava, etc.).\n    \n    This also fixes: STORM-356, STORM-268\n    \n    Note that due to transitive dependencies, some additional dependencies had to be shaded as well (Curator and ZooKeeper).\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/ptgoetz/incubator-storm shading\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/incubator-storm/pull/219.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #219\n    \n----\ncommit 1800380c2b70bc0697f43db75777b97bf2acb0e5\nAuthor: P. Taylor Goetz <ptgoetz@gmail.com>\nDate:   2014-08-08T03:55:48Z\n\n    shade common sources of dependency conflicts\n\ncommit de0aa5af21e4ef424e0e9074223ab8a19e832115\nAuthor: P. Taylor Goetz <ptgoetz@gmail.com>\nDate:   2014-08-08T17:56:29Z\n\n    add exclusion for LICENCE.txt in zk jar\n\ncommit f51bbad17079ca1251992e3a30834c12fdedbf29\nAuthor: P. Taylor Goetz <ptgoetz@gmail.com>\nDate:   2014-08-08T18:35:33Z\n\n    add exclusion for duplicate servlet jar (STORM-356)\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-08T18:46:15.541+0000","updated":"2014-08-08T18:46:15.541+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14111180","id":"14111180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53475215\n  \n    Bump... any other committers have an opinion on this?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-26T19:27:54.460+0000","updated":"2014-08-26T19:27:54.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14111181","id":"14111181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53475612\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-26T19:31:06.366+0000","updated":"2014-08-26T19:31:06.366+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14111222","id":"14111222","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user nathanmarz commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53479618\n  \n    I'm for doing this as much as possible. You're confident these libraries don't use any reflection?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-26T19:58:25.900+0000","updated":"2014-08-26T19:58:25.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14111301","id":"14111301","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53488049\n  \n    @nathanmarz I've tested storm (distributed) with this patch and not seen any issues.\n    \n    I know guava, netty, and httpclient are clean. I'll do an audit of zookeeper and curator to make sure.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-26T20:43:27.079+0000","updated":"2014-08-26T20:43:27.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14111341","id":"14111341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53492508\n  \n    I just checked zookeeper and curator and they look okay. There is some reflection in both (mostly in test code), but none of it involves classes from packages that are relocated in this pull request.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-26T21:08:03.181+0000","updated":"2014-08-26T21:08:03.181+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14111347","id":"14111347","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user nathanmarz commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53492850\n  \n    Thanks for the clarification. I'm +1.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-26T21:10:04.843+0000","updated":"2014-08-26T21:10:04.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14113780","id":"14113780","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53724238\n  \n    +1\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-28T14:06:22.316+0000","updated":"2014-08-28T14:06:22.316+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14113824","id":"14113824","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on a diff in the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#discussion_r16844933\n  \n    --- Diff: storm-core/pom.xml ---\n    @@ -288,6 +298,26 @@\n                                 <pattern>org.apache.thrift</pattern>\n                                 <shadedPattern>org.apache.thrift7</shadedPattern>\n                             </relocation>\n    +                        <relocation>\n    +                            <pattern>org.jboss.netty</pattern>\n    +                            <shadedPattern>org.apache.storm.netty</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>com.google.common</pattern>\n    +                            <shadedPattern>org.apache.storm.guava</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.http</pattern>\n    +                            <shadedPattern>org.apache.storm.http</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.zookeeper</pattern>\n    +                            <shadedPattern>org.apache.storm.zookeeper</shadedPattern>\n    --- End diff --\n    \n    @ptgoetz this is causing the storm-dist/binary build not to include zookeeper-*.jar in the libs\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-28T15:03:16.068+0000","updated":"2014-08-28T15:03:16.068+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14113852","id":"14113852","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on a diff in the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#discussion_r16846611\n  \n    --- Diff: storm-core/pom.xml ---\n    @@ -288,6 +298,26 @@\n                                 <pattern>org.apache.thrift</pattern>\n                                 <shadedPattern>org.apache.thrift7</shadedPattern>\n                             </relocation>\n    +                        <relocation>\n    +                            <pattern>org.jboss.netty</pattern>\n    +                            <shadedPattern>org.apache.storm.netty</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>com.google.common</pattern>\n    +                            <shadedPattern>org.apache.storm.guava</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.http</pattern>\n    +                            <shadedPattern>org.apache.storm.http</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.zookeeper</pattern>\n    +                            <shadedPattern>org.apache.storm.zookeeper</shadedPattern>\n    --- End diff --\n    \n    @harshach Correct. The ZooKeeper classes are package-relocated and included in the storm-core.jar.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-28T15:25:27.736+0000","updated":"2014-08-28T15:25:27.736+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14113894","id":"14113894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#discussion_r16849273\n  \n    --- Diff: storm-core/pom.xml ---\n    @@ -288,6 +298,26 @@\n                                 <pattern>org.apache.thrift</pattern>\n                                 <shadedPattern>org.apache.thrift7</shadedPattern>\n                             </relocation>\n    +                        <relocation>\n    +                            <pattern>org.jboss.netty</pattern>\n    +                            <shadedPattern>org.apache.storm.netty</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>com.google.common</pattern>\n    +                            <shadedPattern>org.apache.storm.guava</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.http</pattern>\n    +                            <shadedPattern>org.apache.storm.http</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.zookeeper</pattern>\n    +                            <shadedPattern>org.apache.storm.zookeeper</shadedPattern>\n    --- End diff --\n    \n    I am still +1 on merging this in as is, but like I said on the e-mail list, is there a way we can update the pom.xml before deploying installing it in the maven repo so that our customers don't have to try and do something to force zookeeper to show up.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-28T16:02:10.235+0000","updated":"2014-08-28T16:02:10.235+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14113908","id":"14113908","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on a diff in the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#discussion_r16849948\n  \n    --- Diff: storm-core/pom.xml ---\n    @@ -288,6 +298,26 @@\n                                 <pattern>org.apache.thrift</pattern>\n                                 <shadedPattern>org.apache.thrift7</shadedPattern>\n                             </relocation>\n    +                        <relocation>\n    +                            <pattern>org.jboss.netty</pattern>\n    +                            <shadedPattern>org.apache.storm.netty</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>com.google.common</pattern>\n    +                            <shadedPattern>org.apache.storm.guava</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.http</pattern>\n    +                            <shadedPattern>org.apache.storm.http</shadedPattern>\n    +                        </relocation>\n    +                        <relocation>\n    +                            <pattern>org.apache.zookeeper</pattern>\n    +                            <shadedPattern>org.apache.storm.zookeeper</shadedPattern>\n    --- End diff --\n    \n    @revans2 I'm not sure I understand what you mean by \"force zookeeper to show up.\" Can you explain?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-28T16:10:01.157+0000","updated":"2014-08-28T16:10:01.157+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14113909","id":"14113909","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user harshach commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53746148\n  \n    @ptgoetz @revans2 Sorry!. I ran into ClassNotFoundException: org.apache.zookeeper.data.Stat when I tried to start nimbus and thought the issue might be related to this. But I tested again running storm cluster with above changes and deploying topologies don't see this issue. I am still +1. Thanks.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-28T16:12:30.405+0000","updated":"2014-08-28T16:12:30.405+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14115349","id":"14115349","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/incubator-storm/pull/219\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-29T15:44:52.700+0000","updated":"2014-08-29T15:44:52.700+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14115458","id":"14115458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-53901704\n  \n    OK So when you package a jar for storm we use the assembly plugin to pull in all dependencies that the jar has, except for the dependencies that are marked as provided, aka storm and its transitive dependencies.  When we shade one of our dependencies like guava we are no longer packaging guava with storm, but maven still thinks that we are because our pom.xml still say that we have a dependency on it.  As such anyone who actually wants to use guava might compile just fine, but end up with a class not found error when they try to run, because maven was not smart enough to package guava with their jar, because it still thinks storm is packaging it. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-08-29T16:51:57.789+0000","updated":"2014-08-29T16:51:57.789+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14120479","id":"14120479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user ptgoetz commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-54369457\n  \n    @revans2 I just did a bunch of digging related to how the shade plugin handles dependencies. When a shaded artifact is installed or deployed to a maven repository, it is installed with the `dependency-reduced-pom.xml` instead of the original `pom.xml` it was built with. You have the choice of either removing shaded dependencies from the pom, or have them set to `provided` scope.\n    \n    Currently, our build is configured to set them to `provided` scope, which is actually not what we want, so we need to make the following change to the storm-core pom (which I've already done, just haven't pull requested it yet):\n    \n    ```\n    <keepDependenciesWithProvidedScope>false</keepDependenciesWithProvidedScope>\n    ```\n    \n    When maven builds a jar, it also puts the pom in `META-INF/${groupId}/${artifactId}/pom.xml`. In a shaded jar this will be the original pom, not the dependency reduced one. I'm not aware of any tools that use that pom, most use the pom that's in the maven repository. However, I do have a patched version of the shade plugin that will use the dependency reduced pom instead of the original if we need it.\n    \n    So long story short we should be able to flip that bit and avoid the scenarios you describe.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-03T21:21:51.346+0000","updated":"2014-09-03T21:21:51.346+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12732894/comment/14121426","id":"14121426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user revans2 commented on the pull request:\n\n    https://github.com/apache/incubator-storm/pull/219#issuecomment-54487806\n  \n    @ptgoetz Sounds good. Please through up a pull request.  \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-04T14:46:57.188+0000","updated":"2014-09-04T14:46:57.188+0000"}],"maxResults":17,"total":17,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-447/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1yp4f:"}}