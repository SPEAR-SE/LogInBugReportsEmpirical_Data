{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13141544","self":"https://issues.apache.org/jira/rest/api/2/issue/13141544","key":"STORM-2983","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":1800,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"aggregatetimespent":1800,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2018-03-06T03:55:36.314+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Apr 09 14:33:58 UTC 2018","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2551663256_*|*_3_*:*_1_*:*_553056459_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2018-04-05T13:12:07.415+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2983/watchers","watchCount":4,"isWatching":false},"created":"2018-02-28T14:46:47.744+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":["pull-request-available"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":"STORM-2714","customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[{"id":"12529976","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12529976","type":{"id":"12310560","name":"Problem/Incident","inward":"is caused by","outward":"causes","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310560"},"outwardIssue":{"id":"13140532","key":"STORM-2970","self":"https://issues.apache.org/jira/rest/api/2/issue/13140532","fields":{"summary":"JCQueue can be full and will throw IllegalStateException","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12531348","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12531348","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13151060","key":"STORM-3021","self":"https://issues.apache.org/jira/rest/api/2/issue/13151060","fields":{"summary":"RAS doesn't honor Config.TOPOLOGY_WORKERS","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-04-09T14:33:58.547+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"For example,\r\n{code:java}\r\nbin/storm jar storm-loadgen-*.jar org.apache.storm.loadgen.ThroughputVsLatency --spouts 1 --splitters 2 --counters 1 -c topology.debug=true\r\n{code}\r\non ResourceAwareScheduler not working properly.\r\n\r\nWith default cluster settings, there will be only one __acker-executor and it will be on a separate worker. And it looks like the __acker-executor was not able to receive messages from spouts and bolts. And spouts and bolts continued to retry sending messages to acker. It then led to another problem:\r\nSTORM-2970\r\n\r\nI tried to run on storm right before [https://github.com/apache/storm/pull/2502] and right after and confirmed that this bug should be related to it","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"0.5h","remainingEstimateSeconds":0,"timeSpentSeconds":1800},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Some topologies not working properly ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":1800,"total":1800,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":1800,"total":1800,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16387243","id":"16387243","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ethanli] \r\n\r\nI notice two issues with this setting:\r\n{code:java}\r\nstorm.scheduler: \"org.apache.storm.scheduler.resource.ResourceAwareScheduler\"{code}\r\n*1) Wrong Number of workers:*\r\n\r\nWith this setting applied, storm is spinning up the wrong number of workers for this command line:\r\n{code:java}\r\nbin/storm jar storm-loadgen-2.0.0-SNAPSHOT.jar  org.apache.storm.loadgen.ThroughputVsLatency  --name tvl  --spouts 1 --splitters 2 --counters 1   -c topology.workers=1{code}\r\nIt actually spins up 2 workers instead of 1. The acker is isolated into its own separate worker process while the remaining spouts and bolts sit in a single worker. \r\n\r\nIn 2306, if worker count is 1, the inter-worker transfer thread will not be spun up.  [Reference|https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java#L219-L222].\r\n\r\nThats why the problem was not noticed previously.\r\n\r\n \r\n\r\n*2) That setting is internally unkown.* \r\n\r\nStrangely, In the code I dont see any setting with the name `storm.scheduler` .  I do see something called `topology.scheduler.strategy`. Its a bit puzzling why an unknown setting makes any impact.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-06T03:55:36.314+0000","updated":"2018-03-06T03:55:36.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16387885","id":"16387885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"[~roshan_naik] \r\n\r\nThanks very much for looking into it.\r\n\r\n1)\r\n\r\nWith ResourceAwareScheduler, the number of worker is actually calculated based on resources. `topology.workers` has no impact here.  As you pointed out, I believe the calculated `topology.workers` is not populated to Worker.\r\n\r\n2)\r\n\r\nWe do have the config `storm.scheduler`:  [https://github.com/apache/storm/blob/master/storm-server/src/main/java/org/apache/storm/DaemonConfig.java#L116]\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-03-06T14:45:35.763+0000","updated":"2018-03-06T14:45:35.763+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16388843","id":"16388843","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"Maybe a good idea to add an a info level log message somewhere when not honoring the worker count.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-07T01:23:04.747+0000","updated":"2018-03-07T01:23:04.747+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16389657","id":"16389657","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"Yes you are right. It can be confusing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-03-07T14:58:28.387+0000","updated":"2018-03-07T14:58:28.387+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16419187","id":"16419187","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"[~roshan_naik] Are you still working on fixing this issue? Or do you want me to put up a fix for it? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-03-29T15:24:45.728+0000","updated":"2018-03-29T15:24:45.728+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16419547","id":"16419547","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"Go  ahead. I didn’t take it up since the changes  are in the RAS code path. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-29T18:38:46.079+0000","updated":"2018-03-29T18:38:46.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16419826","id":"16419826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"[~roshan_naik] Do you think it's OK to just get rid of the special case, i.e. no matter how many workers there are, we launch the inter-worker transfer thread?  i think this is the easiest way to do. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-03-29T21:49:46.019+0000","updated":"2018-03-29T21:49:46.019+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16419996","id":"16419996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"[~ethanli]\r\n\r\nI also think that's OK to get rid of optimization for such case. Most of use cases for Storm should be multi-workers.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-03-30T00:18:45.947+0000","updated":"2018-03-30T00:18:45.947+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16420003","id":"16420003","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"[~kabhwan] Thanks. Will file a pull request quickly","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-03-30T00:27:55.473+0000","updated":"2018-03-30T00:27:55.473+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16420162","id":"16420162","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ethanli]\r\n\r\nWe have a problem in Storm with an excessive number of threads. See details in STORM-2647 for how bad the issue is. In general, best to avoid having useless threads lingering around as they are not free in terms of energy consumption in in the long run and keep bumping off useful threads from their cores periodically.\r\n\r\nIMO, the right approach is to fix this by addressing the fundamental issue of worker count reflecting the true state of the topology. Having the settings reflect the right values is also useful for topologies (as they can query them to find out the state of the topology). This would have to be fixed sooner or later.\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-30T05:15:48.011+0000","updated":"2018-03-30T05:15:48.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16420251","id":"16420251","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"While I agree that reflecting correct worker count is better, I'm OK for that once UI show the information correctly, with proper notice for RAS.\r\n\r\nI don't see specific reason to optimize single worker case. What Storm basically provides is \"distributed realtime computation system\", not a single JVM process to run faster. Such optimization was effective only for single worker case which I think is minor and looks like only for benchmarking. I guess we concerned about inter-worker latency (as well as acker) which looks like the thing to focus.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-03-30T07:21:41.310+0000","updated":"2018-03-30T07:21:41.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16420273","id":"16420273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"[~kabhwan] \r\n\r\nIMO this should not be viewed as a sidestepping an minor optimization. In which case it does look like a minor issue. The optimization only exposed a bug. So it is only the \"messenger\".\r\n\r\nThe key issue here is supporting (internal or user code) to check the state correctly .. to do whatever it needs to do .... optimization or behavior change. \r\n\r\nBy not fixing the core bug, we wlll sidestep the core issue. IMO this a critical bug and needs to fixed. Or we need to provide a diff mechanism for code to make such checks correctly.\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-30T08:17:54.817+0000","updated":"2018-03-30T08:20:02.974+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16420512","id":"16420512","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"[~roshan_naik] [topologyConf|https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java#L143] in the code is read from supervisor which is the  stormconf.ser from user's submission.  Some of the configs in user's submission serves as a hint. topologyConf here won't reflect any dynamically calculated values. We might need to check the usage of topologyConf and make sure it's not used for some dynamically calculated values like this. As for this particular issue, I agree with [~kabhwan] that the optimization for singe worker case is not really an issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-03-30T13:58:20.039+0000","updated":"2018-03-30T13:58:20.039+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16421019","id":"16421019","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"Removing / preserving the optimization will not address the core problem ... which is .. topology.workers is not usable and therefore any code (present/future) would be considered broken with no workaround.\r\n\r\nThere are other use cases in code for this setting plus more that I can think of, but to limit the scope I will stay with the topic of some settings in topoConf being unreliable. I dont think its a good idea to say any such code should not allowed in storm.\r\n\r\n \r\n\r\nSince topoConf is part of the API  ...  it is surprising to know that any setting stored in it cannot be relied upon. The  [documentation|http://storm.apache.org/releases/1.2.1/Configuration.html] specifically states that the system supports overriding settings.  *The actual bug here is that we are not dynamically overriding the setting to what it should be.*\r\n\r\nI think we need to have a good justification for making any setting unreliable and not open the door for more of the same.\r\n\r\nWould like to know:\r\n - Is there good reason why this setting cannot be made reliable ?\r\n\r\n - Are you aware of other such settings that are not reflecting the correct values ?\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-03-30T22:24:48.073+0000","updated":"2018-03-30T22:26:12.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16421158","id":"16421158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"[~roshan_naik] [~ethanli]\r\n\r\nLooks like this is about how we provide users to specify resources which are needed for running topology.\r\n\r\nOther than RAS, we assume there’re homogeneous JVM processes (fixed memory, no restriction on CPU) so overall available memory for topology is configurable via how much memory end-users assigns to single worker and how many workers end-users assigns to topology.\r\n\r\nThis is no longer true in RAS, and maybe container environment, too. If my understanding is correct, the major point on RAS / container scheduler is fully utilizing resources in cluster, so user mainly configures how much resources each component/worker need, and physical plan and placement is left to scheduler.\r\n\r\nI also agree topology configuration should be considered to public API. So if such configuration is not effective to RAS, RAS document should mention such behavior. Even better if we explain why it ignores such configuration.\r\n\r\nI’m cc.ing [~revans2] since I think he is the best folk to answer about RAS, and also cc.ing [~erikdw] to see how storm-mesos works for scheduling.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-03-31T02:58:46.639+0000","updated":"2018-03-31T02:58:46.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16422861","id":"16422861","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"Happy to add my 2 cents on this.\r\n\r\n \r\n\r\nThe point of RAS is for multiple reasons. Yes one of them is to allow the cluster to be more utilized by having finer grained resource scheduling.\r\n\r\n \r\n\r\nWhen we added in RAS we did stop honoring {{topology.workers}}.  There are only a handfull of places where it is used outside of the scheduler, so it didn't turn out to be that big of a deal.  The biggest issue we ran into was around the default number of ackers.  In really old versions of storm it was 1, but then was updated to be the number of workers.  We worked around this by having RAS \"guess\" an approximate number of workers as an alternative default.\r\n\r\n[https://github.com/apache/storm/blob/402a371ccdb39ccd7146fe9743e91ca36fee6d15/storm-server/src/main/java/org/apache/storm/daemon/nimbus/Nimbus.java#L2911-L2924]\r\n\r\n \r\n\r\nFor me there are two different things that need to be addressed.\r\n\r\n \r\n\r\n1) we need to update the documentation for {{topology.workers}} to better reflect how it is actually used.\r\n\r\nhttps://github.com/apache/storm/blob/402a371ccdb39ccd7146fe9743e91ca36fee6d15/storm-client/src/jvm/org/apache/storm/Config.java#L194-L199\r\n\r\n \r\n\r\n2) We need to fix the current issue. \r\n\r\nWe can do that by either not relying on the config and instead looking to see if all of the executors for the topology are in the current worker, by turning it off like the current patch does, or by having RAS do a similar \"guess\" about the actual number of workers, but making sure that we always set it to at least 2, because we don't know how many there really will be.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2018-04-02T17:51:55.676+0000","updated":"2018-04-02T17:51:55.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16423486","id":"16423486","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"If we really want to address this via not removing micro optimization but fixing it, it can be done in the right way. It would be better to check whether there're outgoing tasks/connections in each worker, not just checking topology worker count.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-04-03T05:20:22.900+0000","updated":"2018-04-03T05:20:22.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424191","id":"16424191","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"I think it's not worth it to add complexity for this trivial optimization. How about filing a separate Jira for this RAS bug and use [https://github.com/apache/storm/pull/2614] for this particular bug?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-04-03T15:47:33.710+0000","updated":"2018-04-03T15:47:33.710+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424616","id":"16424616","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"As stated before, the core issue is not the specific optimization. Along with removing this optimization we would have to remove all other code that checks the same. It is impt to get RAS working but needs to be done correctly. \r\n\r\nMy concern is that (independent of the existence/absence of this optimization)...  the mechanism to check the worker count by storm internal code or end user code is broken. Fixing that will address RAS as well as does not need to remove similar code.\r\n\r\nSo would like to ask my prev question again:\r\n\r\n \r\n - Is there good reason why topology.workers cannot be dynamically updated to reflect the actual worker count. \r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-03T21:16:09.389+0000","updated":"2018-04-03T21:16:09.389+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424644","id":"16424644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"We definitely need to read through the code and see what RAS breaks and fix them. That's why I suggested to file a separate Jira to track it and have somebody to do it.  I want to get this in because it blocks my current work for quite a long time and I want to get that done sooner than later, if this is OK with you.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-04-03T21:36:46.662+0000","updated":"2018-04-03T21:38:04.918+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424680","id":"16424680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"My Q was not about finding and fixing all things that RAS breaks. It is limited to fixing this issue with the worker count that is causing the breakage. Any code we try to delete now to unblock you would be useful to revive once the worker count issue is fixed. \r\n\r\n- Instead of the proposed fix, can you update the worker count to the right value ?\r\n\r\n- else, could you consider unblocking your work by commenting out the optimization in your local build ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-03T22:07:35.697+0000","updated":"2018-04-03T22:07:35.697+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424755","id":"16424755","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"I'm still +1 to the proposed fix. Even better if we can avoid removing the optimization code with determining there's outgoing connection, but it's OK to skip if it is not trivial.\r\n\r\nTopology configuration is what users set up the values, and users will get confused if some of them are dynamically updated. And we already know that not all the configurations may be valid according to the scheduler. \"topology.workers\" is popular one so it doesn't look trivial to ignore such value, but I think we can explain why it is ignored in RAS document.\r\n\r\nIf we really want to maintain runtime status, better to have separated one instead of modifying topology configuration to retain users' input.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-04-03T23:32:10.555+0000","updated":"2018-04-03T23:32:10.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424776","id":"16424776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"[~kabhwan] i think you are again missing what I am stressing. \r\n\r\nWe need a way to in code to check the worker count (for internal and user code). Not be removing code that does such checks. I am not concerned about retaining this one optimization. \r\n\r\nBut there is no point removing reasonable code and then put it back again.\r\n\r\nI would like to see why we cannot either fix the topology.workers or  provide something else as substitute.\r\n\r\nSo i ask again... why cant we fix this setting. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-03T23:46:18.312+0000","updated":"2018-04-03T23:48:38.912+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16424819","id":"16424819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"If you're not concerned about retaining the optimization then let's remove it. As explained enough (single worker should be minor one in production use cases), I think we don't need to put it back again. Other concerns look like the things to discuss, since we don't look like having consensus. That's why [~ethanli] would like to file new issues regarding them, and IMHO I think it may be better to initiate them in dev. mailing list so that we can share the concerns and discuss them.\r\n\r\nAs you seem to think I'm missing, I may need to explain my thought below:\r\n\r\n1. Even we want to retain the optimization, I think I proposed \"the right way\" to do it in my comment. Checking topology worker count is \"simplest\" one for activating/deactivating transfer thread, but \"right one\" is checking whether outgoing stream exists in that worker. Multiple workers can be run independently (not communicating with each other) depending on how scheduler plans. Isn't it? We never utilized topology worker count in specific worker, and I think worker still has enough information to deal with such optimization without knowing topology worker count.\r\n\r\n2. Regarding modifying topology configuration, I think I already put my 2 cent on last comment. Whenever I need to check which value I set in configuration, I'm checking the value in UI. If the value is different than what user put before, we still need to explain why it is happening to avoid confusion. That's not ideal. I think the topology configuration should be immutable one, though we don't guarantee it from the code. Maybe we would need to have context object like StormContext?\r\n\r\n3. We already have StormTopology as well as TopologyContext which provide necessary information. Dynamic informations like assignment are handled by worker. The number of worker in topology is not exposed directly, but can be calculated from Assignment. (Please refer [https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/worker/WorkerState.java#L357] and [https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/generated/Assignment.java]) Based on 2, I would try to calculate it if it really needs.\r\n\r\n4. We construct the configuration from combination of command line, code, conf. file, etc. We assume they're not changing during runtime, which makes us safe to read the configuration multiple times in different places. There's a chance for the assumption to be broken if we modify the value in runtime.\r\n\r\n5. I admit that it is too ideal for the state of current Storm, but the count of worker in topology can be increased or decreased in runtime if we address elasticity. If we deal with this via relaunching all the workers then the value can be considered as static, but if not, the value will be dynamic which topology configuration is not doable to contain it.\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-04-04T00:49:51.299+0000","updated":"2018-04-04T00:50:14.691+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16425223","id":"16425223","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"Mutability of topology configuration is explicitly allowed in the documentation (previously referenced).\r\n\r\n \r\n\r\nUsefulness of single worker use case should not be under-estimated. For perf critical topos it is a reasonable option to consider deploying multiple single worker instances of the topo as opposed to a single multiworker instance to avoid interworker communication. I have recommended users on mailing list to consider it (for things like video processing) and I have seen others recommend users to consider 1worker mode as well.\r\n\r\n \r\n\r\nGiven the fact that RA creates the divergence in specification v/s reality, confusion is bound to exist no matter which we resolve this value of this setting. Although IMO it is not a strong enough case to not reflect actual worker count ... if it is contentious ... I am ok to resolve it either way ....  as long we provide an API for so that code can check.  Currently I am aware of a few additional use cases for knowing worker count. \r\n * enable/disable interworker BP subsystem.(already in place)\r\n * auto disabling Locality Awareness for 1 worker (i have measured this impact to be a bit under 10% or something for 1 worker)\r\n * user bolts inspecting this to make decisions..  like potentially allocate a certain number of external resources based on worker count... or who knows what.\r\n\r\n \r\n\r\nMy concern is limited to the fact that we must have official support to be able to detect the worker count. It is simply too heavy handed to simply say NO to all current and potential use cases.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-04T09:12:28.151+0000","updated":"2018-04-04T09:15:00.985+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16425554","id":"16425554","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"I think [~kabhwan] has a very good point. So I am proposing:\r\n\r\n1) a new Jira for RAS issues.\r\n\r\n    We all agree that RAS issues are important and need to be addressed. I believe it's better to have a separate Jira to discuss and fix them in the right way.\r\n\r\n2) checking whether outgoing stream/tasks/connections exists in the worker instead of checking topology.worker. I agree that this is the right way to do it and it's more flexible. It also keeps this minor optimization. (Made updates to the PR).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-04-04T13:58:53.593+0000","updated":"2018-04-04T15:39:45.129+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16425709","id":"16425709","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"[~kabhwan] and [~roshan_naik]\r\n\r\n\"Is there good reason why topology.workers cannot be dynamically updated to reflect the actual worker count. \"\r\n\r\nYes.\r\n\r\nIt would require restarting all workers every time there was a scheduling change in the number of workers.  We can support it, and if someone shows a good use case as to why we would need it we can try and do it, but it is far from ideal.\r\n\r\n\"The  [documentation|http://storm.apache.org/releases/1.2.1/Configuration.html] specifically states that the system supports overriding settings. \"\r\n\r\nYes but that is not a dynamic override.  This is because the config is treated as immutable within the worker.  Additionally there is a convention where configs that start with \"topology.\" are meant for users to set, and for the system to read, not the other way around.\r\n\r\n\"I think the topology configuration should be immutable one, though we don't guarantee it from the code.\"\r\n\r\nActually all currently released versions of storm are based off of clojure.  The Map that we pass around is an immutable clojure map.  I would be 100% on board with making the map we pass around in the worker immutable for 2.x as well.  Hadoop has so many horrible issues because they do not enforce this in their config.  We really don't want to get into the business of allowing this within a worker.  The Config object must be mutable because users are creating it to launch their topology.  Once it is created, except for a few configs we set at topology submission time, and through the rebalance API which will enforce the workers restarting, we do not change the config.\r\n\r\n \r\n\r\n\"We need a way to in code to check the worker count (for internal and user code).\"\r\n\r\nFor internal system code I can see a use case for this and I think we can provide it.  However, I don't see any value in providing this for user code.  \r\n\r\n\"as they can query them to find out the state of the topology\"\r\n\r\nFinding the current state of a topology by a bolt/spout is something we have always been bad at.  I would love to see more of this exposed to topology users, but I don't think config is the right place to expose it.  Also I would like to have a real solid use case for everything we expose.  The issue is the more we expose to end users the harder it is to change the internals of the system.  If we had exposed something about the outbound queues to end users it would have been much harder to make the changes that got rid of the outbound queues.\r\n\r\nI understand letting the grouping know how overloaded downstream bolts are, which we added with load aware groupings.\r\n\r\nI understand letting the grouping know where downstream bolts are schedules, which we added with locality aware groupings.\r\n\r\nI understand letting a bolt know how full its inbound queue is so it can possibly play games with batching data to an external system (something we don't currently do but would be good to).\r\n\r\nWhat I don't understand is what would a bolt do differently for a single worker setup vs a multi-worker setup. Would they try to communicate to one another differently?  Would they send different types or sizes of messages?  I just don't see any use case where a bolt or spout would care, but if you have a use case we can totally provide it.\r\n\r\n \r\n\r\nI agree that the single worker use case is critical for performance.  Hopefully in the future we can get the scheduler and the routers to be smart enough that it is less of an issue, but as for now it is needed.\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2018-04-04T15:22:33.663+0000","updated":"2018-04-04T15:22:33.663+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16426902","id":"16426902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"body":"Thanks [~ethanli], I merged into master.\r\n\r\n[~roshan_naik] [~revans2]\r\n\r\nPlease note that [https://github.com/apache/storm/pull/2614] fixed the issue via proposed way (even better) : it can also cover multiple all-in-one workers use case as well.\r\n\r\nWe can continue discussion, but maybe better to move to dev. list or file issue(s) since the topic(s) are out of topic for this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kabhwan","name":"kabhwan","key":"kabhwan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jungtaek Lim","active":true,"timeZone":"Asia/Seoul"},"created":"2018-04-05T13:12:07.446+0000","updated":"2018-04-05T13:12:07.446+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16427441","id":"16427441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"Thanks [~kabhwan] and [~ethanli] for getting that in.\r\n\r\n \r\n\r\n[~roshan_naik] I am happy to continue any discussion on the mailing list or on follow on JIRAs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2018-04-05T18:55:16.503+0000","updated":"2018-04-05T18:55:16.503+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16427559","id":"16427559","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~revans2] for those clarifications.\r\n\r\nThanks [~ethanli] for the revised fix.\r\n\r\nSimilar fixes are needed elsewhere as well, since they are all probably broken:\r\n - [https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L276]\r\n\r\n - [https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L363-L364] \r\n - [https://github.com/apache/storm/blob/master/examples/storm-loadgen/src/main/java/org/apache/storm/loadgen/CaptureLoad.java#L109-L112]\r\n\r\n - [https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java#L306]  \r\n\r\n \r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-04-05T20:43:57.682+0000","updated":"2018-04-05T20:44:15.502+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/comment/16430608","id":"16430608","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"body":"[~revans2]  [~kabhwan] [~roshan_naik] \r\n\r\nI filed a separate Jira STORM-3021 to track this RAS issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"created":"2018-04-09T14:33:58.547+0000","updated":"2018-04-09T14:33:58.547+0000"}],"maxResults":31,"total":31,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2983/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":3,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/worklog/85840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user Ethanlm opened a pull request:\n\n    https://github.com/apache/storm/pull/2614\n\n    [STORM-2983] fix the issue that the inter-worker transfer thread is not spun up on some cases on RAS cluster\n\n    https://issues.apache.org/jira/browse/STORM-2983\r\n    \r\n    Because the number of workers are dynamically calculated on RAS and is not populated to SupervisorStormConf, by default `topologyConf.get(Config.TOPOLOGY_WORKERS)`  returns 1 and the transferThread is not launched. Some topologies like \r\n    ```\r\n    bin/storm jar storm-loadgen-*.jar org.apache.storm.loadgen.ThroughputVsLatency --spouts 1 --splitters 2 --counters 1 -c topology.debug=true\r\n    ```\r\n    on RAS cluster are not working properly.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/Ethanlm/storm STORM-2983\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/2614.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #2614\n    \n----\ncommit 5eef5094cef215b68baf5b6916b122159ff23ec2\nAuthor: Ethan Li <ethanopensource@...>\nDate:   2018-03-30T00:33:18Z\n\n    [STORM-2983] fix the issue that the inter-worker transfer thread is not spun up on some cases on RAS cluster\n    \n    Because the number of workers are dynamically calculated on RAS and is not populated to SupervisorStormConf\n\n----\n","created":"2018-03-30T00:36:11.656+0000","updated":"2018-03-30T00:36:11.656+0000","started":"2018-03-30T00:36:11.655+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"85840","issueId":"13141544"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/worklog/85888","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on the issue:\n\n    https://github.com/apache/storm/pull/2614\n  \n    not sure why the build failed. Succeeded on my mac.    \n","created":"2018-03-30T03:24:47.038+0000","updated":"2018-03-30T03:24:47.038+0000","started":"2018-03-30T03:24:47.038+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"85888","issueId":"13141544"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13141544/worklog/88029","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/storm/pull/2614\n","created":"2018-04-05T13:08:01.103+0000","updated":"2018-04-05T13:08:01.103+0000","started":"2018-04-05T13:08:01.103+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"88029","issueId":"13141544"}]},"customfield_12311820":"0|i3qp8v:"}}