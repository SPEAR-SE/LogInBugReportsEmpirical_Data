{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13151060","self":"https://issues.apache.org/jira/rest/api/2/issue/13151060","key":"STORM-3021","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":14400,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"aggregatetimespent":14400,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2018-04-09 14:31:01.782","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_361559051_*|*_3_*:*_1_*:*_1412861646_*|*_5_*:*_1_*:*_0","customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":"2018-04-30T03:24:42.438+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-3021/watchers","watchCount":1,"isWatching":false},"created":"2018-04-09T14:31:01.782+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["pull-request-available"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":"STORM-2714","customfield_12312330":null,"versions":[],"customfield_12312339":null,"issuelinks":[{"id":"12531348","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12531348","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"13141544","key":"STORM-2983","self":"https://issues.apache.org/jira/rest/api/2/issue/13141544","fields":{"summary":"Some topologies not working properly ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-04-30T03:24:42.467+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Continue the discussion from STORM-2983.\r\n\r\nResourceAware schedule dynamically calculated the number of workers and doesn't horror topology.worker. So we need to\r\n\r\n1) update docs to avoid confusion; \r\n\r\n2) check what RAS breaks and fix them.","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"4h","remainingEstimateSeconds":0,"timeSpentSeconds":14400},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"RAS doesn't honor Config.TOPOLOGY_WORKERS","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ethanli","name":"ethanli","key":"ethanli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ethanli&avatarId=32192","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ethanli&avatarId=32192","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ethanli&avatarId=32192","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ethanli&avatarId=32192"},"displayName":"Ethan Li","active":true,"timeZone":"America/Chicago"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":14400,"total":14400,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":14400,"total":14400,"percent":100},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-3021/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":24,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/90684","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"GitHub user Ethanlm opened a pull request:\n\n    https://github.com/apache/storm/pull/2634\n\n    [STORM-3021] Fix wrong usages of Config.TOPOLOGY_WORKERS on RAS cluster\n\n    https://issues.apache.org/jira/browse/STORM-3021\r\n    \r\n    The Resource Aware Scheduler doesn't honor `Config.TOPOLOGY_WORKERS`. So we need to fix the code where it uses `Config.TOPOLOGY_WORKERS` incorrectly.  Also fix docs/javadocs to avoid confusion. \r\n\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/Ethanlm/storm STORM-3021\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/storm/pull/2634.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #2634\n    \n----\ncommit 032431cf448a589cfa016fba775921e5c06f89e4\nAuthor: Ethan Li <ethanopensource@...>\nDate:   2018-04-13T03:10:25Z\n\n    [STORM-3021] Fix wrong usages of Config.TOPOLOGY_WORKERS on RAS cluster\n\n----\n","created":"2018-04-13T03:19:03.908+0000","updated":"2018-04-13T03:19:03.908+0000","started":"2018-04-13T03:19:03.908+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"90684","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/90849","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user agresch commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r181427545\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    --- End diff --\n    \n    remove unused topologyConf\n","created":"2018-04-13T15:44:28.295+0000","updated":"2018-04-13T15:44:28.295+0000","started":"2018-04-13T15:44:28.294+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"90849","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/90929","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r181472816\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    --- End diff --\n    \n    `topologyConf`  used in this function \n","created":"2018-04-13T18:26:15.008+0000","updated":"2018-04-13T18:26:15.008+0000","started":"2018-04-13T18:26:15.008+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"90929","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/90940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user agresch commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r181480542\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    --- End diff --\n    \n    My bad.  \n","created":"2018-04-13T18:54:20.562+0000","updated":"2018-04-13T18:54:20.562+0000","started":"2018-04-13T18:54:20.561+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"90940","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/91035","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user erikdw commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r181535091\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/Config.java ---\n    @@ -372,9 +374,10 @@\n         /**\n          * How many executors to spawn for ackers.\n          *\n    -     * <p>By not setting this variable or setting it as null, Storm will set the number of acker executors\n    -     * to be equal to the number of workers configured for this topology. If this variable is set to 0,\n    -     * then Storm will immediately ack tuples as soon as they come off the spout, effectively disabling reliability.</p>\n    +     * <p>By not setting this variable or setting it as null, Storm will set the number of acker executor to be equal to\n    --- End diff --\n    \n    nit: please restore pluralization of `executor`.  i.e., `number of acker executors`.\n","created":"2018-04-14T00:48:13.131+0000","updated":"2018-04-14T00:48:13.131+0000","started":"2018-04-14T00:48:13.131+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"91035","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on the issue:\n\n    https://github.com/apache/storm/pull/2634\n  \n    @revans2  @roshannaik  Could you please take a look if you get a chance as we discussed about this in https://issues.apache.org/jira/browse/STORM-3021\n","created":"2018-04-18T14:04:27.738+0000","updated":"2018-04-18T14:04:27.738+0000","started":"2018-04-18T14:04:27.737+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92119","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92222","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182545551\n  \n    --- Diff: docs/Resource_Aware_Scheduler_overview.md ---\n    @@ -184,6 +184,10 @@ The user can set some default configurations for the Resource Aware Scheduler in\n         topology.worker.max.heap.size.mb: 768.0\n     ```\n     \n    +### Warning\n    +\n    +The number of workers will be dynamically calculated by the Resource Aware Scheduler. The `Config.TOPOLOGY_WORKERS` will not be honored. \n    --- End diff --\n    \n    May I suggest a minor rewording:  \"If Resource Aware Scheduling is enabled, it will dynamically calculate the number of workers and the `topology.workers` setting is ignored.\"\n","created":"2018-04-18T19:37:53.240+0000","updated":"2018-04-18T19:37:53.240+0000","started":"2018-04-18T19:37:53.239+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92222","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182549691\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/nimbus/Nimbus.java ---\n    @@ -3032,9 +3019,19 @@ public void submitTopologyWithOpts(String topoName, String uploadedJarLocation,\n                 // if the other config does not have it set.\n                 topology = normalizeTopology(totalConf, topology);\n     \n    -            //set the number of acker executors;\n    -            totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, getNumOfAckerExecs(totalConf, topology));\n    -            LOG.debug(\"Config.TOPOLOGY_ACKER_EXECUTORS set to: {}\", totalConfToSave.get(Config.TOPOLOGY_ACKER_EXECUTORS));\n    +            // if the Resource Aware Scheduler is used,\n    +            // we might need to set the number of acker executors and eventlogger executors to be the estimated number of workers.\n    +            if (ServerUtils.isRAS(conf)) {\n    +                int estimatedNumWorker = ServerUtils.getEstimatedWorkerCountForRASTopo(totalConf, topology);\n    +                int numAckerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_ACKER_EXECUTORS), estimatedNumWorker);\n    +                int numEventLoggerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_EVENTLOGGER_EXECUTORS), estimatedNumWorker);\n    +\n    +                totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, numAckerExecs);\n    --- End diff --\n    \n    Is this a case where we are overriding the acker & eventLogger count settings that are set by user ?\n","created":"2018-04-18T19:53:53.818+0000","updated":"2018-04-18T19:53:53.818+0000","started":"2018-04-18T19:53:53.817+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92224","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182552073\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n    Perhaps we can consolidate these set difference calls to count single/multiworker mode into a single function ? \r\n    - https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java#L230 \r\n\n","created":"2018-04-18T20:02:45.930+0000","updated":"2018-04-18T20:02:45.930+0000","started":"2018-04-18T20:02:45.929+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92228","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182584203\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/nimbus/Nimbus.java ---\n    @@ -3032,9 +3019,19 @@ public void submitTopologyWithOpts(String topoName, String uploadedJarLocation,\n                 // if the other config does not have it set.\n                 topology = normalizeTopology(totalConf, topology);\n     \n    -            //set the number of acker executors;\n    -            totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, getNumOfAckerExecs(totalConf, topology));\n    -            LOG.debug(\"Config.TOPOLOGY_ACKER_EXECUTORS set to: {}\", totalConfToSave.get(Config.TOPOLOGY_ACKER_EXECUTORS));\n    +            // if the Resource Aware Scheduler is used,\n    +            // we might need to set the number of acker executors and eventlogger executors to be the estimated number of workers.\n    +            if (ServerUtils.isRAS(conf)) {\n    +                int estimatedNumWorker = ServerUtils.getEstimatedWorkerCountForRASTopo(totalConf, topology);\n    +                int numAckerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_ACKER_EXECUTORS), estimatedNumWorker);\n    +                int numEventLoggerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_EVENTLOGGER_EXECUTORS), estimatedNumWorker);\n    +\n    +                totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, numAckerExecs);\n    --- End diff --\n    \n    Some other places that may need similar fixes:\r\n    \r\n    - https://github.com/apache/storm/blob/master/examples/storm-loadgen/src/main/java/org/apache/storm/loadgen/CaptureLoad.java#L109\r\n    \r\n    - https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L363-L364  \r\n    \r\n    - https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L276 \r\n    \r\n    \r\n    may want to check for all usages of that setting in code base.\n","created":"2018-04-18T22:08:51.653+0000","updated":"2018-04-18T22:08:51.653+0000","started":"2018-04-18T22:08:51.652+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92256","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182628537\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n    Some other places that may need similar fixes:\r\n    \r\n    - https://github.com/apache/storm/blob/master/examples/storm-loadgen/src/main/java/org/apache/storm/loadgen/CaptureLoad.java#L109\r\n    \r\n    - https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L363-L364  \r\n    \r\n    - https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L276 \r\n    \r\n    \r\n    may want to check for all usages of that setting in code base.\n","created":"2018-04-19T04:00:19.587+0000","updated":"2018-04-19T04:00:19.587+0000","started":"2018-04-19T04:00:19.587+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92372","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92563","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182747281\n  \n    --- Diff: docs/Resource_Aware_Scheduler_overview.md ---\n    @@ -184,6 +184,10 @@ The user can set some default configurations for the Resource Aware Scheduler in\n         topology.worker.max.heap.size.mb: 768.0\n     ```\n     \n    +### Warning\n    +\n    +The number of workers will be dynamically calculated by the Resource Aware Scheduler. The `Config.TOPOLOGY_WORKERS` will not be honored. \n    --- End diff --\n    \n    +1 for the comment from @roshannaik \n","created":"2018-04-19T13:46:13.007+0000","updated":"2018-04-19T13:46:13.007+0000","started":"2018-04-19T13:46:13.006+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92563","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92564","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182750384\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/nimbus/Nimbus.java ---\n    @@ -3032,9 +3019,19 @@ public void submitTopologyWithOpts(String topoName, String uploadedJarLocation,\n                 // if the other config does not have it set.\n                 topology = normalizeTopology(totalConf, topology);\n     \n    -            //set the number of acker executors;\n    -            totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, getNumOfAckerExecs(totalConf, topology));\n    -            LOG.debug(\"Config.TOPOLOGY_ACKER_EXECUTORS set to: {}\", totalConfToSave.get(Config.TOPOLOGY_ACKER_EXECUTORS));\n    +            // if the Resource Aware Scheduler is used,\n    +            // we might need to set the number of acker executors and eventlogger executors to be the estimated number of workers.\n    +            if (ServerUtils.isRAS(conf)) {\n    +                int estimatedNumWorker = ServerUtils.getEstimatedWorkerCountForRASTopo(totalConf, topology);\n    +                int numAckerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_ACKER_EXECUTORS), estimatedNumWorker);\n    +                int numEventLoggerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_EVENTLOGGER_EXECUTORS), estimatedNumWorker);\n    +\n    +                totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, numAckerExecs);\n    --- End diff --\n    \n    No we are not overriding the user setting.  We are overriding the default value.\n","created":"2018-04-19T13:46:13.356+0000","updated":"2018-04-19T13:46:13.356+0000","started":"2018-04-19T13:46:13.355+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92564","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92571","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182755817\n  \n    --- Diff: storm-server/src/main/java/org/apache/storm/daemon/nimbus/Nimbus.java ---\n    @@ -3032,9 +3019,19 @@ public void submitTopologyWithOpts(String topoName, String uploadedJarLocation,\n                 // if the other config does not have it set.\n                 topology = normalizeTopology(totalConf, topology);\n     \n    -            //set the number of acker executors;\n    -            totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, getNumOfAckerExecs(totalConf, topology));\n    -            LOG.debug(\"Config.TOPOLOGY_ACKER_EXECUTORS set to: {}\", totalConfToSave.get(Config.TOPOLOGY_ACKER_EXECUTORS));\n    +            // if the Resource Aware Scheduler is used,\n    +            // we might need to set the number of acker executors and eventlogger executors to be the estimated number of workers.\n    +            if (ServerUtils.isRAS(conf)) {\n    +                int estimatedNumWorker = ServerUtils.getEstimatedWorkerCountForRASTopo(totalConf, topology);\n    +                int numAckerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_ACKER_EXECUTORS), estimatedNumWorker);\n    +                int numEventLoggerExecs = ObjectReader.getInt(totalConf.get(Config.TOPOLOGY_EVENTLOGGER_EXECUTORS), estimatedNumWorker);\n    +\n    +                totalConfToSave.put(Config.TOPOLOGY_ACKER_EXECUTORS, numAckerExecs);\n    --- End diff --\n    \n    +1\n","created":"2018-04-19T14:00:09.951+0000","updated":"2018-04-19T14:00:09.951+0000","started":"2018-04-19T14:00:09.951+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92571","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92575","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182757546\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n    About the `set difference calls`, I thought these two are different. The first one https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java#L230 is to check if there is any outbound task not in local worker. This doesn't necessarily mean the topology has only one worker. \r\n    The second (in setupBackPressureCheckTimer) is to check if all the tasks are in local which means there is only one worker.\r\n    \r\n    \r\n\n","created":"2018-04-19T14:05:25.763+0000","updated":"2018-04-19T14:05:25.763+0000","started":"2018-04-19T14:05:25.762+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92575","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92576","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182758538\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n    https://github.com/apache/storm/blob/master/examples/storm-loadgen/src/main/java/org/apache/storm/loadgen/CaptureLoad.java#L109 This is fine because the code also gets the num of workers from topologyInfo.\r\n    \r\n    https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L363-L364 this is also fine because we override the default value of `TOPOLOGY_EVENTLOGGER_EXECUTORS` when we submit the topology if it's on RAS.\r\n    Similar to https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/daemon/StormCommon.java#L276\r\n    \r\n    \r\n\n","created":"2018-04-19T14:08:19.094+0000","updated":"2018-04-19T14:08:19.094+0000","started":"2018-04-19T14:08:19.093+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92576","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/92899","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r182909146\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n    Thanks for clarifications. IMO, thats a nice (eventhough small) improvement to disable interworker when there are no outbound tasks... and not just for 1worker mode. \r\n    \r\n    Minor request: would be nice to have named functions for those two set difference calls. I suspect they will start seeing more usage soon.\r\n    \r\n    looks good thanks for taking care of this.\r\n\n","created":"2018-04-19T23:07:33.403+0000","updated":"2018-04-19T23:07:33.403+0000","started":"2018-04-19T23:07:33.402+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"92899","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/93203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r183051697\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n    `Sets.difference()` is already a named function and it's almost one line of code. I think it's OK to just use it in this way?\n","created":"2018-04-20T13:35:10.502+0000","updated":"2018-04-20T13:35:10.502+0000","started":"2018-04-20T13:35:10.501+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"93203","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/93394","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user Ethanlm commented on the issue:\n\n    https://github.com/apache/storm/pull/2634\n  \n    The failed test should be unrelated\n","created":"2018-04-20T19:39:36.553+0000","updated":"2018-04-20T19:39:36.553+0000","started":"2018-04-20T19:39:36.552+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"93394","issueId":"13151060"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13151060/worklog/93575","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user roshannaik commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2634#discussion_r183200719\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java ---\n    @@ -305,8 +305,9 @@ private void setupFlushTupleTimer(final Map<String, Object> topologyConf, final\n         }\n     \n         private void setupBackPressureCheckTimer(final Map<String, Object> topologyConf) {\n    -        final Integer workerCount = ObjectReader.getInt(topologyConf.get(Config.TOPOLOGY_WORKERS));\n    -        if (workerCount <= 1) {\n    +        Set<Integer> nonLocalTasks = Sets.difference(workerState.getTaskToComponent().keySet(),\n    --- End diff --\n    \n     I meant ... would be nice to have functions like  isSingleWorkerMode() and hasOutboundTasks() that hide the detail of whatever mechanics are being employed to figure it out. I suspect they these functions will see more usage.\n","created":"2018-04-21T05:29:37.597+0000","updated":"2018-04-21T05:29:37.597+0000","started":"2018-04-21T05:29:37.597+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"93575","issueId":"13151060"}]},"customfield_12311820":"0|i3sbdr:"}}