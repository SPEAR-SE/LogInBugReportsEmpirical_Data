{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13088563","self":"https://issues.apache.org/jira/rest/api/2/issue/13088563","key":"STORM-2646","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":8400,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12314820","id":"12314820","key":"STORM","name":"Apache Storm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12314820&avatarId=21667","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12314820&avatarId=21667","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12314820&avatarId=21667","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12314820&avatarId=21667"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13260","id":"13260","description":"Apache Storm Related","name":"Storm"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334657","id":"12334657","name":"2.0.0","archived":false,"released":false}],"aggregatetimespent":8400,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 24 14:47:45 UTC 2017","customfield_12312320":null,"customfield_12310222":null,"customfield_12310420":"9223372036854775807","customfield_12312321":null,"resolutiondate":null,"workratio":116,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":"When I run:\nstorm jar test.jar org.apache.storm.flux.Flux --remote /pat/to/topology.yaml --inactive --filter ./config/dev.properties\n\ndev.properties contains:\n# redis properties\nredis.server.host = rd.mycompany.org\nredis.server.port = 63820\n\n# other properties\nzookeeper.servers = zk.mycompany.org:21810\n\nnimbus.seeds = [\"nb.mycompany.org\"]\nnimbus.thrift.port= 6627\n\nGetting following exception:\nCan't use [\"nb.mycompany.org\"] it is : - > Caused by: java.lang.ClassCastException: java.lang.String cannot be cast to java.util.List at org.apache.storm.utils.NimbusClient.getConfiguredClientAs(NimbusClient.java:76)\n","customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2646/watchers","watchCount":1,"isWatching":false},"created":"2017-07-19T21:31:51.839+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["client","config","nimbus"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":7200,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337341","id":"12337341","name":"1.0.3","archived":false,"released":true,"releaseDate":"2017-02-14"}],"customfield_12312339":null,"issuelinks":[],"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-07-24T14:47:45.151+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12332475","id":"12332475","name":"storm-client"}],"timeoriginalestimate":7200,"description":null,"customfield_10010":null,"timetracking":{"originalEstimate":"2h","remainingEstimate":"0h","timeSpent":"2h 20m","originalEstimateSeconds":7200,"remainingEstimateSeconds":0,"timeSpentSeconds":8400},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[],"customfield_12312340":null,"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"NimbusClient Class cast exception when nimbus seeds is not an array of hosts","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ecararus","name":"ecararus","key":"ecararus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eugeniu Cararus","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ecararus","name":"ecararus","key":"ecararus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eugeniu Cararus","active":true,"timeZone":"Etc/UTC"},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":8400,"total":8400,"percent":100},"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":8400,"total":8400,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/comment/16098516","id":"16098516","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ecararus","name":"ecararus","key":"ecararus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eugeniu Cararus","active":true,"timeZone":"Etc/UTC"},"body":"Fix has been committed on: https://github.com/apache/storm/pull/2228/commits/732d0c276d4ee5c7dbf2422a5b5ed78baef5e838 should be merged to master","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ecararus","name":"ecararus","key":"ecararus","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eugeniu Cararus","active":true,"timeZone":"Etc/UTC"},"created":"2017-07-24T14:47:45.151+0000","updated":"2017-07-24T14:47:45.151+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/STORM-2646/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":14,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    Thank you @srdo for suggestion I've created [jira issue](https://issues.apache.org/jira/browse/STORM-2646) also updated PR Title.\n    \n    Inside my config file i have:\n    \n    nimbus.seeds= [\"somehost.org\"]\n    nimbus.host= somehost.org # temporar fix\n    nimbus.thrift.port= 66270\n    \n    more details about project config on jira.\n    \n    About List<String> i agree with @revans2 about validation and I would like to propose to accept single host also e.g. nimbus.seeds= somehost.org in this way we can support same configuration/behavior like it was with nimbus.host (that might be useful when host is provided by discovery or load distribution service).\n","created":"2017-07-19T21:50:34.145+0000","updated":"2017-07-19T21:50:34.145+0000","started":"2017-07-19T21:50:34.144+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48197","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2228#discussion_r128377962\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/NimbusClient.java ---\n    @@ -109,12 +109,13 @@ public static NimbusClient getConfiguredClientAs(Map<String, Object> conf, Strin\n             }\n     \n             List<String> seeds;\n    -        if(conf.containsKey(Config.NIMBUS_HOST)) {\n    +        if (conf.containsKey(Config.NIMBUS_HOST)) {\n                 LOG.warn(\"Using deprecated config {} for backward compatibility. Please update your storm.yaml so it only has config {}\",\n    -                     Config.NIMBUS_HOST, Config.NIMBUS_SEEDS);\n    +                    Config.NIMBUS_HOST, Config.NIMBUS_SEEDS);\n                 seeds = Lists.newArrayList(conf.get(Config.NIMBUS_HOST).toString());\n             } else {\n    -            seeds = (List<String>) conf.get(Config.NIMBUS_SEEDS);\n    +            Object nimbusSeeds = conf.get(Config.NIMBUS_SEEDS);\n    +            seeds = nimbusSeeds instanceof String[] ? Lists.newArrayList((String[]) nimbusSeeds) : Lists.newArrayList(nimbusSeeds.toString());\n    --- End diff --\n    \n    @d2r I don't think that ```conf.get(Config.NIMBUS_SEEDS)``` will return List<String> as per contract the values in conf is Object. in order to avoid any issue probably is better to have a config validation as @revans2 suggested. \n","created":"2017-07-19T21:54:23.033+0000","updated":"2017-07-19T21:54:23.033+0000","started":"2017-07-19T21:54:23.033+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48198","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    @ecararus Thanks. I'm not too familiar with Flux, but going by what you listed in the issue, I'm guessing it's a problem where the `[\"nb.mycompany.org\"]` from dev.properties is being substituted into the topology.yaml as a string instead of a list.\n    \n    Shot in the dark, does your topology.yaml do something like \n    ```\n    config:\n      nimbus.seeds: \"${nimbus.seeds}\"\n    ```\n    If so, would it work to instead write\n    ```\n    config:\n      nimbus.seeds: ${nimbus.seeds}\n    ```\n","created":"2017-07-19T22:23:59.659+0000","updated":"2017-07-19T22:23:59.659+0000","started":"2017-07-19T22:23:59.653+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48200","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48206","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    @srdo my topology.yaml has: \n    ```\n    config:\n      nimbus.seeds: ${nimbus.seeds}\n    ```\n    The property from dev.properties is loaded by [FluxParser](https://github.com/apache/storm/blob/master/flux/flux-core/src/main/java/org/apache/storm/flux/parser/FluxParser.java#L86) see line 100 there ```nimbus.seeds``` is treated as string and when on NimbusClient.java we try to : \n    ```\n     seeds = (List<String>) conf.get(Config.NIMBUS_SEEDS);\n    ```\n    then I'm getting class cast ex. and in the exception we can see mesage Can't use [\"host\"] it is ....\n    As @revans2 suggested before cast we need to check if this is an array, in the situation described above it is configured as array of hosts but parser istreating as a string with \"[host]\" .\n","created":"2017-07-19T22:56:32.704+0000","updated":"2017-07-19T22:56:32.704+0000","started":"2017-07-19T22:56:32.703+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48206","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48238","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user d2r commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2228#discussion_r128411779\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/NimbusClient.java ---\n    @@ -109,12 +109,13 @@ public static NimbusClient getConfiguredClientAs(Map<String, Object> conf, Strin\n             }\n     \n             List<String> seeds;\n    -        if(conf.containsKey(Config.NIMBUS_HOST)) {\n    +        if (conf.containsKey(Config.NIMBUS_HOST)) {\n                 LOG.warn(\"Using deprecated config {} for backward compatibility. Please update your storm.yaml so it only has config {}\",\n    -                     Config.NIMBUS_HOST, Config.NIMBUS_SEEDS);\n    +                    Config.NIMBUS_HOST, Config.NIMBUS_SEEDS);\n                 seeds = Lists.newArrayList(conf.get(Config.NIMBUS_HOST).toString());\n             } else {\n    -            seeds = (List<String>) conf.get(Config.NIMBUS_SEEDS);\n    +            Object nimbusSeeds = conf.get(Config.NIMBUS_SEEDS);\n    +            seeds = nimbusSeeds instanceof String[] ? Lists.newArrayList((String[]) nimbusSeeds) : Lists.newArrayList(nimbusSeeds.toString());\n    --- End diff --\n    \n    Yeah I agree. Validation is supposed to prevent this error. The value must be a list of strings.\n","created":"2017-07-20T02:15:24.908+0000","updated":"2017-07-20T02:15:24.908+0000","started":"2017-07-20T02:15:24.908+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48238","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48329","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    The patch right now looks fine to me, but I don't think it fixes your issue with flux.  Looking at the flux code inside FluxParser.java the `${NAME}` substitution is literately a macro substitution that happens before the YAML parsing.  So if you want it to be an array you need to do like @srdo said and use `[\"nb.mycompany.org\"]` for nimbus.seeds in your properties file instead of just `\"nb.mycompany.org\"`.\n","created":"2017-07-20T18:28:31.765+0000","updated":"2017-07-20T18:28:31.765+0000","started":"2017-07-20T18:28:31.764+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48329","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48338","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2228#discussion_r128613874\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/NimbusClient.java ---\n    @@ -107,13 +109,14 @@ public static NimbusClient getConfiguredClientAs(Map<String, Object> conf, Strin\n                 }\n                 asUser = (String) conf.get(Config.STORM_DO_AS_USER);\n             }\n    +        ConfigValidation.validateFields(conf);\n     \n    -        List<String> seeds;\n    -        if(conf.containsKey(Config.NIMBUS_HOST)) {\n    +        List<String> seeds = Lists.newArrayList();\n    --- End diff --\n    \n    Isn't this list overwritten in both branches below?\n","created":"2017-07-20T19:48:09.804+0000","updated":"2017-07-20T19:48:09.804+0000","started":"2017-07-20T19:48:09.802+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48338","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48339","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    I'm a little confused why it doesn't work for you @ecararus. I added a bit to a Flux test to verify that it is possible to pass a list from a properties file into the Flux yaml file via FluxParser, both on master and 1.0.x. Does the diff at https://github.com/apache/storm/pull/2232 accurately reflect what your properties and yaml files contain?\n","created":"2017-07-20T19:52:48.768+0000","updated":"2017-07-20T19:52:48.768+0000","started":"2017-07-20T19:52:48.768+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48339","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48340","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2228#discussion_r128616112\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/NimbusClient.java ---\n    @@ -107,13 +109,14 @@ public static NimbusClient getConfiguredClientAs(Map<String, Object> conf, Strin\n                 }\n                 asUser = (String) conf.get(Config.STORM_DO_AS_USER);\n             }\n    +        ConfigValidation.validateFields(conf);\n     \n    -        List<String> seeds;\n    -        if(conf.containsKey(Config.NIMBUS_HOST)) {\n    +        List<String> seeds = Lists.newArrayList();\n    --- End diff --\n    \n    By default seeds will be empty and will be populated only if NIMBUS_HOST or NIMBUS_SEEDS will be configured. in case if both missing an exception will [be thrown here](https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/utils/NimbusClient.java#L153).\n\n","created":"2017-07-20T19:58:47.068+0000","updated":"2017-07-20T19:58:47.068+0000","started":"2017-07-20T19:58:47.067+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48340","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    @revans2 This pr will not fully fix my issue however i will not get anymore class cast exception. validation will fail according to [annotation](https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/Config.java#L1059) and [ConfigValidator](https://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/validation/ConfigValidation.java#L657)\n","created":"2017-07-20T20:06:52.776+0000","updated":"2017-07-20T20:06:52.776+0000","started":"2017-07-20T20:06:52.775+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48341","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48342","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user srdo commented on a diff in the pull request:\n\n    https://github.com/apache/storm/pull/2228#discussion_r128617905\n  \n    --- Diff: storm-client/src/jvm/org/apache/storm/utils/NimbusClient.java ---\n    @@ -107,13 +109,14 @@ public static NimbusClient getConfiguredClientAs(Map<String, Object> conf, Strin\n                 }\n                 asUser = (String) conf.get(Config.STORM_DO_AS_USER);\n             }\n    +        ConfigValidation.validateFields(conf);\n     \n    -        List<String> seeds;\n    -        if(conf.containsKey(Config.NIMBUS_HOST)) {\n    +        List<String> seeds = Lists.newArrayList();\n    --- End diff --\n    \n    Sorry, totally spaced and missed the change to L119 :)\n","created":"2017-07-20T20:07:38.907+0000","updated":"2017-07-20T20:07:38.907+0000","started":"2017-07-20T20:07:38.906+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48342","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user revans2 commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    @ecararus could you please take a look at https://github.com/revans2/incubator-storm/commit/0978338c7dd7ec23b035abb5f70ce088064bf60b\n    \n    A lot of it you can ignore, but I added in a test on top of this patch into flux-core that shows that `nimbus.seeds` works (if you set it properly in your properties file).\n    \n    Specifically the properties file needs to have in it\n    \n    ```\n    nimbus.seeds: [\"HOST\"]\n    ```\n    \n    and not\n    \n    ```\n    nimbus.seeds: \"HOST\"\n    ```\n    \n    When I change it to the latter the test fails with an exception of \n    ```\n    java.lang.IllegalArgumentException: Field NIMBUS_SEEDS must be an Iterable but was a class java.lang.String\n    \tat org.apache.storm.validation.ConfigValidationUtils$2.validateField(ConfigValidationUtils.java:125)\n    \tat org.apache.storm.validation.ConfigValidationUtils$NestableFieldValidator.validateField(ConfigValidationUtils.java:48)\n    \tat org.apache.storm.validation.ConfigValidation$ListEntryTypeValidator.validateField(ConfigValidation.java:311)\n    \tat org.apache.storm.validation.ConfigValidation$ListEntryTypeValidator.validateField(ConfigValidation.java:306)\n    \tat org.apache.storm.validation.ConfigValidation.validateField(ConfigValidation.java:697)\n    \tat org.apache.storm.validation.ConfigValidation.validateFields(ConfigValidation.java:750)\n    \tat org.apache.storm.validation.ConfigValidation.validateFields(ConfigValidation.java:711)\n    \tat org.apache.storm.flux.parser.FluxParserTest.testCofigParamListParser(FluxParserTest.java:43)\n    ```\n","created":"2017-07-21T20:05:48.207+0000","updated":"2017-07-21T20:05:48.207+0000","started":"2017-07-21T20:05:48.207+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48426","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48442","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus commented on the issue:\n\n    https://github.com/apache/storm/pull/2228\n  \n    Hello all \n    Thanks for advice i found the issue and fixed, i would like to apologize for misleading by pointing on FluxParser(however propertied.get(key) is returning string thanks to Yaml.load nimbus.seeds is transformed to a list).  I'm using [storm-maven-plugin](https://github.com/hubrick/storm-maven-plugin) so the issue was there i'm calling NimbusClient by passing config as:\n    ```\n                    in = new FileInputStream(properiesFileLocation);\n                    Properties prop = new Properties();\n                    prop.load(in);\n                    return config.putAll(prop);\n    ```\n    \n    I think we can close current issue and apply validation before usage of configuration.\n    Thanks everybody for help.\n","created":"2017-07-21T21:00:29.190+0000","updated":"2017-07-21T21:00:29.190+0000","started":"2017-07-21T21:00:29.189+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48442","issueId":"13088563"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13088563/worklog/48518","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user ecararus closed the pull request at:\n\n    https://github.com/apache/storm/pull/2228\n","created":"2017-07-24T10:09:53.045+0000","updated":"2017-07-24T10:09:53.045+0000","started":"2017-07-24T10:09:53.043+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"48518","issueId":"13088563"}]},"customfield_12311820":"0|i3hrlj:"}}