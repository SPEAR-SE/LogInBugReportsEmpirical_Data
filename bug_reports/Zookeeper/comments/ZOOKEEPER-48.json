[The last patch did not throw an exception if AUTH_ID was used on a non authenticated connection and there were other Ids in the list. The patch fixes the issue adds a test to verify and also fixes some overly severe logging problems., Since the fix for this issue overlaps with ZOOKEEPER-49 and since the fix and test for ZOOKEEPER-49 are so trival, I've included them in this patch., I reviewed the patch, great to see that we are adding a test for this. ;-)

Some comments:
1) if attached patch3 supersedes patch 2 please remove 2.
2) could you add documentation for "fixupACL" method? there's quite a bit going on in that method and it's not really clear what the contract is.
3) line 409 (fixupacl method) logs error for "missing authenciation provider...", is this really an error? (no exception thrown as a result...) should we be notifying the client in this case (might help with client side debugging. Perhaps a new jira for this?
4) line 65 preprequestprocessor.java, could we log an INFO message here that states that acl checking is being skipped (might help w/debugging down the road).
, 1) done
2) will do once we have a repository to check into so that I can construct a proper patch
3) we should probably open a new jira. I'm not really sure what the correct behavior is...
4) this would create a large number of messages in the log. I would think we would only log it once at startup.
, 4) this line is in the static initializer for the class - so it will typically be called once per run of the vm, Oh right. Sorry, I wasn't looking at the line number close enough. I'll fix 4) as well in the next patch. , Ben what's the status on this one? Is it ready for review or further work needs to be done?, Added documentation to fixupACL and added an INFO message if ACLs are skipped., Committed revision 681465., Integrated in ZooKeeper-trunk #42 (See [http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/42/]), 3.0.0 has been released, closing issues.]