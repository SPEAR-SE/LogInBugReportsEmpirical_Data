[We had this issue completely take down our 5-node cluster last night. After digging around we found that the culprit. It's a snapshot that started with nodes /A/B/C present. Before it got to B, both B and C got removed. So, the snapshot contains only /A, but the txn log starts with "delete C". When it replays the log, it tries to increment the cversion of the parent, which is /A/B. It isn't present in the snapshot and the recovery crashes.

This issue seems to have been fixed on trunk. I guess we'd just have to upgrade., Is this JIRA related to ZOOKEEPER-1573? I think they are duplicate.]