[This patch seems to break some other tests.  I will look into it some more, but would appreciate feedback on this issue in the meantime.]