[this patch fixes the issue by adding a thread that does the snapshots in syncrequestprocessor., +1 I can't believe we missed this! I think we should do a 3.0.1 release to get this out soon. This will cause big problems with big databases!, yeah this was a big mistake on my side!! , This test checks for the problem that reported by this issue. I checked that the test fails before Mahadev's patch and passes after., this patch includes the original fix and ben's test with some minor formatting changes., committed to 718434 in 3.0  and 718433 in trunk.

thanks ben

, Integrated in ZooKeeper-trunk #149 (See [http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/149/])
    ]