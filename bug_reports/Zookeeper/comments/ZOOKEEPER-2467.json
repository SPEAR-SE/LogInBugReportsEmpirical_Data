[will provide patch for this., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12817025/ZOOKEEPER-2467.patch
  against trunk revision 1750739.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3269//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3269//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3269//console

This message is automatically generated., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12821299/ZOOKEEPER-2467.patch
  against trunk revision 1754582.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3313//console

This message is automatically generated., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12821299/ZOOKEEPER-2467.patch
  against trunk revision 1754582.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3314//console

This message is automatically generated., Thanks [~joshi.shankar], the change makes sense. I'm wondering if in the test case would be better to try/catch any exception that comes across and fail the test rather than let the exception bubble up., will do it.. Thanks :), -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12821348/ZOOKEEPER-2467-1.patch
  against trunk revision 1754582.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3316//console

This message is automatically generated., +1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12821354/ZOOKEEPER-2467-final.patch
  against trunk revision 1754582.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3317//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3317//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3317//console

This message is automatically generated., Thanks for the updated patch, [~joshi.shankar]. I have a few comments, though:

# The format seems to be broken, the try/catch block doesn't have the right indentation.
# {{testCliCommandsNotEchoingUsage}} is not the best method to include this test. We aren't testing whether redo is echoing usage, but instead that it isn't throwing an NPE with negative values. One suggestion is to have a test case called {{testRedoNegativeCmdNumber}} in the same class and add the redo test there.
# The test cases in the {{ZooKeeperTest}} class throw {{Exception}} so it is actually better that we do it to follow the pattern here. We should still fail in the case it throws an exception, but instead of swallowing it, I suggest we rethrow. 
# We might consider adding an implementation of {{RedoCommand}} that extends {{CliCommand}} to be able to check the output, like in {{testSortedLs()}}.

Here is roughly how it should look like:

{noformat}
   @Test
    public void testRedoNegativeCmdNumber() throws Exception {
       try {
           String cmd = "redo -1";
           zkMain.executeLine(cmd);
           // check that the output matches
           ...
       } (Exception e) {
           fail("Failed to excute redo command with negative number");
           throw e;
       }
    }
{noformat}  , Canceling to sort out comments and suggestions., Pls review, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12831939/ZOOKEEPER-2467.patch
  against trunk revision 8d0154bcc21e58b6166eb5e360f72ce37699e072.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3467//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3467//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3467//console

This message is automatically generated., Thanks [~rakeshsingh] for your interest and taking this ahead. Would you mind reading [Flavio's comments|https://issues.apache.org/jira/browse/ZOOKEEPER-2467?focusedCommentId=15402711&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15402711] and addressing the same., Thanks Joshi for this issue, as i had offline discussion with you i am taking this issue forward for complete., [~rakeshr] i have covered 3 suggestions mentioned by Flavio Junqueira but i feel 4th point is not valid. As redo command is not any specific (separate) command but calling other commands and hence it calls the corresponding exec() implementation and we may not be able to define any sepefic exec() implementation for redo command., Hi [~fpj], i have covered 3 suggestions mentioned by you but i think 4th point may not be valid. As redo command is not any specific (separate) command but calling other commands and hence it calls the corresponding exec() implementation and we may not be able to define any sepefic exec() implementation for redo command. Pls input your feedback. Thanks, bq. //ZOOKEEPER-2587/ZOOKEEPER-2467 : Not handled negative scenario for redo command

Refer only to ZOOKEEPER-2467, please. Also, say instead something like "Testing negative number for redo command".

bq. catch(Exception e)

Don't catch an exception generically, only the one you're testing for and let the others bubble up if any.

Indentation and formating in general are broken, please review it., Like [~fpj] mentioned earlier, it is good to assert the output/error message. One idea is to redirect the err stream something similar to {{ZooKeeperTest#testCliCommandsNotEchoingUsage}}.

How about something like,
{code}

    // ZOOKEEPER-2467 : Testing negative number for redo command
    @Test
    public void testCliCommandHandleNegativeScenarioForRedoCmd()
            throws Exception {
        final ZooKeeper zk = createClient();
        ZooKeeperMain zkMain = new ZooKeeperMain(zk);
        String cmd1 = "redo -1";

        // setup redirect out/err streams to get System.in/err, use this
        // judiciously!
        final PrintStream systemErr = System.err; // get current err
        final ByteArrayOutputStream errContent = new ByteArrayOutputStream();
        System.setErr(new PrintStream(errContent));
        try {
            zkMain.executeLine(cmd1);
            Assert.assertEquals("Command index out of range",
                    errContent.toString().trim());
        } finally {
            // revert redirect of out/err streams - important step!
            System.setErr(systemErr);
        }
    }
{code}, Uploading patch. Pls review and submit if fine., Thanks Rakesh., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12833310/ZOOKEEPER-2467.patch
  against trunk revision f78061aafb19b102c37cb6d744ec6258d5f5b66e.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3490//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3490//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3490//console

This message is automatically generated., Thanks [~rakeshkumarsingh]. +1, latest patch looks good to me.

I will wait one more day to see any comments from others and commit this during weekend., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12833640/ZOOKEEPER-2467.patch
  against trunk revision 422058c222a8a31ec7cfd4113fbdc036181f751d.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 4 new or modified tests.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3491//console

This message is automatically generated., Thanks [~fpj] for the reviews.
Thanks [~rakeshsingh], [~joshi.shankar] for the contribution.

Branch 3.4: Committed git revision a601b032915e85a5f693e7ef247700fefb950a12.
Branch 3.5: Committed git revision 3cd87f06911c6fd806364bf46ae074e7c6096452.
Trunk: Committed git revision 422058c222a8a31ec7cfd4113fbdc036181f751d.
, Attached committed patches to the jira. Following are the modifictions.

* Test case is renamed to {{testRedoWithNegativeCmdNumber}}
* Used {{System.setOut()}} in branch3-4 patch, SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #3121 (See [https://builds.apache.org/job/ZooKeeper-trunk/3121/])
ZOOKEEPER-2467: NullPointerException when redo Command is passed (rakeshr: rev 422058c222a8a31ec7cfd4113fbdc036181f751d)
* (edit) CHANGES.txt
* (edit) src/java/main/org/apache/zookeeper/ZooKeeperMain.java
* (edit) src/java/test/org/apache/zookeeper/ZooKeeperTest.java
]