[Patch to quote relevant ObjectName values., modified tom's patch a bit:

1) only quote if the addr is an ipv6 addr
2) I don't think getclientport needs to be quoted (ie values) -- otw thinks like the time/date stamp would also fail (removed this from my patch)
3) removed the printstacktrace calls in mbeanregistry - replaced with proper error handling/logging.
, oops - the latest patch is ZOOKEEPER-302.patch (all caps version) be sure to review that one not the orig (all lower)
, +1 looks good. i have one small suggestion: in the early part of the patch you log some problem when you catch an exception, would it be good to log the exception?, the extra log/rethrow is just there because sun messed up on malformedobjectnameexceptin - they don't include the name that was malformed, which makes debugging hard.

So -- I log then rethrow, the calling code will actually log the exception and then handle in some way - this log is just for context when reviewing the log.

I could have wrapped the exception with another, but I didn't want to do that for this patch... I think we really need to take a hard look at this mbeanregistry stuff anyway, it will probably go away in the end...
, +1  for the patch .... passes the tests... , The patch looks alright to me.

It passes our unit tests, but we start the server programmatically and we don't use JMX, so I don't know how much my vote counts., thanks stu - just good to hear I didn't break anything. ;-)
, +1

The patch works for me., I just committed this. Thanks tom and pat., Integrated in ZooKeeper-trunk #222 (See [http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/222/])
    . Quote values in JMX objectnames. (tom and pat via mahadev)
]