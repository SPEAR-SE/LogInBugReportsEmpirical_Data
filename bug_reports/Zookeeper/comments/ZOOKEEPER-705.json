[x, should we try getting this into 3.3?  (seems like a harmless change thought needs more testing on all the OS's)..... 

, where did __sync_fetch_and_add come from? i'm wondering if it works with cygwin., Not a  blocker for 3.3.0, let's push to 3.4.0 and ensure it works everywhere (etc), Not a blocker for 3.4., __sync_fetch_and_add is a gcc built-in function.
I think it was added in somewhere in gcc 4.1.
, fixed in ZOOKEEPER-1643, This affects also 3.4.5
I'm building zookeeper in Debian 7.8 on sparc and this was a blocking. Once applied this patch, the build was successful., This has been fixed in 3.4.11.]