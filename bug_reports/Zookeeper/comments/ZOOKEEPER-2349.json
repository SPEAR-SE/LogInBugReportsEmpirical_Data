[GitHub user maoling opened a pull request:

    https://github.com/apache/zookeeper/pull/349

    ZOOKEEPER-2349:Update documentation for snapCount

    Origin patch can not apply now and it has something inaccurate.so I give it a new PR.
    more details in [JIRA](https://issues.apache.org/jira/browse/ZOOKEEPER-2349)

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/maoling/zookeeper ZOOKEEPER-2349

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/zookeeper/pull/349.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #349
    
----
commit 29aa87863d6a5de3886c324ecd50b4f960d100b2
Author: maoling <maoling199210191@sina.com>
Date:   2017-08-25T01:13:28Z

    ZOOKEEPER-2349:Update documentation for snapCount

----
, -1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +0 tests included.  The patch appears to be a documentation patch that doesn't require tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/977//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/977//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/977//console

This message is automatically generated., Github user afine commented on a diff in the pull request:

    https://github.com/apache/zookeeper/pull/349#discussion_r135338802
  
    --- Diff: src/docs/src/documentation/content/xdocs/zookeeperAdmin.xml ---
    @@ -823,10 +823,10 @@ server.3=zoo3:2888:3888</programlisting>
                   role="bold">zookeeper.snapCount</emphasis>)</para>
     
                   <para>ZooKeeper logs transactions to a transaction
    -              log. After snapCount transactions are written to a log
    -              file a snapshot is started and a new transaction log
    -              file is created. The default snapCount is
    -              100,000.</para>
    +              log. After the count of transactions which are written to a log
    +              file exceed a runtime-set limit in [snapCount/2, snapCount),a snapshot 
    --- End diff --
    
    I think this is an excellent documentation improvement, but we still may be able to phrase this in a clearer way. It may be good to reiterate that ZooKeeper writes to a transaction log between snapshotting here, so the reader understands the purpose of the snapCount.
    
    Perhaps something like:
    
    > ZooKeeper records its transactions using snapshots and a transaction log (think write-ahead log). The number of transactions recorded in the transaction log before a snapshot can be taken (and the transaction log rolled) is determined by snapCount. In order to prevent all of the machines in the quorum from taking a snapshot at the same time, each ZooKeeper server will take a snapshot when the number of transactions in the transaction log reaches a runtime generated random value in the [snapCount/2, snapCount) range.
, Github user maoling commented on a diff in the pull request:

    https://github.com/apache/zookeeper/pull/349#discussion_r135400691
  
    --- Diff: src/docs/src/documentation/content/xdocs/zookeeperAdmin.xml ---
    @@ -823,10 +823,10 @@ server.3=zoo3:2888:3888</programlisting>
                   role="bold">zookeeper.snapCount</emphasis>)</para>
     
                   <para>ZooKeeper logs transactions to a transaction
    -              log. After snapCount transactions are written to a log
    -              file a snapshot is started and a new transaction log
    -              file is created. The default snapCount is
    -              100,000.</para>
    +              log. After the count of transactions which are written to a log
    +              file exceed a runtime-set limit in [snapCount/2, snapCount),a snapshot 
    --- End diff --
    
    - awesome suggestions. especially emphasizing the purpose of this snapshot strategy is to  prevent all of the machines in the quorum from taking a snapshot at the same time
    - done
, +1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +0 tests included.  The patch appears to be a documentation patch that doesn't require tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/978//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/978//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/978//console

This message is automatically generated., Issue resolved by pull request 349
[https://github.com/apache/zookeeper/pull/349], Github user asfgit closed the pull request at:

    https://github.com/apache/zookeeper/pull/349
, Github user hanm commented on the issue:

    https://github.com/apache/zookeeper/pull/349
  
    Committed to master 563f892da0e03e23715bddf236b10582bd51e429, 
    branch-3.5 4051b38bd691c105b6e2b29463d2c5ef4420e4dc,
    branch-3.4 574a94dafd9238e74d36d41c8b37388717d32d28
, SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #3532 (See [https://builds.apache.org/job/ZooKeeper-trunk/3532/])
ZOOKEEPER-2349: Update documentation for snapCount (hanm: rev 563f892da0e03e23715bddf236b10582bd51e429)
* (edit) src/docs/src/documentation/content/xdocs/zookeeperAdmin.xml
]