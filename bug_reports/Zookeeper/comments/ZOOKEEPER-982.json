[Hi Bjørn, would you mind creating a patch for this? The process is pretty straightforward (svn checkout, edit, svn diff, upload patch). See this
https://cwiki.apache.org/confluence/display/ZOOKEEPER/HowToContribute

Thanks!
, It may very well be possible, that the bug is only in the shell scripts of the ZooKeeper Debian/Ubuntu package.
Bjørn wrote me about this bug and mentioned that he uses this package.

I should remove the bin/zkServer.sh from the Debian package. On Debian you should start/stop zookeeper like all daemons with /etc/init.d/zookeeper start|stop., (same errors on pristine as patched trunk: They don't seem related to the patch.
/home/rmz/svn/zookeeper-trunk/build.xml:930: The following error occurred while executing this line:
/home/rmz/svn/zookeeper-trunk/build.xml:841: Tests failed!
), More information would be helpful - what test failed? I'd suggest running with output redirected to a file, then attach to this jira.

Perhaps there is a zombie zk server hanginging around? Check ps output. (a previous test may have failed to shutdown the server?), This bug seems to be, as Thomas Koch said, Debian/Ubuntu specific.

I filed a report and patch for this to Debian BTS:

http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=650882

I think this ticket may be closed as Invalid.]