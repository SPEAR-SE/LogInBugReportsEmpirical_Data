[I have access to windows build environment. Let me take care of this., ... and let me know if anybody knows which header defines INET_ADDRSTRLEN in windows., Thank you Michi, I have no access to a windows build environment so I've not been able to look into this.  I can't answer your question about INET_ADDRSTRLEN either, sorry. Worst case do an equivalent of a grep on the windows include directory? Good luck..., With this patch, the c client compiled on windows 7 / visual c++ 2010., thanks Michi!, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12562010/ZOOKEEPER-1597.patch
  against trunk revision 1424336.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1316//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1316//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1316//console

This message is automatically generated., No new tests added because this patch just fixes compilation errors., Committed to trunk. Thanks Michi!, Sorry, spoke too soon, seems to be a linker issue now. Michi?

https://builds.apache.org/view/S-Z/view/ZooKeeper/job/ZooKeeper-trunk-WinVS2008/636/console

{noformat}
"f:\hudson\hudson-slave\workspace\ZooKeeper-trunk-WinVS2008\trunk\src\c\zookeeper.sln" (default target) (1) ->
(zookeeper target) -> 
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_free referenced in function _resolve_hosts
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_shuffle referenced in function _resolve_hosts
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_append_addrinfo referenced in function _resolve_hosts
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_grow_default referenced in function _resolve_hosts
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_alloc_capacity referenced in function _resolve_hosts
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_init referenced in function _resolve_hosts
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_append referenced in function _update_addrs
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_contains referenced in function _update_addrs
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_eq referenced in function _update_addrs
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_next referenced in function _zoo_cycle_next_server
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_hasnext referenced in function _get_next_server_in_reconfig
  zookeeper.obj : error LNK2019: unresolved external symbol _addrvec_atend referenced in function _handle_error
  Release\zookeeper.dll : fatal error LNK1120: 12 unresolved externals

    34 Warning(s)
    13 Error(s)
{noformat}, Integrated in ZooKeeper-trunk #1780 (See [https://builds.apache.org/job/ZooKeeper-trunk/1780/])
    ZOOKEEPER-1597. Windows build failing (michim via phunt) (Revision 1425215)

     Result = SUCCESS
phunt : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1425215
Files : 
* /zookeeper/trunk/CHANGES.txt
* /zookeeper/trunk/src/c/src/addrvec.c
* /zookeeper/trunk/src/c/src/addrvec.h
* /zookeeper/trunk/src/c/src/winport.c
* /zookeeper/trunk/src/c/src/winport.h
* /zookeeper/trunk/src/c/src/zookeeper.c
, - The project file names changed from [Cli,zookeeper].vcproj to [Cli,zookeeper].vcxproj because of the format change in visual c++ 2010. The build is failing because I forgot to add these .vcxproj files to the patch.
- If you apply the patch with "patch -p0 < ZOOKEEPER-1597.patch", you also need to do "svn rm --force Cli.vcproj zookeeper.vcproj". Alternatively, you can do "svn patch ZOOKEEPER-1597.patch" if you are running svn 1.7.
- Some files contain tab characters, but I left them as is since these files are auto-generated by visual studio., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12562553/ZOOKEEPER-1597.patch
  against trunk revision 1425215.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    -1 release audit.  The applied patch generated 26 release audit warnings (more than the trunk's current 24 warnings).

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1317//testReport/
Release audit warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1317//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1317//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1317//console

This message is automatically generated., The audit is complaining about Cli.vcxproj, zookeeper.vcxproj, and winstdint.h missing the apache license header. I think it makes sense to add the header to winstdint.h, but I'm not sure if the *.vcxproj files need the header., This patch is ready for review.

--Michi, Thanks Michi, committed to trunk., Looks like there's a small issue, from apache jenkins:

{noformat}
Build started 1/25/2013 6:35:14 AM.
Project "f:\hudson\hudson-slave\workspace\ZooKeeper-trunk-WinVS2008\trunk\src\c\zookeeper.sln" on node 0 (default targets).
  Building solution configuration "Release|Win32".
f:\hudson\hudson-slave\workspace\ZooKeeper-trunk-WinVS2008\trunk\src\c\zookeeper.vcxproj(3,14): error MSB4066: The attribute "Label" in element <ItemGroup> is unrecognized.
Done Building Project "f:\hudson\hudson-slave\workspace\ZooKeeper-trunk-WinVS2008\trunk\src\c\zookeeper.sln" (default targets) -- FAILED.

Build FAILED.
{noformat}, It looks like a compatibility issue between visual c++ 2008 and 2010. I'll regenerate the project file using 2008. Sorry about that.

--Michi, Hi [~michim], any update on this? Can you regenerate the files and I'll give it a try?, Sorry for the delay Pat. Here is the patch. I verified that the project builds with visual studio 2008., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12570011/ZOOKEEPER-1597.patch
  against trunk revision 1447621.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1397//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1397//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1397//console

This message is automatically generated., Integrated in ZooKeeper-trunk #1840 (See [https://builds.apache.org/job/ZooKeeper-trunk/1840/])
    ZOOKEEPER-1597. Windows build failing (michim via phunt) part 3 (Revision 1447982)

     Result = SUCCESS
phunt : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1447982
Files : 
* /zookeeper/trunk/src/c/Cli.vcproj
* /zookeeper/trunk/src/c/Cli.vcxproj
* /zookeeper/trunk/src/c/zookeeper.sln
* /zookeeper/trunk/src/c/zookeeper.vcproj
* /zookeeper/trunk/src/c/zookeeper.vcxproj
, The jenkins build is working again. thanks Michi., hey michi, I was wondering if it makes sense to backport this patch for the 3.4 branch. I can't even open the solution with visual studio. what do you think?, Yes let's do that. I'll generate a patch for the 3.4 branch., hey michi, any progress here?, ... sorry I forgot about this. I'll take care of this soon.

By the way, there are 2 windows builds for trunk (ZooKeeper-trunk-WinVS2008 and ZooKeeper-trunk-WinVS2008_java). ZooKeeper-trunk-WinVS2008 is passing but ZooKeeper-trunk-WinVS2008_java is failing.
For 3.4 branch there is only one windows build: ZooKeeper-3.4-WinVS2008_java. Does anybody know why there is no ZooKeeper-3.4-WinVS2008?, I couldn't simply cherry-pick the patches from trunk since the 3.4 branch uses an older configuration format. I need to spend a bit more time on this., bq. ZooKeeper-trunk-WinVS2008 is passing but ZooKeeper-trunk-WinVS2008_java is failing.

On my machine, it fails because recursiveDelete is not able to delete temporary txn log files. It looks like at least some tests fail for the same reason on ZooKeeper-trunk-WinVS2008_java. I don't know why we don't have a 3.4-WinVS2008 build.

bq. I couldn't simply cherry-pick the patches from trunk since the 3.4 branch uses an older configuration format. I need to spend a bit more time on this.

Thanks!, [~michim] any update on this? I don't know why we don't have comparable builds for 3.4/trunk but we should set them up once the existing ones are running clean. Thanks!, I haven't had time to fix this. I'll try to get this done this week., [~michim], do you think you can produce a patch for this soon? I think it would be really good to have this one in., Update the solution file format to visual studio 2008. Tested the patch locally by building the project using visual studio 2008., Current build failure looks a java test failure. This patch probably won't fix the build failure.

https://builds.apache.org/job/ZooKeeper-3.4-WinVS2008_java/324/console, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12608334/ZOOKEEPER-1597-3.4.patch
  against trunk revision 1531444.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1693//console

This message is automatically generated., How do I tell buildbot that this patch is for 3.4 branch?, I don't know of a way of doing it, it would be nice if we could, though., Not supported. Just commit the change and we'll roll the dice. ;-), +1, thanks, Michi., Thanks a lot, [~michim]! Branch 3.4 Committed revision 1542710., Closing issues after releasing 3.4.6.]