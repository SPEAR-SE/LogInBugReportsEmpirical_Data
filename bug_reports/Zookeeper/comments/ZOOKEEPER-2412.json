[[~Yongcheng] Thanks for reporting this issue. Can you help me understand a bit better what's going on here?

From the logs you posted, there is a leader and it throws an OOO exception and exits. Another leader is elected and this leader starts behaving erratically, e.g., not incrementing the last zxid. Is that what is going on?

Note that the value of peerLastZxid also does not seem to change, which is odd. 
, Thank you for your response. This issue is the same as https://issues.apache.org/jira/browse/ZOOKEEPER-2201.
I will close this issue. we find so many LearnHandle thread for the same follower in Leader. I think just one LearnHandle thread for one follower in normal condition, but in network anomaly(such as:Network packet loss 16%). We made an optimized modification. when new create LearnHandle thread for followerï¼Œmake sure that the previous LearnHandle thread  has been removed. I think it will get better., the same as https://issues.apache.org/jira/browse/ZOOKEEPER-2201]