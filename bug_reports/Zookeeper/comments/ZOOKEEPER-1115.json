[Hi, guys. After follower get synced with leader, we will call zk.takeSnapshot in communication thread in Learner.java. And this is a function may block. In my case, it takes about 4 seconds to finish the snap. During this period, follower would not ack leader, and leader would thought that something happend to this follower, and close the connection with this follower. After that the follower will receive a broken pipe exception, and it will retry after that. Of cause it will fail time after time.
I think it is a problem.
thanks, Hi Helei, Have you tried increasing the value of initLimit? Check options here:

http://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html, Hi Flavio, this does not help. When the follower took a long time to do a snap, the leader would timeout and then close the connection. I think the problem is here:
     Leader.java: 237   s.setSoTimeout(self.tickTime * self.syncLimit);
After this time, Leader would close the connection. And follower would receive a broken pipe error.

Thanks, What about increasing syncLimit?, Hmm, of cause it works. But I really don't think that's the right way... It obviously harm the performance. We have to limit the node number, or the leader will be the single point. But that's OK, it surely works this time. Thanks again., Is this addressed in ZOOKEEPER-1521 ? i.e. you can set the initlimit higher to allow for longer initialization while not having to modify synclimit., [~fpj] thoughts? Should we close this?, I'm resolving this one as not a problem, given the discussion in the jira, and please feel free to reopen if needed. Also, note that this jira was created for the 3.3 branch, and we've been recommending that users move to the 3.4 branch.]