[Can someone look into this issue?, Hi [~bhavenamrata], thanks for reporting the issue.

Ubuntu 18.04 is quite recent, I have some doubts about anyone has ever tried to to build ZooKeeper C++ unit tests since it's out, but given that it's an LTS release, we should start looking into it.

The error message is complaing about AM_PATH_CPPUNIT macro is missing. Have you installed any *cppunit* related package?

Is there a cppunit package available in Ubuntu 18.04 at all? I think it's quite an old tool and not actively maintained, maybe it has been removed from the distro., Sorry, I missed your apt-get command.

So, libcppunit-dev is available and installed, maybe it's just the build process who's unable to find it and can be fixed by symlinking it to the right place. Need to look into it deeper., [~andorm], the error is due to missing cppunit.m4 file. It was present in Ubuntu 16.04 but seems to be missing in Ubuntu 18.04.

Is Zookeeper supported on Ubuntu 18.04 as of now?, [~bhavenamrata] No, unfortunately we still don't support Ubuntu 18.04 officially. However, that was a good catch actually. I wonder how we could get round this problem, cppunit is an essential part of C++ testing code currently.

One thing you could potentially try is to compare the recent package version with the one in 16.04 and if it's reasonable get a copy of the missing file from the older package., [~bhavenamrata] Please verify my patch [https://github.com/apache/zookeeper/pull/528]

I wonder if we need to polish it any further or it'd be just enough to support 18.04., +1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +0 tests included.  The patch appears to be a documentation patch that doesn't require tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1730//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1730//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1730//console

This message is automatically generated., [~andorm], verified your patch. Build/tests completed.

Looks like its good enough for Ubuntu 18.04.

 

Thank you for the help :), [~bhavenamrata] No probs.

Are u able to compile and run tests on Ubuntu 18.04? I got the following error message:

 
{noformat}
[exec] /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I/home/andor/git/my-zookeeper/src/c -I/home/andor/git/my-zookeeper/src/c/include -I/home/andor/git/my-zookeeper/src/c/tests -I/home/andor/git/my-zookeeper/src/c/generated -Wall -Werror -Wdeclaration-after-statement -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c -o zookeeper.lo `test -f 'src/zookeeper.c' || echo '/home/andor/git/my-zookeeper/src/c/'`src/zookeeper.c
[exec] /home/andor/git/my-zookeeper/src/c/src/zookeeper.c: In function ‘print_completion_queue’:
[exec] /home/andor/git/my-zookeeper/src/c/src/zookeeper.c:2530:5: error: null argument where non-null required (argument 1) [-Werror=nonnull]
[exec] fprintf(LOGSTREAM,"Completion queue: ");
[exec] ^~~~~~~
[exec] /home/andor/git/my-zookeeper/src/c/src/zookeeper.c:2532:9: error: null argument where non-null required (argument 1) [-Werror=nonnull]
[exec] fprintf(LOGSTREAM,"empty\n");
[exec] ^~~~~~~
[exec] /home/andor/git/my-zookeeper/src/c/src/zookeeper.c:2538:9: error: null argument where non-null required (argument 1) [-Werror=nonnull]
[exec] fprintf(LOGSTREAM,"%d,",cptr->xid);
[exec] ^~~~~~~
[exec] /home/andor/git/my-zookeeper/src/c/src/zookeeper.c:2541:5: error: null argument where non-null required (argument 1) [-Werror=nonnull]
[exec] fprintf(LOGSTREAM,"end\n");
[exec] ^~~~~~~
[exec] libtool: compile: gcc -DHAVE_CONFIG_H -I. -I/home/andor/git/my-zookeeper/src/c -I/home/andor/git/my-zookeeper/src/c/include -I/home/andor/git/my-zookeeper/src/c/tests -I/home/andor/git/my-zookeeper/src/c/generated -Wall -Werror -Wdeclaration-after-statement -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c /home/andor/git/my-zookeeper/src/c/src/zookeeper.c -fPIC -DPIC -o .libs/zookeeper.o
[exec] Makefile:1030: recipe for target 'zookeeper.lo' failed
[exec] cc1: all warnings being treated as errors
[exec] make: *** [zookeeper.lo] Error 1
{noformat}
{panel:title=GCC version}
$ gcc --version
gcc (Ubuntu 7.3.0-16ubuntu3) 7.3.0
{panel}
Looks like there's some additional plumbing work needed to fully support 18.04

 , [~andorm], I had tried your patch from PR in older version of Zookeeper(3.4.11, which is the version of my interest) where it worked. I can try it out on master once.

 , [~bhavenamrata] That would be useful, thanks. I'm working on the master branch at the first place., -1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 1 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1753//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1753//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1753//console

This message is automatically generated., +1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 1 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1754//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1754//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1754//console

This message is automatically generated., Master failing for me too :
{quote}{{$ make}}
{{make  all-am}}
{{make[1]: Entering directory '/root/zoo_master/zookeeper/src/c'}}
{{/bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I./include -I./tests -I./generated   -Wall -Werror -Wdeclaration-after-statement -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c -o zookeeper.lo `test -f 'src/zookeeper.c' || echo './'`src/zookeeper.c}}
{{libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I./include -I./tests -I./generated -Wall -Werror -Wdeclaration-after-statement -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c src/zookeeper.c  -fPIC -DPIC -o .libs/zookeeper.o}}
{{src/zookeeper.c: In function 'print_completion_queue':}}
{{src/zookeeper.c:2530:5: error: null argument where non-null required (argument 1) [-Werror=nonnull]}}
{{     fprintf(LOGSTREAM,"Completion queue: ");}}
{{     ^~~~~~~}}
{{src/zookeeper.c:2532:9: error: null argument where non-null required (argument 1) [-Werror=nonnull]}}
{{         fprintf(LOGSTREAM,"empty\n");}}
{{         ^~~~~~~}}
{{src/zookeeper.c:2538:9: error: null argument where non-null required (argument 1) [-Werror=nonnull]}}
{{         fprintf(LOGSTREAM,"%d,",cptr->xid);}}
{{         ^~~~~~~}}
{{src/zookeeper.c:2541:5: error: null argument where non-null required (argument 1) [-Werror=nonnull]}}
{{     fprintf(LOGSTREAM,"end\n");}}
{{     ^~~~~~~}}
{{cc1: all warnings being treated as errors}}
{{Makefile:1026: recipe for target 'zookeeper.lo' failed}}
{{make[1]: *** [zookeeper.lo] Error 1}}
{{make[1]: Leaving directory '/root/zoo_master/zookeeper/src/c'}}
{{Makefile:685: recipe for target 'all' failed}}
{{make: *** [all] Error 2}}{quote}, +1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 1 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1767//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1767//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1767//console

This message is automatically generated., [~bhavenamrata]

I've verified that ZooKeeper C client can be built with CMake on Ubuntu 18.04. I successfully compiled and ran the C++ unit tests too.

As a consequence I close the pull request and this Jira as won't fix, because we don't need to maintain the legacy Autoconf.]