[Thanks for reporting this issue, [~spooky000]. Would you be interested in providing a patch?, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12820618/ZOOKEEPER-2490.patch
  against trunk revision 1754188.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3295//console

This message is automatically generated., Thanks for the patch, [~spooky000]. I'm not sure the fix in the patch is right, though. In zookeeper.c, for example, we cast in format_endpoint_info to either ipv4 and ipv6 format. There is also a separate block for win32. Should we consider having something similar in addrvec_contains?, Also, please use --no-prefix when generating the patch., I think you should. I only tested ipv4.

avec->data's size is ..
in addrvec_append_addrinfo 
memcpy(avec->data + avec->count, addrinfo->ai_addr, addrinfo->ai_addrlen);
in addrvec_contains
if(memcmp(&avec->data[i], addr, ???) == 0)

I think addrinfo->ai_addrlen and memcmp's 3rd parameter should be same size.

, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12820678/ZOOKEEPER-2490.patch
  against trunk revision 1754188.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3297//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3297//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3297//console

This message is automatically generated., fixed the indentation., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12820931/ZOOKEEPER-2490.patch
  against trunk revision 1754188.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    -1 contrib tests.  The patch failed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3306//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3306//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3306//console

This message is automatically generated., GitHub user thelordpsy opened a pull request:

    https://github.com/apache/zookeeper/pull/309

    ZOOKEEPER-2490: infinitely connect on windows

    Apply patch file from spooky000 for ZOOKEEPER-2490
    Resolves issue where memcmp always returns false in windows release builds

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/thelordpsy/zookeeper master

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/zookeeper/pull/309.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #309
    
----
commit 1ddad6f70ea85483c9807ba9f0e98ffa8d3f98eb
Author: Jeffrey Brill <jbrill@blizzard.com>
Date:   2017-07-13T17:57:01Z

    Apply patch file from spooky000 for ZOOKEEPER-2490
    Resolves issue where memcmp always returns false in windows release builds

----
, -1 overall.  GitHub Pull Request  Build
      

    +1 @author.  The patch does not contain any @author tags.

    +0 tests included.  The patch appears to be a documentation patch that doesn't require tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/881//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/881//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Console output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/881//console

This message is automatically generated.]