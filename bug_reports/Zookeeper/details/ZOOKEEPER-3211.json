{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13203610","self":"https://issues.apache.org/jira/rest/api/2/issue/13203610","key":"ZOOKEEPER-3211","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321883","id":"12321883","description":"Fix release against 3.4 branch","name":"3.4.5","archived":false,"released":true,"releaseDate":"2012-11-18"}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-12-11T10:48:58.760+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 26 17:03:23 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-3211/watchers","watchCount":5,"isWatching":false},"created":"2018-12-11T03:53:59.410+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"13.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":604800,"aggregatetimeoriginalestimate":604800,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321883","id":"12321883","description":"Fix release against 3.4 branch","name":"3.4.5","archived":false,"released":true,"releaseDate":"2012-11-18"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-12-26T17:03:23.943+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312382","id":"12312382","name":"server","description":"General issues with the ZooKeeper server."}],"timeoriginalestimate":604800,"description":"1.config--zoo.cfg\r\nserver.1=127.0.0.1:2902:2903\r\n2.kernel version\r\nversion：Linux localhost.localdomain 3.10.0-123.el7.x86_64 #1 SMP Tue Feb 12 19:44:50 EST 2019 x86_64 x86_64 x86_64 GNU/Linux\r\nJDK：\r\njava version \"1.7.0_181\"\r\nOpenJDK Runtime Environment (rhel-2.6.14.5.el7-x86_64 u181-b00)\r\nOpenJDK 64-Bit Server VM (build 24.181-b00, mixed mode)\r\nzk: 3.4.5\r\n3.bug details：\r\nOccasionally，But the recurrence probability is extremely high. At first, the read-write timeout takes about 6s, and after a few minutes, all connections (including long ones) will be CLOSE_WAIT state.\r\n\r\n4.:Circumvention scheme: it is found that all connections become close_wait to restart the zookeeper server side actively\r\n","customfield_10010":null,"timetracking":{"originalEstimate":"168h","remainingEstimate":"168h","originalEstimateSeconds":604800,"remainingEstimateSeconds":604800},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951311","id":"12951311","filename":"1.log","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-11T03:50:32.802+0000","size":7171,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12951311/1.log"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951616","id":"12951616","filename":"2018-12-09_124131.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:11.127+0000","size":15974,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951616/2018-12-09_124131.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951617","id":"12951617","filename":"2018-12-09_124210.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:06.617+0000","size":9993,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951617/2018-12-09_124210.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951618","id":"12951618","filename":"2018-12-09_132854.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:05.363+0000","size":12426,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951618/2018-12-09_132854.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951619","id":"12951619","filename":"2018-12-09_133017.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:04.388+0000","size":18851,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951619/2018-12-09_133017.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951620","id":"12951620","filename":"2018-12-09_133049.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:06.184+0000","size":50389,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951620/2018-12-09_133049.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951621","id":"12951621","filename":"2018-12-09_133111.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:08.170+0000","size":14558,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951621/2018-12-09_133111.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951622","id":"12951622","filename":"2018-12-09_133131.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:05.038+0000","size":16798,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951622/2018-12-09_133131.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951623","id":"12951623","filename":"2018-12-09_133150.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:07.309+0000","size":10483,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951623/2018-12-09_133150.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951624","id":"12951624","filename":"2018-12-09_133210.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:10.369+0000","size":13833,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951624/2018-12-09_133210.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951625","id":"12951625","filename":"2018-12-09_133229.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:08.950+0000","size":13546,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951625/2018-12-09_133229.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951626","id":"12951626","filename":"2018-12-09_133248.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:07.078+0000","size":14739,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951626/2018-12-09_133248.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12951627","id":"12951627","filename":"2018-12-09_133320.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:49:08.304+0000","size":12227,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12951627/2018-12-09_133320.png"}],"aggregatetimeestimate":604800,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"zookeeper standalone mode，found a high level bug in kernel of centos7.0 ，zookeeper Server's  tcp/ip socket connections(default 60 ) are CLOSE_WAIT ，this lead to zk can't work for client any more","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":604800,"percent":0},"customfield_12311024":null,"environment":"1.zoo.cfg\r\nserver.1=127.0.0.1:2902:2903\r\n2.kernel\r\nkernel：Linux localhost.localdomain 3.10.0-123.el7.x86_64 #1 SMP Tue Feb 12 19:44:50 EST 2019 x86_64 x86_64 x86_64 GNU/Linux\r\nJDK：\r\njava version \"1.7.0_181\"\r\nOpenJDK Runtime Environment (rhel-2.6.14.5.el7-x86_64 u181-b00)\r\nOpenJDK 64-Bit Server VM (build 24.181-b00, mixed mode)\r\nzk: 3.4.5","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":604800,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16716822","id":"16716822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"body":"[~yss] [~xiaoed]\r\n\r\nI appreciate the effort for reporting this issue, but the official language of this project is English. Would you please translate the description and comment accordingly?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"created":"2018-12-11T10:48:58.760+0000","updated":"2018-12-11T10:48:58.760+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16718641","id":"16718641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"body":"i've updated","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-12T09:02:15.684+0000","updated":"2018-12-12T09:02:15.684+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16718889","id":"16718889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maoling","name":"maoling","key":"maoling","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maoling&avatarId=32024","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maoling&avatarId=32024","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maoling&avatarId=32024","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maoling&avatarId=32024"},"displayName":"maoling","active":true,"timeZone":"Etc/UTC"},"body":"interesting,I will test this issue in my docker.\r\n[~yss] Do you have any more advances? Is it a issue about linux OS probably?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maoling","name":"maoling","key":"maoling","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maoling&avatarId=32024","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maoling&avatarId=32024","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maoling&avatarId=32024","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maoling&avatarId=32024"},"displayName":"maoling","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-12T12:04:04.481+0000","updated":"2018-12-12T12:04:04.481+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16719680","id":"16719680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"[~yss] Have you tried newer version of stable zookeeper release (e.g. 3.4.13), as well as different versions of OS? 3.4.5 is a pretty old version. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2018-12-13T02:30:32.491+0000","updated":"2018-12-13T02:30:32.491+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16719699","id":"16719699","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"body":"Given the 3.4.5 that has been used in the production environment, it is not realistic to upgrade to a higher version at present. Have similar defects been solved in 3.4.13?\r\n[~hanm]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T03:13:50.179+0000","updated":"2018-12-13T03:13:50.179+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16719703","id":"16719703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"body":"I have seen a futex bug in Linux on the Internet before. However, when there was a problem, no deadlock problem was found with jstack. At present, we have used zk 3.4.5 for 4-5 years, and this bug was encountered for the first time. However, this version of kernel has been upgraded to block related IO drivers. Does this cause CLOSE_WAIT for zk? It looks like zk Server is deadlocked\r\n[~maoling]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T03:18:11.178+0000","updated":"2018-12-13T03:18:11.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16719736","id":"16719736","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"{quote}Have similar defects been solved in 3.4.13?\r\n{quote}\r\nPreviously there were reports about CLOSE_WAIT, but if I remember correctly, most of those cases ended up no actions taken because it was hard to reproduce. \r\n{quote}It looks like zk Server is deadlocked\r\n{quote}\r\nThe thread dump in 1.log file indicates some threads are blocked, but that seems a symptom rather than the cause. If we run out available sockets then some zookeeper threads that involves file IO / socket IO will be blocked. \r\n\r\n \r\n{quote}Does this cause CLOSE_WAIT for zk?\r\n{quote}\r\nMost of time, long living CLOSE_WAIT connections indicate an application side bug instead of kernel bug - that the connection should be closed but for some reasons the application, after receiving TCP reset from clients can't close the connection - which effectively leaks connections. The upgrade of kernel could be a trigger though. \r\n\r\n \r\n\r\nI am interested to know if any other folks can reproduce this. I currently don't have the environment to reproduce this.\r\n\r\n \r\n\r\nAlso, [~yss] can you please use zip file instead of rar file for uploading log files? \r\n\r\nAnother thing to try is to increase your limit of open file descriptors - seems its currently set as 60? If you increase it (ulimit), you could end up still leaking connections but the server should be available before its running out of sockets.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2018-12-13T04:22:23.772+0000","updated":"2018-12-13T04:22:23.772+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16719845","id":"16719845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"body":"\r\n\r\n\r\n27/5000 \r\n\r\n\r\n \r\n\r\n \r\n\r\n\r\n\r\n\r\n\r\n*  increase your limit of open file descriptors \r\nThere are only a few clients on our side, so we do not provide the connection number specifically\r\n\r\n\r\nIf we repeat it here, what information or log should I provide to you for analysis\r\n[~hanm]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yss","name":"yss","key":"yss","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"yeshuangshuang","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-13T07:18:24.702+0000","updated":"2018-12-13T07:18:24.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203610/comment/16729104","id":"16729104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maoling","name":"maoling","key":"maoling","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maoling&avatarId=32024","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maoling&avatarId=32024","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maoling&avatarId=32024","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maoling&avatarId=32024"},"displayName":"maoling","active":true,"timeZone":"Etc/UTC"},"body":"[~yss]\r\n\r\nNot a deadlock? Just a problem about the IO in your env?\r\n\r\nIs it easy to reproduce this issue? any advances?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maoling","name":"maoling","key":"maoling","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maoling&avatarId=32024","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maoling&avatarId=32024","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maoling&avatarId=32024","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maoling&avatarId=32024"},"displayName":"maoling","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-26T17:03:23.943+0000","updated":"2018-12-26T17:03:23.943+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-3211/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|s01do0:"}}