{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12548598","self":"https://issues.apache.org/jira/rest/api/2/issue/12548598","key":"ZOOKEEPER-1437","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319841","id":"12319841","description":"Fix release against 3.4 branch.","name":"3.4.4","archived":false,"released":true,"releaseDate":"2012-09-23"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316644","id":"12316644","description":"Dynamic Reconfig, Remove Watches, Local Session","name":"3.5.0","archived":false,"released":true,"releaseDate":"2014-08-04"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-03-29T19:00:37.468+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 18 12:31:52 UTC 2016","customfield_12310420":"233695","customfield_12312320":null,"customfield_12310222":"10002_*:*_2_*:*_14011409001_*|*_1_*:*_2_*:*_216690998_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-09-09T18:24:53.293+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1437/watchers","watchCount":18,"isWatching":false},"created":"2012-03-29T02:09:53.307+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"18.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319288","id":"12319288","description":"Fix release against 3.4 branch","name":"3.4.3","archived":false,"released":true,"releaseDate":"2012-02-13"}],"issuelinks":[{"id":"12351317","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12351317","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12552880","key":"ZOOKEEPER-1455","self":"https://issues.apache.org/jira/rest/api/2/issue/12552880","fields":{"summary":"there is no way to determine if a session is sasl authenticated or not","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12358798","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12358798","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12611304","key":"ZOOKEEPER-1561","self":"https://issues.apache.org/jira/rest/api/2/issue/12611304","fields":{"summary":"Zookeeper client may hang on a server restart","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12350606","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12350606","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12550770","key":"HBASE-5780","self":"https://issues.apache.org/jira/rest/api/2/issue/12550770","fields":{"summary":"Fix race in HBase regionserver startup vs ZK SASL authentication","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12363969","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12363969","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12630922","key":"HBASE-7771","self":"https://issues.apache.org/jira/rest/api/2/issue/12630922","fields":{"summary":"Secure HBase Client in MR job causes tasks to wait forever","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12353770","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12353770","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12480698","key":"ZOOKEEPER-938","self":"https://issues.apache.org/jira/rest/api/2/issue/12480698","fields":{"summary":"Support Kerberos authentication of clients.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}},{"id":"12357381","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12357381","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12606149","key":"ZOOKEEPER-1547","self":"https://issues.apache.org/jira/rest/api/2/issue/12606149","fields":{"summary":"Test robustness of client using SASL in the presence of dropped requests","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}},{"id":"12351314","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12351314","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12552747","key":"HADOOP-8315","self":"https://issues.apache.org/jira/rest/api/2/issue/12552747","fields":{"summary":"Support SASL-authenticated ZooKeeper in ActiveStandbyElector","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}},{"id":"12375820","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12375820","type":{"id":"12310050","name":"Regression","inward":"is broken by","outward":"breaks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310050"},"outwardIssue":{"id":"12670448","key":"ZOOKEEPER-1764","self":"https://issues.apache.org/jira/rest/api/2/issue/12670448","fields":{"summary":"ZooKeeper attempts at SASL eventhough it shouldn't","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-02-18T12:31:52.014+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312381","id":"12312381","name":"java client","description":"The java client interface for ZooKeeper"}],"timeoriginalestimate":null,"description":"Found issue in the context of hbase region server startup, but can be reproduced w/ zkCli alone.\n\ngetData may occur prior to SaslAuthenticated and fail with NoAuth. This is not expected behavior when the client is configured to use SASL.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12532977","id":"12532977","filename":"getXidCallHierarchy.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-22T00:35:58.887+0000","size":160047,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12532977/getXidCallHierarchy.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12543934","id":"12543934","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-05T23:27:57.249+0000","size":38904,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12543934/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12543740","id":"12543740","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-04T20:48:58.493+0000","size":38127,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12543740/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12532975","id":"12532975","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-22T00:24:17.038+0000","size":37653,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12532975/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12532965","id":"12532965","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-21T23:12:44.751+0000","size":37422,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12532965/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12532777","id":"12532777","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-20T21:39:42.068+0000","size":33434,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12532777/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12531625","id":"12531625","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-11T00:16:44.624+0000","size":31223,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12531625/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12531621","id":"12531621","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-10T22:53:49.105+0000","size":31111,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12531621/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12528189","id":"12528189","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-18T23:03:34.445+0000","size":9272,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12528189/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12527672","id":"12527672","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-16T18:17:52.309+0000","size":9155,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12527672/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12525918","id":"12525918","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-07T20:11:35.356+0000","size":17976,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12525918/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12525802","id":"12525802","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-07T05:29:58.344+0000","size":16859,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12525802/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12525786","id":"12525786","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-06T21:09:24.137+0000","size":18915,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12525786/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12525779","id":"12525779","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-06T15:36:55.797+0000","size":13172,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12525779/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12520699","id":"12520699","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-31T00:15:12.991+0000","size":14592,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12520699/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12520671","id":"12520671","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T21:11:02.047+0000","size":14845,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12520671/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12520635","id":"12520635","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T17:43:07.586+0000","size":15162,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12520635/ZOOKEEPER-1437.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12520531","id":"12520531","filename":"ZOOKEEPER-1437.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-29T23:21:17.937+0000","size":12780,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12520531/ZOOKEEPER-1437.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"32562","customfield_12312823":null,"summary":"Client uses session before SASL authentication complete","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13240922","id":"13240922","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"body":"PASSES: Interactive getData on ACL protected node:\n\n./zkCli.sh -server gsbl90247\n\n[zk: gsbl90247(CONNECTED) 1] ls /hbase\n[splitlog, unassigned, root-region-server, rs, draining, table, master, tokenauth, shutdown, hbaseid]\n\n[zk: gsbl90247(CONNECTED) 2] getAcl /hbase\n'sasl,'hbase\n: cdrwa\n\nThis works because by the time the ls /hbase is executed, SASL authentication is complete (WatchedEvent state:SaslAuthenticated)\n\n\nFAILS: When running the command immediately:\n\n./zkCli.sh -server gsbl90247 -e \"ls /hbase\"  \n\nWATCHER::\n\nWatchedEvent state:SyncConnected type:None path:null\nException in thread \"main\" org.apache.zookeeper.KeeperException$NoAuthException: KeeperErrorCode = NoAuth for /hbase\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:113)\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n        at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1448)\n        at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1476)\n        at org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:717)\n        at org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:593)\n        at org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:354)\n        at org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:282)\n\nWATCHER::\n\nWatchedEvent state:SaslAuthenticated type:None path:null\n\n\ngetData occurs prior to SaslAuthenticated. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-29T02:11:43.691+0000","updated":"2012-03-29T02:11:43.691+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13241514","id":"13241514","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Thomas,\n\nThanks for diagnosing this. This problem is occuring because the client's 'Main' thread (Main of zkCli.sh) is trying to access resources (e.g. with getData) before the sendThread has finished SASL authentication with the Zookeeper server. Thus the fix is to have the client's Main thread wait in submitRequest() for a notification from the SendThread that authentication has completed.\n\nI am working on a patch now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-29T19:00:37.468+0000","updated":"2012-03-29T19:00:37.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13241915","id":"13241915","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"\nThis patch adds an authSync object to ClientCnxn. If client is configured for SASL authentication, client's main thread will wait() on authSync. SendThread will authSync() when SASL negotiation with Zookeeper server is complete (whether successfully or not).\n\nI removed the sleep()s from SaslAuthTest and other Sasl tests which were hiding this issue : now the clients immediately attempt to create zk nodes, as with to Thomas's test case of running zkCli with an immediate get.\n\nHowever, because of removing the sleep()s that hid the issue, the test SaslAuthMissingClientConfigTest hangs. This is because the zooKeeperSaslClient is null because SASL configuration is intentionally bad and the SASL setup has therefore failed. This failure mode needs to be distinguished from the case where zooKeeperSaslClient is null because it hasn't been constructed yet. This remains to be done, so not marking this issue as \"Patch Available\" yet.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-29T23:21:18.081+0000","updated":"2012-03-29T23:21:18.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242587","id":"13242587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Passes test-core-java.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T17:43:07.725+0000","updated":"2012-03-30T17:43:07.725+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242596","id":"13242596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Eugene,\n\nThanks for looking into it, I will test the patch later today. Can we get this fixed for 3.4.x?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T17:50:22.876+0000","updated":"2012-03-30T17:50:22.876+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242619","id":"13242619","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12520635/ZOOKEEPER-1437.patch\n  against trunk revision 1307191.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 19 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1022//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1022//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1022//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-30T18:18:49.870+0000","updated":"2012-03-30T18:18:49.870+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242748","id":"13242748","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Fixes the two Findbugs warnings reported by last patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T21:11:02.146+0000","updated":"2012-03-30T21:11:02.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242778","id":"13242778","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12520671/ZOOKEEPER-1437.patch\n  against trunk revision 1307191.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 19 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1023//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1023//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1023//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-30T21:38:53.108+0000","updated":"2012-03-30T21:38:53.108+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242784","id":"13242784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"body":"With the patch HBase region server will hang (similar problem in HBase shell, updated only the zookeeper client, no change to server):\n\n{code}\n\"regionserver60020\" prio=10 tid=0x0846ac00 nid=0x6032 in Object.wait() [0xaf2ad000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0xdf5c1e30> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.zookeeper.ClientCnxn.waitForAuthenticationIfNecessary(ClientCnxn.java:1344)\n        - locked <0xdf5c1e30> (a java.lang.Object)\n        at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1355)\n        at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1031)\n        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:154)\n        at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:226)\n        at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.start(ZooKeeperNodeTracker.java:76)\n        - locked <0xdf5c38e8> (a org.apache.hadoop.hbase.MasterAddressTracker)\n        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.setupZookeeperTrackers(HConnectionManager.java:580)\n        - locked <0xdf5b8120> (a org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation)\n        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.<init>(HConnectionManager.java:569)\n        at org.apache.hadoop.hbase.client.HConnectionManager.getConnection(HConnectionManager.java:186)\n        - locked <0xe064fa10> (a org.apache.hadoop.hbase.client.HConnectionManager$1)\n        at org.apache.hadoop.hbase.catalog.CatalogTracker.<init>(CatalogTracker.java:178)\n        at org.apache.hadoop.hbase.regionserver.HRegionServer.initializeZooKeeper(HRegionServer.java:565)\n        at org.apache.hadoop.hbase.regionserver.HRegionServer.preRegistrationInitialization(HRegionServer.java:524)\n        at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:625)\n        at java.lang.Thread.run(Thread.java:619)\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T21:42:58.361+0000","updated":"2012-03-30T21:42:58.361+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242852","id":"13242852","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"body":"I see this consistently happening in the hbase client also:\n\n{code}\n\"main\" prio=10 tid=0x08061000 nid=0x5af6 in Object.wait() [0xf741c000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0xf2674320> (a java.lang.Object)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.zookeeper.ClientCnxn.waitForAuthenticationIfNecessary(ClientCnxn.java:1344)\n        - locked <0xf2674320> (a java.lang.Object)\n        at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1355)\n        at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1031)\n        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:154)\n        at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:226)\n        at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.start(ZooKeeperNodeTracker.java:76)\n        - locked <0xf2675948> (a org.apache.hadoop.hbase.zookeeper.RootRegionTracker)\n        at org.apache.hadoop.hbase.catalog.CatalogTracker.start(CatalogTracker.java:233)\n        at org.apache.hadoop.hbase.client.HBaseAdmin.getCatalogTracker(HBaseAdmin.java:143)\n        - locked <0xf3f76370> (a org.apache.hadoop.hbase.client.HBaseAdmin)\n        at org.apache.hadoop.hbase.client.HBaseAdmin.tableExists(HBaseAdmin.java:200)\n{code}\n\nAuthentication succeeds on the server but the client waits forever.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-30T23:40:37.175+0000","updated":"2012-03-30T23:40:37.175+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242879","id":"13242879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Fixes two bugs in the last patch:\n\n-authSync synchronization object was being created twice\n\n-authResultNotify() was not being called in one SASL failure mode\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-31T00:15:13.159+0000","updated":"2012-03-31T00:15:13.159+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242881","id":"13242881","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Thomas for your testing. Can you please try the latest patch and see if it the client doesn't hang anymore?\n-Eugene","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-31T00:16:35.250+0000","updated":"2012-03-31T00:16:35.250+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242904","id":"13242904","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12520699/ZOOKEEPER-1437.patch\n  against trunk revision 1307644.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 19 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1024//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1024//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1024//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-31T00:59:44.836+0000","updated":"2012-03-31T00:59:44.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13242910","id":"13242910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Eugene, the last patch did it! Login synchronization works (NoAuth failures in HBase are gone and no processes hanging). I have not done any negative testing though. Nice to see secure ZK working with HBase!\n\nI have applied the patch to 3.4.x and adding it as fix version.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thw","name":"thw","key":"thw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Weise","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-31T01:02:30.979+0000","updated":"2012-03-31T01:02:30.979+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13261047","id":"13261047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry to come in on this late, but I've really been swamped.\n\nFrom what I can see this patch only fixes synchronous operations (those that call submitrequest) and not async (which call queuepacket directly).\n\nI'm wondering why approach it this way rather than checking if we are in the auth phase in \"doIO\" and then only sending auth packets until the auth phase has been finalized. (leave any non-auth packets in the queue)\n\nPerhaps rather than queuing packets at all for sasl perhaps we should generate them dynamically based on the current sendThread state and the saslclient state?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-04-24T21:34:32.956+0000","updated":"2012-04-24T21:34:32.956+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269239","id":"13269239","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Modify doIO() so that if SASL authentication is in process, defer sending of packets in the outgoingQueue that are subject to permissions-checking until SASL authentication is complete, per Patrick's recommendation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-06T15:36:55.855+0000","updated":"2012-05-06T15:36:55.855+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269249","id":"13269249","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12525779/ZOOKEEPER-1437.patch\n  against trunk revision 1334548.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1062//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1062//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1062//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-06T16:19:15.926+0000","updated":"2012-05-06T16:19:15.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269280","id":"13269280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"As with patches in March, modify tests to remove now-unnecessary sleeps, and set authInitFailed = true where needed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-06T21:09:24.189+0000","updated":"2012-05-06T21:09:24.189+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269288","id":"13269288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12525786/ZOOKEEPER-1437.patch\n  against trunk revision 1334548.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1063//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1063//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1063//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-06T21:34:10.961+0000","updated":"2012-05-06T21:34:10.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269375","id":"13269375","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Fix test failure, add whitespace, remove irrelevant changes from trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-07T05:29:58.735+0000","updated":"2012-05-07T05:29:58.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269388","id":"13269388","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12525802/ZOOKEEPER-1437.patch\n  against trunk revision 1334548.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1064//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1064//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1064//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-07T05:57:39.670+0000","updated":"2012-05-07T05:57:39.670+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269963","id":"13269963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"-pass simply a boolean flag to doIO() and doTransport() rather than entire Cnxn.SendThread - will be faster too, since clientTunneledAuthenticationInProgress will only be called once per doTransport() call.\n-move operationRequiresPermissions() to ZooDefs.java and make static\n-wrap new LOG.debug() message inside a (LOG.isDebugEnabled()) conditional.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-07T20:11:35.435+0000","updated":"2012-05-07T20:11:35.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13269985","id":"13269985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12525918/ZOOKEEPER-1437.patch\n  against trunk revision 1334548.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1065//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1065//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1065//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-07T20:48:04.558+0000","updated":"2012-05-07T20:48:04.558+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13271832","id":"13271832","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"I don't think we should have the \"requires auth\" check. We should guarantee order. That seems dangerous to me for a couple reasons. Was there a reason you added it?\n\nI'd also suggest that you latch the \"in progress\" indicator so that you don't need to constantly call that method. ie three states \"sasl auth pending\" in which you still have to check, vs \"sasl auth completed\" /\"no sasl auth\" in which case you don't.\n\nOne concern is that we'll hog the cpu in this case. what I mean is. if sasl is in progress, and we just return out of doio, the \"write interest\" is still set. So the OS select will wake up immediately to allow us to write, which we won't do (still waiting), etc.... Not sure how to address that (or if it's really a problem), need to look at it a bit more. What do you think though?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-09T21:33:14.094+0000","updated":"2012-05-09T21:33:14.094+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13271839","id":"13271839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Granted doing what I suggested (remove the \"requires auth\" check) would require you to implement my suggestion above, specifically\n\nbq. Perhaps rather than queuing packets at all for sasl perhaps we should generate them dynamically based on the current sendThread state and the saslclient state?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-09T21:35:46.029+0000","updated":"2012-05-09T21:35:46.029+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13273580","id":"13273580","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"body":"I won't intrude on the design discussion, sounds good.\n\nJust want to add a datapoint that with HBase 0.92.1 + Hadoop 1.0.2 + ZooKeeper 3.4.3 enough has changed timing wise from the time of the initial SASL auth contribution to make starting HBase RegionServers problematic. When I apply the latest patch on this issue, it's much better.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-11T20:25:03.657+0000","updated":"2012-05-11T20:25:03.657+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13273592","id":"13273592","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Andrew. When you say \"it's much better\" does that mean everything works, or works better? If the latter what's broken?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-11T20:39:36.118+0000","updated":"2012-05-11T20:39:36.118+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13273625","id":"13273625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"body":"The RegionServers start reliably. Simple test scenarios complete ok,\nnothing seems broken, but I haven't stressed it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-11T21:17:47.104+0000","updated":"2012-05-11T21:17:47.104+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13276413","id":"13276413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Patrick,\n\nI think I understand you but I want to make sure:\n \nYour idea is that ClientCnxn:queueSaslPacket() will use a java.util.concurrent.CountDownLatch to determine when SASL authentication is complete. The client's Main thread will await() on this latch. Meanwhile, the client's SendThread will be sending and receiving SASL packets until the ZooKeeperSaslClient has finished authenticating with the server. When SASL authentication is finished (successfully or not), the Send thread will countDown() the latch, and the Main thread will be able to continue, causing its packets to be enqueued on the outgoingQueue. \n\nNIOServerCnxn::doIO() will not need any changes - it will simply send and receive packets in the outgoingQueue's natural ordering, without regard to their type. But because of the latch in ClientCnxn:queueSaslPacket(), the packets will be ordered so that no permissions-requiring packets are sent before authentication completes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-16T03:26:17.795+0000","updated":"2012-05-16T03:26:17.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13276958","id":"13276958","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Use a CountDownLatch within ClientCnxn to control access to outgoing packet queue: non-SASL packets must wait until SASL authentication has completed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-16T18:17:52.354+0000","updated":"2012-05-16T18:17:52.354+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13276988","id":"13276988","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Excuse me, I meant \"ClientCnxn:queuePacket()\", not \"ClientCnxn:queueSaslPacket()\" in my 20:26 comment above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-16T18:33:55.377+0000","updated":"2012-05-16T18:33:55.377+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13277016","id":"13277016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12527672/ZOOKEEPER-1437.patch\n  against trunk revision 1337029.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1076//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1076//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1076//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-16T18:54:47.795+0000","updated":"2012-05-16T18:54:47.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13278983","id":"13278983","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antoniomau","name":"antoniomau","key":"antoniomau","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio","active":true,"timeZone":"Etc/UTC"},"body":"Hi All,\n\nIn a scenario where the zookeeper server gets killed and restarted while a java zookeeper client is connected  I get the following in the log: (Please note the Error at bottom)\n\n{code:none}\n[main-SendThread(localhost:60728)] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - ClientCnxn:sendSaslPacket:length=0\n[NIOServerCxn.Factory:0.0.0.0/0.0.0.0:60728] DEBUG org.apache.zookeeper.server.ZooKeeperServer  - Responding to client SASL token.\n[NIOServerCxn.Factory:0.0.0.0/0.0.0.0:60728] DEBUG org.apache.zookeeper.server.ZooKeeperServer  - Size of client SASL token: 0\n[NIOServerCxn.Factory:0.0.0.0/0.0.0.0:60728] DEBUG org.apache.zookeeper.server.ZooKeeperServer  - Size of server SASL response: 101\n[main-SendThread(localhost:60728)] DEBUG org.apache.zookeeper.ClientCnxn  - Reading reply sessionid:0x1376082ca4f0000, packet:: clientPath:null serverPath:null finished:false header:: 9,102  replyHeader:: 9,0,0  request::   response:: #7265616c6d3d227a6b2d7361736c2d6d6435222c6e6f6e63653d22717a485932306a56743534552f483668315837734e2b4b56656e4c335772666458716f6468336247222c636861727365743d7574662d382c616c676f726974686d3d6d64352d73657373\n2012-05-18 15:14:16,908 [SyncThread:0] DEBUG org.apache.zookeeper.server.FinalRequestProcessor  - Processing request:: sessionid:0x1376082ca4f0000 type:ping cxid:0xfffffffffffffffe zxid:0xfffffffffffffffe txntype:unknown reqpath:n/a\n2012-05-18 15:14:16,908 [SyncThread:0] DEBUG org.apache.zookeeper.server.FinalRequestProcessor  - sessionid:0x1376082ca4f0000 type:ping cxid:0xfffffffffffffffe zxid:0xfffffffffffffffe txntype:unknown reqpath:n/a\n\n[main-EventThread] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - ServerSaslResponseCallback(): using empty data[] as server response (length=0)\n[main-EventThread] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - saslToken (server) length: 0\n[main-EventThread] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - saslClient.evaluateChallenge(len=0)\n[main-EventThread] ERROR org.apache.zookeeper.client.ZooKeeperSaslClient  - An error: (java.security.PrivilegedActionException: javax.security.sasl.SaslException: DIGEST-MD5: Digest-challenge format violation: algorithm directive missing) occurred when evaluating Zookeeper Quorum Member's  received SASL token. Zookeeper Client will go to AUTH_FAILED state.\n[main-EventThread] ERROR org.apache.zookeeper.client.ZooKeeperSaslClient  - SASL authentication failed using login context 'null'.\n{code}\n\nI was wondering why the \"empty data[]\" is expected since it always drives in my case to a SASL authentication failed.\n\n\nI know this is not the correct set up but at moment only one Zk server is set up. Not sure if this is actually causing the issue.\n\n*Just for test* I've applied the last patch provided on this ticket with date 16/May/12 18:17\nand then in ClientCnxn.java:565 I've added a null check for rsp.getToken().. and I'm not getting that issue anymore.\n\n{code:none}\nIndex: src\\java\\main\\org\\apache\\zookeeper\\ClientCnxn.java\n===================================================================\n--- src\\java\\main\\org\\apache\\zookeeper\\ClientCnxn.java\t(revision 95556)\n+++ src\\java\\main\\org\\apache\\zookeeper\\ClientCnxn.java\t(working copy)\n@@ -563,6 +563,7 @@\n                       ZooKeeperSaslClient.ServerSaslResponseCallback cb = (ZooKeeperSaslClient.ServerSaslResponseCallback) p.cb;\n                       SetSASLResponse rsp = (SetSASLResponse) p.response;\n                       // TODO : check rc (== 0, etc) as with other packet types.\n+                      if (null != rsp.getToken()){\n                       cb.processResult(rc,null,p.ctx,rsp.getToken(),null);\n                       ClientCnxn clientCnxn = (ClientCnxn)p.ctx;\n                       if ((clientCnxn == null) || (clientCnxn.zooKeeperSaslClient == null) ||\n@@ -571,6 +572,7 @@\n                           queueEvent(new WatchedEvent(EventType.None,\n                                   KeeperState.AuthFailed, null));\n                       }\n+                      }\n                   } else if (p.response instanceof GetDataResponse) {\n                       DataCallback cb = (DataCallback) p.cb;\n                       GetDataResponse rsp = (GetDataResponse) p.response;\n\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antoniomau","name":"antoniomau","key":"antoniomau","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-18T17:21:59.582+0000","updated":"2012-05-18T17:21:59.582+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279070","id":"13279070","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Antonio, interesting results - you are finding that sending an empty SASL response to the Zookeeper server causes an authentication failure? Can you show your JAAS configuration for client and server? I see that your paths have backslashes in them - you are running the client on Microsoft Windows I assume? (not that this should be necessarily be a problem).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-18T18:40:03.567+0000","updated":"2012-05-18T18:40:03.567+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279147","id":"13279147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antoniomau","name":"antoniomau","key":"antoniomau","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio","active":true,"timeZone":"Etc/UTC"},"body":"Hi Eugene,\n\nIt's actually happening only on a linux machine. For some reasons doesn't happen on windows. But I got the impression that it's related to how fast the process goes. Perhaps a race condition somewhere?\n\n(The path is in windows style because I've generated the diff from an eclipse running on windows)\n\n\n The sasl setup is the one shown on https://cwiki.apache.org/ZOOKEEPER/zookeeper-and-sasl.html\n\n{code:none}\nServer {\n       org.apache.zookeeper.server.auth.DigestLoginModule required\n       user_super=\"adminsecret\" \n       user_bob=\"bobsecret\";\n};\n\nClient {\n       org.apache.zookeeper.server.auth.DigestLoginModule required\n       username=\"bob\"\n       password=\"bobsecret\";\n};\n{code}\n\nThe authentication usually works. this issue happens only if I kill the server and restart it again and not all the time.\n\nWhat about that \"empty data[] as server response\"? is it what for?\n\n\nThanks\nAntonio","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antoniomau","name":"antoniomau","key":"antoniomau","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-18T20:17:26.606+0000","updated":"2012-05-18T20:17:26.606+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279224","id":"13279224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhihyu%40ebaysf.com","name":"zhihyu@ebaysf.com","key":"zhihyu@ebaysf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Yu","active":true,"timeZone":"Etc/UTC"},"body":"{code}\n+                } catch (InterruptedException e) {\n+                    // ignore interruption and keep waiting for latch.\n+                }\n{code}\nShould the interrupt state be restored in the above catch block ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhihyu%40ebaysf.com","name":"zhihyu@ebaysf.com","key":"zhihyu@ebaysf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Yu","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-18T21:46:36.830+0000","updated":"2012-05-18T21:46:36.830+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279272","id":"13279272","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Antonio, \n\nI think the empty data[] is an artifact of my development process: in my testing, I found that if I use Kerberos as the SASL metchanism, the client's ZooKeeperSaslClient::ServerSaslResponseCallback::processResult() will be supplied with a null data[] array when this method (processResult()) is called for the final time. So I had to handle this situation somehow.\n\nOne could handle the null server response in a different way, as long as you avoid accessing a null pointer, of course - you could check for the null pointer in other places, as your patch does. \n\nHowever I don't think this is related to the problem you are seeing; or at least, I'm not able to reproduce your problem myself. I wonder if you could supply a shell script that could reproduce it? Perhaps a script that kills and starts the server repeatedly to cause the client to eventually fail to authenticate?\n\n-Eugene","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-18T22:39:35.029+0000","updated":"2012-05-18T22:39:35.029+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279292","id":"13279292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Restore the interrupt state when catching InterruptedException while waiting for authentication latch (thanks to Zhihong Yu).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-18T23:03:34.510+0000","updated":"2012-05-18T23:03:34.510+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279345","id":"13279345","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12528189/ZOOKEEPER-1437.patch\n  against trunk revision 1337029.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1081//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1081//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1081//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-18T23:50:33.963+0000","updated":"2012-05-18T23:50:33.963+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279603","id":"13279603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antoniomau","name":"antoniomau","key":"antoniomau","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\n\nI've tested with the latest patch (released on 18/May/12 23:03) but I get the same issue:\n\n{code:none}\n2012-05-19 18:49:44,067 [main-EventThread] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - ServerSaslResponseCallback(): using empty data[] as server response (length=0)\n2012-05-19 18:49:44,067 [main-EventThread] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - saslToken (server) length: 0\n2012-05-19 18:49:44,067 [main-EventThread] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient  - saslClient.evaluateChallenge(len=0)\n2012-05-19 18:49:44,068 [main-EventThread] ERROR org.apache.zookeeper.client.ZooKeeperSaslClient  - An error: (java.security.PrivilegedActionException: javax.security.sasl.SaslException: DIGEST-MD5: Digest-challenge format violation: algorithm directive missing) occurred when evaluating Zookeeper Quorum Member's  received SASL token. Zookeeper Client will go to AUTH_FAILED state.\n2012-05-19 18:49:44,068 [SyncThread:0] DEBUG org.apache.zookeeper.server.FinalRequestProcessor  - Processing request:: sessionid:0x137666e45f70000 type:sync: cxid:0xa zxid:0xfffffffffffffffe txntype:unknown reqpath:/\n2012-05-19 18:49:44,068 [main-EventThread] ERROR org.apache.zookeeper.client.ZooKeeperSaslClient  - SASL authentication failed using login context 'null'.\n{code}\n\nEugene, I'm using as java client Curator. I can provide a junit test to reproduce the issue if it's fine with you.\n\nThe easiest way to reproduce it is with Curator and the provided TestingServer (curator-test.jar) but I got same using the curator client connected to a running zookeeper server.\nThat's should be the same since the TestingServer is actually running an actual zookeeper server.\n\nLet me know and thanks.\nAntonio","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antoniomau","name":"antoniomau","key":"antoniomau","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-19T19:05:30.929+0000","updated":"2012-05-19T19:05:30.929+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279631","id":"13279631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Antonio, \n(my previous post seems to have failed with a 5xx error, apologies if this is a duplicate)\n\nI encourage you to provide a unit test, either with Curator or directly with just a Zookeeper client/server setup with a shell script. I git-cloned Curator but unfortunately I get some tests failures on trunk with {{./gradelw build}}. Nothing against Curator: I would like to learn more about it, but I think it would be best to show the problem with purely Zookeeper code as much as possible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-19T23:30:19.174+0000","updated":"2012-05-19T23:30:19.174+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13279679","id":"13279679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=v.himanshu","name":"v.himanshu","key":"v.himanshu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Himanshu Vashishtha","active":true,"timeZone":"America/Los_Angeles"},"body":"In case of cross realm authentication, I once got this exception:\n{code}\n2012-05-19 20:19:43,776 INFO org.apache.zookeeper.ClientCnxn: Opening socket connection to server /XXX.XX.XX.XX:2181\n2012-05-19 20:19:43,776 INFO org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: The identifier of th\nis process is 3544@<HIDDEN>.com\n2012-05-19 20:19:43,776 INFO org.apache.zookeeper.client.ZooKeeperSaslClient: Found Login Context section\n 'Client': will use it to attempt to SASL-authenticate.\n2012-05-19 20:19:43,776 INFO org.apache.zookeeper.client.ZooKeeperSaslClient: Client will use GSSAPI as S\nASL mechanism.\n2012-05-19 20:19:43,777 INFO org.apache.zookeeper.ClientCnxn: Socket connection established to <hidden>.com XXX.XX.XXX.XX:2181, initiating session\n2012-05-19 20:19:43,780 INFO org.apache.hadoop.hbase.replication.ReplicationZookeeper: Added new peer clu\nster 22\n2012-05-19 20:19:43,783 INFO org.apache.hadoop.hbase.metrics: new MBeanInfo\n2012-05-19 20:19:43,886 INFO org.apache.zookeeper.ClientCnxn: Session establishment complete on server XXX.XX.XXX.X:2181, sessionid = 0x137683fb0680000, negotiated timeout = 40000\n2012-05-19 20:19:43,903 WARN org.apache.zookeeper.ClientCnxn: Session 0x137683fb0680000 for server  XXX.XX.XXX.X:1:2181, unexpected error, closing socket connection and attempting reconnect\njava.io.IOException: Xid out of order. Got Xid 2 with err 0 expected Xid 1 for a packet with details: cli\nentPath:null serverPath:null finished:false header:: 1,8  replyHeader:: 0,0,-4  request:: '/hbase/rs,F  r\nesponse:: v{}\n        at org.apache.zookeeper.ClientCnxn$SendThread.readResponse(ClientCnxn.java:796)\n        at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:89)\n        at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:291)\n        at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1039)\n2012-05-19 20:19:43,903 WARN org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Possibly transient Z\nooKeeper exception: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = Conne\nctionLoss for /hbase/rs\n2012-05-19 20:19:43,903 INFO org.apache.hadoop.hbase.util.RetryCounter: The 1 times to retry  after sleep\ning 2000 ms\n2012-05-19 20:19:45,125 INFO org.apache.zookeeper.ClientCnxn: Opening socket connection to server  XXX.XX.XXX.X:2181\n2012-05-19 20:19:45,151 INFO org.apache.zookeeper.client.ZooKeeperSaslClient: Found Login Context section\n 'Client': will use it to attempt to SASL-authenticate.\n2012-05-19 20:19:45,152 INFO org.apache.zookeeper.client.ZooKeeperSaslClient: Client will use GSSAPI as S\nASL mechanism.\n2012-05-19 20:19:45,152 INFO org.apache.zookeeper.ClientCnxn: Socket connection established to  XXX.XX.XXX.X:2181, initiating session\n2012-05-19 20:19:45,155 INFO org.apache.zookeeper.ClientCnxn: Session establishment complete on server  XXX.XX.XXX.X:2181, sessionid = 0x137683fb0680000, negotiated timeout = 40000\n\n{code}\n\nThough, this happened only once, but I am pasting it here if that might be useful... as its HBase related, and its about transaction mis-ordering.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=v.himanshu","name":"v.himanshu","key":"v.himanshu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Himanshu Vashishtha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-20T06:36:40.406+0000","updated":"2012-05-20T06:36:40.406+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13282822","id":"13282822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry Eugene but I think I'm making a hash of explaining myself to you. \n\nqueuePacket needs to be a non-blocking call. This latest patch makes it potentially blocking and that will likely break some things for end users.\n\nsee my earlier comment:\n\nbq. I'm wondering why approach it this way rather than checking if we are in the auth phase in \"doIO\" and then only sending auth packets until the auth phase has been finalized. (leave any non-auth packets in the queue)\n\nI think what we should be doing is queuing regular the packets as usual, however the \"doIO\" thread will not forward these packets to the server until the SASL auth phase is completed. SASL packets on the other hand should not be queued but generated on the fly based on the connection state (generated in doIO based on this state) Your patch from May 7 was pretty close - except for the issues I raised on May 9.\n\nDo you see my point wrt this earlier feedback? If not please lmk and I'll try to clarify specific points.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-05-24T22:56:59.940+0000","updated":"2012-05-24T22:56:59.940+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13292593","id":"13292593","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Patrick,\nThanks for your patience and help with this. I am attaching a new patch and also creating a review board review for this patch.\n\nIn this most recent patch, I am generating the SASL packets on the fly as you mentioned, and sending these immediately rather than queuing them. \n\nAlso, there is no synchronization mechanisms (no CountDownLatch) added in this patch. This eliminates the blocking in queueing that you pointed out in your last comment.\n\nI've moved the Xid-setting of the packets to immediately before they are sent (whether they are SASL packets or queued packets), in order to make sure that the packets' Xids are always in order of their being sent. \n\nThank you Himanshu for your testing - I believe my latest patch will prevent packets with out-of-order Xids that you experienced.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-10T22:51:38.441+0000","updated":"2012-06-10T22:51:38.441+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13292595","id":"13292595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"https://reviews.apache.org/ is down for maintenance - will post review when it's back up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-10T22:56:12.838+0000","updated":"2012-06-10T22:56:12.838+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13292600","id":"13292600","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12531621/ZOOKEEPER-1437.patch\n  against trunk revision 1337029.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1091//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1091//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1091//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-10T23:29:11.934+0000","updated":"2012-06-10T23:29:11.934+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13292604","id":"13292604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Fix findbugs warning introduced in last patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-11T00:16:44.659+0000","updated":"2012-06-11T00:16:44.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13292609","id":"13292609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12531625/ZOOKEEPER-1437.patch\n  against trunk revision 1337029.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1092//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1092//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1092//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-11T00:48:45.843+0000","updated":"2012-06-11T00:48:45.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13293704","id":"13293704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Unfortunately I don't know when I can post a review to the reviewboard since it seems down for an indefinite period; see https://issues.apache.org/jira/browse/INFRA-4888 ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-12T15:38:00.254+0000","updated":"2012-06-12T15:38:00.254+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13293835","id":"13293835","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"body":"review.cloudera.org is available.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apurtell","name":"apurtell","key":"apurtell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apurtell&avatarId=20553","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apurtell&avatarId=20553","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apurtell&avatarId=20553","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apurtell&avatarId=20553"},"displayName":"Andrew Purtell","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-12T18:44:13.170+0000","updated":"2012-06-12T18:44:13.170+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13293850","id":"13293850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Andy, using review.cloudera.org: https://review.cloudera.org/r/2150/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-12T19:04:34.567+0000","updated":"2012-06-12T19:04:34.567+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13397899","id":"13397899","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Latest patch fixes problem when using Kerberos as SASL mechanism, because ZK server sends a final empty SASL packet at end of authentication. Also tries to minimize changes to existing, non-SASL related files.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-20T21:39:42.221+0000","updated":"2012-06-20T21:39:42.221+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13397908","id":"13397908","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"btw, reviews.apache.org is back now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-20T21:46:15.399+0000","updated":"2012-06-20T21:46:15.399+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13397916","id":"13397916","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks, Patrick, good to know. I'll use that in the future.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-20T21:50:28.454+0000","updated":"2012-06-20T21:50:28.454+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13397932","id":"13397932","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12532777/ZOOKEEPER-1437.patch\n  against trunk revision 1351541.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1102//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1102//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1102//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-20T22:08:51.721+0000","updated":"2012-06-20T22:08:51.721+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13397938","id":"13397938","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Eugene would you mind moving it back over now? (rb) that way we can see the review updates here in the jira. Thx.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-20T22:12:17.402+0000","updated":"2012-06-20T22:12:17.402+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13397975","id":"13397975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"I looked through the patch, some questions.\n\n1) moving the xid is a bit concerning. \n\nIsn't there a chance that the next xid (A) will be generated, and a separate xid (B) generated, and B sent on the wire before A? Notice that getXid can be called by doio, but also by sendPacket via the event thread. Or does something else protect against this?\n\n2) I'm still concerned about spinning on the write interest flag. Have you considered this?\n\nI'm still looking, but those were my initial thoughts.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-20T22:58:25.936+0000","updated":"2012-06-20T22:58:25.936+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13398985","id":"13398985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Patrick,\n\nThanks as always for your comments and help.\n\nWith regard to Xids: I don't see how the event thread can call sendPacket(). It seems to me that *only* the send thread can call getXid() or sendPacket(), and therefore, packets can only be sent in the correct order. \n\nI put some test logging in ClientCnxn::getXid():\n\n{code}\nLOG.info(\"getXid() being called from thread: \" + Thread.currentThread().getName());\n{code}\n\nand the logging always reports SendThread.\n\nWith regard to spinning on the write interest - you are right, this was happening. I've created a new patch that prevents spinning in doIO(). It works by calling disableWrite() in doIO() if no packet can be sent because SASL authentication is ongoing. enableWrite(), in turn, is called after SASL authentication is completed. This makes the patch a bit more complicated to follow, I'm afraid, but I think I'm on the right track. \n\nI'm attaching the patch and opening a review on reviews.apache.org as you asked.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-21T23:12:44.787+0000","updated":"2012-06-21T23:12:44.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399004","id":"13399004","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Eugene, here's the call hierarchy from Eclipse (one of many) and the root of my concern:\n\n{noformat}\norg.apache.zookeeper.ClientCnxn.sendPacket(Record, Record, AsyncCallback, int)\norg.apache.zookeeper.client.ZooKeeperSaslClient.sendSaslPacket(byte[], ClientCnxn)\norg.apache.zookeeper.client.ZooKeeperSaslClient.respondToServer(byte[], ClientCnxn)\norg.apache.zookeeper.client.ZooKeeperSaslClient.ServerSaslResponseCallback.processResult(int, String, Object, byte[], Stat)\norg.apache.zookeeper.ClientCnxn.EventThread.processEvent(Object)\norg.apache.zookeeper.ClientCnxn.EventThread.run()\n{noformat}\n\nTry doing a \"open call hierarchy\" in eclipse for getXid.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-21T23:43:25.117+0000","updated":"2012-06-21T23:43:25.117+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399006","id":"13399006","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12532965/ZOOKEEPER-1437.patch\n  against trunk revision 1351541.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1106//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1106//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1106//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-21T23:49:31.822+0000","updated":"2012-06-21T23:49:31.822+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399023","id":"13399023","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Fix bug in last patch that was not sending SaslAuthenticated event after authentication finishes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-22T00:24:17.069+0000","updated":"2012-06-22T00:24:17.069+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399027","id":"13399027","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Patrick,\n\nThanks for the information about Eclipse. I'm attaching a screenshot showing my Call Hierarchy view.\n\nThe code that calls ServerSaslResponseCallback.processResult has been removed in the latest patch (as well as in the last few most recent patches). \n\n(See the section of the patch beginning with \"@@ -553,17 +551,6 @@ public class ClientCnxn {\" )\n\nSo I don't think there's a possibility anymore of the EventThread creating or sending packets.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-22T00:31:46.291+0000","updated":"2012-06-22T00:31:46.291+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399031","id":"13399031","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"This (the patch I was using) was from a day or two ago - I'll pull the latest and let you know. thx.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-22T00:34:13.660+0000","updated":"2012-06-22T00:34:13.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399033","id":"13399033","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks, Patrick. Also I've created a new review here:\n\nhttps://reviews.apache.org/r/5505/\n\n-Eugene","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-22T00:38:29.596+0000","updated":"2012-06-22T00:38:29.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13399351","id":"13399351","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12532977/getXidCallHierarchy.png\n  against trunk revision 1351541.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1107//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-22T14:45:19.010+0000","updated":"2012-06-22T14:45:19.010+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13404300","id":"13404300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"Looked at the patch. Couple of comments on it:\n\n- You added \n{code} public boolean readOnly; {code}\n In ClientCnxn.java Packet class which doesnt seem to be used anywhere, am I correct?\n\n- I think we are a little weak on our synchronizations in the patch. I will take a look again but looks like its using a lot of member variables which could get changed by various threads. \n\n- I think there is a race condition in ClientCnxnSocketNIO:findSendablePacket() wherein how do you make sure that the sasl packets (without header) are present in the queue before we start running the thread. What I mean to say is that is it possible that we will land up with \n\n{code}\n  } else {\n                    // Tunnelled authentication is not in progress: just\n                    // send the first packet in the queue.\n                    return outgoingQueue.getFirst();\n                }\n{code}\nEven though we are not done authenticating via sasl?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-29T23:09:28.788+0000","updated":"2012-06-29T23:09:28.788+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13406135","id":"13406135","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Mahadev,\nThanks for looking at the patch and your comments. Responding to your comments:\n\nbq.  You added\nbq.    public boolean readOnly;\nbq. In ClientCnxn.java Packet class which doesnt seem to be used anywhere, am I correct?\n\nThis was added so that packet-serialization can be deferred until the\npacket is actually sent: we need to save the readOnly parameter,\npassed as an argument to the packet constructor, until it is actually\nused in the serialization of the packet. In this patch this\nserialization is now done in a newly-added method,\nClientCnxnSocketNIO::sendPacket(), which serializes the input packet\n'p' by calling p.createBB(). createBB() uses the packet's 'readOnly'\nmember variable in order to create the serialization of the packet.\n\nbq.    I think we are a little weak on our synchronizations in the\nbq.    patch. I will take a look again but looks like its using a lot of\nbq.    member variables which could get changed by various threads.\n\nbq.    I think there is a race condition in\nbq.    ClientCnxnSocketNIO:findSendablePacket() wherein how do you make\nbq.    sure that the sasl packets (without header) are present in the\nbq.    queue before we start running the thread. \n\nI don't think there is a race condition possible. My reasoning is that\nthe sendThread both sends packets from the outgoingQueue and manages\nthe {{zooKeeperSaslClient}} object. Therefore it is not possible to send\npackets from the outgoing queue (besides the initial priming packet) without the {{zooKeeperSaslClient}} being\nfinished with authentication (whether successfully or not).\n\nIn the code from the patch that you\ncite, {{clientTunneledAuthenticationInProgress()}} must have returned\nfalse in order to get inside the {{ else{} }}. For\n{{clientTunneledAuthenticationInProgress()}} is false, then at least one\nof the following must be true:\n\n1. saslAuthFailed is true, or\n2. zooKeeperSaslClient's clientTunneledAuthenticationInProgress() is false.\n\nWith regard to 1., saslAuthFailed can only be true if a {{LoginException}} was caught within\n{{startConnect()}}, but {{startConnect()}} can only be run by the sendThread.\n\nWith regard to 2., this can only be false if {{gotLastPacket}} is true,\nand either:\n\n2.1. saslState is COMPLETE, or \n2.2. saslState is FAILED.\n\nBut {{gotLastPacket}} is initialized to false when the sendThread creates it,\nand can only be set to true by code run by the sendThread\n(specifically by {{ZooKeeperSaslClient::respondToServer()}}).\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-03T22:42:34.876+0000","updated":"2012-07-03T22:42:34.876+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13413635","id":"13413635","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi Eugene, Sorry to join late. BTW the patch looks great and just few suggestions.\n\n----\n#1# \n{code}\nthrow new SaslException(\"Failed to send SASL packet to server due \" +\n              \"to IOException:\" + e);\nLOG.error(\"SASL authentication with Zookeeper Quorum member failed: \" + e);\n{code}\nInstead of appending the exception, would be good to pass exception as an argument.\n----\n#2# Say, client and server got partitioned. Now the 'respondToServer' will fail and marking the state as FAILED, also 'gotLastPacket = true'. Here I'm just doubting, whether to mark 'gotLastPacket=true' rather what about considering as authenticationInProgress and continue?\n\n{code}\npublic void respondToServer(byte[] serverToken, ClientCnxn cnxn) {\n      if (!(saslClient.isComplete())) {\n         try {\n         //...\n              sendSaslPacket(saslToken, cnxn);\n         //....\n         } catch (SaslException e) {\n             saslState = SaslState.FAILED;\n             gotLastPacket = true;\n         }\n}\n\npublic boolean clientTunneledAuthenticationInProgress() {\n          //....\n          //...\n            if (((isComplete()) ||\n                    (isFailed())) &&\n                    (gotLastPacket == false)) {\n                return true;\n            }\n}\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-13T10:25:02.638+0000","updated":"2012-07-13T10:25:02.638+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13445300","id":"13445300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Rakesh,\n \nSorry to take a long time to respond to you. I'll try to be more prompt especially as folks are hoping to get this in a release soon.\n\n\n I see what you are asking: should we retry if there's a network error connecting to the client (in your terms, a partition)?\n\n I guess we could add some retry logic - something like:\n\n{code}\nwhile (!(saslClient.isComplete()) {\n   try {\n     sendSaslPacket(saslToken, cnxn); // throws SaslException, IOException\n   } catch (IOException ne) {\n     // transitory network failure: keep trying to reach server\n   } catch (SaslException se) {\n     // auth failed: nothing more we can do.\n     break;\n   }\n}\n{code}\n\nIs that what you had in mind? \n\nI think it would be good to test the SASL exchange in the presence of network failures - I'm wondering what support there is already in Zookeeper tests for network failure and if so, can we use them to test the SASL exchange.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-30T21:11:55.034+0000","updated":"2012-08-30T21:11:55.034+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13445704","id":"13445704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Yeah Eugene, retry logic is fine.\n\nbq.I think it would be good to test the SASL exchange in the presence of network failures - I'm wondering what support there is already in Zookeeper tests for network failure and if so, can we use them to test the SASL exchange.\n\nI could see DisconnectableZooKeeper.disconnect() has network delays/partition simulation logic. Hope this will help you to get more idea.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-08-31T05:59:31.501+0000","updated":"2012-08-31T05:59:31.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13447477","id":"13447477","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=breed","name":"breed","key":"breed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Benjamin Reed","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 looks great for the next release. it would be nice to address the exceptions that Rakesh brought up and set the causing exception as the cause rather than embedding in the message.\n\nas for the disconnect problem. it is slightly hard to follow, but if there is a network failure, wont the connection reset and a new ZooKeeperSaslClient be created anyway? it would be great to add a test that simply drops responses to clients without closing connections. i'm fine with doing it in a separate patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=breed","name":"breed","key":"breed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Benjamin Reed","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-04T04:22:19.449+0000","updated":"2012-09-04T04:22:19.449+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13448031","id":"13448031","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Rakesh and Ben,\n\nI've added https://issues.apache.org/jira/browse/ZOOKEEPER-1437 based on your comments. I addressed it specifically to SASL, though perhaps it is a more general issue of testing the client's coping with all kinds of dropped packets, not just SASL ones.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-04T20:44:55.672+0000","updated":"2012-09-04T20:44:55.672+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13448032","id":"13448032","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry, meant to link to ZOOKEEPER-1547.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-04T20:45:25.624+0000","updated":"2012-09-04T20:45:25.624+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13448035","id":"13448035","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Merge with trunk and pass along exception as second argument of SaslException. Thanks to Rakesh for pointing it out.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-04T20:48:58.494+0000","updated":"2012-09-04T20:48:58.494+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13448047","id":"13448047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Ben, You are right: a new ZooKeeperSaslClient will be created for each new connection, since it's a member variable of a ClientCnxn. So it doesn't seem possible for a ZooKeeperSaslClient to retry across two subsequent connections.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-04T20:55:55.877+0000","updated":"2012-09-04T20:55:55.877+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13448068","id":"13448068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12543740/ZOOKEEPER-1437.patch\n  against trunk revision 1380130.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1176//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1176//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1176//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-04T21:15:17.238+0000","updated":"2012-09-04T21:15:17.238+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13448443","id":"13448443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"Eugene,\n Looks like there is a one last glitch - the test failed. Can you please take a look? I think the patch is ready to go (except for the  test case).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-05T04:02:56.829+0000","updated":"2012-09-05T04:02:56.829+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13449004","id":"13449004","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"I see what's going on: my patch is looking for the system property \"java.security.auth.login.config\" variable, which is not defined by the test that failed (SaslAuthDesignatedServerTest). \n\nWill have a new patch up very soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-05T18:57:31.342+0000","updated":"2012-09-05T18:57:31.342+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13449017","id":"13449017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"Thanks Eugene!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-05T19:08:52.764+0000","updated":"2012-09-05T19:08:52.764+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13449257","id":"13449257","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Fixes SaslAuthDesignatedServerTest by checking for both system property JAAS_CONF_KEY and java.security.auth.login.Configuration.getConfiguration().","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-05T23:27:57.251+0000","updated":"2012-09-05T23:27:57.251+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13449330","id":"13449330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12543934/ZOOKEEPER-1437.patch\n  against trunk revision 1380931.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 15 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1179//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1179//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1179//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-06T01:08:50.625+0000","updated":"2012-09-06T01:08:50.625+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13451643","id":"13451643","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"I just committed this. This is a big one. Thanks Eugene and others who helped reviewing it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-09T18:24:53.303+0000","updated":"2012-09-09T18:24:53.303+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13451889","id":"13451889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in ZooKeeper-trunk #1675 (See [https://builds.apache.org/job/ZooKeeper-trunk/1675/])\n    ZOOKEEPER-1437. Client uses session before SASL authentication complete (Eugene Koontz via mahadev) (Revision 1382555)\n\n     Result = SUCCESS\nmahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1382555\nFiles : \n* /zookeeper/trunk/CHANGES.txt\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/ClientCnxn.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/ClientCnxnSocket.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/client/ZooKeeperSaslClient.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/SaslAuthDesignatedClientTest.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/SaslAuthFailDesignatedClientTest.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/SaslAuthFailTest.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/SaslAuthMissingClientConfigTest.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/SaslAuthTest.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-10T11:01:44.056+0000","updated":"2012-09-10T11:01:44.056+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13475896","id":"13475896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=randgalt","name":"randgalt","key":"randgalt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=randgalt&avatarId=16746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=randgalt&avatarId=16746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=randgalt&avatarId=16746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=randgalt&avatarId=16746"},"displayName":"Jordan Zimmerman","active":true,"timeZone":"America/Panama"},"body":"I'm still seeing this in a 3.4.4 client connecting to a 3.3.5 ensemble:\n\n2012-10-14 20:31:34,814 INFO  org.apache.zookeeper.ZooKeeper:1 [http-0.0.0.0-7101-5] [log] Initiating client connection, connectString=localhost:2181 sessionTimeout=300000 watcher=com.netflix.curator.ConnectionState@4715dc3e\n2012-10-14 20:31:34,825 INFO  org.apache.zookeeper.ClientCnxn:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] Opening socket connection to server localhost/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)\n2012-10-14 20:31:34,835 INFO  org.apache.zookeeper.ClientCnxn:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] Socket connection established to localhost/127.0.0.1:2181, initiating session\n2012-10-14 20:31:34,835 DEBUG org.apache.zookeeper.ClientCnxn:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] Session establishment request sent on localhost/127.0.0.1:2181\n2012-10-14 20:31:34,858 WARN  org.apache.zookeeper.ClientCnxnSocket:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] Connected to an old server; r-o mode will be unavailable\n2012-10-14 20:31:34,858 INFO  org.apache.zookeeper.ClientCnxn:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] Session establishment complete on server localhost/127.0.0.1:2181, sessionid = 0x13a60f640480000, negotiated timeout = 40000\n2012-10-14 20:31:35,379 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:35,864 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:35,864 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,166 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,167 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,168 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,168 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,169 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,169 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: 0,12  replyHeader:: 0,0,0  request:: '/,F  response:: v{} until SASL authentication completes.\n2012-10-14 20:31:48,169 DEBUG org.apache.zookeeper.ClientCnxnSocketNIO:1 [http-0.0.0.0-7101-5-SendThread(localhost:2181)] [log] deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=randgalt","name":"randgalt","key":"randgalt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=randgalt&avatarId=16746","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=randgalt&avatarId=16746","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=randgalt&avatarId=16746","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=randgalt&avatarId=16746"},"displayName":"Jordan Zimmerman","active":true,"timeZone":"America/Panama"},"created":"2012-10-14T20:38:57.492+0000","updated":"2012-10-14T20:38:57.492+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/13483888","id":"13483888","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Jordan,\n\nWhat version of Java are you using to run the Java client? If it's Java 7, your problem in fact might be ZOOKEEPER-1550.\n\n-Eugene","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-10-25T04:22:13.662+0000","updated":"2012-10-25T04:22:13.662+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15140620","id":"15140620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"body":"Hi Eugene,\n\nI am working on the version 3.4.6 and I see all the changes mentioned in the patch attached here. But I am facing some problem when working with kerberos enabled environment. \nThe below error is coming when executing command related to hbase replication which internally communicates with zookeeper - \n\nhbase(main):003:0> list_replicated_tables\nTABLE:COLUMNFAMILY                                  ReplicationType\n\nERROR: KeeperErrorCode = NoAuth for /hbase-secure/replication/peers\n\nHere is some help for this command:\nList all the tables and column families replicated from this cluster\n\n  hbase> list_replicated_tables\n  hbase> list_replicated_tables 'abc.*'\n\nhbase(main):004:0>\n\n------\nAnd this is too what I am getting in zookeerer server log file - \n2016-02-10 02:55:04,450 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@357] - caught end of stream exception\nEndOfStreamException: Unable to read additional data from client sessionid 0x152caa493d20004, likely client has closed socket\n        at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:230)\n        at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)\n        at java.lang.Thread.run(Thread.java:785)\n2016-02-10 02:55:04,451 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1007] - Closed socket connection for client /9.30.123.121:59161 which had sessionid 0x152caa493d20004","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-10T10:55:40.545+0000","updated":"2016-02-10T10:55:40.545+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15144240","id":"15144240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi  Devendra,\n\nAre you sure you are kerberos-authenticated? Can you post the output of running klist before starting hbase shell? Also can you try running zkCli.sh and see if you can access the znode /hbase-secure/replication/peers znode?\n\n-Eugene","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-12T08:06:06.652+0000","updated":"2016-02-12T08:06:06.652+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15144265","id":"15144265","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"body":"Hi Eugene,\n\nYes the environment is kerberos-authenticated. When I try accessing the znode /hbase-secure/replication/peers via zkcli, I get the authentication related error saying 'Authentication is not valid : /hbase-secure/replication/peers'.\n\nWATCHER::\n\nWatchedEvent state:AuthFailed type:None path:null\n2016-02-12 00:24:05,360 INFO  [main-SendThread(dev.machine.com:2181)] zookeeper.ClientCnxn: Socket connection established to dev.machine.com/9.30.123.136:2181, initiating session\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTING) 0] 2016-02-12 00:24:05,393 INFO  [main-SendThread(dev.machine.com:2181)] zookeeper.ClientCnxn: Session establishment complete on server dev.machine.com/9.30.123.136:2181, sessionid = 0x252cfff53750029, negotiated timeout = 30000\n\nWATCHER::\n\nWatchedEvent state:SyncConnected type:None path:null\n\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 0] ls\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 1] ls /hbase-secure\n[replication, meta-region-server, rs, splitWAL, backup-masters, table-lock, flush-table-proc, region-in-transition, online-snapshot, acl, master, running, recovering-regions, tokenauth, draining, namespace, hbaseid, table]\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 2] ls /hbase-secure/replication\nAuthentication is not valid : /hbase-secure/replication\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 3] ls /hbase-secure/replication/peers\nAuthentication is not valid : /hbase-secure/replication/peers\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 4]\n#####################################################################\nOne thing I noticed that when I get the ACLs for parent znode  /hbase-secure, I see the permissions for world:anyone, but for some of the child znode like  /hbase-secure/replication, I dont see any permission set for world:anyone --- \n\n[zk: svlxbi0n.svl.ibm.com:2181,svlxbi04.svl.ibm.com:2181(CONNECTED) 5] getAcl /hbase-secure\n'world,'anyone\n: r\n'sasl,'hbase\n: cdrwa\n'sasl,'hbase\n: cdrwa\n[zk: svlxbi0n.svl.ibm.com:2181,svlxbi04.svl.ibm.com:2181(CONNECTED) 6] getAcl /hbase-secure/replication\n'sasl,'hbase\n: cdrwa\n'sasl,'hbase\n: cdrwa\n[zk: svlxbi0n.svl.ibm.com:2181,svlxbi04.svl.ibm.com:2181(CONNECTED) 7] getAcl /hbase-secure/replication/peers\n'sasl,'hbase\n: cdrwa\n'sasl,'hbase\n: cdrwa\n[zk: svlxbi0n.svl.ibm.com:2181,svlxbi04.svl.ibm.com:2181(CONNECTED) 8]\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-12T08:33:39.421+0000","updated":"2016-02-12T08:33:39.421+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15144267","id":"15144267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"body":"And I forgot posting the output of klist before running hbase shell. And this is the output of klist - \n[hbase@dev.machine root]$ klist\nTicket cache: FILE:/home/hbase/krb5cc_hbase\nDefault principal: hbase-tdcluster@DEV.COM\n\nValid starting       Expires              Service principal\n02/11/2016 04:37:48  02/12/2016 04:37:48  krbtgt/DEV.MACHINE@DEV.COM\n        renew until 02/18/2016 04:37:48\n[hbase@dev.machine root]$","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-12T08:37:36.970+0000","updated":"2016-02-12T08:37:36.970+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15145774","id":"15145774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"body":"Ok, I think I see the problem. Your principle is \"hbase-tdcluster@DEV.COM\". The \"@DEV.COM\" is ignored for the purpose of authorization, but \"hbase-tdcluster\" != \"hbase\", so you don't have any permissions for the /hbase zknode.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ekoontz","name":"ekoontz","key":"ekoontz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ekoontz&avatarId=11640","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ekoontz&avatarId=11640","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ekoontz&avatarId=11640","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ekoontz&avatarId=11640"},"displayName":"Eugene Koontz","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-02-13T04:04:56.532+0000","updated":"2016-02-13T04:04:56.532+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15152142","id":"15152142","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"body":"Thanks Eugene, For the suspected problem. Could you please tell me what should I change in terms of kerberos related properties to make it work. Here are the list of some those property for the reference which is configured for Hbase -\n\nhbase.zookeeper.quorum--> dev.machine.com,dev2machine.com     \nhbase.master.kerberos.principal--> hbase/_HOST@DEV.COM     \nhbase.master.keytab.file--> /etc/security/keytabs/hbase.service.keytab    \nhbase.regionserver.kerberos.principal--> hbase/_HOST@DEV.COM   \nhbase.regionserver.keytab.file--> /etc/security/keytabs/hbase.service.keytab     \nzookeeper.znode.parent--> /hbase-secure\nhbase.replication--> true    \nhbase.rest.authentication.kerberos.keytab--> /etc/security/keytabs/hbase.service.keytab\nhbase.rest.authentication.kerberos.principal--> HTTP/_HOST@DEV.COM     \nhbase.rest.authentication.type--> kerberos    \nhbase.rest.kerberos.principal--> hbase/_HOST@DEV.COM    \nhbase.rest.keytab.file--> /etc/security/keytabs/hbase.service.keytab","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-18T10:59:22.627+0000","updated":"2016-02-18T10:59:22.627+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12548598/comment/15152245","id":"15152245","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"body":"And Eugene, I setup hbase again, now the klist command has this output - \n\nhbase(main):003:0> [hbase@dev.machine root]$ klist\nTicket cache: FILE:/home/hbase/krb5cc_hbase\nDefault principal: hbase@DEV.COM\n\nValid starting       Expires              Service principal\n02/18/2016 03:08:29  02/19/2016 03:08:29  krbtgt/DEV.MACHINE@DEV.COM\n[hbase@dev.machine root]$\n\n########################\nSo as per your last comment, now \"hbase\" == hbase, but still having the same issue ('Authentication is not valid) while accessing the /hbase-secure/replication or any its child zknode via \"hbase zkcli\" - \n\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 0] ls\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 1] ls /hbase-secure\n[replication, meta-region-server, rs, splitWAL, backup-masters, table-lock, flush-table-proc, region-in-transition, online-snapshot, acl, master, running, recovering-regions, tokenauth, draining, namespace, hbaseid, table]\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 2] ls /hbase-secure/replication\nAuthentication is not valid : /hbase-secure/replication\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 3] ls /hbase-secure/replication/peers\nAuthentication is not valid : /hbase-secure/replication/peers\n[zk: dev.machine.com:2181,dev2.machine.com:2181(CONNECTED) 4]\n\n#####################\nAnd because of this problem I am not able to access any data from /hbase-secure/replication/peers zknode in \"hbase shell\"\nhbase(main):001:0> list_peers\n\nERROR: KeeperErrorCode = NoAuth for /hbase-secure/replication/peers\n\nHere is some help for this command:\nList all replication peer clusters.\n\n  hbase> list_peers\n\nhbase(main):002:0>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vvvvvdev","name":"vvvvvdev","key":"vvvvvdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devendra Vishwakarma","active":true,"timeZone":"Etc/UTC"},"created":"2016-02-18T12:31:52.014+0000","updated":"2016-02-18T12:31:52.014+0000"}],"maxResults":92,"total":92,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1437/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i05xpz:"}}