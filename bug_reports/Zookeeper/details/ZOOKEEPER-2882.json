{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13097045","self":"https://issues.apache.org/jira/rest/api/2/issue/13097045","key":"ZOOKEEPER-2882","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-08-24T04:46:02.919+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Sep 11 22:39:22 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2882/watchers","watchCount":2,"isWatching":false},"created":"2017-08-23T14:55:08.220+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-09-11T22:39:22.966+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312380","id":"12312380","name":"c client","description":"The c client interface to ZooKeeper"}],"timeoriginalestimate":null,"description":"when default branch is executed in switch(op->type) , alloced memory for oa variable will leak, so, close_buffer_oarchive(&oa, 1); should be called before returning in default branch.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"memory leak in zoo_amulti() function","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16138470","id":"16138470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"body":"int zoo_amulti(zhandle_t *zh, int count, const zoo_op_t *ops,\n        zoo_op_result_t *results, void_completion_t completion, const void *data)\n            ......\n            default:\n                close_buffer_oarchive(&oa, 1);\n                LOG_ERROR((\"Unimplemented sub-op type=%d in multi-op\", op->type));\n                return ZUNIMPLEMENTED; \n            ......","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"created":"2017-08-23T15:10:53.086+0000","updated":"2017-08-23T15:10:53.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16139548","id":"16139548","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"[~guoxiang] Please follow the steps on the [How to Contribute page|https://cwiki.apache.org/confluence/display/ZOOKEEPER/HowToContribute] to create a pull request for your patch. Similar for ZOOKEEPER-2883.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2017-08-24T04:46:02.919+0000","updated":"2017-08-24T04:46:02.919+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16155292","id":"16155292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"body":"i just added close_buffer_oarchive(&oa, 1); statement after default: statement in zoo_amulti(), when i executed ant test on windows 10 OS, it showed following failed message:\n\nBUILD FAILED\n\\zookeeper\\zookeeper\\build.xml:1339: The following error occurred while executing this line:\n\\zookeeper\\zookeeper\\build.xml:1220: The following error occurred while executing this line:\n\\zookeeper\\zookeeper\\build.xml:1224: Tests failed!\n\nTotal time: 551 minutes 16 seconds\n\nhow to solve it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-06T12:47:26.708+0000","updated":"2017-09-06T12:56:34.030+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16155407","id":"16155407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"{{Total time: 551 minutes 16 seconds}}\n\nIt's the first time I've ever seen unit tests took this long :)\n\nThe error message here indicates that some, if not all of the tests were failing. That is not cool, but usually OK as we have some flaky tests. Were you able to identify which tests were failing? \n\nAnother suggestion is - since you are making change to C client, you can just run C tests and skip java tests. Something like:\n{{ant test-core-cppunit}}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2017-09-06T14:12:42.154+0000","updated":"2017-09-06T14:12:42.154+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16160173","id":"16160173","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"body":"when i executed ant test-core-cppunit command, it showed me following error message:\n\nBUILD FAILED\nd:\\niugx\\work\\zookeeper\\zookeeper\\build.xml:1298: The following error occurred while executing this line:\nd:\\niugx\\work\\zookeeper\\zookeeper\\build.xml:1285: The following error occurred while executing this line:\nd:\\niugx\\work\\zookeeper\\zookeeper\\build.xml:1277: Execute failed: java.io.IOException: Cannot run program \"autoreconf\" (in directory \"d:\\niugx\\work\\zookeeper\\zookeeper\\src\\c\"): CreateProcess error=2, 系统找不到指定的文件。\n        at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)\n        at java.lang.Runtime.exec(Runtime.java:620)\n        at org.apache.tools.ant.taskdefs.launcher.Java13CommandLauncher.exec(Java13CommandLauncher.java:58)\n        at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java:426)\n\nso, whether i need to do something (e.g. initialize or configure ) before executing ant test-core-cppunit?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-10T02:00:10.214+0000","updated":"2017-09-10T02:00:10.214+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16160174","id":"16160174","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"body":"when i executed ant test-core-cppunit command, it showed me following error message:\n\nBUILD FAILED\n\\zookeeper\\build.xml:1298: The following error occurred while executing this line:\n\\zookeeper\\build.xml:1285: The following error occurred while executing this line:\n\\zookeeper\\build.xml:1277: Execute failed: java.io.IOException: Cannot run program \"autoreconf\" (in directory \"\\zookeeper\\src\\c\"): CreateProcess error=2, 系统找不到指定的文件。\n        at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)\n        at java.lang.Runtime.exec(Runtime.java:620)\n        at org.apache.tools.ant.taskdefs.launcher.Java13CommandLauncher.exec(Java13CommandLauncher.java:58)\n        at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java:426)\n\nso, whether i need to do something (e.g. initialize or configure ) before executing ant test-core-cppunit?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=guoxiang","name":"guoxiang","key":"guoxiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"guoxiang niu","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-10T02:00:10.245+0000","updated":"2017-09-10T02:01:48.167+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13097045/comment/16162162","id":"16162162","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"Looks like you did not have autoconf installed, which is required to run C client / unit tests. We don't have terribly good document on c client regarding set up dev env, but this link was what I followed and found useful: http://wiki.wsmoak.net/cgi-bin/wiki.pl?action=browse&diff=1&id=ZooKeeperBuild. If you are on other systems the steps should be similar....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2017-09-11T22:39:22.966+0000","updated":"2017-09-11T22:39:22.966+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2882/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3j70v:"}}