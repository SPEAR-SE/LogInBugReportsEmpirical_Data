{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12842215","self":"https://issues.apache.org/jira/rest/api/2/issue/12842215","key":"ZOOKEEPER-2230","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323310","id":"12323310","description":"Fix release against 3.4 branch","name":"3.4.6","archived":false,"released":true,"releaseDate":"2014-03-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325149","id":"12325149","description":"Fix release against 3.4 branch","name":"3.4.7","archived":false,"released":true,"releaseDate":"2015-12-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326517","id":"12326517","description":"Fix release against 3.4 branch","name":"3.4.8","archived":false,"released":true,"releaseDate":"2016-02-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12331981","id":"12331981","description":"Alpha release against 3.5 branch","name":"3.5.2","archived":false,"released":true,"releaseDate":"2016-07-21"}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-09-06T17:28:36.390+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 09 17:54:50 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2230/watchers","watchCount":10,"isWatching":false},"created":"2015-07-02T06:13:20.843+0000","customfield_12310192":"Fix slowness in connections when setup with native GSSAPI.","customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["patch"],"customfield_12312333":null,"customfield_12310230":"kerberos, native-gssapi","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323310","id":"12323310","description":"Fix release against 3.4 branch","name":"3.4.6","archived":false,"released":true,"releaseDate":"2014-03-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325149","id":"12325149","description":"Fix release against 3.4 branch","name":"3.4.7","archived":false,"released":true,"releaseDate":"2015-12-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326517","id":"12326517","description":"Fix release against 3.4 branch","name":"3.4.8","archived":false,"released":true,"releaseDate":"2016-02-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316644","id":"12316644","description":"Dynamic Reconfig, Remove Watches, Local Session","name":"3.5.0","archived":false,"released":true,"releaseDate":"2014-08-04"}],"issuelinks":[{"id":"12491739","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12491739","type":{"id":"10020","name":"Cloners","inward":"is cloned by","outward":"is a clone of","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10020"},"inwardIssue":{"id":"13036309","key":"ZOOKEEPER-2670","self":"https://issues.apache.org/jira/rest/api/2/issue/13036309","fields":{"summary":"CLONE - Connections fo ZooKeeper server becomes slow over time with native GSSAPI","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=enis","name":"enis","key":"enis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Enis Soztutar","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-02-09T17:54:50.787+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312382","id":"12312382","name":"server","description":"General issues with the ZooKeeper server."}],"timeoriginalestimate":null,"description":"ZooKeeper server becomes slow over time when native GSSAPI is used. The connection to the server starts taking upto 10 seconds.\nThis is happening with ZooKeeper-3.4.6 and is fairly reproducible.\n\nDebug logs:\n{noformat}\n2015-07-02 00:58:49,318 [myid:] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:NIOServerCnxnFactory@197] - Accepted socket connection from /<client_ip>:47942\n2015-07-02 00:58:49,318 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperSaslServer@78] - serviceHostname is '<zookeeper-server>'\n2015-07-02 00:58:49,318 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperSaslServer@79] - servicePrincipalName is 'zookeeper'\n2015-07-02 00:58:49,318 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperSaslServer@80] - SASL mechanism(mech) is 'GSSAPI'\n2015-07-02 00:58:49,324 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperSaslServer@106] - Added private credential to subject: [GSSCredential: \nzookeeper@<zookeeper-server> 1.2.840.113554.1.2.2 Accept [class sun.security.jgss.wrapper.GSSCredElement]]\n2015-07-02 00:58:59,441 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@810] - Session establishment request from client /<client_ip>:47942 client's lastZxid is 0x0\n2015-07-02 00:58:59,441 [myid:] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@868] - Client attempting to establish new session at /<client_ip>:47942\n2015-07-02 00:58:59,448 [myid:] - DEBUG [SyncThread:0:FinalRequestProcessor@88] - Processing request:: sessionid:0x14e486028785c81 type:createSession cxid:0x0 zxid:0x110e79 txntype:-10 reqpath:n/a\n2015-07-02 00:58:59,448 [myid:] - DEBUG [SyncThread:0:FinalRequestProcessor@160] - sessionid:0x14e486028785c81 type:createSession cxid:0x0 zxid:0x110e79 txntype:-10 reqpath:n/a\n2015-07-02 00:58:59,448 [myid:] - INFO  [SyncThread:0:ZooKeeperServer@617] - Established session 0x14e486028785c81 with negotiated timeout 10000 for client /<client_ip>:47942\n2015-07-02 00:58:59,452 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@949] - Responding to client SASL token.\n2015-07-02 00:58:59,452 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@953] - Size of client SASL token: 706\n2015-07-02 00:58:59,460 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@984] - Size of server SASL response: 161\n2015-07-02 00:58:59,462 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@949] - Responding to client SASL token.\n2015-07-02 00:58:59,462 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@953] - Size of client SASL token: 0\n2015-07-02 00:58:59,462 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@984] - Size of server SASL response: 32\n2015-07-02 00:58:59,463 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@949] - Responding to client SASL token.\n2015-07-02 00:58:59,463 [myid:] - DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@953] - Size of client SASL token: 32\n2015-07-02 00:58:59,464 [myid:] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:SaslServerCallbackHandler@118] - Successfully authenticated client: authenticationID=<user_principal>;  authorizationID=<user_principal>.\n2015-07-02 00:58:59,464 [myid:] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:ZooKeeperServer@964] - adding SASL authorization for authorizationID: <user_principal>\n2015-07-02 00:58:59,465 [myid:] - INFO  [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@494] - Processed session termination for sessionid: 0x14e486028785c81\n2015-07-02 00:58:59,467 [myid:] - DEBUG [SyncThread:0:FinalRequestProcessor@88] - Processing request:: sessionid:0x14e486028785c81 type:closeSession cxid:0x1 zxid:0x110e7a txntype:-11 reqpath:n/a\n2015-07-02 00:58:59,467 [myid:] - DEBUG [SyncThread:0:FinalRequestProcessor@160] - sessionid:0x14e486028785c81 type:closeSession cxid:0x1 zxid:0x110e7a txntype:-11 reqpath:n/a\n2015-07-02 00:58:59,467 [myid:] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:42405:NIOServerCnxn@1007] - Closed socket connection for client /<client_ip>:47942 which had sessionid 0x14e486028785c81\n{noformat}\n\nIf you see, after adding the credentials to privateCredential set, it takes roughly 10 seconds to reach to session establishment request. From the code it looks like Subject.doAs() is taking a lot of time.\n\nI connected it to jdb while it was waiting and got following stacktrace:\n{noformat}\nNIOServerCxn.Factory:0.0.0.0/0.0.0.0:58909:\n  [1] java.util.HashMap$TreeNode.find (HashMap.java:1,865)\n  [2] java.util.HashMap$TreeNode.find (HashMap.java:1,861)\n  [3] java.util.HashMap$TreeNode.find (HashMap.java:1,861)\n  [4] java.util.HashMap$TreeNode.find (HashMap.java:1,861)\n  [5] java.util.HashMap$TreeNode.find (HashMap.java:1,861)\n  [6] java.util.HashMap$TreeNode.find (HashMap.java:1,861)\n  [7] java.util.HashMap$TreeNode.find (HashMap.java:1,861)\n  [8] java.util.HashMap$TreeNode.putTreeVal (HashMap.java:1,981)\n  [9] java.util.HashMap.putVal (HashMap.java:637)\n  [10] java.util.HashMap.put (HashMap.java:611)\n  [11] java.util.HashSet.add (HashSet.java:219)\n  [12] javax.security.auth.Subject$ClassSet.populateSet (Subject.java:1,418)\n  [13] javax.security.auth.Subject$ClassSet.<init> (Subject.java:1,372)\n  [14] javax.security.auth.Subject.getPrivateCredentials (Subject.java:767)\n  [15] sun.security.jgss.GSSUtil$1.run (GSSUtil.java:340)\n  [16] sun.security.jgss.GSSUtil$1.run (GSSUtil.java:332)\n  [17] java.security.AccessController.doPrivileged (native method)\n  [18] sun.security.jgss.GSSUtil.searchSubject (GSSUtil.java:332)\n  [19] sun.security.jgss.wrapper.NativeGSSFactory.getCredFromSubject (NativeGSSFactory.java:53)\n  [20] sun.security.jgss.wrapper.NativeGSSFactory.getCredentialElement (NativeGSSFactory.java:116)\n  [21] sun.security.jgss.GSSManagerImpl.getCredentialElement (GSSManagerImpl.java:193)\n  [22] sun.security.jgss.GSSCredentialImpl.add (GSSCredentialImpl.java:427)\n  [23] sun.security.jgss.GSSCredentialImpl.<init> (GSSCredentialImpl.java:62)\n  [24] sun.security.jgss.GSSManagerImpl.createCredential (GSSManagerImpl.java:154)\n  [25] com.sun.security.sasl.gsskerb.GssKrb5Server.<init> (GssKrb5Server.java:108)\n  [26] com.sun.security.sasl.gsskerb.FactoryImpl.createSaslServer (FactoryImpl.java:85)\n  [27] javax.security.sasl.Sasl.createSaslServer (Sasl.java:524)\n  [28] org.apache.zookeeper.server.ZooKeeperSaslServer$1.run (ZooKeeperSaslServer.java:118)\n  [29] org.apache.zookeeper.server.ZooKeeperSaslServer$1.run (ZooKeeperSaslServer.java:114)\n  [30] java.security.AccessController.doPrivileged (native method)\n  [31] javax.security.auth.Subject.doAs (Subject.java:422)\n  [32] org.apache.zookeeper.server.ZooKeeperSaslServer.createSaslServer (ZooKeeperSaslServer.java:114)\n  [33] org.apache.zookeeper.server.ZooKeeperSaslServer.<init> (ZooKeeperSaslServer.java:48)\n  [34] org.apache.zookeeper.server.NIOServerCnxn.<init> (NIOServerCnxn.java:100)\n  [35] org.apache.zookeeper.server.NIOServerCnxnFactory.createConnection (NIOServerCnxnFactory.java:161)\n  [36] org.apache.zookeeper.server.NIOServerCnxnFactory.run (NIOServerCnxnFactory.java:202)\n  [37] java.lang.Thread.run (Thread.java:745)\n{noformat}\n\nThis doesn't happen when we use JGSS, I think because adding credential to privateCredential set for every connection is causing Subject.doAS() to take much longer time.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12830500","id":"12830500","filename":"ZOOKEEPER-2230.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-27T12:37:12.018+0000","size":2533,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12830500/ZOOKEEPER-2230.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Connections fo ZooKeeper server becomes slow over time with native GSSAPI","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"OS: RHEL6\nJava: 1.8.0_40\nConfiguration:\n\njava.env:\n{noformat}\nSERVER_JVMFLAGS=\"$SERVER_JVMFLAGS -Xmx5120m\"\nSERVER_JVMFLAGS=\"$SERVER_JVMFLAGS -Djava.security.auth.login.config=/local/apps/zookeeper-test1/conf/jaas-server.conf\"\nSERVER_JVMFLAGS=\"$SERVER_JVMFLAGS -Dsun.security.jgss.native=true\"\n{noformat}\n\njaas-server.conf:\n{noformat}\nServer {\n    com.sun.security.auth.module.Krb5LoginModule required\n    useKeyTab=true\n    isInitiator=false\n    principal=\"zookeeper/<hostname>@<REALM>\";\n};\n{noformat}\n\nProcess environment:\n{noformat}\nKRB5_KTNAME=/local/apps/zookeeper-test1/conf/keytab\nZOO_LOG_DIR=/local/apps/zookeeper-test1/log\nZOOCFGDIR=/local/apps/zookeeper-test1/conf\n{noformat}","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/14732467","id":"14732467","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rgs","name":"rgs","key":"rgs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rgs&avatarId=18469","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rgs&avatarId=18469","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rgs&avatarId=18469","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rgs&avatarId=18469"},"displayName":"Raul Gutierrez Segales","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for reporting this [~deepeshreja]. Are you working on tthis [~enis]? Happy to help with reviews. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rgs","name":"rgs","key":"rgs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rgs&avatarId=18469","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rgs&avatarId=18469","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rgs&avatarId=18469","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rgs&avatarId=18469"},"displayName":"Raul Gutierrez Segales","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-06T17:28:36.390+0000","updated":"2015-09-06T17:28:36.390+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15526040","id":"15526040","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12830500/ZOOKEEPER-2230.patch\n  against trunk revision ec20c5434cc8a334b3fd25e27d26dccf4793c8f3.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3456//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3456//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3456//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-27T12:56:53.395+0000","updated":"2016-09-27T12:56:53.395+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15526214","id":"15526214","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~rgs],\n\nI've figured out the issue and the came up with the attached patch. Can you please review it and push it further?\n\nThanks,\nDeepesh\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-27T13:57:08.708+0000","updated":"2016-09-27T13:57:08.708+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15526223","id":"15526223","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":">> -1 tests included. The patch doesn't appear to include any new or modified tests.\nI don't think this needs a new tests because it doesn't really include a new function/class or change a lot in the function.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-27T14:00:05.314+0000","updated":"2016-09-27T14:00:05.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15562377","id":"15562377","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~rgs],\n\nCan you please review the patch and merge it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-10-10T13:54:08.403+0000","updated":"2016-10-10T13:54:08.403+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15608199","id":"15608199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~ekoontz]/[~mahadev],\n\nFrom ZOOKEEPER-938, I feel that you might be interested in this patch. Can you please review and merge this?\n\nThanks,\nDeepesh\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-10-26T11:36:30.447+0000","updated":"2016-10-26T11:36:30.447+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15623982","id":"15623982","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=enis","name":"enis","key":"enis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Enis Soztutar","active":true,"timeZone":"America/Los_Angeles"},"body":"cc [~cnauroth]. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=enis","name":"enis","key":"enis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Enis Soztutar","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-11-01T01:21:45.809+0000","updated":"2016-11-01T01:21:45.809+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15690439","id":"15690439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fittey","name":"fittey","key":"fittey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yan Fitterer","active":true,"timeZone":"America/New_York"},"body":" I have hit this issue too, but the proposed patch did not work (caused the server to fail to authenticate all connections). The reason is that in my case, upon instantiation of the subject, it gets an initial (invalid, I believe) entry in the Private Credentials list that stringifies to:\n\n/path/to/keytab/file for username/host.name@DOMAIN.COM\n\nso the isEmpty() check never evaluates to true. I had to allow it to add one additional cred (which looks like this in the logs):\n\n [GSSCredential: \\nusername@host.name.com 1.2.840.113554.1.2.2 Accept [class sun.security.jgss.wrapper.GSSCredElement]]\n\nIt then works a charm.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fittey","name":"fittey","key":"fittey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yan Fitterer","active":true,"timeZone":"America/New_York"},"created":"2016-11-23T15:38:16.348+0000","updated":"2016-11-23T15:38:16.348+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15692157","id":"15692157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":"I am not sure why the first credential in Private Credentials set is keytab file name. We are running proposed patch in Production and we are not seeing any issues.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-11-24T04:29:50.459+0000","updated":"2016-11-24T04:29:50.459+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15707509","id":"15707509","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":"[~fittey] Can you provide us your zookeeper configurations like jaas.conf, Java properties set while starting ZooKeeper, etc.? I'll try to reproduce it in my environment and see if I can come to a conclusion.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-11-30T04:34:09.838+0000","updated":"2016-11-30T04:34:09.838+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15709434","id":"15709434","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fittey","name":"fittey","key":"fittey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yan Fitterer","active":true,"timeZone":"America/New_York"},"body":"[~deepeshreja]: sure. See below. I am working on a different patch that should be more compatible though. When using native Kerberos, the subject.doAs() is entirely unnecessary. The required SaslServer can be simply created and returned. The native libs will do the right thing, and find the correct principal from the available tickets (or request one if necessary).\n\nInvocation line:\n\n{quote}\n/path/to/jdk_1_8_0_91/bin/java\n -Dzookeeper.log.dir=/path/to/logfile \n -Dzookeeper.root.logger=INFO,CONSOLE \n -cp /path/to/jars:/more/jars: \n -Dvisualvm.display.name=friendly_name\n -Xmx4G\n -XX:+UseG1GC\n -Dcom.sun.management.jmxremote.port=<jmxport>\n -Dcom.sun.management.jmxremote.authenticate=false\n -Dcom.sun.management.jmxremote.rmi.port=<port>\n -Dcom.sun.management.jmxremote.ssl=false\n -Dlog4j.configuration=file:/path/to/log4j.properties\n -Dzookeeper.superUser=user/this.host.com@KERB.DOM\n-Dzookeeper.DigestAuthenticationProvider.superDigest=user:<DIGEST>=\n -Dcom.sun.management.jmxremote\n -Dcom.sun.management.jmxremote.local.only=false \n org.apache.zookeeper.server.quorum.QuorumPeerMain /path/to/zoo.cfg\n{quote}\n\nRelevant envvars:\n\n{quote}\nKRB5_KTNAME=\"/path/to/keytab/file\"\nKRB5_TRACE=/dev/stdout\n{quote}\n\n\nJaas config file:\n\n{quote}\nServer \\{\n    com.sun.security.auth.module.Krb5LoginModule required\n    useKeyTab=true\n    storeKey=true\n    isInitiator=false\n    keyTab=\"/path/to/keytab/file\"\n    principal=\"user/qualifited.hostname.com@KERB_REALM\";\n\\};\n\nClient \\{\n    com.sun.security.auth.module.Krb5LoginModule required\n    useTicketCache=true;\n\\};\n{quote}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fittey","name":"fittey","key":"fittey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yan Fitterer","active":true,"timeZone":"America/New_York"},"created":"2016-11-30T19:02:21.655+0000","updated":"2016-11-30T19:03:50.515+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15751226","id":"15751226","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"body":"[~fittey] I think you are seeing different behavior because of setting \"storeKey\" to true which adds principal's key in the Subject's private credentials set. Due to this, there is always an entry in the set.\n\nI'll see if I can come up with something so that this also work when \"storeKey\" is set to True.\n\nAlso, please let me know if you have something or need help on the patch you are working on.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepeshreja","name":"deepeshreja","key":"deepeshreja","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepesh Reja","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-12-15T12:16:40.858+0000","updated":"2016-12-15T12:16:40.858+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15751260","id":"15751260","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12830500/ZOOKEEPER-2230.patch\n  against trunk revision cd0e323831c8b4cde64976325bfc79bb53cdd9b7.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3548//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3548//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3548//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-15T12:37:23.468+0000","updated":"2016-12-15T12:37:23.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15859895","id":"15859895","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user yvf opened a pull request:\n\n    https://github.com/apache/zookeeper/pull/166\n\n    ZOOKEEPER-2230: fix ever-increasing auth times when using jgss native Kerberos lib\n\n    This is a more generic fix for the issue reported in ZOOKEEPER-2230. The patch already proposed in the issue did not work for me, but this does, and should work for all use cases with the native Kerberos libs. In particular, I do not specify the serverName in the createSaslServer, so that any service principal present in the keytab may be used. \n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/yvf/zookeeper ZOOKEEPER-2230-3.4\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/zookeeper/pull/166.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #166\n    \n----\ncommit 84d1259a47ca37e4351a2824bc6a40011acd2da3\nAuthor: Yan Fitterer <yan.fitterer@twosigma.com>\nDate:   2017-02-08T02:50:42Z\n\n    ZOOKEEPER-2230: fixed ever-increasing auth times when using jgss native Kerberos libraries\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-09T17:49:42.134+0000","updated":"2017-02-09T17:49:42.134+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12842215/comment/15859905","id":"15859905","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fittey","name":"fittey","key":"fittey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yan Fitterer","active":true,"timeZone":"America/New_York"},"body":"[~deepeshreja] See my change in the PR above. That patch works for us, and I'm hoping it's good for all. If folks are happy with merging this, I will do an equivalent patch on the 3.5 branch, and master. When I last looked, 3.5 had the same issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fittey","name":"fittey","key":"fittey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yan Fitterer","active":true,"timeZone":"America/New_York"},"created":"2017-02-09T17:54:50.787+0000","updated":"2017-02-09T17:54:50.787+0000"}],"maxResults":15,"total":15,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2230/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2grxb:"}}