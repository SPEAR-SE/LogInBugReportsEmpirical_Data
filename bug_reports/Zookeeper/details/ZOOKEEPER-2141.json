{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12782166","self":"https://issues.apache.org/jira/rest/api/2/issue/12782166","key":"ZOOKEEPER-2141","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334700","id":"12334700","description":"Fix release against 3.4 branch","name":"3.4.9","archived":false,"released":true,"releaseDate":"2016-09-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12331981","id":"12331981","description":"Alpha release against 3.5 branch","name":"3.5.2","archived":false,"released":true,"releaseDate":"2016-07-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-11-12T14:59:56.775+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Apr 06 18:53:40 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_4_*:*_21441242694_*|*_3_*:*_1_*:*_50983_*|*_4_*:*_1_*:*_37367481_*|*_5_*:*_2_*:*_22131003_*|*_10002_*:*_6_*:*_11963662799","customfield_12312321":null,"resolutiondate":"2016-04-06T18:09:26.788+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2141/watchers","watchCount":8,"isWatching":false},"created":"2015-03-16T10:28:31.874+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"8.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323310","id":"12323310","description":"Fix release against 3.4 branch","name":"3.4.6","archived":false,"released":true,"releaseDate":"2014-03-10"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-07-21T20:18:31.148+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The problem and potential solutions are discussed in http://mail-archives.apache.org/mod_mbox/zookeeper-user/201502.mbox/browser\n\nI will attach a proposed patch in due course.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12796401","id":"12796401","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-31T20:53:04.769+0000","size":4708,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12796401/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12796041","id":"12796041","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T09:08:06.591+0000","size":3778,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12796041/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12793634","id":"12793634","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T21:04:40.714+0000","size":30974,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12793634/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12793592","id":"12793592","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T17:10:04.893+0000","size":30932,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12793592/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12793498","id":"12793498","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T08:18:18.238+0000","size":30932,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12793498/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12792212","id":"12792212","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-09T09:13:11.049+0000","size":29030,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12792212/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12771977","id":"12771977","filename":"ZOOKEEPER-2141.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karold","name":"karold","key":"karold","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karol Dudzinski","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-12T14:53:37.518+0000","size":33062,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12771977/ZOOKEEPER-2141.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12795560","id":"12795560","filename":"ZOOKEEPER-2141-3.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-27T21:18:06.882+0000","size":33160,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12795560/ZOOKEEPER-2141-3.4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ACL cache in DataTree never removes entries","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karold","name":"karold","key":"karold","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karol Dudzinski","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karold","name":"karold","key":"karold","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karol Dudzinski","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15002182","id":"15002182","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karold","name":"karold","key":"karold","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karol Dudzinski","active":true,"timeZone":"Etc/UTC"},"body":"I'm attaching a patch which implements the reference counted solution discussed on email.  This patch is for the 3.4 branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karold","name":"karold","key":"karold","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karol Dudzinski","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-12T14:53:11.720+0000","updated":"2015-11-12T14:53:11.720+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15002206","id":"15002206","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12771977/ZOOKEEPER-2141.patch\n  against trunk revision 1713774.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2955//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-12T14:59:56.775+0000","updated":"2015-11-12T14:59:56.775+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15186805","id":"15186805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Attaching trunk patch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-09T09:13:11.053+0000","updated":"2016-03-09T09:13:11.053+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15187012","id":"15187012","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12792212/ZOOKEEPER-2141.patch\n  against trunk revision 1733679.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 3 new Findbugs (version 2.0.3) warnings.\n\n    -1 release audit.  The applied patch generated 2 release audit warnings (more than the trunk's current 0 warnings).\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3094//testReport/\nRelease audit warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3094//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3094//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3094//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-09T12:21:22.006+0000","updated":"2016-03-09T12:21:22.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15188407","id":"15188407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"qabot identified a couple issues:\n\n1) missing license headers in the new files\n2) findbugs noticed some locking issues.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-03-10T00:49:21.617+0000","updated":"2016-03-10T00:49:31.985+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15188871","id":"15188871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I'll take a look and fix these - thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-10T07:54:25.575+0000","updated":"2016-03-10T07:54:25.575+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15190767","id":"15190767","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Including fix for findbugs issues and headers","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-11T10:22:53.298+0000","updated":"2016-03-11T10:22:53.298+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15194909","id":"15194909","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"QA bot didn't pick up my last patch upload - JIRA was being incredibly slow at the time so I don't know if that was related. Uploading the patch again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T08:18:18.243+0000","updated":"2016-03-15T08:18:18.243+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15195603","id":"15195603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Adam. qabot only looks at jiras in the \"patch availabile\" state. You need to \"submit patch\" button for that to happen.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-03-15T16:39:26.418+0000","updated":"2016-03-15T16:39:26.418+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15195613","id":"15195613","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Thanks Patrick. It looks like I did it correctly the first time but not subsequently.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T16:44:18.608+0000","updated":"2016-03-15T16:44:18.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15195621","id":"15195621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Ticket in correct state now - uploading patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T16:48:45.262+0000","updated":"2016-03-15T16:48:45.262+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15195968","id":"15195968","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12793592/ZOOKEEPER-2141.patch\n  against trunk revision 1735116.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3099//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3099//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3099//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-15T18:55:37.127+0000","updated":"2016-03-15T18:55:37.127+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15195985","id":"15195985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I don't think the test failure was related to my change but it does look like I might have missed a find bugs warning - sorry about that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T19:04:49.437+0000","updated":"2016-03-15T19:04:49.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15196255","id":"15196255","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Patrick,\n\nThe remaining findbugs complaint was the lack of synchronisation around \"that.aclIndex\" in the equals(). The equals is only used by the tests and if passing the findbugs were not a requirement I probably wouldn't have been too worried about it - I'm not generally fond of an equals including mutable fields. I've added the synchronized(that) block in for now. Please do let me know if you don't think this is appropriate and would prefer something else like moving the equals logic to the test class only. \n\nI ran test-core-java again locally and  ReconfigRecoveryTest.testCurrentObserverIsParticipantInNewConfig passed. Given the tests in ReconfigRecoveryTest seem a little intermittent on the trunk right now (https://builds.apache.org/job/ZooKeeper-trunk-jdk8/521/) I don't think this was related to my change.\n\nDo let me know if you have any feedback on the code and I'll have a crack at any changes that you'd like to see.\n\nThanks,\nAdam","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-15T21:04:40.717+0000","updated":"2016-03-15T21:04:40.717+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15196549","id":"15196549","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12793634/ZOOKEEPER-2141.patch\n  against trunk revision 1735116.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3101//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3101//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3101//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-16T00:34:41.000+0000","updated":"2016-03-16T00:34:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15197318","id":"15197318","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"It's failing in AsyncHammerTest. Not sure if this is a flaky test or not. [~adammilnesmith_gs] if you'll run that test locally and see if you think it should pass, I'll review this and get it committed. Thanks for this, nice to see you folks contributing!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-16T13:36:40.898+0000","updated":"2016-03-16T13:36:40.898+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15197532","id":"15197532","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Thanks [~fournc]. AsyncHammerTest was passing for me locally before I uploaded the most recent patch and it didn't fail AsyncHammerTest in the version of the patch before that either (PreCommit-ZOOKEEPER-Build/3099). The only change between patches was a synchronize block in an equals that is only invoked by the new test included in the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-16T15:45:44.963+0000","updated":"2016-03-16T15:45:44.963+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15199206","id":"15199206","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I just ran the failing test locally 5 times with the patch and 5 times without the patch; it succeeded every time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-17T09:31:00.207+0000","updated":"2016-03-17T09:31:00.207+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15199812","id":"15199812","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12793634/ZOOKEEPER-2141.patch\n  against trunk revision 1735369.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3105//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3105//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3105//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-17T16:16:50.514+0000","updated":"2016-03-17T16:16:50.514+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15200102","id":"15200102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"This one failed on a cpp test....\n TestReconfigServer::testRemoveConnectedFollowerStarting zookeeper ... FAILED TO START\n\nIs this test flaky? Does anyone know? I don't think I can run the cpp tests from my computer.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-17T18:24:43.673+0000","updated":"2016-03-17T18:24:43.673+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15203108","id":"15203108","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12793634/ZOOKEEPER-2141.patch\n  against trunk revision 1735836.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3112//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3112//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3112//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-20T04:53:41.282+0000","updated":"2016-03-20T04:53:41.282+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15204790","id":"15204790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Do you all want this fixed on the 3.4 branch? The patch will only apply to trunk currently. LMK.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-21T18:13:24.011+0000","updated":"2016-03-21T18:13:24.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15204817","id":"15204817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Fixing this for the 3.4 branch too would be ideal. Would you like me to provide a modified patch for the 3.4 branch? If so, should I attach it in the same way or differently for the branch version?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-21T18:27:06.875+0000","updated":"2016-03-21T18:27:06.875+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15204821","id":"15204821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Yes please just make a patch that applies to the 3.4 branch and attach it here with a naming indication that it's for 3.4. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-21T18:29:20.036+0000","updated":"2016-03-21T18:29:20.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15204840","id":"15204840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"No problem - will do - I should have some time one evening this week to do it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-21T18:34:45.338+0000","updated":"2016-03-21T18:34:45.338+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15207522","id":"15207522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Reviewed the patch against trunk, +1 on that and checked in. Waiting on patch against 3.4. Checking existing patch against 3.5.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-22T23:32:49.135+0000","updated":"2016-03-22T23:32:49.135+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15207534","id":"15207534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Into 3.5 as well. Just waiting on 3.4.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-22T23:37:01.280+0000","updated":"2016-03-22T23:37:01.280+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15207709","id":"15207709","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in ZooKeeper-trunk #2865 (See [https://builds.apache.org/job/ZooKeeper-trunk/2865/])\nZOOKEEPER-2141. ACL cache in DataTree never removes entries\n(Adam Milne-Smith via camille) (camille: [http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1736259])\n* trunk\n* trunk/CHANGES.txt\n* trunk/src/java/main/org/apache/zookeeper/server/DataTree.java\n* trunk/src/java/main/org/apache/zookeeper/server/FinalRequestProcessor.java\n* trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java\n* trunk/src/java/main/org/apache/zookeeper/server/ReferenceCountedACLCache.java\n* trunk/src/java/main/org/apache/zookeeper/server/ZKDatabase.java\n* trunk/src/java/test/org/apache/zookeeper/server/ReferenceCountedACLCacheTest.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-23T01:48:13.443+0000","updated":"2016-03-23T01:48:13.443+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15213623","id":"15213623","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Sorry for the delay - I've attached a patch for the 3.4 branch. I ran test-core-java successfully twice. If there are any issues with it please let me know. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-27T21:18:06.893+0000","updated":"2016-03-27T21:18:06.893+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15213625","id":"15213625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12795560/ZOOKEEPER-2141-3.4.patch\n  against trunk revision 1736259.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3123//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-27T21:20:20.122+0000","updated":"2016-03-27T21:20:20.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15213628","id":"15213628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"QA bot tried to apply the 3.4 branch patch to trunk, hence the failure above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-27T21:29:04.618+0000","updated":"2016-03-27T21:29:04.618+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15216359","id":"15216359","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"This is great, +1 on all of it, I've applied to trunk, 3.5 and 3.4. Thank you all!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-29T17:15:23.118+0000","updated":"2016-03-29T17:15:23.118+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15216993","id":"15216993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"Hi [~adammilnesmith] and [~fournc], I am *really* sorry for only having (limited) time to review/check this patch after it has been committed to trunk. :( So, please, take it more like a couple of highlights, if you like.\n\nThe patch is really cool, and great work, but I have seen some things that raised some questions I would like to point, plus a couple of minor (i.e., irrelevant) issues.\n\n1. The piece of code below, from {{ReferenceCountedACLCache}}, worried me a bit:\n\n{code}\npublic synchronized boolean equals(Object o) {\n\tif (this == o) return true;\n\tif (o == null || getClass() != o.getClass()) return false;\n\n    ReferenceCountedACLCache that = (ReferenceCountedACLCache) o;\n    synchronized (that) {\n            if (aclIndex != that.aclIndex) return false;\n    }    \n        (...)\n{code}\n\nSee, we are acquiring a lock of object {{foo1}} and then acquiring the lock of object {{foo2}} ({{that}}, in this case) inside it. My question is: wouldn't this potentially leads to a DEADLOCK? I mean, imagine a situation below, or something alike:\n\n{code}\nThread-1: foo1.equals(foo2);\nThread-2: foo2.equals(foo1);\n{code}\n\nI guess that with the *right thread interleaving*, it could lead to a deadlock. I was so amused by this possibility that wrote a dummy snippet to evaluate  this, as you can see here (with appropriate insertion of  {{Thread.sleeps}} to reproduce the desired interleaving):\n\nhttps://gist.github.com/eribeiro/bd2aca6fbae0255b64ba0b4f896e6a8d\n\nand got some runs to successfully reproduce a deadlock as seen here:\n\nhttps://gist.github.com/eribeiro/96f95b295a4b90c0d261057d4542063a\n\nDisclaimer: maybe this situation NEVER happens in this particular case (if so, sorry for disturbing you, *really*), but I thought it was worth mentioning. ;)\n\nI *guess* a possible solution would be to make {{aclIndex}} a {{volatile}} variable as a \"lightweight\" alternative to {{synchronized}}, right? Volatile makes has a happens before semantic and it prevents reordering of statements. Wdyt?\n\n2. The inherited code has the following snippet (now moved to {{ReferenceCountedACLCache}}):\n\n{code}\npublic synchronized Long convertAcls(List<ACL> acls) {\n\tif (acls == null)\n\t\treturn -1L;\n{code}\n\nWhat if the acls list is empty, i.e., {{acls = new ArrayList<>()}}? It's okay to cache an empty ACL {{List}} or could we just change the lines above to:\n\n{code}\npublic synchronized Long convertAcls(List<ACL> acls) {\n\tif (acls == null || acls.isEmpty())\n\t\treturn -1L;\n{code}\n\nAgain, this can NEVER happen in this case above so, I am all for letting it as-is today. :)\n \n \n 3. The comment in the following snippet seems a bit out of date (list of longs???):\n \n {code}\n    /**\n     * converts the list of acls to a list of longs.\n     * Increments the reference counter for this ACL.\n     * @param acls\n     * @return a list of longs that map to the acls\n     */\n    public synchronized Long convertAcls(List<ACL> acls) {\n{code}\n\n 4. AtomicLongWithEquals extends AtomicLong. I failed to see a _good_ reason to create a custom AtomicLong, as its instances are not used as keys. What is the rationale behind this? Disclaimer: IMO, extending a j.u. library is an anti-pattern as we don't have control over it and future changes in the parent class can easily break the codebase.\n \n \n 5. ReferenceCountedACLCache.OPEN_UNSAFE_ACL_ID could be made static besides being final.\n \n 6. ReferenceCountedACLCacheTest#convertACLsNTimes performs n-1 convertions as seen here (see the ``<`` and the ``-1``):\n \n{code}\n\tfor (int i = 0; i < num -1; i++) {\n\t\tcache.convertAcls(acl);\n\t}\n{code}\n\nIs this the intended behaviour?\n\nThere are other irrelevant observations, but I will refrain myself from citing them by now.\n\nCheers!\nEddie","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2016-03-29T22:38:05.643+0000","updated":"2016-03-29T22:38:05.643+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217052","id":"15217052","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Nice catch Eddie. Issue #1 is worth addressing, I'm less sure about the rest. \n[~adammilnesmith] why did you synchronize that value in the equals?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-29T23:24:25.853+0000","updated":"2016-03-29T23:24:25.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217445","id":"15217445","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"I'm changing the priority to blocker to make sure we don't ship the next release with a deadlock in it. Thanks a lot [~eribeiro].","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-03-30T05:51:52.183+0000","updated":"2016-03-30T05:51:52.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217496","id":"15217496","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Ok, I checked the code [~eribeiro] has pointed out and it seems to be fairly harmless because it is in the equals code of the new cache class and I haven't seen it called anywhere else other than one test case ({{testSerializeDesirialize}}). We should fix it nonetheless.\n\nCan we simply remove that synchronization block around {{aclIndex}}? Would it make a significant difference to the semantics of the method? Also, since we are on the topic, has anyone checked carefully the synchronization in this patch? There are 22 matches and some of them were part of the code base already. I'm sure [~adammilnesmith] checked it carefully, but I wonder if [~fournc] or maybe [~phunt] have been able to do it too just to have a second opinion. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-03-30T06:31:22.960+0000","updated":"2016-03-30T06:31:22.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217511","id":"15217511","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I think I made a comment about being uncertain about it further up in the thread somewhere but it was to make findbugs be quiet. I justified it as only used in a test and suggested I move it to the test code if you wanted.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T06:44:20.222+0000","updated":"2016-03-30T06:44:20.222+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217516","id":"15217516","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I checked it carefully before findbugs suggested some synchronisation changes which I might have been too quick to adopt so I may have made some mistakes there. The feedback is greatly appreciated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T06:51:10.321+0000","updated":"2016-03-30T06:51:10.321+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217529","id":"15217529","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Thanks [~eribeiro] - I'll take a stab at fixing some of these.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T07:02:22.258+0000","updated":"2016-03-30T07:02:22.258+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217566","id":"15217566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"To remove the deadlock concerns in the equals(), I was considering just making the access package local on those fields and moving the equals logic to the test class given this is the only place that uses it. Does this sound reasonable?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T07:20:11.766+0000","updated":"2016-03-30T07:20:11.766+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217648","id":"15217648","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"That's an option and I'm fine if you want to move the code to the tests, but I'm thinking that you have a couple of other options here:\n\n# Make the synchronization of this and that non-overlapping. You can remove the synchronized modifier from the signature, have a {{synchronized (that)}} block that collects the values of the variables to be compared, and have a {{synchronized (this)} block that performs the comparisons with the local instance variables.\n# Make aclIndex an AtomicLong would also work, although it might be overkill.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-03-30T08:24:07.980+0000","updated":"2016-03-30T08:24:07.980+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217663","id":"15217663","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I had been tempted to move the equals out on the basis of it not being required by any main code but happy to go with option 1. I can make that change now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T08:38:17.617+0000","updated":"2016-03-30T08:38:17.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217692","id":"15217692","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Responses to each (now that I'm at a computer):\n1. Absolutely - will provide a patch for this very shortly.\n2. Good question - I would have assumed if a node were assigned no acls at all then it should have no access rather than open unsafe. I believe there is no change in behaviour from this patch though.\n3. I'll correct this in the aforementioned patch.\n4. It was to be able to lean on the Map.equals() where there is an AtomicLong as the value - happy to make this change if desired.\n5. I'll correct this in the aforementioned patch.\n6. This is the intended behaviour as the line after the for loop calls it an extra time and returns.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T09:02:33.867+0000","updated":"2016-03-30T09:02:33.867+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217696","id":"15217696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Attaching trunk patch for equals() synchronization as discussed. Unlike before, this should apply to the 3.4 branch too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T09:08:06.595+0000","updated":"2016-03-30T09:08:06.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217757","id":"15217757","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12796041/ZOOKEEPER-2141.patch\n  against trunk revision 1736259.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3129//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3129//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3129//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-30T10:10:47.770+0000","updated":"2016-03-30T10:10:47.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217762","id":"15217762","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Notes on the pre-commit build results above:\n- No new tests: I didn't include a test for the change to the equals. Would you like me to add a test to show deadlocking isn't possible?\n- Core unit test failure: Some of the reconfig tests failed - they don't call any code touched by this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T10:17:48.556+0000","updated":"2016-03-30T10:17:48.556+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217794","id":"15217794","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I've provided a patch for using option 1. The only remaining issue I can see with this is that we are delegating to HashMap.equals() which could result in a ConcurrentModificationException if another method was called on \"that\" concurrently. I can't envisage a reason why main code would have 2 ACL caches and compare them, but if we wanted to be cautious so this doesn't come back to bite anyone later, we could replace the HashMaps with ConcurrentHashMaps.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T10:54:04.952+0000","updated":"2016-03-30T10:54:04.952+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217921","id":"15217921","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"Hi [~adammilnesmith], I will try to check your patch today. :)\n\nNevertheless, I would like to step back a bit and ask you *what would be the gain of having an equality check between two caches*? Why not get rid of the {{equals()}} in {{ReferenceCountedACLCache}} and let the equality be handled by the parent Object class (i.e., using the object reference)? Maybe, to make Findbugs happy it would be rewritten as:\n\n{code}\npublic synchronized equals(Object object) {\n   return this == object;\n}\n{code}\n\n\nCaches are highly changing objects so I don't see any multi-threading {{equals()}} implementation being short of complex and error prone (beside that, two caches can be equal now and different a second later). And I question myself if there will be a really compelling reason to check for equality besides the test that [~fpj] pointed out. IMHO, we could also change {{testSerializeDeserialize}} to assert the class fields to make sure the serialization/deserialization worked fine.\n\nFurthermore, it's class is mean to be used by {{DataTree}} only so a single instance is okay, imho. But I am certainly missing some points here, so I would be glad if you help me figure it out a scenario where semantic equality is really necessary here by users of the cache.\n\nRegards,\nEddie","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2016-03-30T12:56:03.699+0000","updated":"2016-03-30T12:56:03.699+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217934","id":"15217934","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I completely agree, I can't envisage a reason why main code would have 2 ACL caches and compare them, hence my suggestion above to make the access package local on those fields and moving the equals logic to the test class. I have an alternative patch locally doing just that which I can share as well if you'd like.\n\nThanks,\nAdam","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T13:04:50.016+0000","updated":"2016-03-30T13:04:50.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217955","id":"15217955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Providing alternative patch with no equals on the cache itself and an assertCachesEqual method in the test instead.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T13:22:24.213+0000","updated":"2016-03-30T13:22:24.213+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15217962","id":"15217962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I've provided the alternative patch for consideration (ZOOKEEPER-2141-equalsMovedToTest.patch) without an equals on the cache. Happy for either to be used. This one is my preference but this is my first contribution and it's not really my call.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-30T13:27:25.509+0000","updated":"2016-03-30T13:27:25.509+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15220606","id":"15220606","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"I'm fine with the version that moves the assertion to the test. I think you've introduced some white spaces in and I was wondering if you could just elaborate a bit on this comments:\n\n{noformat}\n-\n+    \n     /*\n     For reasons we don't all agree with, AtomicLong does not have an equals.\n      */\n{noformat}\n\nboth really minor, hope you don't mind.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-03-31T20:22:43.897+0000","updated":"2016-03-31T20:22:43.897+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15220636","id":"15220636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"I didn't notice which bit of whitespace was introduced  but will look for and remove it. I'll remove the comment too and provide a new patch in the morning. The initial pass on a patch was a while ago but I think it was some sort of nod to the JDKs reasoning for AtomicLong not having a semantic equals - this shouldn't have made it into the patch - sorry about that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-31T20:40:40.979+0000","updated":"2016-03-31T20:40:40.979+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15220652","id":"15220652","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"body":"Here's a version with the comment and accidental whitespace removed. I'm attaching it as ZOOKEEPER-2141.patch and deleting the ZOOKEEPER-2141-equalsMovedToTest.patch file to remove any ambiguity in case it affects QA bot's patch choice.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adammilnesmith","name":"adammilnesmith","key":"adammilnesmith","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Adam Milne-Smith","active":true,"timeZone":"Europe/London"},"created":"2016-03-31T20:53:04.773+0000","updated":"2016-03-31T20:53:04.773+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15220677","id":"15220677","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12796401/ZOOKEEPER-2141.patch\n  against trunk revision 1736259.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3133//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3133//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3133//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-31T21:09:45.468+0000","updated":"2016-03-31T21:09:45.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15222172","id":"15222172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"OK I'm looking at this patch more carefully this time. It looks OK to me but would love for [~eribeiro] to take a look as well since he caught some details last time. If you +1 I'll check it in [~eribeiro]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-01T18:56:04.228+0000","updated":"2016-04-01T18:56:04.228+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15224818","id":"15224818","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"Hi [~fournc], thank you for your consideration! :) And sorry for the delay to answer. Well, *I looked carefully and it's +1, IMHO.*\n\n\n[~adammilnesmith], congrats for the good work! I would only to suggest a little thing (but see, this is *not* required to commit this patch, I am +1 in spite of this): you could have made {{aclIndex}} a volatile as below:\n\n{code}\nvolatile long aclIndex = 0;\n{code}\n\nSee this link for further information about the advantage of using {{volatiles}} with long/int/double: http://stackoverflow.com/a/3038233/2698109 . But again, *I am +1 even without this change*.\n\nCheers,\nEd","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2016-04-04T18:57:30.635+0000","updated":"2016-04-04T18:57:30.635+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782166/comment/15228885","id":"15228885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in ZooKeeper-trunk #2880 (See [https://builds.apache.org/job/ZooKeeper-trunk/2880/])\nZOOKEEPER-2141 ACL cache in DataTree never removes entries (Adam Milne-Smith via camille) (camille: [http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1738012])\n* trunk/src/java/main/org/apache/zookeeper/server/ReferenceCountedACLCache.java\n* trunk/src/java/test/org/apache/zookeeper/server/ReferenceCountedACLCacheTest.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-06T18:53:40.030+0000","updated":"2016-04-06T18:53:40.030+0000"}],"maxResults":58,"total":58,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2141/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i26su7:"}}