{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12857097","self":"https://issues.apache.org/jira/rest/api/2/issue/12857097","key":"ZOOKEEPER-2251","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":12600,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326518","id":"12326518","name":"3.6.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12343268","id":"12343268","description":"Beta release against 3.5 branch","name":"3.5.5","archived":false,"released":false}],"aggregatetimespent":12600,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-08-21T09:38:23.210+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jul 27 04:14:18 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_4272743370_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_88436233796","customfield_12312321":null,"resolutiondate":"2018-07-27T03:16:40.430+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2251/watchers","watchCount":15,"isWatching":false},"created":"2015-08-19T02:47:03.330+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":["fault","pull-request-available"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334700","id":"12334700","description":"Fix release against 3.4 branch","name":"3.4.9","archived":false,"released":true,"releaseDate":"2016-09-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12331981","id":"12331981","description":"Alpha release against 3.5 branch","name":"3.5.2","archived":false,"released":true,"releaseDate":"2016-07-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339207","id":"12339207","description":"Fix release against 3.4 branch","name":"3.4.11","archived":false,"released":true,"releaseDate":"2017-11-09"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-07-27T04:14:18.471+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312381","id":"12312381","name":"java client","description":"The java client interface for ZooKeeper"}],"timeoriginalestimate":null,"description":"I came across one issue related to Client side packet response timeout In my cluster many packet drops happened for some time.\n\nOne observation is the zookeeper client got hanged. As per the thread dump it is waiting for the response/ACK for the operation performed (synchronous API used here).\nI am using zookeeper.serverCnxnFactory=org.apache.zookeeper.server.NIOServerCnxnFactory\n\nSince only few packets missed there is no DISCONNECTED event occurred.\n\nNeed add a \"response time out\" for the operations or packets.\n\n*Comments from [~rakeshr]*\nMy observation about the problem:-\n\n* Can use tools like 'Wireshark' to simulate the artificial packet loss.\n* Assume there is only one packet in the 'outgoingQueue' and unfortunately the server response packet lost. Now, client will enter into infinite waiting. https://github.com/apache/zookeeper/blob/trunk/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1515\n* Probably we can discuss more about this problem and possible solutions(add packet ACK timeout or another better approach) in the jira.\n","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"3.5h","remainingEstimateSeconds":0,"timeSpentSeconds":12600},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12765389","id":"12765389","filename":"ZOOKEEPER-2251-01.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-07T13:38:59.043+0000","size":7825,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12765389/ZOOKEEPER-2251-01.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12765520","id":"12765520","filename":"ZOOKEEPER-2251-02.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-08T04:42:44.481+0000","size":14073,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12765520/ZOOKEEPER-2251-02.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12765803","id":"12765803","filename":"ZOOKEEPER-2251-03.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-09T14:50:17.137+0000","size":11304,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12791733","id":"12791733","filename":"ZOOKEEPER-2251-04.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2016-03-07T08:05:33.208+0000","size":16861,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch"}],"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Add Client side packet response timeout to avoid infinite wait.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":12600,"total":12600,"percent":100},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":12600,"total":12600,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14706468","id":"14706468","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"body":"Hello, I'm trying to reproduce this bug.\n\nHowever I'm not sure about the meaning of \"only few packets missed\".\nIf some IP packets were lost, TCP layer (in the OS kernel) should be able to detect and retransmit lost packets.\nSo I guess the lost packets are eventually delivered to the client OS, but ZK client get hangs due to unexpected delay of the delivered packets.\n\nCould you please share your client workload and its thread dump?\n\nBTW, for partial packet loss simulation, [Linux netem|http://www.linuxfoundation.org/collaborate/workgroups/networking/netem#Packet_loss] or my [Earthquake tool|http://osrg.github.io/earthquake/post/zookeeper-2212/](found ZOOKEEPER-2212, and perhaps also reproduced ZOOKEEPER-2080) might be useful. \n(Wireshark is a packet analyzer, and doesn't provide any network simulation feature.)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-08-21T09:38:23.210+0000","updated":"2015-08-21T09:38:23.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14728996","id":"14728996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"body":"hi [~suda]\ni got this issue from one of our site. The issue is from ResourceManager.\nI could get very few info. The thread which got blocked is as follows\n\n{code}\nStandByTransitionThread Handler\" daemon prio=10 tid=0x000000000119a800 nid=0x641e3 in Object.wait() [0x00007ff3f67ab000]\n1836    java.lang.Thread.State: WAITING (on object monitor)\n1837     at java.lang.Object.wait(Native Method)\n1838     - waiting on <0x00000007855f2010> (a org.apache.zookeeper.ClientCnxn$Packet)\n1839     at java.lang.Object.wait(Object.java:503)\n1840     at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1414)\n1841     - locked <0x00000007855f2010> (a org.apache.zookeeper.ClientCnxn$Packet)\n1842     at org.apache.zookeeper.ClientCnxn.close(ClientCnxn.java:1386)\n1843     at org.apache.zookeeper.ZooKeeper.close(ZooKeeper.java:677)\n1844     - locked <0x000000078660daf0> (a org.apache.zookeeper.ZooKeeper)\n1845     at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.closeZkClients(ZKRMStateStore.java:360)\n1846     - locked <0x0000000781087940> (a org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore)\n1847     at org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore.closeInternal(ZKRMStateStore.java:382)\n1848     - locked <0x0000000781087940> (a org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore)\n1849     at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore.serviceStop(RMStateStore.java:486)\n1850     at org.apache.hadoop.service.AbstractService.stop(AbstractService.java:221)\n1851     - locked <0x00000007823b2a80> (a java.lang.Object)\n1852     at org.apache.hadoop.service.AbstractService.close(AbstractService.java:250)\n1853     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager$RMActiveServices.serviceStop(ResourceManager.java:549)\n1854     at org.apache.hadoop.service.AbstractService.stop(AbstractService.java:221)\n1855     - locked <0x00000007823d0610> (a java.lang.Object)\n1856     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.stopActiveServices(ResourceManager.java:958)\n1857     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.transitionToStandby(ResourceManager.java:1018)\n1858     - locked <0x0000000780059c60> (a org.apache.hadoop.yarn.server.resourcemanager.ResourceManager)\n1859     at org.apache.hadoop.yarn.server.resourcemanager.ResourceManager.handleTransitionToStandBy(ResourceManager.java:703)\n1860     at org.apache.hadoop.yarn.server.resourcemanager.recovery.RMStateStore$StandByTransitionThread.run(RMStateStore.java:884)\n{code}\n\nMy analysis is that it is waiting for the packet response\nHope this helps","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"created":"2015-09-03T13:00:20.295+0000","updated":"2015-09-03T13:00:20.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14730278","id":"14730278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"body":"Hi [~nijel], thank you for the information.\n\nThe [{{wait()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1515] might be waiting for this [{{notifyAll()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L736].\n\nA typical call stack for the notifyAll() is as follows:\n- {{Object.notifyAll()}}\n- [{{ClientCnxn.finishPacket()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L736]\n- [{{ClientCnxn$SendThread.readResponse()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L948]\n- [{{ClientCnxnSocketNIO.doIO()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java#L99]\n- [{{ClientCnxnSocketNIO.doTransport()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java#L361]\n- [{{ClientCnxn$SendThread.run()}}|https://github.com/apache/zookeeper/blob/7f10f9c53a48b296dd27c7a104b303b10b045a89/src/java/main/org/apache/zookeeper/ClientCnxn.java#L1236]\n\nIf you can still reproduce the bug, could you please add some logs for the above methods and share the result (plus ZooKeeper version and YARN version)?\n\nThanks\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-09-04T03:54:03.253+0000","updated":"2015-09-04T03:54:03.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14946850","id":"14946850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"How to reproduce the:\nFrom the logs it is very clear that Client is waiting in {{org.apache.zookeeper.ClientCnxn.submitRequest()}} on Packet object.\n{code}\nsynchronized (packet) {\n    while (!packet.finished) {\n        packet.wait();\n    }\n}\n{code}\nAbove wait ends when packet.notifyAll() is called from {{org.apache.zookeeper.ClientCnxn.finishPacket(Packet)}}\nTo reproduce client hang scenario through test we can override the {{org.apache.zookeeper.ClientCnxn.finishPacket(Packet)}} method, so that it does not call packet.notifyAll(). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-07T13:32:44.396+0000","updated":"2015-10-07T13:32:44.396+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14946857","id":"14946857","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"Submitting a patch to fix this issue.\nImplementation summary:\n# time out handling is done for sync API\n# added zookeeper.request.timeout property, default value is 120000 milliseconds(2 minute)\n# added new error code TIMEOUT (-122);\n# added new exception TimeoutException\n# added test case ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-07T13:38:59.047+0000","updated":"2015-10-07T13:38:59.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14946889","id":"14946889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12765389/ZOOKEEPER-2251-01.patch\n  against trunk revision 1706631.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2905//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-07T14:02:44.994+0000","updated":"2015-10-07T14:02:44.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14948067","id":"14948067","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"In previous patch, I had missed the test cases. Submitting ZOOKEEPER-2251-02.patch with test case included","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-08T04:42:44.485+0000","updated":"2015-10-08T04:42:44.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14948082","id":"14948082","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12765520/ZOOKEEPER-2251-02.patch\n  against trunk revision 1706631.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2906//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-08T05:07:52.930+0000","updated":"2015-10-08T05:07:52.930+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14948352","id":"14948352","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"body":"thanks [~arshad.mohammad] for the patch\noverall looks good\n\nfew comments\n1. The log message \n{code}\nLOG.info(\"{} configured value is {}.\", ZOOKEEPER_REQUEST_TIMEOUT,\n148\t                    requestTimeoutProp);\n{code}\ncan be written after the value is read. Or in invalid case duplicate logs will come\n\n2. Change test class and test method name to reflect timeout feature\n\n3. Number format exception logs looks like not a complete sentence.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-08T09:19:35.219+0000","updated":"2015-10-08T09:19:35.219+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14948362","id":"14948362","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"body":"One more comment\ncan you add this config in document as well ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-08T09:26:34.605+0000","updated":"2015-10-08T09:26:34.605+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14948758","id":"14948758","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"[~arshad.mohammad], the patch looks good, congrats. One question: why {{ZKClientHangTest}} creates 3 servers if the core of the test needs just one ({{clientPorts[0]}}) that the client connects to? More servers are more time to wait for the unit test to run, slowing things down.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2015-10-08T14:36:19.083+0000","updated":"2015-10-08T14:36:19.083+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14950237","id":"14950237","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~eribeiro]for looking into the patch. Quorum servers are required because this patch also hits the logic of reconnect.\nnow connecting to all the servers.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-09T11:23:44.786+0000","updated":"2015-10-09T11:23:44.786+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14950508","id":"14950508","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~nijel] for your review comments. Submitting new patch ZOOKEEPER-2251-03.patch which handles all the above comments. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-10-09T14:50:17.141+0000","updated":"2015-10-09T14:50:17.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14950697","id":"14950697","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch\n  against trunk revision 1706631.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2908//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-09T16:57:05.730+0000","updated":"2015-10-09T16:57:05.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/14951011","id":"14951011","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"Oh, I see now. :) Just a small review comment: give preference to use StringBuilder instead of StringBuffer, specially if the use is as a method variable, because StringBuffer methods are synchronized while StringBuilder methods are not.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2015-10-09T18:59:53.448+0000","updated":"2015-10-09T18:59:53.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15054528","id":"15054528","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"body":"I recently experienced this bug in my cluster.\nAny update?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-12-12T18:39:41.842+0000","updated":"2015-12-12T18:39:41.842+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15055549","id":"15055549","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"Thanks [~suda] for sharing that you experienced this problem. \nRegarding the status, implementation was done long back, review and commit is pending. Meanwhile many changes have happened so the current patch need to be rebased. I will soon rebase and submit new patch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-12-14T07:07:50.400+0000","updated":"2015-12-14T07:07:50.400+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15055604","id":"15055604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"body":"Hi [~arshad.mohammad], thank you for the response.\n\nThe attached patch assumes that a response packet can be \"lost\".\nBut I'm still not sure what \"lost\" means.\nhttps://issues.apache.org/jira/browse/ZOOKEEPER-2251?focusedCommentId=14706468&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14706468\n\nIf TCP packets are actually lost, Linux kernel (on the server) should retransmit packets.\nIf even retransmitted packets are lost, client kernel should raise {{ETIMEDOUT}} after 924.6 seconds by default. (It depends on the value of {{/proc/sys/net/ipv4/tcp_retries2}}.)\n\nSo I think infinite wait should not happen even if packets are lost.\n\nI can come up with following possibilities:\n\n1. Client kernel raised {{ETIMEDOUT}}, and JVM raised a corresponding {{java.lang.IOException}}. But client ZK did not catch the {{IOException}} correctly. It's a bug of client.\n\n2. Server sent a TCP FIN packet. Client received the TCP FIN packet and raised {{IOException}}, but client ZK did not catch the {{IOException}} correctly. It's a bug of client.\n\n3. No TCP FIN packet were sent. It's a bug of server.\n\n4. Bug of kernel or JVM.\n\n\nI think we should dig out what really happens when we hit the bug, before merging the patch and closing the JIRA.\n\n(No matter what is the real cause of the bug, the patch is useful! Because non-privileged users cannot modify {{/proc/sys/net/ipv4/*}}.)\n\nI would like to hear your comments.\n\nI'm also trying to reproduce the bug again, and digging out what are really happening.\n\nThanks!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-12-14T08:10:44.853+0000","updated":"2015-12-14T08:10:44.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15056085","id":"15056085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"I think irrespective of the reason, why packet(server response) not received, there should be some time-out. Can not keep waiting infinitely\n{code}\nsynchronized (packet) {\n    while (!packet.finished) {\n        packet.wait();\n    }\n}\n{code}\nSeems you have good system understanding. please share if you find the reason.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2015-12-14T15:14:45.150+0000","updated":"2015-12-14T15:14:45.150+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15063503","id":"15063503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"body":"hi [~marshad] and [~suda]\n\nI observed this when i am doing reliability test for a banking customer\nHere we test for any network abnormality and packet drop.\n\nHere in the scenario packet is sent and wait for ever. Even if the server is not responding due to any reason, this issue can happen\n\nso my opinion is to have this time out since many services' high availability solution depends on zookeeper.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nijel","name":"nijel","key":"nijel","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"nijel","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-18T05:36:23.024+0000","updated":"2015-12-18T05:36:23.024+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15063517","id":"15063517","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12765803/ZOOKEEPER-2251-03.patch\n  against trunk revision 1720227.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2999//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-18T05:41:43.809+0000","updated":"2015-12-18T05:41:43.809+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15063565","id":"15063565","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"body":"Hi [~arshad.mohammad] and [~nijel],\nThank you for comments,\nand sorry for that I'm still not able to identify the root cause of the bug.\n\nI'm ok for having this timeout.\nI would like to respect committers' decision.\n\nCc: [~rgs] (zktraffic author), could you please look on this?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=suda","name":"suda","key":"suda","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Akihiro Suda","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-12-18T06:21:06.795+0000","updated":"2015-12-18T06:21:06.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15182726","id":"15182726","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"body":"Submitting new patch as previous patch had a deadlock scenario","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arshad.mohammad","name":"arshad.mohammad","key":"arshad.mohammad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10443","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10443","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10443","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10443"},"displayName":"Mohammad Arshad","active":true,"timeZone":"Asia/Singapore"},"created":"2016-03-07T08:05:33.212+0000","updated":"2016-03-07T08:05:33.212+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15182742","id":"15182742","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch\n  against trunk revision 1733679.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3091//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-07T08:26:48.100+0000","updated":"2016-03-07T08:26:48.100+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15495374","id":"15495374","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwhitney","name":"adamwhitney","key":"adamwhitney","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Whitney","active":true,"timeZone":"Etc/UTC"},"body":"I think I'm seeing this problem using activemq with replicated leveldb ... every once in a while our network loses some packets when zookeeper server is acking back to the zookeeper client in activemq, and intermittently it seems to lead to a hang on the activemq side. Unfortunately, I don't have the ability yet to get a thread dump, so I can't tell for sure, but the cause and symptoms of my issue match very well with this bug. It looks like this bug has passed all the reviews ... is there any reason why it is not yet merged?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwhitney","name":"adamwhitney","key":"adamwhitney","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Whitney","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-16T04:52:07.489+0000","updated":"2016-09-16T04:52:07.489+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15495560","id":"15495560","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch\n  against trunk revision b2a484cfe743116d2531fe5d1e1d78b3960c511e.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3434//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-16T06:46:04.063+0000","updated":"2016-09-16T06:46:04.063+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15702561","id":"15702561","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Hi.  We are definitely running into what looks to be this problem and I was wondering if there was any movement towards incorporating the fix into a release version?\n\nI've worked around the issue in one part of our code by wrapping my own timeout around the call that is vulnerable to the deadlock.\n\nHowever, this isn't possible in some cases where 3rd party code (in our case, Accumulo client & Thrift libraries) call down into the ZooKeeper client code and hit this.\n\nThis has become a pretty critical issue for us. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2016-11-28T17:25:16.801+0000","updated":"2016-11-28T17:25:16.801+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15702576","id":"15702576","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch\n  against trunk revision d72f27279a13986ee0c011e1e5b34edf3a310da9.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3534//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-11-28T17:29:46.467+0000","updated":"2016-11-28T17:29:46.467+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15702711","id":"15702711","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Is the problem simply that the patch needs to be updated to match the latest code?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2016-11-28T18:24:30.417+0000","updated":"2016-11-28T18:24:30.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15713491","id":"15713491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"bq. Is the problem simply that the patch needs to be updated to match the latest code?\n\n[~m.martinez] Thanks for bumping this up. Community has been working on a couple of high priority issues to prepare incoming 3.4.10 and 3.5.3 releases. This issue was not labelled with version info so it does not get much visibility in the queue. Just updated the JIRA and reviewing the patch.\n\nbq. We are definitely running into what looks to be this problem\n[~m.martinez] Which version of ZooKeeper you are running?\n\nOn a side note, the patch does look outdated (i.e. the doc changes refer to 3.5.2 which is released already) and needs to be rebased. [~arshad.mohammad] Do you mind update the patch and send a pull request on git? We can start iterating from there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2016-12-02T00:09:49.962+0000","updated":"2016-12-02T00:09:49.962+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15713743","id":"15713743","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Michael Han - we are using version 3.4.5.  \n\nWe would almost certainly upgrade to a newer version if we knew this problem would be addressed. \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2016-12-02T02:00:29.659+0000","updated":"2016-12-02T02:00:29.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15723037","id":"15723037","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user arshadmohammad opened a pull request:\n\n    https://github.com/apache/zookeeper/pull/119\n\n    ZOOKEEPER-2251:Add Client side packet response timeout to avoid infinite wait.\n\n    Add Client side packet response timeout to avoid infinite wait.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/arshadmohammad/zookeeper ZOOKEEPER-2251\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/zookeeper/pull/119.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #119\n    \n----\ncommit b4ac9f9f7f3742ac2bd08e383c9650cbf4962691\nAuthor: arshadmohammad <arshad.mohammad.k@gmail.com>\nDate:   2016-12-05T18:55:10Z\n\n    ZOOKEEPER-2251:Add Client side packet response timeout to avoid infinite wait.\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-05T18:58:42.911+0000","updated":"2016-12-05T18:58:42.911+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15723058","id":"15723058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Is 'master' the correct integration branch to point that pull request to?  \n\nI'm not familiar with the ZooKeeper project's branch strategy so I'm just asking.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2016-12-05T19:06:11.783+0000","updated":"2016-12-05T19:06:11.783+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15723085","id":"15723085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  GitHub Pull Request  Build\n      \n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/101//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-05T19:19:26.063+0000","updated":"2016-12-05T19:19:26.063+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15725558","id":"15725558","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"AFAIK, if the JIRA issue states that it fixes 3.4.10, 3.5.3, and 3.6.0 then you should point to the earliest branch (branch-3.4). When applying the PR the committer can port it to branch-3.5 and master. By the way, I advise you to see if the patch applies cleanly on branch-3.4, branch-3.5 and master so you can save committer time (that is scarce) from having to deal with conflicts. ;)\n\n_Please_, correct me if I am wrong, [~fpj], [~rgs], [~breed]. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2016-12-06T14:00:20.890+0000","updated":"2016-12-06T14:00:20.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15734533","id":"15734533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r91666999\n  \n    --- Diff: src/docs/src/documentation/content/xdocs/zookeeperProgrammers.xml ---\n    @@ -1538,6 +1538,24 @@ public abstract class ServerAuthenticationProvider implements AuthenticationProv\n                         <para>Specifies path to kinit binary. Default is \"/usr/bin/kinit\".</para>\n                     </listitem>\n                 </varlistentry>\n    +            <varlistentry>\n    +                <term>zookeeper.request.timeout</term>\n    +                <listitem>\n    +                <para>\n    +                    <emphasis role=\"bold\">New in 3.5.3:</emphasis>\n    --- End diff --\n    \n    This probably would not make to 3.5.3. 3.6.0 would be a more realistic value.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-09T06:58:38.730+0000","updated":"2016-12-09T06:58:38.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15734534","id":"15734534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r91666945\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -387,6 +389,8 @@ public void setCode(int code) {\n             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),\n             /** Attempts to remove a non-existing watcher */\n             NOWATCHER (-121),\n    +        /** Not received packet timely */\n    +        TIMEOUT (-122),\n    --- End diff --\n    \n    Similar error code needs to be added to C client to make both client library compatible.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-09T06:58:38.799+0000","updated":"2016-12-09T06:58:38.799+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15734535","id":"15734535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r91666647\n  \n    --- Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java ---\n    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,\n             Packet packet = queuePacket(h, r, request, response, null, null, null,\n                     null, watchRegistration, watchDeregistration);\n             synchronized (packet) {\n    +            long waitStartTime = System.currentTimeMillis();\n                 while (!packet.finished) {\n    -                packet.wait();\n    +                packet.wait(requestTimeout);\n    --- End diff --\n    \n    This unconditionally adds a timeout is a pretty significant semantic change. Whether or not we should wait indefinitely is a separate issue to discuss later, but from a compatibility point of view we'd at least provide a configuration option to let user opt in this feature rather than having this turned on by default. So by default there is no timeout and client still waits indefinitely, user who wants to opt in to turn on the timeout needs to explicit say so and provide a value they think make sense to them. Otherwise, we'd have to solve the problem of what the default timeout value we should set in ZK config if this feature is turned on by default, and that problem is hard and very likely there is no default value that makes everyone happy.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-09T06:58:38.813+0000","updated":"2016-12-09T06:58:38.813+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15734548","id":"15734548","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"Has anyone that watching this issue able to have a deterministic reproduce of the issue? The timeout solution is trivial but it's important to try to figure out root cause of packet loss otherwise we could just fix the surface and then have unexpected bug bite us. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2016-12-09T07:06:20.702+0000","updated":"2016-12-09T07:06:20.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15734817","id":"15734817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user wuwen5 commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r91682496\n  \n    --- Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java ---\n    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,\n             Packet packet = queuePacket(h, r, request, response, null, null, null,\n                     null, watchRegistration, watchDeregistration);\n             synchronized (packet) {\n    +            long waitStartTime = System.currentTimeMillis();\n                 while (!packet.finished) {\n    -                packet.wait();\n    +                packet.wait(requestTimeout);\n    +                if (!packet.finished && ((System.currentTimeMillis()\n    --- End diff --\n    \n    System.currentTimeMillis() is dependent on System clock. It probably micro-corrected by an external programme..\n    \n    I think using System.nanoTime() to measure elapsed time is the correct solution.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-09T09:39:06.227+0000","updated":"2016-12-09T09:39:06.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15749214","id":"15749214","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Unfortunately I don't have a simple deterministic test.  But we had an environment where two of our zookeeper servers were sharing their nodes with another cpu & memory (& thread) hungry process and this seemed to result in a lot of zookeepertimeoutexceptions at the client as well as unfortunately frequent hits on this particular deadlock (which does get caught in jvisualvm thread dumps).   We could not run more than a day or two on our sustained ingest tests without hitting this.\n\nWe've moved the two zookeepers to dedicated nodes  (the third already was on it's own node) and things have looked stable so far (on this particular issue), but my management is rightfully concerned that we should have this fix in place.\n\nWe would be perfectly fine with a parameterized wait time option and a default of the current indefinite wait.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2016-12-14T19:23:52.661+0000","updated":"2016-12-14T19:23:52.661+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15750059","id":"15750059","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"Thanks for the info, [~m.martinez]. \n\nOn a side note about sharing ZK with other processes: it is generally advised to have ZK deployed on dedicated resource - sometimes you might even want to have dedicated device for storing transaction log files. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2016-12-15T01:43:38.836+0000","updated":"2016-12-15T01:43:38.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15750088","id":"15750088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r92530333\n  \n    --- Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java ---\n    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,\n             Packet packet = queuePacket(h, r, request, response, null, null, null,\n                     null, watchRegistration, watchDeregistration);\n             synchronized (packet) {\n    +            long waitStartTime = System.currentTimeMillis();\n                 while (!packet.finished) {\n    -                packet.wait();\n    +                packet.wait(requestTimeout);\n    +                if (!packet.finished && ((System.currentTimeMillis()\n    --- End diff --\n    \n    Yes, and actually we have a Time class which we can use here that uses nanoTime internally for exact same reason. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-15T01:55:52.609+0000","updated":"2016-12-15T01:55:52.609+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15751475","id":"15751475","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Yes, we've been figuring this out.\n\nUnfortunately, customer deployment requirements can sometimes limit our control over the environment.  We are trying to make things as robust and fault tolerant as possible while still allowing for as much flexibility in how things are deployed.  There are obviously limits to that!\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2016-12-15T14:12:00.747+0000","updated":"2016-12-15T14:12:00.747+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15816184","id":"15816184","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Bumping this.   We've put in lots of mitigations around this, but we consider this still an important issue for us that needs to be resolved.   Really hope this can make it into 3.4.10.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2017-01-10T21:05:40.013+0000","updated":"2017-01-10T21:05:40.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15817267","id":"15817267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"The PR needs some update to address review comments before we can commit this. In particular, it would be good to have a feature flag that controls the on / off of client side timeout (for reasons commented in PR), also C client side work.\n\nNot sure if [~arshad.mohammad] still on this but if not, maybe [~m.martinez] you can start driving this by contributing a patch? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2017-01-11T05:44:35.857+0000","updated":"2017-01-11T05:44:35.857+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15819610","id":"15819610","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"I'll have to go through Lab protocols for approval to submit a patch.  I'll look into it.  \n\nI'll need to set up to build with Ivy against our internal Nexus as well since I'm behind a firewall.    Sigh ... busywork.  :D","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2017-01-12T00:07:19.564+0000","updated":"2017-01-12T00:07:19.564+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15820232","id":"15820232","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2017-01-12T05:34:44.469+0000","updated":"2017-01-12T05:34:44.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/15878608","id":"15878608","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"body":"Update:  I'm sorry, but I've been pulled away from this in my tasking.   This is still a real concern for us, and I think I'll eventually be able to get back to it, but it won't happen real quick.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=m.martinez","name":"m.martinez","key":"m.martinez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mel Martinez","active":true,"timeZone":"America/New_York"},"created":"2017-02-22T16:18:01.162+0000","updated":"2017-02-22T16:18:01.162+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16385516","id":"16385516","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awkejiang","name":"awkejiang","key":"awkejiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=awkejiang&avatarId=32840","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=awkejiang&avatarId=32840","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=awkejiang&avatarId=32840","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=awkejiang&avatarId=32840"},"displayName":"Ke Jiang","active":true,"timeZone":"Etc/UTC"},"body":"what's the release plan for this patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=awkejiang","name":"awkejiang","key":"awkejiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=awkejiang&avatarId=32840","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=awkejiang&avatarId=32840","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=awkejiang&avatarId=32840","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=awkejiang&avatarId=32840"},"displayName":"Ke Jiang","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-05T03:00:56.294+0000","updated":"2018-03-05T03:00:56.294+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16387776","id":"16387776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"body":"[~awkejiang]\r\n\r\nI believe that [~hanm]'s concerns have to be addressed first on GitHub.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"created":"2018-03-06T13:34:32.380+0000","updated":"2018-03-06T13:34:32.380+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16547209","id":"16547209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch\n  against trunk revision cea251a185435e88f54efc5defb92ec9584fc80f.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3697//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-17T23:20:54.201+0000","updated":"2018-07-17T23:20:54.201+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16550168","id":"16550168","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12791733/ZOOKEEPER-2251-04.patch\n  against trunk revision 4c12f75a9dd546032eafb2d2840061399c2a6a5e.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3698//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-20T03:21:13.938+0000","updated":"2018-07-20T03:21:13.938+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16552300","id":"16552300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  GitHub Pull Request  Build\n      \n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1986//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-23T03:56:54.505+0000","updated":"2018-07-23T03:56:54.505+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16559185","id":"16559185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"body":"Issue resolved by pull request 119\n[https://github.com/apache/zookeeper/pull/119]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanm","name":"hanm","key":"hanm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hanm&avatarId=26946","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hanm&avatarId=26946","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hanm&avatarId=26946","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hanm&avatarId=26946"},"displayName":"Michael Han","active":true,"timeZone":"America/Vancouver"},"created":"2018-07-27T03:16:40.473+0000","updated":"2018-07-27T03:16:40.473+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/comment/16559223","id":"16559223","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build ZooKeeper-trunk #122 (See [https://builds.apache.org/job/ZooKeeper-trunk/122/])\nZOOKEEPER-2251: Add Client side packet response timeout to avoid (hanm: rev 9f82798415351a20136ceb1640b1781723e51cc1)\n* (add) src/java/test/org/apache/zookeeper/ClientRequestTimeoutTest.java\n* (edit) zookeeper-docs/src/documentation/content/xdocs/zookeeperProgrammers.xml\n* (edit) src/java/main/org/apache/zookeeper/ZooKeeper.java\n* (edit) src/java/main/org/apache/zookeeper/client/ZKClientConfig.java\n* (edit) src/java/main/org/apache/zookeeper/ClientCnxn.java\n* (edit) src/java/main/org/apache/zookeeper/KeeperException.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2018-07-27T04:14:18.471+0000","updated":"2018-07-27T04:14:18.471+0000"}],"maxResults":56,"total":56,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2251/votes","votes":4,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":21,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/124043","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user anmolnar commented on the issue:\n\n    https://github.com/apache/zookeeper/pull/119\n  \n    @hanm @arshadmohammad This PR hasn't been updated for ages unfortunately, but looks like it indicates a pretty significant bug in Zk client library. Additionally we could also fix an long outstanding flaky test by fixing this, so killing two birds with a single shot.\r\n    \r\n    Although Akihiro's comment on the jira sounds reasonable: by using TCP there's no such thing as \"packet loss\" and we should better try to find the bug in Zookeeper code, I believe that waiting indefinitely is generally a bad thing and introducing a reasonable and configurable timeout would be beneficial. \r\n    \r\n    Introducing such thing in 3.6 is no harm and I would consider it merging to 3.5 too.\n","created":"2018-07-17T10:41:04.317+0000","updated":"2018-07-17T10:41:04.317+0000","started":"2018-07-17T10:41:04.317+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"124043","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/124181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on the issue:\n\n    https://github.com/apache/zookeeper/pull/119\n  \n    Sounds good to me. I had some comments before and I believe those are still applicable. \n","created":"2018-07-17T19:02:29.921+0000","updated":"2018-07-17T19:02:29.921+0000","started":"2018-07-17T19:02:29.921+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"124181","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/124291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on the issue:\n\n    https://github.com/apache/zookeeper/pull/119\n  \n    Thanks @anmolnar @hanm  for your reviews, I will address the comments and update MR.\n","created":"2018-07-18T02:37:04.652+0000","updated":"2018-07-18T02:37:04.652+0000","started":"2018-07-18T02:37:04.651+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"124291","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/125326","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r203928289\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -387,6 +389,8 @@ public void setCode(int code) {\n             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),\n             /** Attempts to remove a non-existing watcher */\n             NOWATCHER (-121),\n    +        /** Not received packet timely */\n    +        TIMEOUT (-122),\n    --- End diff --\n    \n    I think adding only error code will not be useful. Do you mean, add response timeout functionality in  C code?\n","created":"2018-07-20T03:11:42.485+0000","updated":"2018-07-20T03:11:42.485+0000","started":"2018-07-20T03:11:42.485+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"125326","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/125327","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r203928395\n  \n    --- Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java ---\n    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,\n             Packet packet = queuePacket(h, r, request, response, null, null, null,\n                     null, watchRegistration, watchDeregistration);\n             synchronized (packet) {\n    +            long waitStartTime = System.currentTimeMillis();\n                 while (!packet.finished) {\n    -                packet.wait();\n    +                packet.wait(requestTimeout);\n    --- End diff --\n    \n    disabled this feature by default. any non positive value will disable this feature\n","created":"2018-07-20T03:13:02.607+0000","updated":"2018-07-20T03:13:02.607+0000","started":"2018-07-20T03:13:02.606+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"125327","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/125328","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r203928468\n  \n    --- Diff: src/java/main/org/apache/zookeeper/ClientCnxn.java ---\n    @@ -1495,10 +1504,21 @@ public ReplyHeader submitRequest(RequestHeader h, Record request,\n             Packet packet = queuePacket(h, r, request, response, null, null, null,\n                     null, watchRegistration, watchDeregistration);\n             synchronized (packet) {\n    +            long waitStartTime = System.currentTimeMillis();\n                 while (!packet.finished) {\n    -                packet.wait();\n    +                packet.wait(requestTimeout);\n    +                if (!packet.finished && ((System.currentTimeMillis()\n    --- End diff --\n    \n    Corrected\n","created":"2018-07-20T03:13:50.065+0000","updated":"2018-07-20T03:13:50.065+0000","started":"2018-07-20T03:13:50.064+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"125328","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/125349","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r203940477\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -387,6 +389,8 @@ public void setCode(int code) {\n             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),\n             /** Attempts to remove a non-existing watcher */\n             NOWATCHER (-121),\n    +        /** Not received packet timely */\n    +        TIMEOUT (-122),\n    --- End diff --\n    \n    I was thinking the same error code should be added to C client so the C client can react to the new error code properly, instead of crash (the worst case). Though, I suspect properly the C client is fine as this error code will not be fired on server side (it's a pure Java client thing), so maybe we are fine without touch C client.\n","created":"2018-07-20T05:25:05.545+0000","updated":"2018-07-20T05:25:05.545+0000","started":"2018-07-20T05:25:05.544+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"125349","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204626490\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -843,4 +847,13 @@ public ReconfigDisabledException(String path) {\n                 super(Code.RECONFIGDISABLED, path);\n             }\n         }\n    +\n    +    /**\n    +     * @see Code#TIMEOUT\n    +     */\n    +    public static class TimeoutException extends KeeperException {\n    --- End diff --\n    \n    Similarly, use a more descriptive name like `ServerResponseTimeoutException` sounds better to me.\n","created":"2018-07-24T05:23:18.973+0000","updated":"2018-07-24T05:23:18.973+0000","started":"2018-07-24T05:23:18.972+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126440","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204626422\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -387,6 +389,8 @@ public void setCode(int code) {\n             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),\n             /** Attempts to remove a non-existing watcher */\n             NOWATCHER (-121),\n    +        /** Not received packet timely */\n    +        TIMEOUT (-122),\n    --- End diff --\n    \n    We already have `OPERATIONTIMEOUT` error code, so `TIMEOUT` sound too generic. Instead of using `TIMEOUT`, would something more descriptive better? I am thinking `SERVERRESPONSETIMEOUT` (server response timeout). Consider this is user facing, have a descriptive name with clear semantic sounds better.\n","created":"2018-07-24T05:23:19.014+0000","updated":"2018-07-24T05:23:19.014+0000","started":"2018-07-24T05:23:19.013+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126441","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126445","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user eolivelli commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204628644\n  \n    --- Diff: src/java/test/org/apache/zookeeper/ClientResponseTimeoutTest.java ---\n    @@ -0,0 +1,165 @@\n    +/**\n    + * Licensed to the Apache Software Foundation (ASF) under one\n    + * or more contributor license agreements.  See the NOTICE file\n    + * distributed with this work for additional information\n    + * regarding copyright ownership.  The ASF licenses this file\n    + * to you under the Apache License, Version 2.0 (the\n    + * \"License\"); you may not use this file except in compliance\n    + * with the License.  You may obtain a copy of the License at\n    + *\n    + *     http://www.apache.org/licenses/LICENSE-2.0\n    + *\n    + * Unless required by applicable law or agreed to in writing, software\n    + * distributed under the License is distributed on an \"AS IS\" BASIS,\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    + * See the License for the specific language governing permissions and\n    + * limitations under the License.\n    + */\n    +\n    +package org.apache.zookeeper;\n    +\n    +import static org.apache.zookeeper.test.ClientBase.CONNECTION_TIMEOUT;\n    +import static org.junit.Assert.assertEquals;\n    +import static org.junit.Assert.fail;\n    +\n    +import java.io.IOException;\n    +\n    +import org.apache.zookeeper.ZooDefs.Ids;\n    +import org.apache.zookeeper.client.HostProvider;\n    +import org.apache.zookeeper.server.quorum.QuorumPeerTestBase;\n    +import org.apache.zookeeper.test.ClientBase;\n    +import org.apache.zookeeper.test.ClientBase.CountdownWatcher;\n    +import org.junit.Assert;\n    +import org.junit.Test;\n    +\n    +public class ClientResponseTimeoutTest extends QuorumPeerTestBase {\n    --- End diff --\n    \n    Not sure we need to start a full cluster, what about adding a bunch of  mockito based tests?\r\n    \r\n    I think that having a test which uses the full stack may have some value, so maybe we can keep this. But in case of failure we are not sure about the real cause\n","created":"2018-07-24T05:41:56.033+0000","updated":"2018-07-24T05:41:56.033+0000","started":"2018-07-24T05:41:56.032+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126445","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user eolivelli commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204628957\n  \n    --- Diff: src/java/main/org/apache/zookeeper/client/ZKClientConfig.java ---\n    @@ -56,9 +56,15 @@\n         @SuppressWarnings(\"deprecation\")\n         public static final String SECURE_CLIENT = ZooKeeper.SECURE_CLIENT;\n         public static final int CLIENT_MAX_PACKET_LENGTH_DEFAULT = 4096 * 1024; /* 4 MB */\n    +    public static final String ZOOKEEPER_REQUEST_TIMEOUT = \"zookeeper.request.timeout\";\n    +    /**\n    +     * Feature is disabled by default.\n    --- End diff --\n    \n    What about enabling it by default with a default computed from desired session expire timeout? \n","created":"2018-07-24T05:41:56.076+0000","updated":"2018-07-24T05:41:56.076+0000","started":"2018-07-24T05:41:56.076+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126446","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126830","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204881819\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -387,6 +389,8 @@ public void setCode(int code) {\n             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),\n             /** Attempts to remove a non-existing watcher */\n             NOWATCHER (-121),\n    +        /** Not received packet timely */\n    +        TIMEOUT (-122),\n    --- End diff --\n    \n    Good catch. Request time out is also a kind of operation time out.  OPERATIONTIMEOUT, I think it is not used any where in the  java client code or server code, not sure about other client codes. leaving OPERATIONTIMEOUT as it is.\r\n    Changing TIMEOUT to SERVERRESPONSETIMEOUT is OK but I do not want to change property name.  Can we use REQUESTTIMEOUT.\r\n\n","created":"2018-07-24T19:25:42.579+0000","updated":"2018-07-24T19:25:42.579+0000","started":"2018-07-24T19:25:42.578+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126830","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126831","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204882089\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -843,4 +847,13 @@ public ReconfigDisabledException(String path) {\n                 super(Code.RECONFIGDISABLED, path);\n             }\n         }\n    +\n    +    /**\n    +     * @see Code#TIMEOUT\n    +     */\n    +    public static class TimeoutException extends KeeperException {\n    --- End diff --\n    \n    Changed to RequestTimeoutException\n","created":"2018-07-24T19:26:46.611+0000","updated":"2018-07-24T19:26:46.611+0000","started":"2018-07-24T19:26:46.610+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126831","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user arshadmohammad commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204885587\n  \n    --- Diff: src/java/main/org/apache/zookeeper/client/ZKClientConfig.java ---\n    @@ -56,9 +56,15 @@\n         @SuppressWarnings(\"deprecation\")\n         public static final String SECURE_CLIENT = ZooKeeper.SECURE_CLIENT;\n         public static final int CLIENT_MAX_PACKET_LENGTH_DEFAULT = 4096 * 1024; /* 4 MB */\n    +    public static final String ZOOKEEPER_REQUEST_TIMEOUT = \"zookeeper.request.timeout\";\n    +    /**\n    +     * Feature is disabled by default.\n    --- End diff --\n    \n    Session timeout and this client request timeout are completely different. I think we should not mix these two.\n","created":"2018-07-24T19:39:49.940+0000","updated":"2018-07-24T19:39:49.940+0000","started":"2018-07-24T19:39:49.939+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126839","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/126858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user eolivelli commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204899777\n  \n    --- Diff: src/java/main/org/apache/zookeeper/client/ZKClientConfig.java ---\n    @@ -56,9 +56,15 @@\n         @SuppressWarnings(\"deprecation\")\n         public static final String SECURE_CLIENT = ZooKeeper.SECURE_CLIENT;\n         public static final int CLIENT_MAX_PACKET_LENGTH_DEFAULT = 4096 * 1024; /* 4 MB */\n    +    public static final String ZOOKEEPER_REQUEST_TIMEOUT = \"zookeeper.request.timeout\";\n    +    /**\n    +     * Feature is disabled by default.\n    --- End diff --\n    \n    Totally agree, they are very different things. I mentioned it because configured session timeout is like a client side hint about how much time you can tolerate to be disconnected/not responsive, but it is better to keep it separate from this low level knob.\r\n    Anyway I wonder if it would be better to set a default timeout.\r\n    If there is a chance of infinite wait maybe it can be worth.\r\n    We can use a very large timeout, in the order of minutes.\r\n    Tipical session timeout is in the order of seconds\n","created":"2018-07-24T20:28:19.300+0000","updated":"2018-07-24T20:28:19.300+0000","started":"2018-07-24T20:28:19.299+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"126858","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/127077","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204983836\n  \n    --- Diff: src/java/main/org/apache/zookeeper/KeeperException.java ---\n    @@ -387,6 +389,8 @@ public void setCode(int code) {\n             EPHEMERALONLOCALSESSION (EphemeralOnLocalSession),\n             /** Attempts to remove a non-existing watcher */\n             NOWATCHER (-121),\n    +        /** Not received packet timely */\n    +        TIMEOUT (-122),\n    --- End diff --\n    \n    REQUESTTIMEOUT sounds good to me.\n","created":"2018-07-25T05:20:17.419+0000","updated":"2018-07-25T05:20:17.419+0000","started":"2018-07-25T05:20:17.418+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"127077","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/127078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204984357\n  \n    --- Diff: src/java/main/org/apache/zookeeper/client/ZKClientConfig.java ---\n    @@ -56,9 +56,15 @@\n         @SuppressWarnings(\"deprecation\")\n         public static final String SECURE_CLIENT = ZooKeeper.SECURE_CLIENT;\n         public static final int CLIENT_MAX_PACKET_LENGTH_DEFAULT = 4096 * 1024; /* 4 MB */\n    +    public static final String ZOOKEEPER_REQUEST_TIMEOUT = \"zookeeper.request.timeout\";\n    +    /**\n    +     * Feature is disabled by default.\n    --- End diff --\n    \n    I tend to learn towards the conservative side to have this feature turned off by default, because I feel we don't have deep insight regarding what's the value we could use as default value (if we turn the feature on by default), and a premature setting of that value might impact existing users. For few of users who do have the problem they can tune the parameter based on their prod env. \n","created":"2018-07-25T05:24:34.008+0000","updated":"2018-07-25T05:24:34.008+0000","started":"2018-07-25T05:24:34.007+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"127078","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/127097","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user eolivelli commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/119#discussion_r204990370\n  \n    --- Diff: src/java/main/org/apache/zookeeper/client/ZKClientConfig.java ---\n    @@ -56,9 +56,15 @@\n         @SuppressWarnings(\"deprecation\")\n         public static final String SECURE_CLIENT = ZooKeeper.SECURE_CLIENT;\n         public static final int CLIENT_MAX_PACKET_LENGTH_DEFAULT = 4096 * 1024; /* 4 MB */\n    +    public static final String ZOOKEEPER_REQUEST_TIMEOUT = \"zookeeper.request.timeout\";\n    +    /**\n    +     * Feature is disabled by default.\n    --- End diff --\n    \n    Okay, no feafult\n","created":"2018-07-25T06:09:46.219+0000","updated":"2018-07-25T06:09:46.219+0000","started":"2018-07-25T06:09:46.219+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"127097","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/127640","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user hanm commented on the issue:\n\n    https://github.com/apache/zookeeper/pull/119\n  \n    This is good to go - I am kicking the bot and once it's green I'll commit this.\n","created":"2018-07-26T04:24:07.931+0000","updated":"2018-07-26T04:24:07.931+0000","started":"2018-07-26T04:24:07.930+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"127640","issueId":"12857097"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12857097/worklog/128006","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"Github user asfgit closed the pull request at:\n\n    https://github.com/apache/zookeeper/pull/119\n","created":"2018-07-27T03:16:31.073+0000","updated":"2018-07-27T03:16:31.073+0000","started":"2018-07-27T03:16:31.072+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"128006","issueId":"12857097"}]},"customfield_12311820":"0|i2j31z:"}}