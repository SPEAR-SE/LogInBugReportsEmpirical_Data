{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12429439","self":"https://issues.apache.org/jira/rest/api/2/issue/12429439","key":"ZOOKEEPER-458","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326518","id":"12326518","name":"3.6.0","archived":false,"released":false}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2009-11-19T02:33:30.421+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Oct 29 08:04:32 UTC 2011","customfield_12310420":"68118","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-458/watchers","watchCount":1,"isWatching":false},"created":"2009-07-03T00:05:41.400+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"7.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-04-23T20:41:31.602+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312380","id":"12312380","name":"c client","description":"The c client interface to ZooKeeper"}],"timeoriginalestimate":null,"description":"connect_index in zookeeper handle might get out of bound. the zokoeeper_init method checks for index == count and sets it to zero. If the index becomes greater than count, then it will go out of bounds.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12427583","id":"12427583","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T07:10:33.563+0000","size":3368,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12427583/ZOOKEEPER-458.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12427582","id":"12427582","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T07:09:33.019+0000","size":3368,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12427582/ZOOKEEPER-458.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12427565","id":"12427565","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T03:39:37.554+0000","size":3286,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12427565/ZOOKEEPER-458.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12426121","id":"12426121","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T17:15:52.674+0000","size":3163,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12426121/ZOOKEEPER-458.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12425744","id":"12425744","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-22T01:40:08.960+0000","size":2790,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12425744/ZOOKEEPER-458.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12425734","id":"12425734","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-21T18:36:59.016+0000","size":2790,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12425734/ZOOKEEPER-458.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12425433","id":"12425433","filename":"ZOOKEEPER-458.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-19T02:33:30.374+0000","size":427,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12425433/ZOOKEEPER-458.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"33066","customfield_12312823":null,"summary":"connect_index in zookeeper handle might get out of bound.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12742016","id":"12742016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"moving it to 3.3 since its not a regression and the connect_index will always be sane but the code just needs to put in extra checks for that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-11T19:03:07.016+0000","updated":"2009-08-11T19:03:07.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12779805","id":"12779805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"This patch adds a check that resets connect_index at the only point where connect_index gets non-zero values. \n\nMore checks could be added if more places will be added that update connect_index or to handle addrs_count changing.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-19T02:33:30.421+0000","updated":"2009-11-19T02:33:30.421+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12779809","id":"12779809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"+1 the patch looks good ...\n\nsteven, would it be possible to add tests to it? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-19T02:54:30.790+0000","updated":"2009-11-19T02:54:30.790+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12779815","id":"12779815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"I think so... I would need to force handle_error to get called to bump up connect_index.  Any tips on the best way to do this?\n\nLooks like handle_error gets called from either a socket error or if there's an auth fail.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-19T03:43:52.816+0000","updated":"2009-11-19T03:43:52.816+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12781025","id":"12781025","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Tried to make some test cases that would trigger just one handle_error(), seemed like the easiest way would be to have zk connect to a non-existing server and try an operation.\n\nThe first test gives me a glibc error when I run it\n\n*** glibc detected *** ./zktest-st: corrupted double-linked list: 0x08dc5d70 ***\n======= Backtrace: =========\n/lib/tls/i686/cmov/libc.so.6[0x401d9ff1]\n/lib/tls/i686/cmov/libc.so.6[0x401db899]\n/lib/tls/i686/cmov/libc.so.6(cfree+0x6d)[0x401de79d]\n[snip]\n     [exec] make: *** [run-check] Aborted\n     [exec] Zookeeper_operations::testOperationConnectionLoss1 : assertion\n\nThis seems like a bug.  I'll look into it some more later.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-21T18:36:59.074+0000","updated":"2009-11-21T18:36:59.074+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12781082","id":"12781082","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"This patch ensures that 0 <= connect_index < addrs_count whenever connect_index is set to a non-zero value. \n\nIncludes two tests that this property is maintained over disconnects.   \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-22T01:40:09.023+0000","updated":"2009-11-22T01:40:09.023+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12781087","id":"12781087","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12425744/ZOOKEEPER-458.patch\n  against trunk revision 882744.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/72/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/72/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/72/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-22T02:52:35.319+0000","updated":"2009-11-22T02:52:35.319+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782275","id":"12782275","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"+1... good to see the tests. the test failure with hudson is a known issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T01:58:42.207+0000","updated":"2009-11-25T01:58:42.207+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782299","id":"12782299","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"steven,\n I tried running the ccpunit tests with your patch and it core dumps at testOperationConnectionLoss1 (the test you added).... ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T03:48:31.224+0000","updated":"2009-11-25T03:48:31.224+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782300","id":"12782300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"pressed enter too soon. is it passing for you? Its failing for me consistently. I can help debugging if its passing for you. let me know.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T03:49:13.530+0000","updated":"2009-11-25T03:49:13.530+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782512","id":"12782512","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Sorry Mahadev, for some reason an old patch got uploaded instead.  I'll make sure to double-check next time.\n\nI changed the tests so that a server was available and then disconnects, these ones pass for me.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T17:15:52.693+0000","updated":"2009-11-25T17:15:52.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782513","id":"12782513","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Now I'm wondering how the old patch passed? Strange.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T17:18:52.384+0000","updated":"2009-11-25T17:18:52.384+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782525","id":"12782525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12426121/ZOOKEEPER-458.patch\n  against trunk revision 882744.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/76/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/76/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/76/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T17:36:59.650+0000","updated":"2009-11-25T17:36:59.650+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782535","id":"12782535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"the old patch didnt run the cppunit tests since it had already failed at the java tests. the patch you just uploaded failed at the testConnectConnectIndex1 (segfaulted). you can take a look at \n\nhttp://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/76/console\n\nare the cppunit tests passing for you?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T18:07:02.513+0000","updated":"2009-11-25T18:07:02.513+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782633","id":"12782633","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"These ones are passing for me, and still pass after svn update.  \n\nCan't tell where it segfaults, it should have connected to the server if the zoo_exists returns ZOK?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-25T21:37:36.229+0000","updated":"2009-11-25T21:37:36.229+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12782702","id":"12782702","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Any debugging help you can give would be great Mahadev.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-11-26T00:53:11.829+0000","updated":"2009-11-26T00:53:11.829+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12784629","id":"12784629","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"the tests pass for me on linux. ill try hudson again to see if the failure is consistent or not.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-02T04:55:06.892+0000","updated":"2009-12-02T04:55:06.892+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12787952","id":"12787952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12426121/ZOOKEEPER-458.patch\n  against trunk revision 888216.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h7.grid.sp2.yahoo.net/20/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h7.grid.sp2.yahoo.net/20/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h7.grid.sp2.yahoo.net/20/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-09T07:27:06.909+0000","updated":"2009-12-09T07:27:06.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12788422","id":"12788422","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"I spent some time debugging this. This is the stack trace from the core dump:\n\n{quote}\n#0  0x00002b101d67f6e3 in ?? () from /lib/libc.so.6\n#1  0x00002b101d680e98 in ?? () from /lib/libc.so.6\n#2  0x00002b101d681276 in free () from /lib/libc.so.6\n#3  0x0000000000407b4e in __wrap_free (p=0xc03d80) at /homes/mahadev/zookeeper-trunk/src/c/tests/LibCMocks.cc:197\n#4  0x0000000000441197 in free_buffer (b=0xbff8d0) at /homes/mahadev/zookeeper-trunk/src/c/src/zookeeper.c:763\n#5  0x0000000000441aa5 in destroy_completion_entry (c=0xc02dd0) at /homes/mahadev/zookeeper-trunk/src/c/src/zookeeper.c:2048\n#6  0x0000000000441dc2 in process_completions (zh=0xc02920) at /homes/mahadev/zookeeper-trunk/src/c/src/zookeeper.c:1727\n#7  0x00000000004457a8 in zookeeper_process (zh=0xc02920, events=-1912149552) at /homes/mahadev/zookeeper-trunk/src/c/src/zookeeper.c:1974\n#8  0x00000000004316dd in yield (zh=0xc02920, seconds=1) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestClient.cc:107\n#9  0x0000000000433406 in watchCtx::waitForConnected (this=0x7fff8e06f100, zh=0xc02920) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestClient.cc:165\n#10 0x000000000043448d in Zookeeper_simpleSystem::testConnectIndex1 (this=0xbfdaa0) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestClient.cc:846\n#11 0x0000000000431a02 in CppUnit::TestCaller<Zookeeper_simpleSystem>::runTest (this=0xbfdd00) at /usr/include/cppunit/TestCaller.h:166\n#12 0x00000000004566fa in CppUnit::TestCaseMethodFunctor::operator() ()\n#13 0x00000000004618e4 in CppUnit::DefaultProtector::protect ()\n#14 0x000000000046315f in CppUnit::ProtectorChain::protect ()\n#15 0x000000000045e1b2 in CppUnit::TestResult::protect ()\n#16 0x00000000004564ba in CppUnit::TestCase::run ()\n#17 0x0000000000463d03 in CppUnit::TestComposite::doRunChildTests ()\n#18 0x0000000000463c26 in CppUnit::TestComposite::run ()\n#19 0x0000000000463d03 in CppUnit::TestComposite::doRunChildTests ()\n#20 0x0000000000463c26 in CppUnit::TestComposite::run ()\n#21 0x000000000045da0a in CppUnit::TestResult::runTest ()\n#22 0x000000000045ff62 in CppUnit::TestRunner::run ()\n{quote}\n\nI tried debugging but could not find much time. \n\nSteven,\n can you take a look and see if you find something obvious?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T00:48:53.362+0000","updated":"2009-12-10T00:48:53.362+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12788479","id":"12788479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Maybe free_buffer is getting called twice on the same structure, changed patch to null out the buffer field.  \n\nIf free_buffer is getting called twice, we should see a __wrap_free ... p = 0 in the backtrace.\n\nIt's also possible that the buffer is getting free'd since buffer is shared with the iarchive zookeeper.c:1781 but I couldn't find any paths where the iarchive buffer is free'd by manually tracing through.\n\nOne thing I am confused about is that the segfault happens at the end of the testConnectIndex1 test, but the path that it is taking is processing outstanding synchronous completions.  The only synchronous completion that could be there is the zoo_exists call, but this was completed at the beginning of the test, before the server was stopped.  \n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T03:39:37.588+0000","updated":"2009-12-10T03:39:37.588+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12788538","id":"12788538","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"I tried running the new patch on the hudson machine. I get a core dump but this time there is no trace of zookeeper internal calls. This looks very fishy! \n\n{quote}\n#0  0x00002ab7e7ead225 in free () from /lib/libc.so.6\n#1  0x00000000004053fb in __gnu_cxx::new_allocator<std::string>::deallocate (this=0x7fffc3845648, __p=0x3e700000000) at /usr/include/c++/4.3/ext/new_allocator.h:98\n#2  0x0000000000405855 in std::_Deque_base<std::string, std::allocator<std::string> >::_M_deallocate_node (this=0x7fffc3845648, __p=0x3e700000000) at /usr/include/c++/4.3/bits/stl_deque.h:454\n#3  0x0000000000405886 in std::_Deque_base<std::string, std::allocator<std::string> >::_M_destroy_nodes (this=0x7fffc3845648, __nstart=0x13d3368, __nfinish=0x13d3370) at /usr/include/c++/4.3/bits/stl_deque.h:557\n#4  0x000000000040592b in ~_Deque_base (this=0x7fffc3845648) at /usr/include/c++/4.3/bits/stl_deque.h:480\n#5  0x00000000004059a8 in ~deque (this=0x7fffc3845648) at /usr/include/c++/4.3/bits/stl_deque.h:776\n#6  0x00000000004059fa in ~Message (this=0x7fffc3845640) at /usr/include/cppunit/Message.h:39\n#7  0x00000000004351bc in Zookeeper_simpleSystem::testConnectIndex1 (this=0x13cede0) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestClient.cc:846\n#8  0x0000000000431cc6 in CppUnit::TestCaller<Zookeeper_simpleSystem>::runTest (this=0x13cf040) at /usr/include/cppunit/TestCaller.h:166\n#9  0x000000000045bb4a in CppUnit::TestCaseMethodFunctor::operator() ()\n#10 0x0000000000466d34 in CppUnit::DefaultProtector::protect ()\n#11 0x00000000004685af in CppUnit::ProtectorChain::protect ()\n#12 0x0000000000463602 in CppUnit::TestResult::protect ()\n#13 0x000000000045b90a in CppUnit::TestCase::run ()\n#14 0x0000000000469153 in CppUnit::TestComposite::doRunChildTests ()\n#15 0x0000000000469076 in CppUnit::TestComposite::run ()\n#16 0x0000000000469153 in CppUnit::TestComposite::doRunChildTests ()\n#17 0x0000000000469076 in CppUnit::TestComposite::run ()\n#18 0x0000000000462e5a in CppUnit::TestResult::runTest ()\n#19 0x00000000004653b2 in CppUnit::TestRunner::run ()\n#20 0x00000000004047ea in main (argc=1, argv=0x7fffc38462d8) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestDriver.cc:152\n\n{quote}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T06:27:12.641+0000","updated":"2009-12-10T06:27:12.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12788553","id":"12788553","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Really looks like something with free... maybe this patch will be able to catch it better... marks the buffer node by setting len=-1 and checks it later.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T07:09:33.052+0000","updated":"2009-12-10T07:09:33.052+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12788554","id":"12788554","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"This patch, rather.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T07:10:33.595+0000","updated":"2009-12-10T07:10:33.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12788887","id":"12788887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"it still fails in the same place and with the same back trace:\n\n{quote}\n0  0x00002adc6886c225 in free () from /lib/libc.so.6\n#1  0x00000000004053fb in __gnu_cxx::new_allocator<std::string>::deallocate (this=0x7fff42e84c88, __p=0x3e700000000) at /usr/include/c++/4.3/ext/new_allocator.h:98\n#2  0x0000000000405855 in std::_Deque_base<std::string, std::allocator<std::string> >::_M_deallocate_node (this=0x7fff42e84c88, __p=0x3e700000000) at /usr/include/c++/4.3/bits/stl_deque.h:454\n#3  0x0000000000405886 in std::_Deque_base<std::string, std::allocator<std::string> >::_M_destroy_nodes (this=0x7fff42e84c88, __nstart=0x1854368, __nfinish=0x1854370)\n    at /usr/include/c++/4.3/bits/stl_deque.h:557\n#4  0x000000000040592b in ~_Deque_base (this=0x7fff42e84c88) at /usr/include/c++/4.3/bits/stl_deque.h:480\n#5  0x00000000004059a8 in ~deque (this=0x7fff42e84c88) at /usr/include/c++/4.3/bits/stl_deque.h:776\n#6  0x00000000004059fa in ~Message (this=0x7fff42e84c80) at /usr/include/cppunit/Message.h:39\n#7  0x00000000004351bc in Zookeeper_simpleSystem::testConnectIndex1 (this=0x184fde0) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestClient.cc:846\n#8  0x0000000000431cc6 in CppUnit::TestCaller<Zookeeper_simpleSystem>::runTest (this=0x1850040) at /usr/include/cppunit/TestCaller.h:166\n#9  0x000000000045bb6a in CppUnit::TestCaseMethodFunctor::operator() ()\n#10 0x0000000000466d54 in CppUnit::DefaultProtector::protect ()\n#11 0x00000000004685cf in CppUnit::ProtectorChain::protect ()\n#12 0x0000000000463622 in CppUnit::TestResult::protect ()\n#13 0x000000000045b92a in CppUnit::TestCase::run ()\n#14 0x0000000000469173 in CppUnit::TestComposite::doRunChildTests ()\n#15 0x0000000000469096 in CppUnit::TestComposite::run ()\n#16 0x0000000000469173 in CppUnit::TestComposite::doRunChildTests ()\n#17 0x0000000000469096 in CppUnit::TestComposite::run ()\n#18 0x0000000000462e7a in CppUnit::TestResult::runTest ()\n#19 0x00000000004653d2 in CppUnit::TestRunner::run ()\n#20 0x00000000004047ea in main (argc=1, argv=0x7fff42e85918) at /homes/mahadev/zookeeper-trunk/src/c/tests/TestDriver.cc:152\n\n{quote}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-10T20:13:31.751+0000","updated":"2009-12-10T20:13:31.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12789055","id":"12789055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"I'm out of ideas for now, can't find anything obvious Mahadev, I will think about it some more.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-11T00:51:23.593+0000","updated":"2009-12-11T00:51:23.593+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12789070","id":"12789070","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"I tried increasing the timer on waitForConnected to 20 seconds on so and it seems to pass the tests 4-5 times in a row. So does look like a race condition somewhere. \n\n{code}\n\n     bool waitForConnected(zhandle_t *zh) {\n-        time_t expires = time(0) + 10;\n+        time_t expires = time(0) + 20;\n         while(!connected && time(0) < expires) {\n             yield(zh, 1);\n\n{code}\n\nBut all the other tests work with a timeout of 10 seconds, so I am really suspicious of the timer being the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-11T01:38:55.768+0000","updated":"2009-12-11T01:38:55.768+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12789148","id":"12789148","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Hmm.. I tried with a lower timeout on my computer and couldn't get the failure.  I'll look around the timer stuff.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-11T07:03:58.142+0000","updated":"2009-12-11T07:03:58.142+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12789391","id":"12789391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Have you tried running with valgrind?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-12-11T17:06:44.621+0000","updated":"2009-12-11T17:06:44.621+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12789773","id":"12789773","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Valgrind found some interesting things:\n\n{quote}\n==2357== \n==2357== Invalid write of size 4\n==2357==    at 0x8080C9C: zookeeper_process (zookeeper.c:1900)\n==2357==    by 0x806CAD3: yield(_zhandle*, int) (TestClient.cc:107)\n==2357==    by 0x806CF72: watchCtx::waitForConnected(_zhandle*) (TestClient.cc:165)\n==2357==    by 0x8070402: Zookeeper_simpleSystem::testConnectIndex1() (TestClient.cc:846)\n==2357==    by 0x80727BF: CppUnit::TestCaller<Zookeeper_simpleSystem>::runTest() (TestCaller.h:166)\n==2357==    by 0x8091528: CppUnit::TestCaseMethodFunctor::operator()() const (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==    by 0x809BAAC: CppUnit::DefaultProtector::protect(CppUnit::Functor const&, CppUnit::ProtectorContext const&) (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==    by 0x809D402: CppUnit::ProtectorChain::ProtectFunctor::operator()() const (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==    by 0x809D0C1: CppUnit::ProtectorChain::protect(CppUnit::Functor const&, CppUnit::ProtectorContext const&) (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==    by 0x8098705: CppUnit::TestResult::protect(CppUnit::Functor const&, CppUnit::Test*, std::string const&) (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==    by 0x809131E: CppUnit::TestCase::run(CppUnit::TestResult*) (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==    by 0x809DBB2: CppUnit::TestComposite::doRunChildTests(CppUnit::TestResult*) (in /home/steven/workspace/zookeeper-trunk-working/build/test/test-cppunit/zktest-st)\n==2357==  Address 0x44db5f4 is 4 bytes inside a block of size 84 free'd\n==2357==    at 0x4024836: free (vg_replace_malloc.c:325)\n==2357==    by 0x804E04B: __wrap_free (LibCMocks.cc:197)\n==2357==    by 0x8087B5C: free_sync_completion (st_adaptor.c:56)\n==2357==    by 0x807E1FC: zoo_wexists (zookeeper.c:2909)\n==2357==    by 0x807E289: zoo_exists (zookeeper.c:2890)\n==2357==    by 0x806FDF6: Zookeeper_simpleSystem::testConnectIndex1() (TestClient.cc:840)\n{quote}\n\nThere are a number that looks like this.  In this case it looks like the sync_completion allocated by zoo_wexists is sticking around somewhere after zoo_wexists finishes and free()s it, and gets written to by the zookeeper_process() that gets called by the yield() in waitForConnected() .\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2009-12-12T17:48:07.758+0000","updated":"2009-12-12T17:48:07.758+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12800948","id":"12800948","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"steve,\n sorry was out on vacation. Did you get a chacne to take a look at it? did you find something?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2010-01-15T22:17:58.677+0000","updated":"2010-01-15T22:17:58.677+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12801229","id":"12801229","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Hi Mahadev, haven't been able to look at it until now, I'll take a look and update on what I find.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2010-01-16T17:24:28.590+0000","updated":"2010-01-16T17:24:28.590+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12802085","id":"12802085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Couldn't figure out where it's happening and I don't get quite the same error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2010-01-19T04:11:48.436+0000","updated":"2010-01-19T04:11:48.436+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12842094","id":"12842094","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"What do we want to do here guys, push to 3.4.0? I'd really like to see this one get closed out, esp after all the work you've done.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-03-05T23:07:32.554+0000","updated":"2010-03-05T23:07:32.554+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/12842100","id":"12842100","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"this is quite critical but we wont be able to fix this before 3.3 deadline. Moving it to 3.4.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-05T23:20:33.149+0000","updated":"2010-03-05T23:20:33.149+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/13064936","id":"13064936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"body":"Pushing to 3.5. Not a blocker.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahadev","name":"mahadev","key":"mahadev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mahadev konar","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-13T23:04:54.002+0000","updated":"2011-07-13T23:04:54.002+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12429439/comment/13139148","id":"13139148","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"body":"Assigning this back to Mahadev, I have tried one more run adding the line setting the connect_index back to 0 and the tests pass on a fresh trunk checkout on a different machine.\n\nUnfortunately, I can't think of anything more to debug this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevechy","name":"stevechy","key":"stevechy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Cheng","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-29T08:04:32.719+0000","updated":"2011-10-29T08:04:32.719+0000"}],"maxResults":36,"total":36,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-458/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i060tz:"}}