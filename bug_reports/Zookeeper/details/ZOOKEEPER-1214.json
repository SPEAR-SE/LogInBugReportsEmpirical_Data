{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12525784","self":"https://issues.apache.org/jira/rest/api/2/issue/12525784","key":"ZOOKEEPER-1214","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316644","id":"12316644","description":"Dynamic Reconfig, Remove Watches, Local Session","name":"3.5.0","archived":false,"released":true,"releaseDate":"2014-08-04"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-10-05T10:02:35.717+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue May 20 11:09:12 UTC 2014","customfield_12310420":"46382","customfield_12312320":null,"customfield_12310222":"10002_*:*_3_*:*_7620866480_*|*_1_*:*_3_*:*_74955505223_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-05-18T03:49:28.470+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1214/watchers","watchCount":5,"isWatching":false},"created":"2011-10-05T09:56:36.812+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-05-20T11:09:12.272+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312379","id":"12312379","name":"quorum","description":"Quorum determination for ZooKeeper"}],"timeoriginalestimate":null,"description":"When a QuorumPeer thread dies, it is unregistering *all* ZKMBeanInfo MBeans previously registered on its java process; including those that has not been registered by itself.\n\nIt does not cause any side effect in production environment where each server is running on a separate java process; but fails when using \"org.apache.zookeeper.test.QuorumUtil\" to programmatically start up a zookeeper server ensemble and use its provided methods to force Disconnected, SyncConnected or SessionExpired events; in order to perform some basic/functional testing.\n\nScenario:\n* QuorumUtil qU = new QuorumUtil(1); // It creates a 3 servers ensemble.\n* qU.startAll(); // Startup all servers: 1 Leader + 2 Followers\n* qU.shutdown\\(i\\); // i is a number from 1 to 3. It shutdown one server.\n\nThe last method causes that a QuorumPeer will die, invoking the MBeanRegistry.unregisterAll() method.\nAs a result, *all* ZKMBeanInfo MBeans are unregistered; including those belonging to the other QuorumPeer instances.\n\nWhen trying to restart previous server (qU.restart\\(i\\)) an AssertionError is thrown at MBeanRegistry.register(ZKMBeanInfo bean, ZKMBeanInfo parent) method, causing the QuorumPeer thread dead.\n\nTo solve it:\n* MBeanRegistry.unregisterAll() method has been removed.\n* QuorumPeer only unregister its ZKMBeanInfo MBeans.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12568167","id":"12568167","filename":"ZOOKEEPER-1214.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2013-02-06T05:25:38.431+0000","size":11032,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12568167/ZOOKEEPER-1214.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12568375","id":"12568375","filename":"ZOOKEEPER-1214.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2013-02-07T07:09:19.946+0000","size":11086,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12568375/ZOOKEEPER-1214.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12642729","id":"12642729","filename":"ZOOKEEPER-1214.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-30T21:24:59.719+0000","size":10938,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12642729/ZOOKEEPER-1214.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12509566","id":"12509566","filename":"ZOOKEEPER-1214.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"created":"2012-01-05T16:14:32.173+0000","size":10633,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12509566/ZOOKEEPER-1214.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12497782","id":"12497782","filename":"ZOOKEEPER-1214.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"created":"2011-10-05T11:30:07.186+0000","size":8281,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12497782/ZOOKEEPER-1214.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12497775","id":"12497775","filename":"ZOOKEEPER-1214.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"created":"2011-10-05T09:59:50.264+0000","size":8346,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12497775/ZOOKEEPER-1214.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"32661","customfield_12312823":null,"summary":"QuorumPeer should unregister only its previsously registered MBeans instead of use MBeanRegistry.unregisterAll() method.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13120786","id":"13120786","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12497775/ZOOKEEPER-1214.patch\n  against trunk revision 1177432.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/603//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-05T10:02:35.717+0000","updated":"2011-10-05T10:02:35.717+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13120840","id":"13120840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"body":"Refreshed trunk.\nRegenerated patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"created":"2011-10-05T11:30:07.283+0000","updated":"2011-10-05T11:30:07.283+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13120850","id":"13120850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12497782/ZOOKEEPER-1214.patch\n  against trunk revision 1177432.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/605//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/605//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/605//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-05T11:54:09.392+0000","updated":"2011-10-05T11:54:09.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13120860","id":"13120860","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2208/\n-----------------------------------------------------------\n\nReview request for zookeeper.\n\n\nSummary\n-------\n\nSee https://issues.apache.org/jira/browse/ZOOKEEPER-1214\n\n\nThis addresses bug ZOOKEEPER-1214.\n    https://issues.apache.org/jira/browse/ZOOKEEPER-1214\n\n\nDiffs\n-----\n\n  /src/java/test/org/apache/zookeeper/test/QuorumUtil.java 1179165 \n  /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java PRE-CREATION \n  /src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java 1179166 \n  /src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java 1169669 \n\nDiff: https://reviews.apache.org/r/2208/diff\n\n\nTesting\n-------\n\n-\n\n\nThanks,\n\nCésar\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-05T11:59:34.204+0000","updated":"2011-10-05T11:59:34.204+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13169809","id":"13169809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"I updated the RB review with some f/b that needs to be incorporated before this can be committed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-12-14T23:36:42.478+0000","updated":"2011-12-14T23:36:42.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13169811","id":"13169811","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2208/#review3914\n-----------------------------------------------------------\n\n\na good cleanup, some comments before we can commit it.\n\n\n/src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java\n<https://reviews.apache.org/r/2208/#comment8794>\n\n    cleanup this typo (2 returns)\n\n\n\n/src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java\n<https://reviews.apache.org/r/2208/#comment8793>\n\n    let's call this \n    \n    getRegisteredBeans()\n    \n\n\n\n/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java\n<https://reviews.apache.org/r/2208/#comment8795>\n\n    Add back the try/catch protection. This was necessary in some cases (I can't remember why off the top of my head though).\n\n\n\n/src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java\n<https://reviews.apache.org/r/2208/#comment8796>\n\n    license header is missing. add the std boilerplate found on any other java file in the project.\n\n\n\n/src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java\n<https://reviews.apache.org/r/2208/#comment8798>\n\n    add a comment to the class describing what this set of tests is for\n\n\n\n/src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java\n<https://reviews.apache.org/r/2208/#comment8797>\n\n    no tabs, reformat with spaces only. (you'll probably need to cleanup some of your other changes at the same time)\n\n\n\n/src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java\n<https://reviews.apache.org/r/2208/#comment8799>\n\n    it's fine to ref a jira here, however there should also be some details on what this test is doing. (short summary esp as the test itself is pretty clear)\n\n\n- Patrick\n\n\nOn 2011-10-05 11:59:30, César Álvarez Núñez wrote:\nbq.  \nbq.  -----------------------------------------------------------\nbq.  This is an automatically generated e-mail. To reply, visit:\nbq.  https://reviews.apache.org/r/2208/\nbq.  -----------------------------------------------------------\nbq.  \nbq.  (Updated 2011-10-05 11:59:30)\nbq.  \nbq.  \nbq.  Review request for zookeeper.\nbq.  \nbq.  \nbq.  Summary\nbq.  -------\nbq.  \nbq.  See https://issues.apache.org/jira/browse/ZOOKEEPER-1214\nbq.  \nbq.  \nbq.  This addresses bug ZOOKEEPER-1214.\nbq.      https://issues.apache.org/jira/browse/ZOOKEEPER-1214\nbq.  \nbq.  \nbq.  Diffs\nbq.  -----\nbq.  \nbq.    /src/java/test/org/apache/zookeeper/test/QuorumUtil.java 1179165 \nbq.    /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java PRE-CREATION \nbq.    /src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java 1179166 \nbq.    /src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java 1169669 \nbq.  \nbq.  Diff: https://reviews.apache.org/r/2208/diff\nbq.  \nbq.  \nbq.  Testing\nbq.  -------\nbq.  \nbq.  -\nbq.  \nbq.  \nbq.  Thanks,\nbq.  \nbq.  César\nbq.  \nbq.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-14T23:37:30.656+0000","updated":"2011-12-14T23:37:30.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13180498","id":"13180498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"body":"Patch updated due to review feedback.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=calvarez","name":"calvarez","key":"calvarez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"César Álvarez Núñez","active":true,"timeZone":"Europe/London"},"created":"2012-01-05T16:17:39.286+0000","updated":"2012-01-05T16:17:39.286+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13180512","id":"13180512","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java, lines 126-127\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48123#file48123line126>\nbq.  >\nbq.  >     cleanup this typo (2 returns)\n\nDone.\n\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java, line 130\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48123#file48123line130>\nbq.  >\nbq.  >     let's call this \nbq.  >     \nbq.  >     getRegisteredBeans()\nbq.  >\n\nOk.\n\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java, lines 757-767\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48124#file48124line757>\nbq.  >\nbq.  >     Add back the try/catch protection. This was necessary in some cases (I can't remember why off the top of my head though).\n\nI've enhanced the exception handling during \"public void unregister(ZKMBeanInfo bean)\" method invocation since JMException was caught and logged two times: 1) private void unregister(String path,ZKMBeanInfo bean) throws JMException, 2) public void unregister(ZKMBeanInfo bean).\n\nI've also added a \"catch(Throwable t)\" to \"public void unregister(ZKMBeanInfo bean)\" method that will generate an error log instead of a warn. \n\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java, line 1\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48126#file48126line1>\nbq.  >\nbq.  >     license header is missing. add the std boilerplate found on any other java file in the project.\n\nAs you can see I'm a newbie contributor ;-)\n\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java, line 15\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48126#file48126line15>\nbq.  >\nbq.  >     add a comment to the class describing what this set of tests is for\n\nDone.\n\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java, line 16\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48126#file48126line16>\nbq.  >\nbq.  >     no tabs, reformat with spaces only. (you'll probably need to cleanup some of your other changes at the same time)\n\nDone. It would be nice that the eclipse ant task will create the .setting files to set all formatting rules and useful save actions (like apply formatting). I'll investigate it and upload as a new jira if success.\n\n\nbq.  On 2011-12-14 23:36:06, Patrick Hunt wrote:\nbq.  > /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java, line 19\nbq.  > <https://reviews.apache.org/r/2208/diff/1/?file=48126#file48126line19>\nbq.  >\nbq.  >     it's fine to ref a jira here, however there should also be some details on what this test is doing. (short summary esp as the test itself is pretty clear)\n\nDone.\n\n\n- César\n\n\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2208/#review3914\n-----------------------------------------------------------\n\n\nOn 2011-10-05 11:59:30, César Álvarez Núñez wrote:\nbq.  \nbq.  -----------------------------------------------------------\nbq.  This is an automatically generated e-mail. To reply, visit:\nbq.  https://reviews.apache.org/r/2208/\nbq.  -----------------------------------------------------------\nbq.  \nbq.  (Updated 2011-10-05 11:59:30)\nbq.  \nbq.  \nbq.  Review request for zookeeper.\nbq.  \nbq.  \nbq.  Summary\nbq.  -------\nbq.  \nbq.  See https://issues.apache.org/jira/browse/ZOOKEEPER-1214\nbq.  \nbq.  \nbq.  This addresses bug ZOOKEEPER-1214.\nbq.      https://issues.apache.org/jira/browse/ZOOKEEPER-1214\nbq.  \nbq.  \nbq.  Diffs\nbq.  -----\nbq.  \nbq.    /src/java/test/org/apache/zookeeper/test/QuorumUtil.java 1179165 \nbq.    /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java PRE-CREATION \nbq.    /src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java 1179166 \nbq.    /src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java 1169669 \nbq.  \nbq.  Diff: https://reviews.apache.org/r/2208/diff\nbq.  \nbq.  \nbq.  Testing\nbq.  -------\nbq.  \nbq.  -\nbq.  \nbq.  \nbq.  Thanks,\nbq.  \nbq.  César\nbq.  \nbq.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2012-01-05T16:39:39.004+0000","updated":"2012-01-05T16:39:39.004+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13180514","id":"13180514","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12509566/ZOOKEEPER-1214.patch\n  against trunk revision 1227000.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/879//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/879//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/879//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-01-05T16:45:30.049+0000","updated":"2012-01-05T16:45:30.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13181017","id":"13181017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"Can you update the diff on RB, re-submit, and I'll take another look? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-01-06T01:11:49.262+0000","updated":"2012-01-06T01:11:49.262+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13185558","id":"13185558","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2208/\n-----------------------------------------------------------\n\n(Updated 2012-01-13 12:10:38.234750)\n\n\nReview request for zookeeper.\n\n\nSummary\n-------\n\nSee https://issues.apache.org/jira/browse/ZOOKEEPER-1214\n\n\nThis addresses bug ZOOKEEPER-1214.\n    https://issues.apache.org/jira/browse/ZOOKEEPER-1214\n\n\nDiffs (updated)\n-----\n\n  /src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java 1226094 \n  /src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java 1226094 \n  /src/java/test/org/apache/zookeeper/test/QuorumUtil.java 1226094 \n  /src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java PRE-CREATION \n\nDiff: https://reviews.apache.org/r/2208/diff\n\n\nTesting\n-------\n\n-\n\n\nThanks,\n\nCésar\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2012-01-13T12:12:39.831+0000","updated":"2012-01-13T12:12:39.831+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13434479","id":"13434479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"+1\n\nPat, could you take a look at the updated patch? If it looks ok to you, I'll go ahead and check this patch in.\n\nThanks!\n--Michi","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-14T20:32:01.008+0000","updated":"2012-08-14T20:32:01.008+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13494297","id":"13494297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"Ping!\n\n--Michi","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-11-09T20:43:22.011+0000","updated":"2012-11-09T20:43:22.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13571756","id":"13571756","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"I saw this error in 3.4.5 with ZOOKEEPER-1214.patch applied. \n\n2013-02-04 03:42:39,682 503835 [pool-1-thread-6] INFO org.apache.zookeeper.jmx.MBeanRegistry  - Unregister MBean [org.apache.ZooKeeperService:name0=ReplicatedServer_id0,name1=replica.0,name2=Follower,name3=Connections,name4=127.0.0.1,name5=0x13ca4fc35c40001]\n2013-02-04 03:42:39,683 503836 [QuorumPeer[myid=0]/127.0.0.1:2901] ERROR org.apache.zookeeper.jmx.MBeanRegistry  - Unexpected exception during unregister of [Follower]. It should be reviewed and fixed.\njava.lang.IllegalMonitorStateException\n        at java.util.concurrent.locks.ReentrantReadWriteLock$Sync.tryReleaseShared(ReentrantReadWriteLock.java:398)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.releaseShared(AbstractQueuedSynchronizer.java:1340)\n        at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.unlock(ReentrantReadWriteLock.java:778)\n        at com.sun.jmx.mbeanserver.Repository.retrieve(Repository.java:522)\n        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getMBean(DefaultMBeanServerInterceptor.java:1111)\n        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.exclusiveUnregisterMBean(DefaultMBeanServerInterceptor.java:433)\n        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.unregisterMBean(DefaultMBeanServerInterceptor.java:421)\n        at com.sun.jmx.mbeanserver.JmxMBeanServer.unregisterMBean(JmxMBeanServer.java:540)\n        at org.apache.zookeeper.jmx.MBeanRegistry.unregister(MBeanRegistry.java:116)\n        at org.apache.zookeeper.jmx.MBeanRegistry.unregister(MBeanRegistry.java:137)\n        at org.apache.zookeeper.server.quorum.LearnerZooKeeperServer.unregisterJMX(LearnerZooKeeperServer.java:138)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:100)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:745)\n\nI'm using openjdk-6-jre-6b24-1.11.3-1ubuntu0.12.04.1. Should I use sun-java6-jre instead?\n\n--Michi\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-02-05T21:39:31.594+0000","updated":"2013-02-05T21:39:31.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13572143","id":"13572143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"https://issues.apache.org/jira/browse/ZOOKEEPER-1214\n\nHi Michi,\n\nMy two cents: this looks like a bug in ReentrantReadWriteLock, the JVM, or even an incorrect use of _ReentrantReadWriteLock_ by JmxMBeanServer. I say so because a quick Google search shows that other projects that use ReentrantReadWriteLock, *directly or not*, as HBase, Netbeans and Maven have hit this very same exception.\n\nAs ZooKeeper uses _ReentrantReadWriteLock_ indirectly through JmxMBeanServer, a possible solution seems to be to create a lock object and synchronize lines 98 and 117 of JmxMBeanServer as follows:\n\n{code:title=JmxMBeanServer.java|borderStyle=solid}\n...\nprivate final Object LOCK = new Object();\n...\n// line 98 becomes\n  synchronize (LOCK) {\n     mBeanServer.registerMBean(bean, oname);            \n  }\n// line 117 becomes\n  synchronize (LOCK) {\n     mBeanServer.unregisterMBean(makeObjectName(path, bean));\n  }\n{code}\n\nAs this is a issue addressed to Cesar I'll not submit a patch, but I may provide you a patch by email to see if this  solution works.;)\n\nCheers,\nEdward","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2013-02-06T04:33:21.330+0000","updated":"2013-02-06T04:33:21.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13572190","id":"13572190","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"Ummm ... as this issue last patch is +1 year old -- and I made a silly mistake during my previous explanation (sorry, it's _synchronized_ keyword  instead of _synchronize_) -- then I  decided to submit a new version of Cesar's patch that applies against the trunk and implements the _possible_ solution I've just proposed. It still Cesar's patch tough. See if it helps. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2013-02-06T05:25:38.435+0000","updated":"2013-02-06T05:25:38.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13572882","id":"13572882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"Thank you for the patch, Edward.\n\nThis patch looks good to me. I'd like to check it in if nobody is against it.\n\n--Michi","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-02-06T21:52:49.582+0000","updated":"2013-02-06T21:52:49.582+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13573256","id":"13573256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"body":"Thanks for the feedback Michi, it's highly appreciated. I am sending a new version with an one line change wrt the previous one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eribeiro","name":"eribeiro","key":"eribeiro","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eribeiro&avatarId=16169","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eribeiro&avatarId=16169","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eribeiro&avatarId=16169","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eribeiro&avatarId=16169"},"displayName":"Edward Ribeiro","active":true,"timeZone":"America/Sao_Paulo"},"created":"2013-02-07T07:09:19.950+0000","updated":"2013-02-07T07:09:19.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13986100","id":"13986100","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry I forgot about this patch. I'll rebase it and check it in.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-30T21:15:21.686+0000","updated":"2014-04-30T21:15:21.686+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/13986152","id":"13986152","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12642729/ZOOKEEPER-1214.patch\n  against trunk revision 1591175.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2070//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2070//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2070//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-04-30T22:07:39.668+0000","updated":"2014-04-30T22:07:39.668+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/14000965","id":"14000965","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12642729/ZOOKEEPER-1214.patch\n  against trunk revision 1595559.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2101//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2101//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2101//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-18T03:26:08.593+0000","updated":"2014-05-18T03:26:08.593+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/14000983","id":"14000983","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"trunk: http://svn.apache.org/viewvc?view=revision&revision=1595561","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-18T03:49:28.504+0000","updated":"2014-05-18T03:49:28.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12525784/comment/14003086","id":"14003086","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in ZooKeeper-trunk #2311 (See [https://builds.apache.org/job/ZooKeeper-trunk/2311/])\nZOOKEEPER-1214. QuorumPeer should unregister only its previsously registered MBeans instead of use MBeanRegistry.unregisterAll() method. (César Álvarez Núñez via michim) (michim: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1595561)\n* /zookeeper/trunk/CHANGES.txt\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/jmx/MBeanRegistry.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/QuorumUtil.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/test/QuorumUtilTest.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-20T11:09:12.272+0000","updated":"2014-05-20T11:09:12.272+0000"}],"maxResults":23,"total":23,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1214/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i05ybz:"}}