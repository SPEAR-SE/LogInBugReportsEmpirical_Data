{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12970401","self":"https://issues.apache.org/jira/rest/api/2/issue/12970401","key":"ZOOKEEPER-2429","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326518","id":"12326518","name":"3.6.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12343268","id":"12343268","description":"Beta release against 3.5 branch","name":"3.5.5","archived":false,"released":false}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-05-26T18:20:41.623+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Jun 04 02:45:12 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2429/watchers","watchCount":3,"isWatching":false},"created":"2016-05-17T15:19:36.703+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316644","id":"12316644","description":"Dynamic Reconfig, Remove Watches, Local Session","name":"3.5.0","archived":false,"released":true,"releaseDate":"2014-08-04"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsaurav","name":"jsaurav","key":"jsaurav","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh jain","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-05-10T20:09:28.925+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12329414","id":"12329414","name":"security"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12312382","id":"12312382","name":"server","description":"General issues with the ZooKeeper server."}],"timeoriginalestimate":null,"description":"When connecting from a zookeeper client running in IBM WebSphere Application Server version 8.5.5, with SSL configured in ZooKeeper, the below mentioned exception is observed.\n\norg.jboss.netty.channel.ChannelPipelineException: Failed to initialize a pipeline.\n      at org.jboss.netty.bootstrap.ClientBootstrap.connect(ClientBootstrap.java:208)\n      at org.jboss.netty.bootstrap.ClientBootstrap.connect(ClientBootstrap.java:182)\n      at org.apache.zookeeper.ClientCnxnSocketNetty.connect(ClientCnxnSocketNetty.java:112)\n      at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1130)\n      at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1158)\nCaused by: org.apache.zookeeper.common.X509Exception$SSLContextException: Failed to create KeyManager\n      at org.apache.zookeeper.common.X509Util.createSSLContext(X509Util.java:75)\n      at org.apache.zookeeper.ClientCnxnSocketNetty$ZKClientPipelineFactory.initSSL(ClientCnxnSocketNetty.java:358)\n      at org.apache.zookeeper.ClientCnxnSocketNetty$ZKClientPipelineFactory.getPipeline(ClientCnxnSocketNetty.java:348)\n      at org.jboss.netty.bootstrap.ClientBootstrap.connect(ClientBootstrap.java:206)\n      ... 4 more\nCaused by: org.apache.zookeeper.common.X509Exception$KeyManagerException: java.security.NoSuchAlgorithmException: SunX509 KeyManagerFactory not available\n      at org.apache.zookeeper.common.X509Util.createKeyManager(X509Util.java:129)\n      at org.apache.zookeeper.common.X509Util.createSSLContext(X509Util.java:73)\n      ... 7 more\nCaused by: java.security.NoSuchAlgorithmException: SunX509 KeyManagerFactory not available\n      at sun.security.jca.GetInstance.getInstance(GetInstance.java:172)\n      at javax.net.ssl.KeyManagerFactory.getInstance(KeyManagerFactory.java:9)\n      at org.apache.zookeeper.common.X509Util.createKeyManager(X509Util.java:118)\n\n\nReason : IBM websphere uses its own jre and supports only IbmX509 keymanager algorithm which is causing an exception when trying to get an key manager instance using SunX509 which is not supported.\nCurrently KeyManager algorithm name  (SunX509) is hardcoded in the class X509Util.java.\n\nPossible fix: Instead of having algorithm name hardcoded to SunX509 we can fall back to the default algorithm supported by the underlying jre.\n\nInstead of having this -\nKeyManagerFactory kmf = KeyManagerFactory.getInstance(\"SunX509\");\nTrustManagerFactory tmf = TrustManagerFactory.getInstance(\"SunX509\");\n\ncan we have ?\nKeyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());\n\nTrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"IbmX509 KeyManager and TrustManager algorithm not supported","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sauravmanit","name":"sauravmanit","key":"sauravmanit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Jain","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sauravmanit","name":"sauravmanit","key":"sauravmanit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Jain","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12970401/comment/15299391","id":"15299391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sauravmanit","name":"sauravmanit","key":"sauravmanit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Jain","active":true,"timeZone":"America/New_York"},"body":"Started working on this.\nMaking the KeyManager and TrustManager algorithm as a configurable property , which user can pass as the vm arguments.\nIn addition to the already existing properties\n\n-Dzookeeper.ssl.keyStore.location\n-Dzookeeper.ssl.keyStore.password\n-Dzookeeper.ssl.trustStore.location\n-Dzookeeper.ssl.trustStore.password\n\n2 new properties can also be defined in the server startup script.\n-Dzookeeper.ssl.keyManager.algorithm\n-Dzookeeper.ssl.trustManager.algorithm\n\nIf the properties are missing then it will fallback to the default algorithm supported by underlying jre.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sauravmanit","name":"sauravmanit","key":"sauravmanit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Jain","active":true,"timeZone":"America/New_York"},"created":"2016-05-25T03:25:25.047+0000","updated":"2016-05-25T03:25:25.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12970401/comment/15302630","id":"15302630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"Additional user-facing configuration for this might not be necessary, and it might push more operational complexity onto administrators.  FWIW, there is a bit of code in Hadoop that takes the approach of runtime detection of the IBM JRE, and then automatically toggles between the two algorithms.  See the [SSLFactory|https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/ssl/SSLFactory.java#L71] and [PlatformName|https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-auth/src/main/java/org/apache/hadoop/util/PlatformName.java#L46-L50] classes.\n\nA challenge we've had in the Hadoop community is that not many (none?) of the committers have access to the IBM JRE for verification of proposed patches.  Saurabh, if you can help on any testing efforts related to IBM JRE support, we would greatly appreciate that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-26T18:20:41.623+0000","updated":"2016-05-26T18:20:41.623+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12970401/comment/15311135","id":"15311135","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"I believe Eugene took much of the original implementation from Hadoop, so this makes sense to me (what Chris said).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-06-01T21:25:03.038+0000","updated":"2016-06-01T21:25:03.038+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12970401/comment/15315277","id":"15315277","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sauravmanit","name":"sauravmanit","key":"sauravmanit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Jain","active":true,"timeZone":"America/New_York"},"body":"Yeah , if some solution already exists for the same problem then there is no meaning in reinventing the wheel.\n\nI had gone through the classes as you mentioned in the above comment and will take the same approach to fix it.\n\nThanks for pointing it out.\n\nI will keep you posted once i test it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sauravmanit","name":"sauravmanit","key":"sauravmanit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Jain","active":true,"timeZone":"America/New_York"},"created":"2016-06-04T02:45:12.197+0000","updated":"2016-06-04T02:45:12.197+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2429/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2y31r:"}}