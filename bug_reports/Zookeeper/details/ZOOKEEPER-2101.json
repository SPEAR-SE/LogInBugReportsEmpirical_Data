{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12764775","self":"https://issues.apache.org/jira/rest/api/2/issue/12764775","key":"ZOOKEEPER-2101","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12340141","id":"12340141","description":"Beta release against 3.5 branch","name":"3.5.4","archived":false,"released":true,"releaseDate":"2018-05-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326518","id":"12326518","name":"3.6.0","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2015-01-05T05:29:59.789+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Mar 26 13:30:45 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_2_*:*_13468824398_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_88235822300","customfield_12312321":null,"resolutiondate":"2018-03-26T13:30:59.574+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2101/watchers","watchCount":13,"isWatching":false},"created":"2015-01-04T10:13:32.904+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319841","id":"12319841","description":"Fix release against 3.4 branch.","name":"3.4.4","archived":false,"released":true,"releaseDate":"2012-09-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-03-26T13:30:59.600+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312385","id":"12312385","name":"jute","description":"Data marshalling code generator for ZooKeeper"}],"timeoriginalestimate":null,"description":"*Problem*\nFor multi operation, PrepRequestProcessor may produce a large transaction whose size may be larger than the max buffer size of jute. There is check of buffer size in readBuffer method  of BinaryInputArchive, but no check in writeBuffer method  of BinaryOutputArchive, which will cause that \n\n1, Leader can sync transaction to txn log and send the large transaction to the followers, but the followers failed to read the transaction and can't sync with leader.\n{code}\n2015-01-04,12:42:26,474 WARN org.apache.zookeeper.server.quorum.Learner: [myid:2] Exception when following the leader\njava.io.IOException: Unreasonable length = 2054758\n        at org.apache.jute.BinaryInputArchive.readBuffer(BinaryInputArchive.java:100)\n        at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:85)\n        at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n        at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)\n2015-01-04,12:42:26,475 INFO org.apache.zookeeper.server.quorum.Learner: [myid:2] shutdown called\njava.lang.Exception: shutdown Follower\n        at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)\n{code}\n\n2, The leader lose all followers, which trigger the leader election. The old leader will become leader again for it has up-to-date data.\n{code}\n2015-01-04,12:42:28,502 INFO org.apache.zookeeper.server.quorum.Leader: [myid:3] Shutting down\n2015-01-04,12:42:28,502 INFO org.apache.zookeeper.server.quorum.Leader: [myid:3] Shutdown called\njava.lang.Exception: shutdown Leader! reason: Only 1 followers, need 2\n        at org.apache.zookeeper.server.quorum.Leader.shutdown(Leader.java:496)\n        at org.apache.zookeeper.server.quorum.Leader.lead(Leader.java:471)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:753)\n{code}\n3, The leader can not load the transaction from the txn log for the length of data is larger than the max buffer of jute.\n{code}\n\n2015-01-04,12:42:31,282 ERROR org.apache.zookeeper.server.quorum.QuorumPeer: [myid:3] Unable to load database on disk\njava.io.IOException: Unreasonable length = 2054758\n        at org.apache.jute.BinaryInputArchive.readBuffer(BinaryInputArchive.java:100)\n        at org.apache.zookeeper.server.persistence.Util.readTxnBytes(Util.java:233)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:602)\n        at org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:157)\n        at org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:223)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.loadDataBase(QuorumPeer.java:417)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.getLastLoggedZxid(QuorumPeer.java:546)\n        at org.apache.zookeeper.server.quorum.FastLeaderElection.getInitLastLoggedZxid(FastLeaderElection.java:690)\n        at org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:737)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:716)\n{code}\n\nThe zookeeper service will be unavailable until we enlarge the jute.maxbuffer and restart zookeeper hbase cluster.\n\n*Solution*\nAdd buffer size check in BinaryOutputArchive to avoid large transaction be written to log and sent to followers.\n\nBut I am not sure if there are side-effects of throwing an IOException in BinaryOutputArchive  and RequestProcessors\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12692730","id":"12692730","filename":"test.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-16T10:06:44.649+0000","size":2057,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12692730/test.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12689971","id":"12689971","filename":"ZOOKEEPER-2101-v1.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-04T10:39:03.096+0000","size":681,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12689971/ZOOKEEPER-2101-v1.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12693209","id":"12693209","filename":"ZOOKEEPER-2101-v2.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-20T03:09:12.849+0000","size":2176,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12693209/ZOOKEEPER-2101-v2.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12693844","id":"12693844","filename":"ZOOKEEPER-2101-v3.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-22T09:46:55.178+0000","size":10458,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12693844/ZOOKEEPER-2101-v3.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12732837","id":"12732837","filename":"ZOOKEEPER-2101-v4.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-14T12:17:10.375+0000","size":11189,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12732837/ZOOKEEPER-2101-v4.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12733704","id":"12733704","filename":"ZOOKEEPER-2101-v5.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T03:57:45.691+0000","size":11542,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12733704/ZOOKEEPER-2101-v5.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12733762","id":"12733762","filename":"ZOOKEEPER-2101-v6.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T09:29:31.043+0000","size":11519,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12733762/ZOOKEEPER-2101-v6.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12734317","id":"12734317","filename":"ZOOKEEPER-2101-v7.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-21T03:16:43.987+0000","size":11489,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12734317/ZOOKEEPER-2101-v7.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12774993","id":"12774993","filename":"ZOOKEEPER-2101-v8.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-01T09:21:44.507+0000","size":11422,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12774993/ZOOKEEPER-2101-v8.diff"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Transaction larger than max buffer of jute makes zookeeper unavailable","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14263828","id":"14263828","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Patch for trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-04T10:39:03.121+0000","updated":"2015-01-04T10:39:03.121+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14264194","id":"14264194","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for reporting this issue. Could you please point me the way PrepRequestProcessor producing the transaction larger than the max buffer size of jute?. Also, I hope in your cluster all zk servers are having the default \"jute.maxbuffer=1MB\"","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-01-05T05:29:59.789+0000","updated":"2015-01-05T05:29:59.789+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14264243","id":"14264243","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~rakeshr]\n{quote}\nCould you please point me the way PrepRequestProcessor producing the transaction larger than the max buffer size of jute?\n{quote}\nIt's a multi request from hbase regionserver which wants to copy a large replication queue of a dead regionserver.\n\n{quote}\nI hope in your cluster all zk servers are having the default \"jute.maxbuffer=1MB\"\n{quote}\nOK. I am trying to reproduce the problem in a test cluste with jute.maxbuffer=1MB.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-05T06:49:47.972+0000","updated":"2015-01-05T06:49:47.972+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14280046","id":"14280046","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~rakeshr]\nAdd log in ZKDatabase to validate that the  size of Proposal may larger than the request size.\n\n{code}\n2015-01-16 17:56:07,469 [myid:] - INFO  [SyncThread:0:ZKDatabase@261] - Request type 14 size: 5499 zxid: 2, Proposal size:5526\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-16T10:06:44.659+0000","updated":"2015-01-16T10:06:44.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14283348","id":"14283348","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Limit the size of packet less than the half of jute max buffer size","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-20T03:09:12.859+0000","updated":"2015-01-20T03:09:12.859+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14283481","id":"14283481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12693209/ZOOKEEPER-2101-v2.diff\n  against trunk revision 1646992.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2483//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2483//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2483//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-20T06:26:04.011+0000","updated":"2015-01-20T06:26:04.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14287175","id":"14287175","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Check proposal size in PrepRequestProcessor and throw ProposalTooLargeException exception when proposal is larger then the max jute buffer size.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-22T09:46:55.187+0000","updated":"2015-01-22T09:46:55.187+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14287218","id":"14287218","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12693844/ZOOKEEPER-2101-v3.diff\n  against trunk revision 1646992.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 javadoc.  The javadoc tool appears to have generated 2 warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2484//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2484//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2484//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-01-22T10:35:44.134+0000","updated":"2015-01-22T10:35:44.134+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14290542","id":"14290542","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the patch. I've few comments:\n- The attached log is comparing {{request.request.capacity()}}  and {{data.length}}. But {{data.length}} contains both request and additional fields. So comparing these both won't give exact values.\n- It would be really great if you can add unit test.\n- In the log message, use {} instead of +\n{code} \nLOG.error(\"Proposal size larger than max buffer:\" + BinaryInputArchive.maxBuffer\n+                + \" set by jute.maxbuffer\");\n{code}\n- Make this to debug level\n{code}\nif (request.request != null) {\n+                LOG.info(\"Request type \" + request.type + \" size: \" + request.request.capacity()\n+                    + \" zxid: \" + request.zxid + \", Proposal size:\" + data.length);\n             }\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-01-24T11:01:15.477+0000","updated":"2015-01-24T11:01:15.477+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14498547","id":"14498547","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iandi","name":"iandi","key":"iandi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iandi&avatarId=21639","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iandi&avatarId=21639","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iandi&avatarId=21639","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iandi&avatarId=21639"},"displayName":"Ian Dimayuga","active":true,"timeZone":"America/Los_Angeles"},"body":"I notice this patch introduces a new error code, \"PROPOSALTOOLARGE\". If you add a new error code, you will need to modify the C client to recognize the new error code as well.\n\nHowever, perhaps an existing error code would be suited to this, such as \"BADARGUMENTS\"?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=iandi","name":"iandi","key":"iandi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=iandi&avatarId=21639","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=iandi&avatarId=21639","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=iandi&avatarId=21639","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=iandi&avatarId=21639"},"displayName":"Ian Dimayuga","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-16T19:21:43.819+0000","updated":"2015-04-16T19:21:43.819+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14498563","id":"14498563","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12693844/ZOOKEEPER-2101-v3.diff\n  against trunk revision 1672934.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2636//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-04-16T19:31:01.040+0000","updated":"2015-04-16T19:31:01.040+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14543558","id":"14543558","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Update for [~rakeshr] review.\n- Add unit tests\n- Fix the log problems\n\n{quote}\nThe attached log is comparing request.request.capacity() and data.length. But data.length contains both request and additional fields. So comparing these both won't give exact values.\n{quote}\nJust add more info in the log","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-14T12:17:10.437+0000","updated":"2015-05-14T12:17:10.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14543561","id":"14543561","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~rakeshr]\nSorry for late replay.\nCould you help to review the new patch? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-14T12:18:04.448+0000","updated":"2015-05-14T12:18:04.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14543584","id":"14543584","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~iandi]\n{quote}\nHowever, perhaps an existing error code would be suited to this, such as \"BADARGUMENTS\"?\n{quote}\nGood advice. Change the error code to BADARGUMENTS. Thanks.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-14T12:20:34.464+0000","updated":"2015-05-14T12:20:34.464+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14543703","id":"14543703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12732837/ZOOKEEPER-2101-v4.diff\n  against trunk revision 1679313.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2698//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2698//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2698//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-14T14:07:23.386+0000","updated":"2015-05-14T14:07:23.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14544843","id":"14544843","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"The failed test has no relation with this patch. \nAnd rerun it in my machine for many times and all passed.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-15T03:07:24.942+0000","updated":"2015-05-15T03:07:24.942+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14547460","id":"14547460","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~michim]\nCould you help to review this patch? I saw you help to update fix versions. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-18T02:22:39.945+0000","updated":"2015-05-18T02:22:39.945+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14547863","id":"14547863","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~liushaohui] for taking care this. Just few comments:\n\n# Move {{          baos.close();}} to finally block\n# Please format the lines, few lines exceeds > 80 lines.\n# In tests, any specific reason to increase the value of {{TEST_MAXBUFFER}} to 1000?\n# I missed this part in my previous review. I've checked other places, it is checking < 0 condition also.\n  IMO good to follow the same way like,\n{code}\nif (barr.length < 0 || barr.length > BinaryInputArchive.maxBuffer) {\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-05-18T11:00:18.887+0000","updated":"2015-05-18T11:00:18.887+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14549741","id":"14549741","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Update for [~rakeshr]'s review.\n{quote}\nMove {{ baos.close();}} to finally block\n{quote}\nDone.\n{quote}\nPlease format the lines, few lines exceeds > 80 lines.\n{quote}\nDone.\n{quote}\nIn tests, any specific reason to increase the value of TEST_MAXBUFFER to 1000?\n{quote}\nThe size of extra fields in transaction is large than 100.\nSo we increase the TEST_MAXBUFFER to 1000.\n\n{quote}\nchecking < 0 condition also.\n{quote}\nDone.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T03:57:45.705+0000","updated":"2015-05-19T03:57:45.705+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14549754","id":"14549754","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12733704/ZOOKEEPER-2101-v5.diff\n  against trunk revision 1679951.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2702//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2702//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2702//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T04:14:02.297+0000","updated":"2015-05-19T04:14:02.297+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14549952","id":"14549952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for all your work!\n\nApart from the following comments +1 from me.\n\n# Instead of try-catch, can we use {{IOUtils.cleanup(LOG, baos);}} for the cleaning up ?\n{code}\n try {\n+            baos.close();\n+          } catch (IOException e) {\n+            LOG.error(\"This really should be impossible\", e);\n+          }\n{code}\n# Now with the new condition, it can throw exception < 0 and > maxbuffer. In that case, good to reflect the message more clear like below. Presently its saying {{larger than max buffer}}. Also, please do the necessary changes for the log messages.\n{code}\nthrow new IOException(\"Len error \" + len);\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-05-19T07:14:03.442+0000","updated":"2015-05-19T07:14:03.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14550122","id":"14550122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Update for [~rakeshr]'s review.\n- Using IOUtils.cleanup(LOG, baos) Instead of try-catch.\n- Update the log messages:\n{code}\n        throw new IOException(\"Len error \" + barr.length\n            + \", less than 0 or larger than max buffer: \"\n            + BinaryInputArchive.maxBuffer + \" set by jute.maxbuffer\");\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T09:29:31.049+0000","updated":"2015-05-19T09:29:31.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14550136","id":"14550136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12733762/ZOOKEEPER-2101-v6.diff\n  against trunk revision 1679951.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2703//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2703//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2703//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-19T09:44:01.024+0000","updated":"2015-05-19T09:44:01.024+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14551684","id":"14551684","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~rakeshr]\nDo we need another +1 for commit? Or could you help to push this issue?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-20T02:29:30.417+0000","updated":"2015-05-20T02:29:30.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14551782","id":"14551782","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"It would be good to get another +1 from a committer. Any one would like to review. Thanks!\n\ncc: [~rgs], [~hdeng], [~michim], [~shralex]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-05-20T04:21:16.217+0000","updated":"2015-05-20T04:21:16.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14553368","id":"14553368","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"body":"* BinaryOutputArchive.java:\nindent.\n\n* PrepRequestProcessor:\nI am not sure about this. How can a failed op get a zxid? Does the zxid increment here? I'm also asking a question here :)\n\n* BufferSizeTest:\nindent.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-20T23:49:54.974+0000","updated":"2015-05-20T23:49:54.974+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14553561","id":"14553561","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Update for [~hdeng]'s reivew.\n\n- Fix the indent.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-21T03:16:44.002+0000","updated":"2015-05-21T03:16:44.002+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14553565","id":"14553565","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~hdeng]\n{code}\n        checkProposalSize(request);\n        request.zxid = zks.getZxid();\n{code}\nAccording to my understanding the zxid has increamed before this codes by calling zks.getNextZxid().\nThe zks.getZxid() just get current zxid.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-21T03:20:35.045+0000","updated":"2015-05-21T03:20:35.045+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14553601","id":"14553601","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12734317/ZOOKEEPER-2101-v7.diff\n  against trunk revision 1680471.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2707//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2707//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2707//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-21T04:21:38.186+0000","updated":"2015-05-21T04:21:38.186+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14554808","id":"14554808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"body":"Another question:\n\nin SerializeUtils:\n{code}\nserializeRequest():\n   catch (IOException e) {\n\t            LOG.error(\"This really should be impossible\", e);\n{code}\n\nIf such an unexpected exception happens, should the exception goes up and let server fail?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-21T18:25:26.398+0000","updated":"2015-05-21T18:25:26.398+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14555535","id":"14555535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~hdeng]\nActually, these code are just moved from ZKDatabase.java or Leader.java. Please see the patch.\nI am not very sure about why it just ingore those exceptions. Maybe it's really impossible.\n\nOr we can open another jira issue to discuss it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-22T03:53:25.710+0000","updated":"2015-05-22T03:53:25.710+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14557930","id":"14557930","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"[~hdeng]\nAny suggestion?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-25T02:09:52.872+0000","updated":"2015-05-25T02:09:52.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14557932","id":"14557932","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"body":"It's just my personal opinion. Swallowing a system failure exception doesn't look like a good choice. I usually prefer to let the system crash if not recoverable.\n\nI'm not sure why in Leader and ZKDatabase it did that. So I will leave it to others to comment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-25T02:20:22.208+0000","updated":"2015-05-25T02:20:22.208+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14557939","id":"14557939","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"{quote}\nSwallowing a system failure exception doesn't look like a good choice. I usually prefer to let the system crash if not recoverable.\n{quote}\nAgreed\n\n{quote}\nSo I will leave it to others to comment.\n{quote}\nFrom the log, the last changes of these code are done by [~fpj] in ZOOKEEPER-106\n\n[~fpj]\nDo you know why the exceptions is ignored in ZKDatabase.java or Leader.java? Thanks~\n{code}\n      ByteArrayOutputStream baos = new ByteArrayOutputStream();\n      BinaryOutputArchive boa = BinaryOutputArchive.getArchive(baos);\n      try {\n          request.hdr.serialize(boa, \"hdr\");\n          if (request.txn != null) {\n              request.txn.serialize(boa, \"txn\");\n          }\n          baos.close();\n      } catch (IOException e) {\n          LOG.error(\"This really should be impossible\", e);\n      }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-25T02:50:47.705+0000","updated":"2015-05-25T02:50:47.705+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14715491","id":"14715491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Can we get this finished up folks?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-26T20:50:40.390+0000","updated":"2015-08-26T20:50:40.390+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14715503","id":"14715503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"body":"I will review it by this weekend and hopefully get it committed soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-08-26T21:00:13.885+0000","updated":"2015-08-26T21:00:13.885+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14715504","id":"14715504","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12734317/ZOOKEEPER-2101-v7.diff\n  against trunk revision 1697551.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2843//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-26T21:00:21.036+0000","updated":"2015-08-26T21:00:21.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14715508","id":"14715508","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Awesome thanks [~hdeng]!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-26T21:02:37.573+0000","updated":"2015-08-26T21:02:37.573+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/14717839","id":"14717839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"body":"I have one and only one comment on the swallowed exception as mentioned above. It would be great if other committers can review and give more feedback.\n\n[~liushaohui], are you still available for the JIRA? Otherwise I can take care of it. I want to get this done by the weekend.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hdeng","name":"hdeng","key":"hdeng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hongchao Deng","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-08-28T00:48:38.669+0000","updated":"2015-08-28T00:48:38.669+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15032933","id":"15032933","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"[~hdeng]/[~liushaohui] any update on this issue..?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2015-12-01T02:12:10.528+0000","updated":"2015-12-01T02:12:10.528+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15033005","id":"15033005","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12734317/ZOOKEEPER-2101-v7.diff\n  against trunk revision 1715590.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2972//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-01T03:23:13.608+0000","updated":"2015-12-01T03:23:13.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15033392","id":"15033392","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"body":"Rebase on the trunk\n\n[~brahmareddy] [~hdeng]\nCould you help to push this patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liushaohui","name":"liushaohui","key":"liushaohui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Liu Shaohui","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-01T09:21:44.511+0000","updated":"2015-12-01T09:21:44.511+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15033432","id":"15033432","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12774993/ZOOKEEPER-2101-v8.diff\n  against trunk revision 1715590.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2973//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2973//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2973//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-12-01T09:50:02.478+0000","updated":"2015-12-01T09:50:02.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15177001","id":"15177001","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12774993/ZOOKEEPER-2101-v8.diff\n  against trunk revision 1733348.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3061//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3061//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3061//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-03T02:19:48.119+0000","updated":"2016-03-03T02:19:48.119+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15342987","id":"15342987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12774993/ZOOKEEPER-2101-v8.diff\n  against trunk revision 1748630.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3221//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3221//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/3221//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-06-21T23:02:08.791+0000","updated":"2016-06-21T23:02:08.791+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/15997007","id":"15997007","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"body":"Hello, \nCan anybody shed some light on why it is not yet resolved? \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lavkesh","name":"lavkesh","key":"lavkesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lavkesh Lahngir","active":true,"timeZone":"Asia/Singapore"},"created":"2017-05-04T16:16:08.440+0000","updated":"2017-05-04T16:16:08.440+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225038","id":"16225038","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user anmolnar opened a pull request:\n\n    https://github.com/apache/zookeeper/pull/412\n\n    ZOOKEEPER-2101: Transaction larger than max buffer of jute makes zookeeper unavailable\n\n    This patch has been created to reanimate an ancient, unclosed Jira:\r\n    https://issues.apache.org/jira/browse/ZOOKEEPER-2101\r\n    \r\n    Original patch was done by Liu Shaohui and applied to latest trunk\r\n    without any modification.\r\n    \r\n    This one would be a nice kick off for implementing jute (max) buffer size\r\n    monitoring.\n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/anmolnar/zookeeper ZOOKEEPER-2101\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/zookeeper/pull/412.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #412\n    \n----\ncommit 68a5672aa2df542d7f7979d3876be871b685a197\nAuthor: Andor Molnr <andor@cloudera.com>\nDate:   2017-10-30T14:28:28Z\n\n    ZOOKEEPER-2101: This patch has been created to reanimate an ancient, unclosed Jira:\n    \n    https://issues.apache.org/jira/browse/ZOOKEEPER-2101\n    \n    Original patch was done by Liu Shaohui and applied to latest trunk\n    without any modification.\n    \n    This one would be a nice kick off for implementing jura buffer size\n    monitoring.\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T14:35:34.824+0000","updated":"2017-10-30T14:35:34.824+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225039","id":"16225039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"body":"I picked this one up and created a PR: https://github.com/apache/zookeeper/pull/412\r\n\r\nPlease review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"created":"2017-10-30T14:36:52.280+0000","updated":"2017-10-30T14:36:52.280+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225062","id":"16225062","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  GitHub Pull Request  Build\n      \n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1128//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1128//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1128//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T14:52:53.746+0000","updated":"2017-10-30T14:52:53.746+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225108","id":"16225108","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  GitHub Pull Request  Build\n      \n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 5 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 3.0.1) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1129//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1129//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-github-pr-build/1129//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T15:17:01.297+0000","updated":"2017-10-30T15:17:01.297+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225835","id":"16225835","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user afine commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/412#discussion_r147818798\n  \n    --- Diff: src/java/main/org/apache/jute/BinaryOutputArchive.java ---\n    @@ -115,6 +115,11 @@ public void writeBuffer(byte barr[], String tag)\n         \t\tout.writeInt(-1);\n         \t\treturn;\n         \t}\n    +    \tif (barr.length >= BinaryInputArchive.maxBuffer) {\n    --- End diff --\n    \n    maybe we could also use UNREASONABLE_LENGTH from BinaryInputArchive?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T22:09:59.400+0000","updated":"2017-10-30T22:09:59.400+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225836","id":"16225836","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user afine commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/412#discussion_r147798914\n  \n    --- Diff: src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java ---\n    @@ -905,10 +907,22 @@ protected void pRequest(Request request) throws RequestProcessorException {\n                     request.setTxn(new ErrorTxn(Code.MARSHALLINGERROR.intValue()));\n                 }\n             }\n    +        checkProposalSize(request);\n             request.zxid = zks.getZxid();\n             nextProcessor.processRequest(request);\n         }\n     \n    +    private void checkProposalSize(Request request) {\n    +        if (request.getHdr() == null) return;\n    +        byte[] data = SerializeUtils.serializeRequest(request);\n    --- End diff --\n    \n    I'm concerned about possible performance implications here. Are we serializing this request an extra time here?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T22:09:59.428+0000","updated":"2017-10-30T22:09:59.428+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225837","id":"16225837","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user afine commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/412#discussion_r147816281\n  \n    --- Diff: src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java ---\n    @@ -905,10 +907,22 @@ protected void pRequest(Request request) throws RequestProcessorException {\n                     request.setTxn(new ErrorTxn(Code.MARSHALLINGERROR.intValue()));\n                 }\n             }\n    +        checkProposalSize(request);\n             request.zxid = zks.getZxid();\n             nextProcessor.processRequest(request);\n         }\n     \n    +    private void checkProposalSize(Request request) {\n    +        if (request.getHdr() == null) return;\n    +        byte[] data = SerializeUtils.serializeRequest(request);\n    +        if (data.length > BinaryInputArchive.maxBuffer) {\n    +            LOG.error(\"Len error {}, larger than max buffer: {} set by jute.maxbuffer\",\n    +              data.length, BinaryInputArchive.maxBuffer);\n    --- End diff --\n    \n    maybe there is a more appropriate place for maxBuffer since it applies to input and output archive\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T22:09:59.434+0000","updated":"2017-10-30T22:09:59.434+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225838","id":"16225838","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user afine commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/412#discussion_r147811470\n  \n    --- Diff: src/java/main/org/apache/jute/BinaryOutputArchive.java ---\n    @@ -115,6 +115,11 @@ public void writeBuffer(byte barr[], String tag)\n         \t\tout.writeInt(-1);\n         \t\treturn;\n         \t}\n    +    \tif (barr.length >= BinaryInputArchive.maxBuffer) {\n    --- End diff --\n    \n    I'm not sure how valid this check is. The output buffer could contain other data that makes it larger than the maxBuffer even if barr is small right? Wouldn't it make more sense to track how much data has been written to \"out\"?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T22:09:59.444+0000","updated":"2017-10-30T22:09:59.444+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225839","id":"16225839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user afine commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/412#discussion_r147803340\n  \n    --- Diff: src/java/main/org/apache/zookeeper/server/util/SerializeUtils.java ---\n    @@ -148,4 +152,20 @@ public static void serializeSnapshot(DataTree dt,OutputArchive oa,\n             dt.serialize(oa, \"tree\");\n         }\n     \n    +    public static byte[] serializeRequest(Request request) {\n    +        if (request == null || request.getHdr() == null) return null;\n    --- End diff --\n    \n    are there valid situations where this could return null?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T22:09:59.449+0000","updated":"2017-10-30T22:09:59.449+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16225840","id":"16225840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user afine commented on a diff in the pull request:\n\n    https://github.com/apache/zookeeper/pull/412#discussion_r147815941\n  \n    --- Diff: src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java ---\n    @@ -905,10 +907,22 @@ protected void pRequest(Request request) throws RequestProcessorException {\n                     request.setTxn(new ErrorTxn(Code.MARSHALLINGERROR.intValue()));\n                 }\n             }\n    +        checkProposalSize(request);\n             request.zxid = zks.getZxid();\n             nextProcessor.processRequest(request);\n         }\n     \n    +    private void checkProposalSize(Request request) {\n    +        if (request.getHdr() == null) return;\n    +        byte[] data = SerializeUtils.serializeRequest(request);\n    +        if (data.length > BinaryInputArchive.maxBuffer) {\n    --- End diff --\n    \n    why do we need this if we are also checking how much data has been written when writing to the binary output archive?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-30T22:09:59.455+0000","updated":"2017-10-30T22:09:59.455+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16236309","id":"16236309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user anmolnar commented on the issue:\n\n    https://github.com/apache/zookeeper/pull/412\n  \n    Thanks @afine for looking into this and the detailed explanation.\r\n    \r\n    Unfortunately I cannot answer your question whether there could be other cases than multi when proposal size is bigger than the request. I'd would say *no*, but I'm not sure.\r\n    \r\n    Original patch was intended to implement a generic validation on the proposal size, but to stay on safe side I can move that check inside multi to avoid the performance implication in other cases.\r\n    \r\n    What do you think?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-02T18:15:54.505+0000","updated":"2017-11-02T18:15:54.505+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16239920","id":"16239920","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user anmolnar commented on the issue:\n\n    https://github.com/apache/zookeeper/pull/412\n  \n    I'm unable to create proper unit test for the issue, because cannot reliably reproduce the problem. Closing this PR.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-06T05:16:20.533+0000","updated":"2017-11-06T05:16:20.533+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16239921","id":"16239921","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user anmolnar closed the pull request at:\n\n    https://github.com/apache/zookeeper/pull/412\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-06T05:16:28.023+0000","updated":"2017-11-06T05:16:28.023+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16239923","id":"16239923","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"body":"I was working on creating a proper unit test which is reliably reproduces the original problem, because the patch doesn't contain any. Unfortunately I couldn't find a multi command which would end up in a too large proposal, so unable to create test.\r\n\r\nI suggest to close this ticket until someone provides example/test for it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"created":"2017-11-06T05:19:26.478+0000","updated":"2017-11-06T05:19:26.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12764775/comment/16413850","id":"16413850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"body":"Closing due to lack of response/interest.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andorm","name":"andorm","key":"andorm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andorm&avatarId=32935","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andorm&avatarId=32935","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andorm&avatarId=32935","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andorm&avatarId=32935"},"displayName":"Andor Molnar","active":true,"timeZone":"Europe/Budapest"},"created":"2018-03-26T13:30:45.219+0000","updated":"2018-03-26T13:30:45.219+0000"}],"maxResults":61,"total":61,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2101/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i23xkn:"}}