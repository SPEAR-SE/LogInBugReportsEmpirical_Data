{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12766603","self":"https://issues.apache.org/jira/rest/api/2/issue/12766603","key":"ZOOKEEPER-2104","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-10-21T21:55:37.894+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Dec 10 03:23:14 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2104/watchers","watchCount":21,"isWatching":false},"created":"2015-01-10T00:48:51.298+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323310","id":"12323310","description":"Fix release against 3.4 branch","name":"3.4.6","archived":false,"released":true,"releaseDate":"2014-03-10"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-12-10T03:23:14.640+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312382","id":"12312382","name":"server","description":"General issues with the ZooKeeper server."}],"timeoriginalestimate":null,"description":"In a 3 nodes ensemble, suddenly all the nodes seem to fail, displaying \"ZooKeeper is not running\" messages.\nNot retry seems to be happening after that.\n\nThis a request to understand what happened and probably to improve the logs when it does.\n\nSee logs below:\n\nNODE1:\n\n-- no log for several days before this --\n2015-01-04 16:18:22,259 [myid:1] - WARN  [SyncThread:1:FileTxnLog@321] - fsync-ing the write ahead log in SyncThread:1 took 11024ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide\n2015-01-04 16:18:22,380 [myid:1] - WARN  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:2181:Follower@89] - Exception when following the leader\njava.io.EOFException\n        at java.io.DataInputStream.readInt(DataInputStream.java:392)\n        at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n        at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)\n        at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:103)\n        at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:153)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:786)\n2015-01-04 16:18:23,384 [myid:1] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2015-01-04 16:18:23,492 [myid:1] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2015-01-04 16:18:24,060 [myid:1] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n\n\nNODE2:\n\n-- no log for several days before this --\n2015-01-04 16:18:21,899 [myid:3] - WARN  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2181:Follower@89] - Exception when following the leader\njava.io.EOFException\n        at java.io.DataInputStream.readInt(DataInputStream.java:392)\n        at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n        at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)\n        at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:103)\n        at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:153)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:786)\n2015-01-04 16:18:22,760 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2015-01-04 16:18:22,801 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2015-01-04 16:18:22,886 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n\n\nNODE3 (leader):\n\n-- no log for several days before this --\n2015-01-04 16:18:21,897 [myid:2] - WARN  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:LearnerHandler@687] - Closing connection to peer due to transaction timeout.\n2015-01-04 16:18:21,898 [myid:2] - WARN  [LearnerHandler-/204.53.107.249:43402:LearnerHandler@646] - ******* GOODBYE /204.53.107.249:43402 ********\n2015-01-04 16:18:21,905 [myid:2] - WARN  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:LearnerHandler@687] - Closing connection to peer due to transaction timeout.\n2015-01-04 16:18:21,907 [myid:2] - WARN  [LearnerHandler-/204.53.107.247:45953:LearnerHandler@646] - ******* GOODBYE /204.53.107.247:45953 ********\n2015-01-04 16:18:21,918 [myid:2] - WARN  [LearnerHandler-/204.53.107.247:45953:LearnerHandler@658] - Ignoring unexpected exception\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireInterruptibly(AbstractQueuedSynchronizer.java:1219)\n        at java.util.concurrent.locks.ReentrantLock.lockInterruptibly(ReentrantLock.java:340)\n        at java.util.concurrent.LinkedBlockingQueue.put(LinkedBlockingQueue.java:338)\n        at org.apache.zookeeper.server.quorum.LearnerHandler.shutdown(LearnerHandler.java:656)\n        at org.apache.zookeeper.server.quorum.LearnerHandler.run(LearnerHandler.java:649)\n2015-01-04 16:18:23,003 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2015-01-04 16:18:23,007 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2015-01-04 16:18:23,115 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12777802","id":"12777802","filename":"zookeeper-errors.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T19:17:49.704+0000","size":4552,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12777802/zookeeper-errors.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12777803","id":"12777803","filename":"zookeeper-warns.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T19:17:49.707+0000","size":5535,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12777803/zookeeper-warns.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Sudden crash of all nodes in the cluster","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=benjamin.jaton","name":"benjamin.jaton","key":"benjamin.jaton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Benjamin Jaton","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=benjamin.jaton","name":"benjamin.jaton","key":"benjamin.jaton","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Benjamin Jaton","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/14968035","id":"14968035","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=runiu","name":"runiu","key":"runiu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ray","active":true,"timeZone":"America/Los_Angeles"},"body":"We found the same issue, but it recovered after 10 minutes, was this expected?\nCan we fix this asap?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=runiu","name":"runiu","key":"runiu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ray","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-21T21:55:37.894+0000","updated":"2015-10-21T21:55:37.894+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15010403","id":"15010403","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=puneetdce%40gmail.com","name":"puneetdce@gmail.com","key":"puneetdce@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Puneet Sharma","active":true,"timeZone":"Etc/UTC"},"body":"We are facing the same issue and its took much longer to get recovered . \n\nSo our whole purpose of using Zookeeper cluster for HA has been defeated .\n\nPlease suggest . ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=puneetdce%40gmail.com","name":"puneetdce@gmail.com","key":"puneetdce@gmail.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Puneet Sharma","active":true,"timeZone":"Etc/UTC"},"created":"2015-11-18T07:31:47.103+0000","updated":"2015-11-18T07:31:47.103+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15056947","id":"15056947","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm seeing the same issue. Additional observations: when the ensemble gets into this state, the leader and followers appears to be replicating massive amount of data although the curator clients were mostly idle. The on disk foot print for the log and snapshot are 65MB and 500MB respectively and there are plenty of memory and disk space on the servers. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-14T23:16:52.409+0000","updated":"2015-12-14T23:16:52.409+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15057829","id":"15057829","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"The logs from the first node in the description indicate that syncing to disk is taking too long. Is the disk device shared between logs and snapshots? It is unclear from these logs why the second node abandoned the leader, but looks like a timeout of the socket.\n\n[~davidlao] you say the servers were replicating massive amounts of data, how did you notice it? Also, were the servers generating too many snapshots and is this due to a traffic spike? Would increasing snapCount help? Could you observe in the logs why the ensemble wasn't able to come back up?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-15T10:44:28.433+0000","updated":"2015-12-15T10:44:28.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15058591","id":"15058591","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"body":"In my case the logs and snapshots are on separate drives. I noticed the net traffics, with the resource monitor app which is part of the Windows OS, were from the leader to followers on port 2888. I was seeing ~15 MB/s traffic between the nodes. Will try to increasing the snapshot count (though I'd think the default 100k transactions is plenty for the particular running workload). \n\nThere are two distinct ERRORs from the log (see attached), one appears to be due to broken connection and the other is java.nio.channels.CancelledKeyException (reported in ZOOKEEPER-1237).  The broken connection error happens only once when server start. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T19:16:24.027+0000","updated":"2015-12-15T19:16:24.027+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15058594","id":"15058594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"body":"Add attachements","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-15T19:17:49.711+0000","updated":"2015-12-15T19:17:49.711+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15058891","id":"15058891","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"The errors in this case don't say much, just that the server can't read/write from the socket. Is there any issue with your disks? Have you checked the disk traffic around the time this happened? I'm assumed this happened once, but let me know if this is reproducible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2015-12-15T21:47:51.889+0000","updated":"2015-12-15T21:47:51.889+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15062554","id":"15062554","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"body":"Unfortunately I've lost a member server and its snapshots and upon restarting the issue is no longer reproducible. I'll keep an eye on this and provide update as appropriate. Thanks for taking a look. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-12-17T18:56:35.565+0000","updated":"2015-12-17T18:56:35.565+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15258776","id":"15258776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gvenka008c","name":"gvenka008c","key":"gvenka008c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Govindaraj","active":true,"timeZone":"Etc/UTC"},"body":"Hi All,\n\nI am also seeing the below error on all of my 3 nodes where zookeeper is installed. Zookeeper is not coming backup. Any thoughts?\n\n```\nApr 26 19:09:13 <hostname> zookeeper: 2016-04-26 19:09:13,966 [myid:3] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@362] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n```","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gvenka008c","name":"gvenka008c","key":"gvenka008c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Govindaraj","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-26T19:42:56.433+0000","updated":"2016-04-26T19:42:56.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15258851","id":"15258851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"body":"Have a look at your initLimit config. and ensure its large enough to allow for followers to fully sync to the leader. In my case, increasing the initLimit solved the problem.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidlao","name":"davidlao","key":"davidlao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Lao","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-26T20:27:09.735+0000","updated":"2016-04-26T20:27:09.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15259088","id":"15259088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gvenka008c","name":"gvenka008c","key":"gvenka008c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Govindaraj","active":true,"timeZone":"Etc/UTC"},"body":"[~davidlao] We have the below setting in the initLimit. \n\n```\n# synchronization phase can take\ninitLimit=10\n```","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gvenka008c","name":"gvenka008c","key":"gvenka008c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Govindaraj","active":true,"timeZone":"Etc/UTC"},"created":"2016-04-26T22:34:50.699+0000","updated":"2016-04-26T22:34:50.699+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15271543","id":"15271543","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"If increasing the initLimit value fixes it, then it is probably the case that you have large snapshots. Could you check the size of your snapshot files?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-05-04T22:22:56.877+0000","updated":"2016-05-04T22:22:56.877+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15395310","id":"15395310","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d.freudenberger","name":"d.freudenberger","key":"d.freudenberger","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Freudenberger","active":true,"timeZone":"Etc/UTC"},"body":"We just ran into exactly the same issue. 3 nodes cluster, suddenly the cluster went down and all nodes reporting \"ZooKeeper is not running\".\n\nIs there something I can do to make someone look into this? \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d.freudenberger","name":"d.freudenberger","key":"d.freudenberger","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Freudenberger","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-27T09:34:37.729+0000","updated":"2016-07-27T09:34:37.729+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15395321","id":"15395321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"[~d.freudenberger] please check the comments in this jira if you haven't done it yet.\n\nThe \"ZooKeeper is not running\" messages are due to the server(s) being in leader election. If they can't elect a leader and make progress, then we need to determine why that's the case. To my knowledge, there is nothing to be fixed here unless you provide further evidence of a bug.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-07-27T09:42:15.775+0000","updated":"2016-07-27T09:42:15.775+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15395335","id":"15395335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d.freudenberger","name":"d.freudenberger","key":"d.freudenberger","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Freudenberger","active":true,"timeZone":"Etc/UTC"},"body":"[~fpj] of course I read through the comments. Zookeeper recovered after ~15 minutes. 20 minutes later (right now) it crashed again and flooding the log file with following errors:\n\n{quote}\n2016-07-27 11:49:39,829 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.41.199.233:60522 (no session established for client)\n2016-07-27 11:49:39,864 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.41.199.201:60524\n2016-07-27 11:49:39,865 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2016-07-27 11:49:39,865 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.41.199.201:60524 (no session established for client)\n2016-07-27 11:49:40,095 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.41.199.217:37339\n2016-07-27 11:49:40,096 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2016-07-27 11:49:40,098 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.41.199.217:37339 (no session established for client)\n2016-07-27 11:49:40,245 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.41.199.63:33360\n2016-07-27 11:49:40,245 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2016-07-27 11:49:40,245 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.41.199.63:33360 (no session established for client)\n2016-07-27 11:49:40,317 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@197] - Accepted socket connection from /10.41.199.111:34965\n2016-07-27 11:49:40,320 [myid:2] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@354] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2016-07-27 11:49:40,320 [myid:2] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1001] - Closed socket connection for client /10.41.199.111:34965 (no session established for client)\n2016-07-27 11:49:40,346 [myid:2] - WARN  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:Follower@89] - Exception when following the leader\njava.net.SocketTimeoutException: Read timed out\n\tat java.net.SocketInputStream.socketRead0(Native Method)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:152)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:122)\n\tat java.io.BufferedInputStream.fill(BufferedInputStream.java:235)\n\tat java.io.BufferedInputStream.read(BufferedInputStream.java:254)\n\tat java.io.DataInputStream.readInt(DataInputStream.java:387)\n\tat org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\tat org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)\n\tat org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n\tat org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)\n\tat org.apache.zookeeper.server.quorum.Learner.registerWithLeader(Learner.java:272)\n\tat org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:72)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)\n2016-07-27 11:49:40,347 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:Follower@166] - shutdown called\njava.lang.Exception: shutdown Follower\n\tat org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)\n2016-07-27 11:49:40,347 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:FollowerZooKeeperServer@139] - Shutting down\n2016-07-27 11:49:40,347 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:ZooKeeperServer@419] - shutting down\n2016-07-27 11:49:40,348 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:QuorumPeer@670] - LOOKING\n2016-07-27 11:49:40,352 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:FileSnap@83] - Reading snapshot /var/lib/zookeeper/version-2/snapshot.3300799266\n{quote}\n\nThe size of the snapshot (/var/lib/zookeeper/version-2/snapshot.3300799266) is 147 mb. Not sure if this is considered \"large\" for zookeeper. initLimit is set to 10, tickTime is 2000.\n\nWhat else can I provide?\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d.freudenberger","name":"d.freudenberger","key":"d.freudenberger","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Freudenberger","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-27T09:51:43.048+0000","updated":"2016-07-27T09:53:08.526+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15395346","id":"15395346","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"[~d.freudenberger] right, 147mb isn't large. But, this indicates that the follower has timed out waiting on the leader to sync up:\n\n{noformat}\n2016-07-27 11:49:40,346 [myid:2] - WARN [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:Follower@89] - Exception when following the leader\njava.net.SocketTimeoutException: Read timed out\n{noformat}\n\nYou may want to have a look at the prospective leader logs to see if you spot anything odd. If the log files aren't too large, then you may consider posting them here.\n\nAlso, is the snapshot you checked the latest one? do all snapshots have roughly that size? About devices, are you using a single device or a dedicated device to the txn log. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-07-27T09:59:10.889+0000","updated":"2016-07-27T09:59:10.889+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15395387","id":"15395387","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d.freudenberger","name":"d.freudenberger","key":"d.freudenberger","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Freudenberger","active":true,"timeZone":"Etc/UTC"},"body":"[~fpj] the referenced snapshot is the latest one and all snapshots have around the same size. The log files look pretty much all the same to me. But maybe your eyes will catch sth. that looked good to me. You can download the log files for all nodes if you like (https://s3-eu-west-1.amazonaws.com/files.rebuy-cdn.de/logs.tgz). The transaction log is written to the same device. This is sth. we can't really change in our current setup.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d.freudenberger","name":"d.freudenberger","key":"d.freudenberger","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Freudenberger","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-27T10:25:49.751+0000","updated":"2016-07-27T10:25:49.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15396130","id":"15396130","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Is it possible this is a clock drift problem? The logs you've provided end at 12:13:35 for node1, 12:18:31 for node 2, and 12:14:11 for node3. I can't remember if this degree of clock drift causes issues or not, [~fpj] do you recall?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-27T18:39:31.814+0000","updated":"2016-07-27T18:39:31.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15396137","id":"15396137","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"[~fournc] good point, I have seen clock drift causing problems like that, essentially causing the socket to timeout on the read.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2016-07-27T18:45:32.626+0000","updated":"2016-07-27T18:45:32.626+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15396172","id":"15396172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"It's hard to tell if this is just that the logs were grabbed at different times or if it is clock drift but I would check for clock drift.\nI'm also seeing this error though:\n2016-07-27 11:47:05,709 [myid:2] - WARN  [SyncThread:2:FileTxnLog@321] - fsync-ing the write ahead \nlog in SyncThread:2 took 1111ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide\n\nIt's also taking over 10 seconds to read the snapshot on startup, which is not a good sign. Flavio's advice to increase the initLimit is probably good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-27T19:05:38.511+0000","updated":"2016-07-27T19:05:38.511+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15396234","id":"15396234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"body":"Yeah, your init limit needs to be longer. They're not getting into quorum because it takes longer than 20s to sync. Dunno why the original node crashed but if you increase initLimit that should solve this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fournc","name":"fournc","key":"fournc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Camille Fournier","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-27T19:50:56.042+0000","updated":"2016-07-27T19:50:56.042+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12766603/comment/15737108","id":"15737108","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haitao.yao","name":"haitao.yao","key":"haitao.yao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=haitao.yao&avatarId=18948","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=haitao.yao&avatarId=18948","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=haitao.yao&avatarId=18948","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=haitao.yao&avatarId=18948"},"displayName":"Haitao Yao","active":true,"timeZone":"Etc/UTC"},"body":"I encountered the same problem.  Is any fead back about whether increase the init limit values will work? thanks.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haitao.yao","name":"haitao.yao","key":"haitao.yao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=haitao.yao&avatarId=18948","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=haitao.yao&avatarId=18948","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=haitao.yao&avatarId=18948","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=haitao.yao&avatarId=18948"},"displayName":"Haitao Yao","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-10T03:23:14.640+0000","updated":"2016-12-10T03:23:14.640+0000"}],"maxResults":22,"total":22,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2104/votes","votes":4,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i247xb:"}}