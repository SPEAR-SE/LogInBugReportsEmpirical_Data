{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12600203","self":"https://issues.apache.org/jira/rest/api/2/issue/12600203","key":"ZOOKEEPER-1520","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326518","id":"12326518","name":"3.6.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12343268","id":"12343268","description":"Beta release against 3.5 branch","name":"3.5.5","archived":false,"released":false}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-07-25T20:37:45.771+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Apr 01 02:56:47 UTC 2014","customfield_12310420":"239662","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1520/watchers","watchCount":4,"isWatching":false},"created":"2012-07-25T18:42:28.376+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":["newbie","patch"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":86400,"aggregatetimeoriginalestimate":86400,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319081","id":"12319081","description":"Fix release against 3.3 branch","name":"3.3.5","archived":false,"released":true,"releaseDate":"2012-03-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-05-10T20:09:18.102+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312382","id":"12312382","name":"server","description":"General issues with the ZooKeeper server."}],"timeoriginalestimate":86400,"description":"In Util.readTxnBytes() the sentinel is compared with 0x42 and if it does not match then the record is considered partially written and thus the EOF. However if it is a partial record the sentinel should be 0x00 since that is what the log is initialized with. Any other value would indicate corruption and should throw an IOException rather than indicate EOF. See [ZOOKEEPER-1453|https://issues.apache.org/jira/browse/ZOOKEEPER-1453] for a related issue. ","customfield_10010":null,"timetracking":{"originalEstimate":"24h","remainingEstimate":"24h","originalEstimateSeconds":86400,"remainingEstimateSeconds":86400},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12539728","id":"12539728","filename":"ant.out","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-07T22:37:41.841+0000","size":24585,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12539728/ant.out"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12539727","id":"12539727","filename":"checkout.out","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-07T22:37:41.834+0000","size":87320,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12539727/checkout.out"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12539726","id":"12539726","filename":"init.out","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-07T22:36:47.612+0000","size":359,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12539726/init.out"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12539722","id":"12539722","filename":"init.out","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-07T22:05:52.314+0000","size":359,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12539722/init.out"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12542370","id":"12542370","filename":"ZOOKEEPER-1520.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-24T23:46:47.636+0000","size":11182,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12542370/ZOOKEEPER-1520.patch"}],"aggregatetimeestimate":86400,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"2495","customfield_12312823":null,"summary":"A txn log record with a corrupt sentinel byte looks like EOF","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":86400,"percent":0},"customfield_12311024":null,"environment":"all","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":86400,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13422497","id":"13422497","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"This is a simple localized fix with a low probability of causing any problems. I want to do this to learn the process for making ZooKeeper contributions.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-25T18:47:23.108+0000","updated":"2012-07-25T18:47:23.108+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13422590","id":"13422590","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Did you mean to upload a patch, Bill? Your proposal sounds reasonable to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-07-25T20:37:45.771+0000","updated":"2012-07-25T20:37:45.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13423382","id":"13423382","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"I intend to upload a patch as soon as I can build from an svn checkout, edit in eclipse, run the tests, and create a patch. This is an extremely complex process, and is not documented anywhere that I can find. Fortunately I have a friend that is an old hand at Java development. He is helping me find all the parts that are not in the trunk (e.g. eclipse, svn, ant, ivy, slf4j, log4j, ???), configuring eclipse to successfully compile, and getting the tests to run. At last report the tests were all failing due to some missing or misplaced component or parameter. I suspect our wandering in the dark is going to produce a different development environment than anyone else has. This will likely lead to future problems. \n\nDid I just not find the detailed description of how to take an empty machine that boots some freshly installed OS and turn it into a ZooKeeper development environment? It should start with which JDK to use (I chose jdk1.6.0), and where to download it. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-26T19:39:59.536+0000","updated":"2012-07-26T19:39:59.536+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13426199","id":"13426199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"body":"\"ant test\" is usually how we do it.\n\nAlso \"ant eclipse\" and then open the project in eclipse itself.\n\nNo need to download jars and such (slf/log/etc..) those will be d/l automatically by ant.\n\n\nIf the \"how to contribute\" page is not sufficient please let us know: https://cwiki.apache.org/confluence/display/ZOOKEEPER/HowToContribute","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phunt","name":"phunt","key":"phunt","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Hunt","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-31T22:57:00.721+0000","updated":"2012-07-31T22:57:00.721+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13430693","id":"13430693","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"I have been unable to checkout the trunk and successfully run the tests. I am using a Solaris 10 SPARC machine, and I expect that is part of my problem.\n\nI eventually get the following error after \"ant test\" runs for 35 minutes:\n{quote}\n/zookeeper/zookeeper-trunk/build.xml:1240: Execute failed: java.io.IOException: Cannot run program \"autoreconf\" (in directory \"/zookeeper/zookeeper-trunk/src/c\"): error=2, No such file or directory\n{quote}\nHere are the commands I enter:\n{quote}\nbash-3.00$ rm -rf zookeeper-trunk/bash-3.00$  svn checkout http://svn.apache.org/repos/asf/zookeeper/trunk/ zookeeper-trunk &>checkout.out\nbash-3.00$ cd zookeeper-trunk/\nbash-3.00$ ant init &>../init.out\nbash-3.00$ ant test &>../ant.out\n{quote}\nI will attach the output files.\n\nThe autoreconf file is really missing. It seems to be related to compiling C code to run natively, which is why I expect it is a SPARC problem.\n\nAm I doing something wrong or is development on SPARC Solaris really broken?\n\nI am very much a newbie to large scale Java development such as ZooKeeper. The instructions on the how to contribute page were not sufficient for me. I had previously  downloaded zookeeper-3.3.5 and got it running under eclipse on windows. I found out the hard way that the procedure for a checked out version is quite different.\n\nIt would be nice to list the tools that should be installed such as ivy, eclipse, ant, ... and where they can be found for download. It is particularly important to specify which version of the JDK should be used since using a 1.7 feature in ZooKeeper would be bad if users are running a 1.6 JRE. I still do not know which JDK is appropriate.\n\nA bit more explaination about how the build file works, and what it is capable of would be helpful. I have never used ant before so it took awhile to understand build.xml. A list of the high level targets, their intended use, and what they do would have told me that I did not need to find libraries like log4j online. I had never heard of ivy. Understanding why I should do something is better than just being told what to type.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-07T22:35:45.730+0000","updated":"2012-08-07T22:35:45.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13438808","id":"13438808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"I have attached a patch to throw an error if the sentinel byte is corrupt.Please review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-21T15:47:42.132+0000","updated":"2012-08-21T15:47:42.132+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13438825","id":"13438825","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"Throws an error if the sentinel byte on a transaction record is corrupt.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-21T16:09:42.561+0000","updated":"2012-08-21T16:09:42.561+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13438843","id":"13438843","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12541774/ZOOKEEPER-1520.patch\n  against trunk revision 1373156.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1165//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1165//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1165//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-21T16:45:52.602+0000","updated":"2012-08-21T16:45:52.602+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13441620","id":"13441620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"I moved to linux since I was unable to get the tests working on SPARC Solaris (See above comments). However that too did not really work. I am using a virtual machine that is assigned to me for Oracle development so the timing may be different than a physical machine.I ran \"ant test\" many times before making any changes and got many different errors on the tests. They all seem timing related. After creating my patch and testing it I get the same tests failing at about the same rate. For example I got the following errors when I ran the test suite 21 times:\n\n\"server.quorum.Zab1_0Test FAILED\"    16 times\n\"server.ZxidRolloverTest FAILED\"      1 time\n\"test.AsyncHammerTest FAILED\"         3 times\n\"test.FLETest FAILED\"                 1 time\n\"test.NioNettySuiteHammerTest FAILED\" 3 times \"(timeout)\" on 2 of them\n\"test.QuorumTest FAILED\"              1 time\n\"test.WatcherTest FAILED\"            10 times\n\nThere was one of the 21 runs where none of the test failed but the build failed due to a missing script in my checked out source tree (/scratch/zookeeper/Workspace/zookeeper-trunk/). The test output for this run ended with:\n\ncreate-cppunit-configure:\n     [exec] checking for doxygen... /usr/bin/doxygen\n     [exec] checking for perl... /usr/bin/perl\n     [exec] checking for dot... no\n     [exec] configure: error: cannot find install-sh or install.sh in /scratch/zookeeper/Workspace/zookeeper-trunk/src/c /scratch/zookeeper/Workspace/zookeeper-trunk/src/c/.. /scratch/zookeeper/Workspace/zookeeper-trunk/src/c/../..\n\nBUILD FAILED ...\n\nThis looks like it has something to do with C code, which I did not touch, so I do not think this has anything to do with my patch.\n\nIs there something that can be done so I can reliably run the tests?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-24T23:45:35.780+0000","updated":"2012-08-24T23:45:35.780+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13441626","id":"13441626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"Patch did not include test","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-24T23:48:05.134+0000","updated":"2012-08-24T23:48:05.134+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13441630","id":"13441630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"body":"This treats a sentinel byte of zero as EOF, and throws an IOException if the sentinel byte is otherwise not 0x42. CRCTest was upgraded to test for all 4 types of corruption that the code looks for, including a corrupt sentinel byte.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbridge","name":"bbridge","key":"bbridge","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bill Bridge","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-24T23:52:46.619+0000","updated":"2012-08-24T23:52:46.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13441666","id":"13441666","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12542370/ZOOKEEPER-1520.patch\n  against trunk revision 1373156.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1170//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1170//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1170//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-25T00:20:11.506+0000","updated":"2012-08-25T00:20:11.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13475902","id":"13475902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"The patch looks good to me, thanks, Bill. I have a question about how to recover from such errors. With this patch, if there is a corrupt record, then we throw an exception, which I believe would prevent a server from starting. Does it mean that if we get a corrupt record on a given node, we won't be able to recover the data on the disk of that node?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-14T21:08:05.843+0000","updated":"2012-10-14T21:08:05.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13476020","id":"13476020","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Also, the sentinel being zero does not necessarily mean that there has been no corruption. I understand that it is a pretty good guess, though, because of the zeroing during preallocation. If it happens that there has been a corruption and we simply considered it as a partial record. Is it acceptable to have such a low probability corner case? I'm just pointing this out because the behavior wouldn't be consistent if we hit this case.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-15T08:24:46.252+0000","updated":"2012-10-15T08:24:46.252+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13956042","id":"13956042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"The patch doesn't apply anymore.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-01T02:51:14.099+0000","updated":"2014-04-01T02:51:14.099+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600203/comment/13956044","id":"13956044","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry for jumping in this late, but to answer Flavio's question:\n\n{quote}\nAlso, the sentinel being zero does not necessarily mean that there has been no corruption. I understand that it is a pretty good guess, though, because of the zeroing during preallocation. If it happens that there has been a corruption and we simply considered it as a partial record. Is it acceptable to have such a low probability corner case? I'm just pointing this out because the behavior wouldn't be consistent if we hit this case.\n{quote}\n\nI think we can check if the record is corrupted by validating the checksum, using 0x42 as the last byte instead of 0x0. By the way, it's kind of strange that readTxnBytes() doesn't validate the checksum at all.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-01T02:56:47.052+0000","updated":"2014-04-01T02:56:47.052+0000"}],"maxResults":16,"total":16,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1520/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i00s5z:"}}