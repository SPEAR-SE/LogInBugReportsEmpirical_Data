{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12697838","self":"https://issues.apache.org/jira/rest/api/2/issue/12697838","key":"ZOOKEEPER-1890","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2014-02-28T01:21:58.947+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Feb 14 05:13:45 UTC 2015","customfield_12310420":"376312","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1890/watchers","watchCount":4,"isWatching":false},"created":"2014-02-28T01:21:05.758+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-02-14T05:13:45.299+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"When calling rollLog, FileTxnLog flushes but does not close its FileOutputStream, leaking a file descriptor.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12631642","id":"12631642","filename":"zookeeper-1890.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gaul","name":"gaul","key":"gaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gaul&avatarId=32811","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gaul&avatarId=32811","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gaul&avatarId=32811","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gaul&avatarId=32811"},"displayName":"Andrew Gaul","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-28T01:22:29.739+0000","size":879,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12631642/zookeeper-1890.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"376608","customfield_12312823":null,"summary":"unclosed FileOutputStream in FileTxnLog.rollLog","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gaul","name":"gaul","key":"gaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gaul&avatarId=32811","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gaul&avatarId=32811","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gaul&avatarId=32811","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gaul&avatarId=32811"},"displayName":"Andrew Gaul","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gaul","name":"gaul","key":"gaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gaul&avatarId=32811","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gaul&avatarId=32811","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gaul&avatarId=32811","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gaul&avatarId=32811"},"displayName":"Andrew Gaul","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12697838/comment/13915326","id":"13915326","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"GitHub user andrewgaul opened a pull request:\n\n    https://github.com/apache/zookeeper/pull/10\n\n    ZOOKEEPER-1890: Close FileOutputStream in FileTxnLog\n\n    \n\nYou can merge this pull request into a Git repository by running:\n\n    $ git pull https://github.com/maginatics/zookeeper close-stream-filetxnlog\n\nAlternatively you can review and apply these changes as the patch at:\n\n    https://github.com/apache/zookeeper/pull/10.patch\n\nTo close this pull request, make a commit to your master/trunk branch\nwith (at least) the following in the commit message:\n\n    This closes #10\n    \n----\ncommit 37b41819a8956f191f08d0414d05b0f78f83bde2\nAuthor: Andrew Gaul <gaul@maginatics.com>\nDate:   2014-02-28T01:16:08Z\n\n    ZOOKEEPER-1890: Close FileOutputStream in FileTxnLog\n\n----\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2014-02-28T01:21:58.947+0000","updated":"2014-02-28T01:21:58.947+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12697838/comment/13915328","id":"13915328","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gaul","name":"gaul","key":"gaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gaul&avatarId=32811","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gaul&avatarId=32811","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gaul&avatarId=32811","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gaul&avatarId=32811"},"displayName":"Andrew Gaul","active":true,"timeZone":"America/Los_Angeles"},"body":"Attached patch, also available as a pull request:\n\nhttps://github.com/apache/zookeeper/pull/10","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gaul","name":"gaul","key":"gaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=gaul&avatarId=32811","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=gaul&avatarId=32811","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=gaul&avatarId=32811","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=gaul&avatarId=32811"},"displayName":"Andrew Gaul","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-28T01:22:29.744+0000","updated":"2014-02-28T01:22:29.744+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12697838/comment/13931183","id":"13931183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dutch","name":"dutch","key":"dutch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dutch T. Meyer","active":true,"timeZone":"Etc/UTC"},"body":"I appreciate this patch, but I see a problem.\n\nIn SyncRequestProcessor.java::run()\nAfter zks.getZKDatabase().rollLog(), the request being processed will be added to the toFlush list at the bottom of the loop.\nAt the top of the loop, toFlush will then be non-empty.  So we go into the else block, where queuedRequests.poll() can return null if there are no more waiting requests.  In that case we will try to flush.  However, because we closed the fos associated with the request the flush can fail with a ClosedChannelException.\n\nCan we just catch and ignore the ClosedChannelException?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dutch","name":"dutch","key":"dutch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dutch T. Meyer","active":true,"timeZone":"Etc/UTC"},"created":"2014-03-12T00:03:57.253+0000","updated":"2014-03-12T00:03:57.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12697838/comment/14321245","id":"14321245","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"body":"Github user andrewgaul closed the pull request at:\n\n    https://github.com/apache/zookeeper/pull/10\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"created":"2015-02-14T05:13:45.299+0000","updated":"2015-02-14T05:13:45.299+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1890/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1sugn:"}}