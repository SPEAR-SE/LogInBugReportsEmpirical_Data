{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13204348","self":"https://issues.apache.org/jira/rest/api/2/issue/13204348","key":"ZOOKEEPER-3215","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":3600,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[],"aggregatetimespent":3600,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-12-19T02:20:02.681+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 19 02:20:02 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-3215/watchers","watchCount":2,"isWatching":false},"created":"2018-12-13T20:54:33.125+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":["pull-request-available"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":0,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12342973","id":"12342973","description":"Fix release against 3.4 branch","name":"3.4.13","archived":false,"released":true,"releaseDate":"2018-07-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2019-01-10T05:43:20.337+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Java 9 introduces covariant return types which allows one to have different return types if return type in the overridden method is a sub type. Since Java 9, few functions return ByteBuffer, whereas the parent method return Buffer, resulting in causing issues for Java 8 and below since for them the method does not exist.\r\n\r\nSteps To Reproduce:\r\n1. Setup ZooKeeper Server with JDK11.\r\n2. Setup ZooKeeper Client with JDK8.\r\n3. Try connecting the client and server.\r\n\r\nResults:\r\nCast ByteBuffer instances to Buffer before calling the method.\r\n\r\n \r\n\r\nNotes:\r\nThere was a similar bug in the MongoDB community - [https://jira.mongodb.org/browse/JAVA-2559]\r\n\r\n \r\n\r\nThis is not a contribution.","customfield_10010":null,"timetracking":{"remainingEstimate":"0h","timeSpent":"1h","remainingEstimateSeconds":0,"timeSpentSeconds":3600},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":0,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Handle Java 9/11 additions of covariant return types to java.nio.ByteBuffer methods","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=softwareengg","name":"softwareengg","key":"softwareengg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=softwareengg","name":"softwareengg","key":"softwareengg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":3600,"total":3600,"percent":100},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":3600,"total":3600,"percent":100},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/comment/16724625","id":"16724625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maoling","name":"maoling","key":"maoling","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maoling&avatarId=32024","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maoling&avatarId=32024","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maoling&avatarId=32024","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maoling&avatarId=32024"},"displayName":"maoling","active":true,"timeZone":"Etc/UTC"},"body":"look at the patch:https://github.com/mongodb/mongo-java-driver/commit/21c91bd364d38489e0bbe2e390efdb3746ee3fff\r\njust cast ByteBuffer to Buffer. Java 9 hasn't the good downward compatibility.\r\nThanks for telling us how to reproduce this issue.\r\n[~softwareengg]\r\nCould you give us a patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maoling","name":"maoling","key":"maoling","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maoling&avatarId=32024","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maoling&avatarId=32024","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maoling&avatarId=32024","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maoling&avatarId=32024"},"displayName":"maoling","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-19T02:20:02.681+0000","updated":"2018-12-19T02:20:02.681+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-3215/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":6,"worklogs":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/worklog/182654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"vivekpatani commented on pull request #760: ZOOKEEPER-3215: Handle Java 9/11 additions of covariant return types …\nURL: https://github.com/apache/zookeeper/pull/760\n \n \n   …to java.nio.ByteBuffer methods\r\n   \r\n   Co-authored-by: Brandon Miles <brandon_miles@apple.com>\r\n   \r\n   Java 9 introduces covariant return types which allows one to have different return types if return type in the overridden method is a sub type. Since Java 9, few functions return ByteBuffer, whereas the parent method return Buffer, resulting in causing issues for Java 8 and below since for them the method does not exist.\r\n   \r\n   To fix this, we must cast the ByteBuffer instances to Buffer before we call the method. The methods that need this are:\r\n   \r\n   - position(int newPosition)\r\n   - limit(int newLimit)\r\n   - flip()\r\n   - clear()\r\n   - mark()\r\n   - reset()\r\n   - rewind()\r\n   \r\n   Signed-off-by: Vivek Patani <softwareengg@pm.me>\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n","created":"2019-01-08T20:11:04.067+0000","updated":"2019-01-08T20:11:04.067+0000","started":"2019-01-08T20:11:04.067+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"182654","issueId":"13204348"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/worklog/183094","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"anmolnar commented on issue #760: ZOOKEEPER-3215: Handle Java 9/11 additions of covariant return types …\nURL: https://github.com/apache/zookeeper/pull/760#issuecomment-452734142\n \n \n   @vivekpatani Since Java 1.9 there's a `--release` switch for the javac compiler which sets the \"source\", \"target\" and \"bootclasspath\" properties in order to properly cross-compile.\r\n   \r\n   Wouldn't it be better to use that for cross-compile ZooKeeper instead of code change?\r\n   I tested it on branch-3.4 and it works fine.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n","created":"2019-01-09T15:21:24.363+0000","updated":"2019-01-09T15:21:24.363+0000","started":"2019-01-09T15:21:24.363+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"183094","issueId":"13204348"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/worklog/183095","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"anmolnar commented on issue #760: ZOOKEEPER-3215: Handle Java 9/11 additions of covariant return types …\nURL: https://github.com/apache/zookeeper/pull/760#issuecomment-452734142\n \n \n   @vivekpatani Since Java 9 there's a `--release` switch for the javac compiler which sets the \"source\", \"target\" and \"bootclasspath\" properties in order to properly cross-compile.\r\n   \r\n   Wouldn't it be better to use that for cross-compile ZooKeeper instead of code change?\r\n   I tested it on branch-3.4 and it works fine.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n","created":"2019-01-09T15:21:40.664+0000","updated":"2019-01-09T15:21:40.664+0000","started":"2019-01-09T15:21:40.664+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"183095","issueId":"13204348"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/worklog/183097","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"anmolnar commented on issue #760: ZOOKEEPER-3215: Handle Java 9/11 additions of covariant return types …\nURL: https://github.com/apache/zookeeper/pull/760#issuecomment-452735551\n \n \n   https://openjdk.java.net/jeps/247\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n","created":"2019-01-09T15:25:19.005+0000","updated":"2019-01-09T15:25:19.005+0000","started":"2019-01-09T15:25:19.005+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"183097","issueId":"13204348"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/worklog/183477","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"vivekpatani commented on issue #760: ZOOKEEPER-3215: Handle Java 9/11 additions of covariant return types …\nURL: https://github.com/apache/zookeeper/pull/760#issuecomment-452933177\n \n \n   @anmolnar it builds just fine, passes tests, it's more about return types discrepancy post JDK9. Were you able to spin up a server/client and talk to each other? I'll give it a try as well.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n","created":"2019-01-10T01:14:26.002+0000","updated":"2019-01-10T01:14:26.002+0000","started":"2019-01-10T01:14:26.002+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"183477","issueId":"13204348"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13204348/worklog/183526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=githubbot","name":"githubbot","key":"githubbot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF GitHub Bot","active":true,"timeZone":"Etc/UTC"},"comment":"anmolnar commented on issue #760: ZOOKEEPER-3215: Handle Java 9/11 additions of covariant return types …\nURL: https://github.com/apache/zookeeper/pull/760#issuecomment-452977671\n \n \n   @vivekpatani I tested it (cross-building with `--release 8` flag) on all major branches:\r\n   - branch-3.4 works fine: compiling with Java 11, running on Java 8, client connected, able to execute commands,\r\n   - branch-3.5 and master: code doesn't compile due to unavailability of `com.sun.nio.file.SensitivityWatchEventModifier` imported in `FileChangeWatcher.java`, but that's seems like a problem that we should deal with anyway.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n","created":"2019-01-10T05:43:20.332+0000","updated":"2019-01-10T05:43:20.332+0000","started":"2019-01-10T05:43:20.331+0000","timeSpent":"10m","timeSpentSeconds":600,"id":"183526","issueId":"13204348"}]},"customfield_12311820":"0|s01i6w:"}}