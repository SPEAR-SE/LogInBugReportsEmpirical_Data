{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12684352","self":"https://issues.apache.org/jira/rest/api/2/issue/12684352","key":"ZOOKEEPER-1835","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310801","id":"12310801","key":"ZOOKEEPER","name":"ZooKeeper","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10484","id":"10484","description":"Apache ZooKeeper related","name":"ZooKeeper"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316644","id":"12316644","description":"Dynamic Reconfig, Remove Watches, Local Session","name":"3.5.0","archived":false,"released":true,"releaseDate":"2014-08-04"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-12-15T09:15:05.004+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jul 04 11:11:39 UTC 2014","customfield_12310420":"363424","customfield_12312320":null,"customfield_12310222":"10002_*:*_2_*:*_10076259003_*|*_1_*:*_2_*:*_7482157446_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-07-04T02:25:43.966+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1835/watchers","watchCount":6,"isWatching":false},"created":"2013-12-12T21:05:27.598+0000","customfield_12310192":"Patch described in this comment below:\nhttps://issues.apache.org/jira/browse/ZOOKEEPER-1835?focusedCommentId=13848420&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13848420","customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316644","id":"12316644","description":"Dynamic Reconfig, Remove Watches, Local Session","name":"3.5.0","archived":false,"released":true,"releaseDate":"2014-08-04"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-07-04T11:11:39.220+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312379","id":"12312379","name":"quorum","description":"Quorum determination for ZooKeeper"}],"timeoriginalestimate":null,"description":"On Windows, reconfig fails to rename the tmp dynamic config file to the real dynamic config filename.\nJavadoc of java.io.File.renameTo says the behavior is highly plateform dependent, so I guess this should not be a big surprise.\nThe problem occurs in src/java/main/org/apache/zookeeper/server/quorum/QuorumPeerConfig.java that could be modified like this:\n+ curFile.delete();\nif (!tmpFile.renameTo(curFile)) {\n+ configFile.delete();\nif (!tmpFile.renameTo(configFile)) {\nAs suggested by Alex in https://issues.apache.org/jira/browse/ZOOKEEPER-1691 (btw there is more information about my test scenario over there) it is a bit \"scary\" to delete the current configuration file.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12650866","id":"12650866","filename":"ZOOKEEPER-1835.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-17T20:00:54.932+0000","size":29204,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12650866/ZOOKEEPER-1835.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12650491","id":"12650491","filename":"ZOOKEEPER-1835.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-15T19:43:31.575+0000","size":29204,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12650491/ZOOKEEPER-1835.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12626481","id":"12626481","filename":"ZOOKEEPER-1835.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-02-01T14:00:24.269+0000","size":26653,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12626481/ZOOKEEPER-1835.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12620103","id":"12620103","filename":"ZOOKEEPER-1835.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-22T20:13:59.210+0000","size":26653,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12620103/ZOOKEEPER-1835.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12619178","id":"12619178","filename":"ZOOKEEPER-1835.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-17T22:13:24.715+0000","size":26028,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12619178/ZOOKEEPER-1835.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12618808","id":"12618808","filename":"ZOOKEEPER-1835.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-15T08:35:09.227+0000","size":19301,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12618808/ZOOKEEPER-1835.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"363730","customfield_12312823":null,"summary":"dynamic configuration file renaming fails on Windows","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Windows 7 64-bit, Oracle Java  1.6.0_32-b05","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13848420","id":"13848420","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"I've discovered the existing org.apache.zookeeper.common.AtomicFileOutputStream class that precisely does this job (writing a temp file, then rename it, if failure on windows then delete and rename, delete the temp file...).\nThere is a kind of idiomatic usage described in org.apache.zookeeper.server.quorum.QuorumPeer.writeLongToFile(...), so I've created a org.apache.zookeeper.common.AtomicFileWritingIdiom class (using AtomicFileOutputStream) in order not to miss anything from the idiom, and used it org.apache.zookeeper.server.quorum.QuorumPeerConfig.\nYou will find attached a patch containing this new AtomicFileWritingIdiom class, a unit test for it, and the existing modified QuorumPeerConfig class.\nI've run the ZK junit test suite that did not show any induced problem.\nI've also tested the ZOOKEEPER-1691 patch in addition to this one, and I got my dynamic reconfig scenario working like described in https://issues.apache.org/jira/browse/ZOOKEEPER-1691\nAnd I finally tested the configBackwardCompatibilityMode scenario where the dynamic config file gets created and the zoo.cfg file rewritten. It works too.\nThere is a small bug in the current implementation of the configBackwardCompatibilityMode though: even if the clientPort= line is mentioned the the zoo.cfg file, the port is not appended at the end of the line of the dynamic config. Don't know if it \"deserves\" a bug though. \n\nBruno.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-14T18:21:09.214+0000","updated":"2013-12-14T18:21:09.214+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13848566","id":"13848566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12618808/ZOOKEEPER-1835.patch\n  against trunk revision 1550213.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 4 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1837//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1837//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1837//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-15T09:15:05.004+0000","updated":"2013-12-15T09:15:05.004+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13848829","id":"13848829","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the patch, it looks nice. I have few comments, please see. \n\n# It would be nice to use IOUtils.closeStream(out); instead of following in the patch\n{code}\nif (out != null)\n\tout.close();\n{code}\n# Apache license is missing in the files AtomicFileWritingIdiom.java, AtomicFileWritingIdiomTest.java\n# Please correct the code format. Please see http://wiki.apache.org/hadoop/ZooKeeper/HowToContribute section for more info.\nThere are  spaces in empty lines and also in java comments like \"//   and the caller will be notified (IOException)\"\n# I couldn't see the following constructor is used anywhere. Is it required?\n{code}\n    public AtomicFileWritingIdiom(File targetFile, WriterStatement wStmt, String encoding)  throws IOException {\n        this(targetFile, null, wStmt, encoding);\n    }\n{code}\n# This is a suggestion only. There are many null checks in the constructor logic like, if not null do the operation. I think, you have done this to reduce the code duplication. But I feel, this will create confusions in debugging or maintainability. Say, by mistake if the passed object is null, this will just skip the logic and return. Caller will be thinking the operation is successfully completed. IMHO, its ok to duplicate the constructor logics rather than null checks and skipping. Whats your opinion?\n\n-Rakesh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-12-16T05:26:01.468+0000","updated":"2013-12-16T05:26:01.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13848925","id":"13848925","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Rakesh,\n\nThank you for the review! \nMy answers:\n* 1, 2, 3: Sure! I will do it. \n* You are right, it is not required. I am just reluctant providing a Writer-based API without the possibility to provide an encoding. But I understand that dead code should be avoided. I will remove it.\n* You are right: there are null check because I didn't want to duplicate the idiom (I felt the complexity was more in the idiom - try catch abort finally close...- than in the initialization of the objets). That is why this constructor is private (it handles the null check, and the public constructors cannot accept null parameters, excepted the encoding parameter that I will remove). I you prefer code duplication (for maintenability reasons) I am fine with that as well. Just tell me! \nRegards,\nBruno.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-16T08:36:19.129+0000","updated":"2013-12-16T08:36:19.129+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13848935","id":"13848935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi Bruno,\n\nCan we refactor 'BufferedWriter bw = null' logic as follows:\n{code}\n          } else {\n                // prepare writer\n                BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(out));\n                //......\n                // execute writer operation\n                wStmt.write(bw);\n                bw.flush();\n{code}\n\nAlso, I just noticed the exception blocks in the patch. Both 'IOException' and 'RuntimeException' handles the exception in the same way, aborting and throw back exception to the caller. Instead of having multiple blocks, I think we can simplify this by catching 'Exception or Throwable' and handle it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-12-16T09:00:07.854+0000","updated":"2013-12-16T09:00:07.854+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13849114","id":"13849114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Ralesh,\n\nYes I will refactor the writer logic following your suggestion.\nHowever I am not fond of the global \"catch Exception\": since it is re-thrown, either this will modify the signature of all caller methods (throws Exception), or caller methods will have to catch the Exception and rethrow an IOException (or any other one) embedding the Exception (that was an IOException anyway). This is odd.\nEither the exception is checked and enforced by the compiler (here IOException), or it is unchecked and it will be a subclass of RuntimeException.\nThat's why, as catching a Throwable is never a good idea, we are sure that the double catch (IOException and RuntimeException) is necessary and sufficient. It induces a bit of code duplication, but it sanitizes the throws clause of the method. Would you agree if I left it like as is?\n\nBruno.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-16T12:42:02.082+0000","updated":"2013-12-16T12:42:02.082+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13850181","id":"13850181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"bq.However I am not fond of the global \"catch Exception\": since it is re-thrown, either this will modify the signature of all caller methods (throws Exception), or caller methods will have to catch the Exception and rethrow an IOException (or any other one) embedding the Exception (that was an IOException anyway). This is odd.\n\nyeah, it makes sense and separate exception block is ok.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-12-17T06:43:49.183+0000","updated":"2013-12-17T06:43:49.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13850989","id":"13850989","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Taking account latest remarks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-17T22:13:24.719+0000","updated":"2013-12-17T22:13:24.719+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13850998","id":"13850998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Rakesh,\n\nFirst of all, I apologize for mispelling your name in my last comment.\nPlease find attached the new patch including all your remarks (well, I hope so). The only one that puzzled me was the \"// and the caller will be notified (IOException)\", I didn't find anything special in it, except the extra spaces after the // that I removed.\nAs you will see I have modified the try/catch/finally in a way that should satisfy both of us: it does not duplicate code, it is simpler, and it now resists to any kind of throwable (RuntimeException, Exception, Error) like demonstrated into the new unit tests. I also modified the unit tests to test that the tmp file is removed in any case.\n\nI've tested the ZOOKEEPER-1691 patch in addition to this new one, and I still got my dynamic reconfig scenario working like described in https://issues.apache.org/jira/browse/ZOOKEEPER-1691\nAnd I finally tested the configBackwardCompatibilityMode scenario where the dynamic config file gets created and the zoo.cfg file rewritten. It still works too.\n\nI hope I have not forgotten anything!\n\nBruno.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-17T22:21:18.758+0000","updated":"2013-12-17T22:21:18.758+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13851047","id":"13851047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12619178/ZOOKEEPER-1835.patch\n  against trunk revision 1551624.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 4 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1845//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1845//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1845//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-17T22:54:07.913+0000","updated":"2013-12-17T22:54:07.913+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13855270","id":"13855270","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12620103/ZOOKEEPER-1835.patch\n  against trunk revision 1552946.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 4 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1858//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1858//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1858//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-22T20:54:45.558+0000","updated":"2013-12-22T20:54:45.558+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13855272","id":"13855272","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"I'm out of the office till Jan 5th (included), having limited access to my emails.\nIn case of urgency, please contact support@temis.com\nBest regards,\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-22T20:56:51.071+0000","updated":"2013-12-22T20:56:51.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13855296","id":"13855296","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"I don't know why my out of office reply got here as a comment, but if an admin could delete it (since it is containing an email), it would be great! Thanks in advance,\nBruno.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-22T22:00:56.967+0000","updated":"2013-12-22T22:00:56.967+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13855521","id":"13855521","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Before explaining the latest patch, let me summarize its content:\n- I created a new AtomicFileWritingIdiom...\n - reusing the existing AtomicFileOutputStream class,\n - inspired by the way the  writeLongToFile method of QuorumPeer is using it,\n- ... and used this new AtomicFileWritingIdiom class in the writeDynamicConfig method of QuorumPeerConfig\n\nIt took me some time to understand what was going wrong in QuorumPeerMainTest and ObserverHierarchicalQuorumTest unit tests with my second patch.\nDuring my investigations I discovered strange stack traces in the junit reports of the (unpatched) trunk, related to AtomicFileOutputStream :\n{code}\njava.nio.channels.ClosedByInterruptException\n        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:202)\n        at sun.nio.ch.FileChannelImpl.force(FileChannelImpl.java:380)\n        at org.apache.zookeeper.common.AtomicFileOutputStream.close(AtomicFileOutputStream.java:71)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.writeLongToFile(QuorumPeer.java:1499)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.setCurrentEpoch(QuorumPeer.java:1520)\n        at org.apache.zookeeper.server.quorum.Leader.lead(Leader.java:523)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:980)\n{code}\nThey occur in:\n{code}\nTEST-org.apache.zookeeper.server.quorum.Zab1_0Test.txt\nTEST-org.apache.zookeeper.test.ObserverHierarchicalQuorumTest.txt\nTEST-org.apache.zookeeper.test.ReadOnlyModeTest.txt\n{code}\nThere seems to be a problem with the \"force(true)\" call on the FileChannel. I don't know why to be honnest (maybe related to the threading model of zookeeper).\nIf I simply remove this line (on the unpatched trunk), ClosedByInterruptExceptions disappeared but I observed the same unit test regressions in QuorumPeerMainTest as with my second patch.\nHowever when I replaced:\n{code:java}\n((FileOutputStream) out).getChannel().force(true);\n{code}\nwith:\n{code:java}\n((FileOutputStream) out).getFD().sync();\n{code}\nthen there was no ClosedByInterruptException in the report, and no unit test regression.\nAnd if I apply my patch (the third one, including this modification), there is no unit test regression neither (latest Hadoop QA result).\n\nIt seems that both fc.force() and fd.sync() have the same effect of flushing data on the device:\nhttp://stackoverflow.com/questions/5650327/are-filechannel-force-and-filedescriptor-sync-both-needed\n\nI've tested the ZOOKEEPER-1691 patch in addition to this new one and the configBackwardCompatibilityMode scenario. Both are still working.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2013-12-23T09:35:15.428+0000","updated":"2013-12-23T09:35:15.428+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13888606","id":"13888606","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi,\n\nI've tested the patch against the latest sources of the trunk and it is still ok: dynamic reconfiguration is working on Windows.\nBy the way: I've run the unit tests on the unpatched trunk on Ubuntu 12.04 64-bit and there was still one ClosedByInterruptException (see above) in TEST-org.apache.zookeeper.test.ObserverHierarchicalQuorumTest.txt. \nWith the patch this exception does not occur.\nI would 100% understand if you decided that letting me modify the existing AtomicFileOutputStream class is not a good idea. If this is the case, please tell me and I'll submit a patch that does not touch this class.\nRegards","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-02-01T14:11:13.228+0000","updated":"2014-02-01T14:11:13.228+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13888613","id":"13888613","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12626481/ZOOKEEPER-1835.patch\n  against trunk revision 1561672.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 4 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1909//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1909//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1909//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-02-01T14:38:41.572+0000","updated":"2014-02-01T14:38:41.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13888714","id":"13888714","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Bruno! \n\nShould we use this new class for writing out epoch numbers instead of having a separate QuorumPeer.writeLongToFile ? \n[~phunt] can you please take a look ? (I see that you originally wrote that function for ZOOKEEPER-1427)\nalso re Bruno's question about modifying the existing AtomicFileOutputStream.\n\n> There is a small bug in the current implementation of the configBackwardCompatibilityMode though: even if the clientPort= line is \n> mentioned the the zoo.cfg file, the port is not appended at the end of the line of the dynamic config. Don't know if it \"deserves\" a \n> bug though.\n\nI'm not sure we want to do this automatically - the user still needs to specify the server specs according to the new format\nfor this and the other servers, in all of the config files. Appending just the client port for one of the server in each config file is not enough unless we fix the rest automatically too, which we don't do.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-01T20:09:47.477+0000","updated":"2014-02-01T20:09:47.477+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13888725","id":"13888725","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"body":"moreover, when the leader is established, if I remember correctly, the leader's config will be written in everyone's config files. So unless the leader also somehow knows the client port of this server, the port will disappear from the config file even if you initially append it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-02-01T20:28:55.616+0000","updated":"2014-02-01T20:28:55.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13888740","id":"13888740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"AtomicFileWritingIdiomTest passes for me on windows, but ReconfigTest fails. When you say:\n\nbq. I've tested the patch against the latest sources of the trunk and it is still ok: dynamic reconfiguration is working on Windows.\n\nDo you mean unit tests or tests you've written yourself, [~bfreuden]?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2014-02-01T21:16:16.320+0000","updated":"2014-02-01T21:16:16.320+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13889078","id":"13889078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Alexander,\n{quote}Should we use this new class for writing out epoch numbers instead of having a separate QuorumPeer.writeLongToFile ? {quote}\nThis is almost the same code (writeLongToFile is actually where I got the \"idiom\"), except this modification in the AtomicFileOutputStream. However I preferred leaving it as-is for the sake of \"not touching something that is working for aesthetics reasons\". But if you or Patrick Hunt feel ok about it, I can certainly do it. I am just puzzled by this difference between fc.force() and fd.sync().\nConcerning the backward compatibitity mode behavior, I entirely trust you since I don't know much about ZK (to say the least).\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-02-02T21:55:51.871+0000","updated":"2014-02-02T21:55:51.871+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13889092","id":"13889092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Flavio,\n{quote}AtomicFileWritingIdiomTest passes for me on windows, but ReconfigTest fails. When you say: [...] Do you mean unit tests or tests you've written yourself{quote}\nI mean a test scenario that I am playing manually on Windows (and that did not work without the patch). This manual test is described here: \nhttps://issues.apache.org/jira/browse/ZOOKEEPER-1691?focusedCommentId=13846779&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13846779\nConcerning the ReconfigTest unit test (trunk+patch), on Linux and Windows the result is:\nTests run: 9, Failures: 0, Errors: 0, Skipped: 0\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-02-02T22:38:43.119+0000","updated":"2014-02-02T22:38:43.119+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13959486","id":"13959486","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"Flavio/Bruno, could you guys find out if this patch is causing the test failure?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-04T00:45:05.489+0000","updated":"2014-04-04T00:45:05.489+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13959487","id":"13959487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"I'm out of the office till April 6th (included), having no access to my emails.\nIn case of urgency, please contact support@temis.com\nBest regards,\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-04T00:47:15.430+0000","updated":"2014-04-04T00:47:15.430+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13963834","id":"13963834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"I'll try asap (probably this week-end) to get the latest version of the trunk, run the test suite, apply the patch, run the test suite once again, and compare test results.\nI hope I'll reproduce the test failure Flavio is talking about.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-09T05:42:30.539+0000","updated":"2014-04-09T05:42:30.539+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13968790","id":"13968790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Ok, here are the results. \nThe short version: \n- on Linux, tests results are the same with and without the patch (so I can't reproduce Flavio's test failure), \n- on Windows, tests results are better with the patch (even though results are very strange : timeouts, 3 times longer to run on Windows than on Linux despite a far better CPU - maybe an effect of the SSD?).\n\nThe long version:\nTest plateforms:\n- Ubuntu 13.04 x64 / Oracle Java 1.7 x64 / Celeron G530 / SSD\n- Windows 7 x64 / Oracle Java 1.7 x64 / Core i7 860 / HDD\nTest suite runs in 45 minutes on Linux, and in 165 minutes on Windows.\n\nLinux trunk-only (failures and errors) and Linux trunk+patch are the same:\n    Running org.apache.zookeeper.server.quorum.StandaloneDisabledTest\n    Tests run: 2, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 107,875 sec\n    Running org.apache.zookeeper.test.StaticHostProviderTest\n    Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0 sec\n\nWindows trunk+patch (failures and errors):\n    Test org.apache.zookeeper.server.ZxidRolloverTest FAILED (timeout)\n    Test org.apache.zookeeper.server.quorum.ReconfigRecoveryTest FAILED\n    Test org.apache.zookeeper.test.FollowerResyncConcurrencyTest FAILED (timeout)\n    Test org.apache.zookeeper.test.LeaderSessionTrackerTest FAILED (timeout)\n    Test org.apache.zookeeper.test.QuorumTest FAILED (timeout)\n    Test org.apache.zookeeper.test.ReadOnlyModeTest FAILED (timeout)\n    Test org.apache.zookeeper.test.ReconfigTest FAILED (timeout)\n    Test org.apache.zookeeper.test.StaticHostProviderTest FAILED (timeout)\n\nWindows trunk-only (failures and errors) has the same than above, plus these:\n    Test org.apache.zookeeper.ZooKeeperTest FAILED\n    Test org.apache.zookeeper.ZooKeeperTestableTest FAILED\n    Test org.apache.zookeeper.server.CRCTest FAILED\n    Test org.apache.zookeeper.server.InvalidSnapCountTest FAILED\n    Test org.apache.zookeeper.server.util.DynamicConfigBCTest FAILED\n    Test org.apache.zookeeper.test.AsyncHammerTest FAILED (crashed)\n\nI'll try another run on Windows with the SSD to see if results are reproducible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-14T20:22:54.962+0000","updated":"2014-04-14T20:22:54.962+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13969362","id":"13969362","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Bruno, You seem to get more errors/failures with the patch on windows, no?  Do you have a windows 8 box to run it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-15T09:18:58.815+0000","updated":"2014-04-15T09:18:58.815+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13969369","id":"13969369","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Hi Flavio, Actually not. My explanation was not clear (sorry for that): the trunk-only has more test failures but it shares some of them with the trunk+patch. So my first Windows-related list contains the failures found both in trunk-only and trunk+patch (common failures), and my second list contains only the additional failures found in the trunk-only only.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-15T09:26:50.554+0000","updated":"2014-04-15T09:26:50.554+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13969375","id":"13969375","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Yes I have access to a Windows 8 box. I'll give it a try and keep you posted.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-15T09:27:44.551+0000","updated":"2014-04-15T09:27:44.551+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13973389","id":"13973389","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"First I'd like to say I'm sorry for previous alarming test results.\nAfter encouraging test results on the Windows 8 box, I finally realized that, besides the OS, the other difference was the Java version: Oracle Java 1.6 x64 on my Windows 8 box, and Oracle Java 1.7 x64 on my Windows 7 box.\nI switched to Oracle Java 1.6 x64 on my Windows 7 box as well and... much better!\n\nWindows 8 trunk-only:\n     Test org.apache.zookeeper.server.util.DynamicConfigBCTest FAILED\n     Test org.apache.zookeeper.test.ClientPortBindTest FAILED\n     Test org.apache.zookeeper.test.QuorumTest FAILED\n     Test org.apache.zookeeper.test.StaticHostProviderTest FAILED (timeout)\n\nWindows 8 trunk+patch:\n     Test org.apache.zookeeper.server.quorum.ReconfigRecoveryTest FAILED\n     Test org.apache.zookeeper.test.ClientPortBindTest FAILED\n     Test org.apache.zookeeper.test.QuorumTest FAILED\n     Test org.apache.zookeeper.test.StaticHostProviderTest FAILED (timeout)\n\nWindows 7 trunk-only:\n     Test org.apache.zookeeper.server.quorum.ReconfigRecoveryTest FAILED\n     Test org.apache.zookeeper.server.util.DynamicConfigBCTest FAILED\n     Test org.apache.zookeeper.test.ClientPortBindTest FAILED\n     Test org.apache.zookeeper.test.QuorumTest FAILED\n     Test org.apache.zookeeper.test.StaticHostProviderTest FAILED (timeout)\n\nWindows 7 trunk+patch:\n     Test org.apache.zookeeper.server.quorum.ReconfigRecoveryTest FAILED\n     Test org.apache.zookeeper.test.ClientPortBindTest FAILED\n     Test org.apache.zookeeper.test.QuorumTest FAILED\n     Test org.apache.zookeeper.test.StaticHostProviderTest FAILED (timeout)\n\nQuite honestly, I don't know what to conclude; on Windows test results seem to be so unpredictable.\nThe invariant seems to be that org.apache.zookeeper.server.util.DynamicConfigBCTest failure neved showed up with the patch.\nMaybe I'll try to loop on ReconfigRecoveryTest and DynamicConfigBCTest tests to see if there is a statistical \"evidence\".\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-17T20:50:06.354+0000","updated":"2014-04-17T20:50:06.354+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13975575","id":"13975575","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"This week-end I looped on DynamicConfigBCTest, ReconfigRecoveryTest and FLETest (tests failures not observed on Linux). Tests are done using a shell script performing a loop of \"ant test -Dtestcase=...\".\n\nDynamicConfigBCTest (more than 6500 loops each): \n-  trunk: 100% failures (0 success)\n-  patch: 0% failures (0 failure)\n\nReconfigRecoveryTest (more than 200 loops each): \n-  trunk: 99% failures\n-  patch: 94% failures\n\nFLETest (more than 500 loops each): \n-  trunk: 20% failures\n-  patch: 2% failures\n\nReconfigRecoveryTest and FLETest do exhibit a random behavior on my Windows 7 box.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-04-21T13:51:11.221+0000","updated":"2014-04-21T13:51:11.221+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13976071","id":"13976071","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"body":"Thank you for running these tests Bruno! Flavio/Alex, should we check this patch in? It looks good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michim","name":"michim","key":"michim","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michi Mutsuzaki","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-21T21:30:18.261+0000","updated":"2014-04-21T21:30:18.261+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/13982413","id":"13982413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"body":"It looks good, thanks a lot Bruno! \n\nI'd still suggest to change the implementation of writeLongToFile to use the new Ideom class, to make things consistent. Is there any downside to this ? Could this reduce failures on Windows ? This seems nice to have, but up to you, Bruno.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-27T18:19:08.653+0000","updated":"2014-04-27T18:19:08.653+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14021791","id":"14021791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"I'm Sorry Alex, I totally missed the notification of your message.\nHard to say if there is a downside but I'll do it, run the tests, and we'll see! Probably next week-end though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-09T09:29:58.108+0000","updated":"2014-06-09T09:29:58.108+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14032006","id":"14032006","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"Here is the new patch including the writeLongToFile implementation based on the idiom.\nI ran junit tests on linux and windows, with and without the patch.\nThere is a litle improvement on Linux with org.apache.zookeeper.test.ReconfigTest not failing with the patch.\nOn Windows results are still variable, thus not comparable on a single run. During the week, I'll do another round of test loops.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-15T19:43:05.263+0000","updated":"2014-06-15T19:43:05.263+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14034285","id":"14034285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"body":"re-upload the latest patch in order to try to trigger Hadoop QA report","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bfreuden","name":"bfreuden","key":"bfreuden","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bruno Freudensprung","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-17T20:00:54.991+0000","updated":"2014-06-17T20:00:54.991+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14045506","id":"14045506","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12650866/ZOOKEEPER-1835.patch\n  against trunk revision 1605517.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 4 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2156//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2156//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2156//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-06-27T04:22:50.655+0000","updated":"2014-06-27T04:22:50.655+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14045553","id":"14045553","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"body":"+1. The failure seems unrelated to the JIRA","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shralex","name":"shralex","key":"shralex","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Shraer","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-06-27T05:36:07.679+0000","updated":"2014-06-27T05:36:07.679+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14048630","id":"14048630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"It seems like this patch is good to go. I'll check this in tomorrow unless somebody complains.\n\n\nHi [~bfreuden],\n\nJust one comment. IMHO the test class AtomicFileWritingIdiomTest could extend ZKTestCase, it would be helpful later when debugging test case failures.\nIf possible please include this minor change and update new patch, otw I'll do the changes when committing the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-07-01T08:22:57.904+0000","updated":"2014-07-01T08:22:57.904+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14052105","id":"14052105","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~bfreuden] for the fix. Thanks for the reviews guys.\n\nCommitted to trunk : http://svn.apache.org/viewvc?view=revision&revision=1607774","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh R","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-07-04T02:24:45.848+0000","updated":"2014-07-04T02:24:45.848+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12684352/comment/14052356","id":"14052356","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in ZooKeeper-trunk #2355 (See [https://builds.apache.org/job/ZooKeeper-trunk/2355/])\nZOOKEEPER-1835. dynamic configuration file renaming fails on Windows(Bruno Freudensprung via rakeshr) (rakeshr: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1607774)\n* /zookeeper/trunk/CHANGES.txt\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/common/AtomicFileOutputStream.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/common/AtomicFileWritingIdiom.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java\n* /zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeerConfig.java\n* /zookeeper/trunk/src/java/test/org/apache/zookeeper/common/AtomicFileWritingIdiomTest.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2014-07-04T11:11:39.220+0000","updated":"2014-07-04T11:11:39.220+0000"}],"maxResults":40,"total":40,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1835/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1qn7z:"}}