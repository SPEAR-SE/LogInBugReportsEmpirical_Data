{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andschwa&avatarId=29804",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andschwa&avatarId=29804",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andschwa&avatarId=29804",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andschwa&avatarId=29804"
            },
            "displayName": "Andrew Schwartzmeyer",
            "key": "andschwa",
            "name": "andschwa",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andschwa",
            "timeZone": "America/Los_Angeles"
        },
        "components": [],
        "created": "2017-09-25T22:41:49.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andschwa&avatarId=29804",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andschwa&avatarId=29804",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andschwa&avatarId=29804",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andschwa&avatarId=29804"
            },
            "displayName": "Andrew Schwartzmeyer",
            "key": "andschwa",
            "name": "andschwa",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andschwa",
            "timeZone": "America/Los_Angeles"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2017-09-25T22:57:22.862+0000",
        "customfield_12310222": "1_*:*_1_*:*_1482627_*|*_3_*:*_1_*:*_169966186_*|*_5_*:*_1_*:*_0",
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "0.0",
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i3kix3:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Sep 27 23:34:47 UTC 2017",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "In ZOOKEEPER-2841 I fixed the inclusion of project-specific porting changes that were included in the public headers, which then broke upstream projects (in my case, Mesos).\n\nUnfortunately, I inadvertently created the exact same problem for Linux (or really any system that uses Autotools), and it wasn't evident until the build was coupled with another project with the same problem. More specifically, when including ZooKeeper (with my changes) in Mesos, and including Google's Glog in Mesos, and building both with Autotools (which we also support), both packages define the pre-processor macro {{PACKAGE_VERSION}}, and so so publicly. This is defined in {{config.h}} by Autotools, and is not a problem _unless included publicly_.\n\nWhen refactoring, I saw two includes in {{zookeeper.h}} that instead of being guarded by e.g. {{#ifdef HAVE_SYS_SOCKET_H}} were guarded by {{#ifndef WIN32}}. Without realizing that I would create the exact same problem I was elsewhere fixing, I erroneously added {{#include \"config.h\"}} and guarded the includes \"properly.\" But there is _very good reasons_ not to do this (explained above).\n\nThe patch to fix this is simple:\n\n{noformat}\ndiff --git a/src/c/include/zookeeper.h b/src/c/include/zookeeper.h\nindex d20e70af4..b0bb09e3f 100644\n--- a/src/c/include/zookeeper.h\n+++ b/src/c/include/zookeeper.h\n@@ -21,13 +21,9 @@\n\n #include <stdlib.h>\n\n-#include \"config.h\"\n-\n-#ifdef HAVE_SYS_SOCKET_H\n+/* we must not include config.h as a public header */\n+#ifndef WIN32\n #include <sys/socket.h>\n-#endif\n-\n-#ifdef HAVE_SYS_TIME_H\n #include <sys/time.h>\n #endif\n\ndiff --git a/src/c/src/zookeeper.c b/src/c/src/zookeeper.c\nindex 220c57dc4..9b837f227 100644\n--- a/src/c/src/zookeeper.c\n+++ b/src/c/src/zookeeper.c\n@@ -24,6 +24,7 @@\n #define USE_IPV6\n #endif\n\n+#include \"config.h\"\n #include <zookeeper.h>\n #include <zookeeper.jute.h>\n #include <proto.h>\n{noformat}\n\nI am opening pull requests in a few minutes to have this applied to branch 3.4 and 3.5.\n\nI'm sorry!",
        "duedate": null,
        "environment": "Linux-ish environments.",
        "fixVersions": [
            {
                "archived": false,
                "description": "Fix release against 3.4 branch",
                "id": "12339207",
                "name": "3.4.11",
                "releaseDate": "2017-11-09",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12339207"
            },
            {
                "archived": false,
                "description": "Beta release against 3.5 branch",
                "id": "12340141",
                "name": "3.5.4",
                "releaseDate": "2018-05-17",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340141"
            },
            {
                "archived": false,
                "id": "12326518",
                "name": "3.6.0",
                "released": false,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12326518"
            }
        ],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011"
            },
            "id": "12310801",
            "key": "ZOOKEEPER",
            "name": "ZooKeeper",
            "projectCategory": {
                "description": "Apache ZooKeeper related",
                "id": "10484",
                "name": "ZooKeeper",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10484"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310801"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andschwa&avatarId=29804",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andschwa&avatarId=29804",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andschwa&avatarId=29804",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andschwa&avatarId=29804"
            },
            "displayName": "Andrew Schwartzmeyer",
            "key": "andschwa",
            "name": "andschwa",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andschwa",
            "timeZone": "America/Los_Angeles"
        },
        "resolution": {
            "description": "A fix for this issue is checked into the tree and tested.",
            "id": "1",
            "name": "Fixed",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1"
        },
        "resolutiondate": "2017-09-27T22:19:17.000+0000",
        "status": {
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "id": "5",
            "name": "Resolved",
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "Don't include `config.h` in `zookeeper.h`",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2017-09-27T23:34:47.000+0000",
        "versions": [],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2905/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-2905/watchers",
            "watchCount": 4
        },
        "workratio": -1
    },
    "id": "13104933",
    "key": "ZOOKEEPER-2905",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13104933"
}