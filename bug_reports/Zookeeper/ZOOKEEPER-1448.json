{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030"
            },
            "displayName": "Flavio Junqueira",
            "key": "fpj",
            "name": "fpj",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fpj",
            "timeZone": "Europe/Berlin"
        },
        "components": [{
            "description": "General issues with the ZooKeeper server.",
            "id": "12312382",
            "name": "server",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12312382"
        }],
        "created": "2012-04-17T16:15:40.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Botond Hejj",
            "key": "botond.hejj",
            "name": "botond.hejj",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=botond.hejj",
            "timeZone": "Europe/Berlin"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2012-04-17T17:32:56.306+0000",
        "customfield_12310222": "10002_*:*_4_*:*_5598399712_*|*_1_*:*_4_*:*_38140104131_*|*_5_*:*_1_*:*_0",
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "7.0",
        "customfield_12310420": "236123",
        "customfield_12310920": "32553",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i05xnz:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Mar 13 18:17:08 UTC 2014",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "Hi,\n\nI've found a bug in zookeeper related to quota creation which can shutdown zookeeper leader on startup.\n\nSteps to reproduce:\n1. create /quota_bug\n2. setquota -n 10000 /quota_bug\n3. stop the whole ensemble (the previous operations should be in the transaction log)\n4. start all the servers\n5. the elected leader will shutdown with an exception (Missing stat node for count /zookeeper/quota/quota_bug/zookeeper_\nstats)\n\nI've debugged a bit what happening and I found the following problem:\nOn startup each server loads the last snapshot and replays the last transaction log. While doing this it fills up the pTrie variable of the DataTree with the path of the nodes which have quota.\nAfter the leader is elected the leader servers loads the snapshot and last transaction log but it doesn't clean up the pTrie variable. This means it still contains the \"/quota_bug\" path. Now when the \"create /quota_bug\" is processed from the transaction log the DataTree already thinks that the quota nodes (\"/zookeeper/quota/quota_bug/zookeeper_limits\" and \"/zookeeper/quota/quota_bug/zookeeper_stats\") are created but those node creation actually comes later in the transaction log. This leads to the missing stat node exception.\n\nI think clearing the pTrie should solve this problem.\n\n",
        "duedate": null,
        "environment": null,
        "fixVersions": [
            {
                "archived": false,
                "description": "Fix release against 3.4 branch",
                "id": "12323310",
                "name": "3.4.6",
                "releaseDate": "2014-03-10",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12323310"
            },
            {
                "archived": false,
                "description": "Dynamic Reconfig, Remove Watches, Local Session",
                "id": "12316644",
                "name": "3.5.0",
                "releaseDate": "2014-08-04",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12316644"
            }
        ],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "id": "2",
            "name": "Critical",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011"
            },
            "id": "12310801",
            "key": "ZOOKEEPER",
            "name": "ZooKeeper",
            "projectCategory": {
                "description": "Apache ZooKeeper related",
                "id": "10484",
                "name": "ZooKeeper",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10484"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310801"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Botond Hejj",
            "key": "botond.hejj",
            "name": "botond.hejj",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=botond.hejj",
            "timeZone": "Europe/Berlin"
        },
        "resolution": {
            "description": "A fix for this issue is checked into the tree and tested.",
            "id": "1",
            "name": "Fixed",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1"
        },
        "resolutiondate": "2013-09-05T21:50:44.000+0000",
        "status": {
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "id": "6",
            "name": "Closed",
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "Node+Quota creation in transaction log can crash leader startup",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2014-03-13T18:17:08.000+0000",
        "versions": [{
            "archived": false,
            "description": "Fix release against 3.3 branch",
            "id": "12319081",
            "name": "3.3.5",
            "releaseDate": "2012-03-20",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12319081"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1448/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-1448/watchers",
            "watchCount": 7
        },
        "workratio": -1
    },
    "id": "12551259",
    "key": "ZOOKEEPER-1448",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12551259"
}