{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Sergey Shelukhin",
            "key": "sershe",
            "name": "sershe",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sershe",
            "timeZone": "America/Los_Angeles"
        },
        "components": [],
        "created": "2016-11-28T21:20:01.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Sergey Shelukhin",
            "key": "sershe",
            "name": "sershe",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sershe",
            "timeZone": "America/Los_Angeles"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2016-12-02T20:22:37.151+0000",
        "customfield_12310222": "1_*:*_1_*:*_181389919_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_590354057",
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "3.0",
        "customfield_12310320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i36v7z:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Jan 04 00:03:49 UTC 2017",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "First attempt and failure detection:\n{noformat}\n2016-11-18 20:20:01,980 [INFO] [TaskSchedulerEventHandlerThread] |tezplugins.LlapTaskSchedulerService|: Received allocateRequest. task=attempt_1478967587833_2622_1_06_000031_0, priority=65, capability=&lt;memory:4096, vCores:1&gt;, hosts=[3n01]\n2016-11-18 20:20:01,982 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: Assigned task TaskInfo{task=attempt_1478967587833_2622_1_06_000031_0, priority=65, startTime=0, containerId=null, assignedInstance=null, uniqueId=55, localityDelayTimeout=9223372036854775807} to container container_222212222_2622_01_000056 on node=DynamicServiceInstance [alive=true, host=3n01:15001 with resources=&lt;memory:59392, vCores:16&gt;, shufflePort=15551, servicesAddress=http://3n01:15002, mgmtPort=15004]\n2016-11-18 20:20:01,982 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: ScheduleResult for Task: TaskInfo{task=attempt_1478967587833_2622_1_06_000031_0, priority=65, startTime=10550817928, containerId=container_222212222_2622_01_000056, assignedInstance=DynamicServiceInstance [alive=true, host=3n01:15001 with resources=&lt;memory:59392, vCores:16&gt;, shufflePort=15551, servicesAddress=http://3n01:15002, mgmtPort=15004], uniqueId=55, localityDelayTimeout=9223372036854775807} = SCHEDULED\n2016-11-18 20:20:03,427 [INFO] [Dispatcher thread {Central}] |impl.TaskAttemptImpl|: TaskAttempt: [attempt_1478967587833_2622_1_06_000031_0] started. Is using containerId: [container_222212222_2622_01_000056] on NM: [3n01:15001]\n2016-11-18 20:20:03,427 [INFO] [Dispatcher thread {Central}] |history.HistoryEventHandler|: [HISTORY][DAG:dag_1478967587833_2622_1][Event:TASK_ATTEMPT_STARTED]: vertexName=Map 1, taskAttemptId=attempt_1478967587833_2622_1_06_000031_0, startTime=1479500403427, containerId=container_222212222_2622_01_000056, nodeId=3n01:15001\n2016-11-18 20:20:03,430 [INFO] [TaskCommunicator # 1] |tezplugins.LlapTaskCommunicator|: Successfully launched task: attempt_1478967587833_2622_1_06_000031_0\n2016-11-18 20:20:03,434 [INFO] [IPC Server handler 11 on 43092] |impl.TaskImpl|: TaskAttempt:attempt_1478967587833_2622_1_06_000031_0 sent events: (0-1).\n2016-11-18 20:20:03,434 [INFO] [IPC Server handler 11 on 43092] |impl.VertexImpl|: Sending attempt_1478967587833_2622_1_06_000031_0 24 events [0,24) total 24 vertex_1478967587833_2622_1_06 [Map 1]\n2016-11-18 20:25:43,249 [INFO] [Dispatcher thread {Central}] |history.HistoryEventHandler|: [HISTORY][DAG:dag_1478967587833_2622_1][Event:TASK_ATTEMPT_FINISHED]: vertexName=Map 1, taskAttemptId=attempt_1478967587833_2622_1_06_000031_0, creationTime=1479500401929, allocationTime=1479500403426, startTime=1479500403427, finishTime=1479500743249, timeTaken=339822, status=FAILED, taskFailureType=NON_FATAL, errorEnum=TASK_HEARTBEAT_ERROR, diagnostics=AttemptID:attempt_1478967587833_2622_1_06_000031_0 Timed out after 300 secs, nodeHttpAddress=http://3n01:15002, counters=Counters: 1, org.apache.tez.common.counters.DAGCounter, DATA_LOCAL_TASKS=1\n2016-11-18 20:25:43,255 [INFO] [TaskSchedulerEventHandlerThread] |tezplugins.LlapTaskSchedulerService|: Processing de-allocate request for task=attempt_1478967587833_2622_1_06_000031_0, state=ASSIGNED, endReason=OTHER\n2016-11-18 20:25:43,259 [INFO] [Dispatcher thread {Central}] |node.AMNodeImpl|: Attempt failed on node: 3n01:15001 TA: attempt_1478967587833_2622_1_06_000031_0 failed: true container: container_222212222_2622_01_000056 numFailedTAs: 7\n2016-11-18 20:25:43,262 [INFO] [Dispatcher thread {Central}] |impl.VertexImpl|: Source task attempt completed for vertex: vertex_1478967587833_2622_1_07 [Reducer 2] attempt: attempt_1478967587833_2622_1_06_000031_0 with state: FAILED vertexState: RUNNING\n{noformat}\nSecond attempt:\n{noformat}\n2016-11-18 20:25:43,267 [INFO] [TaskSchedulerEventHandlerThread] |tezplugins.LlapTaskSchedulerService|: Received allocateRequest. task=attempt_1478967587833_2622_1_06_000031_1, priority=64, capability=&lt;memory:4096, vCores:1&gt;, hosts=null\n2016-11-18 20:25:43,297 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: ScheduleResult for Task: TaskInfo{task=attempt_1478967587833_2622_1_06_000031_1, priority=64, startTime=0, containerId=null, assignedInstance=null, uniqueId=318, localityDelayTimeout=9223372036854775807} = DELAYED_RESOURCES\n2016-11-18 20:25:43,297 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: Preempting for task=attempt_1478967587833_2622_1_06_000031_1 on any available host\n2016-11-18 20:25:43,298 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: ScheduleResult for Task: TaskInfo{task=attempt_1478967587833_2622_1_06_000031_1, priority=64, startTime=0, containerId=null, assignedInstance=null, uniqueId=318, localityDelayTimeout=9223372036854775807} = DELAYED_RESOURCES\n2016-11-18 20:25:43,299 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: Assigned task TaskInfo{task=attempt_1478967587833_2622_1_06_000031_1, priority=64, startTime=0, containerId=null, assignedInstance=null, uniqueId=318, localityDelayTimeout=9223372036854775807} to container container_222212222_2622_01_000164 on node=DynamicServiceInstance [alive=true, host=1n02:15001 with resources=&lt;memory:59392, vCores:16&gt;, shufflePort=15551, servicesAddress=http://1n02:15002, mgmtPort=15004]\n2016-11-18 20:25:43,300 [INFO] [LlapScheduler] |tezplugins.LlapTaskSchedulerService|: ScheduleResult for Task: TaskInfo{task=attempt_1478967587833_2622_1_06_000031_1, priority=64, startTime=10551159245, containerId=container_222212222_2622_01_000164, assignedInstance=DynamicServiceInstance [alive=true, host=1n02:15001 with resources=&lt;memory:59392, vCores:16&gt;, shufflePort=15551, servicesAddress=http://1n02:15002, mgmtPort=15004], uniqueId=318, localityDelayTimeout=9223372036854775807} = SCHEDULED\n2016-11-18 20:25:43,301 [INFO] [Dispatcher thread {Central}] |impl.TaskAttemptImpl|: TaskAttempt: [attempt_1478967587833_2622_1_06_000031_1] started. Is using containerId: [container_222212222_2622_01_000164] on NM: [1n02:15001]\n2016-11-18 20:25:43,301 [INFO] [Dispatcher thread {Central}] |history.HistoryEventHandler|: [HISTORY][DAG:dag_1478967587833_2622_1][Event:TASK_ATTEMPT_STARTED]: vertexName=Map 1, taskAttemptId=attempt_1478967587833_2622_1_06_000031_1, startTime=1479500743301, containerId=container_222212222_2622_01_000164, nodeId=1n02:15001\n2016-11-18 20:25:43,485 [INFO] [TaskCommunicator # 7] |tezplugins.LlapTaskCommunicator|: Successfully launched task: attempt_1478967587833_2622_1_06_000031_1\n2016-11-18 20:25:43,500 [INFO] [IPC Server handler 5 on 43092] |impl.TaskImpl|: TaskAttempt:attempt_1478967587833_2622_1_06_000031_1 sent events: (0-1).\n2016-11-18 20:25:43,500 [INFO] [IPC Server handler 5 on 43092] |impl.VertexImpl|: Sending attempt_1478967587833_2622_1_06_000031_1 24 events [0,24) total 24 vertex_1478967587833_2622_1_06 [Map 1]\n{noformat}\nThe IPC thread logs some other activity 250ms later, so it's not stuck nor did it log an error.\nAfter this, there are no mentions of any tasks for 2622_1_06_000031 in the log.\nThe attempt was not running in LLAP.\n\nHowever, the attempt does come up again when the DAG is killed, long time after it was stuck; presumably, AM failed to detect the failure (or heartbeat failure for that matter?) and never tried to reschedule.\n{noformat}\n2016-11-22 08:45:14,228 [INFO] [Dispatcher thread {Central}] |history.HistoryEventHandler|: [HISTORY][DAG:dag_1478967587833_2622_1][Event:TASK_ATTEMPT_FINISHED]: vertexName=Map 1, taskAttemptId=attempt_1478967587833_2622_1_06_000031_1, creationTime=1479500743255, allocationTime=1479500743300, startTime=1479500743301, finishTime=1479804314228, timeTaken=303570927, status=KILLED, errorEnum=TERMINATED_BY_CLIENT, diagnostics=Task KILL is received. Killing attempt. Diagnostics: Killing tasks in vertex: vertex_1478967587833_2622_1_06 [Map 1] due to trigger: DAG_TERMINATED, nodeHttpAddress=http://1n02:15002, counters=Counters: 1, org.apache.tez.common.counters.DAGCounter, OTHER_LOCAL_TASKS=1\n{noformat}\n\nI do see some errors elsewhere to this node (w/Connection refused), but they happen later. Let me know if you need anything else from AM log.\n{noformat}\n2016-11-18 20:27:15,902 [WARN] [TaskCommunicator # 8] |ipc.Client|: Failed to connect to server: 1n02/(snip).2:15001: retries get failed due to exceeded maximum allowed time (in MILLISECONDS): 16000\n2016-11-18 20:27:34,517 [WARN] [TaskCommunicator # 3] |ipc.Client|: Failed to connect to server: 1n02/(snip).2:15001: retries get failed due to exceeded maximum allowed time (in MILLISECONDS): 16000\n{noformat}\n\nIt seems like a parallel query caused the memory exhaustion on LLAP; most mappers for this job eventually completed successfully, a few were lost as per above, and the DAG got stuck because of that.\nRelevant slider containers and restarts (the last one seems to be the one where the attempt was running).\nUnfortunately the logs from relevant LLAP containers are missing from aggregation.\n{noformat}\n2016-11-18 20:20:24,822 [AMRM Callback Handler Thread] ERROR appmaster.SliderAppMaster - Role instance RoleInstance{role='LLAP', id='container_e55_1478967587833_2465_01_000005', container=ContainerID=container_e55_1478967587833_2465_01_000005 nodeID=3n01:45454  ... diagnostics='Container [pid=1636544,containerID=container_e55_1478967587833_2465_01_000005] is running beyond physical memory limits. Current usage: 140.3 GB of 140.3 GB physical memory used; 141.8 GB of 294.5 GB virtual memory used. Killing container.\n2016-11-18 20:20:31,912 [AMRM Callback Handler Thread] ERROR appmaster.SliderAppMaster - Role instance RoleInstance{role='LLAP', id='container_e55_1478967587833_2465_01_000003', container=ContainerID=container_e55_1478967587833_2465_01_000003 nodeID=1n02:45454  ... diagnostics='Container [pid=607173,containerID=container_e55_1478967587833_2465_01_000003] is running beyond physical memory limits. Current usage: 141.0 GB of 140.3 GB physical memory used; 142.5 GB of 294.5 GB virtual memory used. Killing container.\n2016-11-18 20:25:39,248 [AMRM Callback Handler Thread] ERROR appmaster.SliderAppMaster - Role instance RoleInstance{role='LLAP', id='container_e55_1478967587833_2465_01_000007', container=ContainerID=container_e55_1478967587833_2465_01_000007 nodeID=3n01:45454  ... diagnostics='Container [pid=1227721,containerID=container_e55_1478967587833_2465_01_000007] is running beyond physical memory limits. Current usage: 140.3 GB of 140.3 GB physical memory used; 143.2 GB of 294.5 GB virtual memory used. Killing container.\n2016-11-18 20:26:30,250 [AMRM Callback Handler Thread] ERROR appmaster.SliderAppMaster - Role instance RoleInstance{role='LLAP', id='container_e55_1478967587833_2465_01_000009', container=ContainerID=container_e55_1478967587833_2465_01_000009 nodeID=1n02:45454  ... diagnostics='Container [pid=1893586,containerID=container_e55_1478967587833_2465_01_000009] is running beyond physical memory limits. Current usage: 141.2 GB of 140.3 GB physical memory used; 144.4 GB of 294.5 GB virtual memory used. Killing container.\n\n2016-11-18 20:20:41,060 [145589505@qtp-14633842-4] INFO  agent.AgentProviderService - Component operation. Status: COMPLETED; new container state: HEALTHY; new component state: STARTED\n2016-11-18 20:20:49,171 [145589505@qtp-14633842-4] INFO  agent.AgentProviderService - Component operation. Status: COMPLETED; new container state: HEALTHY; new component state: STARTED\n2016-11-18 20:25:55,942 [145589505@qtp-14633842-4] INFO  agent.AgentProviderService - Component operation. Status: COMPLETED; new container state: HEALTHY; new component state: STARTED\n2016-11-18 20:26:47,019 [145589505@qtp-14633842-4] INFO  agent.AgentProviderService - Component operation. Status: COMPLETED; new container state: HEALTHY; new component state: STARTED\n{noformat}\n",
        "duedate": null,
        "environment": null,
        "fixVersions": [{
            "archived": false,
            "id": "12335837",
            "name": "2.2.0",
            "releaseDate": "2017-07-25",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12335837"
        }],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935"
            },
            "id": "12310843",
            "key": "HIVE",
            "name": "Hive",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310843"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Sergey Shelukhin",
            "key": "sershe",
            "name": "sershe",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sershe",
            "timeZone": "America/Los_Angeles"
        },
        "resolution": {
            "description": "A fix for this issue is checked into the tree and tested.",
            "id": "1",
            "name": "Fixed",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1"
        },
        "resolutiondate": "2016-12-07T19:42:23.000+0000",
        "status": {
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "id": "6",
            "name": "Closed",
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "AM may lose task failures and not reschedule when scheduling to LLAP",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2017-07-26T00:03:27.000+0000",
        "versions": [],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-15296/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-15296/watchers",
            "watchCount": 3
        },
        "workratio": -1
    },
    "id": "13023866",
    "key": "HIVE-15296",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13023866"
}