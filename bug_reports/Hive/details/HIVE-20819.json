{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13194501","self":"https://issues.apache.org/jira/rest/api/2/issue/13194501","key":"HIVE-20819","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-11-06T05:29:43.476+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Nov 26 20:43:55 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20819/watchers","watchCount":4,"isWatching":false},"created":"2018-10-26T19:47:54.360+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-11-26T20:47:24.786+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320408","id":"12320408","name":"HiveServer2","description":"Tracks issues related to HiveServer2"}],"timeoriginalestimate":null,"description":"Leaking Metastore connections when HADOOP_USER_NAME environmental variable is set.\r\n\r\nThe connections created are in ESTABLISHED state and never closed\r\n\r\n \r\n\r\n*More Details :* \r\n\r\nWhen a new query is executed for a new session\r\n\r\n \r\n\r\nThe handler thread, calls line 66 HiveSessionImplwithUGI\r\n\r\n(UserGroupInformation.createProxyUser(owner, UserGroupInformation.getLoginUser());\r\n\r\n \r\n\r\nAt *query compile time*, this sessionUgi is used to open MS connection by *handler* thread\r\n\r\nLater at *query run time*, line 277 of SQLOperation\r\n\r\nRunnable work =     new BackgroundWork(getCurrentUGI(), parentSession.getSessionHive(), SessionState.get(),asyncPrepare);\r\n\r\n getCurrentUGI(); is used to create a new proxy user, which in turn calls Utils.getUGI (see below) and passed to the *Background* thread\r\n\r\n \r\n{code:java}\r\npublic static UserGroupInformation getUGI() throws LoginException, IOException {\r\n\r\n   String doAs = System.getenv(\"HADOOP_USER_NAME\");\r\n\r\n   if(doAs != null && doAs.length() > 0) {\r\n\r\n    /*\r\n\r\n     * this allows doAs (proxy user) to be passed along across process boundary where\r\n\r\n     * delegation tokens are not supported.  For example, a DDL stmt via WebHCat with\r\n\r\n     * a doAs parameter, forks to 'hcat' which needs to start a Session that\r\n\r\n     * proxies the end user\r\n\r\n     */\r\n\r\n     return UserGroupInformation.createProxyUser(doAs, UserGroupInformation.getLoginUser());\r\n\r\n   }\r\n\r\n   return UserGroupInformation.getCurrentUser();\r\n\r\n }\r\n{code}\r\n \r\n\r\ncurrentUGI creates a *new* proxyuser instance. This ugi is being set on the background thread\r\n\r\nAnd when it is trying to get the Hive db in subsequent calls, we see that since the ugi’s are not equal (See the equals code below), a new connection is opened, which is never closed, by background thread.\r\n\r\nLine 318 in Hive.java\r\n\r\n \r\n{code:java}\r\n private static Hive getInternal(HiveConf c, boolean needsRefresh, boolean isFastCheck,\r\n\r\n     boolean doRegisterAllFns) throws HiveException {\r\n\r\n   Hive db = hiveDB.get();\r\n\r\n   if (db == null || !db.isCurrentUserOwner() || needsRefresh\r\n\r\n       || (c != null && !isCompatible(db, c, isFastCheck)))\r\n\r\n{      db = create(c, false, db, doRegisterAllFns);    }\r\n\r\n   if (c != null)\r\n\r\n{      db.conf = c;    }\r\n\r\n   return db;\r\n\r\n }\r\n\r\n \r\n\r\nprivate boolean isCurrentUserOwner() throws HiveException {\r\n\r\n   try\r\n\r\n{      return owner == null || owner.equals(UserGroupInformation.getCurrentUser());    }\r\n\r\ncatch(IOException e)\r\n\r\n{      throw new HiveException(\"Error getting current user: \" + e.getMessage(), e);    }\r\n\r\n }\r\n\r\n/**\r\n\r\n  * Compare the subjects to see if they are equal to each other.\r\n\r\n  */\r\n\r\n @Override\r\n\r\n public boolean equals(Object o) {\r\n\r\n   if (o == this)\r\n\r\n{      return true;    }\r\n\r\nelse if (o == null || getClass() != o.getClass())\r\n\r\n{      return false;    }\r\n\r\nelse\r\n\r\n{      return subject == ((UserGroupInformation) o).subject;    }\r\n\r\n }\r\n\r\n \r\n{code}\r\n \r\n\r\nSolution:\r\n\r\nWhen we assign *currentUGI* to the bg thread, we should call UserGroupInformation.getCurrentUser() (see below) instead of calling *getUGI* method listed above (which creates a new instance of proxy user and subject and will always return isCurrentUserOwner as false, since both subject and ugi instances are different and hence creates a new MS connection)\r\n\r\n \r\n{code:java}\r\n/**\r\n\r\n  * Return the current user, including any doAs in the current stack.\r\n\r\n  */\r\n\r\n public synchronized\r\n\r\n static UserGroupInformation getCurrentUser() throws IOException {\r\n\r\n   AccessControlContext context = AccessController.getContext();\r\n\r\n   Subject subject = Subject.getSubject(context);\r\n\r\n   if (subject == null || subject.getPrincipals(User.class).isEmpty())\r\n\r\n{      return getLoginUser();    }\r\n\r\nelse\r\n\r\n{      return new UserGroupInformation(subject);    }\r\n\r\n }\r\n{code}\r\n \r\n\r\n \r\n\r\n ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12946974","id":"12946974","filename":"HIVE-20819.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"created":"2018-11-05T22:11:58.317+0000","size":692,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12946974/HIVE-20819.1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Leaking Metastore connections when HADOOP_USER_NAME environmental variable is set","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13194501/comment/16675818","id":"16675818","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"body":"Use the same UGI for both the handler thread (sessionUGI) and background thread for the same session","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"created":"2018-11-05T22:16:13.931+0000","updated":"2018-11-05T22:16:13.931+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13194501/comment/16676160","id":"16676160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 32s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 21s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 10s{color} | {color:green} master passed {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m 34s{color} | {color:blue} service in master has 48 extant Findbugs warnings. {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 16s{color} | {color:green} master passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 22s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |\r\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red}  0m 11s{color} | {color:red} service: The patch generated 1 new + 18 unchanged - 0 fixed = 19 total (was 18) {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 42s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 15s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 12s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 11m 23s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-14760/dev-support/hive-personality.sh |\r\n| git revision | master / 353c55e |\r\n| Default Java | 1.8.0_111 |\r\n| findbugs | v3.0.0 |\r\n| checkstyle | http://104.198.109.242/logs//PreCommit-HIVE-Build-14760/yetus/diff-checkstyle-service.txt |\r\n| modules | C: service U: service |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-14760/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-11-06T05:29:43.476+0000","updated":"2018-11-06T05:29:43.476+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13194501/comment/16676224","id":"16676224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12946974/HIVE-20819.1.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:green}SUCCESS:{color} +1 due to 15525 tests passed\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/14760/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/14760/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-14760/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12946974 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-11-06T06:26:26.919+0000","updated":"2018-11-06T06:26:26.919+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13194501/comment/16677092","id":"16677092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~roohi] Thanks for the patch. The patch looks very simple although its not very clear as to why the connection leaks. Can you please update the description of the JIRA to some more details as to why there is a leak and how the patch fixes the problem? Also, seems like {{Utils.getUGI}} intentionally checks for {{HADOOP_USER_NAME}} Will this patch not break existing functionality?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-11-06T18:01:50.973+0000","updated":"2018-11-06T18:01:50.973+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13194501/comment/16699562","id":"16699562","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"body":"Logs\r\n\r\n \r\n\r\n2018-10-23 10:52:58,516 DEBUG hive.ql.parse.ParseDriver: [HiveServer2-Handler-Pool: Thread-54]: Parsing command: drop table empdata\r\n\r\n2018-10-23 10:52:58,516 DEBUG hive.ql.parse.ParseDriver: [HiveServer2-Handler-Pool: Thread-54]: Parse Completed\r\n\r\n2018-10-23 10:52:58,566 INFO  hive.metastore: [HiveServer2-Handler-Pool: Thread-54]: Trying to connect to metastore with URI thrift://XXXXX:9083\r\n\r\n*2018-10-23 10:52:58,567 INFO  hive.metastore: [**HiveServer2-Handler-Pool**: Thread-54]: Opened a connection to metastore, current connections: 4*\r\n\r\n2018-10-23 10:52:58,569 INFO  hive.metastore: [HiveServer2-Handler-Pool: Thread-54]: Connected to metastore.\r\n\r\n2018-10-23 10:52:58,698 INFO  org.apache.hadoop.hive.ql.Driver: [HiveServer2-Handler-Pool: Thread-54]: Semantic Analysis Completed\r\n\r\n2018-10-23 10:52:58,699 INFO  hive.ql.metadata.Hive: [HiveServer2-Handler-Pool: Thread-54]: Dumping metastore api call timing information for : compilation phase\r\n\r\n2018-10-23 10:52:58,699 DEBUG hive.ql.metadata.Hive: [HiveServer2-Handler-Pool: Thread-54]: Total time spent in each metastore function (ms): \\{getTable_(String, String, )=129}\r\n\r\n2018-10-23 10:52:58,699 INFO  org.apache.hadoop.hive.ql.Driver: [HiveServer2-Handler-Pool: Thread-54]: Completed compiling command(queryId=hive_20181023105252_d3247a1c-e343-470b-aa46-a692b5ade414); Time taken: 0.183 seconds\r\n\r\n2018-10-23 10:52:58,699 DEBUG org.apache.hadoop.security.UserGroupInformation: *[HiveServer2-**Handler-Pool**: Thread-54]:* *PrivilegedAction as:hive (auth:SIMPLE)* *from:org.apache.hive.service.cli.session.HiveSessionProxy.invoke(HiveSessionProxy.java:59)*\r\n\r\n2018-10-23 10:52:58,699 DEBUG org.apache.hive.service.cli.CLIService: [HiveServer2-Handler-Pool: Thread-54]: SessionHandle [44f74bd9-1a71-458e-9992-e9d8afc3a958]: executeStatementAsync()\r\n\r\n2018-10-23 10:52:58,700 DEBUG org.apache.hadoop.security.UserGroupInformation: [HiveServer2-Background-Pool: Thread-56]: PrivilegedAction as:hive (auth:PROXY) via hive (auth:SIMPLE) from:org.apache.hive.service.cli.operation.SQLOperation$3.run(SQLOperation.java:314)\r\n\r\n2018-10-23 10:52:58,700 DEBUG org.apache.thrift.transport.TSaslTransport: [HiveServer2-Handler-Pool: Thread-54]: writing data length: 109\r\n\r\n*2018-10-23 10:52:58,715 DEBUG hive.ql.metadata.Hive: [HiveServer2-Background-Pool: Thread-56]: Creating new db. db.isCurrentUserOwner = false*\r\n\r\n*2018-10-23 10:52:58,715 DEBUG hive.ql.metadata.Hive: [HiveServer2-Background-Pool: Thread-56]: Closing current thread's connection to Hive Metastore.*\r\n\r\n*2018-10-23 10:52:58,715 INFO  hive.metastore: [HiveServer2-Background-Pool: Thread-56]: Closed a connection to metastore, current connections: 3*\r\n\r\n2018-10-23 10:52:58,716 INFO  org.apache.hadoop.hive.ql.log.PerfLogger: [HiveServer2-Background-Pool: Thread-56]: </PERFLOG method=TimeToSubmit start=1540317178702 end=1540317178716 duration=14 from=org.apache.hadoop.hive.ql.Driver>\r\n\r\n2018-10-23 10:52:58,716 INFO  org.apache.hadoop.hive.ql.log.PerfLogger: [HiveServer2-Background-Pool: Thread-56]: <PERFLOG method=runTasks from=org.apache.hadoop.hive.ql.Driver>\r\n\r\n2018-10-23 10:52:58,716 INFO  org.apache.hadoop.hive.ql.Driver: [HiveServer2-Background-Pool: Thread-56]: Starting task [Stage-0:DDL] in serial mode\r\n\r\n2018-10-23 10:52:58,717 INFO  hive.metastore: [HiveServer2-Background-Pool: Thread-56]: Trying to connect to metastore with URI thrift://XXXX:9083\r\n\r\n*2018-10-23 10:52:58,717 INFO  hive.metastore: [HiveServer2-**Background-Pool**: Thread-56]: Opened a connection to metastore, current connections: 4*\r\n\r\n2018-10-23 10:52:58,720 INFO  hive.metastore: [HiveServer2-Background-Pool: Thread-56]: Connected to metastore.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roohi","name":"roohi","key":"roohi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roohi Syeda","active":true,"timeZone":"Etc/UTC"},"created":"2018-11-26T20:43:55.849+0000","updated":"2018-11-26T20:43:55.849+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20819/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3zp1j:"}}