{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13002082","self":"https://issues.apache.org/jira/rest/api/2/issue/13002082","key":"HIVE-14687","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2016-09-27T09:29:08.623+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Sep 27 09:29:08 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2226617109_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-09-27T09:29:33.891+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14687/watchers","watchCount":2,"isWatching":false},"created":"2016-09-01T14:59:18.097+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["authorization"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-09-27T09:29:35.038+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12317300","id":"12317300","name":"Authorization","description":"Security Subcomponent"}],"timeoriginalestimate":null,"description":"During retrieving the privileges associated with table using Hive metastore api, it retrieves all other properties associated with table and gives null for privileges set .[https://hive.apache.org/javadocs/r1.2.1/api/org/apache/hadoop/hive/metastore/api/Table.html]\n\nConfiguration Applied:\n\nEnable the SQL Authorization inside the Hive Server and user like hive,rootcare added inside admin role through hive configuration.\n\nProblem:\n\nUnable to retrieve the privileges for table using getPrivileges() method after connecting through HiveMetastoreClient api. getPrivileges methods return null whereas other properties of table are retrieved. \n\n\nAnalysis:\n\nI created the table using Hive user after connecting to HiveServer2 usingJDBC. By Default, after creating the table the default\nprivileges are assigned to the current user. It show all the privileges to table from hive prompt using sql.\n\nTried to explore the API, found that Table class is generated by thrift and consist of thrift code. I found that privileges field inside the Table class is made optional. Also, found that, the privileges are stored inside the table TBL_PRIVS inside metastore database.\n\nIs there any specific configuration to be made to retrieve optional field ?\n\nOptions Tried:\n\n1. Tried to print the isSetPrivilege() property, but it returns null.\n2. Tried to add user in admin role which is connecting to hive metastore. Still it gives the getPrivileges() as null.\n\nSample Table Object Output:\n\nTable(tableName:sr4, dbName:hadoop_schema, owner:hive,\ncreateTime:1472192882, lastAccessTime:0, retention:0,\nsd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:null),\nFieldSchema(name:status, type:varchar(20), comment:null)], location:hdfs://\nloco1.fyre.com:8020/apps/hive/warehouse/hadoop_schema.db/sr4,\ninputFormat:org.apache.hadoop.mapred.TextInputFormat,\noutputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat,\ncompressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null,\nserializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe,\nparameters:{serialization.format=1}), bucketCols:[], sortCols:[],\nparameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[],\nskewedColValueLocationMaps:{}), storedAsSubDirectories:false),\npartitionKeys:[], parameters:{totalSize=17, sql.table.io.doAs=false,\nnumRows=-1, rawDataSize=-1, COLUMN_STATS_ACCURATE=false, numFiles=2,\ntransient_lastDdlTime=1472192963}, viewOriginalText:null,\nviewExpandedText:null, tableType:MANAGED_TABLE)\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Metastore API - Retrieving PrincipalPrivilegeSet Object using getPrivileges() method inside metastore Table class give Null value","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rahuldhote","name":"rahuldhote","key":"rahuldhote","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rahul Dhote","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rahuldhote","name":"rahuldhote","key":"rahuldhote","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rahul Dhote","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"RHEL 6 ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13002082/comment/15525595","id":"15525595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lirui","name":"lirui","key":"lirui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Li","active":true,"timeZone":"Asia/Shanghai"},"body":"We have {{IMetaStoreClient::list_privileges}} for this purpose. Closing this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lirui","name":"lirui","key":"lirui","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rui Li","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-09-27T09:29:08.623+0000","updated":"2016-09-27T09:29:08.623+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14687/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3350v:"}}