{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12850217","self":"https://issues.apache.org/jira/rest/api/2/issue/12850217","key":"HIVE-11410","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2015-07-30T23:52:58.411+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Aug 03 17:09:48 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_366220050_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-08-03T17:10:31.577+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11410/watchers","watchCount":4,"isWatching":false},"created":"2015-07-30T11:26:51.552+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-08-03T17:10:31.599+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12325007","id":"12325007","name":"Hive"}],"timeoriginalestimate":null,"description":"Start by creating a table *t* with columns *c1* and *c2* and populate with 1 row of data. For example create table *t* from an existing table which contains at least 1 row of data by running:\n{code}\ncreate table t as select 'abc' as c1, 0 as c2 from Y limit 1; \n{code}\n\nTable *t* looks like the following:\n||c1||c2||\n|abc|0|\n\nRunning the following query then returns zero results.\n{code}\nSELECT \n  t1.c1\nFROM \n  t t1\nJOIN\n(SELECT \n   t2.c1,\n   MAX(t2.c2) AS c2\n FROM \n   t t2 \n GROUP BY \n   t2.c1\n) t3\nON t1.c2=t3.c2\n{code}\n\nHowever, we expected to see the following:\n||c1||\n|abc|\n\nThe problem seems to relate to the fact that in the subquery, we group by column *c1*, but this is not subsequently used in the join condition.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12747968","id":"12747968","filename":"hive-site.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-30T11:27:24.751+0000","size":8233,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12747968/hive-site.xml"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Join with subquery containing a group by incorrectly returns no results","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14648523","id":"14648523","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmokhtar","name":"mmokhtar","key":"mmokhtar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmokhtar&avatarId=21863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmokhtar&avatarId=21863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmokhtar&avatarId=21863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmokhtar&avatarId=21863"},"displayName":"Mostafa Mokhtar","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmccline]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmokhtar","name":"mmokhtar","key":"mmokhtar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmokhtar&avatarId=21863","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmokhtar&avatarId=21863","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmokhtar&avatarId=21863","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmokhtar&avatarId=21863"},"displayName":"Mostafa Mokhtar","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-30T23:52:58.411+0000","updated":"2015-07-30T23:52:58.411+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14648853","id":"14648853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"\nRight, postgres produces:\n{code}\nmmccline=# SELECT\n  t1.c1\nFROM \n  t t1\nJOIN\n(SELECT \n   t2.c1,\n   MAX(t2.c2) AS c2\n FROM \n   t t2 \n GROUP BY \n   t2.c1\n) t3\nON t1.c2=t3.c2;\n c1 \n-----\n abc\n(1 row)\n{code}\n\nAnd, Hive branch-1.1 produces the right result:\n{code}\nSELECT \n  t1.c1\nFROM \n  t t1\nJOIN\n(SELECT \n   t2.c1,\n   MAX(t2.c2) AS c2\n FROM \n   t t2 \n GROUP BY \n   t2.c1\n) t3\nON t1.c2=t3.c2;\nabc\n{code}\n\nHere is the EXPLAIN plan:\n{code}\nEXPLAIN\nSELECT \n  t1.c1\nFROM \n  t t1\nJOIN\n(SELECT \n   t2.c1,\n   MAX(t2.c2) AS c2\n FROM \n   t t2 \n GROUP BY \n   t2.c1\n) t3\nON t1.c2=t3.c2;\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-2 depends on stages: Stage-1\n  Stage-0 depends on stages: Stage-2\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: t2\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Select Operator\n              expressions: c1 (type: string), c2 (type: int)\n              outputColumnNames: c1, c2\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              Group By Operator\n                aggregations: max(c2)\n                keys: c1 (type: string)\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                Reduce Output Operator\n                  key expressions: _col0 (type: string)\n                  sort order: +\n                  Map-reduce partition columns: _col0 (type: string)\n                  Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                  value expressions: _col1 (type: int)\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations: max(VALUE._col0)\n          keys: KEY._col0 (type: string)\n          mode: mergepartial\n          outputColumnNames: _col0, _col1\n          Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n          Select Operator\n            expressions: _col1 (type: int)\n            outputColumnNames: _col1\n            Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n            Filter Operator\n              predicate: _col1 is not null (type: boolean)\n              Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n              Select Operator\n                expressions: _col1 (type: int)\n                outputColumnNames: _col1\n                Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n                File Output Operator\n                  compressed: false\n                  table:\n                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe\n\n  Stage: Stage-2\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            Reduce Output Operator\n              key expressions: _col1 (type: int)\n              sort order: +\n              Map-reduce partition columns: _col1 (type: int)\n              Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n          TableScan\n            alias: t1\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Filter Operator\n              predicate: c2 is not null (type: boolean)\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              Reduce Output Operator\n                key expressions: c2 (type: int)\n                sort order: +\n                Map-reduce partition columns: c2 (type: int)\n                Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                value expressions: c1 (type: string)\n      Reduce Operator Tree:\n        Join Operator\n          condition map:\n               Inner Join 0 to 1\n          keys:\n            0 c2 (type: int)\n            1 _col1 (type: int)\n          outputColumnNames: _col0\n          Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n          File Output Operator\n            compressed: false\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            table:\n                input format: org.apache.hadoop.mapred.TextInputFormat\n                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n      Processor Tree:\n        ListSink\n{code}\n\nSo, perhaps different environment variable setting(s) are causing a plan in branch-1.1 to be produced that the no results case for this JIRA.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-07-31T07:13:24.762+0000","updated":"2015-07-31T07:13:24.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14648854","id":"14648854","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"By the way, thank you for the create repro description.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-07-31T07:14:04.108+0000","updated":"2015-07-31T07:14:04.108+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14648855","id":"14648855","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"[~nbrenwald] please attach your EXPLAIN plan for the query.  And, confirm you are using branch-1.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-07-31T07:15:37.350+0000","updated":"2015-07-31T07:15:37.350+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14649184","id":"14649184","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"body":"Hi, \nThanks for taking a look at this so quickly.\nI confirm we are using branch-1.1 (distributed as part of CDH 5.4.4). For example, hive cli jar is named hive-cli-1.1.0-cdh5.4.4.jar. When we run 'hive' on the command line, we see the following printed message showing the hive-common-1.1.0 is being used.\n{code}\nLogging initialized using configuration in jar:file:/cloudera/parcel-repo/CDH-5.4.4-1.cdh5.4.4.p0.4/jars/hive-common-1.1.0-cdh5.4.4.jar!/hive-log4j.properties\n{code}\n\nAnd the explain plan we see is as follows:\n{code}\nhive> EXPLAIN\n    > SELECT \n    >   t1.c1\n    > FROM \n    >   t t1\n    > JOIN\n    > (SELECT \n    >    t2.c1,\n    >    MAX(t2.c2) AS c2\n    >  FROM \n    >    t t2 \n    >  GROUP BY \n    >    t2.c1\n    > ) t3\n    > ON t1.c2=t3.c2;\nOK\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-5 depends on stages: Stage-1\n  Stage-4 depends on stages: Stage-5\n  Stage-0 depends on stages: Stage-4\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: t2\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Select Operator\n              expressions: c1 (type: string), c2 (type: int)\n              outputColumnNames: c1, c2\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              Group By Operator\n                aggregations: max(c2)\n                keys: c1 (type: string)\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                Reduce Output Operator\n                  key expressions: _col0 (type: string)\n                  sort order: +\n                  Map-reduce partition columns: _col0 (type: string)\n                  Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                  value expressions: _col1 (type: int)\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations: max(VALUE._col0)\n          keys: KEY._col0 (type: string)\n          mode: mergepartial\n          outputColumnNames: _col0, _col1\n          Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n          Filter Operator\n            predicate: _col1 is not null (type: boolean)\n            Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE\n            File Output Operator\n              compressed: false\n              table:\n                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe\n\n  Stage: Stage-5\n    Map Reduce Local Work\n      Alias -> Map Local Tables:\n        t1 \n          Fetch Operator\n            limit: -1\n      Alias -> Map Local Operator Tree:\n        t1 \n          TableScan\n            alias: t1\n            filterExpr: c2 is not null (type: boolean)\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Filter Operator\n              predicate: c2 is not null (type: boolean)\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              HashTable Sink Operator\n                keys:\n                  0 c2 (type: int)\n                  1 _col1 (type: int)\n\n  Stage: Stage-4\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            Map Join Operator\n              condition map:\n                   Inner Join 0 to 1\n              keys:\n                0 c2 (type: int)\n                1 _col1 (type: int)\n              outputColumnNames: _col0\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              Select Operator\n                expressions: _col0 (type: string)\n                outputColumnNames: _col0\n                Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                File Output Operator\n                  compressed: true\n                  Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                  table:\n                      input format: org.apache.hadoop.mapred.TextInputFormat\n                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n      Local Work:\n        Map Reduce Local Work\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n      Processor Tree:\n        ListSink\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"created":"2015-07-31T12:42:46.612+0000","updated":"2015-07-31T12:42:46.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14652081","id":"14652081","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"You EXPLAIN plan shows a MapJoin, so I added \"SET hive.auto.convert.join=true\" and generated a similar but not identical plan....\n\n{code}\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-2 depends on stages: Stage-1\n  Stage-0 depends on stages: Stage-2\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: t2\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Select Operator\n              expressions: c1 (type: string), c2 (type: int)\n              outputColumnNames: c1, c2\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              Group By Operator\n                aggregations: max(c2)\n                keys: c1 (type: string)\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                Reduce Output Operator\n                  key expressions: _col0 (type: string)\n                  sort order: +\n                  Map-reduce partition columns: _col0 (type: string)\n                  Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                  value expressions: _col1 (type: int)\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations: max(VALUE._col0)\n          keys: KEY._col0 (type: string)\n          mode: mergepartial\n          outputColumnNames: _col0, _col1\n          Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n          Select Operator\n            expressions: _col1 (type: int)\n            outputColumnNames: _col1\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Filter Operator\n              predicate: _col1 is not null (type: boolean)\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              File Output Operator\n                compressed: false\n                table:\n                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe\n\n  Stage: Stage-2\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            Reduce Output Operator\n              key expressions: _col1 (type: int)\n              sort order: +\n              Map-reduce partition columns: _col1 (type: int)\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n          TableScan\n            alias: t1\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            Filter Operator\n              predicate: c2 is not null (type: boolean)\n              Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n              Reduce Output Operator\n                key expressions: c2 (type: int)\n                sort order: +\n                Map-reduce partition columns: c2 (type: int)\n                Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n                value expressions: c1 (type: string)\n      Reduce Operator Tree:\n        Join Operator\n          condition map:\n               Inner Join 0 to 1\n          keys:\n            0 c2 (type: int)\n            1 _col1 (type: int)\n          outputColumnNames: _col0\n          Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n          File Output Operator\n            compressed: false\n            Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE\n            table:\n                input format: org.apache.hadoop.mapred.TextInputFormat\n                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n      Processor Tree:\n        ListSink\n{code}\n\nI am not sure what environment variable / possible code difference is producing the different plan and different result...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-08-03T16:46:57.228+0000","updated":"2015-08-03T16:46:57.228+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14652089","id":"14652089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"body":"[~mmccline] I have done some further testing today compiling from source various branches. \n\nThe issue only seems to be present in release-1.1.0 (which is part of the Cloudera distribution we use). The issue cannot be reproduced in branch-1.1 or branch-1.2 (even when using our environment variables/hive-site.xml etc). As such I think this can be marked as resolved. \nThanks for looking into this and sorry for the false alarm.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-03T16:50:42.750+0000","updated":"2015-08-03T16:50:42.750+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12850217/comment/14652125","id":"14652125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"No problem -- thank you for your response.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-08-03T17:09:48.169+0000","updated":"2015-08-03T17:09:48.169+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11410/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2i487:"}}