{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13083959","self":"https://issues.apache.org/jira/rest/api/2/issue/13083959","key":"HIVE-17008","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12340268","id":"12340268","name":"3.0.0","archived":false,"released":true,"releaseDate":"2018-05-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342053","id":"12342053","name":"2.3.2","archived":false,"released":true,"releaseDate":"2017-11-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2017-07-02T00:05:03.815+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 23 00:00:07 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_2_*:*_1669322374_*|*_4_*:*_1_*:*_2749792_*|*_5_*:*_2_*:*_7106845031_*|*_10002_*:*_3_*:*_2595570354","customfield_12312321":null,"resolutiondate":"2017-11-09T15:55:39.032+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-17008/watchers","watchCount":7,"isWatching":false},"created":"2017-07-01T00:20:51.542+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12511424","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12511424","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13093103","key":"HIVE-17267","self":"https://issues.apache.org/jira/rest/api/2/issue/13093103","fields":{"summary":"Make HMS Notification Listeners typesafe","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-05-23T00:00:07.792+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312584","id":"12312584","name":"Metastore","description":"Tracks issue dealing with metastore."}],"timeoriginalestimate":null,"description":"When dropping a non-existent database, the HMS will still fire registered {{DROP_DATABASE}} event listeners.  This results in an NPE when the listeners attempt to deref the {{null}} database parameter.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12875345","id":"12875345","filename":"HIVE-17008.0.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-01T00:22:32.046+0000","size":3028,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12875345/HIVE-17008.0.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12878937","id":"12878937","filename":"HIVE-17008.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-26T02:02:17.059+0000","size":17623,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12878937/HIVE-17008.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12879261","id":"12879261","filename":"HIVE-17008.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-27T23:17:14.519+0000","size":17623,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12879261/HIVE-17008.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12895551","id":"12895551","filename":"HIVE-17008.2-branch-2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-03T02:15:03.179+0000","size":1864,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12895551/HIVE-17008.2-branch-2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12880801","id":"12880801","filename":"HIVE-17008.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zsombor.klara","name":"zsombor.klara","key":"zsombor.klara","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Barna Zsombor Klara","active":true,"timeZone":"Europe/Budapest"},"created":"2017-08-08T09:04:06.804+0000","size":1669,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12880801/HIVE-17008.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12895227","id":"12895227","filename":"HIVE-17008-branch-2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-01T16:14:46.559+0000","size":1864,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12895227/HIVE-17008-branch-2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Fix boolean flag switchup in DropTableEvent","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16071449","id":"16071449","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12875345/HIVE-17008.0.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 8 failed/errored test(s), 10830 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[llap_smb] (batchId=143)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=140)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=145)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=232)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=232)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionRegistrationWithCustomSchema (batchId=177)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionSpecRegistrationWithCustomSchema (batchId=177)\norg.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation (batchId=177)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/5857/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/5857/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-5857/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 8 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12875345 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-07-02T00:05:03.815+0000","updated":"2017-07-02T00:05:03.815+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16074983","id":"16074983","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"body":"[~dan_impala_9180], the changes aren't clear to me, look like changes in indentation. Could you add a review board link ?\n\nAlso, could you add the NPE stracktrace you are seeing to the description ?\n\nYou also need a unit test here, perhaps in TestDbNotificationListener ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"created":"2017-07-05T15:54:40.821+0000","updated":"2017-07-05T15:54:40.821+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16075068","id":"16075068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~mohitsabharwal], here is a better diff of the patch: https://github.com/danburkert/hive/commit/ec115a584c4b2b715f339458afc2bcbf353d1e47?w=1.  Since filing this bug / uploading the patch I've found that the HMS can fire event listeners on almost any type of failed DDL operation: drop database, create table, partitions, functions, indices, etc.  The patch only fixes the drop database case, but the fix is pretty much the same.  It's not clear to me what the designed behavior is, though.  Are these just copy/pasted bugs, or is it by design that the HMS notifies listeners for failed DDL operations?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-05T16:48:07.101+0000","updated":"2017-07-05T16:48:07.101+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16075763","id":"16075763","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"body":"Thanks, [~dan_impala_9180]. There are two flavors of listeners in each DDL operation, one which runs in the same transaction as the DDL event (notify only upon success) and one which run outside the transaction (can notify failed DDL operations as well).  Where exactly is the NPE - I assume somewhere down the notifyEvent stack ?\n\n+ [~spena], who has worked on this recently.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"created":"2017-07-06T01:30:10.602+0000","updated":"2017-07-06T01:30:10.602+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16075790","id":"16075790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm observing these events through the [notification log API|https://github.com/danburkert/hive/blob/master/metastore/if/hive_metastore.thrift#L1546-L1549].  Is it expected that {{ThriftHiveMetastore.get_next_notification}} returns events for failed DDL operations?  There isn't any way to discern whether or not the event failed just from the {{NotificationEvent}} struct.\n\n> Where exactly is the NPE - I assume somewhere down the notifyEvent stack ?\n\nThe NPE is thrown inside the notification event listener, because {{db}} can be null on [this line|https://github.com/apache/hive/blob/master/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java?utf8=%E2%9C%93#L1139].","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-06T01:54:24.085+0000","updated":"2017-07-06T01:54:24.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16076630","id":"16076630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"body":"{{ListenerEvent}} has the success flag, so listener implementation can choose to ignore failed events. But {{DbNotificationListener}} and {{HMSMetricsListener}} are ignoring the status flag.  The old {{NotificationListener}} though is looking at the flag and only logging successful events.\n\nThis does look like something we should make consistent, not just address the NPE. [~sushanth], [~thejas], [~akolb], do you have any thoughts ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"created":"2017-07-06T14:52:37.700+0000","updated":"2017-07-06T14:52:37.700+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16076653","id":"16076653","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akolb","name":"akolb","key":"akolb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Kolbasov","active":true,"timeZone":"America/Los_Angeles"},"body":"There should be no events when the operation failed. This is a bug in the notification processing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akolb","name":"akolb","key":"akolb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Kolbasov","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-06T15:00:15.951+0000","updated":"2017-07-06T15:00:15.951+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16076664","id":"16076664","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akolb","name":"akolb","key":"akolb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Kolbasov","active":true,"timeZone":"America/Los_Angeles"},"body":"Looking at the code, the actual operation is for some reason considered successfull which means that there should be an event and it shouldn't throw NPE.\n\nHere is the relevant check: https://github.com/apache/hive/blob/master/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java?utf8=✓#L1119","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akolb","name":"akolb","key":"akolb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Kolbasov","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-06T15:04:42.834+0000","updated":"2017-07-06T15:04:42.834+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16077005","id":"16077005","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"My comment yesterday evening was a bit brief because I was low on time, but here's the exact sequence of events that leads to the NPE which originally prompted this issue.  As we've discussed it's just one of many inter-related issues in the class, but I wanted to make it clear what's happening in this specific case:\n\n1. Application calls {{ThriftHiveMetastore.drop_database}} with a non-existent database name via the HMS thrift API¹.\n2. In {{HiveMetaStore.drop_database_core}}, the {{db}} local variable is [initialized to {{null}}|https://github.com/apache/hive/blob/555f001146c4fc471e29e18899a0e02a4043cca5/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java#L1023].\n3. In {{HiveMetaStore.drop_database_core}}, the [lookup of the non-existent database fails|https://github.com/apache/hive/blob/555f001146c4fc471e29e18899a0e02a4043cca5/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java#L1029], leaving {{db}} set to {{null}} and unwinding to the {{finally}} block.\n4. In {{HiveMetaSotre.drop_database_core}} {{finally}} block, a new [{{DropDatabaseEvent}} is created|https://github.com/apache/hive/blob/555f001146c4fc471e29e18899a0e02a4043cca5/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java#L1139-L1143] with the {{null}} database, and listeners are notified with this event.\n5. Somewhere (I haven't traced this bit), the notification log event listener is dereferencing the null database.\n\n¹ Although I haven't reproduced it, it should be possible to reproduce this bug through the Java {{HiveMetastoreClient}} API as well, but it would require concurrent DDL operations.  The {{HiveMetastoreClient}} [checks that the database exists|https://github.com/apache/hive/blob/master/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java#L851-L858] before attempting to drop it; this is a benign TOCTOU which makes it difficult to reproduce using that API (again, it should still possible with the right interleavings of concurrent DDL ops).  A light skimming through that class reveals that the client is very aggressive about validating state exists before issuing DDL operations.  Just my opinion, but that's a big code smell; the client should rely on the server to validate arguments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-06T18:20:57.130+0000","updated":"2017-07-06T18:46:40.249+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16077008","id":"16077008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"Canceling patch, since it's clear that it is intended behavior to notify listeners on failed DDL ops.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-06T18:23:31.815+0000","updated":"2017-07-06T18:46:48.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16100891","id":"16100891","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akolb","name":"akolb","key":"akolb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Kolbasov","active":true,"timeZone":"America/Los_Angeles"},"body":"[~dan@danburkert.com] Are you working on the fix for this issue? If not, we should hand it to someone who does.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akolb","name":"akolb","key":"akolb","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alexander Kolbasov","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-25T22:33:45.185+0000","updated":"2017-07-25T22:33:45.185+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16101019","id":"16101019","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"[~akolb] I'm playing around with a fix [here|https://github.com/danburkert/hive/commit/e8b2527ae0fbdff1df2a3b102cba1e0c3cd89e4b?w=1], but it doesn't appear to work quite correctly.  It's fine with me if someone else wants to jump on this an assign it to themselves; I think it should be a high priority bug.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-26T00:57:51.459+0000","updated":"2017-07-26T00:57:51.459+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16101061","id":"16101061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"New patch attached.  Here's a [whitespace-ignored diff|https://github.com/danburkert/hive/commit/b9ff26eccc3733d00f1702c8178cf5b942078485?w=1].  I got to the bottom of the issue I alluded to earlier: the ctor args for {{DropTableEvent}} were mis-ordered in {{HiveMetaStore}}, I've included the fix in this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-07-26T02:04:09.840+0000","updated":"2017-07-26T02:04:09.840+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16105105","id":"16105105","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12879261/HIVE-17008.2.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 8 failed/errored test(s), 11013 tests executed\n*Failed tests:*\n{noformat}\nTestPerfCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=235)\norg.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[materialized_view_create_rewrite] (batchId=240)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[llap_smb] (batchId=144)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_vectorized_dynamic_partition_pruning] (batchId=168)\norg.apache.hadoop.hive.metastore.TestHiveMetaStoreStatsMerge.testStatsMerge (batchId=206)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionRegistrationWithCustomSchema (batchId=179)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionSpecRegistrationWithCustomSchema (batchId=179)\norg.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation (batchId=179)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/6170/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/6170/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6170/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 8 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12879261 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-07-28T15:25:58.491+0000","updated":"2017-07-28T15:25:58.491+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16117546","id":"16117546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi all, I'd like to pass this off to someone with more experience getting Hive patches merged.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=danburkert","name":"danburkert","key":"danburkert","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=danburkert&avatarId=29300","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=danburkert&avatarId=29300","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=danburkert&avatarId=29300","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=danburkert&avatarId=29300"},"displayName":"Dan Burkert","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-08-07T23:24:39.996+0000","updated":"2017-08-07T23:24:39.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16118172","id":"16118172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12880801/HIVE-17008.3.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 12 failed/errored test(s), 10993 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[insert_overwrite_local_directory_1] (batchId=240)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[llap_uncompressed] (batchId=56)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[orc_merge_incompat2] (batchId=80)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[columnstats_part_coltype] (batchId=159)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_dynamic_partition_pruning_mapjoin_only] (batchId=170)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_vectorized_dynamic_partition_pruning] (batchId=169)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=100)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3] (batchId=99)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=235)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionRegistrationWithCustomSchema (batchId=180)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionSpecRegistrationWithCustomSchema (batchId=180)\norg.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation (batchId=180)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/6295/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/6295/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6295/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 12 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12880801 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-08-08T10:49:20.576+0000","updated":"2017-08-08T10:49:20.576+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16118565","id":"16118565","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"body":"HIVE-17008.3.patch looks good to me.\n+1 pending tests","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"created":"2017-08-08T16:22:16.330+0000","updated":"2017-08-08T16:22:16.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16123121","id":"16123121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"body":"Pushed to master.\nThanks [~danburkert] and [~zsombor.klara] for the patch!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"created":"2017-08-11T10:03:02.748+0000","updated":"2017-08-11T10:03:02.748+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16234297","id":"16234297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"Re-opening and assigning to myself, to get this into branch-2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-01T16:10:27.791+0000","updated":"2017-11-01T16:10:27.791+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16238739","id":"16238739","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12895551/HIVE-17008.2-branch-2.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 10659 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[explaindenpendencydiffengs] (batchId=38)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[llap_smb] (batchId=142)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=139)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[table_nonprintable] (batchId=140)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[join_acid_non_acid] (batchId=158)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=153)\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[merge_negative_5] (batchId=88)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[explaindenpendencydiffengs] (batchId=115)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vectorized_ptf] (batchId=125)\norg.apache.hive.hcatalog.api.TestHCatClient.testTransportFailure (batchId=176)\norg.apache.hive.jdbc.TestJdbcDriver2.testYarnATSGuid (batchId=222)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/7624/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/7624/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-7624/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 11 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12895551 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-11-04T03:29:13.196+0000","updated":"2017-11-04T03:29:13.196+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16245884","id":"16245884","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"Merged into branch-2.3","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-11-09T15:55:39.083+0000","updated":"2017-11-09T15:55:39.083+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13083959/comment/16486319","id":"16486319","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vgarg","name":"vgarg","key":"vgarg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vgarg&avatarId=30430","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vgarg&avatarId=30430","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vgarg&avatarId=30430","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vgarg&avatarId=30430"},"displayName":"Vineet Garg","active":true,"timeZone":"America/Los_Angeles"},"body":"Hive 3.0.0 has been released so closing this jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vgarg","name":"vgarg","key":"vgarg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vgarg&avatarId=30430","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vgarg&avatarId=30430","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vgarg&avatarId=30430","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vgarg&avatarId=30430"},"displayName":"Vineet Garg","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-05-23T00:00:07.789+0000","updated":"2018-05-23T00:00:07.789+0000"}],"maxResults":22,"total":22,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-17008/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3gzan:"}}