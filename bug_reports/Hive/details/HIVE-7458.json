{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12728545","self":"https://issues.apache.org/jira/rest/api/2/issue/12728545","key":"HIVE-7458","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2014-07-21T13:40:57.574+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 21 14:12:51 UTC 2014","customfield_12310420":"406621","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_696563_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-07-21T13:41:43.576+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7458/watchers","watchCount":2,"isWatching":false},"created":"2014-07-21T13:30:07.041+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-07-21T14:12:51.676+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12323200","id":"12323200","name":"Spark","description":"Hive on Spark"}],"timeoriginalestimate":null,"description":"I have Hive, MySQL and Spark. MySQL is Hive metastore_db. I follow this guide to configurate it (http://www.cloudera.com/content/cloudera-content/cloudera-docs/CDH4/4.2.0/CDH4-Installation-Guide/cdh4ig_topic_18_4.html). It is ok for me to do drop table command under hive shell environment. But when I enter into spark-shell env, I use hiveContext.hql(\"DROP TABLE IF EXISTS hivetesting\"). And then, I get following error:\nERROR Hive: NoSuchObjectException(message:default.hivetesting table not found)\nat org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$get_table_result$get_table_resultStandardScheme.read(ThriftHiveMetastore.java:27129)\nat org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$get_table_result$get_table_resultStandardScheme.read(ThriftHiveMetastore.java:27097)\nat org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$get_table_result.read(ThriftHiveMetastore.java:27028)\nat org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:78)\nat org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_get_table(ThriftHiveMetastore.java:936)\nat org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.get_table(ThriftHiveMetastore.java:922)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getTable(HiveMetaStoreClient.java:854)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:89)\nat com.sun.proxy.$Proxy11.getTable(Unknown Source)\nat org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:950)\n......\nI think when running under hive shell, it mutes this error. But under spark shell, hive doesn't mute this error and throw out error directly. So If the table doesn't exist, hive should not throw out error; it should throw out warning.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"406641","customfield_12312823":null,"summary":"Drop Hive Table If Exists Throw out Error by Spark","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haimei","name":"haimei","key":"haimei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=haimei&avatarId=20335","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=haimei&avatarId=20335","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=haimei&avatarId=20335","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=haimei&avatarId=20335"},"displayName":"Haimei Li","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haimei","name":"haimei","key":"haimei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=haimei&avatarId=20335","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=haimei&avatarId=20335","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=haimei&avatarId=20335","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=haimei&avatarId=20335"},"displayName":"Haimei Li","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Spark(1.0.1), Hive(0.13.1)","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728545/comment/14068522","id":"14068522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"Your are doing {{hiveContext.hql(\"DROP TABLE IF EXISTS hivetesting\")}} in Scala schell of the Spark project.\n\nWhat this shell is doing ? Query to remote metastore on non existing table (see on your provided stack).\nThe remote metastore throws {{NoSuchObjectException(message:default.hivetesting table not found)}} because Spark code call {{HiveMetaStoreClient.getTable(HiveMetaStoreClient.java:854)}} on non-existing table. It's the right behavior.\nYou should check on Spark code why a query is done on non existing table.\n\nI think Spark does not handle well the {{IF EXISTS}} part of this query. Maybe you could fill a ticket on Spark JIRA.\n\nBUT, it's *not a bug* in HIVE IMHO.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-07-21T13:40:57.574+0000","updated":"2014-07-21T13:40:57.574+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728545/comment/14068533","id":"14068533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haimei","name":"haimei","key":"haimei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=haimei&avatarId=20335","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=haimei&avatarId=20335","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=haimei&avatarId=20335","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=haimei&avatarId=20335"},"displayName":"Haimei Li","active":true,"timeZone":"Etc/UTC"},"body":"thanks, i will report to Spark ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haimei","name":"haimei","key":"haimei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=haimei&avatarId=20335","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=haimei&avatarId=20335","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=haimei&avatarId=20335","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=haimei&avatarId=20335"},"displayName":"Haimei Li","active":true,"timeZone":"Etc/UTC"},"created":"2014-07-21T13:50:29.211+0000","updated":"2014-07-21T13:50:29.211+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12728545/comment/14068551","id":"14068551","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"[~haimei] Glad to help ^^","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-07-21T14:12:51.676+0000","updated":"2014-07-21T14:12:51.676+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7458/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1xz13:"}}