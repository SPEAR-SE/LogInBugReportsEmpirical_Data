{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12863843","self":"https://issues.apache.org/jira/rest/api/2/issue/12863843","key":"HIVE-11812","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-11-02T12:12:05.348+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Oct 27 15:03:45 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11812/watchers","watchCount":12,"isWatching":false},"created":"2015-09-14T10:39:18.115+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":["timestamp"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"issuelinks":[{"id":"12518627","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12518627","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"13000517","key":"HIVE-14657","self":"https://issues.apache.org/jira/rest/api/2/issue/13000517","fields":{"summary":"datediff function produce different results with timestamp and string combination","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12481540","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12481540","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"13000517","key":"HIVE-14657","self":"https://issues.apache.org/jira/rest/api/2/issue/13000517","fields":{"summary":"datediff function produce different results with timestamp and string combination","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-10-27T15:03:45.441+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313585","id":"12313585","name":"UDF","description":"This includes the UDFs and UDAFs"}],"timeoriginalestimate":null,"description":"DATEDIFF returns an incorrect result when one of the arguments is a date type. \n\nThe Hive Language Manual provides the following signature for datediff:\n{code}\nint datediff(string enddate, string startdate)\n{code}\nI think datediff should either throw an error (if date types are not supported), or return the correct result.\n\nTo reproduce, create a table:\n{code}\ncreate table t (c1 string, c2 date);\n{code}\n\nAssuming you have a table x containing some data, populate table t with 1 row:\n{code}\ninsert into t select '2015-09-15', '2015-09-15' from x limit 1;\n{code}\n\nThen run the following 12 test queries:\n{code}\nselect datediff(c1, '2015-09-14') from t;\nselect datediff(c1, '2015-09-15') from t;\nselect datediff(c1, '2015-09-16') from t;\n\nselect datediff('2015-09-14', c1) from t;\nselect datediff('2015-09-15', c1) from t;\nselect datediff('2015-09-16', c1) from t;\n\nselect datediff(c2, '2015-09-14') from t;\nselect datediff(c2, '2015-09-15') from t;\nselect datediff(c2, '2015-09-16') from t;\n\nselect datediff('2015-09-14', c2) from t;\nselect datediff('2015-09-15', c2) from t;\nselect datediff('2015-09-16', c2) from t;\n{code}\n\nThe below table summarises the result. All results for column c1 (which is a string) are correct, but when using c2 (which is a date), two of the results are incorrect.\n|| Test || Expected Result || Actual Result || Passed / Failed ||\n|datediff(c1, '2015-09-14')| 1 | 1| Passed |\n|datediff(c1, '2015-09-15')| 0 | 0| Passed |\n|datediff(c1, '2015-09-16') | -1 | -1| Passed |\n|datediff('2015-09-14', c1) | -1 | -1| Passed |\n|datediff('2015-09-15', c1)| 0 | 0| Passed |\n|datediff('2015-09-16', c1)| 1 | 1| Passed |\n|datediff(c2, '2015-09-14')| 1 | 0| {color:red}Failed{color} |\n|datediff(c2, '2015-09-15')| 0 | 0| Passed |\n|datediff(c2, '2015-09-16') | -1 | -1| Passed |\n|datediff('2015-09-14', c2) | -1 | 0 | {color:red}Failed{color} |\n|datediff('2015-09-15', c2)| 0 | 0| Passed |\n|datediff('2015-09-16', c2)| 1 | 1| Passed |","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12830654","id":"12830654","filename":"HIVE-11812.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2016-09-28T08:11:52.251+0000","size":2484,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12830654/HIVE-11812.1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"datediff sometimes returns incorrect results when called with dates","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nbrenwald","name":"nbrenwald","key":"nbrenwald","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nicholas Brenwald","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/14985125","id":"14985125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"I am able to reproduce the issue with given steps. More details are:\n1) Issue occurs only with 'date' datatype.\n2) Issue is only with dates with difference less than 0. i.e all smaller dates. \n3) datediff() function is returning (expected_result + 1)  in all wrong cases. sample test queries below:\n      {{select datediff(c2, '2015-09-13') from t;}} --> returned -1 expected -2\n      {{select datediff(c2, '2015-09-12') from t;}} --> returned -2 expected -3\n\nI am debugging it further. Seems issue with converter, I have tested {{evaluate(Date date, Date date2)}} method, its working fine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-11-02T12:12:05.348+0000","updated":"2015-11-02T12:12:05.348+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/14985298","id":"14985298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"Seems I don't have permissions to edit my own comments. So replying here to correct a mistake.\n\n3) datediff() function is returning (expected_result - 1) in all wrong cases . sample test queries below:\nselect datediff(c2, '2015-09-13') from t; --> returned 1 expected 2\nselect datediff(c2, '2015-09-12') from t; --> returned 2 expected 3\nAnd (expected_result+1) in following cases:\nselect datediff('2015-09-13', c2) from t; --> returned -1 expected -2\nselect datediff('2015-09-12', c2) from t; --> returned -2 expected -3","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-11-02T14:40:18.127+0000","updated":"2015-11-02T14:40:18.127+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15398085","id":"15398085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=richkoby33","name":"richkoby33","key":"richkoby33","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rich Kobylinski","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for working on this.  Is there an estimated expectation of completion (date, Hive version) on this issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=richkoby33","name":"richkoby33","key":"richkoby33","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rich Kobylinski","active":true,"timeZone":"Etc/UTC"},"created":"2016-07-28T19:29:15.352+0000","updated":"2016-07-28T19:29:15.352+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15528773","id":"15528773","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"Debugged this issue, issue exists because of {code}result.set((int) (diffInMilliSeconds / (86400 * 1000)));{code} line of code. Integer division is the issue, will need to round up division to get correct result. So replacing above line of code with following :\n{code}result.set((int) Math.round((double) diffInMilliSeconds / (86400 * 1000)));{code} .","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2016-09-28T07:53:26.717+0000","updated":"2016-09-28T07:53:26.717+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15528828","id":"15528828","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"Please review the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2016-09-28T08:11:52.255+0000","updated":"2016-09-28T08:11:52.255+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15530156","id":"15530156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12830654/HIVE-11812.1.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 10645 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_mapjoin]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ctas]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[date_udf]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[timestamp_udf]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_join_part_col_char]\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[vectorized_date_funcs]\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3]\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[date_udf]\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[timestamp_udf]\norg.apache.hadoop.hive.metastore.TestMetaStoreMetrics.testMetaDataCounts\norg.apache.hive.jdbc.TestJdbcWithMiniHS2.testAddJarConstructorUnCaching\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/1331/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/1331/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-Build-1331/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 11 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12830654 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-09-28T16:31:09.000+0000","updated":"2016-09-28T16:31:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15530549","id":"15530549","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"body":"The added test in TestGenericUDFDateDiff.testDateDiffEvaluate() does not actually fail for me on Hive master .. what time zone are you running these tests?\n\nAlso there are a number of existing .q file tests failing here. For date_udf looks like the expected output is incorrect and needs to be regenerated, but for timestamp_udf and vectorized_date_funcs I think the expected results are correct, and the patch seems to have broken them.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-28T19:01:15.001+0000","updated":"2016-09-28T19:01:15.001+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15532050","id":"15532050","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"[~jdere]: I am running test in India Time Zone.\nYes the tests are working fine in IST zone, but failing in other.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2016-09-29T07:38:43.064+0000","updated":"2016-09-29T07:38:43.064+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15534684","id":"15534684","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"body":"Ok. So there may be some additional investigation required here, to get this working in all timezones.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-30T01:22:45.320+0000","updated":"2016-09-30T01:22:45.320+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15534688","id":"15534688","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=richkoby33","name":"richkoby33","key":"richkoby33","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rich Kobylinski","active":true,"timeZone":"Etc/UTC"},"body":"I am out of the office Friday September 30, returning Monday.\n\nPlease contact Claire Spettell 860-273-9791 with issues that require immediate response.\n\nThis e-mail may contain confidential or privileged information. If you think you have received this e-mail in error, please advise the sender by reply e-mail and then delete this e-mail immediately. Thank you.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=richkoby33","name":"richkoby33","key":"richkoby33","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rich Kobylinski","active":true,"timeZone":"Etc/UTC"},"created":"2016-09-30T01:23:40.927+0000","updated":"2016-09-30T01:23:40.927+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15689998","id":"15689998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"[~chetna] Are you actively working on re-working the patch as there seem to be a bit more work to be done? I am just trying to estimate when this might get committed so we could provide it to a customer of ours. Thanks a bunch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-11-23T12:41:26.544+0000","updated":"2016-11-23T12:41:26.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15723733","id":"15723733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shyamsunderrai","name":"shyamsunderrai","key":"shyamsunderrai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shyam Sunder Rai","active":true,"timeZone":"Etc/UTC"},"body":"To all the Gurus here, I made a change locally to my code and the datediff function with the test cases given above (in PST) seems to be working correctly for me with all the anticipated results. Can someone help me out on how we are testing it with different timezones ? I performed the test in the following way and am getting the results as expected after my changes.\n\n{code}\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c1, \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-14', \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c1, \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-15', \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c1, \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-16', \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\n\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-14', \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c1, \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-15', \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c1, \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-16', \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c1, \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\n\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c2, \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-14', \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c2, \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-15', \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c2, \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-16', \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\n\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-14', \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c2, \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-15', \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c2, \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\nSELECT datediff(TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP('2015-09-16', \"yyyy-MM-dd\") * 1000, 'EST')), TO_DATE(FROM_UTC_TIMESTAMP(UNIX_TIMESTAMP(t.c2, \"yyyy-MM-dd\") * 1000, 'EST'))) FROM t;\n{code}\n\nTried these changes with multiple timezones to try variations, including IST. The server itself is on PST. \n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shyamsunderrai","name":"shyamsunderrai","key":"shyamsunderrai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shyam Sunder Rai","active":true,"timeZone":"Etc/UTC"},"created":"2016-12-05T23:33:20.315+0000","updated":"2016-12-05T23:34:09.212+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15723775","id":"15723775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sershe","name":"sershe","key":"sershe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Shelukhin","active":true,"timeZone":"America/Los_Angeles"},"body":"See TestDateWritable::testDaylightSavingsTime for an example of how to make a test that covers all timezones (supported on a given system, at least).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sershe","name":"sershe","key":"sershe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Shelukhin","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-05T23:50:26.537+0000","updated":"2016-12-05T23:50:26.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15725058","id":"15725058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12830654/HIVE-11812.1.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 15 failed/errored test(s), 10769 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_sortmerge_join_2] (batchId=44)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[date_udf] (batchId=28)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[timestamp_udf] (batchId=71)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=134)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=150)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_date_funcs] (batchId=150)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=92)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[date_udf] (batchId=106)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[timestamp_udf] (batchId=127)\norg.apache.hive.jdbc.TestJdbcWithLocalClusterSpark.testTempTable (batchId=215)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/2437/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/2437/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-2437/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 15 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12830654 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-12-06T10:34:47.014+0000","updated":"2016-12-06T10:34:47.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15729429","id":"15729429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"Interesting I'm working with Jason on a DATEDIFF fix in https://issues.apache.org/jira/browse/HIVE-15338 that is probably the same problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2016-12-07T18:07:46.440+0000","updated":"2016-12-07T18:07:46.440+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/15730478","id":"15730478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"body":"Ok, I think the issue is the fact that the date formatter is using UTC timezone when parsing dates from string. I believe this allows results to work correctly when both parameters are of string type, but i think this messes up results when the one parameter is of string/char/varchar type and the other is date/timestamp, because the date/timestamp value will have a millis result based on the date for the local timezone. I believe [~mmccline]'s patch for HIVE-15338 may be able to handle this properly since it is parsing dates using the local timezone (to match Date/Timestamp type), and will be using dateToDays() (which hopefully works correctly, otherwise this may need fixes), rather than trying to do some milliseconds-to-days conversion here in the UDF.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-08T00:48:55.920+0000","updated":"2016-12-08T00:48:55.920+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/16221453","id":"16221453","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~jdere], [~mmccline], [~chetna], was this solved with HIVE-15338?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-10-26T23:34:53.999+0000","updated":"2017-10-26T23:45:52.857+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/16221463","id":"16221463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"[~jcamachorodriguez] [~jdere] Yes, I believe so.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2017-10-26T23:42:52.058+0000","updated":"2017-10-26T23:42:52.058+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12863843/comment/16222515","id":"16222515","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12830654/HIVE-11812.1.patch\n\n{color:red}ERROR:{color} -1 due to build exiting with an error\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/7505/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/7505/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-7505/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nTests exited with: NonZeroExitCodeException\nCommand 'bash /data/hiveptest/working/scratch/source-prep.sh' failed with exit status 1 and output '+ date '+%Y-%m-%d %T.%3N'\n2017-10-27 15:03:40.083\n+ [[ -n /usr/lib/jvm/java-8-openjdk-amd64 ]]\n+ export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64\n+ JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64\n+ export PATH=/usr/lib/jvm/java-8-openjdk-amd64/bin/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+ PATH=/usr/lib/jvm/java-8-openjdk-amd64/bin/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+ export 'ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m '\n+ ANT_OPTS='-Xmx1g -XX:MaxPermSize=256m '\n+ export 'MAVEN_OPTS=-Xmx1g '\n+ MAVEN_OPTS='-Xmx1g '\n+ cd /data/hiveptest/working/\n+ tee /data/hiveptest/logs/PreCommit-HIVE-Build-7505/source-prep.txt\n+ [[ false == \\t\\r\\u\\e ]]\n+ mkdir -p maven ivy\n+ [[ git = \\s\\v\\n ]]\n+ [[ git = \\g\\i\\t ]]\n+ [[ -z master ]]\n+ [[ -d apache-github-source-source ]]\n+ [[ ! -d apache-github-source-source/.git ]]\n+ [[ ! -d apache-github-source-source ]]\n+ date '+%Y-%m-%d %T.%3N'\n2017-10-27 15:03:40.085\n+ cd apache-github-source-source\n+ git fetch origin\n+ git reset --hard HEAD\nHEAD is now at 88bd58e HIVE-17764 : alter view fails when hive.metastore.disallow.incompatible.col.type.changes set to true (Janaki Lahorani, reviewed by Andrew Sherman and Vihang Karajgaonkar) (addendum)\n+ git clean -f -d\nRemoving standalone-metastore/src/gen/org/\n+ git checkout master\nAlready on 'master'\nYour branch is up-to-date with 'origin/master'.\n+ git reset --hard origin/master\nHEAD is now at 88bd58e HIVE-17764 : alter view fails when hive.metastore.disallow.incompatible.col.type.changes set to true (Janaki Lahorani, reviewed by Andrew Sherman and Vihang Karajgaonkar) (addendum)\n+ git merge --ff-only origin/master\nAlready up-to-date.\n+ date '+%Y-%m-%d %T.%3N'\n2017-10-27 15:03:44.874\n+ patchCommandPath=/data/hiveptest/working/scratch/smart-apply-patch.sh\n+ patchFilePath=/data/hiveptest/working/scratch/build.patch\n+ [[ -f /data/hiveptest/working/scratch/build.patch ]]\n+ chmod +x /data/hiveptest/working/scratch/smart-apply-patch.sh\n+ /data/hiveptest/working/scratch/smart-apply-patch.sh /data/hiveptest/working/scratch/build.patch\nerror: a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFDateDiff.java: No such file or directory\nerror: a/ql/src/test/org/apache/hadoop/hive/ql/udf/generic/TestGenericUDFDateDiff.java: No such file or directory\nThe patch does not appear to apply with p0, p1, or p2\n+ exit 1\n'\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12830654 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-10-27T15:03:45.441+0000","updated":"2017-10-27T15:03:45.441+0000"}],"maxResults":19,"total":19,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11812/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2k4nr:"}}