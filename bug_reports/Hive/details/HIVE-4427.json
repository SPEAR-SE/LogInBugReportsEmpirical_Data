{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12644893","self":"https://issues.apache.org/jira/rest/api/2/issue/12644893","key":"HIVE-4427","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-04-28T19:14:15.386+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 01 07:56:20 UTC 2013","customfield_12310420":"325255","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4427/watchers","watchCount":3,"isWatching":false},"created":"2013-04-26T18:01:06.811+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":"SemanticAnalyzer","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":86400,"aggregatetimeoriginalestimate":86400,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-07-01T07:56:20.752+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":86400,"description":"In SemanticAnalyzer offline tables throw a SemanticException before validate() is called.  This is unnecessary, since all appropriate checks are run within the validate method, and is a bug because it throws exceptions with a null context (preventing custom offline error messages via hooks).","customfield_10010":null,"timetracking":{"originalEstimate":"24h","remainingEstimate":"24h","originalEstimateSeconds":86400,"remainingEstimateSeconds":86400},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580899","id":"12580899","filename":"HIVE-4427.D10599.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-28T19:14:15.493+0000","size":1129,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12580899/HIVE-4427.D10599.1.patch"}],"aggregatetimeestimate":86400,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"325600","customfield_12312823":null,"summary":"SemanticAnalyzer throws OFFLINE_TABLE_OR_PARTITION exceptions with null context.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":86400,"percent":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":"2013-04-30","customfield_12310250":null,"progress":{"progress":0,"total":86400,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644893/comment/13644090","id":"13644090","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"body":"Patch submitted via phabricator.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-28T19:13:30.652+0000","updated":"2013-04-28T19:13:30.652+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644893/comment/13644091","id":"13644091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"body":"https://reviews.facebook.net/D10599","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mrrrgn","name":"mrrrgn","key":"mrrrgn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mrrrgn&avatarId=16806","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mrrrgn&avatarId=16806","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mrrrgn&avatarId=16806","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mrrrgn&avatarId=16806"},"displayName":"Morgan Phillips","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-28T19:13:42.361+0000","updated":"2013-04-28T19:13:42.361+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644893/comment/13644092","id":"13644092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"Mrrrgn requested code review of \"HIVE-4427 [jira] SemanticAnalyzer throws OFFLINE_TABLE_OR_PARTITION exceptions with null context.\".\n\nReviewers: JIRA\n\nRemoved unnecessary table.isOffline check happening outside of SemanticAnalyzer.validate() to fix null hook contexts and allow custom offline error messages (via hooks) at a partition level.\n\nIn SemanticAnalyzer offline tables throw a SemanticException before validate() is called.  This is unnecessary, since all appropriate checks are run within the validate method, and is a bug because it throws exceptions with a null context (preventing custom offline error messages via hooks).\n\nTEST PLAN\n  Modified a SemanticAnalyzerHook to dump the line number or SemanticAnalyazer.java where an Exception was thrown.  When calling an offline partition in an offline table, before my changes, exceptions were thrown outside of the validate() method.  After my changes exceptions were thrown from within\n  the validate method.  To further verify that the exceptions were correct, I dumped the error message and context to verfity that the exception messages were of type OFFLINE_TABLE_OR_PARTITION and that the HookContext was not null.  After my changes proper errors were indeed thrown, with appropriate contexts.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10599\n\nAFFECTED FILES\n  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n\nMANAGE HERALD RULES\n  https://reviews.facebook.net/herald/view/differential/\n\nWHY DID I GET THIS EMAIL?\n  https://reviews.facebook.net/herald/transcript/25359/\n\nTo: JIRA, Mrrrgn\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-28T19:14:15.386+0000","updated":"2013-04-28T19:14:15.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644893/comment/13650287","id":"13650287","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"kevinwilfong has commented on the revision \"HIVE-4427 [jira] SemanticAnalyzer throws OFFLINE_TABLE_OR_PARTITION exceptions with null context.\".\n\n  It looks like the revision that added this code did not add a proper testcase for it, based on what the comments say it's trying to achieve.\n\n  http://svn.apache.org/viewvc?view=revision&revision=982476\n\n  Could you add a testcase where you attempt to select from an offline table with no partitions or where all partitions are filtered and verify it fails rather than returning no results?\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10599\n\nTo: JIRA, kevinwilfong, sindheeraj, Mrrrgn\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-07T00:28:14.027+0000","updated":"2013-05-07T00:28:14.027+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644893/comment/13650358","id":"13650358","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"Mrrrgn has commented on the revision \"HIVE-4427 [jira] SemanticAnalyzer throws OFFLINE_TABLE_OR_PARTITION exceptions with null context.\".\n\n  @kevinwilfong, Sorry about the lack of a test.  I'll submit another diff after I've written one.  :)\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10599\n\nTo: JIRA, kevinwilfong, sindheeraj, Mrrrgn\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-07T01:47:15.203+0000","updated":"2013-05-07T01:47:15.203+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644893/comment/13696640","id":"13696640","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mrrrgn] Feel free to mark jira as Patch Available, once you have added the test case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-01T07:56:20.750+0000","updated":"2013-07-01T07:56:20.750+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4427/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1k44n:"}}