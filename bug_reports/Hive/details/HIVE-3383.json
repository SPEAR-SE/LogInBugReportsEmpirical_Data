{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12603402","self":"https://issues.apache.org/jira/rest/api/2/issue/12603402","key":"HIVE-3383","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324986","id":"12324986","description":"released","name":"0.13.0","archived":false,"released":true,"releaseDate":"2014-04-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-12-13T05:08:03.485+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Dec 24 01:32:46 UTC 2014","customfield_12310420":"259220","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_74452713084_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-12-24T01:32:46.137+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3383/watchers","watchCount":2,"isWatching":false},"created":"2012-08-14T08:14:13.149+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-12-24T01:32:46.218+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312590","id":"12312590","name":"Testing Infrastructure","description":"Tracks issues with tests and testing infrastructure."}],"timeoriginalestimate":null,"description":"I ran \n{code} \nant clean package test -Dtestcase=TestMinimrCliDriver -Dhadoop.mr.rev=20S\n{code}\nThis hangs after printing following on console:\n{code}\ntest:\n    [junit] WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.\n    [junit] Starting DataNode 0 with dfs.data.dir: build/test/data/dfs/data/data1,build/test/data/dfs/data/data2\n    [junit] Starting DataNode 1 with dfs.data.dir: build/test/data/dfs/data/data3,build/test/data/dfs/data/data4\n    [junit] Starting DataNode 2 with dfs.data.dir: build/test/data/dfs/data/data5,build/test/data/dfs/data/data6\n    [junit] Starting DataNode 3 with dfs.data.dir: build/test/data/dfs/data/data7,build/test/data/dfs/data/data8\n    [junit] Generating rack names for tasktrackers\n    [junit] Generating host names for tasktrackers\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"124470","customfield_12312823":null,"summary":"MinimrCliDriver test hangs when run on 20S (aka 1.0) hadoop profile","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12603402/comment/13433995","id":"13433995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I collected stack traces multiple times while test was in hang state. I always found main thread in following stack:\n{code}\n\"main\" prio=10 tid=0x08800000 nid=0x52cf waiting on condition [0xf72fa000]\n   java.lang.Thread.State: TIMED_WAITING (sleeping)\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.hadoop.mapred.MiniMRCluster.startJobTracker(MiniMRCluster.java:638)\n\tat org.apache.hadoop.mapred.MiniMRCluster.startJobTracker(MiniMRCluster.java:609)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:507)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:462)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:454)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:446)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:436)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:426)\n\tat org.apache.hadoop.mapred.MiniMRCluster.<init>(MiniMRCluster.java:417)\n\tat org.apache.hadoop.hive.ql.QTestUtil.<init>(QTestUtil.java:278)\n\tat org.apache.hadoop.hive.cli.TestMinimrCliDriver.<clinit>(TestMinimrCliDriver.java:51)\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:169)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:373)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1052)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:906)\n{code}\n\nWhats happening here is JobTracker is in wait state (forever). Further analysis showed that JT makes an RPC call to NN, NN is trying to load a class which it fails to find and then keep on throwing ClassNotFoundException. Then DFSClient (embedded in JT) keeps on retrying and system remains in hang state. Fix is to download the missing jar file (http://mirrors.ibiblio.org/pub/mirrors/maven2/javax/ws/rs/jsr311-api/1.0/jsr311-api-1.0.jar) and place it in ivy/lib/default dir after compilation but before starting test run. I am not sure whether its a bug in a hive build system wherein it should download this jar file or in hadoop build system, where it should have declared this jar as its dependency in its pom file, so that downstream project will pull in this jar while pulling in hadoop and its dependency. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-14T08:31:31.622+0000","updated":"2012-08-14T08:31:31.622+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12603402/comment/13530682","id":"13530682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mgrover","name":"mgrover","key":"mgrover","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mark Grover","active":true,"timeZone":"America/Los_Angeles"},"body":"I ran into the same problem today with simple {{ant test}} on trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mgrover","name":"mgrover","key":"mgrover","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mark Grover","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-12-13T05:08:03.485+0000","updated":"2012-12-13T05:08:03.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12603402/comment/14257793","id":"14257793","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"If i remember correctly, problem was because of incorrect pom files published by hadoop because of which hive was not downloading correct jars. This has been fixed in subsequent hadoop releases which Hive has upgraded to.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-24T01:32:46.191+0000","updated":"2014-12-24T01:32:46.191+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3383/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lnkv:"}}