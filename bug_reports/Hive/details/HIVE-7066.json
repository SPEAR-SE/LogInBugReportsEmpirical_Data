{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12714343","self":"https://issues.apache.org/jira/rest/api/2/issue/12714343","key":"HIVE-7066","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-05-15T13:42:41.417+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 13 19:44:00 UTC 2014","customfield_12310420":"392656","customfield_12312320":null,"customfield_12310222":"3_*:*_2_*:*_316967_*|*_10002_*:*_1_*:*_596254970_*|*_1_*:*_2_*:*_1832729_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-05-21T21:18:44.816+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7066/watchers","watchCount":5,"isWatching":false},"created":"2014-05-14T23:05:20.195+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324986","id":"12324986","description":"released","name":"0.13.0","archived":false,"released":true,"releaseDate":"2014-04-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326829","id":"12326829","description":"0.13 maintenance release 1","name":"0.13.1","archived":false,"released":true,"releaseDate":"2014-06-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-11-13T19:44:00.860+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312593","id":"12312593","name":"Build Infrastructure","description":"Tracks issues with build files."}],"timeoriginalestimate":null,"description":"Running a simple query that reads an Avro table caused the following exception to be thrown on the cluster side:\n\n{code}\njava.lang.RuntimeException: org.apache.hive.com.esotericsoftware.kryo.KryoException: java.lang.IllegalArgumentException: Unable to create serializer \"org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer\" for class: org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat\nSerialization trace:\noutputFileFormatClass (org.apache.hadoop.hive.ql.plan.PartitionDesc)\naliasToPartnInfo (org.apache.hadoop.hive.ql.plan.MapWork)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.getBaseWork(Utilities.java:365)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.getMapWork(Utilities.java:276)\n\tat org.apache.hadoop.hive.ql.io.HiveInputFormat.init(HiveInputFormat.java:254)\n\tat org.apache.hadoop.hive.ql.io.HiveInputFormat.pushProjectionsAndFilters(HiveInputFormat.java:445)\n\tat org.apache.hadoop.hive.ql.io.HiveInputFormat.pushProjectionsAndFilters(HiveInputFormat.java:438)\n\tat org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getRecordReader(CombineHiveInputFormat.java:587)\n\tat org.apache.hadoop.mapred.MapTask$TrackedRecordReader.<init>(MapTask.java:191)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:412)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:366)\n\tat org.apache.hadoop.mapred.Child$4.run(Child.java:255)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:394)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1190)\n\tat org.apache.hadoop.mapred.Child.main(Child.java:249)\nCaused by: org.apache.hive.com.esotericsoftware.kryo.KryoException: java.lang.IllegalArgumentException: Unable to create serializer \"org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer\" for class: org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat\nSerialization trace:\noutputFileFormatClass (org.apache.hadoop.hive.ql.plan.PartitionDesc)\naliasToPartnInfo (org.apache.hadoop.hive.ql.plan.MapWork)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:507)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:776)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:139)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:17)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:694)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:507)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:672)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.deserializeObjectByKryo(Utilities.java:942)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.deserializePlan(Utilities.java:850)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.deserializePlan(Utilities.java:864)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.getBaseWork(Utilities.java:334)\n\t... 13 more\nCaused by: java.lang.IllegalArgumentException: Unable to create serializer \"org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer\" for class: org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat\n\tat org.apache.hive.com.esotericsoftware.kryo.factories.ReflectionSerializerFactory.makeSerializer(ReflectionSerializerFactory.java:45)\n\tat org.apache.hive.com.esotericsoftware.kryo.factories.ReflectionSerializerFactory.makeSerializer(ReflectionSerializerFactory.java:26)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.newDefaultSerializer(Kryo.java:343)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.getDefaultSerializer(Kryo.java:336)\n\tat org.apache.hive.com.esotericsoftware.kryo.util.DefaultClassResolver.registerImplicit(DefaultClassResolver.java:56)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.getRegistration(Kryo.java:476)\n\tat org.apache.hive.com.esotericsoftware.kryo.util.DefaultClassResolver.readName(DefaultClassResolver.java:148)\n\tat org.apache.hive.com.esotericsoftware.kryo.util.DefaultClassResolver.readClass(DefaultClassResolver.java:115)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.readClass(Kryo.java:656)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.DefaultSerializers$ClassSerializer.read(DefaultSerializers.java:238)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.DefaultSerializers$ClassSerializer.read(DefaultSerializers.java:226)\n\tat org.apache.hive.com.esotericsoftware.kryo.Kryo.readObjectOrNull(Kryo.java:745)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:113)\n\t... 25 more\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.hive.com.esotericsoftware.kryo.factories.ReflectionSerializerFactory.makeSerializer(ReflectionSerializerFactory.java:32)\n\t... 37 more\nCaused by: java.lang.NoClassDefFoundError: org/apache/avro/io/DatumWriter\n\tat java.lang.Class.getDeclaredFields0(Native Method)\n\tat java.lang.Class.privateGetDeclaredFields(Class.java:2348)\n\tat java.lang.Class.getDeclaredFields(Class.java:1779)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer.rebuildCachedFields(FieldSerializer.java:150)\n\tat org.apache.hive.com.esotericsoftware.kryo.serializers.FieldSerializer.<init>(FieldSerializer.java:109)\n\t... 42 more\nCaused by: java.lang.ClassNotFoundException: org.apache.avro.io.DatumWriter\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:202)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:190)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:247)\n\t... 47 more\n{code}\n\nI took a look at the hive-exec jar and found that the Avro core jar was not included, though avro-mapred is included.\n\nI confirmed that Avro core was included in the Hive 0.12 hive-exec jar. Was there a reason why this was removed in trunk? It seems that this would break the AvroSerDe.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12644913","id":"12644913","filename":"HIVE-7066.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-14T23:36:24.195+0000","size":887,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12644913/HIVE-7066.1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"392836","customfield_12312823":null,"summary":"hive-exec jar is missing avro core","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/13998274","id":"13998274","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"I have posted a patch for a fix. I have tested this on trunk by confirming that Avro core is in the hive-exec jar and successfully running a simple Hive query against a table registered with the AvroSerDe. The fix was a simple 1 line change. It looks like this issue was caused by the Ant -> Maven switch and the avro core jar was inadvertently left out when creating the hive-exec  jar.\n\nI am not able to create an RB right now because RB is giving me a 502 error when I try to create a new review request, both using {{rbt post}} and manually via the RB web UI. I will try to create a RB later. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-14T23:41:05.202+0000","updated":"2014-05-14T23:41:05.202+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/13998278","id":"13998278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"RB: https://reviews.apache.org/r/21471","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-14T23:47:10.608+0000","updated":"2014-05-14T23:47:10.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/13998771","id":"13998771","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the patch. What query are you running that demonstrates the problem? Recently I worked on HIVE-5823, and didn't hit the problem you described. I'd like to reproduce the problem in order to verify your fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-15T13:42:41.417+0000","updated":"2014-05-15T13:42:41.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/13999251","id":"13999251","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 no tests executed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12644913/HIVE-7066.1.patch\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/204/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/204/console\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12644913","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-05-15T21:02:13.962+0000","updated":"2014-05-15T21:02:13.962+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14000456","id":"14000456","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Xuefu, I simply ran {{select count(1) from avro-table;}}. I ran {{mvn clean install -DskipTests -Phadoop-1 -Pdist}} to build Hive, create the tarball, unzipped it and set up a local metastore and ran the query.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-16T23:00:37.596+0000","updated":"2014-05-16T23:00:37.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14002601","id":"14002601","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"[~xuefuz], were you able to reproduce the problem? Do you have any more feedback on this patch before it can be merged?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-19T23:53:32.662+0000","updated":"2014-05-19T23:53:32.662+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14003576","id":"14003576","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~davidzchen] I ran your mvn command and built a tarball. I unzipped it, and found in the lib directory there is a jar named avro-1.7.5.jar. Is this what you need? I thought all jars under /lib will be shipped to the cluster. BTW, I was able to run avro query from this build, though my cluster may already have the avro jar.\n\nYour change seems to shade the avro jar in Hive libexec jar, but the JIRA's title mentiones avro-mapred. I'm little confused.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-20T16:20:03.076+0000","updated":"2014-05-20T16:20:03.076+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14003871","id":"14003871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"[~xuefuz] Sorry for the confusion. The title should be referring to avro core and not avro-mapred. avro-mapred is already included but avro core is not.\n\nFrom what I understand, only the hive-exec jar is shipped to the cluster. The jars under /lib are used by Hive locally before firing the MapReduce jobs. If your cluster already has the Avro jar, then the query would work. In this case, I was simply running a local instance; further, we do not install Avro on each node but rather expect jobs to provide the jars. Based on the testing that I have done, if avro core is not present in the hive-exec jar, then queries that read tables registered with the AvroSerDe fails with the above exception.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidzchen","name":"davidzchen","key":"davidzchen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-20T19:32:37.016+0000","updated":"2014-05-20T19:32:37.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14003993","id":"14003993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Okay. +1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-20T21:23:13.887+0000","updated":"2014-05-20T21:23:13.887+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14005251","id":"14005251","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cwsteinbach","name":"cwsteinbach","key":"cwsteinbach","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Carl Steinbach","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed to trunk. Thanks David!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cwsteinbach","name":"cwsteinbach","key":"cwsteinbach","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Carl Steinbach","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-21T21:18:44.847+0000","updated":"2014-05-21T21:18:44.847+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714343/comment/14211077","id":"14211077","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"body":"This has been fixed in 0.14 release. Please open new jira if you see any issues.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-13T19:44:00.851+0000","updated":"2014-11-13T19:44:00.851+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7066/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1vmav:"}}