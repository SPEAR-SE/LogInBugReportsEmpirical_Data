{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12776600","self":"https://issues.apache.org/jira/rest/api/2/issue/12776600","key":"HIVE-9745","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-02-21T01:56:29.335+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Feb 21 15:20:38 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9745/watchers","watchCount":2,"isWatching":false},"created":"2015-02-21T01:04:17.864+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-02-21T15:20:38.325+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315100","id":"12315100","name":"SQL","description":"Issues related to Hive Query Language and its conformance with ANSI SQL."}],"timeoriginalestimate":null,"description":"The following query should return 5 rows but Hive returns 3\n\n{code}\nselect rnum, tchar.cchar from tchar where not (  tchar.cchar = ' ' or ( tchar.cchar is null and ' ' is null ))\n{code}\nConsider the following project of the base table\n\n{code}\nselect rnum, tchar.cchar, \ncase tchar.cchar when ' ' then 'space' else 'not space' end, \ncase when tchar.cchar is null then 'is null' else 'not null' end, case when ' ' is null then 'is null' else 'not null' end\nfrom tchar\norder by rnum\n{code}\nRow 0 is a NULL\nRow 1 was loaded with a zero length string ''\nRow 2 was loaded with a single space ' '\n{code}\nrnum\ttchar.cchar\t_c2\t_c3\t_c4\n0\t<null>\tnot space\tis null\tnot null\n1\t                                \tnot space\tnot null\tnot null\n2\t                                \tnot space\tnot null\tnot null\n3\tBB                              \tnot space\tnot null\tnot null\n4\tEE                              \tnot space\tnot null\tnot null\n5\tFF                              \tnot space\tnot null\tnot null\n{code}\nExplicitly type cast the literal which many  SQL developers would not expect need to do.\n{code}\nselect rnum, tchar.cchar, \ncase tchar.cchar when cast(' ' as char(1)) then 'space' else 'not space' end, \ncase when tchar.cchar is null then 'is null' else 'not null' end, case when cast( ' ' as char(1)) is null then 'is null' else 'not null' end\nfrom tchar\norder by rnum\n\nrnum\ttchar.cchar\t_c2\t_c3\t_c4\n0\t<null>\tnot space\tis null\tnot null\n1\t                                \tspace\tnot null\tnot null\n2\t                                \tspace\tnot null\tnot null\n3\tBB                              \tnot space\tnot null\tnot null\n4\tEE                              \tnot space\tnot null\tnot null\n5\tFF                              \tnot space\tnot null\tnot null\n\n\ncreate table  if not exists T_TCHAR ( RNUM int , CCHAR char(32 )    )\nROW FORMAT DELIMITED FIELDS TERMINATED BY '|' LINES TERMINATED BY '\\n' \n STORED AS TEXTFILE  ;\n\n0|\\N\n1|\n2| \n3|BB\n4|EE\n5|FF\n\n\ncreate table  if not exists TCHAR ( RNUM int , CCHAR char(32 )    )\n STORED AS orc  ;\n\ninsert overwrite table TCHAR select * from  T_TCHAR;\n{code}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"predicate evaluation of character fields with spaces and literals with spaces returns unexpected result","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12776600/comment/14329913","id":"14329913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"body":"This is unfortunately due to the fact that string literals in Hive type string, whereas most other databases treat them as of type char. When comparing string to char, both sides are converted to string before comparison, where trailing spaces are stripped when converting from char to string, and trailing spaces are significant during string comparison.\n\nIt would have been nice to have been able to change string literals to become char type, but this would have meant changing a pretty fundamental behavior in Hive, and I'm not really sure what the consequences would be here.\n\nAs you have already noticed, one solution is to cast string literals to char. Another option that might work here is to strip trailing whitespace from the string literals.\n\nAs with HIVE-9537, better documentation would probably be helpful here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-02-21T01:56:29.335+0000","updated":"2015-02-21T01:56:29.335+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12776600/comment/14330279","id":"14330279","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"body":"Turns out I added similar comments in 2013 to HIVE-3745 where references were drawn to MySQL/Postgres in that thread etc.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"created":"2015-02-21T15:20:38.325+0000","updated":"2015-02-21T15:20:38.325+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9745/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i25vtj:"}}