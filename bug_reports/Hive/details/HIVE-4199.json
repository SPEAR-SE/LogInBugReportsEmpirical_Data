{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12637603","self":"https://issues.apache.org/jira/rest/api/2/issue/12637603","key":"HIVE-4199","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-03-18T21:29:13.555+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Apr 09 22:26:15 UTC 2013","customfield_12310420":"318083","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4199/watchers","watchCount":2,"isWatching":false},"created":"2013-03-18T18:34:43.459+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sxyuan","name":"sxyuan","key":"sxyuan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Samuel Yuan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-17T16:41:17.298+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320633","id":"12320633","name":"File Formats","description":"File Formats"}],"timeoriginalestimate":null,"description":"StringTreeWriter currently converts fields stored as Text objects into Strings. This can lose information (see http://en.wikipedia.org/wiki/Replacement_character#Replacement_character), and is also unnecessary since the dictionary stores Text objects.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12574230","id":"12574230","filename":"HIVE-4199.HIVE-4199.HIVE-4199.D9501.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-18T21:29:13.656+0000","size":5744,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12574230/HIVE-4199.HIVE-4199.HIVE-4199.D9501.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12574231","id":"12574231","filename":"HIVE-4199.HIVE-4199.HIVE-4199.D9501.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-18T21:33:14.427+0000","size":5791,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12574231/HIVE-4199.HIVE-4199.HIVE-4199.D9501.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12574234","id":"12574234","filename":"HIVE-4199.HIVE-4199.HIVE-4199.D9501.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-18T21:45:14.134+0000","size":5540,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12574234/HIVE-4199.HIVE-4199.HIVE-4199.D9501.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12575960","id":"12575960","filename":"HIVE-4199.HIVE-4199.HIVE-4199.D9501.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-28T22:13:14.624+0000","size":5252,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12575960/HIVE-4199.HIVE-4199.HIVE-4199.D9501.4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"318424","customfield_12312823":null,"summary":"ORC writer doesn't handle non-UTF8 encoded Text properly","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sxyuan","name":"sxyuan","key":"sxyuan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Samuel Yuan","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sxyuan","name":"sxyuan","key":"sxyuan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Samuel Yuan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637603/comment/13605672","id":"13605672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"sxyuan requested code review of \"HIVE-4199 [jira] ORC writer doesn't handle non-UTF8 encoded Text properly\".\n\nReviewers: kevinwilfong\n\nStringTreeWriter currently converts fields stored as Text objects into Strings. This can lose information (see http://en.wikipedia.org/wiki/Replacement_character#Replacement_character), and is also unnecessary since the dictionary stores Text objects.\n\nInstead, we can check whether Text or String is preferred and simply use the preferred class, converting only to String for the index stats.\n\nTEST PLAN\n  Run unit tests, including new query. The join in the test query originally produces no results because of the bug.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D9501\n\nAFFECTED FILES\n  data/files/nonutf8.txt\n  ql/src/test/results/clientpositive/orc_nonutf8.q.out\n  ql/src/test/queries/clientpositive/orc_nonutf8.q\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/StringRedBlackTree.java\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/WriterImpl.java\n\nMANAGE HERALD RULES\n  https://reviews.facebook.net/herald/view/differential/\n\nWHY DID I GET THIS EMAIL?\n  https://reviews.facebook.net/herald/transcript/22719/\n\nTo: kevinwilfong, sxyuan\nCc: JIRA\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-18T21:29:13.555+0000","updated":"2013-03-18T21:29:13.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637603/comment/13605682","id":"13605682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"sxyuan updated the revision \"HIVE-4199 [jira] ORC writer doesn't handle non-UTF8 encoded Text properly\".\n\n  Phabricator is converting the non-UTF8 data file to UTF8, defeating the purpose of the test. Trying a raw diff.\n\nReviewers: kevinwilfong\n\nREVISION DETAIL\n  https://reviews.facebook.net/D9501\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D9501?vs=29967&id=29973#toc\n\nAFFECTED FILES\n  ql/src/test/results/clientpositive/orc_nonutf8.q.out\n  ql/src/test/queries/clientpositive/orc_nonutf8.q\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/StringRedBlackTree.java\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/WriterImpl.java\n  data/files/nonutf8.txt\n\nTo: kevinwilfong, sxyuan\nCc: JIRA\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-18T21:33:14.344+0000","updated":"2013-03-18T21:33:14.344+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637603/comment/13605702","id":"13605702","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"sxyuan updated the revision \"HIVE-4199 [jira] ORC writer doesn't handle non-UTF8 encoded Text properly\".\n\n  Making the new data file binary.\n\nReviewers: kevinwilfong\n\nREVISION DETAIL\n  https://reviews.facebook.net/D9501\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D9501?vs=29973&id=30009#toc\n\nAFFECTED FILES\n  data/files/nonutf8.txt\n  ql/src/test/results/clientpositive/orc_nonutf8.q.out\n  ql/src/test/queries/clientpositive/orc_nonutf8.q\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/StringRedBlackTree.java\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/WriterImpl.java\n\nTo: kevinwilfong, sxyuan\nCc: JIRA\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-18T21:45:14.026+0000","updated":"2013-03-18T21:45:14.026+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637603/comment/13616723","id":"13616723","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"sxyuan updated the revision \"HIVE-4199 [jira] ORC writer doesn't handle non-UTF8 encoded Text properly\".\n\n  Updated test case to clarify the expected behaviour.\n\nReviewers: kevinwilfong\n\nREVISION DETAIL\n  https://reviews.facebook.net/D9501\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D9501?vs=30009&id=30675#toc\n\nAFFECTED FILES\n  data/files/nonutf8.txt\n  ql/src/test/results/clientpositive/orc_nonutf8.q.out\n  ql/src/test/queries/clientpositive/orc_nonutf8.q\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/StringRedBlackTree.java\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/WriterImpl.java\n\nTo: kevinwilfong, sxyuan\nCc: JIRA\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-28T22:13:14.552+0000","updated":"2013-03-28T22:13:14.552+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637603/comment/13617454","id":"13617454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"omalley has commented on the revision \"HIVE-4199 [jira] ORC writer doesn't handle non-UTF8 encoded Text properly\".\n\nINLINE COMMENTS\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/StringRedBlackTree.java:44 Let's just remove the current add method and move exclusively to Text for the StringRedBlackTree. I should have known better than using String internally.\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/WriterImpl.java:717 We're going to have the same problem here with the statistics. If we need to support non-utf8, we need to update the statistics to use Text also.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D9501\n\nTo: kevinwilfong, sxyuan\nCc: JIRA, omalley\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-29T15:57:15.272+0000","updated":"2013-03-29T15:57:15.272+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637603/comment/13627200","id":"13627200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"sxyuan has commented on the revision \"HIVE-4199 [jira] ORC writer doesn't handle non-UTF8 encoded Text properly\".\n\n  Inline comments.\n\nINLINE COMMENTS\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/StringRedBlackTree.java:44 The reason why I kept the add(String) method is that it can avoid doing two copies when the original data is actually a String. If the dictionary only takes Text objects, the writer will have to convert the String to a new Text object, and then set(Text) will copy the bytes over to the dictionary's internal Text object.\n  ql/src/java/org/apache/hadoop/hive/ql/io/orc/WriterImpl.java:717 I've looked into adding statistics for non-UTF8 strings, but I discovered that the stats are serialized to Protobuf objects which require strings to be UTF8 encoded. Do you have any suggestions?\n\nREVISION DETAIL\n  https://reviews.facebook.net/D9501\n\nTo: kevinwilfong, sxyuan\nCc: JIRA, omalley\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-09T22:26:15.289+0000","updated":"2013-04-09T22:26:15.289+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4199/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1ivvb:"}}