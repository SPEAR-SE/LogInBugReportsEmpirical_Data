{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13091882","self":"https://issues.apache.org/jira/rest/api/2/issue/13091882","key":"HIVE-17230","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-08-03T00:32:15.477+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 17 23:14:09 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-17230/watchers","watchCount":5,"isWatching":false},"created":"2017-08-02T13:12:24.060+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-10-17T23:14:09.178+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324409","id":"12324409","name":"Beeline"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313604","id":"12313604","name":"CLI","description":"Command-line interpreter for Hive.\n"}],"timeoriginalestimate":null,"description":"The issue can be reproduced with the following commands:\n{code}\ncreate table timestamp_test(t timestamp);\ninsert into table timestamp_test values('2000-01-01 01:00:00');\nselect * from timestamp_test;\n{code}\n\nThe timestamp is displayed without nanoseconds in HiveCLI:\n{code}\n2000-01-01 01:00:00\n{code}\n\nWhen the exact same timestamp is displayed in BeeLine it displays:\n{code}\n2000-01-01 01:00:00.0\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12881266","id":"12881266","filename":"HIVE-17230.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"created":"2017-08-10T16:27:23.349+0000","size":95910,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12881266/HIVE-17230.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12886458","id":"12886458","filename":"HIVE-17230.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-11T17:19:24.976+0000","size":870663,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12886458/HIVE-17230.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12887101","id":"12887101","filename":"HIVE-17230.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"created":"2017-09-14T13:06:21.410+0000","size":920187,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12887101/HIVE-17230.3.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Timestamp format different in HiveCLI and Beeline","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16110874","id":"16110874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"body":"The root cause of the issue is, that HiveCLI writes out the value with TimestampWritable.toString() method which specifically changes the output of the timeStamp.toString() for an unknown reason since the \"inception\" of this code :)\n{code:title=TimestampWritable}\n  @Override\n  public String toString() {\n    if (timestampEmpty) {\n      populateTimestamp();\n    }\n\n    String timestampString = timestamp.toString();\n    if (timestampString.length() > 19) {\n      if (timestampString.length() == 21) {\n        if (timestampString.substring(19).compareTo(\".0\") == 0) {\n          return threadLocalDateFormat.get().format(timestamp);\n        }\n      }\n      return threadLocalDateFormat.get().format(timestamp) + timestampString.substring(19);\n    }\n\n    return threadLocalDateFormat.get().format(timestamp);\n  }\n{code}\n\nThe BeeLine receives a Timestamp object and calls it's toString without any changes:\n{code:title=org.apache.hive.beeline.Rows}\n    Row(int size, ResultSet rs) throws SQLException {\n[..]\n      for (int i = 0; i < size; i++) {\n        if (numberFormat != null) {\n          Object o = rs.getObject(i + 1);\n          if (o == null) {\n            values[i] = null;\n          }  else if (o instanceof Number) {\n            values[i] = numberFormat.format(o);\n          } else {\n            values[i] = o.toString();       <--- This row prints out the Timestamp object\n          }\n        } else {\n          values[i] = rs.getString(i + 1);\n        }\n        values[i] = values[i] == null ? nullStr : values[i];\n        sizes[i] = values[i].length();\n      }\n    }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"created":"2017-08-02T13:20:20.805+0000","updated":"2017-08-02T13:20:20.805+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16110888","id":"16110888","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"body":"I have found this issue when I was trying to run several more tests with the TestBeeLineDriver to see if there is any further differences between the output of BeeLine, and HiveCLI.\n\n[~vihangk1], [~aihuaxu]: What do you think we should do with this difference?\n- Change the way BeeLine prints out timestamps?\n- Change the way HiveCLI prints out timestamps?\n- Document this as a known issue?\n\nI personally do not understand/like the HiveCLI version where the Timestamp nanoseconds are not displayed - in my view this column was specifically defined as a Timestamp because we expect it to be an exact time, so I would go for removing the formatting changes from the HiveCLI, but this is a backward incompatible change, and I might not see every aspect of this change.\n\nI would greatly value your input here [~aihuaxu], [~vihangk1].\n\nThanks,\nPeter","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pvary","name":"pvary","key":"pvary","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Vary","active":true,"timeZone":"Europe/Budapest"},"created":"2017-08-02T13:26:40.090+0000","updated":"2017-08-02T13:26:40.090+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16111975","id":"16111975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"body":"The output from the beeline version is more accurate to me. I feel it makes sense to make that change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-08-03T00:32:15.477+0000","updated":"2017-08-03T00:32:15.477+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16121867","id":"16121867","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"body":"Uploading a first version of the patch to see which tests are affected. Most probably there will be some failing tests which will be analyzed.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"created":"2017-08-10T16:28:29.093+0000","updated":"2017-08-10T16:28:29.093+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16122369","id":"16122369","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12881266/HIVE-17230.1.patch\n\n{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 80 failed/errored test(s), 11002 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_index] (batchId=231)\norg.apache.hadoop.hive.cli.TestBlobstoreCliDriver.testCliDriver[insert_overwrite_dynamic_partitions_merge_move] (batchId=243)\norg.apache.hadoop.hive.cli.TestBlobstoreCliDriver.testCliDriver[insert_overwrite_dynamic_partitions_merge_only] (batchId=243)\norg.apache.hadoop.hive.cli.TestBlobstoreCliDriver.testCliDriver[insert_overwrite_dynamic_partitions_move_only] (batchId=243)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[floor_time] (batchId=73)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[interval_alt] (batchId=4)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[interval_arithmetic] (batchId=45)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[json_serde_tsformat] (batchId=5)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[llap_text] (batchId=71)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[orc_merge11] (batchId=38)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[orc_ppd_exception] (batchId=32)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[timestamp] (batchId=28)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[timestamp_ints_casts] (batchId=1)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[timestamp_literal] (batchId=25)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[timestamptz_1] (batchId=56)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[udf_to_utc_timestamp] (batchId=21)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_aggregate_9] (batchId=38)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_interval_1] (batchId=15)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_interval_arithmetic] (batchId=4)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorization_14] (batchId=14)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorization_17] (batchId=83)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorization_7] (batchId=42)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_casts] (batchId=79)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_date_funcs] (batchId=73)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_timestamp] (batchId=74)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_timestamp_ints_casts] (batchId=47)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[windowing_windowspec3] (batchId=36)\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver[hbase_timestamp] (batchId=96)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[insert_values_non_partitioned] (batchId=149)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[insert_values_partitioned] (batchId=160)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_merge11] (batchId=153)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_merge5] (batchId=157)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_merge6] (batchId=152)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_merge7] (batchId=162)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_merge_incompat1] (batchId=159)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_merge_incompat2] (batchId=162)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_split_elimination] (batchId=158)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_orc_nonvec_part_all_primitive] (batchId=163)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_orc_vec_part_all_primitive] (batchId=161)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_nonvec_part] (batchId=149)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_nonvec_part_all_primitive] (batchId=156)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_nonvec_table] (batchId=148)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_part] (batchId=157)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_part_all_primitive] (batchId=158)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=155)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vecrow_part] (batchId=162)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vecrow_part_all_primitive] (batchId=158)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vecrow_table] (batchId=147)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_aggregate_9] (batchId=153)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_interval_1] (batchId=148)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_interval_2] (batchId=159)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_interval_arithmetic] (batchId=146)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_partitioned_date_time] (batchId=161)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorization_14] (batchId=148)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorization_17] (batchId=163)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorization_7] (batchId=154)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_casts] (batchId=162)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_date_funcs] (batchId=161)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_timestamp] (batchId=161)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_timestamp_ints_casts] (batchId=156)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[orc_merge5] (batchId=170)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[orc_merge6] (batchId=170)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[orc_merge7] (batchId=172)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[orc_merge_incompat1] (batchId=171)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[orc_merge_incompat2] (batchId=172)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_dynamic_partition_pruning_mapjoin_only] (batchId=170)\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_vectorized_dynamic_partition_pruning] (batchId=169)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=235)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=235)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[date_udf] (batchId=115)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[timestamp_1] (batchId=113)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[timestamp_2] (batchId=101)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[timestamp_lazy] (batchId=124)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vectorization_14] (batchId=107)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vectorization_17] (batchId=138)\norg.apache.hadoop.hive.ql.io.orc.TestNewInputOutputFormat.testNewInputFormat (batchId=263)\norg.apache.hadoop.hive.serde2.io.TestTimestampWritable.testSerializationFormatDirectly (batchId=289)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionRegistrationWithCustomSchema (batchId=180)\norg.apache.hive.hcatalog.api.TestHCatClient.testPartitionSpecRegistrationWithCustomSchema (batchId=180)\norg.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation (batchId=180)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/6342/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/6342/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6342/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 80 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12881266 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-08-10T21:29:41.466+0000","updated":"2017-08-10T21:29:41.466+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16161784","id":"16161784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12886458/HIVE-17230.2.patch\n\n{color:green}SUCCESS:{color} +1 due to 4 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 13 failed/errored test(s), 11033 tests executed\n*Failed tests:*\n{noformat}\nTestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=230)\nTestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=230)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=61)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[interval_arithmetic] (batchId=45)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[orc_merge8] (batchId=81)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_timestamp] (batchId=74)\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver[hbase_timestamp] (batchId=96)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_nonvec_part] (batchId=149)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_nonvec_part_all_primitive] (batchId=156)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_part_all_primitive] (batchId=158)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vecrow_part] (batchId=162)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vecrow_part_all_primitive] (batchId=158)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=100)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/6769/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/6769/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6769/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 13 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12886458 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-09-11T18:54:56.776+0000","updated":"2017-09-11T18:54:56.776+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16167328","id":"16167328","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12887101/HIVE-17230.3.patch\n\n{color:green}SUCCESS:{color} +1 due to 4 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 12 failed/errored test(s), 11040 tests executed\n*Failed tests:*\n{noformat}\nTestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=230)\nTestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=230)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[create_view] (batchId=39)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=61)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[interval_arithmetic] (batchId=45)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=156)\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[drop_table_failure2] (batchId=89)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=234)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=234)\norg.apache.hadoop.hive.ql.TestAcidOnTez.testCtasTezUnion (batchId=215)\norg.apache.hadoop.hive.ql.TestAcidOnTez.testNonStandardConversion01 (batchId=215)\norg.apache.hive.jdbc.TestJdbcDriver2.testSelectExecAsync2 (batchId=225)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/6817/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/6817/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6817/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 12 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12887101 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-09-15T05:06:11.617+0000","updated":"2017-09-15T05:06:11.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16191096","id":"16191096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"body":"I've not found any recommendation in the sql standard how this should be formatted on outputting it; however here's what I've found:\n\n* psql - displays timestamp precision only on demand (supresses trailing zeros):\n{code}\nselect cast('2011-11-11 11:11:11.123' as timestamp(2)), cast('2011-11-11 11:11:11' as timestamp(2));\n 2011-11-11 11:11:11.12 | 2011-11-11 11:11:11\n{code}\n* mariadb - seems to be not supporting {{cast}} for me..\n  creating a table; and setting timestamp precision explicitly to 2 makes it show .00 all the time\n  I must note that {{timestamp}} without specifier should be 6 precise\n* oracle has a supercomplicated formatter; which by default outputs all 6 precision digits.\n* hive (as of now)\n does not support the timestamp precision setting\n stores all timestamps with precision 9 \n cli: trims trailing zeros\n\nI think from the above that the most user friendly is the behaviour of psql...\nI think the only case when we might be ok to show a single trailing zero in case of precision 1. - so I think it would be better to remove those lone trailing 0s.\n\n{code}\ncreate table t(a timestamp);\ninsert into t values\n('2011-11-11 11:11:11')\n,('2011-11-11 11:11:11.1234')\n,('2011-11-11 11:11:11.1234567')\n,('2011-11-11 11:11:11.123456789')\n,('2011-11-11 11:11:11.1234567890123')\n,('2011-11-11 11:11:11.12345678901234567890')\n,('2011-11-11 11:11:11.12345678901234567890123456')\n;\nselect * from t;\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"created":"2017-10-04T10:29:53.804+0000","updated":"2017-10-04T10:29:53.804+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16207557","id":"16207557","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"body":"Thanks a lot [~kgyrtkirk] for the investigation you did. You are right that the behavior of psql seems to be the most user friendly. However in this case we have to implement the same custom logic in BeeLine as in Hive CLI instead of just relaying on the string representation of the timestamps. This adds a bit more complexity and extra logic to the BeeLine code.\r\nIf we want the same timestamp format in both BeeLine and Hive CLI, we can either change the BeeLine behavior or the CLI behavior and I think both solutions have advantages and disadvantages.\r\nChanging the behavior of the Hive CLI to display the timestamp like in BeeLine (with the trailing .0s) affects many q.out files.\r\nChanging the behavior of BeeLine (remove the trailing 0s) is a smaller change but in return we have to maintain the same formatting logic as in Hive CLI.\r\n[~aihuaxu], what are your thoughts about this? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kuczoram","name":"kuczoram","key":"kuczoram","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marta Kuczora","active":true,"timeZone":"Etc/UTC"},"created":"2017-10-17T12:13:03.248+0000","updated":"2017-10-17T12:13:03.248+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13091882/comment/16208572","id":"16208572","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~kgyrtkirk] for looking into it. Seems like the standard is more about how to store the timestamp data  http://troels.arvin.dk/db/rdbms/#data_types-date_and_time-timestamp, not about how to display the timestamp. So either will be fine if the result is correct. Hive follows more with Oracle and Postgres, but Oracle shows the trailing 0 and postgres removes the trailing 0. \r\n\r\n[~jdere] Do you have opinion on this? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-10-17T23:14:09.178+0000","updated":"2017-10-17T23:14:09.178+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-17230/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3ibmf:"}}