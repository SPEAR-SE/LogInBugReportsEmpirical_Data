{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12954165","self":"https://issues.apache.org/jira/rest/api/2/issue/12954165","key":"HIVE-13374","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-10-27T21:25:19.303+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Oct 27 21:25:19 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13374/watchers","watchCount":10,"isWatching":false},"created":"2016-03-29T01:50:29.009+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-10-27T22:01:07.555+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320408","id":"12320408","name":"HiveServer2","description":"Tracks issues related to HiveServer2"}],"timeoriginalestimate":null,"description":"If query to scan too many partition(for example, more than 40,000 partitions) is submitted, hiveserver2 hangs up\n\nhiveserver2 java heap status is the following.\nhttps://gyazo.com/e0a35bd628a0dc904bc24f19cdb2261e\nhttps://gyazo.com/65f12cd3875330995508ae11afd394a2\n\nOutOfMemoryError doesn't occur. but other queries fails.\n\nMaybe it is necessary to spill to disk...\n\nhiveserver2.log\n{code}\n....\n2016-03-28 13:44:28,923 INFO  [HiveServer2-Handler-Pool: Thread-766923]: io.CombineHiveInputFormat (CombineHiveInputFormat.java:getSplits(517)) - Total number of paths: 47409, launching 50 threads to check non-combinable ones.\n2016-03-28 13:44:29,444 INFO  [HiveServer2-Handler-Pool: Thread-766923]: io.CombineHiveInputFormat (CombineHiveInputFormat.java:getCombineSplits(439)) - CombineHiveInputSplit creating pool for hdfs://.../aaa=.../yyyymmdd=20150721; using filter path hdfs://.../aaa=.../yyyymmdd=20150721\n....\n2016-03-28 13:44:34,811 INFO  [HiveServer2-Handler-Pool: Thread-766923]: io.CombineHiveInputFormat (CombineHiveInputFormat.java:getCombineSplits(444)) - CombineHiveInputSplit: pool is already created for hdfs://.../aaa=.../yyyymmdd=20160326; using filter path hdfs://.../aaa=.../yyyymmdd=20160326\n2016-03-28 13:44:34,811 INFO  [HiveServer2-Handler-Pool: Thread-766923]: io.CombineHiveInputFormat (CombineHiveInputFormat.java:getCombineSplits(444)) - CombineHiveInputSplit: pool is already created for hdfs://.../aaa=.../yyyymmdd=20160327; using filter path hdfs://.../aaa=.../yyyymmdd=20160327\n2016-03-28 13:44:34,811 INFO  [HiveServer2-Handler-Pool: Thread-766923]: io.CombineHiveInputFormat (CombineHiveInputFormat.java:getCombineSplits(444)) - CombineHiveInputSplit: pool is already created for hdfs://.../aaa=.../yyyymmdd=20160328; using filter path hdfs://.../aaa=.../yyyymmdd=20160328\n2016-03-28 13:45:00,285 INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@6f5d0190]: util.JvmPauseMonitor (JvmPauseMonitor.java:run(195)) - Detected pause in JVM or host machine (eg GC): pause of approximately 4587ms\nGC pool 'PS MarkSweep' had collection(s): count=1 time=4699ms\nGC pool 'PS Scavenge' had collection(s): count=1 time=63ms\n....\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"HiveServer2 hangs up if query to scan too many partition is submitted","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyukawa","name":"wyukawa","key":"wyukawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=wyukawa&avatarId=13133","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wyukawa&avatarId=13133","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wyukawa&avatarId=13133","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wyukawa&avatarId=13133"},"displayName":"Wataru Yukawa","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyukawa","name":"wyukawa","key":"wyukawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=wyukawa&avatarId=13133","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wyukawa&avatarId=13133","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wyukawa&avatarId=13133","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wyukawa&avatarId=13133"},"displayName":"Wataru Yukawa","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"HDP2.4.0\nJDK1.8","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12954165/comment/15611294","id":"15611294","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyukawa","name":"wyukawa","key":"wyukawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=wyukawa&avatarId=13133","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wyukawa&avatarId=13133","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wyukawa&avatarId=13133","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wyukawa&avatarId=13133"},"displayName":"Wataru Yukawa","active":true,"timeZone":"Etc/UTC"},"body":"[~pxiong] This is the issue that I talked you in Hadoop Summit Tokyo 2016.\n\nI hope that hiveserver2 will become stable.\n\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyukawa","name":"wyukawa","key":"wyukawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=wyukawa&avatarId=13133","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wyukawa&avatarId=13133","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wyukawa&avatarId=13133","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wyukawa&avatarId=13133"},"displayName":"Wataru Yukawa","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-27T09:16:19.814+0000","updated":"2016-10-27T09:16:19.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12954165/comment/15611677","id":"15611677","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyukawa","name":"wyukawa","key":"wyukawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=wyukawa&avatarId=13133","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wyukawa&avatarId=13133","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wyukawa&avatarId=13133","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wyukawa&avatarId=13133"},"displayName":"Wataru Yukawa","active":true,"timeZone":"Etc/UTC"},"body":"Thank you for comment.\n\nBy the way, I work at LINE.\n\nI'm not sure if Yahoo Japan faces this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyukawa","name":"wyukawa","key":"wyukawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=wyukawa&avatarId=13133","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wyukawa&avatarId=13133","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wyukawa&avatarId=13133","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wyukawa&avatarId=13133"},"displayName":"Wataru Yukawa","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-27T12:05:18.589+0000","updated":"2016-10-27T12:05:18.589+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12954165/comment/15613273","id":"15613273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"body":"[~pxiong] If this is resulting in longer compile phase time, HS2 would block other query compiles before 2.0 (HIVE-4239) , as there was a lock around compile phase.\nThats likely one part of the issue.\n\nThe other part seems to be memory consumption is very high when very large number (10s of thousands) of partitions are queried.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-27T21:25:19.303+0000","updated":"2016-10-27T21:25:19.303+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13374/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2vblj:"}}