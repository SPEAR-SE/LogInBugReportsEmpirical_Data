{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12649275","self":"https://issues.apache.org/jira/rest/api/2/issue/12649275","key":"HIVE-4605","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-06-07T16:50:10.230+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Mar 29 04:46:46 UTC 2017","customfield_12310420":"329602","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4605/watchers","watchCount":18,"isWatching":false},"created":"2013-05-24T08:07:53.113+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323587","id":"12323587","description":"Hive 0.11.0","name":"0.11.0","archived":false,"released":true,"releaseDate":"2013-05-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324312","id":"12324312","description":"released","name":"0.12.0","archived":false,"released":true,"releaseDate":"2013-10-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324986","id":"12324986","description":"released","name":"0.13.0","archived":false,"released":true,"releaseDate":"2014-04-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326829","id":"12326829","description":"0.13 maintenance release 1","name":"0.13.1","archived":false,"released":true,"releaseDate":"2014-06-06"}],"issuelinks":[{"id":"12390218","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12390218","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12723056","key":"HIVE-7273","self":"https://issues.apache.org/jira/rest/api/2/issue/12723056","fields":{"summary":"Hive job fails due to unable to rename reducer output file","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-03-29T04:46:46.700+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/4","description":"This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/reopened.png","name":"Reopened","id":"4","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":null,"description":"1, create a table with ORC storage model\ncreate table iparea_analysis_orc (network int, ip string,  .... )\nstored as ORC;\n\n2, insert table iparea_analysis_orc select  network, ip, .... , the script success, but failed after add *OVERWRITE* keyword.  the main error log list as here.\n\nava.lang.RuntimeException: Hive Runtime Error while closing operators: Unable to rename output from: hdfs://qa3hop001.uucun.com:9000/tmp/hive-hadoop/hive_2013-05-24_15-11-06_511_7746839019590922068/_task_tmp.-ext-10000/_tmp.000000_0 to: hdfs://qa3hop001.uucun.com:9000/tmp/hive-hadoop/hive_2013-05-24_15-11-06_511_7746839019590922068/_tmp.-ext-10000/000000_0\n\tat org.apache.hadoop.hive.ql.exec.ExecReducer.close(ExecReducer.java:317)\n\tat org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:530)\n\tat org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:421)\n\tat org.apache.hadoop.mapred.Child$4.run(Child.java:255)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:396)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1149)\n\tat org.apache.hadoop.mapred.Child.main(Child.java:249)\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Unable to rename output from: hdfs://qa3hop001.uucun.com:9000/tmp/hive-hadoop/hive_2013-05-24_15-11-06_511_7746839019590922068/_task_tmp.-ext-10000/_tmp.000000_0 to: hdfs://qa3hop001.uucun.com:9000/tmp/hive-hadoop/hive_2013-05-24_15-11-06_511_7746839019590922068/_tmp.-ext-10000/000000_0\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.commit(FileSinkOperator.java:197)\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.access$300(FileSinkOperator.java:108)\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator.closeOp(FileSinkOperator.java:867)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:588)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.ExecReducer.close(ExecReducer.java:309)\n\t... 7 more\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12665026","id":"12665026","filename":"HIVE-4605.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ccondit","name":"ccondit","key":"ccondit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ccondit&avatarId=36345","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ccondit&avatarId=36345","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ccondit&avatarId=36345","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ccondit&avatarId=36345"},"displayName":"Craig Condit","active":true,"timeZone":"America/Chicago"},"created":"2014-08-28T17:45:47.697+0000","size":672,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12665026/HIVE-4605.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"329937","customfield_12312823":null,"summary":"Hive job fails while closing reducer output - Unable to rename","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lqian","name":"lqian","key":"lqian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lqian&avatarId=16239","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lqian&avatarId=16239","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lqian&avatarId=16239","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lqian&avatarId=16239"},"displayName":"Link Qian","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lqian","name":"lqian","key":"lqian","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lqian&avatarId=16239","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lqian&avatarId=16239","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lqian&avatarId=16239","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lqian&avatarId=16239"},"displayName":"Link Qian","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"OS: 2.6.18-194.el5xen #1 SMP Fri Apr 2 15:34:40 EDT 2010 x86_64 x86_64 x86_64 GNU/Linux\nHadoop 1.1.2","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/13678144","id":"13678144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"body":"I cannot reproduce this, it was either fixed or was an environmental problem. If you have more information please re-open and share.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-07T16:50:10.230+0000","updated":"2013-06-07T16:50:10.230+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/13769472","id":"13769472","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jtrav","name":"jtrav","key":"jtrav","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joe Travaglini","active":true,"timeZone":"America/New_York"},"body":"Brock,\nI've also been seeing this same symptom several times over the past month, but with RCFile and not ORC.\nI also cannot reliably reproduce, but it's happening.\nSee also http://mail-archives.apache.org/mod_mbox/hive-user/201306.mbox/%3CCANsfGRkR0jy5W3eY3z8aWTWpypHGu5YeDicybVJBnwR_o_52Vg@mail.gmail.com%3E which seems like the same symptom.\nHive 0.10 in CDH4.3.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jtrav","name":"jtrav","key":"jtrav","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joe Travaglini","active":true,"timeZone":"America/New_York"},"created":"2013-09-17T12:24:31.001+0000","updated":"2013-09-17T12:24:31.001+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/13784874","id":"13784874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kjsingh","name":"kjsingh","key":"kjsingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kjsingh&avatarId=22338","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kjsingh&avatarId=22338","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kjsingh&avatarId=22338","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kjsingh&avatarId=22338"},"displayName":"Kanwaljit Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Observed for text files also. There were as many as 8 reducers running concurrently.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kjsingh","name":"kjsingh","key":"kjsingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kjsingh&avatarId=22338","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kjsingh&avatarId=22338","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kjsingh&avatarId=22338","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kjsingh&avatarId=22338"},"displayName":"Kanwaljit Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-10-03T07:08:20.885+0000","updated":"2013-10-03T07:08:20.885+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14037200","id":"14037200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GWong","name":"GWong","key":"gwong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"George Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"We ran into this issue in our cluster.\nThe error message is like this\n{code}\norg.apache.hadoop.hive.ql.metadata.HiveException: Unable to rename output from: hdfs://***:8020/tmp/hive-svcckppi/hive_2014-06-16_20-24-09_584_6615934756634587679/_task_tmp.-ext-10002/_tmp.000000_3 to: hdfs://***:8020/tmp/hive-svcckppi/hive_2014-06-16_20-24-09_584_6615934756634587679/_tmp.-ext-10002/000000_3\n        at org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.commit(FileSinkOperator.java:197)\n        at org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.access$300(FileSinkOperator.java:108)\n        at org.apache.hadoop.hive.ql.exec.FileSinkOperator.closeOp(FileSinkOperator.java:867)\n        at org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:588)\n        at org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n        at org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n        at org.apache.hadoop.hive.ql.exec.ExecReducer.close(ExecReducer.java:309)\n        at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:470)\n        at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:407)\n        at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:158)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:396)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1478)\n        at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:153)\n{code}\n\nThe log of NameNode shows\n{code}\n2014-06-16 20:43:38,582 WARN org.apache.hadoop.hdfs.StateChange: DIR* FSDirectory.unprotectedRenameTo: failed to rename /tmp/hive-svcckppi/hive_2014-06-16_20-24-09_584_6615934756634587679/_task_tmp.-ext-10002/_tmp.000000_3 to /tmp/hive-svcckppi/hive_2014-06-16_20-24-09_584_6615934756634587679/_tmp.-ext-10002/000000_3 because destination's parent does not exist\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GWong","name":"GWong","key":"gwong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"George Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-06-19T10:11:54.600+0000","updated":"2014-06-19T10:11:54.600+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14037203","id":"14037203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GWong","name":"GWong","key":"gwong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"George Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"I went through the code of FileSink operator\nThe code is like this.\n{code}\n         if ((bDynParts || isSkewedStoredAsSubDirectories)\n              && !fs.exists(finalPaths[idx].getParent())) {\n            fs.mkdirs(finalPaths[idx].getParent());\n          }\n{code}\n\nI am wondering why we should check bDynParts and isSkewedStoredAsSubDirectories. In the code, the output is move to finalPath no matter what the values of bDynParts and isSkewedStoredAsSubDirectories are. Since the date move is not avoidable, why not change the code to the following to make sure the path exists before moving the file.\n{code}\n         if (!fs.exists(finalPaths[idx].getParent())) {\n            fs.mkdirs(finalPaths[idx].getParent());\n          }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GWong","name":"GWong","key":"gwong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"George Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-06-19T10:15:55.055+0000","updated":"2014-06-19T10:15:55.055+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14051872","id":"14051872","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arif.iqbal","name":"arif.iqbal","key":"arif.iqbal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arif Iqbal","active":true,"timeZone":"Etc/UTC"},"body":"I'm also seeing exact same issue with hive-0.11. The exception message is attached below\n\nIt looks like that the bug started happening when we started using the command in hive \"create table as\"\n\norg.apache.hadoop.hive.ql.metadata.HiveException: Unable to rename output from: hdfs://ares-nn.vip.ebay.com:8020/tmp/abc/hive_2014-07-02_22-28-32_991_2129131884187129074/_task_tmp.-ext-10001/_tmp.000000_0 to: hdfs://ares-nn.vip.ebay.com:8020/tmp/abc/hive_2014-07-02_22-28-32_991_2129131884187129074/_tmp.-ext-10001/000000_0\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.commit(FileSinkOperator.java:197)\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.access$300(FileSinkOperator.java:108)\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator.closeOp(FileSinkOperator.java:867)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:588)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.ExecMapper.close(ExecMapper.java:194)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:57)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:429)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:365)\n\tat org.apache.hadoop.mapred.Child$4.run(Child.java:255)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:396)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1232)\n\tat org.apache.hadoop.mapred.Child.main(Child.java:249)\norg.apache.hadoop.hive.ql.metadata.HiveException: Unable to rename output from: hdfs://ares-nn.vip.ebay.com:8020/tmp/abc/hive_2014-07-02_22-28-32_991_2129131884187129074/_task_tmp.-ext-10001/_tmp.000000_0 to: hdfs://ares-nn.vip.ebay.com:8020/tmp/abc/hive_2014-07-02_22-28-32_991_2129131884187129074/_tmp.-ext-10001/000000_0\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.commit(FileSinkOperator.java:197)\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator$FSPaths.access$300(FileSinkOperator.java:108)\n\tat org.apache.hadoop.hive.ql.exec.FileSinkOperator.closeOp(FileSinkOperator.java:867)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:588)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.Operator.close(Operator.java:597)\n\tat org.apache.hadoop.hive.ql.exec.ExecMapper.close(ExecMapper.java:194)\n\tat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:57)\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:429)\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:365)\n\tat org.apache.hadoop.mapred.Child$4.run(Child.java:255)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:396)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1232)\n\tat org.apache.hadoop.mapred.Child.main(Child.java:249)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arif.iqbal","name":"arif.iqbal","key":"arif.iqbal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arif Iqbal","active":true,"timeZone":"Etc/UTC"},"created":"2014-07-03T20:13:46.259+0000","updated":"2014-07-03T20:13:46.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14114041","id":"14114041","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ccondit","name":"ccondit","key":"ccondit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ccondit&avatarId=36345","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ccondit&avatarId=36345","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ccondit&avatarId=36345","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ccondit&avatarId=36345"},"displayName":"Craig Condit","active":true,"timeZone":"America/Chicago"},"body":"We are seeing this issue as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ccondit","name":"ccondit","key":"ccondit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ccondit&avatarId=36345","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ccondit&avatarId=36345","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ccondit&avatarId=36345","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ccondit&avatarId=36345"},"displayName":"Craig Condit","active":true,"timeZone":"America/Chicago"},"created":"2014-08-28T17:44:44.878+0000","updated":"2014-08-28T17:44:44.878+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14114044","id":"14114044","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ccondit","name":"ccondit","key":"ccondit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ccondit&avatarId=36345","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ccondit&avatarId=36345","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ccondit&avatarId=36345","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ccondit&avatarId=36345"},"displayName":"Craig Condit","active":true,"timeZone":"America/Chicago"},"body":"The patch by [~GWong] seems to work for us.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ccondit","name":"ccondit","key":"ccondit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ccondit&avatarId=36345","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ccondit&avatarId=36345","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ccondit&avatarId=36345","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ccondit&avatarId=36345"},"displayName":"Craig Condit","active":true,"timeZone":"America/Chicago"},"created":"2014-08-28T17:45:31.420+0000","updated":"2014-08-28T17:45:31.420+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14117175","id":"14117175","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rguo","name":"rguo","key":"rguo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Guo Ruijing","active":true,"timeZone":"Etc/UTC"},"body":"George Wong or somebody can help to go through patch available procedure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rguo","name":"rguo","key":"rguo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Guo Ruijing","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-01T08:26:02.050+0000","updated":"2014-09-01T08:26:02.050+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14179452","id":"14179452","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GWong","name":"GWong","key":"gwong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"George Wong","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~arif.iqbal] and [~ccondit], would you mind to share the failure HQL statement with us? It is very helpful to find the root cause.\n\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=GWong","name":"GWong","key":"gwong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"George Wong","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-10-22T01:42:46.684+0000","updated":"2014-10-22T01:42:46.684+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/14593185","id":"14593185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bperroud","name":"bperroud","key":"bperroud","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bperroud&avatarId=12753","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bperroud&avatarId=12753","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bperroud&avatarId=12753","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bperroud&avatarId=12753"},"displayName":"Benoit Perroud","active":true,"timeZone":"Europe/Berlin"},"body":"I'm seeing this error, too, with Hive 0.13, but it's because another process deleted the {{_tmp.-ext-10001}} folder.\nSo it's not really a bug from my perspective. \nTo find the guilty process deleting the folder, have a look at hdfs audits file to figure out who deleted the folder.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bperroud","name":"bperroud","key":"bperroud","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bperroud&avatarId=12753","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bperroud&avatarId=12753","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bperroud&avatarId=12753","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bperroud&avatarId=12753"},"displayName":"Benoit Perroud","active":true,"timeZone":"Europe/Berlin"},"created":"2015-06-19T08:23:11.381+0000","updated":"2015-06-19T08:23:11.381+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12649275/comment/15946521","id":"15946521","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gjz22","name":"gjz22","key":"gjz22","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gabriel Zimmerman","active":true,"timeZone":"Etc/UTC"},"body":"\nI am seeing the same issue and maybe this sheds some light. Using Hive version 1.0.0 and below (haven't tried later versions) on EMR, this error happens consistently. \n\nThe table uses its own storage handler but when I use \"create external table\" to create the table, somehow Hive thinks the table is native, which means that it runs commit on the FS paths causing the error (see stack trace above). Removing external fixed the issue. Maybe overwrite in the above case had a similar result?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gjz22","name":"gjz22","key":"gjz22","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gabriel Zimmerman","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-29T04:46:46.700+0000","updated":"2017-03-29T04:46:46.700+0000"}],"maxResults":12,"total":12,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4605/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1kv5b:"}}