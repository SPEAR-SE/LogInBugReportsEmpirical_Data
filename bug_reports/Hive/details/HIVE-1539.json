{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12471563","self":"https://issues.apache.org/jira/rest/api/2/issue/12471563","key":"HIVE-1539","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-08-16T22:46:16.079+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Sep 28 18:58:10 UTC 2016","customfield_12310420":"42457","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_120241151341_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-06-05T07:55:11.453+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-1539/watchers","watchCount":10,"isWatching":false},"created":"2010-08-13T15:36:00.221+0000","customfield_12310192":"We switched to a datanucleus version >= 2.2 a long time ago so this is fixed.","customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315150","id":"12315150","description":"released","name":"0.7.0","archived":false,"released":true,"releaseDate":"2011-03-29"}],"issuelinks":[{"id":"12336762","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12336762","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12493928","key":"HIVE-1862","self":"https://issues.apache.org/jira/rest/api/2/issue/12493928","fields":{"summary":"Revive partition filtering in the Hive MetaStore","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12336780","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12336780","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12494920","key":"HIVE-1899","self":"https://issues.apache.org/jira/rest/api/2/issue/12494920","fields":{"summary":"add a factory method for creating a synchronized wrapper for IMetaStoreClient","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}},{"id":"12336769","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12336769","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12493399","key":"HIVE-1853","self":"https://issues.apache.org/jira/rest/api/2/issue/12493399","fields":{"summary":"downgrade JDO version","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12336768","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12336768","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12472999","key":"HIVE-1609","self":"https://issues.apache.org/jira/rest/api/2/issue/12472999","fields":{"summary":"Support partition filtering in metastore","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-09-28T18:58:10.047+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312584","id":"12312584","name":"Metastore","description":"Tracks issue dealing with metastore."}],"timeoriginalestimate":null,"description":"When running hive as a service and running a high number of queries concurrently I end up with multiple threads running at 100% cpu without any progress.\n\nLooking at these threads I notice this thread(484e):\nat org.apache.hadoop.hive.metastore.ObjectStore.getMTable(ObjectStore.java:598)\n\nBut on a different thread(63a2):\nat org.apache.hadoop.hive.metastore.model.MStorageDescriptor.jdoReplaceField(MStorageDescriptor.java)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12453671","id":"12453671","filename":"ClassLoaderResolver.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-09-02T09:35:57.833+0000","size":26623,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12453671/ClassLoaderResolver.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12459337","id":"12459337","filename":"HIVE-1539.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-11-11T10:21:14.414+0000","size":563,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12459337/HIVE-1539.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12467673","id":"12467673","filename":"HIVE-1539-1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2011-01-06T21:50:01.515+0000","size":2952,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12467673/HIVE-1539-1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12452031","id":"12452031","filename":"thread_dump_hanging.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-08-13T15:38:26.769+0000","size":30986,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12452031/thread_dump_hanging.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123176","customfield_12312823":null,"summary":"Concurrent metastore threading problem ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12898279","id":"12898279","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"Thread dump.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-08-13T15:38:26.835+0000","updated":"2010-08-13T15:38:26.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12898808","id":"12898808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"This is starting to look more and more like a similar problem we have on the jdbc driver (HIVE-1428). the HiveMetatStoreClient is doing calls on the thrift client but the thrift client isn't threadsafe (probably by design). So when the HiveMetaStoreClient is used it should be synchronized or a new HiveMetaStoreClient object should be created for each thread.\n\nFrom the \"Hive\" class:\n\n  private IMetaStoreClient getMSC() throws MetaException {\n    if (metaStoreClient == null) {\n      metaStoreClient = createMetaStoreClient();\n    }\n    return metaStoreClient;\n  }\n\nI could make the sync factory we use on HIVE-1428 a common thing and reuse it here. Any objections?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-08-16T07:01:40.968+0000","updated":"2010-08-16T07:01:40.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12898810","id":"12898810","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"That would be HIVE-1482 not 28 :(","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-08-16T07:07:57.875+0000","updated":"2010-08-16T07:07:57.875+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12899157","id":"12899157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pauly","name":"pauly","key":"pauly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Paul Yang","active":true,"timeZone":"America/Los_Angeles"},"body":"From looking at the Hive class, we are creating a ThreadLocal instance of Hive when we call get(). Since the HiveMetaStoreClient is a member of Hive, shouldn't the client be accessed by only 1 thread at a time?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pauly","name":"pauly","key":"pauly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Paul Yang","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-08-16T22:46:16.079+0000","updated":"2010-08-16T22:46:16.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12901356","id":"12901356","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"thanks Paul, I didn't notice that yet so in theory it shouldn't be the cause. However after synchronizing the metastore client I never saw this problem again where I used to see this problem every day.\nStrange issue. I'll see if I can create something reproducible but that might be tricky for this type of problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-08-23T11:36:24.358+0000","updated":"2010-08-23T11:36:24.358+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12904093","id":"12904093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"Ok, I just had another few instances of hanging threads. Last time I used a SynchronizedFactory to eliminate any threading issues in the metastore client but that doesn't solve it like Paul correctly saw.\n\n\"pool-1-thread-224\" prio=10 tid=0x00007f717d62c800 nid=0x7b4d runnable [0x000000004557c000]\n   java.lang.Thread.State: RUNNABLE\n        at java.util.HashMap.get(HashMap.java:303)\n        at org.datanucleus.util.ReferenceValueMap.get(ReferenceValueMap.java:186)\n        at org.datanucleus.JDOClassLoaderResolver.classForName(JDOClassLoaderResolver.java:185)\n        at org.datanucleus.JDOClassLoaderResolver.classForName(JDOClassLoaderResolver.java:415)\n        at org.datanucleus.store.mapped.MappedTypeManager.isSupportedMappedType(MappedTypeManager.java:84)\n        at org.datanucleus.store.rdbms.query.legacy.AbstractIteratorStatement.<init>(AbstractIteratorStatement.java:83)\n        at org.datanucleus.store.rdbms.query.legacy.UnionIteratorStatement.<init>(UnionIteratorStatement.java:147)\n        at org.datanucleus.store.rdbms.query.legacy.ClassTableExtent.newQueryStatement(ClassTableExtent.java:204)\n        at org.datanucleus.store.rdbms.query.legacy.QueryCompiler.executionCompile(QueryCompiler.java:323)\n        at org.datanucleus.store.rdbms.query.legacy.JDOQLQueryCompiler.compile(JDOQLQueryCompiler.java:225)\n        at org.datanucleus.store.rdbms.query.legacy.JDOQLQuery.compileInternal(JDOQLQuery.java:175)\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1628)\n        at org.datanucleus.store.rdbms.query.legacy.JDOQLQuery.executeQuery(JDOQLQuery.java:245)\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1499)\n        at org.datanucleus.jdo.JDOQuery.execute(JDOQuery.java:243)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getMDatabase(ObjectStore.java:323)\n        at org.apache.hadoop.hive.metastore.ObjectStore.convertToMTable(ObjectStore.java:640)\n        at org.apache.hadoop.hive.metastore.ObjectStore.alterTable(ObjectStore.java:946)\n        at org.apache.hadoop.hive.metastore.HiveAlterHandler.alterTable(HiveAlterHandler.java:177)\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$23.run(HiveMetaStore.java:1329)\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler$23.run(HiveMetaStore.java:1326)\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:229)\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.alter_table(HiveMetaStore.java:1326)\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.alter_table(HiveMetaStoreClient.java:143)\n        at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.hadoop.hive.common.SynchronizedFactory$Handler.invoke(SynchronizedFactory.java:46)\n        - locked <0x00000007ffc6fd00> (a org.apache.hadoop.hive.metastore.HiveMetaStoreClient)\n        at $Proxy8.alter_table(Unknown Source)\n        at org.apache.hadoop.hive.ql.metadata.Hive.alterTable(Hive.java:267)\n        at org.apache.hadoop.hive.ql.metadata.Hive.loadTable(Hive.java:875)\n        at org.apache.hadoop.hive.ql.exec.MoveTask.execute(MoveTask.java:174)\n        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:108)\n        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:55)\n        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:609)\n        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:478)\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:356)\n        at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:114)\n        at org.apache.hadoop.hive.service.ThriftHive$Processor$execute.process(ThriftHive.java:378)\n        at org.apache.hadoop.hive.service.ThriftHive$Processor.process(ThriftHive.java:366)\n        at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:252)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-08-30T07:09:49.172+0000","updated":"2010-08-30T07:09:49.172+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12905455","id":"12905455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"JDOClassLoaderResolver doesn't seem thread safe. That's a bit of a surprise. I filed a bug with datanucleus: \nhttp://www.datanucleus.org/servlet/jira/browse/NUCCORE-559\nI just made my own threadsafe version of the JDOClassLoaderResolver and am loading it to see if that fixes it. Will probably take a few days to be sure it got fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-09-02T08:58:37.292+0000","updated":"2010-09-02T08:58:37.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12905463","id":"12905463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"Ok still testing it but this is a temporary fix we add our own sync. version of the classloader:\n\nJust make sure you add these properties and it should work:\n<property>\n  <name>datanucleus.classLoaderResolverName</name>\n  <value>syncloader</value>\n</property>\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-09-02T09:35:57.902+0000","updated":"2010-09-02T09:35:57.902+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12908472","id":"12908472","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"Patch got comitted on datanucleus 2.2.0.m2\nWe could consider moving from 2.0 to 2.2\nThe temporary fix of loading your own classloader also wroked nicely.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-09-12T14:12:15.205+0000","updated":"2010-09-12T14:12:15.205+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12930974","id":"12930974","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"2.2.0-m2 can now be found on maven so the previous patch can be discarded and you can simple update the ivy/libraries/properties file to use datanucleus 2.2.0-m2.\n\nsince -m2 is a milestone release I'm not sure if we would want to include this or wait for 2.2.0 release.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2010-11-11T10:21:14.453+0000","updated":"2010-11-11T10:21:14.453+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12965515","id":"12965515","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"body":"According to the datanucleus website, 2.2.0 is scheduled for 10-Dec, so let's wait for it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"created":"2010-12-01T01:01:43.006+0000","updated":"2010-12-01T01:01:43.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12978521","id":"12978521","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"patch to go from datanucleus 2.0 to 2.2.0-release. I had to make a small change to the Utilities class since some package names changed. I also had to add some extra excludes on the metastore/ivy.xml","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2011-01-06T21:50:01.608+0000","updated":"2011-01-06T21:50:01.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12978538","id":"12978538","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"@Bennie,\n\nSince this bug was filed, we upgraded from 2.0.3 to 2.1.1 (in HIVE-1609) Some bugs then showed up which were attributed to that jdo lib upgrade (HIVE-1853) so it was rolled back to 2.0.3 Investigation is still on for them in HIVE-1862 So, before committing to still higher version of jdo 2.2.0 we need to make sure it doesn't result in test case failure listed in HIVE-1862.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-01-06T22:17:02.177+0000","updated":"2011-01-06T22:17:02.177+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12978665","id":"12978665","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"Thanks Ashutosh, I was waiting for the test result and as you predicted just got a build failed. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2011-01-07T07:45:39.049+0000","updated":"2011-01-07T07:45:39.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/12978698","id":"12978698","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"body":"Are we getting errors like these on HIVE-1862 ? :\n    [junit] Exception: java.lang.RuntimeException: The table default__show_idx_full_idx_comment__ is an index table. Please do drop index instead.\n    [junit] org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: The table default__show_idx_full_idx_comment__ is an index table. Please do drop index instead.\n\nOr is this something else?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bennies","name":"bennies","key":"bennies","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bennie Schut","active":true,"timeZone":"Europe/Berlin"},"created":"2011-01-07T09:10:58.718+0000","updated":"2011-01-07T09:10:58.718+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12471563/comment/15530543","id":"15530543","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sharathmk99","name":"sharathmk99","key":"sharathmk99","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sharath MK","active":true,"timeZone":"Asia/Kolkata"},"body":"I'm facing the same problem. \nI'm not able to run concurrent query using JDBC java program.\nIf any one solved, please direct me to some example java program.\nThanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sharathmk99","name":"sharathmk99","key":"sharathmk99","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sharath MK","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-09-28T18:58:10.047+0000","updated":"2016-09-28T18:58:10.047+0000"}],"maxResults":16,"total":16,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-1539/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lflb:"}}