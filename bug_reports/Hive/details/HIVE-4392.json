{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12643864","self":"https://issues.apache.org/jira/rest/api/2/issue/12643864","key":"HIVE-4392","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324312","id":"12324312","description":"released","name":"0.12.0","archived":false,"released":true,"releaseDate":"2013-10-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-04-22T07:45:15.006+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 15 23:31:31 UTC 2013","customfield_12310420":"324231","customfield_12312320":null,"customfield_12310222":"10002_*:*_2_*:*_1163091397_*|*_1_*:*_2_*:*_225809798_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-05-08T05:15:19.989+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4392/watchers","watchCount":7,"isWatching":false},"created":"2013-04-22T03:26:58.831+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12368712","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12368712","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12646559","key":"HIVE-4522","self":"https://issues.apache.org/jira/rest/api/2/issue/12646559","fields":{"summary":"Confusing result generated when use mulit aggregate functions with star columns","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12367820","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12367820","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12643848","key":"HIVE-4391","self":"https://issues.apache.org/jira/rest/api/2/issue/12643848","fields":{"summary":"Windowing function doesn't work in conjunction with CTAS","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-15T23:31:31.229+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":null,"description":"For Example:\n\nhive (default)> create table liza_1 as \n              > select *, sum(key), sum(value) \n              > from new_src;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks determined at compile time: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201304191025_0003, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0003\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0003\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 1\n2013-04-22 11:09:28,017 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:09:34,054 Stage-1 map = 0%,  reduce = 100%\n2013-04-22 11:09:37,074 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0003\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nFAILED: Error in metadata: InvalidObjectException(message:liza_1 is not a valid object name)\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask\nMapReduce Jobs Launched: \nJob 0: Reduce: 1   HDFS Read: 0 HDFS Write: 12 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\n\nhive (default)> create table liza_1 as         \n              > select *, sum(key), sum(value) \n              > from new_src                   \n              > group by key, value;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201304191025_0004, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0004\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0004\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 1\n2013-04-22 11:11:58,945 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:12:01,964 Stage-1 map = 0%,  reduce = 100%\n2013-04-22 11:12:04,982 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0004\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nFAILED: Error in metadata: InvalidObjectException(message:liza_1 is not a valid object name)\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask\nMapReduce Jobs Launched: \nJob 0: Reduce: 1   HDFS Read: 0 HDFS Write: 0 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\n\nBut the following tow Queries  work:\nhive (default)> create table liza_1 as select * from new_src;\nTotal MapReduce jobs = 3\nLaunching Job 1 out of 3\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_201304191025_0006, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0006\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0006\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 0\n2013-04-22 11:15:00,681 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:15:03,697 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0006\nStage-4 is selected by condition resolver.\nStage-3 is filtered out by condition resolver.\nStage-5 is filtered out by condition resolver.\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive-scratchdir/hive_2013-04-22_11-14-54_632_6709035018023861094/-ext-10001\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nTable default.liza_1 stats: [num_partitions: 0, num_files: 0, num_rows: 0, total_size: 0, raw_data_size: 0]\nMapReduce Jobs Launched: \nJob 0:  HDFS Read: 0 HDFS Write: 0 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\nOK\nTime taken: 9.576 seconds\n\nhive (default)> create table liza_1 as\n              > select sum (key), sum(value) \n              > from new_test;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks determined at compile time: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201304191025_0008, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0008\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0008\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 1\n2013-04-22 11:22:52,200 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:22:55,216 Stage-1 map = 0%,  reduce = 100%\n2013-04-22 11:22:58,234 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0008\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nTable default.liza_1 stats: [num_partitions: 0, num_files: 1, num_rows: 0, total_size: 6, raw_data_size: 0]\nMapReduce Jobs Launched: \nJob 0: Reduce: 1   HDFS Read: 0 HDFS Write: 6 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\nOK\nTime taken: 11.115 seconds\n\n\nIn MySQL :\nmysql> select * from example ;\n+------+------+\n| id   | data |\n+------+------+\n|    1 | 2    |\n|    2 | 2    |\n|    3 | 3    |\n+------+------+\n3 rows in set (0.00 sec)\n\nmysql> select *, sum(id),count(data)  from example ;\n+------+------+---------+-------------+\n| id   | data | sum(id) | count(data) |\n+------+------+---------+-------------+\n|    1 | 2    |       6 |           3 |\n+------+------+---------+-------------+\n1 row in set (0.03 sec)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579796","id":"12579796","filename":"HIVE-4392.D10431.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-22T07:45:15.132+0000","size":13173,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12579796/HIVE-4392.D10431.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579986","id":"12579986","filename":"HIVE-4392.D10431.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-23T06:31:15.002+0000","size":25876,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12579986/HIVE-4392.D10431.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580450","id":"12580450","filename":"HIVE-4392.D10431.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-25T02:06:14.211+0000","size":26981,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12580450/HIVE-4392.D10431.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12581090","id":"12581090","filename":"HIVE-4392.D10431.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-30T00:32:15.404+0000","size":31632,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12581090/HIVE-4392.D10431.4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12581646","id":"12581646","filename":"HIVE-4392.D10431.5.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-03T00:52:14.213+0000","size":50037,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12581646/HIVE-4392.D10431.5.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"324576","customfield_12312823":null,"summary":"Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Apache Hadoop 0.20.1\nApache Hive Trunk\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13637815","id":"13637815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis requested code review of \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\nReviewers: JIRA\n\nHIVE-4392 Illogical InvalidObjectException throwed when use multi aggregate functions with star columns\n\nFor Example:\n\nhive (default)> create table liza_1 as\n              > select *, sum(key), sum(value)\n              > from new_src;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks determined at compile time: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201304191025_0003, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0003\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0003\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 1\n2013-04-22 11:09:28,017 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:09:34,054 Stage-1 map = 0%,  reduce = 100%\n2013-04-22 11:09:37,074 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0003\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nFAILED: Error in metadata: InvalidObjectException(message:liza_1 is not a valid object name)\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask\nMapReduce Jobs Launched:\nJob 0: Reduce: 1   HDFS Read: 0 HDFS Write: 12 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\n\nhive (default)> create table liza_1 as\n              > select *, sum(key), sum(value)\n              > from new_src\n              > group by key, value;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201304191025_0004, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0004\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0004\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 1\n2013-04-22 11:11:58,945 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:12:01,964 Stage-1 map = 0%,  reduce = 100%\n2013-04-22 11:12:04,982 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0004\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nFAILED: Error in metadata: InvalidObjectException(message:liza_1 is not a valid object name)\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask\nMapReduce Jobs Launched:\nJob 0: Reduce: 1   HDFS Read: 0 HDFS Write: 0 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\n\nBut the following tow Queries  work:\nhive (default)> create table liza_1 as select * from new_src;\nTotal MapReduce jobs = 3\nLaunching Job 1 out of 3\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_201304191025_0006, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0006\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0006\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 0\n2013-04-22 11:15:00,681 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:15:03,697 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0006\nStage-4 is selected by condition resolver.\nStage-3 is filtered out by condition resolver.\nStage-5 is filtered out by condition resolver.\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive-scratchdir/hive_2013-04-22_11-14-54_632_6709035018023861094/-ext-10001\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nTable default.liza_1 stats: [num_partitions: 0, num_files: 0, num_rows: 0, total_size: 0, raw_data_size: 0]\nMapReduce Jobs Launched:\nJob 0:  HDFS Read: 0 HDFS Write: 0 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\nOK\nTime taken: 9.576 seconds\n\nhive (default)> create table liza_1 as\n              > select sum (key), sum(value)\n              > from new_test;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks determined at compile time: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201304191025_0008, Tracking URL = http://hd17-vm5:51030/jobdetails.jsp?jobid=job_201304191025_0008\nKill Command = /home/zongren/hadoop-current/bin/../bin/hadoop job  -kill job_201304191025_0008\nHadoop job information for Stage-1: number of mappers: 0; number of reducers: 1\n2013-04-22 11:22:52,200 Stage-1 map = 0%,  reduce = 0%\n2013-04-22 11:22:55,216 Stage-1 map = 0%,  reduce = 100%\n2013-04-22 11:22:58,234 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201304191025_0008\nMoving data to: hdfs://hd17-vm5:9101/user/zongren/hive/liza_1\nTable default.liza_1 stats: [num_partitions: 0, num_files: 1, num_rows: 0, total_size: 6, raw_data_size: 0]\nMapReduce Jobs Launched:\nJob 0: Reduce: 1   HDFS Read: 0 HDFS Write: 6 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\nOK\nTime taken: 11.115 seconds\n\nTEST PLAN\n  EMPTY\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nAFFECTED FILES\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n  ql/src/test/queries/clientpositive/ctas_colname.q\n  ql/src/test/results/clientpositive/ctas_colname.q.out\n\nMANAGE HERALD RULES\n  https://reviews.facebook.net/herald/view/differential/\n\nWHY DID I GET THIS EMAIL?\n  https://reviews.facebook.net/herald/transcript/24963/\n\nTo: JIRA, navis\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-22T07:45:15.006+0000","updated":"2013-04-22T07:45:15.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13637817","id":"13637817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Looks like same bug is causing HIVE-4391 as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-22T07:52:12.996+0000","updated":"2013-04-22T07:52:12.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13638088","id":"13638088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Since, HIVE-4391 is very similar to this. I tried with this patch and the queries posted there (e.g.,  from t2 insert overwrite  table t7  select c1, rank() over() ; ) . This query used to fail exactly as in the stacktrace here earlier (ie, after executing MR job, failing saying InvalidObjectException). But now fails at compile time itself with exception\n{noformat}\nFAILED: SemanticException [Error 10001]: Line 1:32 Table not found 't7'\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-22T15:13:24.151+0000","updated":"2013-04-22T15:42:17.695+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13638615","id":"13638615","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"I'll check that. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-23T00:30:52.174+0000","updated":"2013-04-23T00:30:52.174+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13638626","id":"13638626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~ashutoshc] It's not CTAS and it seemed t7 is not exist. I've tried \"create table x2 as select *, rank() over() as rr from src\" and it worked.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-23T00:49:27.649+0000","updated":"2013-04-23T00:49:27.649+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13638653","id":"13638653","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~navis] You are correct (as always : ) ). It does indeed work. Can you add some variant of following tests in the patch. I verified these tests work. I meanwhile will review the patch.\n{code}\n create table x4 as select *, rank() over(partition by c1 order by c2)  as rr from t1; \n select * from x4;  \ncreate table x5 as select *, lead(c3,1) over(partition by c1 order by c2)   from t1 limit 5;\nselect * from x5;\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-23T01:09:50.321+0000","updated":"2013-04-23T01:10:13.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13638837","id":"13638837","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis updated the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\n  Added test cases\n\nReviewers: JIRA\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D10431?vs=32607&id=32715#toc\n\nAFFECTED FILES\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n  ql/src/test/queries/clientpositive/ctas_colname.q\n  ql/src/test/results/clientpositive/ctas_colname.q.out\n\nTo: JIRA, navis\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-23T06:31:14.900+0000","updated":"2013-04-23T06:31:14.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13639122","id":"13639122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-23T14:46:02.537+0000","updated":"2013-04-23T14:46:02.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13639123","id":"13639123","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"ashutoshc has requested changes to the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\n  .q.out file changes doesn't look right for windowing functions.\n\nINLINE COMMENTS\n  ql/src/test/results/clientpositive/ctas_colname.q.out:245 This doesn't look right. There should be three columns here, not 4.\n  Column _col2 looks suspicious.\n  ql/src/test/results/clientpositive/ctas_colname.q.out:291 Some rows here have 3 columns and others have 4 columns. How is that possible?\n  ql/src/test/results/clientpositive/ctas_colname.q.out:430 Again, there should only be 3 columns here, not 4.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nBRANCH\n  HIVE-4392\n\nARCANIST PROJECT\n  hive\n\nTo: JIRA, ashutoshc, navis\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-23T14:47:14.554+0000","updated":"2013-04-23T14:47:14.554+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13639981","id":"13639981","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis has commented on the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\nINLINE COMMENTS\n  ql/src/test/results/clientpositive/ctas_colname.q.out:245 PTF operator, which is parent of SEL hands over 3 columns(except vcs). One window column and two other columns(key, value). So * is resolved into theses three columns and adding one window column(rank()..) makes 4 columns.\n\n  it's similar to \"select *, key from src\" returning 3 columns.\n  ql/src/test/results/clientpositive/ctas_colname.q.out:291 The table 'src1' has null columns which makes query result very confusing.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nBRANCH\n  HIVE-4392\n\nARCANIST PROJECT\n  hive\n\nTo: JIRA, ashutoshc, navis\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-24T01:59:14.141+0000","updated":"2013-04-24T01:59:14.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13639996","id":"13639996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"ashutoshc has added CCs to the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\nAdded CCs: hbutani\n\n  I think we need to fix why in case of windowing we have an extra column.\n  CCing Harish, who may have an insight into this.\n\nINLINE COMMENTS\n  ql/src/test/results/clientpositive/ctas_colname.q.out:245 I see why is this happening. But that still against the semantics. When I do create table t1 as select * , rank() from src; where src has 2 columns. I expect t1 to have 3 columns, not 4. Isn't it ?\n  ql/src/test/results/clientpositive/ctas_colname.q.out:291 I thought when column is null, we print NULL for column, how come its empty string in this case?\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nBRANCH\n  HIVE-4392\n\nARCANIST PROJECT\n  hive\n\nTo: JIRA, ashutoshc, navis\nCc: hbutani\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-24T02:19:13.982+0000","updated":"2013-04-24T02:19:13.982+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13640004","id":"13640004","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis has commented on the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\nINLINE COMMENTS\n  ql/src/test/results/clientpositive/ctas_colname.q.out:245 Yes, I think windows columns should be marked as hidden-virtual column. But I can't decide it cause I don't know anything on windowing functions.\n  ql/src/test/results/clientpositive/ctas_colname.q.out:291 You are right, what's that then? I should investigate on it.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nBRANCH\n  HIVE-4392\n\nARCANIST PROJECT\n  hive\n\nTo: JIRA, ashutoshc, navis\nCc: hbutani\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-24T02:31:13.595+0000","updated":"2013-04-24T02:31:13.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13640016","id":"13640016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~rhbutani] Do you think marking windowing column as hidden virtual column is a wise thing to do?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-24T02:43:41.375+0000","updated":"2013-04-24T02:43:41.375+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13640136","id":"13640136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis has commented on the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\nINLINE COMMENTS\n  ql/src/test/results/clientpositive/ctas_colname.q.out:245 I've changed window columns to hidden virtual columns and it seemed working good (passed ptf* and window* in client positive tests in ql). But still need a confirmation from Harish.\n  ql/src/test/results/clientpositive/ctas_colname.q.out:291 My bad. It's empty string, not null.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nBRANCH\n  HIVE-4392\n\nARCANIST PROJECT\n  hive\n\nTo: JIRA, ashutoshc, navis\nCc: hbutani\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-24T06:01:14.155+0000","updated":"2013-04-24T06:01:14.155+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13640541","id":"13640541","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~navis] Can you update the phabricator entry with your fix. I will take a look.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-24T15:35:15.980+0000","updated":"2013-04-24T15:35:15.980+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13640902","id":"13640902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"But the check in genFileSinkPlan doesn't work for this query:\n{noformat}\ncreate table x4 as select * from (select *, rank() over(partition by key order by value) as rr from src1) a\n{noformat}\n\nIt would be nice to fix this in genSelectPlan. \n- both PTFOp and GByOp set the agg function expression's ColInfo.alias as the ast.toStringTree\n- because of the star, genColListRegex adds the ColInfo's for these to the out_schema\n- then in the expr loop in genSelectPlan, the expression is added again, using the alias specified this time.\n\nStill trying to see how to prevent the expression from being added twice:\n- the straightforward answer would be to check in genColListRegex if the ColInfo.alias matches some expression.toStringTree on the SelectList. But to me it appears that this would require reproducing a lot of logic that is in genSelectPlan here.\n- a potential simple check is, to check in genColListRegex if the alias is a validName; if not then the Column represents an expression that will get added explicitly in the genSelectPlan expr loop. But I am not sure if this is a bullet proof check.\nBy adding the following, around line 1816 in SemAnalyzer, I get the above e.g. to work:\n{noformat}\n       if ( !MetaStoreUtils.validateName(entry.getKey()) ) {\n         continue;\n       }\n{noformat}\nBut haven't run any other tests, so this is very preliminary.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-24T20:27:52.007+0000","updated":"2013-04-24T20:27:52.007+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13641304","id":"13641304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis updated the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\n  Changed window/ptf columns to hidden virtual column\n\nReviewers: ashutoshc, JIRA\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D10431?vs=32715&id=32847#toc\n\nAFFECTED FILES\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/PTFTranslator.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n  ql/src/test/queries/clientpositive/ctas_colname.q\n  ql/src/test/results/clientpositive/ctas_colname.q.out\n\nTo: JIRA, ashutoshc, navis\nCc: hbutani\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-25T02:06:14.081+0000","updated":"2013-04-25T02:06:14.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13641528","id":"13641528","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~rhbutani] I didn't completely follow your suggestion. But, Navis's trick of treating the window column as hidden virtual column seems to have fixed the issue. I tested the test-case you have posted. That seems to have worked. I also ran all windowing and ptf tests those worked too. Can you take a look at Navis's latest patch to see if that looks right.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-25T07:34:03.552+0000","updated":"2013-04-25T07:34:03.552+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13642229","id":"13642229","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"In PTFTranslator, only the change on line 1053(pertaining to Window Functions) should be made. \n\nBut to me it looks like the issue is the same for both PTFOp and GByOp. And the issue is in how the RowResolver is constructed in SelectOp when a '*' is present in the Select List.\n\nThe combination of:\n1. using the internalName in genFileSinkPlan when the input column has no table Alias.\n2. making the Windowing expressions hidden Virtual\n\nWorks for PTFs. But same thing has to be done for GBy.\n\n1. For this e.g.  \n{noformat}\ncreate table x4 as select *, min(value) from src1\n{noformat}\n the output schema still has 2 columns instead of 1; the GByOp's RowResolver has 1 column; but the SelectOp's RR has 2 columns.\n\n2. This one still fails:\n{noformat}\ncreate table x4 as select * from (select *, min(value) from src1) a\n{noformat}\n\nI wonder if you can make the aggregations expressions in GByOp virtual hidden? They maybe referenced in a Having clause.\nA more direct fix maybe to avoid adding these SelectExprs twice in the SelectOp RR. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-25T21:16:38.002+0000","updated":"2013-04-25T21:16:38.002+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13642335","id":"13642335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I see. Thanks for explanation. I agree right fix is to correctly handle * and not add select list twice in such cases. I would make following proposal. \nFor 0.11 we go ahead with current fix and track the correct fix in a new jira.  \n[~navis] / [~rhbutani] What do you guys think ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-25T22:51:18.021+0000","updated":"2013-04-25T22:51:18.021+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13642508","id":"13642508","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"Harish is right. Query 2 is failing and it's apparent that the patch is still missing something even for a stopgap. I'll look into this more.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-26T02:00:03.564+0000","updated":"2013-04-26T02:00:03.564+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13645095","id":"13645095","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis updated the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\n  Addressed comments\n\nReviewers: ashutoshc, JIRA\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D10431?vs=32847&id=33177#toc\n\nAFFECTED FILES\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/PTFTranslator.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n  ql/src/test/queries/clientpositive/ctas_colname.q\n  ql/src/test/results/clientpositive/ctas_colname.q.out\n\nTo: JIRA, ashutoshc, navis\nCc: hbutani\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-30T00:32:15.227+0000","updated":"2013-04-30T00:32:15.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13645096","id":"13645096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~rhbutani] / [~ashutoshc] Updated patch. Could you take a look at it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-30T00:32:43.113+0000","updated":"2013-04-30T00:32:43.113+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13645952","id":"13645952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~navis] You opted to make aggregate column virtual hidden. But as [~rhbutani] this may still be problematic when these aggregate columns are referenced in having clause. e.g, consider query 2 from Harish's example with groupby and having clause in subquery. Did you test that.\n\nAlso as Harish suggested root problem here is\nbq. And the issue is in how the RowResolver is constructed in SelectOp when a '*' is present in the Select List.\n\nSo, proper fix is to correctly handle * and only add requisite columns in RowResolver of select Op and thereby avoiding duplication of columns in first place. Wondering if you explored that route ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-30T20:41:35.195+0000","updated":"2013-04-30T20:41:35.195+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13646879","id":"13646879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I played bit more with the patch and tried out following queries:\n{quote}\n create table x6 as select * from (select * from t1 group by key) a;\n create table x6 as select * from (select * from t1 group by key having key < 9) a;\n create table x7 as select * from (select max(value),key from t1 group by key having key < 9) a;\n{quote}\n\nAll of the above worked, so seems like patch is effective. [~rhbutani] Do you think there could be other queries which you think might still be broken. I am fine with moving forward with the current patch, unless [~rhbutani] or [~navis] you guys want to do further investigation on the proper fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-01T20:06:35.846+0000","updated":"2013-05-01T20:06:35.846+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13647165","id":"13647165","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"I've understood this issue is for temporal stopgap. Wasn't it?\n\nMaking a column as VHC does not affect resolving it in \"having\" or others and just affects \"select\" clause. And changing aggregation columns to VHC might make backward compatibility issue (different schema).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-05-02T01:32:27.378+0000","updated":"2013-05-02T01:32:27.378+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13647182","id":"13647182","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I was suggesting this as a stopgap for 0.11. But since now that 0.11 has already shipped there is no rush. So, now we can take time to fix it the proper way. There are few alternatives now:\n* We check this fix in and forget about the issue.\n* We check this fix in to fix the issue on trunk and create another jira to track proper fix.\n* We don't check in this fix and explore the proper fix (of correctly handling * in RR of select op) in this jira and try to get that in trunk.\n\n[~navis] Since you are the one actively working on the issue, I will let you make the call for it. I am fine with any of three options.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-02T01:53:09.387+0000","updated":"2013-05-02T01:53:09.387+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13647284","id":"13647284","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"I agree [~navis] your call.\n\nBut couple of related observations, what are your thoughts on this.\nIf you do this query:\n{noformat}\nselect *, max(p_size), min(p_size) from part\n{noformat}\n- The output has 4 columns. It will always be twice the number of aggregation expressions. \n- If you do this\n{noformat}\nselect *, max(p_size), min(p_size) from part group by p_name\n{noformat}\n- you get 5 columns.\n- This is because the * applies to the schema of the GBy Op.\n- In the case of the PTFs you don't get duplicates because the agg. expressions are marked as VHC.\n- But if you try either of these in Postgres\n{noformat}\nselect *, max(p_size) from part\nselect *, max(p_size) from part group by p_name\n{noformat}\n- they fail; giving an error to the effect the part columns are not in Group By.\n- So the '*' is resolved against the schema before the GBy \n- I think the behavior in Hive makes more sense; at some point should we change it so that we don't get duplicate output columns for aggregations?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-02T04:40:53.704+0000","updated":"2013-05-02T04:40:53.704+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13647288","id":"13647288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~charish] I was writing on the same issue, and now I see your comment. Thanks.\nFor the patch, I think this would be enough for now. But it's based on assumptions which can be broken if things changed, so let's include tests mentioned above and wait for next fail (and fix then).\n\nAnd.. it seemed better to decide whether aggregation columns should be included or not for select-star in here. I prefer to change it not-included, but I'm not sure of it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-05-02T04:55:52.370+0000","updated":"2013-05-02T04:55:52.370+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13647690","id":"13647690","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Ok. Lets go ahead with this patch than. [~navis] Do you want to update the patch with these tests or shall I go ahead with testing it for commit?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-02T16:50:53.812+0000","updated":"2013-05-02T16:50:53.812+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13648068","id":"13648068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis updated the revision \"HIVE-4392 [jira] Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns\".\n\n  Added tests\n\nReviewers: ashutoshc, JIRA\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10431\n\nCHANGE SINCE LAST DIFF\n  https://reviews.facebook.net/D10431?vs=33177&id=33285#toc\n\nAFFECTED FILES\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n  metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/PTFTranslator.java\n  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n  ql/src/test/queries/clientpositive/ctas_colname.q\n  ql/src/test/results/clientpositive/ctas_colname.q.out\n\nTo: JIRA, ashutoshc, navis\nCc: hbutani\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-03T00:52:14.071+0000","updated":"2013-05-03T00:52:14.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13648069","id":"13648069","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"Added tests. Not changed aggregation columns.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-05-03T00:52:32.992+0000","updated":"2013-05-03T00:52:32.992+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13651545","id":"13651545","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"body":"hive>create table summary as select *, sum(key), count(value) from src;\nhive>select * from summary;\n130091.0\t500\t130091.0\t500\n\nSuch kind of query will generate only one row of result ? \nAnd the the first two column values are not correct ?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-05-08T01:51:01.572+0000","updated":"2013-05-08T01:51:01.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13651575","id":"13651575","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"body":"hive (default)> select * from src_for_test;\n\t35\n48\t\n100\t100\nhive (default)> select *, sum(key), count(value)  from src_for_test group by key, value ;\n\t35\t0.0\t1\t0.0\t1\n100\t100\t100.0\t1\t100.0\t1\n48\t\t48.0\t1\t48.0\t1\n\ntwo more columns generated!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=caofangkun","name":"caofangkun","key":"caofangkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=caofangkun&avatarId=23151","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=caofangkun&avatarId=23151","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=caofangkun&avatarId=23151","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=caofangkun&avatarId=23151"},"displayName":"caofangkun","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-05-08T02:51:46.594+0000","updated":"2013-05-08T02:51:46.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13651625","id":"13651625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~caofangkun] As discussed earlier on this thread, I went ahead with the commit of the patch. Can you test  on top of trunk and please feel free to open new jiras if you think behavior is incorrect.\n\nCommitted to trunk. Thanks, Navis!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-05-08T05:14:02.566+0000","updated":"2013-05-08T05:14:02.566+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13651879","id":"13651879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-h0.21 #2091 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2091/])\n    HIVE-4392 : Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns  (Navis via Ashutosh Chauhan) (Revision 1480161)\n\n     Result = FAILURE\nhashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1480161\nFiles : \n* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/PTFTranslator.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n* /hive/trunk/ql/src/test/queries/clientpositive/ctas_colname.q\n* /hive/trunk/ql/src/test/results/clientpositive/ctas_colname.q.out\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-08T13:29:18.442+0000","updated":"2013-05-08T13:29:18.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13652669","id":"13652669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-hadoop2 #188 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/188/])\n    HIVE-4392 : Illogical InvalidObjectException throwed when use mulit aggregate functions with star columns  (Navis via Ashutosh Chauhan) (Revision 1480161)\n\n     Result = ABORTED\nhashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1480161\nFiles : \n* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\n* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java\n* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/PTFTranslator.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n* /hive/trunk/ql/src/test/queries/clientpositive/ctas_colname.q\n* /hive/trunk/ql/src/test/results/clientpositive/ctas_colname.q.out\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2013-05-09T02:10:15.015+0000","updated":"2013-05-09T02:10:15.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12643864/comment/13796165","id":"13796165","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-10-15T23:31:31.219+0000","updated":"2013-10-15T23:31:31.219+0000"}],"maxResults":38,"total":38,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4392/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1jxtr:"}}