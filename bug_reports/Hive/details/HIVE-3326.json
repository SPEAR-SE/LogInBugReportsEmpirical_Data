{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12600953","self":"https://issues.apache.org/jira/rest/api/2/issue/12600953","key":"HIVE-3326","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2012-08-02T07:17:44.894+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Feb 25 06:52:53 UTC 2013","customfield_12310420":"259195","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_12364738_*|*_1_*:*_2_*:*_17958874235_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-02-25T06:52:53.780+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3326/watchers","watchCount":5,"isWatching":false},"created":"2012-08-01T06:52:14.903+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12364763","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12364763","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12623099","key":"HIVE-3784","self":"https://issues.apache.org/jira/rest/api/2/issue/12623099","fields":{"summary":"de-emphasize mapjoin hint","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-02-25T06:52:53.843+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315100","id":"12315100","name":"SQL","description":"Issues related to Hive Query Language and its conformance with ANSI SQL."}],"timeoriginalestimate":null,"description":"example queries:\n{code}\ncreate table yudi(c1 int, c2 int, c3 int, c4 int);\ncreate table wangmu(c1 int, c2 int, c3 int, c4 int);\nselect /*+mapjoin(b,c)*/ * from yudi a join yudi b on a.c1=b.c1 join wangmu c on b.c2=c.c2 join yudi d on a.c3=d.c3;\n{code}\nin explain mode, I got this:\n{code}\nhive> explain select /*+mapjoin(b,c)*/ * from yudi a join yudi b on a.c1=b.c1 join wangmu c on b.c2=c.c2 join yudi d on a.c3=d.c3;\nOK\nSTAGE DEPENDENCIES:\n  Stage-8 is a root stage\n  Stage-2 depends on stages: Stage-8\n  Stage-7 depends on stages: Stage-2\n  Stage-3 depends on stages: Stage-7\n  Stage-1 depends on stages: Stage-3\n\nSTAGE PLANS:\n  Stage: Stage-8\n    Map Reduce Local Work\n      Alias -> Map Local Tables:\n        b\n        <Not Important>\n  Stage: Stage-2\n    Map Reduce\n      Alias -> Map Operator Tree:\n        a\n        <Not Important>\n      Local Work:\n        Map Reduce Local Work\n\n  Stage: Stage-7\n    Map Reduce Local Work\n      Alias -> Map Local Tables:\n        c\n        <Not Important>\n  Stage: Stage-3\n    Map Reduce\n      Alias -> Map Operator Tree:\n           file:/var/folders/4w/3_nk1cwd4pd023mzx64p3r480000gn/T/dukezhang/hive_2012-08-01_14-01-37_152_5814747325029961632/-mr-10002\n        <Not Important>\n      Local Work:\n        Map Reduce Local Work\n\n  Stage: Stage-1\n    Map Reduce\n      Alias -> Map Operator Tree:\n        d\n          TableScan\n\n        file:/var/folders/4w/3_nk1cwd4pd023mzx64p3r480000gn/T/dukezhang/hive_2012-08-01_14-01-37_152_5814747325029961632/-mr-10002\n          Select Operator\n\n      Reduce Operator Tree:\n      <Not Important>\n{code}\nYou see, mapper of Stage-1 should read from Stage-3, maybe '.../-mr-10003', not Stage-2(result in '.../-mr-10002').\n\nTo resolve this bug, I found these codes(GenMapRedUtils.java, about line 431):\n{code:title=GenMapRedUtils.java}\nif (oldMapJoin == null) {\n  if (opProcCtx.getParseCtx().getListMapJoinOpsNoReducer().contains(mjOp)\n      || local || (oldTask != null) && (parTasks != null)) {\n    taskTmpDir = mjCtx.getTaskTmpDir();\n    tt_desc = mjCtx.getTTDesc();\n    rootOp = mjCtx.getRootMapJoinOp();\n    }\n} else {\n  GenMRMapJoinCtx oldMjCtx = opProcCtx.getMapJoinCtx(oldMapJoin);\n  assert oldMjCtx != null;\n  taskTmpDir = oldMjCtx.getTaskTmpDir();\n  tt_desc = oldMjCtx.getTTDesc();\n  rootOp = oldMjCtx.getRootMapJoinOp();\n}\n{code}\nmy query goes into 'else' block and gets wrong taskTmpDir. I hack them to let query go into 'if' block, and it works.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12565882","id":"12565882","filename":"HIVE-3326.D8091.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-01-22T00:42:12.164+0000","size":10963,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12565882/HIVE-3326.D8091.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12538652","id":"12538652","filename":"patch.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-01T07:07:58.826+0000","size":1524,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12538652/patch.diff"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"124444","customfield_12312823":null,"summary":"plan for multiple mapjoin followed by a normal join is wrong","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"OS X 10.8; java 1.6.0_33","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13426354","id":"13426354","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"body":"this is my patch for this bug. I use an unused argument to control my logic whether goes into 'else' block","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-01T07:07:58.870+0000","updated":"2012-08-01T07:07:58.870+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13427154","id":"13427154","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"I think the condition,\n{code}\nif (oldMapJoin == null) {\n{code}\nshould be changed to \n{code}\nif (oldMapJoin == null || !opProcCtx.getParseCtx().getListMapJoinOpsNoReducer().contains(oldMapJoin)) {\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2012-08-02T07:17:44.894+0000","updated":"2012-08-02T07:17:44.894+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13427270","id":"13427270","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"body":"coolï¼Thx","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yuzone","name":"yuzone","key":"yuzone","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zhang Xinyu","active":true,"timeZone":"Etc/UTC"},"created":"2012-08-02T12:28:04.057+0000","updated":"2012-08-02T12:28:04.057+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13559242","id":"13559242","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"I've forgot this issue for months. should be fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-01-22T00:41:33.899+0000","updated":"2013-01-22T00:41:33.899+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13559243","id":"13559243","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis requested code review of \"HIVE-3326 [jira] plan for multiple mapjoin followed by a normal join is wrong\".\nReviewers: JIRA\n\n  DPAL-1968 plan for multiple mapjoin followed by a normal join is wrong\n\n  example queries:\n\n  create table yudi(c1 int, c2 int, c3 int, c4 int);\n  create table wangmu(c1 int, c2 int, c3 int, c4 int);\n  select /*+mapjoin(b,c)*/ * from yudi a join yudi b on a.c1=b.c1 join wangmu c on b.c2=c.c2 join yudi d on a.c3=d.c3;\n\n  in explain mode, I got this:\n\n  hive> explain select /*+mapjoin(b,c)*/ * from yudi a join yudi b on a.c1=b.c1 join wangmu c on b.c2=c.c2 join yudi d on a.c3=d.c3;\n  OK\n  STAGE DEPENDENCIES:\n    Stage-8 is a root stage\n    Stage-2 depends on stages: Stage-8\n    Stage-7 depends on stages: Stage-2\n    Stage-3 depends on stages: Stage-7\n    Stage-1 depends on stages: Stage-3\n\n  STAGE PLANS:\n    Stage: Stage-8\n      Map Reduce Local Work\n        Alias -> Map Local Tables:\n          b\n          <Not Important>\n    Stage: Stage-2\n      Map Reduce\n        Alias -> Map Operator Tree:\n          a\n          <Not Important>\n        Local Work:\n          Map Reduce Local Work\n\n    Stage: Stage-7\n      Map Reduce Local Work\n        Alias -> Map Local Tables:\n          c\n          <Not Important>\n    Stage: Stage-3\n      Map Reduce\n        Alias -> Map Operator Tree:\n             file:/var/folders/4w/3_nk1cwd4pd023mzx64p3r480000gn/T/dukezhang/hive_2012-08-01_14-01-37_152_5814747325029961632/-mr-10002\n          <Not Important>\n        Local Work:\n          Map Reduce Local Work\n\n    Stage: Stage-1\n      Map Reduce\n        Alias -> Map Operator Tree:\n          d\n            TableScan\n\n          file:/var/folders/4w/3_nk1cwd4pd023mzx64p3r480000gn/T/dukezhang/hive_2012-08-01_14-01-37_152_5814747325029961632/-mr-10002\n            Select Operator\n\n        Reduce Operator Tree:\n        <Not Important>\n\n  You see, mapper of Stage-1 should read from Stage-3, maybe '.../-mr-10003', not Stage-2(result in '.../-mr-10002').\n\n  To resolve this bug, I found these codes(GenMapRedUtils.java, about line 431):\n  GenMapRedUtils.java\n\n  if (oldMapJoin == null) {\n    if (opProcCtx.getParseCtx().getListMapJoinOpsNoReducer().contains(mjOp)\n        || local || (oldTask != null) && (parTasks != null)) {\n      taskTmpDir = mjCtx.getTaskTmpDir();\n      tt_desc = mjCtx.getTTDesc();\n      rootOp = mjCtx.getRootMapJoinOp();\n      }\n  } else {\n    GenMRMapJoinCtx oldMjCtx = opProcCtx.getMapJoinCtx(oldMapJoin);\n    assert oldMjCtx != null;\n    taskTmpDir = oldMjCtx.getTaskTmpDir();\n    tt_desc = oldMjCtx.getTTDesc();\n    rootOp = oldMjCtx.getRootMapJoinOp();\n  }\n\n  my query goes into 'else' block and gets wrong taskTmpDir. I hack them to let query go into 'if' block, and it works.\n\nTEST PLAN\n  EMPTY\n\nREVISION DETAIL\n  https://reviews.facebook.net/D8091\n\nAFFECTED FILES\n  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java\n  ql/src/test/queries/clientpositive/mapjoin_mapjoin_join.q\n  ql/src/test/results/clientpositive/mapjoin_mapjoin_join.q.out\n\nMANAGE HERALD DIFFERENTIAL RULES\n  https://reviews.facebook.net/herald/view/differential/\n\nWHY DID I GET THIS EMAIL?\n  https://reviews.facebook.net/herald/transcript/19497/\n\nTo: JIRA, navis\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-01-22T00:42:12.094+0000","updated":"2013-01-22T00:42:12.094+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13559377","id":"13559377","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"comments on phabricator","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-01-22T04:07:38.640+0000","updated":"2013-01-22T04:07:38.640+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13559378","id":"13559378","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"njain has commented on the revision \"HIVE-3326 [jira] plan for multiple mapjoin followed by a normal join is wrong\".\n\n  Navis, I am not sure, we should support this.\n  https://issues.apache.org/jira/browse/HIVE-3784 is the right way to go.\n  We are adding way more complexity than is needed to solve this problem.\n\n  Let me refresh HIVE-3784 and try to address Ashutosh's concerns.\n\nREVISION DETAIL\n  https://reviews.facebook.net/D8091\n\nTo: JIRA, navis\nCc: njain\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-01-22T04:08:11.807+0000","updated":"2013-01-22T04:08:11.807+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13569858","id":"13569858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Now that HIVE-3784 went in, this bug is still present in GenMapRedUtils.java. But I suspect we will never encounter this because hints for multiple map-joins are no longer supported so its impossible to enforce map-joins. They will automatically get converted in physical optimizer. This implies though bug is there, there is no reasonable way to hit this code path. [~namit] is that correct ? If this is true, than instead of having this bug lurking in codebase and worrying about it, we should refactor the code to get rid of this dead code. If this is not true, than we should commit this patch, perhaps with testcase which will produce this behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-02-03T19:00:13.495+0000","updated":"2013-02-03T19:00:13.495+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12600953/comment/13585666","id":"13585666","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"Cannot reproduce the situation by HIVE-3784","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-02-25T06:52:53.829+0000","updated":"2013-02-25T06:52:53.829+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3326/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lnf3:"}}