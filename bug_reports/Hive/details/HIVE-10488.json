{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12824093","self":"https://issues.apache.org/jira/rest/api/2/issue/12824093","key":"HIVE-10488","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2015-04-27T07:11:36.669+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri May 01 00:51:35 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_381425239_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-05-01T00:51:35.463+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-10488/watchers","watchCount":4,"isWatching":false},"created":"2015-04-26T14:54:30.281+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326829","id":"12326829","description":"0.13 maintenance release 1","name":"0.13.1","archived":false,"released":true,"releaseDate":"2014-06-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-01T00:51:35.513+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315100","id":"12315100","name":"SQL","description":"Issues related to Hive Query Language and its conformance with ANSI SQL."}],"timeoriginalestimate":null,"description":"same data in textfile works\nsame data loaded into an ORC table does not\nconnection property of tez/mr makes no difference.\n\nselect rnum, cdt, cast (cdt as timestamp) from tdt\n0\t<null>\t<null>\n1\t1996-01-01\t1969-12-31 19:00:09.496\n2\t2000-01-01\t1969-12-31 19:00:10.957\n3\t2000-12-31\t1969-12-31 19:00:11.322\n\nvs\n\n0\t<null>\t<null>\n1\t1996-01-01\t1996-01-01 00:00:00.0\n2\t2000-01-01\t2000-01-01 00:00:00.0\n3\t2000-12-31\t2000-12-31 00:00:00.0\n\ncreate table  if not exists TDT ( RNUM int , CDT date   )\n STORED AS orc  ;\n\ninsert overwrite table TDT select * from  text.TDT;\n\n0|\\N\n1|1996-01-01\n2|2000-01-01\n3|2000-12-31\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"cast DATE as TIMESTAMP returns incorrect values","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14513641","id":"14513641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"body":"I can not reproduce this issue in hive 1.2.0\nI created 2 tables \nt3 - textfile\nt3o - Orc\n\n{code}\nhive> desc formatted t3;\nOK\n# col_name            \tdata_type           \tcomment             \n\t \t \nrnum                \tint                 \t                    \ncdt                 \tdate                \t                    \n\t \t \n# Detailed Table Information\t \t \nDatabase:           \tdefault             \t \nOwner:              \tapivovarov          \t \nCreateTime:         \tSun Apr 26 23:58:29 PDT 2015\t \nLastAccessTime:     \tUNKNOWN             \t \nProtect Mode:       \tNone                \t \nRetention:          \t0                   \t \nLocation:           \thdfs://localhost/apps/apivovarov/warehouse/t3\t \nTable Type:         \tMANAGED_TABLE       \t \nTable Parameters:\t \t \n\ttransient_lastDdlTime\t1430117909          \n\t \t \n# Storage Information\t \t \nSerDe Library:      \torg.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\t \nInputFormat:        \torg.apache.hadoop.mapred.TextInputFormat\t \nOutputFormat:       \torg.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\t \nCompressed:         \tNo                  \t \nNum Buckets:        \t-1                  \t \nBucket Columns:     \t[]                  \t \nSort Columns:       \t[]                  \t \nStorage Desc Params:\t \t \n\tserialization.format\t1                   \nTime taken: 0.098 seconds, Fetched: 27 row(s)\n{code}\n{code}\nhive> desc formatted t3o;\nOK\n# col_name            \tdata_type           \tcomment             \n\t \t \nrnum                \tint                 \t                    \ncdt                 \tdate                \t                    \n\t \t \n# Detailed Table Information\t \t \nDatabase:           \tdefault             \t \nOwner:              \tapivovarov          \t \nCreateTime:         \tMon Apr 27 00:00:11 PDT 2015\t \nLastAccessTime:     \tUNKNOWN             \t \nProtect Mode:       \tNone                \t \nRetention:          \t0                   \t \nLocation:           \thdfs://localhost/apps/apivovarov/warehouse/t3o\t \nTable Type:         \tMANAGED_TABLE       \t \nTable Parameters:\t \t \n\tCOLUMN_STATS_ACCURATE\ttrue                \n\tnumFiles            \t1                   \n\tnumRows             \t4                   \n\trawDataSize         \t184                 \n\ttotalSize           \t302                 \n\ttransient_lastDdlTime\t1430118011          \n\t \t \n# Storage Information\t \t \nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\t \nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\t \nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\t \nCompressed:         \tNo                  \t \nNum Buckets:        \t-1                  \t \nBucket Columns:     \t[]                  \t \nSort Columns:       \t[]                  \t \nStorage Desc Params:\t \t \n\tserialization.format\t1                   \nTime taken: 0.096 seconds, Fetched: 32 row(s)\n{code}\n{code}\nhive> select * from t3;\nOK\n0\tNULL\n1\t1996-01-01\n2\t2000-01-01\n3\t2000-12-31\nTime taken: 0.086 seconds, Fetched: 4 row(s)\n{code}\n{code}\nhive> select * from t3o;\nOK\n0\tNULL\n1\t1996-01-01\n2\t2000-01-01\n3\t2000-12-31\nTime taken: 0.086 seconds, Fetched: 4 row(s)\n{code}\n{code}\nhive> select rnum, cdt, cast (cdt as timestamp) from t3;\nOK\n0\tNULL\tNULL\n1\t1996-01-01\t1996-01-01 00:00:00\n2\t2000-01-01\t2000-01-01 00:00:00\n3\t2000-12-31\t2000-12-31 00:00:00\nTime taken: 0.091 seconds, Fetched: 4 row(s)\n{code}\n{code}\nhive> select rnum, cdt, cast (cdt as timestamp) from t3o;\nOK\n0\tNULL\tNULL\n1\t1996-01-01\t1996-01-01 00:00:00\n2\t2000-01-01\t2000-01-01 00:00:00\n3\t2000-12-31\t2000-12-31 00:00:00\nTime taken: 0.108 seconds, Fetched: 4 row(s)\n{code}\n\nMR\n{code}\nhive> select t3.rnum, t3.cdt, cast (t3.cdt as timestamp) cts, t3o.cdt cdt2, cast(t3o.cdt as timestamp) cts2 from t3 join t3o on (t3.rnum = t3o.rnum);\nQuery ID = apivovarov_20150427000533_2734a9a1-63eb-45d4-83a4-4129ae3e7afc\nTotal jobs = 1\n15/04/27 00:05:36 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nExecution log at: /tmp/apivovarov/apivovarov_20150427000533_2734a9a1-63eb-45d4-83a4-4129ae3e7afc.log\n2015-04-27 00:05:37\tStarting to launch local task to process map join;\tmaximum memory = 477102080\n2015-04-27 00:05:39\tDump the side-table for tag: 0 with group count: 4 into file: file:/tmp/apivovarov/fe4b8d14-3414-4790-a737-7a5d00bd04d0/hive_2015-04-27_00-05-33_412_2029315734201436275-1/-local-10003/HashTable-Stage-3/MapJoin-mapfile00--.hashtable\n2015-04-27 00:05:39\tUploaded 1 File to: file:/tmp/apivovarov/fe4b8d14-3414-4790-a737-7a5d00bd04d0/hive_2015-04-27_00-05-33_412_2029315734201436275-1/-local-10003/HashTable-Stage-3/MapJoin-mapfile00--.hashtable (345 bytes)\n2015-04-27 00:05:39\tEnd of local task; Time Taken: 1.612 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 1 out of 1\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1429923083119_0002, Tracking URL = http://c11.example.com:8088/proxy/application_1429923083119_0002/\nKill Command = /usr/lib/hadoop-2.6.0/bin/hadoop job  -kill job_1429923083119_0002\nHadoop job information for Stage-3: number of mappers: 1; number of reducers: 0\n2015-04-27 00:05:47,494 Stage-3 map = 0%,  reduce = 0%\n2015-04-27 00:05:54,942 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 2.03 sec\nMapReduce Total cumulative CPU time: 2 seconds 30 msec\nEnded Job = job_1429923083119_0002\nMapReduce Jobs Launched: \nStage-Stage-3: Map: 1   Cumulative CPU: 2.03 sec   HDFS Read: 6756 HDFS Write: 206 SUCCESS\nTotal MapReduce CPU Time Spent: 2 seconds 30 msec\nOK\n0\tNULL\tNULL\tNULL\tNULL\n1\t1996-01-01\t1996-01-01 00:00:00\t1996-01-01\t1996-01-01 00:00:00\n2\t2000-01-01\t2000-01-01 00:00:00\t2000-01-01\t2000-01-01 00:00:00\n3\t2000-12-31\t2000-12-31 00:00:00\t2000-12-31\t2000-12-31 00:00:00\nTime taken: 22.631 seconds, Fetched: 4 row(s)\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-27T07:11:36.669+0000","updated":"2015-04-27T07:11:36.669+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14514143","id":"14514143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"In Hive 1.2, I tried following three cases and got different results:\n1. select cast(date '2015-01-02' as timestamp) from src limit 1;\nreturns 2015-01-02 00:00:00\n\n2. select cast('2015-01-02' as timestamp) from src limit 1;\nreturns NULL;\n\n3. select cast(2015-01-02 as timestamp) from src limit 1;\nreturns 1969-12-31 16:33:32\n\nI believe what Campbell did fall into the 3rd one.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-04-27T13:42:49.184+0000","updated":"2015-04-27T13:42:49.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14514263","id":"14514263","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"body":"Cast was using a column of type date and not literals or value expression.\nVariance was the format the data was in.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=the6campbells","name":"the6campbells","key":"the6campbells","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"N Campbell","active":true,"timeZone":"America/New_York"},"created":"2015-04-27T15:12:40.818+0000","updated":"2015-04-27T15:12:40.818+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14514489","id":"14514489","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"body":"Put 2015-01-02 to quotes in the example 3\nOtherwise you cast integer 2012 to timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-27T17:30:58.109+0000","updated":"2015-04-27T17:30:58.109+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14519846","id":"14519846","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"[~the6campbells] I was also not able to reproduce the issue in Hive 1.2. Here are my steps:\n{code}\ncreate table testcastts (key int, datevalue date);\ninsert into testcastts select 0, null from src limit 1;\ninsert into testcastts select 1, date '1996-01-01' from src limit 1;\ninsert into testcastts select 2, date '2000-01-01' from src limit 1;\ninsert into testcastts select 3, date '2000-12-31' from src limit 1;\n---\nselect key, datevalue, cast(datevalue as timestamp) from testcastts;\n0\tNULL\tNULL\n1\t1996-01-01\t1996-01-01 00:00:00\n2\t2000-01-01\t2000-01-01 00:00:00\n3\t2000-12-31\t2000-12-31 00:00:00\n\n---\ncreate table if not exists testcastorcts (key int, datevalue date) stored as orc;\ninsert overwrite table testcastorcts select * from testcastts;\nselect key, datevalue, cast(datevalue as timestamp) from testcastorcts;\n0\tNULL\tNULL\n1\t1996-01-01\t1996-01-01 00:00:00\n2\t2000-01-01\t2000-01-01 00:00:00\n3\t2000-12-31\t2000-12-31 00:00:00\n{code}\nDo you see any difference between above my test case and yours? Otherwise, I will resolve this JIRA as \"Not Reproducible\". Thanks\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-04-29T18:02:35.107+0000","updated":"2015-04-29T18:02:35.107+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14519863","id":"14519863","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"body":"Chaoyu, testcastts should be Orc table. Is Orc default table format in your hive config?\nCast is working fine for textfile table for N.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-29T18:12:27.238+0000","updated":"2015-04-29T18:12:27.238+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14519865","id":"14519865","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"body":"you do not have to put \"from src limit 1\" in select statement in hive-1.2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-29T18:13:03.173+0000","updated":"2015-04-29T18:13:03.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14519893","id":"14519893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"[~apivovarov] I have had two tables, one is text table testcasetts (create table testcastts (key int, datevalue date);) which was populated with 4 rows of src data. the other is orc table testcastorats (create table if not exists testcastorcts (key int, datevalue date) stored as orc;). I was not able reproduce the issue with these two tables.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-04-29T18:33:21.609+0000","updated":"2015-04-29T18:33:21.609+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14519921","id":"14519921","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"Here are the desc formatted from two tables (testcastts and testcastorcts) I tested:\n{code}\n# Detailed Table Information\t \t \nDatabase:           \tjira                \t \nOwner:              \tctang               \t \nCreateTime:         \tWed Apr 29 12:03:08 EDT 2015\t \nLastAccessTime:     \tUNKNOWN             \t \nProtect Mode:       \tNone                \t \nRetention:          \t0                   \t \nLocation:           \tfile:/user/hive/warehouse/apache/jira.db/testcastts\t \nTable Type:         \tMANAGED_TABLE       \t \nTable Parameters:\t \t \n\tCOLUMN_STATS_ACCURATE\ttrue                \n\tnumFiles            \t4                   \n\tnumRows             \t4                   \n\trawDataSize         \t40                  \n\ttotalSize           \t44                  \n\ttransient_lastDdlTime\t1430323769          \n\t \t \n# Storage Information\t \t \nSerDe Library:      \torg.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\t \nInputFormat:        \torg.apache.hadoop.mapred.TextInputFormat\t \nOutputFormat:       \torg.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\t \nCompressed:         \tNo                  \t \nNum Buckets:        \t-1                  \t \nBucket Columns:     \t[]                  \t \nSort Columns:       \t[]                  \t \nStorage Desc Params:\t \t \n\tserialization.format\t1  \n\n===\nkey                 \tint                 \t                    \ndatevalue           \tdate                \t                    \n\t \t \n# Detailed Table Information\t \t \nDatabase:           \tjira                \t \nOwner:              \tctang               \t \nCreateTime:         \tWed Apr 29 12:12:42 EDT 2015\t \nLastAccessTime:     \tUNKNOWN             \t \nProtect Mode:       \tNone                \t \nRetention:          \t0                   \t \nLocation:           \tfile:/user/hive/warehouse/apache/jira.db/testcastorcts\t \nTable Type:         \tMANAGED_TABLE       \t \nTable Parameters:\t \t \n\tCOLUMN_STATS_ACCURATE\ttrue                \n\tnumFiles            \t1                   \n\tnumRows             \t4                   \n\trawDataSize         \t184                 \n\ttotalSize           \t304                 \n\ttransient_lastDdlTime\t1430324019          \n\t \t \n# Storage Information\t \t \nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\t \nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\t \nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\t \nCompressed:         \tNo                  \t \nNum Buckets:        \t-1                  \t \nBucket Columns:     \t[]                  \t \nSort Columns:       \t[]                  \t \nStorage Desc Params:\t \t \n\tserialization.format\t1  \n{code}\nBTW, I also queried with vectorized execution (set hive.vectorized.execution.enabled=true) for the ORC table testcastorcts, it also worked fine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-04-29T18:45:36.730+0000","updated":"2015-04-29T18:45:36.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14519997","id":"14519997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"body":"Got it! Thank you.\n\nBTW, I remember it was one issue with date to timestamp conversion for negative unix time HIVE-10178. But it is fixed already and has nothing to do with Orc.\n{code}\nselect cast(cast('1966-01-01 00:00:01' as timestamp) as date);\n1966-02-02\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-29T19:17:10.552+0000","updated":"2015-04-29T19:17:10.552+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14520126","id":"14520126","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"Yes, I looked through several timestamp related JIRAs, recently from Jason, Aihua and you (including HIVE-10178) and it seems none of them is related to this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-04-29T20:13:36.653+0000","updated":"2015-04-29T20:13:36.653+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14521089","id":"14521089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"body":"looks like Orc table contains int values instead of date values\ne.g. 1996-01-01=1994\n\nI got very similar results as in the description when I removed quotation marks wrapping date values:\n{code}\n--  1996-01-01=1994\nhive> select cast(1996-01-01 as timestamp);\nOK\n1969-12-31 16:00:01.994\n\n--  2000-01-01=1998\nhive> select cast(2000-01-01 as timestamp);\nOK\n1969-12-31 16:00:01.998\n\n--  2000-12-31=1957\nhive> select cast(2000-12-31 as timestamp);\nOK\n1969-12-31 16:00:01.957\n{code}\nmy TimeZone is US/Pacific - this is why time is -8hr from 1970   (1969 4pm)\n\nThe description shows 1969 7pm (-5 hours offset from 1970) - So, their timezone is US/Eastern","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=apivovarov","name":"apivovarov","key":"apivovarov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=apivovarov&avatarId=25851","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=apivovarov&avatarId=25851","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=apivovarov&avatarId=25851","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=apivovarov&avatarId=25851"},"displayName":"Alexander Pivovarov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-30T08:04:32.147+0000","updated":"2015-04-30T08:04:32.147+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12824093/comment/14522570","id":"14522570","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"[~the6campbells] We are not able to reproduce the issue, so I resolve the JIRA this moment. If you see any further issue, please feel free to reopen it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-05-01T00:51:35.505+0000","updated":"2015-05-01T00:51:35.505+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-10488/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2drwv:"}}