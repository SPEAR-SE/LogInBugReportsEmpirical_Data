{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12475599","self":"https://issues.apache.org/jira/rest/api/2/issue/12475599","key":"HIVE-1683","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2010-10-01T17:08:31.045+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 23 10:26:19 UTC 2017","customfield_12310420":"42400","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_34291174803_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-11-02T08:31:03.337+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-1683/watchers","watchCount":5,"isWatching":false},"created":"2010-10-01T11:11:28.602+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["SQL"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-08-23T10:26:43.858+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312584","id":"12312584","name":"Metastore","description":"Tracks issue dealing with metastore."}],"timeoriginalestimate":null,"description":"Column aliases cannot be used in a group by clause\n\n\nFollowing query would fail :\n\nselect col1 as t, count(col2) from test group by t;\nFAILED: Error in semantic analysis: line 1:49 Invalid Table Alias or Column Reference t\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123303","customfield_12312823":null,"summary":"Column aliases cannot be used in a group by clause","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slawande","name":"slawande","key":"slawande","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shrikrishna Lawande","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slawande","name":"slawande","key":"slawande","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shrikrishna Lawande","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475599/comment/12916953","id":"12916953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"A workaround is to use the original expression:\n\nselect col1, count(col2) from test group by col1;","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2010-10-01T17:08:31.045+0000","updated":"2010-10-01T17:08:31.045+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475599/comment/12916960","id":"12916960","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"body":"This is not a bug and should be closed as invalid.  Conceptually, GROUP BY processing happens before SELECT list computation, so it would be circular to allow such references.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-01T17:24:20.691+0000","updated":"2010-10-01T17:24:20.691+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475599/comment/13142001","id":"13142001","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"John's explanation makes sense. Projections are handled after aggregations. There is no easy way to make it work. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-11-02T08:31:03.386+0000","updated":"2011-11-02T08:31:03.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475599/comment/13142295","id":"13142295","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=electrum","name":"electrum","key":"electrum","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Phillips","active":true,"timeZone":"America/Los_Angeles"},"body":"This isn't allowed by the ANSI standard and is a bit weird conceptually.  MySQL does allow it, which might cause confusion for users.  A problem with their implementation is when the column is ambiguous (i.e. an output column named the same as an input column):\n\n{code}\nCREATE TABLE foo (a string, b int);\nSELECT length(a) AS b FROM foo GROUP BY b;\n{code}\n\nIn this case, MySQL will choose the output column and emit a warning.  I believe the correct behavior here is to error at compile time.\n\nA common work around for complex expressions is to use an inline view (which works for both WHERE and GROUP BY):\n\n{code}\nSELECT t, COUNT(*)\nFROM (\n    SELECT complex(expression(a)) t\n    FROM foo\n) x\nWHERE t > 5\nGROUP BY t\n;\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=electrum","name":"electrum","key":"electrum","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Phillips","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-11-02T16:57:19.478+0000","updated":"2011-11-02T16:57:19.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475599/comment/15721729","id":"15721729","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dmarkovitz","name":"dmarkovitz","key":"dmarkovitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dmarkovitz&avatarId=31909","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dmarkovitz&avatarId=31909","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dmarkovitz&avatarId=31909","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dmarkovitz&avatarId=31909"},"displayName":"Dudu Markovitz","active":true,"timeZone":"Asia/Jerusalem"},"body":"There was no reason to close this issue.\nThe execution flow is not relevant, the important thing is that the full query is known at parsing time and therefore aliases can be expand to their source expressions no matter where they are located.\nTeradata for example supports aliases in every part of the query including SELECT and WHERE.\n\ne.g.\n{code}\n    select  length(x) as len_x,case when len_x > 10 then 'Y' else 'N' end ...\n    select length(x) as len_x from ... where len_x > 10\n{\\code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dmarkovitz","name":"dmarkovitz","key":"dmarkovitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dmarkovitz&avatarId=31909","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dmarkovitz&avatarId=31909","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dmarkovitz&avatarId=31909","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dmarkovitz&avatarId=31909"},"displayName":"Dudu Markovitz","active":true,"timeZone":"Asia/Jerusalem"},"created":"2016-12-05T09:33:37.235+0000","updated":"2016-12-05T09:37:08.778+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475599/comment/16138203","id":"16138203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alfonso.nishikawa","name":"alfonso.nishikawa","key":"alfonso.nishikawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=alfonso.nishikawa&avatarId=16236","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alfonso.nishikawa&avatarId=16236","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alfonso.nishikawa&avatarId=16236","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alfonso.nishikawa&avatarId=16236"},"displayName":"Alfonso Nishikawa","active":true,"timeZone":"Europe/Madrid"},"body":"For anyone reaching this comments, it is possible to set the group by position (not by alias, but in much cases will be enough) configuring {{set hive.groupby.orderby.position.alias=true;}}.\n\nFrom [https://cwiki.apache.org/confluence/display/Hive/LanguageManual+GroupBy] :\n\nbq. In groupByExpression columns are specified by name, not by position number. However in Hive 0.11.0 and later, columns can be specified by position when configured as follows:\nbq.    For Hive 0.11.0 through 2.1.x, set hive.groupby.orderby.position.alias to true (the default is false).\nbq.    For Hive 2.2.0 and later, set hive.groupby.position.alias to true (the default is false).\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alfonso.nishikawa","name":"alfonso.nishikawa","key":"alfonso.nishikawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=alfonso.nishikawa&avatarId=16236","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alfonso.nishikawa&avatarId=16236","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alfonso.nishikawa&avatarId=16236","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alfonso.nishikawa&avatarId=16236"},"displayName":"Alfonso Nishikawa","active":true,"timeZone":"Europe/Madrid"},"created":"2017-08-23T10:26:19.437+0000","updated":"2017-08-23T10:26:43.850+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-1683/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lgdj:"}}