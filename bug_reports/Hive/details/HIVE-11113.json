{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12840595","self":"https://issues.apache.org/jira/rest/api/2/issue/12840595","key":"HIVE-11113","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2015-06-25T18:42:59.546+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 21 16:45:29 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_2244251776_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-07-21T17:01:59.793+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11113/watchers","watchCount":5,"isWatching":false},"created":"2015-06-25T17:37:48.069+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326829","id":"12326829","description":"0.13 maintenance release 1","name":"0.13.1","archived":false,"released":true,"releaseDate":"2014-06-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-07-21T17:01:59.839+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I was trying to perform some column statistics using hive as per the documentation https://cwiki.apache.org/confluence/display/Hive/Column+Statistics+in+Hive and was encountering the following errors:\n\nSeems like a bug. Can you look into this? Thanks in advance.\n\n-- HIVE table\n{noformat}\nhive> create table people_part(\nname string,\naddress string) PARTITIONED BY (dob string, nationality varchar(2))\nrow format delimited fields terminated by '\\t';\n{noformat}\n\n--Analyze table with partition dob and nationality with FOR COLUMNS\n{noformat}\nhive> ANALYZE TABLE people_part PARTITION(dob='2015-10-2',nationality) COMPUTE STATISTICS FOR COLUMNS;\nNoViableAltException(-1@[])\n        at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.identifier(HiveParser_IdentifiersParser.java:11627)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.identifier(HiveParser.java:40215)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.columnName(HiveParser.java:33351)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.columnNameList(HiveParser.java:33219)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.analyzeStatement(HiveParser.java:17764)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.ddlStatement(HiveParser.java:2369)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.execStatement(HiveParser.java:1398)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.statement(HiveParser.java:1036)\n        at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:199)\n        at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:166)\n        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:404)\n        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:322)\n        at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:975)\n        at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1040)\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:911)\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:901)\n        at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:275)\n        at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:227)\n        at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:430)\n        at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:803)\n        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:697)\n        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:636)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nFAILED: ParseException line 1:95 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in column name\n{noformat}\n\n\n--Analyze table with partition dob and nationality values specified with FOR COLUMNS\n{noformat}\nhive> ANALYZE TABLE people_part PARTITION(dob='2015-10-2',nationality='IE') COMPUTE STATISTICS FOR COLUMNS;\nNoViableAltException(-1@[])\n        at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.identifier(HiveParser_IdentifiersParser.java:11627)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.identifier(HiveParser.java:40215)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.columnName(HiveParser.java:33351)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.columnNameList(HiveParser.java:33219)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.analyzeStatement(HiveParser.java:17764)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.ddlStatement(HiveParser.java:2369)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.execStatement(HiveParser.java:1398)\n        at org.apache.hadoop.hive.ql.parse.HiveParser.statement(HiveParser.java:1036)\n        at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:199)\n        at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:166)\n        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:404)\n        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:322)\n        at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:975)\n        at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1040)\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:911)\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:901)\n        at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:275)\n        at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:227)\n        at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:430)\n        at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:803)\n        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:697)\n        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:636)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nFAILED: ParseException line 1:100 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in column name\n{noformat}\n\n\n--Analyze table with partition dob and nationality values specified with FOR COLUMNS with column name specified\n{noformat}\nhive> ANALYZE TABLE people_part PARTITION(dob='2015-10-2',nationality='IE') COMPUTE STATISTICS FOR COLUMNS name;\nFAILED: SemanticException [Error 10004]: Line 1:92 Invalid table alias or column reference 'IE': (possible column names are: name, address, dob, nationality)\n{noformat}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ANALYZE TABLE .. COMPUTE STATISTICS FOR COLUMNS does not work. ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shiroy","name":"shiroy","key":"shiroy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shiroy Pigarez","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shiroy","name":"shiroy","key":"shiroy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shiroy Pigarez","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"\n\n\n\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14601706","id":"14601706","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~shiroy], I tried your queries, the first one passed and the second one has a different error msg which says that there is \" Invalid partitioning key/value\". Could you update your Hive to the most recent version and double check the quote ' that you use? Thanks. also ccing [~jpullokkaran].\n{code}\nhive> ANALYZE TABLE people_part PARTITION(dob='2015-10-2',nationality) COMPUTE STATISTICS FOR COLUMNS;\nQuery ID = pxiong_20150625114030_a4536dbc-6c31-4b89-bc22-6f56981cb6dc\nTotal jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapreduce.job.reduces=<number>\nJob running in-process (local Hadoop)\n2015-06-25 11:40:32,399 Stage-0 map = 100%,  reduce = 100%\nEnded Job = job_local728672066_0002\nMapReduce Jobs Launched:\nStage-Stage-0:  HDFS Read: 0 HDFS Write: 0 SUCCESS\nTotal MapReduce CPU Time Spent: 0 msec\nOK\nTime taken: 1.495 seconds\n{code}\n{code}\nhive> ANALYZE TABLE people_part PARTITION(dob='2015-10-2',nationality='IE') COMPUTE STATISTICS FOR COLUMNS;\nFAILED: SemanticException [Error 30007]: Invalid partitioning key/value specified in ANALYZE statement : {dob=2015-10-2, nationality=IE}\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-25T18:42:59.546+0000","updated":"2015-06-25T18:42:59.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14608129","id":"14608129","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shiroy","name":"shiroy","key":"shiroy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shiroy Pigarez","active":true,"timeZone":"Etc/UTC"},"body":"Thank you Pengcheng Xiong for looking into this.\nCould you please tell me the version of hive that ran the following query successfully?\nANALYZE TABLE people_part PARTITION(dob='2015-10-2',nationality) COMPUTE STATISTICS FOR COLUMNS;\n\nRegards\nShiroy\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shiroy","name":"shiroy","key":"shiroy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shiroy Pigarez","active":true,"timeZone":"Etc/UTC"},"created":"2015-06-30T11:08:52.951+0000","updated":"2015-06-30T11:08:52.951+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14608621","id":"14608621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~shiroy], Hive 1.2 should work. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-30T16:32:00.525+0000","updated":"2015-06-30T16:32:00.525+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14627777","id":"14627777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi, [~pxiong] and [~shiroy]\nI tried this scenario on Hive 1.2.1. And found it could work for a table stored as TEXTFILE, but cant NOT work for the one stored as PARQUET.\n\nErrors\n======\nCaused by: java.lang.IllegalArgumentException: Column [ds] was not found in schema!\n        at parquet.Preconditions.checkArgument(Preconditions.java:55)\n        at parquet.filter2.predicate.SchemaCompatibilityValidator.getColumnDescriptor(SchemaCompatibilityValidator.java:190)\n        at parquet.filter2.predicate.SchemaCompatibilityValidator.validateColumn(SchemaCompatibilityValidator.java:178)\n        at parquet.filter2.predicate.SchemaCompatibilityValidator.validateColumnFilterPredicate(SchemaCompatibilityValidator.java:160)\n        at parquet.filter2.predicate.SchemaCompatibilityValidator.visit(SchemaCompatibilityValidator.java:94)\n        at parquet.filter2.predicate.SchemaCompatibilityValidator.visit(SchemaCompatibilityValidator.java:59)\n        at parquet.filter2.predicate.Operators$Eq.accept(Operators.java:180)\n        at parquet.filter2.predicate.SchemaCompatibilityValidator.validate(SchemaCompatibilityValidator.java:64)\n        at parquet.filter2.compat.RowGroupFilter.visit(RowGroupFilter.java:59)\n        at parquet.filter2.compat.RowGroupFilter.visit(RowGroupFilter.java:40)\n        at parquet.filter2.compat.FilterCompat$FilterPredicateCompat.accept(FilterCompat.java:126)\n        at parquet.filter2.compat.RowGroupFilter.filterRowGroups(RowGroupFilter.java:46)\n        at org.apache.hadoop.hive.ql.io.parquet.read.ParquetRecordReaderWrapper.getSplit(ParquetRecordReaderWrapper.java:275)\n        at org.apache.hadoop.hive.ql.io.parquet.read.ParquetRecordReaderWrapper.<init>(ParquetRecordReaderWrapper.java:99)\n        at org.apache.hadoop.hive.ql.io.parquet.read.ParquetRecordReaderWrapper.<init>(ParquetRecordReaderWrapper.java:85)\n        at org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat.getRecordReader(MapredParquetInputFormat.java:72)\n        at org.apache.hadoop.hive.ql.io.CombineHiveRecordReader.<init>(CombineHiveRecordReader.java:67)\n        ... 16 more\n\n\nReproduced Queries\n==================\ncreate table dummy (key string, value string) partitioned by (ds string, hr string);\n\nload data local inpath 'kv1.txt' into table dummy partition (ds='2008',hr='12');\nload data local inpath 'kv1.txt' into table dummy partition (ds='2008',hr='11');\n\nselect * from dummy;\nanalyze table dummy partition (ds='2008',hr='12') compute statistics for columns key;\n\n\ncreate table dummy2 (key string, value string) partitioned by (ds string, hr string)stored as parquet;\ninsert into table dummy2 partition (ds='2008',hr='12')\nselect key, value from dummy where (ds='2008');\n\nselect * from dummy2;\nanalyze table dummy2 partition(ds='2008') compute statistics for columns key;","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-07-15T09:25:23.245+0000","updated":"2015-07-15T09:25:23.245+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14628438","id":"14628438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~libing], I tried your queries on both 1.2.1 and also latest master. I could not reproduce your problem. In both cases, they ran fine. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-15T17:48:16.506+0000","updated":"2015-07-15T17:48:16.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14633017","id":"14633017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi, @Pengcheng Xiong\nWhat's the value of hive.optimize.ppd in your cluster?\nI can run into the error if I set it to true.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-07-20T01:31:07.768+0000","updated":"2015-07-20T01:31:07.768+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14633046","id":"14633046","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~libing], i was using default setting of ppd (true). So you have problem when you set it to true and no problem when you set it to false?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-20T03:40:48.609+0000","updated":"2015-07-20T03:40:48.609+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14633635","id":"14633635","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi, [~pxiong]\nThank you for your quick response.\nYes, I tried the queries on two different cluster. And both of them ran into this error in \n\nanalyze table dummy2 partition(ds='2008') compute statistics for columns key;\n\nThen I tried to set hive.optimize.ppd to false, it would work, but got a bad performance.\n\nDo you have some idea that which classes may lead into it?\n\nThank you!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-07-20T14:03:31.619+0000","updated":"2015-07-20T14:03:31.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14634240","id":"14634240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~libing], the initial problem that you were asking is why analyze table people_part does not work. Later, you changed the question to \"found it could work for a table stored as TEXTFILE, but cant NOT work for the one stored as PARQUET.\" Now, you are asking why \"analyze table dummy2 partition(ds='2008') compute statistics for columns key;\" does not work. I assume table dummy2 has a different schema from table people_part? Could you confirm that? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-20T23:11:34.645+0000","updated":"2015-07-20T23:11:34.645+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14634338","id":"14634338","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi, [~pxiong]\nI didn't run the query for \"people_part\".\n\nWhat I ran list in my previous comment with \"Reproduced Queries\".\n\nIn the \"reproduced queries\", I tried two different types of tables, one is TEXTFILE, and the other is PARQUET.\n\nThe ANALYZE command on TEXTFILE was passed, while failed on PARQUET table with the error.\n\n\nanalyze table dummy partition (ds='2008',hr='12') compute statistics for columns key;    // PASS\nanalyze table dummy2 partition(ds='2008') compute statistics for columns key;  //FAILED\n\n\nThen I tried to disable hive.optimize.ppd, set its value to false. Then the following query could work without any error\n\nanalyze table dummy2 partition(ds='2008') compute statistics for columns key;  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-07-21T00:38:36.981+0000","updated":"2015-07-21T00:38:36.981+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14634359","id":"14634359","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~libing], I see. But I still could not reproduce your problem on the latest master. Could you update your Hive to the latest version and try again? Please also post the stack trace as well if possible. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-21T00:59:46.921+0000","updated":"2015-07-21T00:59:46.921+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14634646","id":"14634646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tfriedr","name":"tfriedr","key":"tfriedr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Friedrich","active":true,"timeZone":"America/Los_Angeles"},"body":"[~libing], [~pxiong], the error message \"Column [ds] was not found in schema!\" is a different problem than reported in this JIRA originally and is specific to parquet tables with partitions and not limited to analyze. I opened HIVE-11326 for the parquet problem and added steps to reproduce the problem over there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tfriedr","name":"tfriedr","key":"tfriedr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Friedrich","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-21T07:19:50.377+0000","updated":"2015-07-21T07:19:50.377+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14634801","id":"14634801","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"body":"Thank you, [~tfriedr]\nWith your fix in HIVE-11326, all the queries could work now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=libing","name":"libing","key":"libing","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bing Li","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-07-21T08:59:29.917+0000","updated":"2015-07-21T08:59:29.917+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12840595/comment/14635379","id":"14635379","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~tfriedr], thanks for your efforts. So, I am going to close this jira, [~shiroy] and [~libing] please feel free to reopen it if the problem remains. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-21T16:45:29.496+0000","updated":"2015-07-21T16:45:29.496+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11113/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2gi1r:"}}