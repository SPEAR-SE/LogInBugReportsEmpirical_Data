{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12932608","self":"https://issues.apache.org/jira/rest/api/2/issue/12932608","key":"HIVE-12893","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332154","id":"12332154","description":"","name":"1.3.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-01-20T03:09:57.945+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sun Jan 31 20:43:19 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_3_*:*_364691_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_3_*:*_1013531993","customfield_12312321":null,"resolutiondate":"2016-01-31T20:43:19.013+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-12893/watchers","watchCount":2,"isWatching":false},"created":"2016-01-20T03:05:02.477+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332154","id":"12332154","description":"","name":"1.3.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"issuelinks":[{"id":"12465484","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12465484","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12959924","key":"HIVE-13546","self":"https://issues.apache.org/jira/rest/api/2/issue/12959924","fields":{"summary":"Patch for HIVE-12893 is broken in branch-1 ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-05-02T23:10:31.026+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12323400","id":"12323400","name":"Logical Optimizer","description":"Optimizations which are independent of runtime."}],"timeoriginalestimate":null,"description":"If all partition columns are constant folded then sorted dynamic partitioning should not be used as it is similar to static partitioning. But if only subset of partition columns are constant folded sorted dynamic partition optimization will be helpful. Currently, this optimization is disabled if atleast one partition column constant folded.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12783268","id":"12783268","filename":"HIVE-12893.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-20T03:09:57.941+0000","size":23247,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12783268/HIVE-12893.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12784981","id":"12784981","filename":"HIVE-12893.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-28T17:51:24.256+0000","size":129644,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12784981/HIVE-12893.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12784786","id":"12784786","filename":"HIVE-12893.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-28T00:32:15.116+0000","size":129644,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12784786/HIVE-12893.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12785415","id":"12785415","filename":"HIVE-12893.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-31T20:10:39.574+0000","size":129894,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12785415/HIVE-12893.3.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Sorted dynamic partition does not work if subset of partition columns are constant folded","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yeeza","name":"yeeza","key":"yeeza","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yi Zhang","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15107893","id":"15107893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"This patch moves the SortedDynamicPartition optimizer above PartitionConditionRemover optimization. Removal of partition condition after constant folding makes it complicated to determine the partition columns as the folded columns will be removed from row schema. Also this patch disables BucketingSortingReduceSinkOptimizer if SortedDynamicPartition optimizer inserts a new ReduceSink. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-20T03:09:57.945+0000","updated":"2016-01-20T03:09:57.945+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15107894","id":"15107894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ashutoshc] Can you please review this patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-20T03:10:15.903+0000","updated":"2016-01-20T03:10:15.903+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15107900","id":"15107900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"Attaching RB","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-20T03:12:32.253+0000","updated":"2016-01-20T03:12:32.253+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15109622","id":"15109622","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"When all columns are constant folded, we disable SDPO, but do we also convert this to static partition insert code path? Perhaps here: https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConstantPropagateProcFactory.java#L1220\nDidn't get the intended behavior for case of subset getting folded. In the existing test case it seems like ReduceSinkDedup wasn't kicking in. Was that the primary bug being fixed here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-20T22:34:43.976+0000","updated":"2016-01-20T22:34:43.976+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15110047","id":"15110047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12783268/HIVE-12893.1.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 21 failed/errored test(s), 10010 tests executed\n*Failed tests:*\n{noformat}\nTestHWISessionManager - did not produce a TEST-*.xml file\nTestSparkCliDriver-timestamp_lazy.q-bucketsortoptimize_insert_4.q-date_udf.q-and-12-more - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.org.apache.hadoop.hive.cli.TestMiniTezCliDriver\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_auto_sortmerge_join_15\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_cbo_views\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_delete_where_no_match\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_mapreduce1\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_merge2\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_orc_merge4\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_orc_merge6\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_schema_evol_text_mapwork_table\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_script_env_var1\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_tez_vector_dynpart_hashjoin_2\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_char_simple\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_decimal_udf\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_outer_join0\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_string_concat\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vectorized_distinct_gby\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vectorized_parquet\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import\norg.apache.hive.jdbc.TestSSL.testSSLVersion\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6688/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6688/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6688/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 21 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12783268 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-01-21T04:46:01.734+0000","updated":"2016-01-21T04:46:01.734+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15112765","id":"15112765","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sershe","name":"sershe","key":"sershe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Shelukhin","active":true,"timeZone":"America/Los_Angeles"},"body":"One small nit on RB, and tests need to be fixed. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sershe","name":"sershe","key":"sershe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Shelukhin","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-22T17:47:24.157+0000","updated":"2016-01-22T17:47:24.157+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15120244","id":"15120244","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sershe","name":"sershe","key":"sershe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Shelukhin","active":true,"timeZone":"America/Los_Angeles"},"body":"[~prasanth_j] ping? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sershe","name":"sershe","key":"sershe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Shelukhin","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-27T21:57:30.075+0000","updated":"2016-01-27T21:57:30.075+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15120437","id":"15120437","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"Uploading patch shortly. Analyzing the test failures.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-27T23:49:58.378+0000","updated":"2016-01-27T23:49:58.378+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15120508","id":"15120508","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"Addressed review comments. [~ashutoshc] Regd. your comments about converting to static partition spec in constant propagation optimization, I will put up a follow up patch. Also added more tests for this specific issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-28T00:32:15.120+0000","updated":"2016-01-28T00:32:15.120+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15120896","id":"15120896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Doing conversion to static partition spec for all constants in follow-up sounds good.\n\nBut, patch & description is still not geling will for me. Title & description of jira is suggesting a presence of bug when few (and not all) columns are constant.  However, If I read the patch right, it is basically an optimization of disabling SPDO off if all columns are determined to be the constant. Issue described in title/description seems to be non-existent. Can you explain it and if necessary, update title/description of jira.\n\nPatch itself however looks good. +1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-28T06:50:42.890+0000","updated":"2016-01-28T06:50:42.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15122014","id":"15122014","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"The main cause of this bug is this line https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedDynPartitionOptimizer.java#L305\n\nWhen SDPO removes the RS (and SEL) inserted by Bucketing Sorting (this is inserted in SemanticAnalyzer), it changes the plan from TS->SEL->RS->SEL->FS to TS->SEL->FS. What the condition aboves says is if the schema of both SEL does not match then it means that some columns are constant folded and PartitionConditionRemover removed the ExprNodeColumnDesc for the partition columns that are folded. So there will be mismatch between RowSchema of both SEL operators. In such cases, SDPO used to bail out. Even if only a subset of partition columns are folded the above condition will disable SDPO. I tried fixing this condition but that lead to more fragile checks in SDPO. To avoid that, in this patch I moved the SDPO before PartitionConditionRemover and after first ConstantPropagation optimization. This lets me avoid fragile checks in SDPO. \n\nWith this change, the check for schema mismatch in the above link is no longer required. I just left it there for safety :)\n\nThe allStaticPartitions() method in the patch returns false if it finds atleast one non-folded column in which case the optimization proceeds ahead. The newly tests shows it clearly in the explain plan. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-28T18:14:16.603+0000","updated":"2016-01-28T18:14:16.603+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15122045","id":"15122045","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I see. Thanks for explanation. +1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-28T18:26:08.505+0000","updated":"2016-01-28T18:26:08.505+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15124680","id":"15124680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12784981/HIVE-12893.2.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 64 failed/errored test(s), 10031 tests executed\n*Failed tests:*\n{noformat}\nTestMiniTezCliDriver-vector_interval_2.q-vectorization_7.q-union8.q-and-12-more - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_dynpart_sort_optimization\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query13\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query15\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query17\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query18\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query19\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query20\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query21\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query22\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query25\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query26\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query27\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query28\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query29\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query3\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query31\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query32\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query34\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query39\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query40\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query42\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query43\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query45\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query46\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query48\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query50\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query51\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query52\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query54\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query55\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query58\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query64\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query65\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query66\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query67\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query68\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query7\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query70\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query71\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query72\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query73\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query75\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query76\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query79\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query80\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query82\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query84\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query85\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query87\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query88\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query89\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query90\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query91\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query92\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query93\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query94\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query95\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query96\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query97\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testPerfCliDriver_query98\norg.apache.hive.jdbc.TestSSL.testSSLVersion\norg.apache.hive.service.cli.TestEmbeddedThriftBinaryCLIService.testExecuteStatementAsync\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6794/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6794/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6794/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 64 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12784981 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-01-30T03:02:26.715+0000","updated":"2016-01-30T03:02:26.715+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12932608/comment/15125492","id":"15125492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"body":"PerfCliDriver test failures are unrelated and are happening for other patches as well. dynpart_sort_optimization.q is just a golden file update that was missed for tez. Updated them on commit. Committed to all branches.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=prasanth_j","name":"prasanth_j","key":"prasanth_j","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Prasanth Jayachandran","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-31T20:43:19.134+0000","updated":"2016-01-31T20:43:19.134+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-12893/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2rpw7:"}}