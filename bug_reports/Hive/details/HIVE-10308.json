{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12820264","self":"https://issues.apache.org/jira/rest/api/2/issue/12820264","key":"HIVE-10308","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332154","id":"12332154","description":"","name":"1.3.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-04-12T14:37:09.976+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 17 20:05:58 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_2185431923_*|*_1_*:*_1_*:*_2734879_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-05-06T09:34:25.550+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-10308/watchers","watchCount":5,"isWatching":false},"created":"2015-04-11T01:44:58.803+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326829","id":"12326829","description":"0.13 maintenance release 1","name":"0.13.1","archived":false,"released":true,"releaseDate":"2014-06-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329345","id":"12329345","description":"Hive 1.2.0","name":"1.2.0","archived":false,"released":true,"releaseDate":"2015-05-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-03-17T20:05:58.833+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12321300","id":"12321300","name":"Vectorization","description":"Vectorized query execution"}],"timeoriginalestimate":null,"description":"Steps to reproduce:\n{code:sql}\nCREATE TABLE test_orc (a INT, b MAP<INT, STRING>) STORED AS ORC;\nINSERT OVERWRITE TABLE test_orc SELECT 1, MAP(1, \"one\", 2, \"two\") FROM src LIMIT 1;\nCREATE TABLE test(key INT) ;\nINSERT OVERWRITE TABLE test SELECT 1 FROM src LIMIT 1;\n\nset hive.vectorized.execution.enabled=true;\nset hive.auto.convert.join=false;\n\nselect l.key from test l left outer join test_orc r on (l.key= r.a) where r.a is not null;\n{code}\nStack trace:\n{noformat}\nCaused by: java.lang.IllegalArgumentException: Unsupported complex type: MAP\n\tat org.apache.hadoop.hive.ql.exec.vector.expressions.VectorExpressionWriterFactory.genVectorExpressionWritable(VectorExpressionWriterFactory.java:456)\n\tat org.apache.hadoop.hive.ql.exec.vector.expressions.VectorExpressionWriterFactory.processVectorInspector(VectorExpressionWriterFactory.java:1191)\n\tat org.apache.hadoop.hive.ql.exec.vector.VectorReduceSinkOperator.initializeOp(VectorReduceSinkOperator.java:58)\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:362)\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:481)\n\tat org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:438)\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:375)\n\tat org.apache.hadoop.hive.ql.exec.MapOperator.initializeMapOperator(MapOperator.java:442)\n\tat org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:198)\n{noformat}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12724726","id":"12724726","filename":"HIVE-10308.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-11T02:30:17.454+0000","size":1279,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12724726/HIVE-10308.1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Vectorization execution throws java.lang.IllegalArgumentException: Unsupported complex type: MAP","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14491492","id":"14491492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12724726/HIVE-10308.1.patch\n\n{color:red}ERROR:{color} -1 due to 14 failed/errored test(s), 8672 tests executed\n*Failed tests:*\n{noformat}\nTestMinimrCliDriver-bucketmapjoin6.q-constprog_partitioner.q-infer_bucket_sort_dyn_part.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-external_table_with_space_in_location_path.q-infer_bucket_sort_merge.q-auto_sortmerge_join_16.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-groupby2.q-import_exported_table.q-bucketizedhiveinputformat.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-index_bitmap3.q-stats_counter_partitioned.q-temp_table_external.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-infer_bucket_sort_map_operators.q-join1.q-bucketmapjoin7.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-infer_bucket_sort_num_buckets.q-disable_merge_for_bucketing.q-uber_reduce.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-infer_bucket_sort_reducers_power_two.q-scriptfile1.q-scriptfile1_win.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-leftsemijoin_mr.q-load_hdfs_file_with_space_in_the_name.q-root_dir_external_table.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-list_bucket_dml_10.q-bucket_num_reducers.q-bucket6.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-load_fs2.q-file_with_header_footer.q-ql_rewrite_gbtoidx_cbo_1.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-parallel_orderby.q-reduce_deduplicate.q-ql_rewrite_gbtoidx_cbo_2.q-and-1-more - did not produce a TEST-*.xml file\nTestMinimrCliDriver-ql_rewrite_gbtoidx.q-smb_mapjoin_8.q - did not produce a TEST-*.xml file\nTestMinimrCliDriver-schemeAuthority2.q-bucket4.q-input16_cc.q-and-1-more - did not produce a TEST-*.xml file\norg.apache.hive.jdbc.TestJdbcWithMiniHS2.testNewConnectionConfiguration\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3395/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3395/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3395/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 14 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12724726 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2015-04-12T14:37:09.976+0000","updated":"2015-04-12T14:37:09.976+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14493272","id":"14493272","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Actually the test results show only 1 test failure and the failure is 33 days old. So should be irrelevant. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-13T23:30:29.905+0000","updated":"2015-04-13T23:30:29.905+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14493304","id":"14493304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"The Vectorizer class is suppose to *exclude* the MAP data type from vectorization.  We should never execute a Map or Reduce vertex with a MAP type.\n\nSo, I am a -1 on this patch.  Some verification path is missing in the Vectorizer class.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-04-13T23:53:15.495+0000","updated":"2015-04-13T23:53:15.495+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14493768","id":"14493768","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"I see the problem.  The Vectorizer class has in fact correclty validated that all data types used in the query are ok.  The test (thank you) above does not reference the MAP data type.\n\nHowever, in the initializeOp method of VectorReduceSinkOperator, we convert the input object inspector inputObjInspector\\[0\\] to vector expression row writers and that inspector includes the MAP data type.\n\n{noformat}\ninputObjInspectors[0] a:INT, b:MAP\n{noformat}\n\nWe use the ReduceSinkOperator as a super type and it is expecting a standard row object that looks like inputObjInspector\\[0\\].\n\nSo, need to rethink how we are creating the vector expression row writers here.\n\nI'm assigning this to me since I wrote the recent addition to VectorReduceSinkOperator initializeOp that is producing the problem.  We are missing some negative tests here, too.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-04-14T08:17:29.843+0000","updated":"2015-04-14T08:17:29.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14530238","id":"14530238","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"I ended up fixing this problem with one of my other changes because it caused some Q file failures.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-05-06T09:34:14.660+0000","updated":"2015-05-06T09:34:14.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14544611","id":"14544611","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~mmccline] Thanks for reviewing this! Which patch fixed this problem? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selinazh","name":"selinazh","key":"selinazh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244"},"displayName":"Selina Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-05-14T23:25:06.948+0000","updated":"2015-05-14T23:25:06.948+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/14553672","id":"14553672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"body":"[~selinaz] It was part of the huge HIVE-9824 patch (improved vector map join performance).\n\nThe change was to VectorExpressionWriterFactory (the class you modified in your patch):\n\nI added this to public static VectorExpressionWriter genVectorExpressionWritable(ObjectInspector fieldObjInspector):\n\n{noformat}\n      case STRUCT:\n      case UNION:\n      case MAP:\n      case LIST:\n         return genVectorExpressionWritableEmpty();\n{noformat}\n\nand a the new method genVectorExpressionWritableEmpty:\n\n{noformat}\n  // For complex types like STRUCT, MAP, etc we do not support, we need a writer that\n  // does nothing.  We assume the Vectorizer class has not validated the query to actually\n  // try and use the complex types.  They do show up in inputObjInspector[0] and need to be\n  // ignored.\n  private static VectorExpressionWriter genVectorExpressionWritableEmpty() {\n    return new VectorExpressionWriterBase() {\n\t\n      @Override\n      public Object writeValue(ColumnVector column, int row)\n          throws HiveException {\n        return null;\n      }\n\t\n      @Override\n      public Object setValue(Object row, ColumnVector column, int columnRow)\n          throws HiveException {\n         return null;\n      }\n\t\n      @Override\n      public Object initValue(Object ost) throws HiveException {\n         return null;\n      }\n    };\n  }\t\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mmccline","name":"mmccline","key":"mmccline","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mmccline&avatarId=36046","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mmccline&avatarId=36046","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mmccline&avatarId=36046","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mmccline&avatarId=36046"},"displayName":"Matt McCline","active":true,"timeZone":"America/Chicago"},"created":"2015-05-21T05:58:34.538+0000","updated":"2015-05-21T05:58:34.538+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/15093902","id":"15093902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akatose","name":"akatose","key":"akatose","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Haeusler","active":true,"timeZone":"Europe/Berlin"},"body":"Could we document the fix version of this issue? [~mmccline] Is it correct to assume that this was fixed in 1.2.0 together with HIVE-9824? I want to double check as 1.2.0 is still listed as affected version here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=akatose","name":"akatose","key":"akatose","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Haeusler","active":true,"timeZone":"Europe/Berlin"},"created":"2016-01-12T13:48:16.116+0000","updated":"2016-01-12T13:48:16.116+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12820264/comment/15930619","id":"15930619","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vgumashta","name":"vgumashta","key":"vgumashta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vaibhav Gumashta","active":true,"timeZone":"America/Los_Angeles"},"body":"Removing fix version 1.2.2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vgumashta","name":"vgumashta","key":"vgumashta","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vaibhav Gumashta","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-17T20:05:58.833+0000","updated":"2017-03-17T20:05:58.833+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-10308/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2d4uf:"}}