{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12644971","self":"https://issues.apache.org/jira/rest/api/2/issue/12644971","key":"HIVE-4429","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-04-27T01:46:44.508+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Apr 27 04:02:25 UTC 2013","customfield_12310420":"325333","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4429/watchers","watchCount":4,"isWatching":false},"created":"2013-04-27T00:19:58.659+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317742","id":"12317742","description":"released","name":"0.9.0","archived":false,"released":true,"releaseDate":"2012-04-30"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-04-27T04:02:25.636+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."},{"self":"https://issues.apache.org/jira/rest/api/2/component/12315100","id":"12315100","name":"SQL","description":"Issues related to Hive Query Language and its conformance with ANSI SQL."},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313585","id":"12313585","name":"UDF","description":"This includes the UDFs and UDAFs"}],"timeoriginalestimate":null,"description":"Nested ORDER BY clause doesn't honor the outer one in specific case.\n\nThe below query produces result which honors only the inner ORDER BY clause. (it produces only 1 MapRed job)\n\n{code:borderStyle=solid}\nSELECT alias.b0 as d0, alias.b1 as d1\nFROM\n    (SELECT test.a0 as b0, test.a1 as b1 \n    FROM test\n    ORDER BY b1 ASC, b0 DESC) alias    \nORDER BY d0 ASC, d1 DESC;\n\n{code}\n\n----\nOn the other hand the query below honors the outer ORDER BY clause which produces the correct result. (it produces 2 MapRed jobs)\n\n{code:borderStyle=solid}\nSELECT alias.b0 as d0, alias.b1 as d1\nFROM\n    (SELECT test.a0 as b0, test.a1 as b1 \n    FROM test\n    ORDER BY b1 ASC, b0 DESC) alias    \nORDER BY d0 DESC, d1 DESC;\n\n{code}\n\n----\nAny other combination of nested ORDER BY clauses does produce the correct result.\nPlease see attachments for query, schema and Hive Commands for reprocase.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580792","id":"12580792","filename":"Hive_Command_Script.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T00:26:20.228+0000","size":185,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12580792/Hive_Command_Script.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580793","id":"12580793","filename":"HiveQuery.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T00:26:20.231+0000","size":774,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12580793/HiveQuery.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12580794","id":"12580794","filename":"Test_Data.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T00:26:20.234+0000","size":108,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12580794/Test_Data.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"325678","customfield_12312823":null,"summary":"Nested ORDER BY produces incorrect result","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Red Hat Linux VM with Hive 0.9 and Hadoop 2.0","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644971/comment/13643417","id":"13643417","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"body":"1) Hive_Command_Script.txt\n    This file contains the commands to setup schema and load data.\n\n2) HiveQuery.txt\n    This file contains the queries which reproduce the bug.\n\n3) Test_Data.txt\n    File containing data to load into the schema required by Hive_Command_Script.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T00:26:20.237+0000","updated":"2013-04-27T00:26:20.237+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644971/comment/13643453","id":"13643453","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lianhuiwang","name":"lianhuiwang","key":"lianhuiwang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lianhui Wang","active":true,"timeZone":"Etc/UTC"},"body":"hi, Mihir Kulkarni \ni run the first sql of your cases, but in my hive-0.9, it produces correct result.it is the following.\n30.0    1.0\n20.0    1.0\n10.0    1.0\n30.0    2.0\n20.0    2.0\n10.0    2.0\n30.0    3.0\n20.0    3.0\n10.0    3.0\n60.0    4.0\n50.0    4.0\n40.0    4.0\n60.0    5.0\n50.0    5.0\n40.0    5.0\n60.0    6.0\n50.0    6.0\n40.0    6.0\n\nso can you tell which version you used.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lianhuiwang","name":"lianhuiwang","key":"lianhuiwang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lianhui Wang","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T01:46:44.508+0000","updated":"2013-04-27T01:46:44.508+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644971/comment/13643483","id":"13643483","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"body":"[~lianhuiwang]\nIsn't the output you mentioned above wrong? Because my first sql says\n\n*ORDER BY d0 ASC, d1 DESC*\n\nAnd the output you get is *d1 ASC d0 DESC*","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T02:47:54.072+0000","updated":"2013-04-27T02:47:54.072+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644971/comment/13643494","id":"13643494","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"It should make two MR not one MR, and hive on trunk seemed fixed by HIVE-2340. Disable rs-dedup for a walkaround (hive.optimize.reducededuplication=false)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-27T03:04:47.484+0000","updated":"2013-04-27T03:04:47.484+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12644971/comment/13643512","id":"13643512","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lianhuiwang","name":"lianhuiwang","key":"lianhuiwang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lianhui Wang","active":true,"timeZone":"Etc/UTC"},"body":"Mihir Kulkarni\nsorry, my mistakes. \nNavis\nyes, there are some bugs in reducededuplication, i donot confirm that it is fixed.but i think the inner order by can be removed in this case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lianhuiwang","name":"lianhuiwang","key":"lianhuiwang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lianhui Wang","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T04:02:25.636+0000","updated":"2013-04-27T04:02:25.636+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4429/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1k4lz:"}}