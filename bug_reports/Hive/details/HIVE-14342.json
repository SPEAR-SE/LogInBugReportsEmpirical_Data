{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12992679","self":"https://issues.apache.org/jira/rest/api/2/issue/12992679","key":"HIVE-14342","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12335838","id":"12335838","description":"Maintenance branch for 2.1 ","name":"2.1.1","archived":false,"released":true,"releaseDate":"2016-12-08"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335837","id":"12335837","name":"2.2.0","archived":false,"released":true,"releaseDate":"2017-07-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-08-04T23:08:48.100+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Mar 05 11:37:49 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_3_*:*_787249691_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_3_*:*_685728690","customfield_12312321":null,"resolutiondate":"2016-08-12T19:25:43.554+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14342/watchers","watchCount":5,"isWatching":false},"created":"2016-07-26T18:16:05.575+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"issuelinks":[{"id":"12476068","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12476068","type":{"id":"12310050","name":"Regression","inward":"is broken by","outward":"breaks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310050"},"inwardIssue":{"id":"12703841","key":"HIVE-6758","self":"https://issues.apache.org/jira/rest/api/2/issue/12703841","fields":{"summary":"Beeline doesn't work with -e option when started in background","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-03-05T11:37:49.740+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324409","id":"12324409","name":"Beeline"}],"timeoriginalestimate":null,"description":"{code}\nuse default;\ncreate table clitest (key int, name String, value String);\ninsert into table clitest values (1,\"TRUE\",\"1\"),(2,\"TRUE\",\"1\"),(3,\"TRUE\",\"1\"),(4,\"TRUE\",\"1\"),(5,\"FALSE\",\"0\"),(6,\"FALSE\",\"0\"),(7,\"FALSE\",\"0\");\n{code}\n\nthen run a select query\n{code} \n# cat /tmp/select.sql \nset hive.execution.engine=mr;\nselect key,name,value \nfrom clitest \nwhere value=\"1\" limit 1;\n{code}\n\nThen run beeline via a remote shell, for example\n{code}\n$ ssh -l root <remotehost.domain.com> \"sudo -u hive beeline -u jdbc:hive2://localhost:10000 -n hive -p hive --silent=true --outputformat=csv2 -f /tmp/select.sql\" \nroot@<remoteHost.domain.com>'s password: \n16/07/12 14:59:22 WARN mapreduce.TableMapReduceUtil: The hbase-prefix-tree module jar containing PrefixTreeCodec is not present.  Continuing without it.\nnullkey,name,value                                     \n1,TRUE,1\nnull                                                   \n$\n{code}\n\nIn older releases that the output is as follows\n{code}\n$ ssh -l root <remoteHost.domain.com> \"sudo -u hive beeline -u jdbc:hive2://localhost:10000 -n hive -p hive --silent=true --outputformat=csv2 -f /tmp/run.sql\" \nAre you sure you want to continue connecting (yes/no)? yes\nroot@<remoteHost.domain.com>'s password: \n16/07/12 14:57:55 WARN mapreduce.TableMapReduceUtil: The hbase-prefix-tree module jar containing PrefixTreeCodec is not present.  Continuing without it.\n\n\n\nkey,name,value\n1,TRUE,1\n\n\n$\n{code}\n\nThe output contains nulls instead of blank lines. This is due to the use of -Djline.terminal=jline.UnsupportedTerminal introduced in HIVE-6758 to be able to run beeline as a background process. But this is the unfortunate side effect of that fix.\n\nRunning beeline in background also produces garbled output.\n{code}\n# beeline -u \"jdbc:hive2://localhost:10000\" -n hive -p hive --silent=true --outputformat=csv2 --showHeader=false -f /tmp/run.sql 2>&1 > /tmp/beeline.txt &\n# cat /tmp/beeline.txt \nnull1,TRUE,1                                           \n\n#\n{code}\n\nSo I think the use of jline.UnsupportedTerminal should be documented but not used automatically by beeline under the covers.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12822344","id":"12822344","filename":"HIVE-14342.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-05T17:53:43.689+0000","size":905,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12822344/HIVE-14342.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12822205","id":"12822205","filename":"HIVE-14342.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-04T23:28:13.999+0000","size":460,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12822205/HIVE-14342.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12822163","id":"12822163","filename":"HIVE-14342.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-04T20:56:09.346+0000","size":460,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12822163/HIVE-14342.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Beeline output is garbled when executed from a remote shell","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15408468","id":"15408468","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"After quite a bit of testing, I found that the most reliable means to detect if beeline is being run via a remote shell is to check if the <stdin> for the process is a pipe.\nSo I have added an additional check to the condition before using jline's UnsupportedTerminal. The use of UnsupportedTerminal should be limited to beeline processes running locally as a background process.\n\nThe output now is as we expected prior to this change.\n{code}\nssh -l root <remoteHost.domain.com> \"sudo -u hive beeline -u jdbc:hive2://localhost:10000 -n hive -p hive --silent=true --outputformat=csv2 -f /tmp/run.sql\"\nroot@<remoteHost.domain.com>'s password: \n16/08/04 13:46:35 WARN mapreduce.TableMapReduceUtil: The hbase-prefix-tree module jar containing PrefixTreeCodec is not present.  Continuing without it.\n\n\n\n\n\nkey,name,value\n1,TRUE,1\n\n\n$\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-04T20:54:10.716+0000","updated":"2016-08-04T20:54:10.716+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15408628","id":"15408628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12822163/HIVE-14342.patch\n\n{color:red}ERROR:{color} -1 due to build exiting with an error\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/777/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/777/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-777/\n\nMessages:\n{noformat}\n**** This message was trimmed, see log for full details ****\n[INFO] Executing tasks\n\nmain:\n    [mkdir] Created dir: /data/hive-ptest/working/apache-github-source-source/spark-client/target/tmp\n    [mkdir] Created dir: /data/hive-ptest/working/apache-github-source-source/spark-client/target/warehouse\n    [mkdir] Created dir: /data/hive-ptest/working/apache-github-source-source/spark-client/target/tmp/conf\n     [copy] Copying 15 files to /data/hive-ptest/working/apache-github-source-source/spark-client/target/tmp/conf\n[INFO] Executed tasks\n[INFO] \n[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ spark-client ---\n[INFO] Compiling 5 source files to /data/hive-ptest/working/apache-github-source-source/spark-client/target/test-classes\n[INFO] \n[INFO] --- maven-dependency-plugin:2.8:copy (copy-guava-14) @ spark-client ---\n[INFO] Configured Artifact: com.google.guava:guava:14.0.1:jar\n[INFO] Copying guava-14.0.1.jar to /data/hive-ptest/working/apache-github-source-source/spark-client/target/dependency/guava-14.0.1.jar\n[INFO] \n[INFO] --- maven-surefire-plugin:2.16:test (default-test) @ spark-client ---\n[INFO] Tests are skipped.\n[INFO] \n[INFO] --- maven-jar-plugin:2.2:jar (default-jar) @ spark-client ---\n[INFO] Building jar: /data/hive-ptest/working/apache-github-source-source/spark-client/target/spark-client-2.2.0-SNAPSHOT.jar\n[INFO] \n[INFO] --- maven-site-plugin:3.3:attach-descriptor (attach-descriptor) @ spark-client ---\n[INFO] \n[INFO] --- maven-install-plugin:2.4:install (default-install) @ spark-client ---\n[INFO] Installing /data/hive-ptest/working/apache-github-source-source/spark-client/target/spark-client-2.2.0-SNAPSHOT.jar to /data/hive-ptest/working/maven/org/apache/hive/spark-client/2.2.0-SNAPSHOT/spark-client-2.2.0-SNAPSHOT.jar\n[INFO] Installing /data/hive-ptest/working/apache-github-source-source/spark-client/pom.xml to /data/hive-ptest/working/maven/org/apache/hive/spark-client/2.2.0-SNAPSHOT/spark-client-2.2.0-SNAPSHOT.pom\n[INFO]                                                                         \n[INFO] ------------------------------------------------------------------------\n[INFO] Building Hive Query Language 2.2.0-SNAPSHOT\n[INFO] ------------------------------------------------------------------------\n[INFO] \n[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hive-exec ---\n[INFO] Deleting /data/hive-ptest/working/apache-github-source-source/ql/target\n[INFO] Deleting /data/hive-ptest/working/apache-github-source-source/ql (includes = [datanucleus.log, derby.log], excludes = [])\n[INFO] \n[INFO] --- maven-enforcer-plugin:1.3.1:enforce (enforce-no-snapshots) @ hive-exec ---\n[INFO] \n[INFO] --- maven-antrun-plugin:1.7:run (generate-sources) @ hive-exec ---\n[INFO] Executing tasks\n\nmain:\n    [mkdir] Created dir: /data/hive-ptest/working/apache-github-source-source/ql/target/generated-sources/java/org/apache/hadoop/hive/ql/exec/vector/expressions/gen\n    [mkdir] Created dir: /data/hive-ptest/working/apache-github-source-source/ql/target/generated-sources/java/org/apache/hadoop/hive/ql/exec/vector/expressions/aggregates/gen\n    [mkdir] Created dir: /data/hive-ptest/working/apache-github-source-source/ql/target/generated-test-sources/java/org/apache/hadoop/hive/ql/exec/vector/expressions/gen\nGenerating vector expression code\nGenerating vector expression test code\n[INFO] Executed tasks\n[INFO] \n[INFO] --- build-helper-maven-plugin:1.8:add-source (add-source) @ hive-exec ---\n[INFO] Source directory: /data/hive-ptest/working/apache-github-source-source/ql/src/gen/thrift/gen-javabean added.\n[INFO] Source directory: /data/hive-ptest/working/apache-github-source-source/ql/target/generated-sources/java added.\n[INFO] \n[INFO] --- antlr3-maven-plugin:3.4:antlr (default) @ hive-exec ---\n[INFO] ANTLR: Processing source directory /data/hive-ptest/working/apache-github-source-source/ql/src/java\nANTLR Parser Generator  Version 3.4\norg/apache/hadoop/hive/ql/parse/HiveLexer.g\norg/apache/hadoop/hive/ql/parse/HiveParser.g\n[INFO] \n[INFO] --- maven-remote-resources-plugin:1.5:process (default) @ hive-exec ---\n[INFO] \n[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hive-exec ---\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\n[INFO] Copying 4 resources\n[INFO] Copying 3 resources\n[INFO] \n[INFO] --- maven-antrun-plugin:1.7:run (define-classpath) @ hive-exec ---\n[INFO] Executing tasks\n\nmain:\n[INFO] Executed tasks\n[INFO] \n[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ hive-exec ---\n[INFO] Compiling 2653 source files to /data/hive-ptest/working/apache-github-source-source/ql/target/classes\n[INFO] -------------------------------------------------------------\n[ERROR] COMPILATION ERROR : \n[INFO] -------------------------------------------------------------\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java:[130,40] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: package org.apache.hadoop.hive.metastore\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[22,40] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: package org.apache.hadoop.hive.metastore\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java:[168,11] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.metadata.Hive\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java:[3472,23] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.metadata.Hive\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbLockManager.java:[21,40] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: package org.apache.hadoop.hive.metastore\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[64,11] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.lockmgr.DbTxnManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[89,30] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.lockmgr.DbTxnManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[110,18] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.lockmgr.DbTxnManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbLockManager.java:[56,11] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.lockmgr.DbLockManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbLockManager.java:[60,17] cannot find symbol\n  symbol:   class SynchronizedMetaStoreClient\n  location: class org.apache.hadoop.hive.ql.lockmgr.DbLockManager\n[INFO] 10 errors \n[INFO] -------------------------------------------------------------\n[INFO] ------------------------------------------------------------------------\n[INFO] Reactor Summary:\n[INFO] \n[INFO] Hive .............................................. SUCCESS [1.803s]\n[INFO] Hive Shims Common ................................. SUCCESS [3.575s]\n[INFO] Hive Shims 0.23 ................................... SUCCESS [1.900s]\n[INFO] Hive Shims Scheduler .............................. SUCCESS [0.555s]\n[INFO] Hive Shims ........................................ SUCCESS [0.339s]\n[INFO] Hive Storage API .................................. SUCCESS [0.892s]\n[INFO] Hive ORC .......................................... SUCCESS [4.303s]\n[INFO] Hive Common ....................................... SUCCESS [4.289s]\n[INFO] Hive Service RPC .................................. SUCCESS [3.322s]\n[INFO] Hive Serde ........................................ SUCCESS [4.440s]\n[INFO] Hive Metastore .................................... SUCCESS [18.939s]\n[INFO] Hive Ant Utilities ................................ SUCCESS [0.295s]\n[INFO] Hive Llap Common .................................. SUCCESS [2.427s]\n[INFO] Hive Llap Client .................................. SUCCESS [1.042s]\n[INFO] Hive Llap Tez ..................................... SUCCESS [1.641s]\n[INFO] Spark Remote Client ............................... SUCCESS [2.821s]\n[INFO] Hive Query Language ............................... FAILURE [17.695s]\n[INFO] Hive Llap Server .................................. SKIPPED\n[INFO] Hive Service ...................................... SKIPPED\n[INFO] Hive Accumulo Handler ............................. SKIPPED\n[INFO] Hive JDBC ......................................... SKIPPED\n[INFO] Hive Beeline ...................................... SKIPPED\n[INFO] Hive CLI .......................................... SKIPPED\n[INFO] Hive Contrib ...................................... SKIPPED\n[INFO] Hive HBase Handler ................................ SKIPPED\n[INFO] Hive HCatalog ..................................... SKIPPED\n[INFO] Hive HCatalog Core ................................ SKIPPED\n[INFO] Hive HCatalog Pig Adapter ......................... SKIPPED\n[INFO] Hive HCatalog Server Extensions ................... SKIPPED\n[INFO] Hive HCatalog Webhcat Java Client ................. SKIPPED\n[INFO] Hive HCatalog Webhcat ............................. SKIPPED\n[INFO] Hive HCatalog Streaming ........................... SKIPPED\n[INFO] Hive HPL/SQL ...................................... SKIPPED\n[INFO] Hive HWI .......................................... SKIPPED\n[INFO] Hive Llap External Client ......................... SKIPPED\n[INFO] Hive Shims Aggregator ............................. SKIPPED\n[INFO] Hive TestUtils .................................... SKIPPED\n[INFO] Hive Packaging .................................... SKIPPED\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 1:11.114s\n[INFO] Finished at: Thu Aug 04 23:08:56 UTC 2016\n[INFO] Final Memory: 131M/1021M\n[INFO] ------------------------------------------------------------------------\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.1:compile (default-compile) on project hive-exec: Compilation failure: Compilation failure:\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java:[130,40] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: package org.apache.hadoop.hive.metastore\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[22,40] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: package org.apache.hadoop.hive.metastore\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java:[168,11] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.metadata.Hive\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java:[3472,23] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.metadata.Hive\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbLockManager.java:[21,40] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: package org.apache.hadoop.hive.metastore\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[64,11] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.lockmgr.DbTxnManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[89,30] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.lockmgr.DbTxnManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java:[110,18] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.lockmgr.DbTxnManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbLockManager.java:[56,11] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.lockmgr.DbLockManager\n[ERROR] /data/hive-ptest/working/apache-github-source-source/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbLockManager.java:[60,17] cannot find symbol\n[ERROR] symbol:   class SynchronizedMetaStoreClient\n[ERROR] location: class org.apache.hadoop.hive.ql.lockmgr.DbLockManager\n[ERROR] -> [Help 1]\n[ERROR] \n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\n[ERROR] \n[ERROR] For more information about the errors and possible solutions, please read the following articles:\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException\n[ERROR] \n[ERROR] After correcting the problems, you can resume the build with the command\n[ERROR]   mvn <goals> -rf :hive-exec\n+ exit 1\n'\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12822163 - PreCommit-HIVE-MASTER-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-08-04T23:08:48.100+0000","updated":"2016-08-04T23:08:48.100+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15408641","id":"15408641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"Pre-commit build failed because of build failure due to missing file from HIVE-14204. Retrying","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-04T23:28:02.059+0000","updated":"2016-08-04T23:28:02.059+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15408918","id":"15408918","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12822205/HIVE-14342.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10440 tests executed\n*Failed tests:*\n{noformat}\nTestMsgBusConnection - did not produce a TEST-*.xml file\nTestQueryLifeTimeHook - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_orc_llap_counters\norg.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler.testRevokeTimedOutWorkers\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/781/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/781/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-781/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 4 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12822205 - PreCommit-HIVE-MASTER-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-08-05T05:49:30.295+0000","updated":"2016-08-05T05:49:30.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15409377","id":"15409377","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"[~mohitsabharwal] [~aihuaxu] Could you please review the fix? \nThe proposed fix adds an additional condition to only use the UnsupportedTerminal for beeline running as background process when run locally. The condition detects that beeline is being invoked from a remote shell by checking if stdin for the script is a pipe.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-05T12:14:05.190+0000","updated":"2016-08-05T12:14:05.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15409798","id":"15409798","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"Appears that from HIVE-11717 we need to make an additional change to the cli.sh \nAttaching a new patch that includes that fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-05T17:53:43.710+0000","updated":"2016-08-05T17:53:43.710+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15410064","id":"15410064","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"body":"Thanks, [~ngangam]\n\nWondering if you tried simply detecting if the prompt\nvariable is set ? Seems like that is a more intuitive\nsolution:\nhttp://tldp.org/LDP/abs/html/intandnonint.html","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"created":"2016-08-05T21:04:58.619+0000","updated":"2016-08-05T21:04:58.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15410183","id":"15410183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"Thanks Mohit. I ran the following test on bash 4.1.2 (tried both conditions, the second condition for Bash 4.2+ does not seem to work as expected).\nThe prompt variable does not seem to be set in any scenario. I ran the test both in background and foreground and the result is the same. Running from a remote node results in the same.\n\n{code}\n# cat test.sh \n#!/usr/bin/env bash\n\nif [ -z $PS1 ] # no prompt?\n#if [ -v PS1 ]   # On Bash 4.2+ ...\nthen\n  echo \"non-interactive3\"\nelse\n  echo \"interactive3\"\nfi\n# ./test.sh \nnon-interactive3\n# ./test.sh &\n[1] 5715\n# non-interactive3\n\n[1]+  Done                    ./test.sh\n{code}\n\nFrom a remote node\n{code}\nngangam-MBP-2:~ ngangam$ ssh -l root <remoteHost.domain.com> \"/root/test.sh\"\nroot@<remoteHost.domain.com>'s password: \nnon-interactive3\n{code}\n\nIn the link above, further down on the page, there is a sample using exactly what the patch is, \"-p /dev/stdin\". Do you know any other means that might work? Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2016-08-05T22:21:58.827+0000","updated":"2016-08-05T22:21:58.827+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15410524","id":"15410524","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12822344/HIVE-14342.2.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 10440 tests executed\n*Failed tests:*\n{noformat}\nTestMsgBusConnection - did not produce a TEST-*.xml file\nTestQueryLifeTimeHook - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_orc_llap_counters\norg.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService.testDelayedLocalityNodeCommErrorImmediateAllocation\norg.apache.hive.jdbc.TestJdbcWithMiniHS2.testAddJarConstructorUnCaching\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/793/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/793/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-793/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 5 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12822344 - PreCommit-HIVE-MASTER-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-08-06T07:15:45.965+0000","updated":"2016-08-06T07:15:45.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15417553","id":"15417553","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"body":"Thanks, [~ngangam], LGTM +1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"created":"2016-08-11T16:43:52.193+0000","updated":"2016-08-11T16:43:52.193+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/15419331","id":"15419331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"Committed to 2.2.0 and 2.1.1, thanks [~ngangam] for the patch and [~mohitsabharwal] for review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2016-08-12T19:25:43.759+0000","updated":"2016-08-12T19:25:43.759+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/16374205","id":"16374205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cabot","name":"cabot","key":"cabot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Smith","active":true,"timeZone":"Etc/UTC"},"body":"Are you sure this has been fixed? We are using Cloudera distribution with HIVE-14342 bundled and I can confirm that cli.sh file contains check for unsupported terminal:\r\n\r\n{code}\r\nupdateBeelineOpts() {\r\n  # If process is backgrounded, don't change terminal settings\r\n  if [[ ( ! $(ps -o stat= -p $$) =~ *+ ) && ! ( -p /dev/stdin ) ]]; then\r\n    export HADOOP_CLIENT_OPTS=\"$HADOOP_CLIENT_OPTS -Djline.terminal=jline.UnsupportedTerminal\"\r\n  fi\r\n}\r\n{code}\r\n\r\n \r\n\r\n*Test case to reproduce:*\r\n\r\n_*test.hql content:*_\r\n{code:sql}\r\n   SELECT 1;\r\n{code}\r\n_*Bash command & output:*_\r\n{code:bash}\r\n$ beeline -u jdbc:hive2://xxxxxxx:10000 --silent=true  --showWarnings=false --showNestedErrs=false --showHeader=false --outputformat=tsv2 -f ~/test.hql & wait\r\n[1] 3076126\r\nnull1\r\n\r\n{code}\r\nI also tried to add this line before calling beeline:\r\n{code:java}\r\n export HADOOP_CLIENT_OPTS=\"$HADOOP_CLIENT_OPTS -Djline.terminal=jline.UnsupportedTerminal\"\r\n\r\n{code}\r\nNothing has changed. Please help.\r\n\r\n \r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cabot","name":"cabot","key":"cabot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Smith","active":true,"timeZone":"Etc/UTC"},"created":"2018-02-23T10:47:30.014+0000","updated":"2018-02-23T10:56:14.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/16378643","id":"16378643","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cabot","name":"cabot","key":"cabot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Smith","active":true,"timeZone":"Etc/UTC"},"body":"Anyone can confirm my issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cabot","name":"cabot","key":"cabot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Smith","active":true,"timeZone":"Etc/UTC"},"created":"2018-02-27T14:22:10.706+0000","updated":"2018-02-27T14:22:10.706+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/16383719","id":"16383719","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"body":"[~cabot] Your testcase is slightly different than the issue in this jira. You are running beeline as a background process that has to use the {{-Djline.terminal=jline.UnsupportedTerminal}} property. Otherwise there is contention for STDOUT/STDERR streams between the JLine Terminal and Unix background process. As a result, the backgrounded beeline process is SUSPENDED by the OS (similar to CNTRL Z). \r\n\r\nSo without using this property, beeline wouldnt even run as a background process. But unfortunately, it appears to have this side effect. I can look at the jline code again to see if there have been any fixes.\r\n\r\nDoes that make sense?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ngangam","name":"ngangam","key":"ngangam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Naveen Gangam","active":true,"timeZone":"America/New_York"},"created":"2018-03-02T15:51:36.847+0000","updated":"2018-03-02T15:51:36.847+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992679/comment/16385980","id":"16385980","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cabot","name":"cabot","key":"cabot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Smith","active":true,"timeZone":"Etc/UTC"},"body":"[~ngangam] Thank you for your response!\r\nAre you able to reproduce my problem on your cluster configuration as well?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cabot","name":"cabot","key":"cabot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Smith","active":true,"timeZone":"Etc/UTC"},"created":"2018-03-05T11:37:49.740+0000","updated":"2018-03-05T11:37:49.740+0000"}],"maxResults":15,"total":15,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14342/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i31j13:"}}