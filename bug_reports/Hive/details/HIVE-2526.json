{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12528614","self":"https://issues.apache.org/jira/rest/api/2/issue/12528614","key":"HIVE-2526","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2011-10-31T11:57:17.325+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Aug 30 09:23:25 UTC 2017","customfield_12310420":"214474","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2526/watchers","watchCount":7,"isWatching":false},"created":"2011-10-25T04:48:49.388+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317742","id":"12317742","description":"released","name":"0.9.0","archived":false,"released":true,"releaseDate":"2012-04-30"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini","name":"priyadarshini","key":"priyadarshini","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-08-30T09:23:25.779+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"When the table is accessed(load),lastAccessTime is displaying updated accessTime in \n\n\"show table extended like <table_name>\".But \"describe extended <table_name>\" is always displaying zero.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12504468","id":"12504468","filename":"HIVE-2526.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-21T05:20:58.255+0000","size":21877,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12504468/HIVE-2526.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123957","customfield_12312823":null,"summary":"\"lastAceesTime\" is always zero when executed through \"describe extended <table_name>\" unlike \"show table extende like <table_name>\"  where lastAccessTime is updated.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rohithsharma","name":"rohithsharma","key":"rohithsharma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rohith Sharma K S","active":true,"timeZone":"Australia/Sydney"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux : SuSE 11 SP1","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12528614/comment/13140082","id":"13140082","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anoopsamjohn","name":"anoopsamjohn","key":"anoopsamjohn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anoop Sam John","active":true,"timeZone":"Asia/Kolkata"},"body":"As part of meta data for table, there are fields named 'lastAccessTime' and 'createTime'.[ Both are of int type also]. But as of now we are not maintaining any values in these fields and always will be zero only.[ default value].\nWhen I checked the code DDLTask.writeFileSystemStats () contains code to display the lastaccesstime by getting the last access time from the underlying file system. So in case of command, show table extended like <TN>, this method is getting used and the last access time is getting displayed. In case of command describe exteneded <TN> the last access time is getting dispalyed from \noutStream.writeBytes(tbl.getTTable().toString());\nIn org.apache.hadoop.hive.metastore.api.Table, the \nprivate int lastAccessTime; will always be default value ( 0 ) only and no one updates this also.\n\nI have 2 points here.\n1. Why we are not making use of the fields in tbls meta data table for storing the last access time, create time?\n2. Why is the dat type for lastAccessTime in org.apache.hadoop.hive.metastore.api.Table is int and not long? In order to capture the access time with values of System.currentTimeMillis() this type to be long. Also pls refer that in case of org.apache.hadoop.fs.FileStatus the access_time is having long data type rather than int.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anoopsamjohn","name":"anoopsamjohn","key":"anoopsamjohn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anoop Sam John","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-31T11:57:17.325+0000","updated":"2011-10-31T11:57:17.325+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12528614/comment/13153996","id":"13153996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2896/\n-----------------------------------------------------------\n\nReview request for hive.\n\n\nSummary\n-------\n\nWhen \"describe extended <tname>\" is executed, lastAccessTime is always zero because its not gtting updated.\nNow we have updated the lastAccessTime using the HDFS FileStatus api.\n\n\nThis addresses bug HIVE-2526.\n    https://issues.apache.org/jira/browse/HIVE-2526\n\n\nDiffs\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1202581 \n  trunk/ql/src/test/results/clientpositive/ppr_pushdown.q.out 1202581 \n\nDiff: https://reviews.apache.org/r/2896/diff\n\n\nTesting\n-------\n\nAll existing tests are passed.\n\n\nThanks,\n\nPriyadarshini\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-21T05:33:51.664+0000","updated":"2011-11-21T05:33:51.664+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12528614/comment/13153997","id":"13153997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"body":"When \"describe extended <tname>\" is executed, lastAccessTime is always zero because its not gtting updated.\nNow we have updated the lastAccessTime using the HDFS FileStatus api.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-21T05:34:33.106+0000","updated":"2011-11-21T05:34:33.106+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12528614/comment/13166588","id":"13166588","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"If we want to maintain the last access time, it should be at the metadata level (in the metastore),\nand not computed dynamically.\n\nAlso, if you want to maintain the last access time, it should be done for both hive access and metastore access.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-12-09T21:38:39.487+0000","updated":"2011-12-09T21:38:39.487+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12528614/comment/13167438","id":"13167438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for the comments Namit..\n\nIn org.apache.hadoop.hive.metastore.api.Table, the field lastAccessTime has the datatype as int.\nThis field should be of type long for capturing the time information. So thrift side changes has to be done for changing the type.\nAlso \"show table extended like <tname>\" needs to be changed where it dynamically calculates the lastAccessTime from HDFS.\nNow lastAccessTime has to be updated into metadata also.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-12T10:27:12.274+0000","updated":"2011-12-12T10:27:12.274+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12528614/comment/16146944","id":"16146944","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsen","name":"dsen","key":"dsen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Dmytro Sen","active":true,"timeZone":"Europe/Kiev"},"body":"I you want lastAccessTime updated, just set\n{code}\nset hive.exec.pre.hooks = org.apache.hadoop.hive.ql.hooks.UpdateInputAccessTimeHook$PreExec;\n{code}\n\nThe hook will update LAST_ACCESS_TIME on every query as it was initially implemented in HIVE-1819, so both commands will return non-zero lastAccessTime.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsen","name":"dsen","key":"dsen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Dmytro Sen","active":true,"timeZone":"Europe/Kiev"},"created":"2017-08-30T09:23:25.779+0000","updated":"2017-08-30T09:23:25.779+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2526/votes","votes":13,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lkev:"}}