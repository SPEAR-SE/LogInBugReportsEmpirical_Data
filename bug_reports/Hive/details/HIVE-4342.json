{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12642166","self":"https://issues.apache.org/jira/rest/api/2/issue/12642166","key":"HIVE-4342","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323587","id":"12323587","description":"Hive 0.11.0","name":"0.11.0","archived":false,"released":true,"releaseDate":"2013-05-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-04-19T05:59:00.612+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Apr 27 00:08:41 UTC 2013","customfield_12310420":"322580","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_42083467_*|*_1_*:*_1_*:*_792258329_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-04-21T16:06:23.746+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4342/watchers","watchCount":6,"isWatching":false},"created":"2013-04-12T00:20:41.971+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317742","id":"12317742","description":"released","name":"0.9.0","archived":false,"released":true,"releaseDate":"2012-04-30"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-16T21:10:26.723+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312594","id":"12312594","name":"Logging","description":"Tracks issues dealing with logging and log messages."},{"self":"https://issues.apache.org/jira/rest/api/2/component/12312584","id":"12312584","name":"Metastore","description":"Tracks issue dealing with metastore."},{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":null,"description":"UNION ALL query with JOIN in first part and another UNION ALL in second part gives NPE.\n\nbq. JOIN\nUNION ALL\nbq. UNION ALL\n\nAttachments:\n1. HiveCommands.txt : command script to setup schema for query under consideration.\n2. sourceData1.txt and sourceData2.txt : required for above command script.\n3. Query.txt : Exact query which produces NPE.\n\nNOTE: you will need to update path to sourceData1.txt and sourceData2.txt in the HiveCommands.txt to suit your environment.\n\nAttached files contain the schema and exact query which fails on Hive 0.9.\nIt is worthwhile to note that the same query executes successfully on Hive 0.7.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579706","id":"12579706","filename":"HIVE-4342.D10407.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-21T04:23:15.749+0000","size":32548,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12579706/HIVE-4342.D10407.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579641","id":"12579641","filename":"HiveCommands.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-19T23:53:23.402+0000","size":931,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12579641/HiveCommands.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579644","id":"12579644","filename":"Query.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-19T23:53:23.409+0000","size":360,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12579644/Query.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579642","id":"12579642","filename":"sourceData1.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-19T23:53:23.405+0000","size":7,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12579642/sourceData1.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12579643","id":"12579643","filename":"sourceData2.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-19T23:53:23.407+0000","size":33,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12579643/sourceData2.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"322925","customfield_12312823":null,"summary":"NPE for query involving UNION ALL with nested JOIN and UNION ALL","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Red Hat Linux VM with Hive 0.9 and Hadoop 2.0","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13629644","id":"13629644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"body":"Attached file contains the schema and exact query which fails on Hive 0.9.\nIt is worthwhile to note that the same query executes successfully on Hive 0.7.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-12T00:47:21.892+0000","updated":"2013-04-12T00:47:21.892+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13636106","id":"13636106","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"I've tried with trunk and got various exceptions.\n\nwith default configuration,\n\n{noformat}\norg.apache.hadoop.hive.ql.parse.SemanticException: Big Table Alias is null\n\tat org.apache.hadoop.hive.ql.optimizer.MapJoinProcessor.genMapJoinLocalWork(MapJoinProcessor.java:217)\n\tat org.apache.hadoop.hive.ql.optimizer.MapJoinProcessor.genMapJoinOpAndLocalWork(MapJoinProcessor.java:232)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver$CommonJoinTaskDispatcher.convertTaskToMapJoinTask(CommonJoinResolver.java:245)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver$CommonJoinTaskDispatcher.processCurrentTask(CommonJoinResolver.java:372)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver$CommonJoinTaskDispatcher.dispatch(CommonJoinResolver.java:553)\n\tat org.apache.hadoop.hive.ql.lib.TaskGraphWalker.dispatch(TaskGraphWalker.java:111)\n\tat org.apache.hadoop.hive.ql.lib.TaskGraphWalker.walk(TaskGraphWalker.java:194)\n\tat org.apache.hadoop.hive.ql.lib.TaskGraphWalker.startWalking(TaskGraphWalker.java:139)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver.resolve(CommonJoinResolver.java:112)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.PhysicalOptimizer.optimize(PhysicalOptimizer.java:79)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genMapRedTasks(SemanticAnalyzer.java:8387)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:8759)\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:279)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:433)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:337)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:902)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:259)\n\tat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:216)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:413)\n\tat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:756)\n\tat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:614)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:186)\norg.apache.hadoop.hive.ql.parse.SemanticException: Generate New MapJoin Opertor Exeception Big Table Alias is null\n\tat org.apache.hadoop.hive.ql.optimizer.MapJoinProcessor.genMapJoinOpAndLocalWork(MapJoinProcessor.java:242)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver$CommonJoinTaskDispatcher.convertTaskToMapJoinTask(CommonJoinResolver.java:245)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver$CommonJoinTaskDispatcher.processCurrentTask(CommonJoinResolver.java:372)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver$CommonJoinTaskDispatcher.dispatch(CommonJoinResolver.java:553)\n\tat org.apache.hadoop.hive.ql.lib.TaskGraphWalker.dispatch(TaskGraphWalker.java:111)\n\tat org.apache.hadoop.hive.ql.lib.TaskGraphWalker.walk(TaskGraphWalker.java:194)\n\tat org.apache.hadoop.hive.ql.lib.TaskGraphWalker.startWalking(TaskGraphWalker.java:139)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.CommonJoinResolver.resolve(CommonJoinResolver.java:112)\n\tat org.apache.hadoop.hive.ql.optimizer.physical.PhysicalOptimizer.optimize(PhysicalOptimizer.java:79)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genMapRedTasks(SemanticAnalyzer.java:8387)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:8759)\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:279)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:433)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:337)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:902)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:259)\n\tat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:216)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:413)\n\tat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:756)\n\tat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:614)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:186)\nFAILED: SemanticException Generate Map Join Task Error: Generate New MapJoin Opertor Exeception Big Table Alias is null\n{noformat}\n\nand with \nset hive.auto.convert.join=false;\nset hive.auto.convert.join.noconditionaltask=false;\n\n{noformat}\njava.lang.ArrayIndexOutOfBoundsException: 0\n\tat org.apache.hadoop.mapred.FileInputFormat.setInputPaths(FileInputFormat.java:315)\n\tat org.apache.hadoop.hive.ql.exec.ExecDriver.setInputPaths(ExecDriver.java:904)\n\tat org.apache.hadoop.hive.ql.exec.ExecDriver.addInputPaths(ExecDriver.java:890)\n\tat org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:416)\n\tat org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:138)\n\tat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:144)\n\tat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)\n\tat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1349)\n\tat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1135)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:945)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:259)\n\tat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:216)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:413)\n\tat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:756)\n\tat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:614)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:186)\nJob Submission failed with exception 'java.lang.ArrayIndexOutOfBoundsException(0)'\njava.lang.IllegalArgumentException: Can not create a Path from an empty string\n\tat org.apache.hadoop.fs.Path.checkPathArg(Path.java:82)\n\tat org.apache.hadoop.fs.Path.<init>(Path.java:90)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.getHiveJobID(Utilities.java:384)\n\tat org.apache.hadoop.hive.ql.exec.Utilities.clearMapRedWork(Utilities.java:197)\n\tat org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:471)\n\tat org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:138)\n\tat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:144)\n\tat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)\n\tat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1349)\n\tat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1135)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:945)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:259)\n\tat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:216)\n\tat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:413)\n\tat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:756)\n\tat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:614)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:186)\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-19T05:59:00.612+0000","updated":"2013-04-19T05:59:00.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13637023","id":"13637023","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"body":"[~navis]\nI have updated the attachments which contain the command script to generate schema, the data to be used with the command script and the exact query! I hope you are able to reproduce the NPE with this information.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-19T23:55:02.966+0000","updated":"2013-04-19T23:55:02.966+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13637463","id":"13637463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"body":"navis requested code review of \"HIVE-4342 [jira] NPE for query involving UNION ALL with nested JOIN and UNION ALL\".\n\nReviewers: JIRA\n\nHIVE-4342 temp\n\nUNION ALL query with JOIN in first part and another UNION ALL in second part gives NPE.\n\nJOIN\nUNION ALL\nUNION ALL\n\nAttachments:\n1. HiveCommands.txt : command script to setup schema for query under consideration.\n2. sourceData1.txt and sourceData2.txt : required for above command script.\n3. Query.txt : Exact query which produces NPE.\n\nNOTE: you will need to update path to sourceData1.txt and sourceData2.txt in the HiveCommands.txt to suit your environment.\n\nAttached files contain the schema and exact query which fails on Hive 0.9.\nIt is worthwhile to note that the same query executes successfully on Hive 0.7.\n\nTEST PLAN\n  EMPTY\n\nREVISION DETAIL\n  https://reviews.facebook.net/D10407\n\nAFFECTED FILES\n  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRUnion1.java\n  ql/src/java/org/apache/hadoop/hive/ql/optimizer/unionproc/UnionProcContext.java\n  ql/src/java/org/apache/hadoop/hive/ql/optimizer/unionproc/UnionProcFactory.java\n  ql/src/test/queries/clientpositive/union34.q\n  ql/src/test/results/clientpositive/union34.q.out\n\nMANAGE HERALD RULES\n  https://reviews.facebook.net/herald/view/differential/\n\nWHY DID I GET THIS EMAIL?\n  https://reviews.facebook.net/herald/transcript/24921/\n\nTo: JIRA, navis\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phabricator%40reviews.facebook.net","name":"phabricator@reviews.facebook.net","key":"phabricator@reviews.facebook.net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phabricator","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-21T04:23:15.616+0000","updated":"2013-04-21T04:23:15.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13637464","id":"13637464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~mihirk] Thanks for reporting this. But generally bug fixes are only for trunk and those are seldom backported to released versions.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-04-21T04:25:00.295+0000","updated":"2013-04-21T04:25:00.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13637537","id":"13637537","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-04-21T11:36:04.797+0000","updated":"2013-04-21T11:36:04.797+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13637584","id":"13637584","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"Committed. Thanks Navis","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-04-21T16:06:23.762+0000","updated":"2013-04-21T16:06:23.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13638132","id":"13638132","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-hadoop2 #169 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/169/])\n    HIVE-4342 NPE for query involving UNION ALL with nested JOIN and UNION ALL\n(Navis via namit) (Revision 1470316)\n\n     Result = ABORTED\nnamit : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1470316\nFiles : \n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRUnion1.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/unionproc/UnionProcContext.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/unionproc/UnionProcFactory.java\n* /hive/trunk/ql/src/test/queries/clientpositive/union34.q\n* /hive/trunk/ql/src/test/results/clientpositive/union34.q.out\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-22T16:07:10.647+0000","updated":"2013-04-22T16:07:10.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13638592","id":"13638592","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-h0.21 #2074 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2074/])\n    HIVE-4342 NPE for query involving UNION ALL with nested JOIN and UNION ALL\n(Navis via namit) (Revision 1470316)\n\n     Result = FAILURE\nnamit : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1470316\nFiles : \n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRUnion1.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/unionproc/UnionProcContext.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/unionproc/UnionProcFactory.java\n* /hive/trunk/ql/src/test/queries/clientpositive/union34.q\n* /hive/trunk/ql/src/test/results/clientpositive/union34.q.out\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-23T00:04:50.956+0000","updated":"2013-04-23T00:04:50.956+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12642166/comment/13643407","id":"13643407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"body":"Thanks a lot [~navis] and [~namit] for fixing this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mihirk","name":"mihirk","key":"mihirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mihir Kulkarni","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-27T00:08:41.835+0000","updated":"2013-04-27T00:08:41.835+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4342/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1jnn3:"}}