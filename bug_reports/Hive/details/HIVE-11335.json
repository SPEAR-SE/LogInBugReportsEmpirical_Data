{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12846745","self":"https://issues.apache.org/jira/rest/api/2/issue/12846745","key":"HIVE-11335","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2015-07-22T17:29:22.998+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jul 23 06:09:39 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_50057575_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-07-22T17:30:31.687+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11335/watchers","watchCount":3,"isWatching":false},"created":"2015-07-22T03:36:14.232+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"}],"issuelinks":[{"id":"12431729","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12431729","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12773350","key":"HIVE-9613","self":"https://issues.apache.org/jira/rest/api/2/issue/12773350","fields":{"summary":"Left join query plan outputs  wrong column when using subquery","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-07-23T06:09:39.292+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324798","id":"12324798","name":"Query Planning"}],"timeoriginalestimate":null,"description":"test step\n\n{code}\ncreate table log (uid string, uid2 string);\ninsert into log values ('1', '1');\n\ncreate table user (uid string, name string);\ninsert into user values ('1', \"test1\");\n{code}\n\n(Query1)\n{code}\nselect b.name, c.name from log a\n left outer join (select uid, name from user) b on (a.uid=b.uid)\n left outer join user c on (a.uid2=c.uid);\n\n{code}\nreturn wrong result：\n1\ttest1\n\nIt should be both return test1\n\n(Query2)I try to find error, if I use this query, return right result.（join key different）\n{code}\nselect b.name, c.name from log a\n left outer join (select uid, name from user) b on (a.uid=b.uid)\n left outer join user c on (a.uid=c.uid);\n{code}\n\nThe explain is different,Query1 only select one colum. It should select uid and name.\n{code}\n        b:user \n          TableScan\n            alias: user\n            Statistics: Num rows: 1 Data size: 7 Basic stats: COMPLETE Column stats: NONE\n            Select Operator\n              expressions: uid (type: string)\n              outputColumnNames: _col0\n{code}\n\nIt may relate HIVE-10996\n\n=========UPDATE1===================\n\n(Query3) this query return correct result\n{code}\nselect b.name, c.name from log a\n left outer join (select user.uid, user.name from user) b on (a.uid=b.uid)\n left outer join user c on (a.uid2=c.uid);\n{code}\nthe operator tree\nTS[0]-SEL[1]-RS[5]-JOIN[6]-RS[7]-JOIN[9]-SEL[10]-FS[11]\nTS[2]-RS[4]-JOIN[6]\nTS[3]-RS[8]-JOIN[9]\n\nthe Query1 SEL[1] rowSchema is wrong, cannot detect the tabAlias\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12746464","id":"12746464","filename":"query1.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"created":"2015-07-22T03:46:26.897+0000","size":3161,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12746464/query1.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12746463","id":"12746463","filename":"query2.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"created":"2015-07-22T03:46:26.893+0000","size":2972,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12746463/query2.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Multi-Join Inner Query producing incorrect results","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"CDH5.4.0","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12846745/comment/14636164","id":"14636164","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"body":"[~jcamachorodriguez] Could you take a look?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"created":"2015-07-22T03:39:26.847+0000","updated":"2015-07-22T03:39:26.847+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12846745/comment/14636170","id":"14636170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"body":"attach query explain","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"created":"2015-07-22T03:46:26.900+0000","updated":"2015-07-22T03:46:26.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12846745/comment/14636823","id":"14636823","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"body":"SEL[1] rowSchema tabAlias is null, this function *ExprNodeDescUtils.indexOf(exprBack, reduceKeysBack)* return wrong. But I have no idea change the code.\n\n{code:title=SemanticAnalyzer.java}\n  private Operator genJoinReduceSinkChild(QB qb, ExprNodeDesc[] joinKeys,\n      Operator<?> child, String[] srcs, int tag) throws SemanticException {\n...\n      // backtrack can be null when input is script operator\n      ExprNodeDesc exprBack = ExprNodeDescUtils.backtrack(expr, dummy, child);\n      int kindex = exprBack == null ? -1 : ExprNodeDescUtils.indexOf(exprBack, reduceKeysBack);\n      if (kindex >= 0) {\n        ColumnInfo newColInfo = new ColumnInfo(colInfo);\n        newColInfo.setInternalName(Utilities.ReduceField.KEY + \".reducesinkkey\" + kindex);\n        newColInfo.setTabAlias(nm[0]);\n        outputRR.addMappingOnly(nm[0], nm[1], newColInfo);\n        if (nm2 != null) {\n          outputRR.addMappingOnly(nm2[0], nm2[1], newColInfo);\n        }\n        index[i] = kindex;\n        continue;\n      }\n...\n    }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"created":"2015-07-22T12:30:01.579+0000","updated":"2015-07-22T12:30:01.579+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12846745/comment/14637238","id":"14637238","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~fatkun], this is a duplicate of HIVE-9613, which had not been committed to 1.1 (in fact, the issue cannot be reproduced in other versions). With that patch, the problem is solved. I have just backported it, thus I mark this one as duplicate.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-07-22T17:29:22.998+0000","updated":"2015-07-22T17:29:22.998+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12846745/comment/14638229","id":"14638229","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"body":"thanks, I test the patch in 1.1.0, It's OK now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fatkun","name":"fatkun","key":"fatkun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fatkun","active":true,"timeZone":"Asia/Chongqing"},"created":"2015-07-23T06:09:39.292+0000","updated":"2015-07-23T06:09:39.292+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11335/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2hj3j:"}}