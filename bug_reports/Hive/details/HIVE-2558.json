{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12530664","self":"https://issues.apache.org/jira/rest/api/2/issue/12530664","key":"HIVE-2558","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324312","id":"12324312","description":"released","name":"0.12.0","archived":false,"released":true,"releaseDate":"2013-10-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-12-13T14:27:22.305+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jan 24 19:19:38 UTC 2014","customfield_12310420":"216402","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_69877414276_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-01-24T19:20:59.279+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2558/watchers","watchCount":2,"isWatching":false},"created":"2011-11-08T00:57:25.039+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-01-24T19:20:59.309+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I may be missing something, but:\n\nAfter performing:\n\ncreate table rrt (r timestamp);\ninsert into table rrt select '1970-01-01 00:00:01' from src limit 1;\n\nFollowing queries give undesirable results:\n\nselect * from rrt where r in ('1970-01-01 00:00:01');\nselect * from rrt where r in (0); \nselect * from rrt where r = 0; \nselect * from rrt where r = '1970-01-01 00:00:01';\n\nAt least for the first two, the reason may be the lack of timestamp in numericTypes Map from FunctionRegistry.java (591) . Yet whether we really want to have a linear hierarchy of primitive types in the end, is another question.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123978","customfield_12312823":null,"summary":"Timestamp comparisons don't work","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsurowka","name":"rsurowka","key":"rsurowka","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Surówka","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsurowka","name":"rsurowka","key":"rsurowka","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Surówka","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12530664/comment/13168407","id":"13168407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"body":"Hi Robert,\n\nIn the above query, timestamp is used as a column datatype of the table rrt.\nSo when u want to use the timestamp in the where clause of select statement, we should be able to tell that the data we are searching is a timestamp value.\nGiving the field value in single/double quote will be treated as a string value and not timestamp value.\nSo when u wanted to retreive the results that satisfy the timestamp value you are specifying in where clause, the query should be\n\nselect * from rrt where r = unix_timestamp('1970-01-01 00:00:01');\n\nThis would be interpreted as data u r searching is a timestamp. \nHope it helps \n\n\nThanks,\nPriya","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=priyadarshini.r","name":"priyadarshini.r","key":"priyadarshini.r","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Priyadarshini","active":true,"timeZone":"Etc/UTC"},"created":"2011-12-13T14:27:22.305+0000","updated":"2011-12-13T14:27:22.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12530664/comment/13236736","id":"13236736","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ubell","name":"ubell","key":"ubell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Ubell","active":true,"timeZone":"Etc/UTC"},"body":"In the query:\n\nselect * from rrt where r = '1970-01-01 00:00:01';\n\nyou say that the problem is that the field is treated as a string not as a time stamp but if it is treated as a string then either there should be a proper conversion of the string to timestamp (or vice versa) to do the compare or an error should be raised, you cannot just compare the bytes (or what ever hive is doing) and return an invalid answer.\n\nThe first query:\n\nselect * from rrt where r in ('1970-01-01 00:00:01');\n\ndoes the right thing:\nFAILED: Error in semantic analysis: Line 1:26 Wrong arguments ''1970-01-01 00:00:01'': The arguments for IN should be the same type! Types are: {timestamp IN (string)}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ubell","name":"ubell","key":"ubell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Ubell","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-23T16:23:43.105+0000","updated":"2012-03-23T16:23:43.105+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12530664/comment/13236800","id":"13236800","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ubell","name":"ubell","key":"ubell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Ubell","active":true,"timeZone":"Etc/UTC"},"body":"Actually I misunderstood what hive is doing.  It is converting the string to a number and then comparing it to the timestamp:\n\nselect * from rrt where r = '28801';\nOK\n1970-01-01 00:00:01\n\nWhile this does pass the reasonability test, I don't think its the right thing to do.  It would be much better to implicitly cast the string constant to a timestamp.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ubell","name":"ubell","key":"ubell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Ubell","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-23T17:21:10.453+0000","updated":"2012-03-23T17:21:10.453+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12530664/comment/13881331","id":"13881331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"body":"This has changed as of HIVE-5204 - the comparison is done as string","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdere","name":"jdere","key":"jdere","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Dere","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-01-24T19:19:38.148+0000","updated":"2014-01-24T19:19:38.148+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2558/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lkjj:"}}