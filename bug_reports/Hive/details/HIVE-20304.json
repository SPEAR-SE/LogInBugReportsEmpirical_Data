{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13176667","self":"https://issues.apache.org/jira/rest/api/2/issue/13176667","key":"HIVE-20304","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342162","id":"12342162","name":"2.3.3","archived":false,"released":false,"releaseDate":"2018-04-03"}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-08-03T13:22:46.914+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Aug 04 02:09:32 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20304/watchers","watchCount":3,"isWatching":false},"created":"2018-08-03T09:21:02.868+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12342162","id":"12342162","name":"2.3.3","archived":false,"released":false,"releaseDate":"2018-04-03"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-14T02:34:17.736+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313604","id":"12313604","name":"CLI","description":"Command-line interpreter for Hive.\n"}],"timeoriginalestimate":null,"description":"`When hive.optimize.skewjoin and hive.auto.convert.join are both set to true, and the execution engine is set to mr, same stage of a query may launch twice due to the wrong generated plan. If hive.exec.parallel is also true, the same stage will launch at the same time and the job will failed due to the first completed stage clear the map.xml/reduce.xml file stored in the hdfs.\r\n\r\nuse following sql to reproduce the issue:\r\n{code:java}\r\nCREATE TABLE `tbl1`(\r\n  `fence` string);\r\n\r\nCREATE TABLE `tbl2`(\r\n  `order_id` string,\r\n  `phone` string,\r\n  `search_id` string\r\n)\r\nPARTITIONED BY (\r\n  `dt` string);\r\n\r\n\r\nCREATE TABLE `tbl3`(\r\n  `order_id` string,\r\n  `platform` string)\r\nPARTITIONED BY (\r\n  `dt` string);\r\n\r\n\r\nCREATE TABLE `tbl4`(\r\n  `groupname` string,\r\n  `phone` string)\r\nPARTITIONED BY (\r\n  `dt` string);\r\n\r\n\r\nCREATE TABLE `tbl5`(\r\n  `search_id` string,\r\n  `fence` string)\r\nPARTITIONED BY (\r\n  `dt` string);\r\n\r\nSET hive.exec.parallel = TRUE;\r\n\r\nSET hive.auto.convert.join = TRUE;\r\n\r\nSET hive.optimize.skewjoin = TRUE;\r\n\r\n\r\nSELECT dt,\r\n               platform,\r\n               groupname,\r\n               count(1) as cnt\r\n        FROM\r\n        (SELECT dt,\r\n                platform,\r\n                groupname\r\n         FROM\r\n         (SELECT fence\r\n          FROM tbl1)ta\r\n           JOIN\r\n           (SELECT a0.dt,\r\n                   a1.platform,\r\n                   a2.groupname,\r\n                   a3.fence\r\n            FROM\r\n            (SELECT dt,\r\n                    order_id,\r\n                    phone,\r\n                    search_id\r\n             FROM tbl2\r\n             WHERE dt =20180703 )a0\r\n              JOIN\r\n              (SELECT order_id,\r\n                      platform,\r\n                      dt\r\n               FROM tbl3\r\n               WHERE dt =20180703 )a1 ON a0.order_id = a1.order_id\r\n              INNER JOIN\r\n              (SELECT groupname,\r\n                      phone,\r\n                      dt\r\n               FROM tbl4\r\n               WHERE dt =20180703 )a2 ON a0.phone = a2.phone\r\n              LEFT JOIN\r\n              (SELECT search_id,\r\n                      fence,\r\n                      dt\r\n               FROM tbl5\r\n               WHERE dt =20180703)a3 ON a0.search_id = a3.search_id)t0 ON ta.fence = t0.fence)t11\r\n        GROUP BY dt,\r\n                 platform,\r\n                 groupname;\r\n\r\nDROP TABLE tbl1;\r\nDROP TABLE tbl2;\r\nDROP TABLE tbl3;\r\nDROP TABLE tbl4;\r\nDROP TABLE tbl5;\r\n\r\n{code}\r\nWe will get some error message like this:\r\n\r\nExamining task ID: task_1531284442065_3637_m_000000 (and more) from job job_1531284442065_3637\r\n\r\nTask with the most failures(4):\r\n----\r\nTask ID:\r\n task_1531284442065_3637_m_000000\r\n\r\nURL:\r\n [http://0.0.0.0:8088/taskdetails.jsp?jobid=job_1531284442065_3637&tipid=task_1531284442065_3637_m_000000]\r\n----\r\nDiagnostic Messages for this Task:\r\n File does not exist: hdfs://test/tmp/hive-hadoop/hadoop/fe5efa94-abb1-420f-b6ba-ec782e7b79ad/hive_2018-08-03_17-00-17_707_592882314975289971-5/-mr-10045/757eb1f7-7a37-4a7e-abc0-4a3b8b06510c/reduce.xml\r\n java.io.FileNotFoundException: File does not exist: hdfs://test/tmp/hive-hadoop/hadoop/fe5efa94-abb1-420f-b6ba-ec782e7b79ad/hive_2018-08-03_17-00-17_707_592882314975289971-5/-mr-10045/757eb1f7-7a37-4a7e-abc0-4a3b8b06510c/reduce.xml\r\n\r\nLooking into the plan by executing explain, I found that the Stage-4 and Stage-5 can reached from multi root tasks.\r\n{code:java}\r\nExplain\r\nSTAGE DEPENDENCIES:\r\n  Stage-21 is a root stage , consists of Stage-34, Stage-5\r\n  Stage-34 has a backup stage: Stage-5\r\n  Stage-20 depends on stages: Stage-34\r\n  Stage-17 depends on stages: Stage-5, Stage-18, Stage-20 , consists of Stage-32, Stage-33, Stage-1\r\n  Stage-32 has a backup stage: Stage-1\r\n  Stage-15 depends on stages: Stage-32\r\n  Stage-10 depends on stages: Stage-1, Stage-15, Stage-16 , consists of Stage-31, Stage-2\r\n  Stage-31\r\n  Stage-9 depends on stages: Stage-31\r\n  Stage-2 depends on stages: Stage-9\r\n  Stage-33 has a backup stage: Stage-1\r\n  Stage-16 depends on stages: Stage-33\r\n  Stage-1\r\n  Stage-5\r\n  Stage-27 is a root stage , consists of Stage-37, Stage-38, Stage-4\r\n  Stage-37 has a backup stage: Stage-4\r\n  Stage-25 depends on stages: Stage-37\r\n  Stage-12 depends on stages: Stage-4, Stage-22, Stage-23, Stage-25, Stage-26 , consists of Stage-36, Stage-5\r\n  Stage-36\r\n  Stage-11 depends on stages: Stage-36\r\n  Stage-19 depends on stages: Stage-11 , consists of Stage-35, Stage-5\r\n  Stage-35 has a backup stage: Stage-5\r\n  Stage-18 depends on stages: Stage-35\r\n  Stage-38 has a backup stage: Stage-4\r\n  Stage-26 depends on stages: Stage-38\r\n  Stage-4\r\n  Stage-30 is a root stage , consists of Stage-42, Stage-43, Stage-3\r\n  Stage-42 has a backup stage: Stage-3\r\n  Stage-28 depends on stages: Stage-42\r\n  Stage-14 depends on stages: Stage-3, Stage-28, Stage-29 , consists of Stage-41, Stage-4\r\n  Stage-41\r\n  Stage-13 depends on stages: Stage-41\r\n  Stage-24 depends on stages: Stage-13 , consists of Stage-39, Stage-40, Stage-4\r\n  Stage-39 has a backup stage: Stage-4\r\n  Stage-22 depends on stages: Stage-39\r\n  Stage-40 has a backup stage: Stage-4\r\n  Stage-23 depends on stages: Stage-40\r\n  Stage-43 has a backup stage: Stage-3\r\n  Stage-29 depends on stages: Stage-43\r\n  Stage-3\r\n  Stage-0 depends on stages: Stage-2\r\n{code}\r\nAfter skewjoin optimization, the processed node is added into the listTasks of ConditionalTask and the parentTask of the processed node is removed and during the commonJoin optimization of listTasks of ConditionalTask, the new generated condTask will be added into root task list due to parentTask is null.\r\n\r\nworkaround: do not set hive.optimize.skewjoin and hive.auto.convert.join to true at the same time.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12934290","id":"12934290","filename":"HIVE-20304.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-03T16:47:05.069+0000","size":60572,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12934290/HIVE-20304.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12934249","id":"12934249","filename":"HIVE-20304.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-03T09:39:23.454+0000","size":1175,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12934249/HIVE-20304.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"When hive.optimize.skewjoin and hive.auto.convert.join are both set to true, and the execution engine is mr, same stage may launch twice due to the wrong generated plan","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568006","id":"16568006","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"body":"The patch just change the execution order of the skewjoin and commonjoin physical optimizer.\r\nBetter solusion needed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-03T09:42:00.206+0000","updated":"2018-08-03T09:48:02.196+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568196","id":"16568196","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (/) *{color:green}+1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  9m 11s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  9s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 43s{color} | {color:green} master passed {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  4m 21s{color} | {color:blue} ql in master has 2301 extant Findbugs warnings. {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  4s{color} | {color:green} master passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 34s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 14s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 14s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 42s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m 34s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 15s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 26m 18s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-13023/dev-support/hive-personality.sh |\r\n| git revision | master / 66ea326 |\r\n| Default Java | 1.8.0_111 |\r\n| findbugs | v3.0.0 |\r\n| modules | C: ql U: ql |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-13023/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-08-03T13:22:46.914+0000","updated":"2018-08-03T13:22:46.914+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568275","id":"16568275","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12934249/HIVE-20304.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 14859 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[runtime_skewjoin_mapjoin_spark] (batchId=58)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/13023/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/13023/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-13023/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 1 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12934249 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-08-03T14:39:12.474+0000","updated":"2018-08-03T14:39:12.474+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568467","id":"16568467","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"body":"Add one test .q file","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-03T16:48:19.571+0000","updated":"2018-08-03T16:48:19.571+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568475","id":"16568475","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=belugabehr","name":"belugabehr","key":"belugabehr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"BELUGA BEHR","active":true,"timeZone":"America/New_York"},"body":"Is this related to [HIVE-14557]?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=belugabehr","name":"belugabehr","key":"belugabehr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"BELUGA BEHR","active":true,"timeZone":"America/New_York"},"created":"2018-08-03T16:56:30.219+0000","updated":"2018-08-03T16:56:30.219+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568618","id":"16568618","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (/) *{color:green}+1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  9m 20s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 16s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 42s{color} | {color:green} master passed {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  4m 24s{color} | {color:blue} ql in master has 2301 extant Findbugs warnings. {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  5s{color} | {color:green} master passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 38s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 10s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 10s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 38s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m 42s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  4s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 15s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 26m 45s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-13028/dev-support/hive-personality.sh |\r\n| git revision | master / a3cd496 |\r\n| Default Java | 1.8.0_111 |\r\n| findbugs | v3.0.0 |\r\n| modules | C: ql U: ql |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-13028/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-08-03T18:49:43.145+0000","updated":"2018-08-03T18:49:43.145+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568671","id":"16568671","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12934290/HIVE-20304.1.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 14860 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.metastore.TestRetryingHMSHandler.testRetryingHMSHandler (batchId=226)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/13028/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/13028/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-13028/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 1 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12934290 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-08-03T19:42:30.704+0000","updated":"2018-08-03T19:42:30.704+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13176667/comment/16568989","id":"16568989","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"body":"hi, [~belugabehr] I run the sql provided by HIVE-14557 in my local environment , and I got different errors with this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=BIGrey","name":"BIGrey","key":"bigrey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hui Huang","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-04T02:09:32.879+0000","updated":"2018-08-04T02:09:32.879+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20304/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3wnmn:"}}