{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12962884","self":"https://issues.apache.org/jira/rest/api/2/issue/12962884","key":"HIVE-13623","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-01-04T18:37:54.526+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Mar 27 15:36:17 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13623/watchers","watchCount":6,"isWatching":false},"created":"2016-04-27T05:11:59.656+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/5","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sivashankar.c","name":"sivashankar.c","key":"sivashankar.c","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sivashankar","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-03-27T15:36:17.899+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Hive on mr produce correct results when (outer) joins and withClause. But tez produce wrong results \n\n{code:sql|title=Case1}\nwith a as (\nselect 1 as c1\nunion all\nselect 2 as c1\nunion all\nselect 3 as c1\n),\nb as (\nselect 1 as c1\n)\nselect * \n  from ( select a.c1 as ac1, b.c1 as bc1 \n         from a left outer join b \n         on a.c1 = b.c1 \n       ) c;\n  where c.bc1 is null\n{code}\n{code:title=case1 result}\nmr :\n+--------+--------+--+\n| c.ac1  | c.bc1  |\n+--------+--------+--+\n| 2      | NULL   |\n| 3      | NULL   |\n+--------+--------+--+\ntez :\n+--------+--------+--+\n| c.ac1  | c.bc1  |\n+--------+--------+--+\n+--------+--------+--+\n{code}\n\nCase2 as similar to Case1 produces same results.\n{code:sql|title=Case2}\nwith a as (\nselect * from j1\n),\nb as (\nselect * from j2\n)\nselect * \n  from ( select a.c1 as ac1, b.c1 as bc1 \n         from a left outer join b \n         on a.c1 = b.c1 \n       ) c\n  where c.bc1 is null;\n  \ndrop table j1;\ncreate table j1 as select c1 from \n( select 1 as c1 from default.dual\nunion all\nselect 2 as c1 from default.dual\nunion all\nselect 3 as c1 from default.dual\n) t1;\n\ndrop table j2;\ncreate table j2 as\nselect 1 as c1 from default.dual;\n{code}\n\n{code:title=case2 result}\nmr :\n+--------+--------+--+\n| c.ac1  | c.bc1  |\n+--------+--------+--+\n| 2      | NULL   |\n| 3      | NULL   |\n+--------+--------+--+\ntez :\n+--------+--------+--+\n| c.ac1  | c.bc1  |\n+--------+--------+--+\n| 2      | NULL   |\n| 3      | NULL   |\n+--------+--------+--+\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Hive on tez produce wrong results when withClause and (outer) joins","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=goodjins","name":"goodjins","key":"goodjins","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"JinsuKim","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=goodjins","name":"goodjins","key":"goodjins","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"JinsuKim","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12962884/comment/15799003","id":"15799003","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cpiliotis","name":"cpiliotis","key":"cpiliotis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Costas Piliotis","active":true,"timeZone":"Etc/UTC"},"body":"Hi, I've just seen this issue too on tez 0.7.0.  \n\nQuery works fine on mr engine and fine in presto but tez is producing incorrect results.   I'm using a CTE\n\n{code:sql}\nselect  tableaCTE.intCol1, tableaCTE.strCol2\nfrom (\n  select distinct intCol1, strCol2\n  from tablea ) tableaCTE\n    left outer join tableb on (\n             tableaCTE.strCol2=tableb.strCol2 AND\n            tableaCTE.intCol1=tableb.intCol1\n           )\nwhere tableb.intCol1 IS NULL\n{code}\n\nI've tried rewriting the query to use a WITH clause for the CTE and it made no difference.\n\n*however* if I save my data to a temp table first, the query does return correct results, so I'd be inclined to think that this is a runtime interpretation of the CTE being handled incorrectly.\n\nWhen I set the execution engine to mapreduce, it works fine and returns expected results, and this same query returns expected results in presto as well.    It appears to be a tez related issue.\n\nI know this is marked as trivial, but I'll argue that if hiveQL is returning incorrect results on this pattern it shouldn't be interpreted as trivial.\n\nBelow is my actual explain plan for my real query:\n{code}\nExplain\nPlan not optimized by CBO.\n\nVertex dependency in root stage\nReducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (CUSTOM_SIMPLE_EDGE)\nReducer 3 <- Reducer 2 (SIMPLE_EDGE)\n\nStage-0\n   Fetch Operator\n      limit:-1\n      Stage-1\n         Reducer 3\n         File Output Operator [FS_28]\n            compressed:true\n            Statistics:Num rows: 5032426 Data size: 523372372 Basic stats: COMPLETE Column stats: NONE\n            table:{\"serde:\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"input format:\":\"org.apache.hadoop.mapred.TextInputFormat\",\"output format:\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\"}\n            Select Operator [OP_27]\n            |  outputColumnNames:[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\"]\n            |  Statistics:Num rows: 5032426 Data size: 523372372 Basic stats: COMPLETE Column stats: NONE\n            |<-Reducer 2 [SIMPLE_EDGE]\n               Reduce Output Operator [RS_26]\n                  key expressions:_col0 (type: int), _col1 (type: string)\n                  sort order:++\n                  Statistics:Num rows: 5032426 Data size: 523372372 Basic stats: COMPLETE Column stats: NONE\n                  value expressions:_col2 (type: int), _col3 (type: string), _col4 (type: boolean)\n                  Select Operator [OP_25]\n                     outputColumnNames:[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\"]\n                     Statistics:Num rows: 5032426 Data size: 523372372 Basic stats: COMPLETE Column stats: NONE\n                     Filter Operator [FIL_24]\n                        predicate:_col4 is null (type: boolean)\n                        Statistics:Num rows: 5032426 Data size: 523372372 Basic stats: COMPLETE Column stats: NONE\n                        Map Join Operator [MAPJOIN_23]\n                        |  condition map:[{\"\":\"Left Outer Join0 to 1\"}]\n                        |  keys:{\"Reducer 2\":\"_col0 (type: int), _col1 (type: string)\",\"Map 4\":\"dim_language_id (type: int), localized_level_name (type: string)\"}\n                        |  outputColumnNames:[\"_col0\",\"_col1\",\"_col4\",\"_col5\",\"_col6\"]\n                        |  Statistics:Num rows: 10064852 Data size: 1046744745 Basic stats: COMPLETE Column stats: NONE\n                        |<-Map 4 [CUSTOM_SIMPLE_EDGE]\n                        |  Reduce Output Operator [RS_20]\n                        |     key expressions:dim_language_id (type: int), localized_level_name (type: string)\n                        |     Map-reduce partition columns:dim_language_id (type: int), localized_level_name (type: string)\n                        |     sort order:++\n                        |     Statistics:Num rows: 7741 Data size: 1068258 Basic stats: COMPLETE Column stats: NONE\n                        |     value expressions:dim_level_nl_id (type: int)\n                        |     TableScan [TS_6]\n                        |        alias:da\n                        |        Statistics:Num rows: 7741 Data size: 1068258 Basic stats: COMPLETE Column stats: NONE\n                        |<-Select Operator [OP_22]\n                              outputColumnNames:[\"_col0\",\"_col1\"]\n                              Statistics:Num rows: 9149866 Data size: 951586112 Basic stats: COMPLETE Column stats: NONE\n                              Group By Operator [OP_21]\n                              |  keys:KEY._col0 (type: int), KEY._col1 (type: string), KEY._col2 (type: int)\n                              |  outputColumnNames:[\"_col0\",\"_col1\",\"_col2\"]\n                              |  Statistics:Num rows: 9149866 Data size: 951586112 Basic stats: COMPLETE Column stats: NONE\n                              |<-Map 1 [SIMPLE_EDGE]\n                                 Reduce Output Operator [RS_3]\n                                    key expressions:_col0 (type: int), _col1 (type: string), _col2 (type: int)\n                                    Map-reduce partition columns:_col0 (type: int), _col1 (type: string), _col2 (type: int)\n                                    sort order:+++\n                                    Statistics:Num rows: 18299732 Data size: 1903172224 Basic stats: COMPLETE Column stats: NONE\n                                    Group By Operator [GBY_2]\n                                       keys:dim_language_id (type: int), level (type: string), 1 (type: int)\n                                       outputColumnNames:[\"_col0\",\"_col1\",\"_col2\"]\n                                       Statistics:Num rows: 18299732 Data size: 1903172224 Basic stats: COMPLETE Column stats: NONE\n                                       Select Operator [SEL_1]\n                                          outputColumnNames:[\"dim_language_id\",\"level\"]\n                                          Statistics:Num rows: 18299732 Data size: 1903172224 Basic stats: COMPLETE Column stats: NONE\n                                          TableScan [TS_0]\n                                             alias:trapteam_fact_event_timeline\n                                             Statistics:Num rows: 18299732 Data size: 1903172224 Basic stats: COMPLETE Column stats: NONE\n{code}\n\nI suspect this issue is related to HIVE-14027 as well","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cpiliotis","name":"cpiliotis","key":"cpiliotis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Costas Piliotis","active":true,"timeZone":"Etc/UTC"},"created":"2017-01-04T18:37:54.526+0000","updated":"2017-01-04T19:03:50.876+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12962884/comment/15943474","id":"15943474","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=osayankin","name":"osayankin","key":"osayankin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=osayankin&avatarId=34533","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=osayankin&avatarId=34533","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=osayankin&avatarId=34533","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=osayankin&avatarId=34533"},"displayName":"Oleksiy Sayankin","active":true,"timeZone":"Etc/UTC"},"body":"I have no issue with Hive-2.1.1 and Tez-0.8.4\n\n{code}\nwith a as (\nselect 1 as c1\nunion all\nselect 2 as c1\nunion all\nselect 3 as c1\n),\nb as (\nselect 1 as c1\n)\nselect * \n  from ( select a.c1 as ac1, b.c1 as bc1 \n         from a left outer join b \n         on a.c1 = b.c1 \n       ) c\n  where c.bc1 is null;\n{code}\n\nResults is on TEZ\n\n{code}\nStatus: Running (Executing on YARN cluster with App id application_1490371429102_0009)\n\n----------------------------------------------------------------------------------------------\n        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  \n----------------------------------------------------------------------------------------------\nMap 1 .......... container     SUCCEEDED      1          1        0        0       0       0  \nMap 3 .......... container     SUCCEEDED      1          1        0        0       0       0  \nMap 4 .......... container     SUCCEEDED      1          1        0        0       0       0  \nMap 5 .......... container     SUCCEEDED      1          1        0        0       0       0  \n----------------------------------------------------------------------------------------------\nVERTICES: 04/04  [==========================>>] 100%  ELAPSED TIME: 11.23 s    \n----------------------------------------------------------------------------------------------\n\nOK\n2017-03-27 18:28:33,715 INFO  [c7d93c00-eb42-4731-bccb-a8fd56995bd9 main] mapred.FileInputFormat: Total input paths to process : 2\n3\tNULL\n2\tNULL\nTime taken: 18.484 seconds, Fetched: 2 row(s)\n{code}\n\nQuery plan on Hive-2.1.1 on Tez-0.8.4\n\n{code}\n    > explain with a as (\n    > select 1 as c1\n    > union all\n    > select 2 as c1\n    > union all\n    > select 3 as c1\n    > ),\n    > b as (\n    > select 1 as c1\n    > )\n    > select * \n    >   from ( select a.c1 as ac1, b.c1 as bc1 \n    >          from a left outer join b \n    >          on a.c1 = b.c1 \n    >        ) c\n    >   where c.bc1 is null;\nOK\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-0 depends on stages: Stage-1\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Tez\n      DagId: mapr_20170327182950_39a484d6-3b9b-4021-a262-ba2d8722cf35:4\n      Edges:\n        Map 1 <- Map 5 (BROADCAST_EDGE), Union 2 (CONTAINS)\n        Map 3 <- Map 5 (BROADCAST_EDGE), Union 2 (CONTAINS)\n        Map 4 <- Map 5 (BROADCAST_EDGE), Union 2 (CONTAINS)\n      DagName: \n      Vertices:\n        Map 1 \n            Map Operator Tree:\n                TableScan\n                  alias: _dummy_table\n                  Row Limit Per Split: 1\n                  Statistics: Num rows: 1 Data size: 1 Basic stats: COMPLETE Column stats: COMPLETE\n                  Select Operator\n                    expressions: 1 (type: int)\n                    outputColumnNames: _col0\n                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                    Map Join Operator\n                      condition map:\n                           Left Outer Join0 to 1\n                      keys:\n                        0 _col0 (type: int)\n                        1 1 (type: int)\n                      outputColumnNames: _col0, _col1\n                      input vertices:\n                        1 Map 5\n                      Statistics: Num rows: 3 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE\n                      HybridGraceHashJoin: true\n                      Filter Operator\n                        predicate: _col1 is null (type: boolean)\n                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                        Select Operator\n                          expressions: _col0 (type: int), null (type: int)\n                          outputColumnNames: _col0, _col1\n                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                          File Output Operator\n                            compressed: false\n                            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                            table:\n                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n        Map 3 \n            Map Operator Tree:\n                TableScan\n                  alias: _dummy_table\n                  Row Limit Per Split: 1\n                  Statistics: Num rows: 1 Data size: 1 Basic stats: COMPLETE Column stats: COMPLETE\n                  Select Operator\n                    expressions: 2 (type: int)\n                    outputColumnNames: _col0\n                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                    Map Join Operator\n                      condition map:\n                           Left Outer Join0 to 1\n                      keys:\n                        0 _col0 (type: int)\n                        1 1 (type: int)\n                      outputColumnNames: _col0, _col1\n                      input vertices:\n                        1 Map 5\n                      Statistics: Num rows: 3 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE\n                      HybridGraceHashJoin: true\n                      Filter Operator\n                        predicate: _col1 is null (type: boolean)\n                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                        Select Operator\n                          expressions: _col0 (type: int), null (type: int)\n                          outputColumnNames: _col0, _col1\n                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                          File Output Operator\n                            compressed: false\n                            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                            table:\n                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n        Map 4 \n            Map Operator Tree:\n                TableScan\n                  alias: _dummy_table\n                  Row Limit Per Split: 1\n                  Statistics: Num rows: 1 Data size: 1 Basic stats: COMPLETE Column stats: COMPLETE\n                  Select Operator\n                    expressions: 3 (type: int)\n                    outputColumnNames: _col0\n                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                    Map Join Operator\n                      condition map:\n                           Left Outer Join0 to 1\n                      keys:\n                        0 _col0 (type: int)\n                        1 1 (type: int)\n                      outputColumnNames: _col0, _col1\n                      input vertices:\n                        1 Map 5\n                      Statistics: Num rows: 3 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE\n                      HybridGraceHashJoin: true\n                      Filter Operator\n                        predicate: _col1 is null (type: boolean)\n                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                        Select Operator\n                          expressions: _col0 (type: int), null (type: int)\n                          outputColumnNames: _col0, _col1\n                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                          File Output Operator\n                            compressed: false\n                            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                            table:\n                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n        Map 5 \n            Map Operator Tree:\n                TableScan\n                  alias: _dummy_table\n                  Row Limit Per Split: 1\n                  Statistics: Num rows: 1 Data size: 1 Basic stats: COMPLETE Column stats: COMPLETE\n                  Select Operator\n                    expressions: 1 (type: int)\n                    outputColumnNames: _col0\n                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                    Reduce Output Operator\n                      key expressions: 1 (type: int)\n                      sort order: +\n                      Map-reduce partition columns: 1 (type: int)\n                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                      value expressions: _col0 (type: int)\n                    Reduce Output Operator\n                      key expressions: 1 (type: int)\n                      sort order: +\n                      Map-reduce partition columns: 1 (type: int)\n                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                      value expressions: _col0 (type: int)\n                    Reduce Output Operator\n                      key expressions: 1 (type: int)\n                      sort order: +\n                      Map-reduce partition columns: 1 (type: int)\n                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE\n                      value expressions: _col0 (type: int)\n        Union 2 \n            Vertex: Union 2\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n      Processor Tree:\n        ListSink\n\nTime taken: 0.223 seconds, Fetched: 156 row(s)\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=osayankin","name":"osayankin","key":"osayankin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=osayankin&avatarId=34533","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=osayankin&avatarId=34533","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=osayankin&avatarId=34533","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=osayankin&avatarId=34533"},"displayName":"Oleksiy Sayankin","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-27T15:33:00.072+0000","updated":"2017-03-27T15:33:00.072+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12962884/comment/15943480","id":"15943480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"body":"This bug might be a dup of HIVE-14027","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-03-27T15:36:17.899+0000","updated":"2017-03-27T15:36:17.899+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13623/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2wstj:"}}