{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13128180","self":"https://issues.apache.org/jira/rest/api/2/issue/13128180","key":"HIVE-18362","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-01-03T09:58:19.284+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jan 03 15:27:17 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-18362/watchers","watchCount":3,"isWatching":false},"created":"2018-01-03T08:41:45.342+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-01-03T15:27:17.748+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":null,"description":"The compression ratio of the Orc compressed file will be very high in some cases.\r\n\r\nThe test table has three Int columns, with twelve million records, but the compressed file size is only 4M. Hive will automatically converts the Join to Map join, but this will cause memory overflow. So I think it is better to have a parameter to limit to the total number of table records in the Map Join convertion, and if the total number of records is larger than that, it can not be converted to Map join.\r\n\r\n*hive.auto.convert.join.max.number = 2500000L*\r\n\r\nThe default value for this parameter is 2500000, because so many records occupy about 700M memory in clint JVM, and 2500000 records for Map Join are also large tables.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12904365","id":"12904365","filename":"HIVE-18362-branch-1.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wankunde","name":"wankunde","key":"wankunde","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"wan kun","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-01-03T09:51:57.326+0000","size":5653,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12904365/HIVE-18362-branch-1.2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Introduce a parameter to control the max row number for map join convertion","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wankunde","name":"wankunde","key":"wankunde","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"wan kun","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wankunde","name":"wankunde","key":"wankunde","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"wan kun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":"2018-01-05","customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13128180/comment/16309392","id":"16309392","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"body":"Is this a dup for {{hive.auto.convert.join.hashtable.max.entries}} setting?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-01-03T09:58:19.284+0000","updated":"2018-01-03T09:58:19.284+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13128180/comment/16309740","id":"16309740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12904365/HIVE-18362-branch-1.2.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 155 failed/errored test(s), 7897 tests executed\n*Failed tests:*\n{noformat}\nTestAdminUser - did not produce a TEST-*.xml file (likely timed out) (batchId=339)\nTestAuthorizationPreEventListener - did not produce a TEST-*.xml file (likely timed out) (batchId=370)\nTestAuthzApiEmbedAuthorizerInEmbed - did not produce a TEST-*.xml file (likely timed out) (batchId=349)\nTestAuthzApiEmbedAuthorizerInRemote - did not produce a TEST-*.xml file (likely timed out) (batchId=355)\nTestBeeLineWithArgs - did not produce a TEST-*.xml file (likely timed out) (batchId=377)\nTestCLIAuthzSessionContext - did not produce a TEST-*.xml file (likely timed out) (batchId=393)\nTestClientSideAuthorizationProvider - did not produce a TEST-*.xml file (likely timed out) (batchId=369)\nTestCompactor - did not produce a TEST-*.xml file (likely timed out) (batchId=359)\nTestCreateUdfEntities - did not produce a TEST-*.xml file (likely timed out) (batchId=358)\nTestCustomAuthentication - did not produce a TEST-*.xml file (likely timed out) (batchId=378)\nTestDBTokenStore - did not produce a TEST-*.xml file (likely timed out) (batchId=324)\nTestDDLWithRemoteMetastoreSecondNamenode - did not produce a TEST-*.xml file (likely timed out) (batchId=357)\nTestDynamicSerDe - did not produce a TEST-*.xml file (likely timed out) (batchId=327)\nTestEmbeddedHiveMetaStore - did not produce a TEST-*.xml file (likely timed out) (batchId=336)\nTestEmbeddedThriftBinaryCLIService - did not produce a TEST-*.xml file (likely timed out) (batchId=381)\nTestFilterHooks - did not produce a TEST-*.xml file (likely timed out) (batchId=331)\nTestFolderPermissions - did not produce a TEST-*.xml file (likely timed out) (batchId=364)\nTestHS2AuthzContext - did not produce a TEST-*.xml file (likely timed out) (batchId=396)\nTestHS2AuthzSessionContext - did not produce a TEST-*.xml file (likely timed out) (batchId=397)\nTestHS2ImpersonationWithRemoteMS - did not produce a TEST-*.xml file (likely timed out) (batchId=385)\nTestHiveAuthorizerCheckInvocation - did not produce a TEST-*.xml file (likely timed out) (batchId=373)\nTestHiveAuthorizerShowFilters - did not produce a TEST-*.xml file (likely timed out) (batchId=372)\nTestHiveHistory - did not produce a TEST-*.xml file (likely timed out) (batchId=375)\nTestHiveMetaStoreTxns - did not produce a TEST-*.xml file (likely timed out) (batchId=351)\nTestHiveMetaStoreWithEnvironmentContext - did not produce a TEST-*.xml file (likely timed out) (batchId=341)\nTestHiveMetaTool - did not produce a TEST-*.xml file (likely timed out) (batchId=354)\nTestHiveServer2 - did not produce a TEST-*.xml file (likely timed out) (batchId=399)\nTestHiveServer2SessionTimeout - did not produce a TEST-*.xml file (likely timed out) (batchId=400)\nTestHiveSessionImpl - did not produce a TEST-*.xml file (likely timed out) (batchId=382)\nTestHs2Hooks - did not produce a TEST-*.xml file (likely timed out) (batchId=356)\nTestHs2HooksWithMiniKdc - did not produce a TEST-*.xml file (likely timed out) (batchId=428)\nTestJdbcDriver2 - did not produce a TEST-*.xml file (likely timed out) (batchId=387)\nTestJdbcMetadataApiAuth - did not produce a TEST-*.xml file (likely timed out) (batchId=398)\nTestJdbcWithLocalClusterSpark - did not produce a TEST-*.xml file (likely timed out) (batchId=392)\nTestJdbcWithMiniHS2 - did not produce a TEST-*.xml file (likely timed out) (batchId=389)\nTestJdbcWithMiniKdc - did not produce a TEST-*.xml file (likely timed out) (batchId=425)\nTestJdbcWithMiniKdcCookie - did not produce a TEST-*.xml file (likely timed out) (batchId=424)\nTestJdbcWithMiniKdcSQLAuthBinary - did not produce a TEST-*.xml file (likely timed out) (batchId=422)\nTestJdbcWithMiniKdcSQLAuthHttp - did not produce a TEST-*.xml file (likely timed out) (batchId=427)\nTestJdbcWithMiniMr - did not produce a TEST-*.xml file (likely timed out) (batchId=388)\nTestJdbcWithSQLAuthUDFBlacklist - did not produce a TEST-*.xml file (likely timed out) (batchId=394)\nTestJdbcWithSQLAuthorization - did not produce a TEST-*.xml file (likely timed out) (batchId=395)\nTestLocationQueries - did not produce a TEST-*.xml file (likely timed out) (batchId=362)\nTestMTQueries - did not produce a TEST-*.xml file (likely timed out) (batchId=360)\nTestMarkPartition - did not produce a TEST-*.xml file (likely timed out) (batchId=348)\nTestMarkPartitionRemote - did not produce a TEST-*.xml file (likely timed out) (batchId=352)\nTestMetaStoreAuthorization - did not produce a TEST-*.xml file (likely timed out) (batchId=337)\nTestMetaStoreConnectionUrlHook - did not produce a TEST-*.xml file (likely timed out) (batchId=335)\nTestMetaStoreEndFunctionListener - did not produce a TEST-*.xml file (likely timed out) (batchId=334)\nTestMetaStoreEventListener - did not produce a TEST-*.xml file (likely timed out) (batchId=344)\nTestMetaStoreEventListenerOnlyOnCommit - did not produce a TEST-*.xml file (likely timed out) (batchId=347)\nTestMetaStoreInitListener - did not produce a TEST-*.xml file (likely timed out) (batchId=350)\nTestMetaStoreListenersError - did not produce a TEST-*.xml file (likely timed out) (batchId=346)\nTestMetaStoreUtils - did not produce a TEST-*.xml file (likely timed out) (batchId=328)\nTestMetastoreAuthorizationProvider - did not produce a TEST-*.xml file (likely timed out) (batchId=366)\nTestMetastoreVersion - did not produce a TEST-*.xml file (likely timed out) (batchId=343)\nTestMiniHS2 - did not produce a TEST-*.xml file (likely timed out) (batchId=401)\nTestMiniSparkOnYarnCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=429)\nTestMultiAuthorizationPreEventListener - did not produce a TEST-*.xml file (likely timed out) (batchId=367)\nTestMultiSessionsHS2WithLocalClusterSpark - did not produce a TEST-*.xml file (likely timed out) (batchId=391)\nTestNoSaslAuth - did not produce a TEST-*.xml file (likely timed out) (batchId=390)\nTestOperationLoggingAPIWithMr - did not produce a TEST-*.xml file (likely timed out) (batchId=383)\nTestOperationLoggingAPIWithTez - did not produce a TEST-*.xml file (likely timed out) (batchId=384)\nTestPartitionNameWhitelistValidation - did not produce a TEST-*.xml file (likely timed out) (batchId=332)\nTestPasswordWithConfig - did not produce a TEST-*.xml file (likely timed out) (batchId=368)\nTestRemoteHiveMetaStore - did not produce a TEST-*.xml file (likely timed out) (batchId=340)\nTestRemoteHiveMetaStoreIpAddress - did not produce a TEST-*.xml file (likely timed out) (batchId=329)\nTestRemoteUGIHiveMetaStoreIpAddress - did not produce a TEST-*.xml file (likely timed out) (batchId=345)\nTestRetryingHMSHandler - did not produce a TEST-*.xml file (likely timed out) (batchId=338)\nTestSSL - did not produce a TEST-*.xml file (likely timed out) (batchId=386)\nTestSchemaTool - did not produce a TEST-*.xml file (likely timed out) (batchId=376)\nTestSemanticAnalyzerHookLoading - did not produce a TEST-*.xml file (likely timed out) (batchId=361)\nTestSerdeWithFieldComments - did not produce a TEST-*.xml file (likely timed out) (batchId=326)\nTestServerSpecificConfig - did not produce a TEST-*.xml file (likely timed out) (batchId=342)\nTestSetUGIOnBothClientServer - did not produce a TEST-*.xml file (likely timed out) (batchId=333)\nTestSetUGIOnOnlyClient - did not produce a TEST-*.xml file (likely timed out) (batchId=330)\nTestSetUGIOnOnlyServer - did not produce a TEST-*.xml file (likely timed out) (batchId=353)\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=177)\n\t[bucketmapjoin4.q,bucket_map_join_spark2.q,bucket_map_join_spark4.q,union21.q,timestamp_2.q,date_join1.q,mergejoins.q,smb_mapjoin_11.q,auto_sortmerge_join_3.q,mapjoin_test_outer.q,vectorization_9.q,merge2.q,auto_join_without_localtask.q,bucketmapjoin2.q,multi_join_union.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=178)\n\t[parallel_join1.q,join_cond_pushdown_unqual4.q,union_remove_7.q,join13.q,join_vc.q,groupby_cube1.q,join_reorder4.q,sample3.q,smb_mapjoin_19.q,stats16.q,union23.q,union.q,union31.q,cbo_udf_udaf.q,ptf_decimal.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=179)\n\t[union27.q,mapjoin_subquery2.q,union12.q,groupby7_map_multi_single_reducer.q,varchar_join1.q,join7.q,mapjoin1.q,skewjoinopt2.q,bucketsortoptimize_insert_2.q,smb_mapjoin_17.q,script_env_var1.q,groupby7_map.q,groupby3.q,bucketsortoptimize_insert_8.q,union20.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=180)\n\t[ptf_general_queries.q,auto_join_reordering_values.q,sample2.q,join1.q,decimal_join.q,join32_lessSize.q,order2.q,skewjoinopt18.q,union_remove_18.q,join25.q,union_remove_4.q,smb_mapjoin_25.q,groupby9.q,bucketsortoptimize_insert_6.q,ctas.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=181)\n\t[skewjoinopt15.q,list_bucket_dml_2.q,groupby_map_ppr.q,join_rc.q,union14.q,load_dyn_part3.q,smb_mapjoin_12.q,vector_cast_constant.q,auto_sortmerge_join_15.q,union10.q,auto_join11.q,load_dyn_part7.q,vectorization_12.q,groupby_sort_skew_1_23.q,skewjoinopt12.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=182)\n\t[auto_join18.q,input1_limit.q,auto_join26.q,union_remove_14.q,auto_sortmerge_join_14.q,stats_counter_partitioned.q,union22.q,bucket_map_join_tez2.q,smb_mapjoin_22.q,join_reorder.q,stats15.q,transform_ppr1.q,sample1.q,bucketmapjoin8.q,union34.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=183)\n\t[avro_joins.q,skewjoinopt16.q,bucket3.q,skewjoinopt13.q,auto_join14.q,vectorization_14.q,stats1.q,cbo_stats.q,auto_sortmerge_join_6.q,auto_join15.q,union_remove_24.q,union_view.q,join22.q,join33.q,ptf_matchpath.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=184)\n\t[vector_decimal_aggregate.q,skewjoin_noskew.q,leftsemijoin_mr.q,auto_join23.q,bucketmapjoin9.q,input18.q,cbo_simple_select.q,ptf.q,vectorized_nested_mapjoin.q,sample4.q,union18.q,multi_insert_gby.q,groupby1.q,join_reorder2.q,join_cond_pushdown_unqual2.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=185)\n\t[order.q,ppd_join3.q,join10.q,union_remove_11.q,vectorized_math_funcs.q,union_ppr.q,skewjoinopt6.q,union_remove_19.q,join14.q,join32.q,groupby_multi_single_reducer2.q,stats3.q,parquet_join.q,outer_join_ppr.q,join26.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=186)\n\t[skewjoinopt3.q,skewjoinopt19.q,timestamp_comparison.q,join_merge_multi_expressions.q,skewjoinopt10.q,union5.q,insert_into1.q,vectorization_4.q,stats_counter.q,vectorization_2.q,vector_left_outer_join.q,semijoin.q,skewjoinopt9.q,rcfile_bigdata.q,load_dyn_part10.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=187)\n\t[multi_insert_mixed.q,smb_mapjoin_4.q,join_cond_pushdown_3.q,insert1.q,union_remove_10.q,mapreduce2.q,bucketmapjoin_negative.q,udf_in_file.q,skewjoinopt5.q,auto_join12.q,skewjoin.q,vectorization_part_project.q,vector_count_distinct.q,smb_mapjoin_3.q,stats10.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=188)\n\t[bucketsortoptimize_insert_4.q,skewjoinopt8.q,vectorization_10.q,auto_join18_multi_distinct.q,custom_input_output_format.q,insert_into3.q,vectorization_6.q,skewjoinopt4.q,count.q,stats9.q,auto_join7.q,parallel.q,timestamp_1.q,union33.q,union_lateralview.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=189)\n\t[skewjoin_union_remove_2.q,avro_decimal_native.q,timestamp_null.q,bucketmapjoin_negative3.q,union32.q,groupby_ppr.q,smb_mapjoin_18.q,vector_varchar_4.q,stats6.q,stats_only_null.q,join18_multi_distinct.q,cross_join.q,sample8.q,join24.q,join_star.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=190)\n\t[auto_join30.q,union_remove_1.q,ppd_outer_join2.q,date_udf.q,join16.q,smb_mapjoin_13.q,bucketmapjoin7.q,join19.q,smb_mapjoin_6.q,metadata_only_queries.q,union6.q,cbo_subq_in.q,vectorization_part.q,groupby3_map_multi_distinct.q,vectorized_timestamp_funcs.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=191)\n\t[bucketmapjoin12.q,auto_join10.q,ptf_rcfile.q,join20.q,vector_elt.q,multi_insert.q,groupby_rollup1.q,ppd_join5.q,join_filters_overlap.q,vector_string_concat.q,join_empty.q,auto_sortmerge_join_12.q,load_dyn_part6.q,groupby_bigdata.q,innerjoin.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=192)\n\t[tez_joins_explain.q,input17.q,ppd_gby_join.q,vectorized_rcfile_columnar.q,ppd_join.q,join_cond_pushdown_1.q,union_remove_6_subq.q,timestamp_3.q,load_dyn_part9.q,multi_insert_gby2.q,vectorization_11.q,groupby_position.q,avro_compression_enabled_native.q,stats_noscan_2.q,transform1.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=193)\n\t[smb_mapjoin_21.q,load_dyn_part15.q,transform2.q,mapjoin_memcheck.q,subquery_exists.q,cbo_semijoin.q,bucketmapjoin13.q,join27.q,alter_merge_stats_orc.q,union_remove_2.q,join12.q,smb_mapjoin_8.q,join21.q,auto_join16.q,union9.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=194)\n\t[vectorization_16.q,enforce_order.q,join_casesensitive.q,join23.q,ppd_join2.q,ppd_outer_join5.q,create_merge_compressed.q,louter_join_ppr.q,sample9.q,smb_mapjoin_16.q,vectorization_not.q,having.q,ppd_outer_join1.q,vector_orderby_5.q,union_remove_12.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=195)\n\t[bucketmapjoin3.q,load_dyn_part5.q,transform_ppr2.q,groupby7_map_skew.q,cbo_gby.q,auto_join31.q,auto_sortmerge_join_1.q,join_cond_pushdown_unqual1.q,bucket_map_join_spark3.q,union28.q,statsfs.q,escape_sortby1.q,leftsemijoin.q,union_remove_6.q,join29.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=196)\n\t[escape_distributeby1.q,join9.q,groupby2.q,vectorization_pushdown.q,union_date.q,cbo_gby_empty.q,join_cond_pushdown_unqual3.q,join8.q,sample10.q,ppd_outer_join3.q,cross_product_check_1.q,auto_sortmerge_join_2.q,auto_join_stats.q,input_part2.q,groupby_multi_single_reducer3.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=197)\n\t[groupby_map_ppr_multi_distinct.q,vectorization_13.q,mapjoin_mapjoin.q,union2.q,join41.q,groupby8_map.q,cbo_subq_not_in.q,vectorization_short_regress.q,identity_project_remove_skip.q,stats5.q,groupby8_map_skew.q,mapjoin_subquery.q,bucket2.q,smb_mapjoin_1.q,union_remove_8.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=198)\n\t[join39.q,bucketsortoptimize_insert_7.q,vector_distinct_2.q,bucketmapjoin10.q,join11.q,auto_sortmerge_join_16.q,windowing.q,join40.q,union_remove_3.q,skewjoinopt7.q,stats7.q,annotate_stats_join.q,multi_insert_lateral_view.q,ptf_streaming.q,join_1to1.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=199)\n\t[timestamp_lazy.q,ppd_join4.q,union29.q,runtime_skewjoin_mapjoin_spark.q,auto_join22.q,union8.q,union13.q,stats0.q,auto_join29.q,merge1.q,mapjoin_distinct.q,vector_decimal_mapjoin.q,sample5.q,multi_insert_move_tasks_share_dependencies.q,join_array.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=200)\n\t[load_dyn_part2.q,smb_mapjoin_7.q,vectorization_5.q,smb_mapjoin_2.q,ppd_join_filter.q,column_access_stats.q,vector_between_in.q,vectorized_string_funcs.q,vectorization_1.q,bucket_map_join_2.q,auto_join_filters.q,temp_table_join1.q,join0.q,vectorized_case.q,stats_noscan_1.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=201)\n\t[groupby4.q,stats2.q,groupby3_map_skew.q,mapjoin_filter_on_outerjoin.q,join_cond_pushdown_2.q,union19.q,union24.q,union_remove_5.q,groupby7_noskew_multi_single_reducer.q,groupby_multi_single_reducer.q,index_auto_self_join.q,auto_smb_mapjoin_14.q,script_env_var2.q,pcr.q,join37.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=202)\n\t[stats12.q,union_top_level.q,groupby10.q,subquery_in.q,stats14.q,auto_sortmerge_join_4.q,limit_partition_metadataonly.q,load_dyn_part4.q,union3.q,smb_mapjoin_14.q,vectorized_ptf.q,auto_join2.q,groupby3_noskew_multi_distinct.q,stats18.q,union_remove_21.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=203)\n\t[auto_sortmerge_join_13.q,join4.q,join35.q,union26.q,join_reorder3.q,auto_join19.q,sample7.q,vectorization_15.q,union7.q,vectorization_nested_udf.q,ppd_outer_join4.q,load_dyn_part8.q,vector_groupby_3.q,alter_merge_orc.q,bucket_map_join_1.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=204)\n\t[groupby_complex_types.q,groupby3_map.q,union11.q,groupby7.q,mapreduce1.q,mapjoin_addjar.q,bucketmapjoin_negative2.q,bucket_map_join_spark1.q,udf_example_add.q,vectorization_div0.q,union_remove_17.q,auto_join_nulls.q,metadata_only_queries_with_filters.q,sample6.q,auto_sortmerge_join_9.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=205)\n\t[multigroupby_singlemr.q,bucketmapjoin11.q,auto_join4.q,mapjoin_decimal.q,join34.q,join5.q,sort.q,auto_join28.q,join17.q,union_script.q,add_part_multiple.q,limit_pushdown.q,uniquejoin.q,union25.q,load_dyn_part13.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=206)\n\t[table_access_keys_stats.q,union_remove_9.q,mergejoins_mixed.q,join_nullsafe.q,stats8.q,skewjoinopt14.q,vectorized_mapjoin.q,union17.q,auto_join5.q,vectorized_shufflejoin.q,groupby8_noskew.q,auto_sortmerge_join_10.q,groupby11.q,skewjoinopt11.q,load_dyn_part11.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=207)\n\t[script_pipe.q,auto_join24.q,ptf_seqfile.q,union_remove_23.q,filter_join_breaktask.q,parallel_join0.q,ppd_multi_insert.q,join_thrift.q,multi_insert_gby3.q,groupby8.q,union4.q,smb_mapjoin_20.q,groupby_multi_insert_common_distinct.q,join6.q,union_remove_16.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=208)\n\t[ppd_transform.q,smb_mapjoin_15.q,auto_join9.q,vector_data_types.q,input13.q,bucket4.q,skewjoinopt20.q,input12.q,vectorization_3.q,join_map_ppr.q,auto_sortmerge_join_8.q,cbo_union.q,escape_clusterby1.q,reduce_deduplicate_exclude_join.q,filter_join_breaktask2.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=209)\n\t[auto_join1.q,input14.q,union30.q,vector_mapjoin_reduce.q,stats20.q,union_remove_22.q,ptf_register_tblfn.q,union_date_trim.q,disable_merge_for_bucketing.q,join3.q,skewjoinopt1.q,join_alt_syntax.q,join30.q,groupby_sort_1_23.q,timestamp_udf.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=210)\n\t[stats13.q,router_join_ppr.q,join15.q,auto_join13.q,join_hive_626.q,tez_join_tests.q,auto_join21.q,join_view.q,join_merging.q,union_null.q,groupby3_noskew.q,optimize_nullscan.q,join38.q,auto_join3.q,vectorization_decimal_date.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=211)\n\t[load_dyn_part12.q,bucket_map_join_tez1.q,scriptfile1.q,groupby7_noskew.q,bucketmapjoin1.q,auto_join17.q,subquery_multiinsert.q,lateral_view_explode2.q,join28.q,join_cond_pushdown_4.q,vectorization_0.q,load_dyn_part1.q,skewjoinopt17.q,union_remove_20.q,bucketmapjoin5.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=212)\n\t[join36.q,join18.q,union_remove_15.q,smb_mapjoin_10.q,temp_table.q,union_remove_13.q,auto_join8.q,auto_join6.q,auto_sortmerge_join_5.q,auto_join0.q,auto_join_stats2.q,skewjoin_union_remove_1.q,union16.q,auto_join32.q,join_literals.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=213)\n\t[join2.q,avro_joins_native.q,auto_join20.q,smb_mapjoin_5.q,vector_char_4.q,cross_product_check_2.q,union_remove_25.q,insert_into2.q,join31.q,auto_join27.q,escape_orderby1.q,cbo_limit.q,stats_partscan_1_23.q,groupby_complex_types_multi_single_reducer.q,load_dyn_part14.q]\nTestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=214)\n\t[union15.q,auto_sortmerge_join_7.q]\nTestStorageBasedClientSideAuthorizationProvider - did not produce a TEST-*.xml file (likely timed out) (batchId=374)\nTestStorageBasedMetastoreAuthorizationDrops - did not produce a TEST-*.xml file (likely timed out) (batchId=365)\nTestStorageBasedMetastoreAuthorizationProvider - did not produce a TEST-*.xml file (likely timed out) (batchId=363)\nTestStorageBasedMetastoreAuthorizationReads - did not produce a TEST-*.xml file (likely timed out) (batchId=371)\nTestThriftBinaryCLIService - did not produce a TEST-*.xml file (likely timed out) (batchId=379)\nTestThriftHttpCLIService - did not produce a TEST-*.xml file (likely timed out) (batchId=380)\nTestZooKeeperTokenStore - did not produce a TEST-*.xml file (likely timed out) (batchId=325)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_ivyDownload (batchId=36)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join0 (batchId=84)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_11 (batchId=27)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12 (batchId=71)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_13 (batchId=37)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_2 (batchId=17)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_4 (batchId=22)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_5 (batchId=54)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_6 (batchId=46)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_8 (batchId=105)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_9 (batchId=120)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_outer_join_ppr (batchId=29)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_parallel_join0 (batchId=107)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_plan_json (batchId=95)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_selectDistinctStar (batchId=109)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket (batchId=98)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_str_to_map (batchId=91)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert (batchId=120)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_notin_having (batchId=71)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_from_utc_timestamp (batchId=120)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_to_utc_timestamp (batchId=33)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_bucket_map_join_tez1 (batchId=175)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_explainuser_1 (batchId=164)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_explainuser_2 (batchId=172)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_join0 (batchId=169)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_selectDistinctStar (batchId=173)\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_auto_smb_mapjoin_14 (batchId=163)\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_exchgpartition2lel (batchId=135)\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import (batchId=143)\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_columnstats_partlvl_invalid_values (batchId=143)\norg.apache.hive.minikdc.TestHiveAuthFactory.testStartTokenManagerForDBTokenStore (batchId=426)\norg.apache.hive.minikdc.TestHiveAuthFactory.testStartTokenManagerForMemoryTokenStore (batchId=426)\norg.apache.hive.minikdc.TestMiniHiveKdc.testLogin (batchId=423)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/8418/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/8418/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-8418/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 155 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12904365 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-01-03T14:49:10.435+0000","updated":"2018-01-03T14:49:10.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13128180/comment/16309791","id":"16309791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wankunde","name":"wankunde","key":"wankunde","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"wan kun","active":true,"timeZone":"Asia/Shanghai"},"body":"Hiï¼Œ[~gopalv]\r\nWhat we do is similar, but there is some difference in the implementation. My implementation is to take the table or partition's ROW_COUNT information directly from hive metastore, which does not need additional calculations.\r\n\r\nI also have a few questions to ask:\r\n\r\n1. Why do you use NDV instead of using ROW_COUNT directly ? I think NDV will be less than the actual number of ROW, but the actual memory is linearly related to the number of ROW.\r\n2., I'm sorry, I haven't had the test environment of hive 2.* for a while. Hive branch-2.* depends on ColStatistics's statistics. Can you tell me where does ColStatistics come from ? Is this nesessary to add extra calculation for additional column statistics before our job?\r\n3. The checkNumberOfEntriesForHashTable function only checks the number of Entry of one RS at a time. Does it happen that multiple map table is loaded into memory together, resulting in OOM?\r\n\r\nThere are also two following questions:\r\n1. ConvertJoinMapJoin optimization  is only used in TezCompiler ? Spark use SparkMapJoinOptimizer. There is no optimizer for MapReduce ?\r\n2. in hive branch-1.2 does not have this part of the code (but this parameter is added in hive-default.xml.template, which should not be effective)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wankunde","name":"wankunde","key":"wankunde","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"wan kun","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-01-03T15:27:17.748+0000","updated":"2018-01-03T15:27:17.748+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-18362/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3ogen:"}}