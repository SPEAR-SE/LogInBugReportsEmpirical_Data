{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13187455","self":"https://issues.apache.org/jira/rest/api/2/issue/13187455","key":"HIVE-20634","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Sep 27 23:13:16 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_176944777_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2018-09-27T23:13:16.018+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20634/watchers","watchCount":3,"isWatching":false},"created":"2018-09-25T22:04:11.283+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karthik.manamcheri","name":"karthik.manamcheri","key":"karthik.manamcheri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=karthik.manamcheri&avatarId=33724","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=karthik.manamcheri&avatarId=33724","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=karthik.manamcheri&avatarId=33724","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=karthik.manamcheri&avatarId=33724"},"displayName":"Karthik Manamcheri","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-09-27T23:13:16.057+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The code path for getting partitions by filter is as follows,\r\n{code:java}\r\n  protected List<Partition> getPartitionsByFilterInternal(..) {\r\n   ...\r\n      @Override\r\n      protected boolean canUseDirectSql(GetHelper<List<Partition>> ctx) throws MetaException \r\n     {\r\n        return directSql.generateSqlFilterForPushdown(ctx.getTable(), tree, filter);\r\n      }\r\n   ...\r\n  }\r\n{code}\r\nIf directSql.generateSqlFilterForPushdown throws an exception, we should be returning false from canUseDirectSql instead of propagating the exception. The propagation of exception causes the whole query to fail, instead of retrying with JDO.\r\n\r\nWe should have code such as\r\n{code:java}\r\n      @Override\r\n      protected boolean canUseDirectSql(GetHelper<Integer> ctx) throws MetaException {\r\n        try {\r\n          return directSql.generateSqlFilterForPushdown(ctx.getTable(), exprTree, filter);\r\n        } catch (final MetaException me) {\r\n          return false;\r\n        }\r\n      }\r\n{code}\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"DirectSQL does not retry in ORM mode while getting partitions by filter","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karthik.manamcheri","name":"karthik.manamcheri","key":"karthik.manamcheri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=karthik.manamcheri&avatarId=33724","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=karthik.manamcheri&avatarId=33724","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=karthik.manamcheri&avatarId=33724","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=karthik.manamcheri&avatarId=33724"},"displayName":"Karthik Manamcheri","active":true,"timeZone":"America/Chicago"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karthik.manamcheri","name":"karthik.manamcheri","key":"karthik.manamcheri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=karthik.manamcheri&avatarId=33724","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=karthik.manamcheri&avatarId=33724","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=karthik.manamcheri&avatarId=33724","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=karthik.manamcheri&avatarId=33724"},"displayName":"Karthik Manamcheri","active":true,"timeZone":"America/Chicago"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13187455/comment/16631171","id":"16631171","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karthik.manamcheri","name":"karthik.manamcheri","key":"karthik.manamcheri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=karthik.manamcheri&avatarId=33724","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=karthik.manamcheri&avatarId=33724","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=karthik.manamcheri&avatarId=33724","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=karthik.manamcheri&avatarId=33724"},"displayName":"Karthik Manamcheri","active":true,"timeZone":"America/Chicago"},"body":"I realized that this was not a bug. {{directSql.generateSqlFilterForPushdown(..)}} never calls SQL and only generates the filter. Closing as Not A Problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karthik.manamcheri","name":"karthik.manamcheri","key":"karthik.manamcheri","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=karthik.manamcheri&avatarId=33724","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=karthik.manamcheri&avatarId=33724","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=karthik.manamcheri&avatarId=33724","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=karthik.manamcheri&avatarId=33724"},"displayName":"Karthik Manamcheri","active":true,"timeZone":"America/Chicago"},"created":"2018-09-27T23:13:16.047+0000","updated":"2018-09-27T23:13:16.047+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20634/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3yhsn:"}}