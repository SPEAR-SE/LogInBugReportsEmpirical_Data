{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12754944","self":"https://issues.apache.org/jira/rest/api/2/issue/12754944","key":"HIVE-8850","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-11-13T11:11:06.015+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Dec 09 01:11:27 UTC 2014","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"10002_*:*_4_*:*_2239381012_*|*_1_*:*_4_*:*_5116638_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-12-09T01:11:27.569+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-8850/watchers","watchCount":5,"isWatching":false},"created":"2014-11-13T01:43:09.968+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12401855","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12401855","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12661631","key":"HIVE-4996","self":"https://issues.apache.org/jira/rest/api/2/issue/12661631","fields":{"summary":"unbalanced calls to openTransaction/commitTransaction","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12401856","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12401856","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12753835","key":"HIVE-8786","self":"https://issues.apache.org/jira/rest/api/2/issue/12753835","fields":{"summary":"ObjectStore.rollbackTransaction()  should decrement openTrasactionCalls and not set it to 0","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12401457","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12401457","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12755644","key":"HIVE-8891","self":"https://issues.apache.org/jira/rest/api/2/issue/12755644","fields":{"summary":"Another possible cause to NucleusObjectNotFoundException from drops/rollback","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-02-12T23:40:42.913+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312584","id":"12312584","name":"Metastore","description":"Tracks issue dealing with metastore."}],"timeoriginalestimate":null,"description":"We can run into issues as described below:\nHive script adds 2800 partitions to a table and during this it can get a SQLState 08S01 [Communication Link Error] and bonecp kill all the connections in the pool. The partitions are added and a create table statement executes (Metering_IngestedData_Compressed). The map job finishes successfully and while moving the table to the hive warehouse the ObjectStore.java commitTransaction() raises the error: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12681204","id":"12681204","filename":"HIVE-8850.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-13T01:48:29.361+0000","size":1213,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12681204/HIVE-8850.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12682750","id":"12682750","filename":"HIVE-8850.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-20T21:43:00.856+0000","size":4576,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12682750/HIVE-8850.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12682774","id":"12682774","filename":"HIVE-8850.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-20T23:20:19.693+0000","size":4701,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12682774/HIVE-8850.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12685484","id":"12685484","filename":"HIVE-8850.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-06T00:56:09.542+0000","size":2370,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12685484/HIVE-8850.4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ObjectStore:: rollbackTransaction() needs to be looked into further.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14209069","id":"14209069","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Stack Trace : \n\n2014-11-10 15:36:26,041 ERROR [main]: bonecp.ConnectionHandle (ConnectionHandle.java:markPossiblyBroken(388)) - Database access problem. Killing off this connection and all remaining connections in the connection pool. SQL State = 08S01\n2014-11-10 15:36:26,043 WARN [main]: metastore.ObjectStore (ObjectStore.java:getDatabase(504)) - JDODataStoreException using direct sql getting db: 6824349d_5e79_b4d7_aa8a_5e470e12bdd8. Falling back to ORM.\njavax.jdo.JDODataStoreException: Read timed out\nat org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:451)\nat org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:321)\nat org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getDatabase(MetaStoreDirectSql.java:197)\nat org.apache.hadoop.hive.metastore.ObjectStore.getDatabase(ObjectStore.java:500)\nat sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)\nat com.sun.proxy.$Proxy11.getDatabase(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_core(HiveMetaStore.java:1248)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_with_environment_context(HiveMetaStore.java:1332)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:105)\nat com.sun.proxy.$Proxy13.create_table_with_environment_context(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:558)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:547)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:89)\nat com.sun.proxy.$Proxy9.createTable(Unknown Source)\nat org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:613)\nat org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:4203)\nat org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:281)\nat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:153)\nat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:85)\nat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1508)\nat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1275)\nat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1093)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:916)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:906)\nat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:268)\nat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:220)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:423)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:359)\nat org.apache.hadoop.hive.cli.CliDriver.processReader(CliDriver.java:456)\nat org.apache.hadoop.hive.cli.CliDriver.processFile(CliDriver.java:466)\nat org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:749)\nat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:686)\nat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nNestedThrowablesStackTrace:\ncom.microsoft.sqlserver.jdbc.SQLServerException: Read timed out\nat com.microsoft.sqlserver.jdbc.SQLServerConnection.terminate(SQLServerConnection.java:1352)\nat com.microsoft.sqlserver.jdbc.SQLServerConnection.terminate(SQLServerConnection.java:1339)\nat com.microsoft.sqlserver.jdbc.TDSChannel.read(IOBuffer.java:1694)\nat com.microsoft.sqlserver.jdbc.TDSReader.readPacket(IOBuffer.java:3734)\nat com.microsoft.sqlserver.jdbc.TDSCommand.startResponse(IOBuffer.java:5066)\nat com.microsoft.sqlserver.jdbc.TDSCommand.startResponse(IOBuffer.java:5018)\nat com.microsoft.sqlserver.jdbc.SQLServerConnection$1ConnectionCommand.doExecute(SQLServerConnection.java:1441)\nat com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4615)\nat com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)\nat com.microsoft.sqlserver.jdbc.SQLServerConnection.connectionCommand(SQLServerConnection.java:1446)\nat com.microsoft.sqlserver.jdbc.SQLServerConnection.setAutoCommit(SQLServerConnection.java:1594)\nat com.jolbox.bonecp.ConnectionHandle.setAutoCommit(ConnectionHandle.java:1292)\nat org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:440)\nat org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getXAResource(ConnectionFactoryImpl.java:378)\nat org.datanucleus.store.connection.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:328)\nat org.datanucleus.store.connection.AbstractConnectionFactory.getConnection(AbstractConnectionFactory.java:94)\nat org.datanucleus.store.AbstractStoreManager.getConnection(AbstractStoreManager.java:430)\nat org.datanucleus.store.AbstractStoreManager.getConnection(AbstractStoreManager.java:396)\nat org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:262)\nat org.datanucleus.store.query.Query.executeQuery(Query.java:1786)\nat org.datanucleus.store.query.AbstractSQLQuery.executeWithArray(AbstractSQLQuery.java:339)\nat org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:312)\nat org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getDatabase(MetaStoreDirectSql.java:197)\nat org.apache.hadoop.hive.metastore.ObjectStore.getDatabase(ObjectStore.java:500)\nat sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)\nat com.sun.proxy.$Proxy11.getDatabase(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_core(HiveMetaStore.java:1248)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_with_environment_context(HiveMetaStore.java:1332)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:105)\nat com.sun.proxy.$Proxy13.create_table_with_environment_context(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:558)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:547)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:89)\nat com.sun.proxy.$Proxy9.createTable(Unknown Source)\nat org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:613)\nat org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:4203)\nat org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:281)\nat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:153)\nat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:85)\nat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1508)\nat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1275)\nat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1093)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:916)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:906)\nat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:268)\nat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:220)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:423)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:359)\nat org.apache.hadoop.hive.cli.CliDriver.processReader(CliDriver.java:456)\nat org.apache.hadoop.hive.cli.CliDriver.processFile(CliDriver.java:466)\nat org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:749)\nat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:686)\nat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.util.RunJar.main(RunJar.java:212)\n2014-11-10 15:36:28,876 ERROR [main]: metastore.ObjectStore (ObjectStore.java:commitTransaction(391)) - java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction\n2014-11-10 15:36:28,882 ERROR [main]: metastore.RetryingHMSHandler (RetryingHMSHandler.java:invoke(143)) - MetaException(message:java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newMetaException(HiveMetaStore.java:4638)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_with_environment_context(HiveMetaStore.java:1346)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:105)\nat com.sun.proxy.$Proxy13.create_table_with_environment_context(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:558)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:547)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:89)\nat com.sun.proxy.$Proxy9.createTable(Unknown Source)\nat org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:613)\nat org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:4203)\nat org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:281)\nat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:153)\nat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:85)\nat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1508)\nat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1275)\nat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1093)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:916)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:906)\nat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:268)\nat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:220)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:423)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:359)\nat org.apache.hadoop.hive.cli.CliDriver.processReader(CliDriver.java:456)\nat org.apache.hadoop.hive.cli.CliDriver.processFile(CliDriver.java:466)\nat org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:749)\nat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:686)\nat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nCaused by: java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction\nat org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:388)\nat sun.reflect.GeneratedMethodAccessor11.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)\nat com.sun.proxy.$Proxy11.commitTransaction(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_core(HiveMetaStore.java:1300)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_with_environment_context(HiveMetaStore.java:1332)\n... 38 more\n2014-11-10 15:36:28,887 ERROR [main]: exec.DDLTask (DDLTask.java:execute(478)) - org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction)\nat org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:619)\nat org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:4203)\nat org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:281)\nat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:153)\nat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:85)\nat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1508)\nat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1275)\nat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1093)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:916)\nat org.apache.hadoop.hive.ql.Driver.run(Driver.java:906)\nat org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:268)\nat org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:220)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:423)\nat org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:359)\nat org.apache.hadoop.hive.cli.CliDriver.processReader(CliDriver.java:456)\nat org.apache.hadoop.hive.cli.CliDriver.processFile(CliDriver.java:466)\nat org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:749)\nat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:686)\nat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nCaused by: MetaException(message:java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newMetaException(HiveMetaStore.java:4638)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_with_environment_context(HiveMetaStore.java:1346)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:105)\nat com.sun.proxy.$Proxy13.create_table_with_environment_context(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:558)\nat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:547)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:89)\nat com.sun.proxy.$Proxy9.createTable(Unknown Source)\nat org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:613)\n... 23 more\nCaused by: java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction\nat org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:388)\nat sun.reflect.GeneratedMethodAccessor11.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)\nat com.sun.proxy.$Proxy11.commitTransaction(Unknown Source)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_core(HiveMetaStore.java:1300)\nat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.create_table_with_environment_context(HiveMetaStore.java:1332)\n... 38 more\n2014-11-10 15:36:28,889 ERROR [main]: ql.Driver (SessionState.java:printError(547)) - FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that there are unbalanced calls to openTransaction/commitTransaction)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-13T01:44:25.031+0000","updated":"2014-11-13T01:44:25.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14209075","id":"14209075","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"body":"cc-ing [~sushanth] for review.\n\nThanks\nHari","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-13T01:48:29.368+0000","updated":"2014-11-13T01:48:29.368+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14209594","id":"14209594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12681204/HIVE-8850.1.patch\n\n{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 6686 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1769/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1769/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1769/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 1 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12681204 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-11-13T11:11:06.015+0000","updated":"2014-11-13T11:11:06.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14215309","id":"14215309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"In theory, from analyzing the codeflow path of open and close transactions, this looks like this is important to have. This is how I currently analyze the flow of how the variable openTransactions is affected:\n\n{noformat}\n\nMethods that interact with openTransactions:\n\nsetConf\n\t> instantiates it to 0 the very first time we start.\n\nopenTransaction\n\t> Increments without any checks.\n\t> If after incrementing, its value is 1, then sets currentTransaction = pm.currentTransaction(), begins that trnasaction, and sests TXN_STATUS.OPEN\n\t> If openTransactionCalls > 1, and current transaction is non-null and active, all's good, returns\n\t~ If openTransactionCalls > 1, but current transaction is null or inactive, asserts (disabled in prod) but doesn't really handle anything.\n\n\nrollbackTransaction\n\t> If openTransactionCalls < 1, returns saying there's no open transactions - from prior conditions, this can only happen if it's 0. Negative cannot happen.\n\t> sets openTransactionCalls to 0.\n\t> if current transaction is inactive, does nothing\n\t> If current transaction is active, and its status is TXN_STATUS.ROLLBACK, does nothing\n\t> If current transaction is active and its status is not TXN_STATUS.ROLLBACK, then does the following:\n\t\t+ sets status to TXN_STATUS.ROLLBACK \n\t\t+ calls currentTransaction.rollback\n\t\t+ calls pm.evictAll\n\t~ If the transaction state goes inactive, we still have a case to evict, and that is what's being done in this patch.\n\n\ncommitTransaction\n\t> If current state is TXN_STATUS.ROLLBACK, returns false\n\t> If openTransactionCalls is <=0, errors out about unbalanced commitTransactions.\n\t\t> Technically, this can never be negative, it can only happen if it is 0.\n\t\t> Also, the only cases that lead to this state are if:\n\t\t\ta) More commitTransactions are called than the number of openTransactions that were called.\n\t\t\tb) rollbackTransaction was called, but for whatever reason, did not set TXN_STATUS.ROLLBACK, followed by calling commitTransaction later.\n\t\t\t\t- note that this can happen if the current transaction should become invalid for whatever reason before rollback is called. There does seem to be an issue here, in that rollback will not result in a full eviction in this case, but atleast we error here in a valid way.\n\t> If current transaction is not active, throws an error identical to the previous case. This is probably not good if we need to ever distinguish between these two cases, and if the current transaction might wind up being inactive for whatever other reason.\n\t> decrements if it should apply successfully.\n\t> If the result of the decrement gets it to 0, and current transaction is active, then commits the current transaction, and ssets status to TXN_STATUS.COMMITTED\n\n{noformat}\n\nSo, it would seem that this patch is correct and needed. However, since this is a sensitive area, I'm trying to follow call stacks to rollback and commit transaction to make sure I'm not misreading this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-17T22:28:40.144+0000","updated":"2014-11-17T22:28:40.144+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14217027","id":"14217027","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"In addition to the rollback issue here, there's one more nasty interplay here between open and rollback - open after a rollback will simply go ahead and nuke out the txn state and simply increment transaction count. Thus, the following can now happen:\n\n{noformat}\nsetConf (count = 0)\nopenTransaction (count = 1)\n        openTransaction (count = 2)\n                (... some code that fails ...)\n        rollbackTransaction (count = 0)\n        openTransaction (count = 1)\n                (... some code that succeeds ...)\n        commitTransaction (count = 0)\ncommitTransaction (count = -1)\n{noformat}\n\nNormally, a rollback makes it so subsequent commits will realize that it's rolling back, so they do nothing, but if there is ever code that tries to call an open again instead of going down the commit chain, we have a problem.\n\nAgain, normally, this shouldn't happen, because the rollback is indicative that this txn should fail, and to roll all the way out. The case where it wouldn't do that, however, is if we are inside a direct sql helper, where we attempt to use direct sql, open a txn, fail, rollback, and then fail back to using jdo, where we open a transaction again, and have that succeed.\n\nNow, ordinarily, this situation is also protected against, since the directsql portion does not open a new transaction and roll that back if it detects that it's already inside a transaction. However, directsql's detection of whether or not it is in a nested transaction is to simply check if there is already a transaction which is active. This can sometimes not be the case if the transaction got invalidated (set inactive, effectively) by bonecp, etc. In that scenario, we wind up with this behaviour described above, where directsql decides that isInTxn is false (since the current txn is invalid), and then it opens a txn for the directsql part, and if that fails, will rollback.\n\nTagging [~sershe] to share this headache with him as well. :p","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-18T23:17:53.352+0000","updated":"2014-11-18T23:17:53.352+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14217215","id":"14217215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Also tagging [~brocknoland] and [~ctang.ma], since they're also hit issues over at HIVE-8891, and I'd like to get some more eyeballs on this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-19T01:23:40.420+0000","updated":"2014-11-19T01:23:40.420+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14217231","id":"14217231","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"(Also, for context, one thing I should explicitly call out here is the reason for the original change here is that the transaction seems to have been invalidated by bonecp, so it does not satisfy the if condition for (currentTransaction.isActive() && transactionStatus != TXN_STATUS.ROLLBACK) when rollback is first called. Thus, as a result of that, we never set TXN_STATUS.ROLLBACK, which then causes commits further on from proceeding without realizing it shouldn't.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-19T01:34:02.352+0000","updated":"2014-11-19T01:34:02.352+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14218230","id":"14218230","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"[~sushanth] Thanks for the deep insight and analysis to the cause of the \"unbalanced calls to openTransaction/commitTransaction\" issue. I think HIVE-8891 is slightly different from the issue here and it just ensures to clean PersistenceManager cache after rollback to avoid the NucleusObjectNotFoundException and should not involve in the nested txn count issue.\nBecause rollbackTransaction always resets the openTransactionCalls to 0, so even if you set the transactionStatus to TXN_STATUS.ROLLBACK regardless in rollbackTrasaction, in the nested transaction example you gave above (e.g. sqldirect fallback to jdo), the nested openTransaction following rollbackTransaction will set it back to TXN_STATUS.OPEN, and patch provided here would still not solve the issue for this example, is it right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2014-11-19T17:55:16.896+0000","updated":"2014-11-19T17:55:16.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14218356","id":"14218356","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Yeah, I agree HIVE-8891 is different, and is necessary as well - I called you guys in here so that I have more people familiar with this looking at this as well. :)\n\nAnd yes, the patch provided here would still not solve the issue. It's a good first step in that it solves the issue of commitTransaction after a rollbackTransaction where the connection is invalidated in the background by something else, such as bonecp, but it does not yet solve the issue of an openTransaction after a rollbackTransaction in a nested scope.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-19T19:31:04.012+0000","updated":"2014-11-19T19:31:04.012+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14220059","id":"14220059","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Attaching updated patch that I believe solves this issue. (Also incorporates Hari's original patch)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-20T21:43:00.862+0000","updated":"2014-11-20T21:43:00.862+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14220072","id":"14220072","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Note also, that the result of this is that the directsql attempt of getDatabase will not have a rollback executed on it if it fails before falling back to jdo, but that is fine, I think, since it's a read-only operation, and thus, does not need rollback.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-20T21:50:16.746+0000","updated":"2014-11-20T21:50:16.746+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14220096","id":"14220096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Cancelling second patch, there is still another issue with this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-20T22:02:08.313+0000","updated":"2014-11-20T22:02:08.313+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14220200","id":"14220200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Earlier bug fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-20T23:20:19.701+0000","updated":"2014-11-20T23:20:19.701+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14221760","id":"14221760","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12682774/HIVE-8850.3.patch\n\n{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 6666 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan\norg.apache.hive.hcatalog.streaming.TestStreaming.testEndpointConnection\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1859/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1859/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1859/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 2 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12682774 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-11-22T02:29:18.735+0000","updated":"2014-11-22T02:29:18.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14223577","id":"14223577","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~sershe],[~brocknoland], [~ctang.ma], can I bug one of you for a review of this? https://reviews.apache.org/r/28408/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-24T21:47:08.435+0000","updated":"2014-11-24T21:47:08.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14223582","id":"14223582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ctang.ma] I know you've looked at this recently. Let me know what you think.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-24T21:50:03.355+0000","updated":"2014-11-24T21:50:03.355+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14225426","id":"14225426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"[~sushanth] The patch looks good. I left a couple of questions on the RB, could you help clarify them? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2014-11-25T23:52:54.515+0000","updated":"2014-11-25T23:52:54.515+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14236416","id":"14236416","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Updated patch per review comments and further testing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-06T00:59:29.588+0000","updated":"2014-12-06T00:59:29.588+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14236617","id":"14236617","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12685484/HIVE-8850.4.patch\n\n{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 6696 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_decimal_aggregate\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1978/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1978/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1978/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 1 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12685484 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-12-06T05:50:47.684+0000","updated":"2014-12-06T05:50:47.684+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14237191","id":"14237191","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"[~sushanth] Thanks for the clarifications to the questions in RB and updating the patch. It looks good to me. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2014-12-07T16:16:50.723+0000","updated":"2014-12-07T16:16:50.723+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14238783","id":"14238783","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Since the latest patch is very similar in state to what Hari initially came up with except for the change to openTransaction that Chaoyu suggested, I think it's fair to reassign back to Hari for this, doing so, and will commit with my +1 and Chaoyu's.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-09T01:06:39.232+0000","updated":"2014-12-09T01:06:39.232+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14238787","id":"14238787","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed. Thanks, Hari & Chaoyu.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-09T01:10:47.754+0000","updated":"2014-12-09T01:10:47.754+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12754944/comment/14238789","id":"14238789","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"body":"(No documentation required, just a bugfix)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushanth","name":"sushanth","key":"sushanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=sushanth&avatarId=26812","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sushanth&avatarId=26812","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sushanth&avatarId=26812","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sushanth&avatarId=26812"},"displayName":"Sushanth Sowmyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-09T01:11:27.606+0000","updated":"2014-12-09T01:11:27.606+0000"}],"maxResults":23,"total":23,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-8850/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i22b8f:"}}