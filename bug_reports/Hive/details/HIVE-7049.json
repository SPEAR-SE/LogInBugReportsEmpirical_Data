{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12713757","self":"https://issues.apache.org/jira/rest/api/2/issue/12713757","key":"HIVE-7049","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329345","id":"12329345","description":"Hive 1.2.0","name":"1.2.0","archived":false,"released":true,"releaseDate":"2015-05-18"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-05-13T04:41:05.238+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Apr 06 21:06:02 UTC 2015","customfield_12310420":"392073","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_28412803681_*|*_1_*:*_1_*:*_10350839_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-04-06T21:06:02.682+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7049/watchers","watchCount":9,"isWatching":false},"created":"2014-05-12T21:46:48.299+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12387935","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12387935","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"},"inwardIssue":{"id":"12595122","key":"HIVE-3159","self":"https://issues.apache.org/jira/rest/api/2/issue/12595122","fields":{"summary":"Update AvroSerde to determine schema of new tables","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-09-23T17:00:49.647+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"It mainly happens when \n1 )file schema and record schema are not same\n2 ) Record schema is nullable  but file schema is not.\n\nThe potential code location is at class AvroDeserialize\n \n{noformat}\n if(AvroSerdeUtils.isNullableType(recordSchema)) {\n      return deserializeNullableUnion(datum, fileSchema, recordSchema, columnType);\n    }\n{noformat}\n\nIn the above code snippet, recordSchema is verified if it is nullable. But the file schema is not checked.\n\nI tested with these values:\n{noformat}\nrecordSchema= [\"null\",\"string\"]\nfielSchema= \"string\"\n{noformat}\n\nAnd i got the following exception <line numbers might not be the same due to mu debugged code version>.\n\n{noformat}\norg.apache.avro.AvroRuntimeException: Not a union: \"string\" \n        at org.apache.avro.Schema.getTypes(Schema.java:272)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.deserializeNullableUnion(AvroDeserializer.java:275)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.worker(AvroDeserializer.java:205)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.workerBase(AvroDeserializer.java:188)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.deserialize(AvroDeserializer.java:174)\n        at org.apache.hadoop.hive.serde2.avro.TestAvroDeserializer.verifyNullableType(TestAvroDeserializer.java:487)\n        at org.apache.hadoop.hive.serde2.avro.TestAvroDeserializer.canDeserializeNullableTypes(TestAvroDeserializer.java:407)\n\n{noformat}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12644526","id":"12644526","filename":"HIVE-7049.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-13T00:30:51.610+0000","size":4051,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12644526/HIVE-7049.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12708290","id":"12708290","filename":"HIVE-7049.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T01:59:35.191+0000","size":4976,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12708290/HIVE-7049.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12708288","id":"12708288","filename":"Statistic","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T01:59:35.168+0000","size":2448,"mimeType":"text/html","content":"https://issues.apache.org/jira/secure/attachment/12708288/Statistic"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12708289","id":"12708289","filename":"Statistics10Min.avsc","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T01:59:35.183+0000","size":2353,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12708289/Statistics10Min.avsc"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"392268","customfield_12312823":null,"summary":"Unable to deserialize AVRO data when file schema and record schema are different and nullable","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13995873","id":"13995873","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"body":"patch uploaded","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-13T00:30:51.616+0000","updated":"2014-05-13T00:30:51.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13995896","id":"13995896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"body":"RB at: https://reviews.apache.org/r/21353/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-13T00:57:18.829+0000","updated":"2014-05-13T00:57:18.829+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13996047","id":"13996047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 no tests executed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12644526/HIVE-7049.1.patch\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/188/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/188/console\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12644526","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-05-13T04:41:05.238+0000","updated":"2014-05-13T04:41:05.238+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13996660","id":"13996660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for bringing this up.  I'm wondering if the situation you described is an issue of incompatibility of schemas rather than a bug. Record schema says that a field is union (nullable), while file schema says that the file is not a union, which seems suggesting that the data is not compatible with the schema. While we may need to provided a better error message for this, ignoring the file schema (by passing NULL down) will very likely break decimal support, which needs the file schema to read data correctly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-13T17:22:43.928+0000","updated":"2014-05-13T17:22:43.928+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13997378","id":"13997378","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"body":"Thank [~xuefuz] for the comments.\n\nI believe it is a valid Avro schema evolution.\nPlease see the following comments copied from  the link:\nhttp://avro.apache.org/docs/1.7.6/spec.html#Schema+Resolution\n{noformat}\n* if reader's is a union, but writer's is not\nThe first schema in the reader's union that matches the writer's schema is recursively resolved against it. If none match, an error is signalled.\n* if writer's is a union, but reader's is not\nIf the reader's schema matches the selected writer's schema, it is recursively resolved against it. If they do not match, an error is signalled.\n{noformat}\n\nMoreover, i tested a similar scenarios using pure avro code where i wrote using schema \"string\" and read it using [\"null\",\"string\"].","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-14T08:11:43.673+0000","updated":"2014-05-14T08:11:43.673+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13997714","id":"13997714","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~kamrul] If Hive can support the AVRO schema resolutions you mentioned, I don't see any obstacles. However, the fix in your patch seems having a problem with decimal, which may need more deliberation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-14T16:22:35.549+0000","updated":"2014-05-14T16:22:35.549+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13998371","id":"13998371","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks @xzhang.\n>However, the fix in your patch seems having a problem with decimal, which may need more deliberation.\n\nWhat is the (potential) problem in decimal?\nAny proposal what to do to address the decimal problem?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-15T01:53:14.963+0000","updated":"2014-05-15T01:53:14.963+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/13999687","id":"13999687","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"body":"[~xuefuz] : can you please help me to understand the problem mentioned in the previous comment?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-16T08:21:45.967+0000","updated":"2014-05-16T08:21:45.967+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14000010","id":"14000010","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"It seems that your patch tries to fix the issue by ignoring the file schema ( passing NULL down). File schema is needed to read decimal data correctly. Thus, we might need to fix in a different way.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-16T17:19:41.074+0000","updated":"2014-05-16T17:19:41.074+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14000642","id":"14000642","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"body":"Null is passed only if record schema is null but file schema is not null.\nDo you see any use case for decimal too?\n\n>Thus, we might need to fix in a different way.\n\nDo you want me to fix it differently? or you are looking to address this for decimal differently?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kamrul","name":"kamrul","key":"kamrul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohammad Kamrul Islam","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-17T03:13:41.487+0000","updated":"2014-05-17T03:13:41.487+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14000673","id":"14000673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"{code}\n+    if (AvroSerdeUtils.isNullableType(recordSchema)) {\n+      Schema tmpFileSchema = fileSchema;\n+      if (tmpFileSchema == null || !AvroSerdeUtils.isNullableType(tmpFileSchema)) {\n+\ttmpFileSchema = null;\n+      }\n+      return deserializeNullableUnion(datum, tmpFileSchema, recordSchema, columnType);\n     }\n{code}\n\nIf fileSchema is not null, but AvroSerdeUtils.isNullableType(tmpFileSchema) returns false, then tmpFileSchema = null. So you pass null as fileSchema in  deserializeNullableUnion(datum, tmpFileSchema, recordSchema, columnType).  This doesn't seem right.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-05-17T05:11:48.688+0000","updated":"2014-05-17T05:11:48.688+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14129380","id":"14129380","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smallem","name":"smallem","key":"smallem","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sudhir mallem","active":true,"timeZone":"Etc/UTC"},"body":"I'm seeing a similar issue but with \"long\" datatype. \n\nHive version: 0.13.1\n\nHere is the error:\n{code}\nexception java.io.IOException:org.apache.avro.AvroRuntimeException: Not a union: \"long\"\n{code}\n\nHere is the error from Log:\n{code}\n2014-09-10 23:45:05,679 ERROR CliDriver (SessionState.java:printError(545)) - Failed with exception java.io.IOException:org.apache.avro.AvroRuntimeException: Not a union: \"long\"\njava.io.IOException: org.apache.avro.AvroRuntimeException: Not a union: \"long\"\n        at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:636)\n        at org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:534)\n        at org.apache.hadoop.hive.ql.exec.FetchTask.fetch(FetchTask.java:137)\n        at org.apache.hadoop.hive.ql.Driver.getResults(Driver.java:1519)\n        at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:285)\n        at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:220)\n        at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:423)\n        at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:792)\n        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:686)\n        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:625)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nCaused by: org.apache.avro.AvroRuntimeException: Not a union: \"long\"\n        at org.apache.avro.Schema.getTypes(Schema.java:266)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.deserializeNullableUnion(AvroDeserializer.java:269)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.worker(AvroDeserializer.java:200)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.workerBase(AvroDeserializer.java:188)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.deserialize(AvroDeserializer.java:174)\n        at org.apache.hadoop.hive.serde2.avro.AvroSerDe.deserialize(AvroSerDe.java:99)\n        at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:620)\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smallem","name":"smallem","key":"smallem","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sudhir mallem","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-10T23:47:17.908+0000","updated":"2014-09-10T23:47:17.908+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14251986","id":"14251986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jonathan.bender","name":"jonathan.bender","key":"jonathan.bender","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jonathan.bender&avatarId=33577","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jonathan.bender&avatarId=33577","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jonathan.bender&avatarId=33577","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jonathan.bender&avatarId=33577"},"displayName":"Jonathan Bender","active":true,"timeZone":"Etc/UTC"},"body":"Seems like we can get away with the following patch (confirm the fileSchema AKA writer's schema is actually a union type before trying to find the type that the reader schema expects).  If not, just use the schema as is (it should be promoted to a union by Avro).\n\nThis worked for me in local testing.\n\n{noformat}\ndiff --git a/src/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroDeserializer.java b/src/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroDeserializer.java\nindex ce933ff..032761c 100644\n--- a/src/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroDeserializer.java\n+++ b/src/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroDeserializer.java\n@@ -265,9 +265,12 @@ private Object deserializeNullableUnion(Object datum, Schema fileSchema, Schema\n     if(schema.getType().equals(Schema.Type.NULL)) {\n       return null;\n     }\n+    Schema writerSchema = fileSchema;\n+    if (writerSchema != null && writerSchema.getType().equals(Schema.Type.UNION)) {\n+      writerSchema = writerSchema.getTypes().get(tag);  \n+    }\n \n-    return worker(datum, fileSchema == null ? null : fileSchema.getTypes().get(tag), schema,\n-        SchemaToTypeInfo.generateTypeInfo(schema));\n+    return worker(datum, writerSchema, schema, SchemaToTypeInfo.generateTypeInfo(schema));\n \n   }\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-18T18:24:38.494+0000","updated":"2015-01-25T21:57:42.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14387817","id":"14387817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"body":"Hit the same issue and here is the reproducible steps:\n{code}\nCREATE TABLE Statistics10Min \nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.avro.AvroSerDe' \nSTORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat' \nOUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat' \nLOCATION '/user/daijy/data/Statistics10Min/' \nTBLPROPERTIES ('avro.schema.url'='/user/daijy/Statistics10Min/Statistics10Min.avsc');\n{code}\nselect * from Statistics10Min fail with the message:\n{code}\nFailed with exception java.io.IOException:org.apache.avro.AvroRuntimeException: Not a record: [\"null\",{\"type\":\"record\",\"name\":\"Statistic\",\"namespace\":\"SHARP\",\"fields\":[{\"name\":\"WindFarm\",\"type\":[\"null\",\"string\"]},{\"name\":\"WTG\",\"type\":[\"null\",\"string\"]},{\"name\":\"LocalTS\",\"type\":[\"null\",\"string\"]},{\"name\":\"TS\",\"type\":[\"null\",\"string\"]},{\"name\":\"WindSpeedAvg\",\"type\":\"string\"},{\"name\":\"WindSpeedMin\",\"type\":\"string\"},{\"name\":\"WindSpeedMax\",\"type\":\"string\"},{\"name\":\"WindSpeedStdDev\",\"type\":\"string\"},{\"name\":\"ActPowAvg\",\"type\":\"string\"},{\"name\":\"ActPowMin\",\"type\":\"string\"},{\"name\":\"ActPowMax\",\"type\":\"string\"},{\"name\":\"ActPowStdDev\",\"type\":\"string\"},{\"name\":\"ReactPowAvg\",\"type\":\"string\"},{\"name\":\"ReactPowMin\",\"type\":\"string\"},{\"name\":\"ReactPowMax\",\"type\":\"string\"},{\"name\":\"ReactPowStdDev\",\"type\":\"string\"},{\"name\":\"GenSpeedAvg\",\"type\":\"string\"},{\"name\":\"GenSpeedMin\",\"type\":\"string\"},{\"name\":\"GenSpeedMax\",\"type\":\"string\"},{\"name\":\"GenSpeedStdDev\",\"type\":\"string\"},{\"name\":\"RotSpeedAvg\",\"type\":\"string\"},{\"name\":\"RotSpeedMin\",\"type\":\"string\"},{\"name\":\"RotSpeedMax\",\"type\":\"string\"},{\"name\":\"RotSpeedStdDev\",\"type\":\"string\"},{\"name\":\"YawDirAvg\",\"type\":\"string\"},{\"name\":\"YawDirMin\",\"type\":\"string\"},{\"name\":\"YawDirMax\",\"type\":\"string\"},{\"name\":\"YawDirStdDev\",\"type\":\"string\"},{\"name\":\"VibTowAvg\",\"type\":\"string\"},{\"name\":\"VibTowMin\",\"type\":\"string\"},{\"name\":\"VibTowMax\",\"type\":\"string\"},{\"name\":\"VibTowStdDev\",\"type\":\"string\"},{\"name\":\"PitchAvg\",\"type\":\"string\"},{\"name\":\"PitchMin\",\"type\":\"string\"},{\"name\":\"PitchMax\",\"type\":\"string\"},{\"name\":\"PitchRateMin\",\"type\":\"string\"},{\"name\":\"PitchRateMax\",\"type\":\"string\"},{\"name\":\"PitchRateStdDev\",\"type\":\"string\"},{\"name\":\"GridVoltAvg\",\"type\":\"int\"},{\"name\":\"GridVoltMin\",\"type\":\"int\"},{\"name\":\"GridVoltMax\",\"type\":\"int\"},{\"name\":\"EnvTempAvg\",\"type\":\"string\"},{\"name\":\"EnvTempMin\",\"type\":\"string\"},{\"name\":\"EnvTempMax\",\"type\":\"string\"},{\"name\":\"GbxTempAvg\",\"type\":\"string\"},{\"name\":\"GbxTempMin\",\"type\":\"string\"},{\"name\":\"GbxTempMax\",\"type\":\"string\"},{\"name\":\"GenAccMin\",\"type\":\"string\"},{\"name\":\"GenAccMax\",\"type\":\"string\"},{\"name\":\"VibratAvg\",\"type\":\"string\"},{\"name\":\"VibratMax\",\"type\":\"string\"},{\"name\":\"GenU1TempAvg\",\"type\":\"string\"},{\"name\":\"GenU1TempMin\",\"type\":\"string\"},{\"name\":\"GenU1TempMax\",\"type\":\"string\"},{\"name\":\"RotorSideLTempAvg\",\"type\":\"string\"},{\"name\":\"RotorSideLTempMin\",\"type\":\"string\"},{\"name\":\"RotorSideLTempMax\",\"type\":\"string\"},{\"name\":\"WindBin\",\"type\":\"int\"},{\"name\":\"FreqMean\",\"type\":\"string\"}]}]\n{code}\nStack:\n{code}\n        at org.apache.avro.Schema.getField(Schema.java:184)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.workerBase(AvroDeserializer.java:191)\n        at org.apache.hadoop.hive.serde2.avro.AvroDeserializer.deserialize(AvroDeserializer.java:178)\n        at org.apache.hadoop.hive.serde2.avro.AvroSerDe.deserialize(AvroSerDe.java:199)\n        at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:488)\n{code}\n\nNote this is broken by HIVE-5823.\n\nAttach HIVE-7049.2.patch. [~xuefuz], can you check if the new patch work with decimal?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-31T01:59:35.199+0000","updated":"2015-03-31T01:59:35.199+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14388063","id":"14388063","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12708290/HIVE-7049.2.patch\n\n{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 8693 tests executed\n*Failed tests:*\n{noformat}\nTestMinimrCliDriver-smb_mapjoin_8.q - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler.testRevokeTimedOutWorkers\norg.apache.hive.hcatalog.streaming.TestStreaming.testMultipleTransactionBatchCommits\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3213/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3213/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3213/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 3 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12708290 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2015-03-31T05:48:51.039+0000","updated":"2015-03-31T05:48:51.039+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14391722","id":"14391722","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Daniel's approach of extracting actual type from a nullable type looks ok to me.\n+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-01T23:15:01.394+0000","updated":"2015-04-01T23:15:01.394+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12713757/comment/14481945","id":"14481945","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hagleitn","name":"hagleitn","key":"hagleitn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hagleitn&avatarId=16035","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hagleitn&avatarId=16035","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hagleitn&avatarId=16035","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hagleitn&avatarId=16035"},"displayName":"Gunther Hagleitner","active":true,"timeZone":"America/Los_Angeles"},"body":"Tests passed locally. Committed to trunk. Thanks [~daijy] and [~ashutoshc]!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hagleitn","name":"hagleitn","key":"hagleitn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hagleitn&avatarId=16035","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hagleitn&avatarId=16035","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hagleitn&avatarId=16035","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hagleitn&avatarId=16035"},"displayName":"Gunther Hagleitner","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-06T21:06:02.750+0000","updated":"2015-04-06T21:06:02.750+0000"}],"maxResults":17,"total":17,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7049/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1visf:"}}