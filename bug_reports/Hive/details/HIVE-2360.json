{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12518267","self":"https://issues.apache.org/jira/rest/api/2/issue/12518267","key":"HIVE-2360","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-08-09T17:29:21.466+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Oct 26 05:46:11 UTC 2011","customfield_12310420":"35796","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_126985074524_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-08-17T18:38:21.907+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2360/watchers","watchCount":0,"isWatching":false},"created":"2011-08-09T01:00:27.425+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-08-17T18:38:21.938+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"There are some conditions under which a partition description is created due to insert overwriting a table using dynamic partitioning for partitions that that are empty (have no files).","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12489789","id":"12489789","filename":"hive-2360.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-09T01:04:32.698+0000","size":1261,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12489789/hive-2360.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12489913","id":"12489913","filename":"hive-2360.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-09T23:28:22.433+0000","size":3592,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12489913/hive-2360.2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123834","customfield_12312823":null,"summary":"create dynamic partition if and only if intermediate source has files","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12518267/comment/13081780","id":"13081780","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Franklin, can you create a review request? That's much easier to comment. Two comments here: \n\n 1) in dynamic partition inserts, a subquery corresponding to a partition is created only if there is a row that should be inserted into that partition, which means the directory should not be empty. If the directory is empty, most likely there is a bug there and we should fix that bug instead. \n 2) the function Utilities.getFileStatusRecurse() is quite expensive. We should avoid using it and use cached results (it's called somewhere else before). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-08-09T17:29:21.466+0000","updated":"2011-08-09T17:29:21.466+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12518267/comment/13081992","id":"13081992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"body":"refactor to use one call to Utilities.getFileStatusRecurse()","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=franklinhu","name":"franklinhu","key":"franklinhu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Franklin Hu","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-09T23:28:22.495+0000","updated":"2011-08-09T23:28:22.495+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12518267/comment/13081995","id":"13081995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/1442/\n-----------------------------------------------------------\n\nReview request for hive, Ning Zhang and Siying Dong.\n\n\nSummary\n-------\n\nThere are some conditions under which partition descriptions are created in memory and committed to the metastore despite there being no intermediate or final finals in that directory (due to dynamic partitioning).\nIn this change, a check is done to only call loadPartitions that have files in them.\n\n\nThis addresses bug HIVE-2360.\n    https://issues.apache.org/jira/browse/HIVE-2360\n\n\nDiffs\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1155968 \n\nDiff: https://reviews.apache.org/r/1442/diff\n\n\nTesting\n-------\n\nUnit tests pass\n\n\nThanks,\n\nFranklin\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-09T23:31:26.982+0000","updated":"2011-08-09T23:31:26.982+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12518267/comment/13103145","id":"13103145","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sdong","name":"sdong","key":"sdong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siying Dong","active":true,"timeZone":"Etc/UTC"},"body":"Franklin finished his internship and left. We should find another one to finish the task.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sdong","name":"sdong","key":"sdong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siying Dong","active":true,"timeZone":"Etc/UTC"},"created":"2011-09-12T22:43:08.497+0000","updated":"2011-09-12T22:43:08.497+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12518267/comment/13132289","id":"13132289","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kaushik","name":"kaushik","key":"kaushik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kaushik Lakshminarayanan","active":true,"timeZone":"Etc/UTC"},"body":"The patch (https://issues.apache.org/jira/secure/attachment/12489913/hive-2360.2.patch) passes all the unit tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kaushik","name":"kaushik","key":"kaushik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kaushik Lakshminarayanan","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-21T02:40:38.902+0000","updated":"2011-10-21T02:40:38.902+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12518267/comment/13135732","id":"13135732","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-h0.21 #1035 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1035/])\n    HIVE-2360 create dynamic partition if and only if intermediate source has files (Franklin Hu, Kaushik Lakshminarayanan via Siying Dong)\n\nsdong : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1188989\nFiles : \n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-26T05:46:11.254+0000","updated":"2011-10-26T05:46:11.254+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2360/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ljnj:"}}