{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13130591","self":"https://issues.apache.org/jira/rest/api/2/issue/13130591","key":"HIVE-18445","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12340268","id":"12340268","name":"3.0.0","archived":false,"released":true,"releaseDate":"2018-05-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2018-01-15T09:13:07.672+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue May 22 23:13:04 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_589705406_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_238580099","customfield_12312321":null,"resolutiondate":"2018-01-22T08:01:14.807+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-18445/watchers","watchCount":2,"isWatching":false},"created":"2018-01-12T17:56:29.353+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-05-22T23:13:04.550+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12317406","id":"12317406","name":"Tests"}],"timeoriginalestimate":null,"description":"org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join25] (batchId=72)\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12906820","id":"12906820","filename":"HIVE-18445.01.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-19T13:45:05.404+0000","size":5340,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12906820/HIVE-18445.01.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"qtests: auto_join25.q fails permanently","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16325351","id":"16325351","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"body":"It seems like the results don't depend on other qtests, as it fails sometimes when running separately.\r\n{code}\r\nmvn test -Dtest=TestCliDriver -Pitests -e -pl itests/qtest -Dqfile=auto_join25.q\r\n{code}\r\n\r\nIn the event of failure, the q.out contains something like:\r\n{code}\r\n< Hive Runtime Error: Map local work exhausted memory\r\n< FAILED: Execution Error, return code 3 from org.apache.hadoop.hive.ql.exec.mr.MapredLocalTask\r\n< ATTEMPT: Execute BackupTask: org.apache.hadoop.hive.ql.exec.mr.MapRedTask\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-13T22:14:44.289+0000","updated":"2018-01-13T22:15:15.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16325380","id":"16325380","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"body":"The issue here is, that the test is about exhausting the local mapper task's memory, and to achieve this, it sets a parameter at the beginning...\r\n{code:java}\r\nset hive.mapjoin.localtask.max.memory.usage = 0.0001;\r\n{code}\r\n...so the task can use the 0.01% percent of the process' memory. It seems to be ok for testing memory exhaustion, but the problem is that it affects all queries.\r\n\r\nChecking the q.out file, it seems like we expect an exhaustion by running the 2nd query:\r\n{code:java}\r\nFROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key + src2.key = src3.key)\r\nINSERT OVERWRITE TABLE dest_j2 SELECT src1.key, src3.value;\r\n{code}\r\nBut when the test fails, it fails on the first statement (which is not supposed to fail):\r\n{code:java}\r\nFROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)\r\nINSERT OVERWRITE TABLE dest1 SELECT src1.key, src2.value \r\nwhere (src1.ds = '2008-04-08' or src1.ds = '2008-04-09' )and (src1.hr = '12' or src1.hr = '11');\r\n{code}\r\nI think the best practise would be to set the parameter before the target query, and reset it to default (or a higher value) after, like:\r\n{code:java}\r\nset hive.mapjoin.localtask.max.memory.usage = 0.0001;\r\n\r\nFROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key + src2.key = src3.key)\r\nINSERT OVERWRITE TABLE dest_j2 SELECT src1.key, src3.value;\r\n\r\nset hive.mapjoin.localtask.max.memory.usage = 0.9;\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-13T23:30:34.783+0000","updated":"2018-01-19T13:02:44.559+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16325504","id":"16325504","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"body":"Or we can completely turn off auto join for statements out of scope, the test case will test conditonal task and exhaustion anyway. The current problem is, sometimes there are repeated errors messages in q.out. Further investigation is in progress.\r\n\r\nq file\r\n{code}\r\nset hive.auto.convert.join = true;\r\nFROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key + src2.key = src3.key)\r\nINSERT OVERWRITE TABLE dest_j2 SELECT src1.key, src3.value;\r\nset hive.auto.convert.join = false;\r\n{code}\r\n\r\nq.out file\r\n{code}\r\nPREHOOK: query: FROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key + src2.key = src3.key)\r\nINSERT OVERWRITE TABLE dest_j2 SELECT src1.key, src3.value\r\nPREHOOK: type: QUERY\r\nPREHOOK: Input: default@src\r\nPREHOOK: Output: default@dest_j2\r\nHive Runtime Error: Map local work exhausted memory\r\nFAILED: Execution Error, return code 3 from org.apache.hadoop.hive.ql.exec.mr.MapredLocalTask\r\nATTEMPT: Execute BackupTask: org.apache.hadoop.hive.ql.exec.mr.MapRedTask\r\nHive Runtime Error: Map local work exhausted memory\r\nFAILED: Execution Error, return code 3 from org.apache.hadoop.hive.ql.exec.mr.MapredLocalTask\r\nATTEMPT: Execute BackupTask: org.apache.hadoop.hive.ql.exec.mr.MapRedTask\r\nPOSTHOOK: query: FROM src src1 JOIN src src2 ON (src1.key = src2.key) JOIN src src3 ON (src1.key + src2.key = src3.key)\r\nINSERT OVERWRITE TABLE dest_j2 SELECT src1.key, src3.value\r\nPOSTHOOK: type: QUERY\r\nPOSTHOOK: Input: default@src\r\nPOSTHOOK: Output: default@dest_j2\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-14T10:46:03.459+0000","updated":"2018-01-14T10:46:36.306+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16326021","id":"16326021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"body":"it seems like the test was added in HIVE-1642; with the intention to check for the \"backuptask\" doing the job in case the first one fails...I think the test should have ~3 BackupTask executionions in the q.out; but instead there is 1\r\nIn the light of the above; I've looked into when these {{BackupTask}} attempts are changed - and it looks like after HIVE-13567 some of the \"Execution Error\"-s are gone; probably the plans have changed for these queries","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"created":"2018-01-15T09:13:07.672+0000","updated":"2018-01-15T09:13:07.672+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16326030","id":"16326030","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"body":"query plans look good to me ; I've see no changes in the select join type (other changes are expect after HIVE-13567) ; interestingly: adding these explains to the q file made the \"Execution Error\" messages go away somehow","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"created":"2018-01-15T09:30:30.615+0000","updated":"2018-01-15T09:30:30.615+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16326105","id":"16326105","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"body":"I was looking into whether this feature works for producing test cases for reoptimization...and I've probably just bumped into the reason this test have changed after HIVE-13567: \r\n[https://github.com/apache/hive/blob/6938fcabf0944817fed8241c48b57fb3f5d98c69/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/LocalMapJoinProcFactory.java#L133\r\nwhich is a feature introduced in HIVE-1830\r\nso probably setting {{hive.mapjoin.followby.gby.localtask.max.memory.usage}} to some low value would probably re-introduce the backuptasks ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"created":"2018-01-15T10:45:39.434+0000","updated":"2018-01-15T10:45:39.434+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16332240","id":"16332240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"body":"Hi [~kgyrtkirk] !\r\n\r\nThx, it was really helpful.\r\nI'll upload a patch, which seems to fix that in the way you've explained (consistently fails for all 3 queries in case of using hive.mapjoin.followby.gby.localtask.max.memory.usage).\r\n\r\nHowever, according to the documentation, the \"group by\" part is not clear to me.\r\n[\"when this map join is followed by a group by\"|https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.mapjoin.followby.gby.localtask.max.memory.usage]\r\n\r\nIs there an implicit \"group by\", somewhere? I can't see any grouping in auto_join25.q.\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-19T13:21:52.216+0000","updated":"2018-01-19T13:21:52.216+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16332309","id":"16332309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"body":"oh...I was looking thru things for a few minutes...but eventually I've figured it out....the groupby is added because HIVE-13567 have enable the colstats collection which technically an extra aggregator executed on the newly created table's contents - and because of the aggregation there is a groupby; because UDAFs has a wider range of function than just aggregate a column; probably most importantly, the [aggregation modes|https://github.com/apache/hive/blob/d6c6d96f98d998298618a643bd0d571d4e290dc3/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFEvaluator.java#L76].\r\n\r\n+1 pending tests","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"created":"2018-01-19T14:21:52.092+0000","updated":"2018-01-19T14:21:52.092+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16333015","id":"16333015","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (/) *{color:green}+1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 50s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}  1m 34s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus/dev-support/hive-personality.sh |\r\n| git revision | master / 6d890fa |\r\n| modules | C: ql U: ql |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-8710/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-01-19T23:41:48.843+0000","updated":"2018-01-19T23:41:48.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16333068","id":"16333068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12906820/HIVE-18445.01.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 22 failed/errored test(s), 11628 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[groupby_rollup_empty] (batchId=55)\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_join5] (batchId=35)\norg.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_move_tbl] (batchId=173)\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[llap_smb] (batchId=151)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[bucket_map_join_tez1] (batchId=170)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[groupby_rollup_empty] (batchId=164)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[insert_values_orig_table_use_metadata] (batchId=165)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[llap_acid] (batchId=169)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[llap_acid_fast] (batchId=160)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[resourceplan] (batchId=163)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sysdb] (batchId=160)\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[authorization_part] (batchId=94)\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_join5] (batchId=121)\norg.apache.hadoop.hive.metastore.TestMetastoreExpr.testPartitionExpr (batchId=257)\norg.apache.hadoop.hive.ql.io.TestDruidRecordWriter.testWrite (batchId=254)\norg.apache.hive.hcatalog.common.TestHiveClientCache.testCacheExpiry (batchId=198)\norg.apache.hive.hcatalog.common.TestHiveClientCache.testCacheHit (batchId=198)\norg.apache.hive.hcatalog.common.TestHiveClientCache.testCacheMiss (batchId=198)\norg.apache.hive.hcatalog.common.TestHiveClientCache.testCloseAllClients (batchId=198)\norg.apache.hive.jdbc.TestSSL.testConnectionMismatch (batchId=232)\norg.apache.hive.jdbc.TestSSL.testConnectionWrongCertCN (batchId=232)\norg.apache.hive.jdbc.TestSSL.testMetastoreConnectionWrongCertCN (batchId=232)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/8710/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/8710/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-8710/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 22 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12906820 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-01-20T00:51:01.651+0000","updated":"2018-01-20T00:51:01.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16333224","id":"16333224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"body":"It seems like auto_join25 test passed, and it has also passed locally without error.\r\n\r\n[~kgyrtkirk]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=abstractdog","name":"abstractdog","key":"abstractdog","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Laszlo Bodor","active":true,"timeZone":"Etc/UTC"},"created":"2018-01-20T15:28:11.404+0000","updated":"2018-01-20T15:28:11.404+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16333984","id":"16333984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"body":"pushed to master. Thank you [~abstractdog] for taking care of this!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kgyrtkirk","name":"kgyrtkirk","key":"kgyrtkirk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kgyrtkirk&avatarId=32755","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kgyrtkirk&avatarId=32755","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kgyrtkirk&avatarId=32755","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kgyrtkirk&avatarId=32755"},"displayName":"Zoltan Haindrich","active":true,"timeZone":"Europe/Budapest"},"created":"2018-01-22T08:01:14.833+0000","updated":"2018-01-22T08:01:14.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13130591/comment/16484842","id":"16484842","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-05-22T23:13:04.543+0000","updated":"2018-05-22T23:13:04.543+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-18445/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3ov5b:"}}