{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12779113","self":"https://issues.apache.org/jira/rest/api/2/issue/12779113","key":"HIVE-9840","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-03-03T17:43:00.265+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Mar 04 22:14:05 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9840/watchers","watchCount":2,"isWatching":false},"created":"2015-03-03T16:39:24.499+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"issuelinks":[{"id":"12409636","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12409636","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12471927","key":"HIVE-1558","self":"https://issues.apache.org/jira/rest/api/2/issue/12471927","fields":{"summary":"introducing the \"dual\" table","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}},{"id":"12409580","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12409580","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12700763","key":"HIVE-6617","self":"https://issues.apache.org/jira/rest/api/2/issue/12700763","fields":{"summary":"Reduce ambiguity in grammar","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype","name":"Task","subtask":false,"avatarId":21148}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-03-04T22:14:05.787+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12325007","id":"12325007","name":"Hive"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12324450","id":"12324450","name":"Parser","description":"Hive grammar"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12324798","id":"12324798","name":"Query Planning"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":null,"description":"When I am running hive query [count (*)] with any table name or without table name ,  It spawn MR job and return result as \"1\"\nThese all command (as below) should fail with Syntax Error\n\nhive > select count ( * ) <any-table-name>\nhive > select count ( * ) <non-existing-table-name>\nhive > select count ( * ) <existing-table-name>\nhive > select count ( * ) \n\nWhen we provide any table name or do not supllie any argument , it spawn mapreduce job to count the row of table name \"_dummy_table\".\n\nEXPLAIN of above commands :\n\n---\nhive> EXPLAIN select count( * )  sample;\nOK\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-0 depends on stages: Stage-1\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: _dummy_table\n            Row Limit Per Split: 1\n            Statistics: Num rows: 0 Data size: 1 Basic stats: PARTIAL Column stats: COMPLETE\n            Select Operator\n              Statistics: Num rows: 0 Data size: 1 Basic stats: PARTIAL Column stats: COMPLETE\n              Group By Operator\n                aggregations: count()\n                mode: hash\n                outputColumnNames: _col0\n                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                Reduce Output Operator\n                  sort order: \n                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n                  value expressions: _col0 (type: bigint)\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations: count(VALUE._col0)\n          mode: mergepartial\n          outputColumnNames: _col0\n          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n          Select Operator\n            expressions: _col0 (type: bigint)\n            outputColumnNames: _col0\n            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n            File Output Operator\n              compressed: false\n              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE\n              table:\n                  input format: org.apache.hadoop.mapred.TextInputFormat\n                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n      Processor Tree:\n        ListSink\n\nTime taken: 0.071 seconds, Fetched: 47 row(s)\n---\n\nNOTE:  Table \"sample\" do not exist in my hive.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"select count(*) <tablename> should give exception","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pradeep_bhadani","name":"pradeep_bhadani","key":"pradeep_bhadani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep Bhadani","active":true,"timeZone":"Europe/London"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pradeep_bhadani","name":"pradeep_bhadani","key":"pradeep_bhadani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep Bhadani","active":true,"timeZone":"Europe/London"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"hive 0.14","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12779113/comment/14345389","id":"14345389","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~pradeep_bhadani], I tried mysql and postgres, they returned the same results without any exception. [~jpullokkaran] and [~ashutoshc], could you please take a look?\n\nMysql:\n\nmysql> select count(*);\n+----------+\n| count(*) |\n+----------+\n|        1 |\n+----------+\n1 row in set (0.00 sec)\n\nmysql> select count(*) src;\n+-----+\n| src |\n+-----+\n|   1 |\n+-----+\n1 row in set (0.00 sec)\n\nmysql> explain select count(*) src;\n+----+-------------+-------+------+---------------+------+---------+------+------+----------------+\n| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra          |\n+----+-------------+-------+------+---------------+------+---------+------+------+----------------+\n|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | No tables used |\n+----+-------------+-------+------+---------------+------+---------+------+------+----------------+\n1 row in set (0.00 sec)\n\nPostgres\n\ntmpdb=# select count(*);\n count\n-------\n     1\n(1 row)\n\ntmpdb=# select count(*) src;\n src\n-----\n   1\n(1 row)\n\ntmpdb=# explain select count(*) src;\n                   QUERY PLAN\n------------------------------------------------\n Aggregate  (cost=0.01..0.03 rows=1 width=0)\n   ->  Result  (cost=0.00..0.01 rows=1 width=0)\n(2 rows)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-03T17:43:00.265+0000","updated":"2015-03-03T17:43:00.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12779113/comment/14346487","id":"14346487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"(1) When there is no from clause, aliasToOpInfo.isEmpty() in Semantic Analyzer. And, Hive will create a dummy table, which only has a single 1 in it. Thus, select count(*) will be rewritten as select count(*) from `_dummy_table`\n{code}\nif (aliasToOpInfo.isEmpty()) {\n\n      qb.getMetaData().setSrcForAlias(DUMMY_TABLE, getDummyTable());\n\n      TableScanOperator op = (TableScanOperator) genTablePlan(DUMMY_TABLE, qb);\n\n      op.getConf().setRowLimit(1);\n\n      qb.addAlias(DUMMY_TABLE);\n\n      qb.setTabAlias(DUMMY_TABLE, DUMMY_TABLE);\n\n      aliasToOpInfo.put(DUMMY_TABLE, op);\n\n}\n{code}\n\n(2) When there is no from clause, but followed by a table name that does (not) exist, hive will give you an AST like this\n{code}\nTOK_QUERY\n   TOK_INSERT\n      TOK_DESTINATION\n         TOK_DIR\n            TOK_TMP_FILE\n      TOK_SELECT\n         TOK_SELEXPR\n            TOK_FUNCTIONSTAR\n               count\n            -----table name -----\n{code}\nHive will ignore the table name when parsing this.\n\n(3) MySQL, Postgres, MSSQL etc uses \"dual\" table\nhttp://dev.mysql.com/doc/refman/5.0/en/select.html\nhttp://en.wikipedia.org/wiki/DUAL_table\nAnd, \"The DUAL table is a special one-row, one-column table present by default in Oracle and other database installations. \" which corresponding to the dummytable in Hive. However, Hive does not allow you to use \"select 1 from dual\" explicitly:\n{code}\nhive> select 1 from dual;\nFAILED: SemanticException [Error 10001]: Line 1:14 Table not found 'dual'\n{code}\nAnd, there is already a jira ticket for this : https://issues.apache.org/jira/browse/HIVE-1558\n\n[~pradeep_bhadani], do you think it is OK to close this ticket? Thanks.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-04T06:42:20.217+0000","updated":"2015-03-04T06:42:20.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12779113/comment/14346658","id":"14346658","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pradeep_bhadani","name":"pradeep_bhadani","key":"pradeep_bhadani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep Bhadani","active":true,"timeZone":"Europe/London"},"body":"[~pxiong] , It makes sense to have dual (dummy) table in MySQL or Oracle , as you can access this table and can do some testing operation.\nBut in Hive , this table is not accessible. So I don't know what is the logic behind this dummy table in Hive. At least we should be able to access this table , otherwise it do not see any use of this table. \n\nIf dummy table is implemented as per  https://issues.apache.org/jira/browse/HIVE-1558 , then it might be useful for some cases. \n\nIf the ticket https://issues.apache.org/jira/browse/HIVE-1558 do not go for implementation , then the above statement should show some ERROR or aleast WARn message that we are trying to access dummy table and we cannot access this table or do any operation on this table.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pradeep_bhadani","name":"pradeep_bhadani","key":"pradeep_bhadani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pradeep Bhadani","active":true,"timeZone":"Europe/London"},"created":"2015-03-04T09:52:22.031+0000","updated":"2015-03-04T09:52:22.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12779113/comment/14347660","id":"14347660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"body":"[~pradeep_bhadani], the logic behind this dummy table is mentioned in my previous comment (1) and it is already implemented there. However, as I mentioned in (3) the dummy table is different from dual table. The function of dual table is mentioned in  https://issues.apache.org/jira/browse/HIVE-1558  but not implemented. You are very welcome to either add a warning log in the source code of Hive when dummy table is used or implement the dual table as you wish. Either way, we can help review your code. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxiong","name":"pxiong","key":"pxiong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pengcheng Xiong","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-04T22:14:05.787+0000","updated":"2015-03-04T22:14:05.787+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9840/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i26atr:"}}