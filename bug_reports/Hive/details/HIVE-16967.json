{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13082676","self":"https://issues.apache.org/jira/rest/api/2/issue/13082676","key":"HIVE-16967","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-06-27T05:56:42.945+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jun 27 08:11:20 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-16967/watchers","watchCount":2,"isWatching":false},"created":"2017-06-27T00:51:27.411+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-06-27T08:11:20.642+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320810","id":"12320810","name":"Tez","description":"Hive utilizing Tez framework"}],"timeoriginalestimate":null,"description":"Status: Running (Executing on YARN cluster with App id application_1494499520849_1063145)\n\n--------------------------------------------------------------------------------\n        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED\n--------------------------------------------------------------------------------\nMap 1 .........       KILLED     15         14        0        1       0       1\nMap 10 .........   SUCCEEDED     15         15        0        0       0       0\nMap 12 .........   SUCCEEDED     15         15        0        0       0       0\nMap 13 .........   SUCCEEDED      1          1        0        0       0       0\nMap 14 .........   SUCCEEDED      1          1        0        0       0       0\nMap 15 .........   SUCCEEDED      1          1        0        0       0       0\nMap 16 .........   SUCCEEDED      1          1        0        0       0       0\nMap 17 .........   SUCCEEDED      1          1        0        0       0       0\nMap 4 ..........   SUCCEEDED     15         15        0        0       0       0\nMap 5 ..........   SUCCEEDED      1          1        0        0       0       0\nMap 6 ..........   SUCCEEDED      1          1        0        0       0       0\nMap 7 ..........   SUCCEEDED      1          1        0        0       0       0\nMap 8 ..........   SUCCEEDED      1          1        0        0       0       0\nMap 9 ..........   SUCCEEDED      1          1        0        0       0       0\nReducer 11            FAILED    315          0        0      315     774     314\nReducer 2             KILLED    315          0        0      315       0     315\n--------------------------------------------------------------------------------\nVERTICES: 14/16  [==>>------------------------] 9%    ELAPSED TIME: 130.89 s   \n--------------------------------------------------------------------------------\nStatus: Failed\nVertex re-running, vertexName=Map 12, vertexId=vertex_1494499520849_1063145_1_07\nVertex re-running, vertexName=Map 1, vertexId=vertex_1494499520849_1063145_1_11\nVertex re-running, vertexName=Map 10, vertexId=vertex_1494499520849_1063145_1_06\nVertex re-running, vertexName=Map 4, vertexId=vertex_1494499520849_1063145_1_03\nVertex re-running, vertexName=Map 10, vertexId=vertex_1494499520849_1063145_1_06\nVertex re-running, vertexName=Map 4, vertexId=vertex_1494499520849_1063145_1_03\nVertex re-running, vertexName=Map 12, vertexId=vertex_1494499520849_1063145_1_07\nVertex re-running, vertexName=Map 4, vertexId=vertex_1494499520849_1063145_1_03\nVertex re-running, vertexName=Map 10, vertexId=vertex_1494499520849_1063145_1_06\nVertex re-running, vertexName=Map 5, vertexId=vertex_1494499520849_1063145_1_02\nVertex failed, vertexName=Reducer 11, vertexId=vertex_1494499520849_1063145_1_14, diagnostics=[Task failed, taskId=task_1494499520849_1063145_1_14_000013, diagnostics=[TaskAttempt 0 failed, info=[Error: Error while running task ( failure ) : attempt_1494499520849_1063145_1_14_000013_0:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:187)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)\n        at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:370)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:73)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:61)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:422)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1796)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:61)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:37)\n        at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:270)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:169)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:164)\n        ... 14 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:338)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:259)\n        ... 16 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Unexpected exception: null\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:318)\n        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:815)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.internalForward(CommonJoinOperator.java:642)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.createForwardJoinObject(CommonJoinOperator.java:437)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:529)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:526)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genJoinObject(CommonJoinOperator.java:455)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.checkAndGenObject(CommonJoinOperator.java:761)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinObject(CommonMergeJoinOperator.java:248)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinOneGroup(CommonMergeJoinOperator.java:213)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.processOp(CommonMergeJoinOperator.java:196)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:329)\n        ... 17 more\nCaused by: java.lang.NullPointerException\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:257)\n        ... 28 more\n], TaskAttempt 1 failed, info=[Error: Error while running task ( failure ) : attempt_1494499520849_1063145_1_14_000013_1:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:187)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)\n        at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:370)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:73)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:61)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:422)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1796)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:61)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:37)\n        at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:270)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:169)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:164)\n        ... 14 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:338)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:259)\n        ... 16 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Unexpected exception: null\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:318)\n        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:815)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.internalForward(CommonJoinOperator.java:638)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.createForwardJoinObject(CommonJoinOperator.java:433)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:525)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:522)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genJoinObject(CommonJoinOperator.java:451)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.checkAndGenObject(CommonJoinOperator.java:752)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinObject(CommonMergeJoinOperator.java:248)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinOneGroup(CommonMergeJoinOperator.java:213)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.processOp(CommonMergeJoinOperator.java:196)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:329)\n        ... 17 more\nCaused by: java.lang.NullPointerException\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:257)\n        ... 28 more\n], TaskAttempt 2 failed, info=[Error: Error while running task ( failure ) : attempt_1494499520849_1063145_1_14_000013_2:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:187)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)\n        at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:370)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:73)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:61)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:422)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1796)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:61)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:37)\n        at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:270)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:169)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:164)\n        ... 14 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:338)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:259)\n        ... 16 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Unexpected exception: null\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:318)\n        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:815)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.internalForward(CommonJoinOperator.java:642)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.createForwardJoinObject(CommonJoinOperator.java:437)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:529)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:526)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genJoinObject(CommonJoinOperator.java:455)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.checkAndGenObject(CommonJoinOperator.java:761)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinObject(CommonMergeJoinOperator.java:248)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinOneGroup(CommonMergeJoinOperator.java:213)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.processOp(CommonMergeJoinOperator.java:196)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:329)\n        ... 17 more\nCaused by: java.lang.NullPointerException\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:257)\n        ... 28 more\n], TaskAttempt 3 failed, info=[Error: Error while running task ( failure ) : attempt_1494499520849_1063145_1_14_000013_3:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:187)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)\n        at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:370)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:73)\n        at org.apache.tez.runtime.task.TaskRunner2Callable$1.run(TaskRunner2Callable.java:61)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:422)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1796)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:61)\n        at org.apache.tez.runtime.task.TaskRunner2Callable.callInternal(TaskRunner2Callable.java:37)\n        at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:270)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordProcessor.run(ReduceRecordProcessor.java:169)\n        at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:164)\n        ... 14 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0) {\"key\":{\"reducesinkkey0\":\"0002991000585141671\"},\"value\":{\"_col0\":\"\",\"_col1\":\"\"}}\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:338)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource.pushRecord(ReduceRecordSource.java:259)\n        ... 16 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Unexpected exception: null\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:318)\n        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:815)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.internalForward(CommonJoinOperator.java:642)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.createForwardJoinObject(CommonJoinOperator.java:437)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:529)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genObject(CommonJoinOperator.java:526)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.genJoinObject(CommonJoinOperator.java:455)\n        at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.checkAndGenObject(CommonJoinOperator.java:761)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinObject(CommonMergeJoinOperator.java:248)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.joinOneGroup(CommonMergeJoinOperator.java:213)\n        at org.apache.hadoop.hive.ql.exec.CommonMergeJoinOperator.processOp(CommonMergeJoinOperator.java:196)\n        at org.apache.hadoop.hive.ql.exec.tez.ReduceRecordSource$GroupIterator.next(ReduceRecordSource.java:329)\n        ... 17 more\nCaused by: java.lang.NullPointerException\n        at org.apache.hadoop.hive.ql.exec.MapJoinOperator.processOp(MapJoinOperator.java:257)\n        ... 28 more\n]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:314, Vertex vertex_1494499520849_1063145_1_14 [Reducer 11] killed/failed due to:OWN_TASK_FAILURE]\nVertex killed, vertexName=Map 1, vertexId=vertex_1494499520849_1063145_1_11, diagnostics=[Vertex received Kill while in RUNNING state., Vertex did not succeed due to OTHER_VERTEX_FAILURE, failedTasks:0 killedTasks:1, Vertex vertex_1494499520849_1063145_1_11 [Map 1] killed/failed due to:OTHER_VERTEX_FAILURE]\nVertex killed, vertexName=Reducer 2, vertexId=vertex_1494499520849_1063145_1_15, diagnostics=[Vertex received Kill while in RUNNING state., Vertex did not succeed due to OTHER_VERTEX_FAILURE, failedTasks:0 killedTasks:315, Vertex vertex_1494499520849_1063145_1_15 [Reducer 2] killed/failed due to:OTHER_VERTEX_FAILURE]\nDAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:2\nFAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.tez.TezTask","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"hive use tez engine occur org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row (tag=0)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xujie19852006","name":"xujie19852006","key":"xujie19852006","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xujie","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xujie19852006","name":"xujie19852006","key":"xujie19852006","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xujie","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"hive version:1.1.0\ntez version:0.85\nhadoop version:hadoop2.6 -cdh-5.10.0","customfield_12313520":null,"customfield_12311020":null,"duedate":"2017-06-27","customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13082676/comment/16064053","id":"16064053","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xujie19852006","name":"xujie19852006","key":"xujie19852006","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xujie","active":true,"timeZone":"Etc/UTC"},"body":"set hive.execution.engine=tez;\nWITH TEMP_S02_CARD_DATE_H AS\n(SELECT\nCARD_NBR AS CARD_NUM\n,MIN(CARD_ACTIVE_DATE) AS CARD_ACTIVE_DATE\n,MAX(DATE_ONE_ACTIVE) AS DATE_ONE_ACTIVE\n,MAX(DATE_EXPIRE) AS DATE_EXPIRE\n--FROM MID.FS_VP_AMED_CUR\nFROM BASE.VP_AMED\nWHERE DT = '20170604'\nGROUP BY CARD_NBR\n)\n,\n– 卡片信息\nTMP_CREDIT_CARD_01 AS\n(SELECT\nPOST_TO_ACCT AS POST_TO_ACCT – 对应帐户的帐号\n,CARD_NBR AS CARD_NBR – 卡号\n,ORG AS ORG – 币种\n,USER_CODE_2 AS USER_CODE_2 – 是否该帐户第一张卡标志\n,DATE_EXPIRE AS DATE_EXPIRE – 卡片到期日\n,BLOCK_CODE AS BLOCK_CODE – BLOCK_CODE\n,CARD_ACTIVE_DATE AS CARD_ACTIVE_DATE – 卡片激活日期\n,DATE_ONE_ACTIVE AS DATE_ONE_ACTIVE – 一帐通激活日期\n,LOGO AS LOGO – TYPE卡种卡类\n,CARD_STATUS_CD AS CARD_STATUS_CD – 卡状态代码\n,FIRST_CARD_VERIFY_DATE AS FIRST_CARD_VERIFY_DATE – 可激活日期 --20130914\n--,ROW_NUMBER() OVER(PARTITION BY POST_TO_ACCT ORDER BY APPLICATION_NO) AS CARD_SEQ\nFROM(SELECT\nE1.POST_TO_ACCT AS POST_TO_ACCT\n,E1.CARD_NBR AS CARD_NBR\n,E1.ORG AS ORG\n,E1.USER_CODE_2 AS USER_CODE_2\n,E1.USER_3 AS APPLICATION_NO\n,E3.DATE_EXPIRE AS DATE_EXPIRE\n,E1.BLOCK_CODE AS BLOCK_CODE\n,E3.CARD_ACTIVE_DATE AS CARD_ACTIVE_DATE\n,E3.DATE_ONE_ACTIVE AS DATE_ONE_ACTIVE\n,E1.LOGO AS LOGO\n,E1.CURR_FIRST_USAGE_FLAG AS CARD_STATUS_CD\n,E1.DATE_FIRST_CARD_VERIFY AS FIRST_CARD_VERIFY_DATE\n--FROM MID.FS_VP_AMED_CUR E1\nFROM BASE.VP_AMED E1\nLEFT JOIN TEMP_S02_CARD_DATE_H E3\nON E1.CARD_NBR = E3.CARD_NUM\nWHERE E1.DT = '20170604'\n) T\n)\n,\n– 注销账户判断\nTEMP_ACCT_WRITE_OFF AS\n(SELECT\nACCT\n,CASE WHEN SUM(IND) > 0\nTHEN 1\nELSE 0\nEND AS PASS_WRITE_OFF_IND\n--账户双边每边至少有一个BLOCK CODE为B,Q,A,M,S之一\nFROM\n(SELECT\nACCT\n,CASE WHEN SUM(IND) >= 1 THEN 1\nELSE 0\nEND AS IND\nFROM(SELECT\nACCT\n,ORG\n,CASE WHEN (BLOCK_CODE_1 IN ('B','Q','A','M','S') OR BLOCK_CODE_2 IN ('B','Q','A','M','S')) THEN 1\nELSE 0\nEND AS IND\nFROM BASE.VP_AMBS_TMP_CREDIT_ACCT_H_01\nWHERE DT = '20170604'\n) T\nGROUP BY ACCT\nUNION ALL\n--卡片存在X\nSELECT\nACCT\n,CASE WHEN SUM(CARD_NBR_SUM) >= 1 THEN 1\nELSE 0\nEND AS IND\nFROM(SELECT\nPOST_TO_ACCT AS ACCT\n,SUM(CASE WHEN COALESCE(BLOCK_CODE,'') ='X' THEN 1\nELSE 0\nEND) AS CARD_NBR_SUM\nFROM TMP_CREDIT_CARD_01\nGROUP BY POST_TO_ACCT) T\nGROUP BY ACCT\n) T\nGROUP BY ACCT)\n,\n--取账单日和下一账单日\nTEMP_STMT_DATE AS\n(SELECT\nF1.ACCT AS ACCOUNT_NUM\n,F1.ORG AS ACCOUNT_MODIFIER_NUM\n,MAX(CASE WHEN F1.DATE_LAST_CYCLE IS NOT NULL THEN F1.DATE_LAST_CYCLE\nELSE CONCAT('201705',F1.BILLING_CYCLE)\nEND) AS STMT_DATE --账单日\n,MAX(CONCAT('201706',F1.BILLING_CYCLE)) AS NEXT_STMT_DATE --下一账单日\nFROM BASE.VP_AMBS F1 --取上个月的\nWHERE F1.DT = '20170531'\nGROUP BY F1.ACCT,F1.ORG\n)\n,\nTMP_CREDIT_ACCT_H_G1 AS\n(SELECT\nACCT\n,COALESCE(BLOCK_CODE_1,' ') AS BLOCK_CODE_1\n,COALESCE(BLOCK_CODE_2,' ') AS BLOCK_CODE_2\n,BLOCK_CODE_1_SET_DATE AS BLOCK_CODE_1_SET_DATE\n,BLOCK_CODE_2_SET_DATE AS BLOCK_CODE_2_SET_DATE\n,CUST_TYPE\nFROM BASE.VP_AMBS_TMP_CREDIT_ACCT_H_01\nWHERE DT = '20170604' \nAND ORG = '242'\n)\n,\nTMP_CREDIT_ACCT_H_G2 AS\n(SELECT\nACCT\n,COALESCE(BLOCK_CODE_1,' ') AS BLOCK_CODE_1\n,CASE WHEN BLOCK_CODE_2 = 'Z' AND COALESCE(BLOCK_CODE_2_MEMO,' ') IN ('UCF','CUCF')\nTHEN ' ' – 美元边需要将z+ucf/cucf的block_code变为' '\nELSE COALESCE(BLOCK_CODE_2,' ')\nEND AS BLOCK_CODE_2\n,BLOCK_CODE_1_SET_DATE AS BLOCK_CODE_1_SET_DATE\n,BLOCK_CODE_2_SET_DATE AS BLOCK_CODE_2_SET_DATE\n,CUST_TYPE\nFROM BASE.VP_AMBS_TMP_CREDIT_ACCT_H_01\nWHERE DT = '20170604'\nAND ORG = '241'\n)\n,\n– 汇总双边账户的block_code\nTMP_CREDIT_ACCT_H_04 AS\n(SELECT\nG1.ACCT\n,G1.BLOCK_CODE_1 AS BLOCK_CODE_1 – 人民币边block_code_1\n,coalesce(G3.PRI,0) AS PRI_1 – 人民币边block_code_1的优先级\n,coalesce(G1.BLOCK_CODE_1_SET_DATE,'29991231') AS BLOCK_CODE_1_SET_DATE – 人民币边Block_Code_1_Set_Date\n,G1.BLOCK_CODE_2 AS BLOCK_CODE_2 – 人民币边block_code_2\n,coalesce(G4.PRI,0) AS PRI_2 – 人民币边block_code_2的优先级\n,coalesce(G1.BLOCK_CODE_2_SET_DATE,'29991231') AS BLOCK_CODE_2_SET_DATE – 人民币边Block_Code_2_Set_Date\n,G2.BLOCK_CODE_1 AS BLOCK_CODE_3 – 美元边block_code_1\n,coalesce(G5.PRI,0) AS PRI_3 – 美元边block_code_1的优先级\n,coalesce(G2.BLOCK_CODE_1_SET_DATE,'29991231') AS BLOCK_CODE_3_SET_DATE – 美元边Block_Code_1_Set_Date\n,G2.BLOCK_CODE_2 AS BLOCK_CODE_4 – 美元边block_code_2\n,coalesce(G6.PRI,0) AS PRI_4 – 美元边block_code_2的优先级\n,coalesce(G2.BLOCK_CODE_2_SET_DATE,'29991231') AS BLOCK_CODE_4_SET_DATE – 美元边Block_Code_2_Set_Date\n,G1.CUST_TYPE AS CUST_TYPE_1 – 纯费用标志客户类型\n,G2.CUST_TYPE AS CUST_TYPE_2 – 纯费用标志客户类型\nFROM TMP_CREDIT_ACCT_H_G1 G1\nLEFT JOIN TMP_CREDIT_ACCT_H_G2 G2\nON G1.ACCT = G2.ACCT\nLEFT JOIN DIM.CCM_CODE_CFG_BLOCK_CODE G3\nON COALESCE(G1.BLOCK_CODE_1,' ') = COALESCE(G3.BLOCK_CODE,' ')\nLEFT JOIN DIM.CCM_CODE_CFG_BLOCK_CODE G4\nON COALESCE(G1.BLOCK_CODE_2,' ') = COALESCE(G4.BLOCK_CODE,' ')\nLEFT JOIN DIM.CCM_CODE_CFG_BLOCK_CODE G5\nON COALESCE(G2.BLOCK_CODE_1,' ') = COALESCE(G5.BLOCK_CODE,' ')\nLEFT JOIN DIM.CCM_CODE_CFG_BLOCK_CODE G6\nON COALESCE(G2.BLOCK_CODE_2,' ') = COALESCE(G6.BLOCK_CODE,' ')\n),\nTEMP_TMP_CREDIT_ACCT_H_04_1 AS (\nSELECT\nACCT\n,'242' AS ORG\n,T2.BLOCK_CODE AS BLOCK_CODE\n,BLOCK_CODE_1_SET_DATE AS DATE_BLOCK_CODE\nFROM(\nSELECT\nACCT\n,CASE WHEN PRI_1 = PRI_2 THEN PRI_1\nWHEN PRI_1 > PRI_2 THEN PRI_1\nWHEN PRI_1 < PRI_2 THEN PRI_2\nEND AS PRI_1\n,CASE WHEN PRI_1 = PRI_2 THEN LEAST(BLOCK_CODE_1_SET_DATE,BLOCK_CODE_2_SET_DATE)\nWHEN PRI_1 > PRI_2 THEN BLOCK_CODE_1_SET_DATE\nWHEN PRI_1 < PRI_2 THEN BLOCK_CODE_2_SET_DATE\nEND AS BLOCK_CODE_1_SET_DATE\nFROM TMP_CREDIT_ACCT_H_04\n) T1\nLEFT JOIN DIM.CCM_CODE_CFG_BLOCK_CODE T2\nON T1.PRI_1 = T2.PRI),\nUNION ALL\nSELECT\nACCT\n,'241' AS ORG\n,T2.BLOCK_CODE AS BLOCK_CODE\n,BLOCK_CODE_2_SET_DATE AS DATE_BLOCK_CODE\nFROM(SELECT\nACCT\n,CASE WHEN PRI_3 = PRI_4\nTHEN PRI_3\nWHEN PRI_3 > PRI_4\nTHEN PRI_3\nWHEN PRI_3 < PRI_4\nTHEN PRI_4\nEND AS PRI_2\n,CASE WHEN PRI_3 = PRI_4\nTHEN LEAST(BLOCK_CODE_3_SET_DATE,BLOCK_CODE_4_SET_DATE)\nWHEN PRI_3 > PRI_4\nTHEN BLOCK_CODE_3_SET_DATE\nWHEN PRI_3 < PRI_4\nTHEN BLOCK_CODE_4_SET_DATE\nEND AS BLOCK_CODE_2_SET_DATE\nFROM TMP_CREDIT_ACCT_H_04) T1\nLEFT JOIN DIM.CCM_CODE_CFG_BLOCK_CODE T2\nON T1.PRI_2 = T2.PRI\nwhen i don‘t use union all ，the query can exec right；","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xujie19852006","name":"xujie19852006","key":"xujie19852006","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xujie","active":true,"timeZone":"Etc/UTC"},"created":"2017-06-27T00:52:16.101+0000","updated":"2017-06-27T00:52:16.101+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13082676/comment/16064319","id":"16064319","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"body":"This looks like a duplicate of HIVE-9832, please confirm with an explain plan.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-06-27T05:56:42.945+0000","updated":"2017-06-27T05:56:42.945+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13082676/comment/16064439","id":"16064439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xujie19852006","name":"xujie19852006","key":"xujie19852006","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xujie","active":true,"timeZone":"Etc/UTC"},"body":"STAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-0 depends on stages: Stage-1\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Tez\n      Edges:\n        Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 12 (SIMPLE_EDGE), Map 13 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Map 15 (BROADCAST_EDGE), Map 16 (BROADCAST_EDGE), Map 17 (BROADCAST_EDGE), Union 3 (CONTAINS)\n        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Union 3 (CONTAINS)\n      DagName: hadoop_20170627161010_072d8ca5-d7c5-4048-aeab-4683f226d56f:1\n      Vertices:\n        Map 1 \n            Map Operator Tree:\n                TableScan\n                  alias: vp_ambs_tmp_credit_acct_h_01\n                  Statistics: Num rows: 47016953 Data size: 80577838747 Basic stats: COMPLETE Column stats: NONE\n                  Filter Operator\n                    predicate: (org = '242') (type: boolean)\n                    Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                    Select Operator\n                      expressions: acct (type: string), COALESCE(block_code_1,' ') (type: string), COALESCE(block_code_2,' ') (type: string), block_code_1_set_date (type: string), block_code_2_set_date (type: string)\n                      outputColumnNames: _col0, _col1, _col2, _col3, _col4\n                      Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                      Reduce Output Operator\n                        key expressions: _col0 (type: string)\n                        sort order: +\n                        Map-reduce partition columns: _col0 (type: string)\n                        Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                        value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)\n        Map 10 \n            Map Operator Tree:\n                TableScan\n                  alias: vp_ambs_tmp_credit_acct_h_01\n                  Statistics: Num rows: 47016953 Data size: 80577838747 Basic stats: COMPLETE Column stats: NONE\n                  Filter Operator\n                    predicate: (org = '242') (type: boolean)\n                    Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                    Select Operator\n                      expressions: acct (type: string), COALESCE(block_code_1,' ') (type: string), COALESCE(block_code_2,' ') (type: string)\n                      outputColumnNames: _col0, _col1, _col2\n                      Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                      Reduce Output Operator\n                        key expressions: _col0 (type: string)\n                        sort order: +\n                        Map-reduce partition columns: _col0 (type: string)\n                        Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                        value expressions: _col1 (type: string), _col2 (type: string)\n        Map 12 \n            Map Operator Tree:\n                TableScan\n                  alias: vp_ambs_tmp_credit_acct_h_01\n                  Statistics: Num rows: 47016953 Data size: 80577838747 Basic stats: COMPLETE Column stats: NONE\n                  Filter Operator\n                    predicate: (org = '241') (type: boolean)\n                    Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                    Select Operator\n                      expressions: acct (type: string), COALESCE(block_code_1,' ') (type: string), CASE WHEN (((block_code_2 = 'Z') and (COALESCE(block_code_2_memo,' ')) IN ('UCF', 'CUCF'))) THEN (' ') ELSE (COALESCE(block_code_2,' ')) END (type: string), block_code_1_set_date (type: string), block_code_2_set_date (type: string)\n                      outputColumnNames: _col0, _col1, _col2, _col3, _col4\n                      Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                      Reduce Output Operator\n                        key expressions: _col0 (type: string)\n                        sort order: +\n                        Map-reduce partition columns: _col0 (type: string)\n                        Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                        value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)\n        Map 13 \n            Map Operator Tree:\n                TableScan\n                  alias: g3\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n        Map 14 \n            Map Operator Tree:\n                TableScan\n                  alias: g4\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n        Map 15 \n            Map Operator Tree:\n                TableScan\n                  alias: g5\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                    value expressions: pri (type: bigint)\n        Map 16 \n            Map Operator Tree:\n                TableScan\n                  alias: g6\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                    value expressions: pri (type: bigint)\n        Map 17 \n            Map Operator Tree:\n                TableScan\n                  alias: t2\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: pri (type: bigint)\n                    sort order: +\n                    Map-reduce partition columns: pri (type: bigint)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                    value expressions: block_code (type: string)\n        Map 4 \n            Map Operator Tree:\n                TableScan\n                  alias: vp_ambs_tmp_credit_acct_h_01\n                  Statistics: Num rows: 47016953 Data size: 80577838747 Basic stats: COMPLETE Column stats: NONE\n                  Filter Operator\n                    predicate: (org = '241') (type: boolean)\n                    Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                    Select Operator\n                      expressions: acct (type: string), COALESCE(block_code_1,' ') (type: string), CASE WHEN (((block_code_2 = 'Z') and (COALESCE(block_code_2_memo,' ')) IN ('UCF', 'CUCF'))) THEN (' ') ELSE (COALESCE(block_code_2,' ')) END (type: string)\n                      outputColumnNames: _col0, _col1, _col2\n                      Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                      Reduce Output Operator\n                        key expressions: _col0 (type: string)\n                        sort order: +\n                        Map-reduce partition columns: _col0 (type: string)\n                        Statistics: Num rows: 23508476 Data size: 40288918516 Basic stats: COMPLETE Column stats: NONE\n                        value expressions: _col1 (type: string), _col2 (type: string)\n        Map 5 \n            Map Operator Tree:\n                TableScan\n                  alias: g3\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                    value expressions: pri (type: bigint)\n        Map 6 \n            Map Operator Tree:\n                TableScan\n                  alias: g4\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                    value expressions: pri (type: bigint)\n        Map 7 \n            Map Operator Tree:\n                TableScan\n                  alias: g5\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n        Map 8 \n            Map Operator Tree:\n                TableScan\n                  alias: g6\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: COALESCE(block_code,' ') (type: string)\n                    sort order: +\n                    Map-reduce partition columns: COALESCE(block_code,' ') (type: string)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n        Map 9 \n            Map Operator Tree:\n                TableScan\n                  alias: t2\n                  Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                  Reduce Output Operator\n                    key expressions: pri (type: bigint)\n                    sort order: +\n                    Map-reduce partition columns: pri (type: bigint)\n                    Statistics: Num rows: 22 Data size: 4158 Basic stats: COMPLETE Column stats: NONE\n                    value expressions: block_code (type: string)\n        Reducer 11 \n            Reduce Operator Tree:\n              Merge Join Operator\n                condition map:\n                     Left Outer Join0 to 1\n                keys:\n                  0 _col0 (type: string)\n                  1 _col0 (type: string)\n                outputColumnNames: _col0, _col1, _col2, _col7, _col8, _col9, _col10\n                Statistics: Num rows: 25859324 Data size: 44317811328 Basic stats: COMPLETE Column stats: NONE\n                Map Join Operator\n                  condition map:\n                       Left Outer Join0 to 1\n                  keys:\n                    0 COALESCE(_col1,' ') (type: string)\n                    1 COALESCE(block_code,' ') (type: string)\n                  outputColumnNames: _col0, _col2, _col7, _col8, _col9, _col10\n                  input vertices:\n                    1 Map 13\n                  Statistics: Num rows: 28445257 Data size: 48749593517 Basic stats: COMPLETE Column stats: NONE\n                  Map Join Operator\n                    condition map:\n                         Left Outer Join0 to 1\n                    keys:\n                      0 COALESCE(_col2,' ') (type: string)\n                      1 COALESCE(block_code,' ') (type: string)\n                    outputColumnNames: _col0, _col7, _col8, _col9, _col10\n                    input vertices:\n                      1 Map 14\n                    Statistics: Num rows: 31289783 Data size: 53624554030 Basic stats: COMPLETE Column stats: NONE\n                    Map Join Operator\n                      condition map:\n                           Left Outer Join0 to 1\n                      keys:\n                        0 COALESCE(_col7,' ') (type: string)\n                        1 COALESCE(block_code,' ') (type: string)\n                      outputColumnNames: _col0, _col8, _col9, _col10, _col26\n                      input vertices:\n                        1 Map 15\n                      Statistics: Num rows: 34418762 Data size: 58987010711 Basic stats: COMPLETE Column stats: NONE\n                      Map Join Operator\n                        condition map:\n                             Left Outer Join0 to 1\n                        keys:\n                          0 COALESCE(_col8,' ') (type: string)\n                          1 COALESCE(block_code,' ') (type: string)\n                        outputColumnNames: _col0, _col9, _col10, _col26, _col32\n                        input vertices:\n                          1 Map 16\n                        Statistics: Num rows: 37860639 Data size: 64885713188 Basic stats: COMPLETE Column stats: NONE\n                        Select Operator\n                          expressions: _col0 (type: string), COALESCE(_col26,0) (type: bigint), COALESCE(_col32,0) (type: bigint), COALESCE(_col9,'29991231') (type: string), COALESCE(_col10,'29991231') (type: string)\n                          outputColumnNames: _col0, _col8, _col11, _col9, _col12\n                          Statistics: Num rows: 37860639 Data size: 64885713188 Basic stats: COMPLETE Column stats: NONE\n                          Select Operator\n                            expressions: _col0 (type: string), CASE WHEN ((_col8 = _col11)) THEN (_col8) WHEN ((_col8 > _col11)) THEN (_col8) WHEN ((_col8 < _col11)) THEN (_col11) END (type: bigint), CASE WHEN ((_col8 = _col11)) THEN (least(_col9,_col12)) WHEN ((_col8 > _col11)) THEN (_col9) WHEN ((_col8 < _col11)) THEN (_col12) END (type: string)\n                            outputColumnNames: _col0, _col1, _col2\n                            Statistics: Num rows: 37860639 Data size: 64885713188 Basic stats: COMPLETE Column stats: NONE\n                            Map Join Operator\n                              condition map:\n                                   Left Outer Join0 to 1\n                              keys:\n                                0 _col1 (type: bigint)\n                                1 pri (type: bigint)\n                              outputColumnNames: _col0, _col2, _col3\n                              input vertices:\n                                1 Map 17\n                              Statistics: Num rows: 41646703 Data size: 71374286053 Basic stats: COMPLETE Column stats: NONE\n                              Select Operator\n                                expressions: _col0 (type: string), '241' (type: string), _col3 (type: string), _col2 (type: string)\n                                outputColumnNames: _col0, _col1, _col2, _col3\n                                Statistics: Num rows: 41646703 Data size: 71374286053 Basic stats: COMPLETE Column stats: NONE\n                                File Output Operator\n                                  compressed: false\n                                  Statistics: Num rows: 83293406 Data size: 142748572106 Basic stats: COMPLETE Column stats: NONE\n                                  table:\n                                      input format: org.apache.hadoop.mapred.TextInputFormat\n                                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n        Reducer 2 \n            Reduce Operator Tree:\n              Merge Join Operator\n                condition map:\n                     Left Outer Join0 to 1\n                keys:\n                  0 _col0 (type: string)\n                  1 _col0 (type: string)\n                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col7, _col8\n                Statistics: Num rows: 25859324 Data size: 44317811328 Basic stats: COMPLETE Column stats: NONE\n                Map Join Operator\n                  condition map:\n                       Left Outer Join0 to 1\n                  keys:\n                    0 COALESCE(_col1,' ') (type: string)\n                    1 COALESCE(block_code,' ') (type: string)\n                  outputColumnNames: _col0, _col2, _col3, _col4, _col7, _col8, _col14\n                  input vertices:\n                    1 Map 5\n                  Statistics: Num rows: 28445257 Data size: 48749593517 Basic stats: COMPLETE Column stats: NONE\n                  Map Join Operator\n                    condition map:\n                         Left Outer Join0 to 1\n                    keys:\n                      0 COALESCE(_col2,' ') (type: string)\n                      1 COALESCE(block_code,' ') (type: string)\n                    outputColumnNames: _col0, _col3, _col4, _col7, _col8, _col14, _col20\n                    input vertices:\n                      1 Map 6\n                    Statistics: Num rows: 31289783 Data size: 53624554030 Basic stats: COMPLETE Column stats: NONE\n                    Map Join Operator\n                      condition map:\n                           Left Outer Join0 to 1\n                      keys:\n                        0 COALESCE(_col7,' ') (type: string)\n                        1 COALESCE(block_code,' ') (type: string)\n                      outputColumnNames: _col0, _col3, _col4, _col8, _col14, _col20\n                      input vertices:\n                        1 Map 7\n                      Statistics: Num rows: 34418762 Data size: 58987010711 Basic stats: COMPLETE Column stats: NONE\n                      Map Join Operator\n                        condition map:\n                             Left Outer Join0 to 1\n                        keys:\n                          0 COALESCE(_col8,' ') (type: string)\n                          1 COALESCE(block_code,' ') (type: string)\n                        outputColumnNames: _col0, _col3, _col4, _col14, _col20\n                        input vertices:\n                          1 Map 8\n                        Statistics: Num rows: 37860639 Data size: 64885713188 Basic stats: COMPLETE Column stats: NONE\n                        Select Operator\n                          expressions: _col0 (type: string), COALESCE(_col14,0) (type: bigint), COALESCE(_col20,0) (type: bigint), COALESCE(_col3,'29991231') (type: string), COALESCE(_col4,'29991231') (type: string)\n                          outputColumnNames: _col0, _col2, _col5, _col3, _col6\n                          Statistics: Num rows: 37860639 Data size: 64885713188 Basic stats: COMPLETE Column stats: NONE\n                          Select Operator\n                            expressions: _col0 (type: string), CASE WHEN ((_col2 = _col5)) THEN (_col2) WHEN ((_col2 > _col5)) THEN (_col2) WHEN ((_col2 < _col5)) THEN (_col5) END (type: bigint), CASE WHEN ((_col2 = _col5)) THEN (least(_col3,_col6)) WHEN ((_col2 > _col5)) THEN (_col3) WHEN ((_col2 < _col5)) THEN (_col6) END (type: string)\n                            outputColumnNames: _col0, _col1, _col2\n                            Statistics: Num rows: 37860639 Data size: 64885713188 Basic stats: COMPLETE Column stats: NONE\n                            Map Join Operator\n                              condition map:\n                                   Left Outer Join0 to 1\n                              keys:\n                                0 _col1 (type: bigint)\n                                1 pri (type: bigint)\n                              outputColumnNames: _col0, _col2, _col3\n                              input vertices:\n                                1 Map 9\n                              Statistics: Num rows: 41646703 Data size: 71374286053 Basic stats: COMPLETE Column stats: NONE\n                              Select Operator\n                                expressions: _col0 (type: string), '242' (type: string), _col3 (type: string), _col2 (type: string)\n                                outputColumnNames: _col0, _col1, _col2, _col3\n                                Statistics: Num rows: 41646703 Data size: 71374286053 Basic stats: COMPLETE Column stats: NONE\n                                File Output Operator\n                                  compressed: false\n                                  Statistics: Num rows: 83293406 Data size: 142748572106 Basic stats: COMPLETE Column stats: NONE\n                                  table:\n                                      input format: org.apache.hadoop.mapred.TextInputFormat\n                                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n        Union 3 \n            Vertex: Union 3\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n      Processor Tree:\n        ListSink","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xujie19852006","name":"xujie19852006","key":"xujie19852006","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"xujie","active":true,"timeZone":"Etc/UTC"},"created":"2017-06-27T08:11:20.642+0000","updated":"2017-06-27T08:11:20.642+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-16967/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3gref:"}}