{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12498804","self":"https://issues.apache.org/jira/rest/api/2/issue/12498804","key":"HIVE-1996","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2011-05-19T14:08:19.336+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Apr 07 18:52:05 UTC 2014","customfield_12310420":"35814","customfield_12312320":null,"customfield_12310222":"10002_*:*_3_*:*_82130727312_*|*_1_*:*_3_*:*_16878335298_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-04-07T18:52:05.396+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-1996/watchers","watchCount":5,"isWatching":false},"created":"2011-02-16T20:21:02.816+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315150","id":"12315150","description":"released","name":"0.7.0","archived":false,"released":true,"releaseDate":"2011-03-29"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12319268","id":"12319268","description":"released","name":"0.8.1","archived":false,"released":true,"releaseDate":"2012-02-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-04-07T18:52:05.423+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Steps:\n\n1. From the command line copy the kv2.txt data file into the current user's HDFS directory:\n\n{{$ hadoop fs -copyFromLocal /path/to/hive/sources/data/files/kv2.txt kv2.txt}}\n\n2. In Hive, create the table:\n\n{{create table tst_src1 (key_ int, value_ string);}}\n\n3. Load the data into the table from HDFS:\n\n{{load data inpath './kv2.txt' into table tst_src1;}}\n\n4. Repeat step 1\n5. Repeat step 3\n\nExpected:\n\nTo have kv2.txt renamed in HDFS and then copied to the destination as per HIVE-307.\n\nActual:\n\nFile is renamed, but {{Hive.copyFiles}} doesn't \"see\" the change in {{srcs}} as it continues to use the same array elements (with the un-renamed, old file names). It crashes with this error:\n\n{noformat}\njava.lang.NullPointerException\n    at org.apache.hadoop.hive.ql.metadata.Hive.copyFiles(Hive.java:1725)\n    at org.apache.hadoop.hive.ql.metadata.Table.copyFiles(Table.java:541)\n    at org.apache.hadoop.hive.ql.metadata.Hive.loadTable(Hive.java:1173)\n    at org.apache.hadoop.hive.ql.exec.MoveTask.execute(MoveTask.java:197)\n    at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:130)\n    at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)\n    at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1060)\n    at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:897)\n    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:745)\n    at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:164)\n    at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:241)\n    at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:456)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.apache.hadoop.util.RunJar.main(RunJar.java:156)\n{noformat}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12491240","id":"12491240","filename":"HIVE-1996.1.Patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-08-22T18:25:20.670+0000","size":28131,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12491240/HIVE-1996.1.Patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12503097","id":"12503097","filename":"HIVE-1996.2.Patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-09T16:43:13.220+0000","size":13817,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12503097/HIVE-1996.2.Patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12479770","id":"12479770","filename":"HIVE-1996.Patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-05-19T13:32:09.344+0000","size":9217,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12479770/HIVE-1996.Patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123556","customfield_12312823":null,"summary":"\"LOAD DATA INPATH\" fails when the table already contains a file of the same name","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kirktrue","name":"kirktrue","key":"kirktrue","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kirktrue&avatarId=33527","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kirktrue&avatarId=33527","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kirktrue&avatarId=33527","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kirktrue&avatarId=33527"},"displayName":"Kirk True","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kirktrue","name":"kirktrue","key":"kirktrue","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kirktrue&avatarId=33527","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kirktrue&avatarId=33527","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kirktrue&avatarId=33527","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kirktrue&avatarId=33527"},"displayName":"Kirk True","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/12995499","id":"12995499","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kirktrue","name":"kirktrue","key":"kirktrue","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kirktrue&avatarId=33527","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kirktrue&avatarId=33527","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kirktrue&avatarId=33527","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kirktrue&avatarId=33527"},"displayName":"Kirk True","active":true,"timeZone":"America/Los_Angeles"},"body":"This is very closely related to, but not the same as, HIVE-307. That bug specifically pertains to {{LOCAL}} files.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kirktrue","name":"kirktrue","key":"kirktrue","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kirktrue&avatarId=33527","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kirktrue&avatarId=33527","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kirktrue&avatarId=33527","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kirktrue&avatarId=33527"},"displayName":"Kirk True","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-02-16T20:24:21.414+0000","updated":"2011-02-16T20:24:21.414+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13036197","id":"13036197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"After file name got changed it is trying to load with the old name because of this load is failed. \nNow we have changed the code like,  load with the changed filename  for that introduced a map it will maintain  the old name and changed filename as  key  value pair  and  while loading need to use this map.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-05-19T14:08:19.336+0000","updated":"2011-05-19T14:08:19.336+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13061622","id":"13061622","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"body":"I tried running the test, but it fails for me.  I looked in hive.log and found\n\n{noformat}\n2011-07-07 14:45:34,359 ERROR hive.log (MetaStoreUtils.java:logAndThrowMetaException(778)) - java.io.FileNotFoundException: File file:/tmp1/load2_overwrite2 does not exist.\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-07T21:52:51.126+0000","updated":"2011-07-07T21:52:51.126+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13088903","id":"13088903","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"This scenario will work if load from local but it will fail if loading from File-system. To replicate this scenarios i have used this queries \"create table load_overwrite2 (key string, value string) stored as textfile location 'file:/tmp1/load2_overwrite2';\" so as part of this query execution it should create this \"file:/tmp1/load2_overwrite2\". I have verified this in my environment it is working without fail. Pls let me know if any issues.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-08-22T18:31:28.138+0000","updated":"2011-08-22T18:31:28.138+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13088911","id":"13088911","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/1610/\n-----------------------------------------------------------\n\nReview request for hive, Carl Steinbach and John Sichi.\n\n\nSummary\n-------\n\n\"LOAD DATA INPATH\" fails when the table already contains a file of the same name. If any name confilcts occurs it will rename the file, After file name got changed it is trying to load with the old name because of this load is failed. Now we have changed the code like, load with the changed filename for that introduced a map it will maintain the old name and changed filename as key value pair and while loading need to use this map.\n\n\nThis addresses bug HIVE-1996.\n    https://issues.apache.org/jira/browse/HIVE-1996\n\n\nDiffs\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1160102 \n  trunk/ql/src/test/queries/clientpositive/input44.q PRE-CREATION \n  trunk/ql/src/test/results/clientpositive/input44.q.out PRE-CREATION \n\nDiff: https://reviews.apache.org/r/1610/diff\n\n\nTesting\n-------\n\nAdded a test case for this scenario.\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-22T18:37:29.201+0000","updated":"2011-08-22T18:37:29.201+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13103155","id":"13103155","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=he+yongqiang","name":"he yongqiang","key":"he yongqiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"He Yongqiang","active":true,"timeZone":"Etc/UTC"},"body":"For this, we need to make the rename optional, and by default disabled. If disabled rename, should throw an error to user.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=he+yongqiang","name":"he yongqiang","key":"he yongqiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"He Yongqiang","active":true,"timeZone":"Etc/UTC"},"created":"2011-09-12T22:53:27.625+0000","updated":"2011-09-12T22:53:27.625+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13103814","id":"13103814","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"Agreed, I will update the patch with configuration.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-09-13T17:39:56.795+0000","updated":"2011-09-13T17:39:56.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13109247","id":"13109247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi He Yongqiang,\nHere these 2 scenarios need to consider\n1)If rename disabled  load one data folder that contains 10 files like 1.txt,2.txt...,10.txt   here in the table already one file present with same name 5.txt. While loading 5.txt it will throw the  exception and operation will fail but here already loaded file(1.txt,2.txt....4.txt) will present...\n\n 1.txt,2.txt...,10.txt   here in the table already one file present with same name 6.txt. While loading 6.txt it will throw the  exception and operation will fail but here already loaded file(1.txt,2.txt....4.txt,5.txt ) will present...\n\n\tSo its mainly dependent on the order and can cause inconsistencies.\n\n2)In the current implementation also \"org.apache.hadoop.hive.ql.metadata.Hive.copyFiles(Path, Path, FileSystem)\"  if any of the file it is unable to rename it will throw exception but for the same operation some file will be loaded.\n\nProposed Sol:  While loading if any exception comes note that file as unloaded file and continue the load with remaining files  and operation will fail with the exception and unloaded file information  so user can retry loading the unloaded files alone. Here there is no inconsistent data.\n\nPls give u r inputs","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-09-21T04:01:52.813+0000","updated":"2011-09-21T04:01:52.813+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13147146","id":"13147146","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/1610/\n-----------------------------------------------------------\n\n(Updated 2011-11-09 16:44:55.708392)\n\n\nReview request for hive, Carl Steinbach and John Sichi.\n\n\nChanges\n-------\n\nLoad rename made it configurable.\n\n\nSummary\n-------\n\n\"LOAD DATA INPATH\" fails when the table already contains a file of the same name. If any name confilcts occurs it will rename the file, After file name got changed it is trying to load with the old name because of this load is failed. Now we have changed the code like, load with the changed filename for that introduced a map it will maintain the old name and changed filename as key value pair and while loading need to use this map.\n\n\nThis addresses bug HIVE-1996.\n    https://issues.apache.org/jira/browse/HIVE-1996\n\n\nDiffs (updated)\n-----\n\n  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1198626 \n  trunk/conf/hive-default.xml 1198626 \n  trunk/data/conf/hive-site.xml 1198626 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1198626 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java 1198626 \n  trunk/ql/src/test/queries/clientpositive/input47.q PRE-CREATION \n  trunk/ql/src/test/results/clientpositive/input47.q.out PRE-CREATION \n\nDiff: https://reviews.apache.org/r/1610/diff\n\n\nTesting\n-------\n\nAdded a test case for this scenario.\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-09T16:45:51.415+0000","updated":"2011-11-09T16:45:51.415+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13166594","id":"13166594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"Yongqiang, can you take a look ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-12-09T21:44:01.548+0000","updated":"2011-12-09T21:44:01.548+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13858997","id":"13858997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antonbas","name":"antonbas","key":"antonbas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio Bastardo","active":true,"timeZone":"Etc/UTC"},"body":"Is this bug solved in hive-0.10.0_cdh4.2.0_20130411_1129?\nI'm having this behavior in this version.\nRegards","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=antonbas","name":"antonbas","key":"antonbas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Antonio Bastardo","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-30T19:03:36.855+0000","updated":"2013-12-30T19:03:36.855+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13859024","id":"13859024","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 no tests executed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12503097/HIVE-1996.2.Patch\n\nTest results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/772/testReport\nConsole output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/772/console\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nTests exited with: NonZeroExitCodeException\nCommand 'bash /data/hive-ptest/working/scratch/source-prep.sh' failed with exit status 1 and output '+ [[ -n '' ]]\n+ export 'ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m '\n+ ANT_OPTS='-Xmx1g -XX:MaxPermSize=256m '\n+ export 'M2_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128'\n+ M2_OPTS='-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128'\n+ cd /data/hive-ptest/working/\n+ tee /data/hive-ptest/logs/PreCommit-HIVE-Build-772/source-prep.txt\n+ [[ false == \\t\\r\\u\\e ]]\n+ mkdir -p maven ivy\n+ [[ svn = \\s\\v\\n ]]\n+ [[ -n '' ]]\n+ [[ -d apache-svn-trunk-source ]]\n+ [[ ! -d apache-svn-trunk-source/.svn ]]\n+ [[ ! -d apache-svn-trunk-source ]]\n+ cd apache-svn-trunk-source\n+ svn revert -R .\nReverted 'ql/src/java/org/apache/hadoop/hive/ql/DriverContext.java'\nReverted 'ql/src/java/org/apache/hadoop/hive/ql/exec/TaskRunner.java'\nReverted 'ql/src/java/org/apache/hadoop/hive/ql/Driver.java'\n++ awk '{print $2}'\n++ egrep -v '^X|^Performing status on external'\n++ svn status --no-ignore\n+ rm -rf target datanucleus.log ant/target shims/target shims/0.20/target shims/0.20S/target shims/0.23/target shims/aggregator/target shims/common/target shims/common-secure/target packaging/target hbase-handler/target testutils/target jdbc/target metastore/target itests/target itests/hcatalog-unit/target itests/test-serde/target itests/qtest/target itests/hive-unit/target itests/custom-serde/target itests/util/target hcatalog/target hcatalog/storage-handlers/hbase/target hcatalog/server-extensions/target hcatalog/core/target hcatalog/webhcat/svr/target hcatalog/webhcat/java-client/target hcatalog/hcatalog-pig-adapter/target hwi/target common/target common/src/gen contrib/target service/target serde/target beeline/target odbc/target cli/target ql/dependency-reduced-pom.xml ql/target\n+ svn update\nU    hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java\n\nFetching external item into 'hcatalog/src/test/e2e/harness'\nUpdated external to revision 1554298.\n\nUpdated to revision 1554298.\n+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh\n+ patchFilePath=/data/hive-ptest/working/scratch/build.patch\n+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]\n+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh\n+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch\nThe patch does not appear to apply with p0, p1, or p2\n+ exit 1\n'\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12503097","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2013-12-30T19:41:08.073+0000","updated":"2013-12-30T19:41:08.073+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12498804/comment/13962136","id":"13962136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"This issue is solved as part of HIVE-3300","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2014-04-07T18:52:05.417+0000","updated":"2014-04-07T18:52:05.417+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-1996/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lhxr:"}}