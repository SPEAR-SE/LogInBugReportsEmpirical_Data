{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13170289","self":"https://issues.apache.org/jira/rest/api/2/issue/13170289","key":"HIVE-20095","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-07-05T17:16:31.864+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jul 18 23:17:23 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20095/watchers","watchCount":5,"isWatching":false},"created":"2018-07-05T14:58:53.222+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12537846","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12537846","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"13129833","key":"HIVE-18423","self":"https://issues.apache.org/jira/rest/api/2/issue/13129833","fields":{"summary":"Support pushing computation from the optimizer for JDBC storage handler tables","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-07-18T23:49:44.145+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[],"timeoriginalestimate":null,"description":"It seems like the committed code for HIVE-19161 \r\n\r\n(7584b3276bebf64aa006eaa162c0a6264d8fcb56) reverted some of HIVE-18423 updates, and therefore some of the external table queries are not working correctly.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12343014","id":"12343014","description":"","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-07-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12343343","id":"12343343","name":"4.0.0","archived":false,"released":false}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12930404","id":"12930404","filename":"HIVE-20095.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-05T15:08:37.890+0000","size":9346,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12930404/HIVE-20095.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12930997","id":"12930997","filename":"HIVE-20095.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-10T12:48:19.878+0000","size":39622,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12930997/HIVE-20095.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12931132","id":"12931132","filename":"HIVE-20095.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-11T08:03:48.539+0000","size":42557,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12931132/HIVE-20095.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12931692","id":"12931692","filename":"HIVE-20095.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-15T08:51:38.633+0000","size":54272,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12931692/HIVE-20095.4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Fix jdbc external table feature","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16533913","id":"16533913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~daijy], it seems HIVE-19161 broke the integration with JDBC pushdown from Calcite side. Can you comment on this patch?\r\n\r\n[~msydoron], I did not see any test related to what was broken. Can you add tests to the patch? In addition, HIVE-19299 still needs to be addressed. Without proper testing coverage, this situation will continue repeating itself.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-07-05T17:16:31.864+0000","updated":"2018-07-05T17:16:31.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16534441","id":"16534441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  1m 46s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 21s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 16s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 46s{color} | {color:green} master passed {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  3m 54s{color} | {color:blue} ql in master has 2287 extant Findbugs warnings. {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m 21s{color} | {color:blue} jdbc-handler in master has 8 extant Findbugs warnings. {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  6s{color} | {color:green} master passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 23s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 37s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 15s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 15s{color} | {color:green} the patch passed {color} |\r\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red}  0m  9s{color} | {color:red} jdbc-handler: The patch generated 30 new + 17 unchanged - 2 fixed = 47 total (was 19) {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  0m 30s{color} | {color:red} jdbc-handler generated 3 new + 8 unchanged - 0 fixed = 11 total (was 8) {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  5s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 12s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 26m  3s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| FindBugs | module:jdbc-handler |\r\n|  |  Exception is caught when Exception is not thrown in org.apache.hive.storage.jdbc.JdbcSerDe.initialize(Configuration, Properties)  At JdbcSerDe.java:is not thrown in org.apache.hive.storage.jdbc.JdbcSerDe.initialize(Configuration, Properties)  At JdbcSerDe.java:[line 111] |\r\n|  |  org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnTypes(Configuration) may fail to clean up java.sql.ResultSet  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:up java.sql.ResultSet  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:[line 115] is not discharged |\r\n|  |  org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnTypes(Configuration) may fail to clean up java.sql.Statement  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:up java.sql.Statement  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:[line 114] is not discharged |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12416/dev-support/hive-personality.sh |\r\n| git revision | master / ef53d69 |\r\n| Default Java | 1.8.0_111 |\r\n| findbugs | v3.0.0 |\r\n| checkstyle | http://104.198.109.242/logs//PreCommit-HIVE-Build-12416/yetus/diff-checkstyle-jdbc-handler.txt |\r\n| findbugs | http://104.198.109.242/logs//PreCommit-HIVE-Build-12416/yetus/new-findbugs-jdbc-handler.html |\r\n| modules | C: ql jdbc-handler U: . |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12416/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-06T05:25:59.822+0000","updated":"2018-07-06T05:25:59.822+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16534491","id":"16534491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12930404/HIVE-20095.1.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 6 failed/errored test(s), 14642 tests executed\n*Failed tests:*\n{noformat}\nTestAutoPurgeTables - did not produce a TEST-*.xml file (likely timed out) (batchId=240)\nTestClearDanglingScratchDir - did not produce a TEST-*.xml file (likely timed out) (batchId=240)\nTestLocationQueries - did not produce a TEST-*.xml file (likely timed out) (batchId=240)\nTestSemanticAnalyzerHookLoading - did not produce a TEST-*.xml file (likely timed out) (batchId=240)\nTestSparkStatistics - did not produce a TEST-*.xml file (likely timed out) (batchId=240)\norg.apache.hadoop.hive.cli.TestBlobstoreCliDriver.testCliDriver[ptf_parquetfile] (batchId=264)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/12416/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/12416/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12416/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 6 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12930404 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-06T06:51:45.693+0000","updated":"2018-07-06T06:51:45.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16538440","id":"16538440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"body":"[~daijy] Can you also please explain your change in JdbcRecordIterator.java? \r\n\r\nI think that this change can cause many troubles when the columnTypes member is set. what was missing it the old code?\r\n\r\n \r\n\r\n[~jcamachorodriguez] Please take a look.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-10T11:37:57.180+0000","updated":"2018-07-10T11:37:57.180+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16538794","id":"16538794","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  1m 45s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 32s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 19s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 47s{color} | {color:green} master passed {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  3m 56s{color} | {color:blue} ql in master has 2287 extant Findbugs warnings. {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m 24s{color} | {color:blue} jdbc-handler in master has 8 extant Findbugs warnings. {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  9s{color} | {color:green} master passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 25s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 39s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 17s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 17s{color} | {color:green} the patch passed {color} |\r\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red}  0m  9s{color} | {color:red} jdbc-handler: The patch generated 31 new + 23 unchanged - 2 fixed = 54 total (was 25) {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  0m 30s{color} | {color:red} jdbc-handler generated 3 new + 8 unchanged - 0 fixed = 11 total (was 8) {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  4s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 12s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 26m 35s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| FindBugs | module:jdbc-handler |\r\n|  |  Exception is caught when Exception is not thrown in org.apache.hive.storage.jdbc.JdbcSerDe.initialize(Configuration, Properties)  At JdbcSerDe.java:is not thrown in org.apache.hive.storage.jdbc.JdbcSerDe.initialize(Configuration, Properties)  At JdbcSerDe.java:[line 111] |\r\n|  |  org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnTypes(Configuration) may fail to clean up java.sql.ResultSet  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:up java.sql.ResultSet  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:[line 115] is not discharged |\r\n|  |  org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnTypes(Configuration) may fail to clean up java.sql.Statement  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:up java.sql.Statement  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:[line 114] is not discharged |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12512/dev-support/hive-personality.sh |\r\n| git revision | master / 18fb1b3 |\r\n| Default Java | 1.8.0_111 |\r\n| findbugs | v3.0.0 |\r\n| checkstyle | http://104.198.109.242/logs//PreCommit-HIVE-Build-12512/yetus/diff-checkstyle-jdbc-handler.txt |\r\n| findbugs | http://104.198.109.242/logs//PreCommit-HIVE-Build-12512/yetus/new-findbugs-jdbc-handler.html |\r\n| modules | C: ql jdbc-handler itests U: . |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12512/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-10T15:37:51.573+0000","updated":"2018-07-10T15:37:51.573+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16538871","id":"16538871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12930997/HIVE-20095.2.patch\n\n{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 14623 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[external_jdbc_table] (batchId=9)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[resourceplan] (batchId=168)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[strict_managed_tables_sysdb] (batchId=169)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/12512/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/12512/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12512/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 3 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12930997 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-10T16:13:01.011+0000","updated":"2018-07-10T16:13:01.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16541023","id":"16541023","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n|| || || || {color:brown} master Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  1m 47s{color} | {color:blue} Maven dependency ordering for branch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 21s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 16s{color} | {color:green} master passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 45s{color} | {color:green} master passed {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  3m 54s{color} | {color:blue} ql in master has 2287 extant Findbugs warnings. {color} |\r\n| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  0m 22s{color} | {color:blue} jdbc-handler in master has 8 extant Findbugs warnings. {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  6s{color} | {color:green} master passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 25s{color} | {color:blue} Maven dependency ordering for patch {color} |\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 32s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m 15s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m 15s{color} | {color:green} the patch passed {color} |\r\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red}  0m 10s{color} | {color:red} jdbc-handler: The patch generated 30 new + 23 unchanged - 2 fixed = 53 total (was 25) {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  0m 30s{color} | {color:red} jdbc-handler generated 3 new + 8 unchanged - 0 fixed = 11 total (was 8) {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  5s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 12s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black} 25m 58s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| FindBugs | module:jdbc-handler |\r\n|  |  Exception is caught when Exception is not thrown in org.apache.hive.storage.jdbc.JdbcSerDe.initialize(Configuration, Properties)  At JdbcSerDe.java:is not thrown in org.apache.hive.storage.jdbc.JdbcSerDe.initialize(Configuration, Properties)  At JdbcSerDe.java:[line 111] |\r\n|  |  org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnTypes(Configuration) may fail to clean up java.sql.ResultSet  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:up java.sql.ResultSet  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:[line 115] is not discharged |\r\n|  |  org.apache.hive.storage.jdbc.dao.GenericJdbcDatabaseAccessor.getColumnTypes(Configuration) may fail to clean up java.sql.Statement  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:up java.sql.Statement  Obligation to clean up resource created at GenericJdbcDatabaseAccessor.java:[line 114] is not discharged |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |\r\n| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12542/dev-support/hive-personality.sh |\r\n| git revision | master / 19c2ec4 |\r\n| Default Java | 1.8.0_111 |\r\n| findbugs | v3.0.0 |\r\n| checkstyle | http://104.198.109.242/logs//PreCommit-HIVE-Build-12542/yetus/diff-checkstyle-jdbc-handler.txt |\r\n| findbugs | http://104.198.109.242/logs//PreCommit-HIVE-Build-12542/yetus/new-findbugs-jdbc-handler.html |\r\n| modules | C: ql jdbc-handler itests U: . |\r\n| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12542/yetus.txt |\r\n| Powered by | Apache Yetus    http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-12T02:04:33.513+0000","updated":"2018-07-12T02:04:33.513+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16541053","id":"16541053","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12931132/HIVE-20095.3.patch\n\n{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 14629 tests executed\n*Failed tests:*\n{noformat}\nTestMiniTezCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=105)\n\t[update_orig_table.q,explainanalyze_3.q,orc_vectorization_ppd.q,vector_non_string_partition.q,multi_count_distinct.q,explainanalyze_1.q,explainuser_3.q,explainanalyze_4.q,hybridgrace_hashjoin_1.q,delete_orig_table.q,hybridgrace_hashjoin_2.q,tez-tag.q,orc_merge12.q,explainanalyze_5.q,vector_join_part_col_char.q]\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[resourceplan] (batchId=168)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[strict_managed_tables_sysdb] (batchId=169)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/12542/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/12542/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12542/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.YetusPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 3 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12931132 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-12T02:41:11.363+0000","updated":"2018-07-12T02:41:11.363+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16541201","id":"16541201","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"body":"Haven't read through the patch but the motivation of the change in HIVE-19161 is to rely on table schema rather than ResultSet to determine the object type of the results. Same sql expression could be interpreted as different datatype in ResultSet for different databases, thus the result for the same expression could be different datatype for different database. Rely on table schema is more reliable. I don't remember a concrete example out of my head but there must be one inside hive-schema-3.1.0.hive.sql. I can find it if needed. I am not sure how this breaks PPD, is that \"hiveQueryExecution\" part in JdbcSerDe? If we can fix it and keep relying on table schema for result type, that should be fine for me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daijy","name":"daijy","key":"daijy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel Dai","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-07-12T06:19:12.025+0000","updated":"2018-07-12T06:26:06.941+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16542339","id":"16542339","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~daijy], the motivation for that is that currently we can generate complex SQL statement for the part of the query that we push to the storage handler automatically from Calcite. Hence, the types for that TableScan should be coming from the output of that query rather than from the Table schema. I think an easy fix would be that if query has been generated by Hive, then we could use ResultSet to determine the schema; otherwise we fallback to using table schema, which is what [~msydoron] did.\r\nSince the number of dialects supported from Calcite will be limited, this means we should also include a map for the types in those databases towards Hive. We can do that later on. Does it make sense?\r\n\r\n[~msydoron], there seem to be be some test failures still.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-07-12T23:53:08.705+0000","updated":"2018-07-12T23:53:08.705+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16544479","id":"16544479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12931692/HIVE-20095.4.patch\n\n{color:red}ERROR:{color} -1 due to build exiting with an error\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/12622/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/12622/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12622/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nTests exited with: NonZeroExitCodeException\nCommand 'bash /data/hiveptest/working/scratch/source-prep.sh' failed with exit status 1 and output '+ date '+%Y-%m-%d %T.%3N'\n2018-07-15 09:04:54.430\n+ [[ -n /usr/lib/jvm/java-8-openjdk-amd64 ]]\n+ export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64\n+ JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64\n+ export PATH=/usr/lib/jvm/java-8-openjdk-amd64/bin/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+ PATH=/usr/lib/jvm/java-8-openjdk-amd64/bin/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+ export 'ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m '\n+ ANT_OPTS='-Xmx1g -XX:MaxPermSize=256m '\n+ export 'MAVEN_OPTS=-Xmx1g '\n+ MAVEN_OPTS='-Xmx1g '\n+ cd /data/hiveptest/working/\n+ tee /data/hiveptest/logs/PreCommit-HIVE-Build-12622/source-prep.txt\n+ [[ false == \\t\\r\\u\\e ]]\n+ mkdir -p maven ivy\n+ [[ git = \\s\\v\\n ]]\n+ [[ git = \\g\\i\\t ]]\n+ [[ -z master ]]\n+ [[ -d apache-github-source-source ]]\n+ [[ ! -d apache-github-source-source/.git ]]\n+ [[ ! -d apache-github-source-source ]]\n+ date '+%Y-%m-%d %T.%3N'\n2018-07-15 09:04:54.433\n+ cd apache-github-source-source\n+ git fetch origin\n+ git reset --hard HEAD\nHEAD is now at 1b5903b HIVE-20006: Make materializations invalidation cache work with multiple active remote metastores (Jesus Camacho Rodriguez, reviewed by Ashutosh Chauhan)\n+ git clean -f -d\n+ git checkout master\nAlready on 'master'\nYour branch is up-to-date with 'origin/master'.\n+ git reset --hard origin/master\nHEAD is now at 1b5903b HIVE-20006: Make materializations invalidation cache work with multiple active remote metastores (Jesus Camacho Rodriguez, reviewed by Ashutosh Chauhan)\n+ git merge --ff-only origin/master\nAlready up-to-date.\n+ date '+%Y-%m-%d %T.%3N'\n2018-07-15 09:04:55.581\n+ rm -rf ../yetus_PreCommit-HIVE-Build-12622\n+ mkdir ../yetus_PreCommit-HIVE-Build-12622\n+ git gc\n+ cp -R . ../yetus_PreCommit-HIVE-Build-12622\n+ mkdir /data/hiveptest/logs/PreCommit-HIVE-Build-12622/yetus\n+ patchCommandPath=/data/hiveptest/working/scratch/smart-apply-patch.sh\n+ patchFilePath=/data/hiveptest/working/scratch/build.patch\n+ [[ -f /data/hiveptest/working/scratch/build.patch ]]\n+ chmod +x /data/hiveptest/working/scratch/smart-apply-patch.sh\n+ /data/hiveptest/working/scratch/smart-apply-patch.sh /data/hiveptest/working/scratch/build.patch\nfatal: patch with only garbage at line 1325\nfatal: git diff header lacks filename information when removing 1 leading pathname component (line 427)\nfatal: git diff header lacks filename information when removing 2 leading pathname components (line 427)\nThe patch does not appear to apply with p0, p1, or p2\n+ result=1\n+ '[' 1 -ne 0 ']'\n+ rm -rf yetus_PreCommit-HIVE-Build-12622\n+ exit 1\n'\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12931692 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2018-07-15T09:05:31.837+0000","updated":"2018-07-15T09:05:31.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16545053","id":"16545053","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"body":"[~jcamachorodriguez] [~daijy]\r\n\r\nThose 2 tests are failing exactly due to the changes that has been done in JdbcRecordIterator.java.\r\n\r\n +\r\n\r\nUsing getLong/getDouble will return wrong results, as those API's will not return null values!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-16T10:46:10.101+0000","updated":"2018-07-16T14:44:26.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16545209","id":"16545209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"body":"[~jcamachorodriguez]\r\n\r\nI am afraid that your commit for HIVE-20007 also broke the timestamp consuming from external table, as JavaTimestampObjectInspector now expect  org.apache.hadoop.hive.common.type.Timestamp instead of java.sql.Timestamp which the jdbc generates.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msydoron","name":"msydoron","key":"msydoron","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10441","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"},"displayName":"Jonathan Doron","active":true,"timeZone":"Asia/Jerusalem"},"created":"2018-07-16T13:30:48.936+0000","updated":"2018-07-16T13:30:48.936+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13170289/comment/16548561","id":"16548561","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~msydoron], we need to fix those two test failures before committing this patch. What is the error that we are getting?\r\n\r\nAfter checking the code in more detail.\r\nFor the existing failures, I think your new code in JdbcRecordIterator is the right way to go, but we should modify the {{deserialize}} method in JDBCSerde to create the right type requested for Hive (the deserialize method in DruidSerDe may serve as an example https://github.com/apache/hive/blob/master/druid-handler/src/java/org/apache/hadoop/hive/druid/serde/DruidSerDe.java#L387 ). JDBCSerde always has information for the columnTypes derived either from from metadata query or from conf depending on the existence of {{Constants.HIVE_JDBC_QUERY}}, hence it should be straightforward. At the same time, issue for nulls and timestamp would be fixed this way. What do you think?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-07-18T23:17:23.242+0000","updated":"2018-07-18T23:49:44.139+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20095/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3vkvr:"}}