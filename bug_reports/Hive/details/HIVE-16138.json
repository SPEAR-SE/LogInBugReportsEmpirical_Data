{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13048889","self":"https://issues.apache.org/jira/rest/api/2/issue/13048889","key":"HIVE-16138","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-03-07T15:01:33.611+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 10 15:30:18 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-16138/watchers","watchCount":4,"isWatching":false},"created":"2017-03-07T13:22:01.737+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-03-10T15:32:49.627+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12325007","id":"12325007","name":"Hive"}],"timeoriginalestimate":null,"description":"Consider the following table:\n\n{code:title=create-table.hql|borderStyle=solid}\n\nCREATE TABLE customer.customer_link(\n  customer_id decimal(25,0),\n  member_id decimal(25,0))\nROW FORMAT DELIMITED\n  FIELDS TERMINATED BY '\\u0001'\nSTORED AS INPUTFORMAT\n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\nOUTPUTFORMAT\n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://nameNodeHA/user/hive/warehouse/customer.db/customer_link'\nTBLPROPERTIES (\n  'ORC.COMPRESS'='SNAPPY',\n  'transient_lastDdlTime'='1488844949')\n{code}\n\nWhen executing the following select, no records are returned.  The table contains 10 million records.  This only happens with ORC formatted tables.\n\n{code:title=query-with-no-results.hql|borderStyle=solid}\nselect * from customer.customer_link where customer_id  = 1000000000000003210009;\n{code}\n\n\n{code:title=query-with-results.hql|borderStyle=solid}\nselect * from customer.customer_link where customer_id limit 10;\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Query on ORC table returns no results when specifying a DECIMAL(25) column in a the where clause.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gencorruptor","name":"gencorruptor","key":"gencorruptor","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Winston Spencer","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gencorruptor","name":"gencorruptor","key":"gencorruptor","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Winston Spencer","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13048889/comment/15899562","id":"15899562","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabhmishra","name":"saurabhmishra","key":"saurabhmishra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10434","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10434","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10434","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10434"},"displayName":"Saurabh Mishra","active":true,"timeZone":"Asia/Kolkata"},"body":"Am facing similar issue when using ORC storage format with decimal datatypes in columns. Few additional quirks noticed were\nselect * from table1 where col1  = '7799999990000003210009' - WORKING\nselect * from table1 where col1  IN ('7799999990000003210009') - NOT WORKING\nselect * from table1 where CAST(col1 as varchar(100))  IN ('7799999990000003210009'); - WORKING","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabhmishra","name":"saurabhmishra","key":"saurabhmishra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10434","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10434","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10434","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10434"},"displayName":"Saurabh Mishra","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-03-07T15:01:33.611+0000","updated":"2017-03-07T15:01:33.611+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13048889/comment/15899680","id":"15899680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cartershanklin","name":"cartershanklin","key":"cartershanklin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Carter Shanklin","active":true,"timeZone":"America/Chicago"},"body":"[~mmccline] any insights on this one?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cartershanklin","name":"cartershanklin","key":"cartershanklin","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Carter Shanklin","active":true,"timeZone":"America/Chicago"},"created":"2017-03-07T16:18:19.185+0000","updated":"2017-03-07T16:18:19.185+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13048889/comment/15899878","id":"15899878","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"body":"This looks like a problem with free integers with digits > 18.\n\nWhat happens when you explicitly force a decimal by doing = 7799999990000003210009BD ?\n\n(FYI, the explain should show the broken case like so)\n\n{code}\n            predicate:(customer_id) IN (1.0000000000000031E21) (type: boolean)\n{code}\n\nWhile the explicit decimal test shows\n\n{code}\nexplain select * from customer_link where customer_id in (1000000000000003210009BD);\n...\n            predicate:(customer_id) IN (1000000000000003210009) (type: boolean)\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-03-07T18:15:14.838+0000","updated":"2017-03-07T18:21:16.894+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13048889/comment/15901136","id":"15901136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabhmishra","name":"saurabhmishra","key":"saurabhmishra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10434","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10434","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10434","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10434"},"displayName":"Saurabh Mishra","active":true,"timeZone":"Asia/Kolkata"},"body":"[~gopalv] That clears few doubts. But still the behaviour with numeral within quotes (') in unclear. When checking the explain plan for both of them, it seems to be not approximating for numbers greater than 18 digits.\n\neg. 1\nselect * from tab1 where col1 in ('1010000000421400010101');\n`filterExpr: (col1) IN ('1010000000421400010101') (type: boolean)`\n\neg. 2\nselect * from tab1 where col1 = ('1010000000421400010101');\n`filterExpr: (col1 = '1010000000421400010101') (type: boolean)`\n\nAbove, 1st example gives no output while the 2nd one gives expected return.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabhmishra","name":"saurabhmishra","key":"saurabhmishra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10434","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10434","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10434","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10434"},"displayName":"Saurabh Mishra","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-03-08T11:44:36.812+0000","updated":"2017-03-08T11:44:36.812+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13048889/comment/15901184","id":"15901184","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"body":"I'm not able to reproduce the IN clause problem in 1.2.x branch\n\n{code}\ncreate temporary table customer_link (customer_id decimal(25,0)) stored as orc;\ninsert into customer_link values('1010000000421400010101');\nselect * from customer_link where customer_id in ('1010000000421400010101');\n\nOK\n1010000000421400010101\n{code}\n\nBut \n\n{code}\nhive> select * from customer_link where customer_id in (1010000000421400010101);\nOK\nTime taken: 0.17 seconds\n{code}\n\nfails, due to the loss of exact types.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gopalv","name":"gopalv","key":"gopalv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gopal V","active":true,"timeZone":"Asia/Kolkata"},"created":"2017-03-08T12:36:47.178+0000","updated":"2017-03-08T12:36:47.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13048889/comment/15905260","id":"15905260","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gencorruptor","name":"gencorruptor","key":"gencorruptor","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Winston Spencer","active":true,"timeZone":"Etc/UTC"},"body":"Just tried to run the following query which failed also.  \n\n\n{code:title=query-with-no-results.hql|borderStyle=solid}\n     select * from customer.customer_link where customer_id = member_id;\n{code}\n\n\nThere should be at least 1 million records in the result.  I'm about to pull down the 1.2.x branch and debug locally.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gencorruptor","name":"gencorruptor","key":"gencorruptor","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Winston Spencer","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-10T15:30:18.637+0000","updated":"2017-03-10T15:32:49.621+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-16138/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3b1zj:"}}