{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12771733","self":"https://issues.apache.org/jira/rest/api/2/issue/12771733","key":"HIVE-9544","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2015-05-08T21:06:31.148+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Dec 11 00:05:46 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_27227162803_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-12-14T17:11:59.387+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9544/watchers","watchCount":8,"isWatching":false},"created":"2015-02-02T14:05:56.621+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-02-16T23:50:35.843+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"When attempting to drop a partitioned table using a fully qualified name I get this error:\n{code}\nhive -e 'drop table myDB.my_table_name;'\nLogging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n\n\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. org.apache.thrift.TApplicationException: Internal error processing get_partition_names\n{code}\nIt succeeds if I instead do:\n{code}hive -e 'use myDB; drop table my_table_name;'{code}\n\nRegards,\n\nHari Sekhon\nhttp://www.linkedin.com/in/harisekhon","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Error dropping fully qualified partitioned table - Internal error processing get_partition_names","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harisekhon","name":"harisekhon","key":"harisekhon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari Sekhon","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harisekhon","name":"harisekhon","key":"harisekhon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari Sekhon","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"HDP 2.2","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/14535530","id":"14535530","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dghosal","name":"dghosal","key":"dghosal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dipankar","active":true,"timeZone":"Etc/UTC"},"body":"Alternate way of doing this is :\nhive -hiveconf schema=mydb -e 'drop table ${hiveconf:schema}.my_table_name'\n\nI.e .. pass the schema/database name as hive conf.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dghosal","name":"dghosal","key":"dghosal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dipankar","active":true,"timeZone":"Etc/UTC"},"created":"2015-05-08T21:06:31.148+0000","updated":"2015-05-08T21:06:31.148+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/14714177","id":"14714177","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ryan+P","name":"Ryan P","key":"ryan p","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ryan+p&avatarId=22394","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ryan+p&avatarId=22394","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ryan+p&avatarId=22394","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ryan+p&avatarId=22394"},"displayName":"Ryan P","active":true,"timeZone":"Etc/GMT+4"},"body":"[~harisekhon] were you using Sentry at the time?  I personally could not reproduce this issue with Sentry disabled. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ryan+P","name":"Ryan P","key":"ryan p","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ryan+p&avatarId=22394","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ryan+p&avatarId=22394","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ryan+p&avatarId=22394","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ryan+p&avatarId=22394"},"displayName":"Ryan P","active":true,"timeZone":"Etc/GMT+4"},"created":"2015-08-26T15:35:45.948+0000","updated":"2015-08-26T15:35:45.948+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/14714424","id":"14714424","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harisekhon","name":"harisekhon","key":"harisekhon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari Sekhon","active":true,"timeZone":"Etc/UTC"},"body":"[~rnpridgeon] No it was on Hortonworks so no Sentry.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=harisekhon","name":"harisekhon","key":"harisekhon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hari Sekhon","active":true,"timeZone":"Etc/UTC"},"created":"2015-08-26T16:13:32.137+0000","updated":"2015-08-26T16:13:32.137+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/14723588","id":"14723588","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ryan+P","name":"Ryan P","key":"ryan p","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ryan+p&avatarId=22394","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ryan+p&avatarId=22394","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ryan+p&avatarId=22394","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ryan+p&avatarId=22394"},"displayName":"Ryan P","active":true,"timeZone":"Etc/GMT+4"},"body":"[~harisekhon] that's fair, sorry I missed that some how. I don't think the issue is with Sentry it's so much as the presence of a pre-event listener. \n\nFrom the HMS logs I was able to find the following\n\nERROR org.apache.thrift.ProcessFunction: Internal error processing get_partition_names\nNoSuchObjectException(message:default.testdrop table not found)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.fireReadTablePreEvent(HiveMetaStore.java:2820)\n\nTracing the stack in the HMS logs I found that the error is thrown here:\n\nprivate void fireReadTablePreEvent(String dbName, String tblName) throws MetaException, NoSuchObjectException {\nif(preListeners.size() > 0) {\n// do this only if there is a pre event listener registered (avoid unnecessary\n// metastore api call)\nTable t = getMS().getTable(dbName, tblName);\nif (t == null) {\nthrow new NoSuchObjectException(dbName + \".\" + tblName\n+ \" table not found\");\n}\nfirePreEvent(new PreReadTableEvent(t, this));\n}\n}\n\nI'm not sure why or how the database qualifier is lost but in the absence of a pre-event listener everything works as expected. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ryan+P","name":"Ryan P","key":"ryan p","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ryan+p&avatarId=22394","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ryan+p&avatarId=22394","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ryan+p&avatarId=22394","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ryan+p&avatarId=22394"},"displayName":"Ryan P","active":true,"timeZone":"Etc/GMT+4"},"created":"2015-08-31T15:54:04.338+0000","updated":"2015-08-31T15:54:04.338+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/14998825","id":"14998825","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ErwanMAS","name":"ErwanMAS","key":"erwanmas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=erwanmas&avatarId=23462","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=erwanmas&avatarId=23462","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=erwanmas&avatarId=23462","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=erwanmas&avatarId=23462"},"displayName":"ErwanMAS","active":true,"timeZone":"America/New_York"},"body":"I have this bug , on Hortonworks 2.2.4 , so with hive 0.14 \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ErwanMAS","name":"ErwanMAS","key":"erwanmas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=erwanmas&avatarId=23462","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=erwanmas&avatarId=23462","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=erwanmas&avatarId=23462","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=erwanmas&avatarId=23462"},"displayName":"ErwanMAS","active":true,"timeZone":"America/New_York"},"created":"2015-11-10T16:11:26.713+0000","updated":"2015-11-10T16:11:26.713+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/15051457","id":"15051457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ryan+P","name":"Ryan P","key":"ryan p","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ryan+p&avatarId=22394","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ryan+p&avatarId=22394","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ryan+p&avatarId=22394","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ryan+p&avatarId=22394"},"displayName":"Ryan P","active":true,"timeZone":"Etc/GMT+4"},"body":"This looks pretty similar to HIVE-10421. Are the offending tables partitioned?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ryan+P","name":"Ryan P","key":"ryan p","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ryan+p&avatarId=22394","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ryan+p&avatarId=22394","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ryan+p&avatarId=22394","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ryan+p&avatarId=22394"},"displayName":"Ryan P","active":true,"timeZone":"Etc/GMT+4"},"created":"2015-12-10T18:54:27.092+0000","updated":"2015-12-10T18:54:27.092+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12771733/comment/15051891","id":"15051891","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"body":"It is possible since I was not able to reproduce this issue in current upstream.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ctang.ma","name":"ctang.ma","key":"ctang.ma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chaoyu Tang","active":true,"timeZone":"America/New_York"},"created":"2015-12-11T00:05:46.039+0000","updated":"2015-12-11T00:05:46.039+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9544/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i252qn:"}}