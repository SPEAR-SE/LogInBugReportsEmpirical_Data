{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12762755","self":"https://issues.apache.org/jira/rest/api/2/issue/12762755","key":"HIVE-9171","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2014-12-29T03:26:43.366+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Dec 30 05:44:22 UTC 2014","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_8806702297_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-03-31T02:00:53.232+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9171/watchers","watchCount":2,"isWatching":false},"created":"2014-12-19T03:42:30.998+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ferd","name":"Ferd","key":"ferd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ferd&avatarId=21543","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ferd&avatarId=21543","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ferd&avatarId=21543","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ferd&avatarId=21543"},"displayName":"Ferdinand Xu","active":true,"timeZone":"Asia/Hong_Kong"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-03-31T02:00:53.279+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324409","id":"12324409","name":"Beeline"}],"timeoriginalestimate":null,"description":"when I use init file in beeline ,it has some exception:\n./beeline -i init.sql -f /tmp/test.sql  --verbose\n\n0: jdbc:hive2://hadoop015.dx.momo.com:10000> SELECT\nError: Error while compiling statement: FAILED: ParseException line 1:6 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in select clause (state=42000,code=40000)\norg.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: ParseException line 1:6 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in select clause\n\tat org.apache.hive.jdbc.Utils.verifySuccess(Utils.java:231)\n\tat org.apache.hive.jdbc.Utils.verifySuccessWithInfo(Utils.java:217)\n\tat org.apache.hive.jdbc.HiveStatement.execute(HiveStatement.java:254)\n\tat org.apache.hive.beeline.Commands.execute(Commands.java:784)\n\tat org.apache.hive.beeline.Commands.sql(Commands.java:665)\n\tat org.apache.hive.beeline.BeeLine.dispatch(BeeLine.java:933)\n\tat org.apache.hive.beeline.BeeLine.execute(BeeLine.java:796)\n\tat org.apache.hive.beeline.BeeLine.executeFile(BeeLine.java:781)\n\tat org.apache.hive.beeline.BeeLine.begin(BeeLine.java:726)\n\tat org.apache.hive.beeline.BeeLine.mainWithInputRedirection(BeeLine.java:465)\n\tat org.apache.hive.beeline.BeeLine.main(BeeLine.java:451)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:606)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:212)\nCaused by: org.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: ParseException line 1:6 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in select clause\n\tat org.apache.hive.service.cli.operation.Operation.toSQLException(Operation.java:314)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:102)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runInternal(SQLOperation.java:171)\n\tat org.apache.hive.service.cli.operation.Operation.run(Operation.java:256)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementInternal(HiveSessionImpl.java:376)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementAsync(HiveSessionImpl.java:363)\n\tat sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:606)\n\tat org.apache.hive.service.cli.session.HiveSessionProxy.invoke(HiveSessionProxy.java:79)\n\tat org.apache.hive.service.cli.session.HiveSessionProxy.access$000(HiveSessionProxy.java:37)\n\tat org.apache.hive.service.cli.session.HiveSessionProxy$1.run(HiveSessionProxy.java:64)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat javax.security.auth.Subject.doAs(Subject.java:415)\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1614)\n\tat org.apache.hadoop.hive.shims.HadoopShimsSecure.doAs(HadoopShimsSecure.java:536)\n\tat org.apache.hive.service.cli.session.HiveSessionProxy.invoke(HiveSessionProxy.java:60)\n\tat com.sun.proxy.$Proxy14.executeStatementAsync(Unknown Source)\n\tat org.apache.hive.service.cli.CLIService.executeStatementAsync(CLIService.java:247)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.ExecuteStatement(ThriftCLIService.java:401)\n\tat org.apache.hive.service.cli.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1313)\n\tat org.apache.hive.service.cli.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1298)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:206)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.parse.ParseException:line 1:6 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in select clause\n\tat org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:202)\n\tat org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:166)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:389)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:303)\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1067)\n\tat org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:1061)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:100)\n\t... 27 more\n\n\n\nIn BeeLine.java,I found the consoleReader will be setter \"null\" in function runInit. And I modify this function ,\nint runInit() {\n        String initFile = getOpts().getInitFile();\n        ConsoleReader csr = consoleReader;\n        if (initFile != null) {\n            info(\"Running init script \" + initFile);\n            try {\n                return executeFile(initFile);\n            } finally {\n                exit = false;\n                consoleReader=csr;\n            }\n        }\n        return ERRNO_OK;\n    }\n\nTry again,my command  is work.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"After use init file in beeline,the consoleReader is setted null.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wh831019","name":"wh831019","key":"wh831019","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wang Hao","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wh831019","name":"wh831019","key":"wh831019","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wang Hao","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12762755/comment/14259811","id":"14259811","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ferd","name":"Ferd","key":"ferd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ferd&avatarId=21543","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ferd&avatarId=21543","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ferd&avatarId=21543","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ferd&avatarId=21543"},"displayName":"Ferdinand Xu","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Hi [~wh831019], can you provide your test.sql file? I can not reproduce this bug? Thank you!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ferd","name":"Ferd","key":"ferd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ferd&avatarId=21543","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ferd&avatarId=21543","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ferd&avatarId=21543","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ferd&avatarId=21543"},"displayName":"Ferdinand Xu","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2014-12-29T03:26:43.366+0000","updated":"2014-12-29T03:26:43.366+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12762755/comment/14260769","id":"14260769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wh831019","name":"wh831019","key":"wh831019","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wang Hao","active":true,"timeZone":"Asia/Shanghai"},"body":"hi, here is a simple way to reproduce this bug.\n\nmy init file:\n[hadoop@hadoop015.dx.momo.com bin]$ cat init.sql\nuse test;\n\nFirst,run beeline with -i\n\n[hadoop@hadoop015.dx.momo.com bin]$ ./beeline -i init.sql\nBeeline version 0.14.0 by Apache Hive\nbeeline> \n\nSecond,connect to hive2\n\nbeeline> !connect jdbc:hive2://hadoop015.dx.momo.com:10000 dm dm\nscan complete in 12ms\nConnecting to jdbc:hive2://hadoop015.dx.momo.com:10000\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/hadoop-2.5.1/share/hadoop/common/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/apache-hive-0.14.0-bin/lib/hive-jdbc-0.14.0-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nConnected to: Apache Hive (version 0.14.0)\nDriver: Hive JDBC (version 0.14.0)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\nRunning init script init.sql\n0: jdbc:hive2://hadoop015.dx.momo.com:10000> use test;\nNo rows affected (0.276 seconds)\n0: jdbc:hive2://hadoop015.dx.momo.com:10000> \n\nfinally, run “show tables”, you can find I didn't end the command with \";\",but beeline can run the command\n\n0: jdbc:hive2://hadoop015.dx.momo.com:10000> show tables\n+------------------------+--+\n|        tab_name        |\n+------------------------+--+\n| tl_hdfs_app_event_log  |\n+------------------------+--+\n1 row selected (0.207 seconds)\n\nand I not run sql with multiple line，\n\n0: jdbc:hive2://hadoop015.dx.momo.com:10000> select \nError: Error while compiling statement: FAILED: ParseException line 1:6 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' in select clause (state=42000,code=40000)\n0: jdbc:hive2://hadoop015.dx.momo.com:10000> \n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wh831019","name":"wh831019","key":"wh831019","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wang Hao","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-12-30T04:31:39.186+0000","updated":"2014-12-30T04:31:39.186+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12762755/comment/14260826","id":"14260826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ferd","name":"Ferd","key":"ferd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ferd&avatarId=21543","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ferd&avatarId=21543","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ferd&avatarId=21543","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ferd&avatarId=21543"},"displayName":"Ferdinand Xu","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Thank you for your information. This bug has been resolved in the latest trunk in 0.15.0-SNAPSHOT. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Ferd","name":"Ferd","key":"ferd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ferd&avatarId=21543","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ferd&avatarId=21543","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ferd&avatarId=21543","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ferd&avatarId=21543"},"displayName":"Ferdinand Xu","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2014-12-30T05:44:22.733+0000","updated":"2014-12-30T05:44:22.733+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-9171/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i23ltj:"}}