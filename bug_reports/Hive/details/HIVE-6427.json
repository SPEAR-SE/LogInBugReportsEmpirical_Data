{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12695033","self":"https://issues.apache.org/jira/rest/api/2/issue/12695033","key":"HIVE-6427","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2014-04-10T23:54:52.856+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Nov 12 01:56:27 UTC 2014","customfield_12310420":"373541","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-6427/watchers","watchCount":4,"isWatching":false},"created":"2014-02-13T16:19:43.588+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324312","id":"12324312","description":"released","name":"0.12.0","archived":false,"released":true,"releaseDate":"2013-10-15"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-11-12T01:56:27.477+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320408","id":"12320408","name":"HiveServer2","description":"Tracks issues related to HiveServer2"}],"timeoriginalestimate":null,"description":"In case of metastore restart hive server doesn't reopen connection to metastore. Any command gives broken pipe or similar exceptions.\nhttp://paste.ubuntu.com/6926215/\n\nAny subsequent command doesn't reestablish connection and tries to use stale (closed) connection.\n\nLooks like we shouldn't blindly convert any MetaException to HiveSQLException, but should distinguish between fatal exceptions and logical exceptions.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12640599","id":"12640599","filename":"HIVE-6427.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"created":"2014-04-17T07:27:23.387+0000","size":9793,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12640599/HIVE-6427.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"373841","customfield_12312823":null,"summary":"Hive Server2 should reopen Metastore client in case of any Thrift exceptions","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12695033/comment/13900792","id":"13900792","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"body":"I make a patch against cloudera branch cdh5-0.12.0_5.0.0b2 which somehow solves that problem. \nIt is copy&paste of RetryingMetaStoreClient initialisation. Also, for properly working proxy code I've removed unnecessary exception mangling.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"created":"2014-02-13T22:08:00.122+0000","updated":"2014-02-13T22:08:00.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12695033/comment/13918055","id":"13918055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"body":"Patch was updated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"created":"2014-03-03T13:43:56.908+0000","updated":"2014-03-03T13:43:56.908+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12695033/comment/13966030","id":"13966030","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~octo47] Can you create a RB request on https://reviews.apache.org/r/new/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-10T23:54:52.856+0000","updated":"2014-04-10T23:54:52.856+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12695033/comment/13972527","id":"13972527","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"body":"https://reviews.apache.org/r/20444/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=octo47","name":"octo47","key":"octo47","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=octo47&avatarId=22739","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=octo47&avatarId=22739","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=octo47&avatarId=22739","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=octo47&avatarId=22739"},"displayName":"Andrey Stepachev","active":true,"timeZone":"Europe/London"},"created":"2014-04-17T08:55:08.926+0000","updated":"2014-04-17T08:55:08.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12695033/comment/14094192","id":"14094192","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 no tests executed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12640599/HIVE-6427.patch\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/272/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/272/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-272/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nTests exited with: NonZeroExitCodeException\nCommand 'bash /data/hive-ptest/working/scratch/source-prep.sh' failed with exit status 1 and output '+ [[ -n /usr/java/jdk1.7.0_45-cloudera ]]\n+ export JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera\n+ JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera\n+ export PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-maven-3.0.5/bin:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin\n+ PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-maven-3.0.5/bin:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.6.0_34/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin\n+ export 'ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m '\n+ ANT_OPTS='-Xmx1g -XX:MaxPermSize=256m '\n+ export 'M2_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128'\n+ M2_OPTS='-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128'\n+ cd /data/hive-ptest/working/\n+ tee /data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-272/source-prep.txt\n+ [[ false == \\t\\r\\u\\e ]]\n+ mkdir -p maven ivy\n+ [[ svn = \\s\\v\\n ]]\n+ [[ -n '' ]]\n+ [[ -d apache-svn-trunk-source ]]\n+ [[ ! -d apache-svn-trunk-source/.svn ]]\n+ [[ ! -d apache-svn-trunk-source ]]\n+ cd apache-svn-trunk-source\n+ svn revert -R .\nReverted 'ql/src/test/results/clientpositive/union20.q.out'\nReverted 'ql/src/test/results/clientpositive/annotate_stats_join.q.out'\nReverted 'ql/src/java/org/apache/hadoop/hive/ql/optimizer/stats/annotation/StatsRulesProcFactory.java'\n++ egrep -v '^X|^Performing status on external'\n++ awk '{print $2}'\n++ svn status --no-ignore\n+ rm -rf target datanucleus.log ant/target shims/target shims/0.20/target shims/0.20S/target shims/0.23/target shims/aggregator/target shims/common/target shims/common-secure/target packaging/target hbase-handler/target testutils/target jdbc/target metastore/target itests/target itests/hcatalog-unit/target itests/test-serde/target itests/qtest/target itests/hive-unit-hadoop2/target itests/hive-minikdc/target itests/hive-unit/target itests/custom-serde/target itests/util/target hcatalog/target hcatalog/core/target hcatalog/streaming/target hcatalog/server-extensions/target hcatalog/hcatalog-pig-adapter/target hcatalog/webhcat/svr/target hcatalog/webhcat/java-client/target hwi/target common/target common/src/gen service/target contrib/target serde/target beeline/target odbc/target cli/target ql/dependency-reduced-pom.xml ql/target\n+ svn update\n\nFetching external item into 'hcatalog/src/test/e2e/harness'\nExternal at revision 1617512.\n\nAt revision 1617512.\n+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh\n+ patchFilePath=/data/hive-ptest/working/scratch/build.patch\n+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]\n+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh\n+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch\nThe patch does not appear to apply with p0, p1, or p2\n+ exit 1\n'\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12640599","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-08-12T15:48:03.557+0000","updated":"2014-08-12T15:48:03.557+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12695033/comment/14207519","id":"14207519","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"patch needs a rebase","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-12T01:56:27.472+0000","updated":"2014-11-12T01:56:27.472+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-6427/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1sdev:"}}