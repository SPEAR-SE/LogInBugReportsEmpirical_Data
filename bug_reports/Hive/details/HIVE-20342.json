{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13177787","self":"https://issues.apache.org/jira/rest/api/2/issue/13177787","key":"HIVE-20342","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Aug 23 15:31:44 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20342/watchers","watchCount":2,"isWatching":false},"created":"2018-08-08T20:46:29.905+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12340268","id":"12340268","name":"3.0.0","archived":false,"released":true,"releaseDate":"2018-05-21"}],"issuelinks":[{"id":"12541613","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12541613","type":{"id":"10020","name":"Cloners","inward":"is cloned by","outward":"is a clone of","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10020"},"outwardIssue":{"id":"13179223","key":"HIVE-20399","self":"https://issues.apache.org/jira/rest/api/2/issue/13179223","fields":{"summary":"CTAS w/a custom table location that is not fully qualified fails for MM tables","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-08-23T15:31:44.424+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324409","id":"12324409","name":"Beeline"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12320408","id":"12320408","name":"HiveServer2","description":"Tracks issues related to HiveServer2"}],"timeoriginalestimate":null,"description":"When attempting to create table from SELECT with LOCATION  (managed tables)\r\n\r\n \r\n\r\nTo reproduce CREATE source table CLASS with some data\r\n\r\nthen use the code below to CREATE table TABLE42 from select on CLASS and LOCATION /tmp/test1\r\n\r\n \r\n{code:java}\r\nCREATE TABLE TABLE42 ROW FORMAT SERDE\r\n'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe' STORED AS RCFILE\r\nLOCATION '/tmp/test1'\r\nAS SELECT * FROM\r\nCLASS;\r\n{code}\r\n \r\n\r\nit fails with ERROR:\r\n{code:java}\r\nERROR : Job Commit failed with exception 'org.apache.hadoop.hive.ql.metadata.HiveException(The following files were committed but not found: [/tmp/test1/delta_0000001_0000001_0000/000000_0])' \r\norg.apache.hadoop.hive.ql.metadata.HiveException: The following files were committed but not found: [/tmp/test1/delta_0000001_0000001_0000/000000_0] \r\nat org.apache.hadoop.hive.ql.exec.Utilities.handleMmTableFinalPath(Utilities.java:4329) \r\nat org.apache.hadoop.hive.ql.exec.FileSinkOperator.jobCloseOp(FileSinkOperator.java:1393) \r\n{code}\r\n \r\n\r\nIf the same is attempted for an EXTERNAL table will work OK\r\n{code:java}\r\nCREATE EXTERNAL TABLE test3 ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe' STORED AS RCFILE LOCATION '/tmp/test2' AS SELECT * FROM test;\r\n{code}\r\nif we CREATE table on statement 1, and INSERT from SELECT on statement 2 , will work OK.\r\n\r\n(Step1 CREATE TABLE)\r\n{code:java}\r\nCREATE TABLE `TABLE42`( \r\n`COL1` double, \r\n`COL2` varchar(8), \r\n`COL3` varchar(1), \r\n`COL4` double, \r\n`COL5` double) \r\nROW FORMAT SERDE \r\n'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe' \r\nSTORED AS INPUTFORMAT \r\n'org.apache.hadoop.hive.ql.io.RCFileInputFormat' \r\nOUTPUTFORMAT \r\n'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' \r\nLOCATION '/tmp/test1';\r\n\r\n{code}\r\n(Step2 INSERT from SELECT)\r\n{code:java}\r\nINSERT into TABLE42 select * FROM CLASS;\r\n{code}\r\nwill work as expected.\r\n\r\n \r\n\r\nThanks\r\n\r\nPablo\r\n\r\n \r\n\r\n ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Create table from CTAS with location fails for managed tables","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pidiaquez","name":"pidiaquez","key":"pidiaquez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=pidiaquez&avatarId=36481","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pidiaquez&avatarId=36481","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pidiaquez&avatarId=36481","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pidiaquez&avatarId=36481"},"displayName":"Pablo Idiaquez","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pidiaquez","name":"pidiaquez","key":"pidiaquez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=pidiaquez&avatarId=36481","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pidiaquez&avatarId=36481","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pidiaquez&avatarId=36481","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pidiaquez&avatarId=36481"},"displayName":"Pablo Idiaquez","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13177787/comment/16590372","id":"16590372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pidiaquez","name":"pidiaquez","key":"pidiaquez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=pidiaquez&avatarId=36481","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pidiaquez&avatarId=36481","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pidiaquez&avatarId=36481","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pidiaquez&avatarId=36481"},"displayName":"Pablo Idiaquez","active":true,"timeZone":"Etc/UTC"},"body":" \r\n\r\nLOCATION in this case requires to include FULL HDFS URI Path to work without giving error\r\n{code:java}\r\nCREATE TABLE test4 ROW FORMAT SERDE \r\n'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe' STORED AS RCFILE \r\nLOCATION 'hdfs://NAMENODE:8020/tmp/test4' \r\n AS SELECT * FROM test;\r\n{code}\r\nHowever If LOCATION is passed with the short format '/folder/subfolder'   ( no hdfs://NN prefix) . it will still fail\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pidiaquez","name":"pidiaquez","key":"pidiaquez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=pidiaquez&avatarId=36481","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pidiaquez&avatarId=36481","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pidiaquez&avatarId=36481","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pidiaquez&avatarId=36481"},"displayName":"Pablo Idiaquez","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-23T15:19:26.555+0000","updated":"2018-08-23T15:19:26.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13177787/comment/16590385","id":"16590385","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pidiaquez","name":"pidiaquez","key":"pidiaquez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=pidiaquez&avatarId=36481","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pidiaquez&avatarId=36481","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pidiaquez&avatarId=36481","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pidiaquez&avatarId=36481"},"displayName":"Pablo Idiaquez","active":true,"timeZone":"Etc/UTC"},"body":"seems that there is a Patch Available on HIVE-20399\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pidiaquez","name":"pidiaquez","key":"pidiaquez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=pidiaquez&avatarId=36481","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pidiaquez&avatarId=36481","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pidiaquez&avatarId=36481","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pidiaquez&avatarId=36481"},"displayName":"Pablo Idiaquez","active":true,"timeZone":"Etc/UTC"},"created":"2018-08-23T15:31:44.424+0000","updated":"2018-08-23T15:31:44.424+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-20342/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3wujj:"}}