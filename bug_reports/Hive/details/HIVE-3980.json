{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12630612","self":"https://issues.apache.org/jira/rest/api/2/issue/12630612","key":"HIVE-3980","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323587","id":"12323587","description":"Hive 0.11.0","name":"0.11.0","archived":false,"released":true,"releaseDate":"2013-05-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-02-20T16:00:48.533+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Apr 04 23:39:59 UTC 2013","customfield_12310420":"311108","customfield_12312320":null,"customfield_12310222":"10002_*:*_3_*:*_2357192539_*|*_1_*:*_3_*:*_1973689790_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-03-26T08:28:35.025+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3980/watchers","watchCount":4,"isWatching":false},"created":"2013-02-04T05:27:12.723+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12363889","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12363889","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"},"outwardIssue":{"id":"12604358","key":"HIVE-3403","self":"https://issues.apache.org/jira/rest/api/2/issue/12604358","fields":{"summary":"user should not specify mapjoin to perform sort-merge bucketed join","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-16T21:10:03.605+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."}],"timeoriginalestimate":null,"description":"There have been a lot of comments on HIVE-3403, which involve changing \nvariable names/function names/adding more comments/general cleanup etc.\n\nSince HIVE-3403 involves a lot of refactoring, it was fairly difficult to\naddress the comments there, since refreshing becomes impossible. This jira\nis to track those cleanups.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12569968","id":"12569968","filename":"hive.3980.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-19T17:35:02.093+0000","size":11700,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12569968/hive.3980.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12570078","id":"12570078","filename":"hive.3980.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-20T04:49:40.880+0000","size":25495,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12570078/hive.3980.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12571536","id":"12571536","filename":"hive.3980.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-01T04:15:58.998+0000","size":25495,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12571536/hive.3980.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12575160","id":"12575160","filename":"hive.3980.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-23T05:13:59.671+0000","size":25495,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12575160/hive.3980.4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"311456","customfield_12312823":null,"summary":"Cleanup after HIVE-3403","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13570002","id":"13570002","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"\ncommon/src/java/org/apache/hadoop/hive/conf/HiveConf.java\n503 ↗\n(On Diff #26877)\t\nBetter name: hive.auto.convert.sortmerge.join?\n504 ↗\n(On Diff #26877)\t\nhive.auto.convert.sortmerge.join.bigtable.selection.policy ?\nql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractBucketJoinProc.java\n108 ↗\n(On Diff #26877)\t\nWhy is this needed ? If orders[] = index for all i, this is not needed and if orders[] != index for some i, than we are partially updating orders[] which sounds dangerous.\n114 ↗\n(On Diff #26877)\t\nI think it makes more sense to do this check before looping over and comparing orders, since this is a stricter check, in a sense that if all join keys are not bucketed columns there is no point in checking order.\n98 ↗\n(On Diff #26877)\t\nBetter argument name: joinKeys ?\n99 ↗\n(On Diff #26877)\t\nBetter argument name: joinKeyOrders?\n80 ↗\n(On Diff #26877)\t\nBetter function name: getBucketFilePathOfPartition() ?\nAlso can you refactor this to return List<Path> instead, we had troubles because of String Vs Path interchangeable usage in Hive code base in past.\n97 ↗\n(On Diff #26877)\t\nComment for function ?\n\"This function checks whether all bucketing columns are also in join keys and are in same order.\"\n117 ↗\n(On Diff #26877)\t\nBetter function name: checkNumOfBucketsAgainstBigTable()?\n118 ↗\n(On Diff #26877)\t\nBetter param name: aliasToNumOfBuckets, NumOfBucketsInPartition ?\n182 ↗\n(On Diff #26877)\t\nThis function does bunch of checks to determine if join can be converted to bucketmapjoin. It will be good idea to list all the checks it performs in comments for this method.\n190 ↗\n(On Diff #26877)\t\nbetter name: tblAliasToNumOfBucketsInEachPartition ?\nActually, it seems that you can always derive this info from the next field, it is just the size of the innermost list in next map. If so, please consider getting rid of this map and just use next field wherever this one is required. \nHaving too many datastructures makes code harder to follow as well as results in tighter function coupling.\n192 ↗\n(On Diff #26877)\t\nbetter name: tblAliasToListOfBucketedFilePathInEachPartition?\n200–203 ↗\n(On Diff #26877)\t\nSimilar comment as the one above applies here as well.\n210 ↗\n(On Diff #26877)\t\nIn what case, topOp for the alias could be null. Is it a subquery case? Either case, please add a comment when this topOp could be null and why in that case we cannot join to BMJ.\n219 ↗\n(On Diff #26877)\t\nComment:\nWe cannot get to root TS operator, likely because there is a join or group-by between topOp and root TS operator. We don't handle that case, so we simply return.\n226 ↗\n(On Diff #26877)\t\nShould this be topOpEntry.getValue().equals(tso) instead ?\n361 ↗\n(On Diff #26877)\t\nThis function does bunch of checks to determine if mapjoin can be converted to bucketmapjoin. It will be good idea to list all the checks it performs in comments for this method.\n366 ↗\n(On Diff #26877)\t\nBetter name ?\n205 ↗\n(On Diff #26877)\t\nBetter name: joinKeyOrder?\nql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java\n87 ↗\n(On Diff #26877)\t\nComment:\nFirst check if this map-join operator is already a BMJ or not. If not give up we are only trying to convert a BMJ to sort-BMJ.\n121 ↗\n(On Diff #26877)\t\nIf table is not sorted, we cannot do sortBMJ anyways. Secondly we cannot do sortBMJ for outer joins either. Shouldn't this check be made much earlier?\n232 ↗\n(On Diff #26877)\t\nEarly parts of this method performs some of the same checks of checkConvertBucketMapJoin() of AbstractBucketJoinProc.java. Perhaps, we can refactor to avoid code duplication. Further, name isTableSorted is not correct, since it does much more than checking if table is sorted. Better name: isEligibleForSBMJ() ?\n462 ↗\n(On Diff #26877)\t\nThis should be a checked exception (perhaps of type SemanticException). Certainly, not RuntimeException.\nql/src/java/org/apache/hadoop/hive/ql/optimizer/AvgPartitionSizeSortMergeJoinBigTableMatcher.java\n41 ↗\n(On Diff #26877)\t\nBetter name: AvgPartitionSizeBasedTblSelectorForSMJ ?\n41 ↗\n(On Diff #26877)\t\nIs there a test for this policy ?\nql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketJoinOptProcCtx.java\n39 ↗\n(On Diff #26877)\t\nBetter name: rejectedJoinOps.\n42 ↗\n(On Diff #26877)\t\nBetter name: convertedJoinOps. Also, update the comment.\n60 ↗\n(On Diff #26877)\t\nName: getRejectedJoinOps ?\nAlso can similarly name other getters and setters of this class.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-04T05:55:01.613+0000","updated":"2013-02-04T05:55:01.613+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13581931","id":"13581931","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"https://reviews.facebook.net/D8703","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-20T04:15:40.861+0000","updated":"2013-02-20T04:15:40.861+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13581946","id":"13581946","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"cleanup patch -- only involves comments/changing variable names/function names etc.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-20T04:51:40.365+0000","updated":"2013-02-20T04:51:40.365+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13582021","id":"13582021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"Tests passed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-20T07:55:03.537+0000","updated":"2013-02-20T07:55:03.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13582267","id":"13582267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jarcec","name":"jarcec","key":"jarcec","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jarcec&avatarId=10641","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jarcec&avatarId=10641","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jarcec&avatarId=10641","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jarcec&avatarId=10641"},"displayName":"Jarek Jarcec Cecho","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 (non-binding)\n\nSeems as a reasonable changes to me.\n\nJacec","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jarcec","name":"jarcec","key":"jarcec","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jarcec&avatarId=10641","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jarcec&avatarId=10641","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jarcec&avatarId=10641","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jarcec&avatarId=10641"},"displayName":"Jarek Jarcec Cecho","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-02-20T16:00:48.533+0000","updated":"2013-02-20T16:00:48.533+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13584413","id":"13584413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Current patch doesn't address all the concerns.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-02-22T16:36:35.529+0000","updated":"2013-02-22T16:36:35.529+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13584520","id":"13584520","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"[~ashutoshc], which ones ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-22T18:35:11.312+0000","updated":"2013-02-22T18:35:11.312+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13589241","id":"13589241","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"[~ashutoshc], ping","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-02-28T06:20:52.826+0000","updated":"2013-02-28T06:20:52.826+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13590275","id":"13590275","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"Tests passed after refresh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-01T06:09:53.573+0000","updated":"2013-03-01T06:09:53.573+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13591601","id":"13591601","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"From the list you posted on this jira, I don't see any code changes/code comments/explanation for following changes:\n\n114 ↗\n(On Diff #26877)\t\nI think it makes more sense to do this check before looping over and comparing orders, since this is a stricter check, in a sense that if all join keys are not bucketed columns there is no point in checking order.\n\nAlso can you refactor this to return List<Path> instead, we had troubles because of String Vs Path interchangeable usage in Hive code base in past.\n\nActually, it seems that you can always derive this info from the next field, it is just the size of the innermost list in next map. If so, please consider getting rid of this map and just use next field wherever this one is required. \nHaving too many datastructures makes code harder to follow as well as results in tighter function coupling.\n\n200–203 ↗\n(On Diff #26877)\t\nSimilar comment as the one above applies here as well.\n\n(On Diff #26877)\t\nShould this be topOpEntry.getValue().equals(tso) instead ?\n\nOn Diff #26877)\t\nIf table is not sorted, we cannot do sortBMJ anyways. Secondly we cannot do sortBMJ for outer joins either. Shouldn't this check be made much earlier?\n\nEarly parts of this method performs some of the same checks of checkConvertBucketMapJoin() of AbstractBucketJoinProc.java. Perhaps, we can refactor to avoid code duplication.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-03T02:24:52.048+0000","updated":"2013-03-03T02:24:52.048+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13611144","id":"13611144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~namit] If you don't intend to work on this any further, lets get this committed as it is. As its already improving on current situation. I checked and current patch does apply. Let me know.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-22T19:50:54.256+0000","updated":"2013-03-22T19:50:54.256+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13611562","id":"13611562","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"Since this is a cleanup, let me get the current cleanup in (ofcourse after refreshing etc.)\nCan file a new patch for the remaining items ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-23T04:16:26.321+0000","updated":"2013-03-23T04:16:26.321+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13611564","id":"13611564","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"need to refresh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-23T04:16:41.882+0000","updated":"2013-03-23T04:16:41.882+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13611624","id":"13611624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"refreshed -- running tests again","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-23T05:15:59.037+0000","updated":"2013-03-23T05:15:59.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13611680","id":"13611680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"test passed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-03-23T11:33:45.973+0000","updated":"2013-03-23T11:33:45.973+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13613613","id":"13613613","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed to trunk. Thanks, Namit!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-26T08:28:35.046+0000","updated":"2013-03-26T08:28:35.046+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13615492","id":"13615492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-h0.21 #2033 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2033/])\n    HIVE-3980 : Cleanup after 3403 (Namit Jain via Ashutosh Chauhan) (Revision 1461012)\n\n     Result = ABORTED\nhashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1461012\nFiles : \n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractBucketJoinProc.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketJoinProcCtx.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-27T16:57:51.848+0000","updated":"2013-03-27T16:57:51.848+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12630612/comment/13623068","id":"13623068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-hadoop2 #138 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/138/])\n    HIVE-3980 : Cleanup after 3403 (Namit Jain via Ashutosh Chauhan) (Revision 1461012)\n\n     Result = FAILURE\nhashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1461012\nFiles : \n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractBucketJoinProc.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/AbstractSMBJoinProc.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/BucketJoinProcCtx.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2013-04-04T23:39:59.965+0000","updated":"2013-04-04T23:39:59.965+0000"}],"maxResults":18,"total":18,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3980/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1hovb:"}}