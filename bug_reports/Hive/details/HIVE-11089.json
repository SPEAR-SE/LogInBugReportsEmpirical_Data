{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12839995","self":"https://issues.apache.org/jira/rest/api/2/issue/12839995","key":"HIVE-11089","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2015-08-05T21:36:21.860+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jun 16 23:13:48 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_31014181725_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-06-16T23:14:15.405+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11089/watchers","watchCount":7,"isWatching":false},"created":"2015-06-24T00:11:13.747+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["ACID","Streaming"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329278","id":"12329278","description":"Branch 1.0 release","name":"1.0.0","archived":false,"released":true,"releaseDate":"2015-02-04"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329345","id":"12329345","description":"Hive 1.2.0","name":"1.2.0","archived":false,"released":true,"releaseDate":"2015-05-18"}],"issuelinks":[{"id":"12428727","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12428727","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12729565","key":"HIVE-7508","self":"https://issues.apache.org/jira/rest/api/2/issue/12729565","fields":{"summary":"Kerberos support for streaming","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12428711","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12428711","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12747398","key":"HIVE-8427","self":"https://issues.apache.org/jira/rest/api/2/issue/12747398","fields":{"summary":"Hive Streaming :  secure streaming hangs leading to time outs.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12474019","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12474019","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12984222","key":"HIVE-14114","self":"https://issues.apache.org/jira/rest/api/2/issue/12984222","fields":{"summary":"Ensure RecordWriter in streaming API is using the same UserGroupInformation as StreamingConnection","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wzheng","name":"wzheng","key":"wzheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wei Zheng","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-07-06T23:57:18.301+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320409","id":"12320409","name":"HCatalog","description":"Tracks issues related to the HCatalog"}],"timeoriginalestimate":null,"description":"HIVE-7508 \"Add Kerberos Support\" seems to also remove the ability to specify a proxy user.\n\nHIVE-8427 adds a call to ugi.hasKerberosCredentials() to check whether the connection is supposed to be a secure connection.\n\nThis however breaks support for Proxy Users as a proxy user UGI will always return false to hasKerberosCredentials().\n\nSee lines 273, 274 of HiveEndPoint.java\n{code}\nthis.secureMode = ugi==null ? false : ugi.hasKerberosCredentials();\nthis.msClient = getMetaStoreClient(endPoint, conf, secureMode);\n{code}\n\nIt also seems that between 13.1 and 0.14 the newConnection() method that includes a proxy user has been removed.\n\nfor reference: https://github.com/apache/hive/commit/8e423a12db47759196c24535fbc32236b79f464a","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Hive Streaming: connection fails when using a proxy user UGI","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adam.kunicki","name":"adam.kunicki","key":"adam.kunicki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=adam.kunicki&avatarId=25979","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=adam.kunicki&avatarId=25979","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=adam.kunicki&avatarId=25979","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=adam.kunicki&avatarId=25979"},"displayName":"Adam Kunicki","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adam.kunicki","name":"adam.kunicki","key":"adam.kunicki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=adam.kunicki&avatarId=25979","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=adam.kunicki&avatarId=25979","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=adam.kunicki&avatarId=25979","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=adam.kunicki&avatarId=25979"},"displayName":"Adam Kunicki","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12839995/comment/14598620","id":"14598620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adam.kunicki","name":"adam.kunicki","key":"adam.kunicki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=adam.kunicki&avatarId=25979","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=adam.kunicki&avatarId=25979","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=adam.kunicki&avatarId=25979","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=adam.kunicki&avatarId=25979"},"displayName":"Adam Kunicki","active":true,"timeZone":"America/Los_Angeles"},"body":"HIVE-8427 introduces a change that causes incorrect behavior when using a proxy user with HiveEndPoint.newConnection()","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adam.kunicki","name":"adam.kunicki","key":"adam.kunicki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=adam.kunicki&avatarId=25979","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=adam.kunicki&avatarId=25979","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=adam.kunicki&avatarId=25979","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=adam.kunicki&avatarId=25979"},"displayName":"Adam Kunicki","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-24T00:12:24.594+0000","updated":"2015-06-24T00:12:24.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12839995/comment/14598822","id":"14598822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adam.kunicki","name":"adam.kunicki","key":"adam.kunicki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=adam.kunicki&avatarId=25979","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=adam.kunicki&avatarId=25979","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=adam.kunicki&avatarId=25979","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=adam.kunicki&avatarId=25979"},"displayName":"Adam Kunicki","active":true,"timeZone":"America/Los_Angeles"},"body":"Additionally, it seems that the Hive docs https://cwiki.apache.org/confluence/display/Hive/Streaming+Data+Ingest reflect the HiveEndPoint API prior to HIVE-8427 which does allow for specifying a proxy user.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adam.kunicki","name":"adam.kunicki","key":"adam.kunicki","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=adam.kunicki&avatarId=25979","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=adam.kunicki&avatarId=25979","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=adam.kunicki&avatarId=25979","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=adam.kunicki&avatarId=25979"},"displayName":"Adam Kunicki","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-06-24T03:43:30.070+0000","updated":"2015-06-24T03:43:30.070+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12839995/comment/14658998","id":"14658998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"body":"[~roshan_naik] [~alangates] - any thoughts here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-08-05T21:36:21.860+0000","updated":"2015-08-05T21:36:21.860+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12839995/comment/14659125","id":"14659125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"body":"\n- That 'proxyUser' string argument was a parameter to a private method prior to kerberos support. it was never exposed externally and always set to null internally. At the time the thought was to support proxying but it never got fully tested. So I think i pulled it from the public interface very late in the dev cycle and did not reflect that in the wiki. I just updated the wiki.\n\n- With introduction of kerberos support, the internal 'proxyUser' was dropped, and UGI based 'authenticatedUser' argument  was exposed publicly ... in a new overload for newConnection(). So to acquire connection as a user other than process user, kerberos will be needed.\n\n- Wiki has a secure/kerberos example at the bottom. that should work.  API reference is in the Java Docs http://hive.apache.org/javadocs/r1.2.1/api/.   References to proxyUser in the javadocs need to be fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roshan_naik","name":"roshan_naik","key":"roshan_naik","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roshan Naik","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-08-05T22:51:39.437+0000","updated":"2015-08-05T22:51:39.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12839995/comment/14660537","id":"14660537","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi [~roshan_naik],\n\nI think the issue is that the code by using {{hasKerberosCredentials}} assumes kerberos for security. However that method will never return true when a user is a authenticated by a delegation token or when the user is real user is authenticated by kerberos, but the current UGI is a proxy user.\n\nBrock","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brocknoland","name":"brocknoland","key":"brocknoland","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brock Noland","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-08-06T18:09:56.838+0000","updated":"2015-08-06T18:09:56.838+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12839995/comment/15334922","id":"15334922","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wzheng","name":"wzheng","key":"wzheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wei Zheng","active":true,"timeZone":"America/Los_Angeles"},"body":"Had discussion with [~roshan_naik]. Looks like we didn't have proxy support for Hive streaming from day 1. As Roshan pointed out earlier, the \"proxyuser\" param was in a private method and was always null. The plan was to support proxy and that didn't happen (so the wiki was also updated).\n\nIf proxying is needed, this will be a new feature request. So I will close this ticket as invalid.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wzheng","name":"wzheng","key":"wzheng","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wei Zheng","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-06-16T23:13:48.266+0000","updated":"2016-06-16T23:13:48.266+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11089/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2gesn:"}}