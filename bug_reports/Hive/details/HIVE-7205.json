{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12720333","self":"https://issues.apache.org/jira/rest/api/2/issue/12720333","key":"HIVE-7205","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2014-06-19T09:40:38.485+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jun 29 11:09:22 UTC 2015","customfield_12310420":"398532","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7205/watchers","watchCount":3,"isWatching":false},"created":"2014-06-10T12:43:33.464+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324312","id":"12324312","description":"released","name":"0.12.0","archived":false,"released":true,"releaseDate":"2013-10-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324986","id":"12324986","description":"released","name":"0.13.0","archived":false,"released":true,"releaseDate":"2014-04-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326829","id":"12326829","description":"0.13 maintenance release 1","name":"0.13.1","archived":false,"released":true,"releaseDate":"2014-06-06"}],"issuelinks":[{"id":"12391011","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12391011","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12725885","key":"HIVE-7362","self":"https://issues.apache.org/jira/rest/api/2/issue/12725885","fields":{"summary":"Enabling Correlation Optimizer by default.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype","name":"Task","subtask":false,"avatarId":21148}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-06-29T11:09:22.966+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[],"timeoriginalestimate":null,"description":"use case :\n\ntable TBL (a string,b string) contains single row : 'a','a'\nthe following query :\n{code:sql}\nselect b, sum(cc) from (\n        select b,count(1) as cc from TBL group by b\n        union all\n        select a as b,count(1) as cc from TBL group by a\n) z\ngroup by b\n{code}\nreturns \n\na 1\na 1\nwhile set hive.optimize.correlation=true;\n\nif we change set hive.optimize.correlation=false;\nit returns correct results : a 2\n\n\n\nThe plan with correlation optimization :\n{code:sql}\nABSTRACT SYNTAX TREE:\n  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME DB TBL))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL b)) (TOK_SELEXPR (TOK_FUNCTION count 1) cc)) (TOK_GROUPBY (TOK_TABLE_OR_COL b)))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME DB TBL))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL a) b) (TOK_SELEXPR (TOK_FUNCTION count 1) cc)) (TOK_GROUPBY (TOK_TABLE_OR_COL a))))) z)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL b)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cc)))) (TOK_GROUPBY (TOK_TABLE_OR_COL b))))\n\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-0 is a root stage\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Map Reduce\n      Alias -> Map Operator Tree:\n        null-subquery1:z-subquery1:TBL \n          TableScan\n            alias: TBL\n            Select Operator\n              expressions:\n                    expr: b\n                    type: string\n              outputColumnNames: b\n              Group By Operator\n                aggregations:\n                      expr: count(1)\n                bucketGroup: false\n                keys:\n                      expr: b\n                      type: string\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Reduce Output Operator\n                  key expressions:\n                        expr: _col0\n                        type: string\n                  sort order: +\n                  Map-reduce partition columns:\n                        expr: _col0\n                        type: string\n                  tag: 0\n                  value expressions:\n                        expr: _col1\n                        type: bigint\n        null-subquery2:z-subquery2:TBL \n          TableScan\n            alias: TBL\n            Select Operator\n              expressions:\n                    expr: a\n                    type: string\n              outputColumnNames: a\n              Group By Operator\n                aggregations:\n                      expr: count(1)\n                bucketGroup: false\n                keys:\n                      expr: a\n                      type: string\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Reduce Output Operator\n                  key expressions:\n                        expr: _col0\n                        type: string\n                  sort order: +\n                  Map-reduce partition columns:\n                        expr: _col0\n                        type: string\n                  tag: 1\n                  value expressions:\n                        expr: _col1\n                        type: bigint\n      Reduce Operator Tree:\n        Demux Operator\n          Group By Operator\n            aggregations:\n                  expr: count(VALUE._col0)\n            bucketGroup: false\n            keys:\n                  expr: KEY._col0\n                  type: string\n            mode: mergepartial\n            outputColumnNames: _col0, _col1\n            Select Operator\n              expressions:\n                    expr: _col0\n                    type: string\n                    expr: _col1\n                    type: bigint\n              outputColumnNames: _col0, _col1\n              Union\n                Select Operator\n                  expressions:\n                        expr: _col0\n                        type: string\n                        expr: _col1\n                        type: bigint\n                  outputColumnNames: _col0, _col1\n                  Mux Operator\n                    Group By Operator\n                      aggregations:\n                            expr: sum(_col1)\n                      bucketGroup: false\n                      keys:\n                            expr: _col0\n                            type: string\n                      mode: complete\n                      outputColumnNames: _col0, _col1\n                      Select Operator\n                        expressions:\n                              expr: _col0\n                              type: string\n                              expr: _col1\n                              type: bigint\n                        outputColumnNames: _col0, _col1\n                        File Output Operator\n                          compressed: false\n                          GlobalTableId: 0\n                          table:\n                              input format: org.apache.hadoop.mapred.TextInputFormat\n                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n          Group By Operator\n            aggregations:\n                  expr: count(VALUE._col0)\n            bucketGroup: false\n            keys:\n                  expr: KEY._col0\n                  type: string\n            mode: mergepartial\n            outputColumnNames: _col0, _col1\n            Select Operator\n              expressions:\n                    expr: _col0\n                    type: string\n                    expr: _col1\n                    type: bigint\n              outputColumnNames: _col0, _col1\n              Union\n                Select Operator\n                  expressions:\n                        expr: _col0\n                        type: string\n                        expr: _col1\n                        type: bigint\n                  outputColumnNames: _col0, _col1\n                  Mux Operator\n                    Group By Operator\n                      aggregations:\n                            expr: sum(_col1)\n                      bucketGroup: false\n                      keys:\n                            expr: _col0\n                            type: string\n                      mode: complete\n                      outputColumnNames: _col0, _col1\n                      Select Operator\n                        expressions:\n                              expr: _col0\n                              type: string\n                              expr: _col1\n                              type: bigint\n                        outputColumnNames: _col0, _col1\n                        File Output Operator\n                          compressed: false\n                          GlobalTableId: 0\n                          table:\n                              input format: org.apache.hadoop.mapred.TextInputFormat\n                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n{code}\n\nPlan without correlation optimization :\n\n{code:sql}\nABSTRACT SYNTAX TREE:\n  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME DB TBL))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL b)) (TOK_SELEXPR (TOK_FUNCTION count 1) cc)) (TOK_GROUPBY (TOK_TABLE_OR_COL b)))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME DB TBL))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL a) b) (TOK_SELEXPR (TOK_FUNCTION count 1) cc)) (TOK_GROUPBY (TOK_TABLE_OR_COL a))))) z)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL b)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cc)))) (TOK_GROUPBY (TOK_TABLE_OR_COL b))))\n\nSTAGE DEPENDENCIES:\n  Stage-1 is a root stage\n  Stage-2 depends on stages: Stage-1, Stage-3\n  Stage-3 is a root stage\n  Stage-0 is a root stage\n\nSTAGE PLANS:\n  Stage: Stage-1\n    Map Reduce\n      Alias -> Map Operator Tree:\n        null-subquery2:z-subquery2:TBL \n          TableScan\n            alias: TBL\n            Select Operator\n              expressions:\n                    expr: a\n                    type: string\n              outputColumnNames: a\n              Group By Operator\n                aggregations:\n                      expr: count(1)\n                bucketGroup: false\n                keys:\n                      expr: a\n                      type: string\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Reduce Output Operator\n                  key expressions:\n                        expr: _col0\n                        type: string\n                  sort order: +\n                  Map-reduce partition columns:\n                        expr: _col0\n                        type: string\n                  tag: -1\n                  value expressions:\n                        expr: _col1\n                        type: bigint\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations:\n                expr: count(VALUE._col0)\n          bucketGroup: false\n          keys:\n                expr: KEY._col0\n                type: string\n          mode: mergepartial\n          outputColumnNames: _col0, _col1\n          Select Operator\n            expressions:\n                  expr: _col0\n                  type: string\n                  expr: _col1\n                  type: bigint\n            outputColumnNames: _col0, _col1\n            File Output Operator\n              compressed: false\n              GlobalTableId: 0\n              table:\n                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n\n  Stage: Stage-2\n    Map Reduce\n      Alias -> Map Operator Tree:\n        maprfs:/user/hadoop/tmp/hive/hive_2014-06-10_15-42-37_188_2403850033480056671-5/-mr-10002 \n          TableScan\n            Union\n              Select Operator\n                expressions:\n                      expr: _col0\n                      type: string\n                      expr: _col1\n                      type: bigint\n                outputColumnNames: _col0, _col1\n                Group By Operator\n                  aggregations:\n                        expr: sum(_col1)\n                  bucketGroup: false\n                  keys:\n                        expr: _col0\n                        type: string\n                  mode: hash\n                  outputColumnNames: _col0, _col1\n                  Reduce Output Operator\n                    key expressions:\n                          expr: _col0\n                          type: string\n                    sort order: +\n                    Map-reduce partition columns:\n                          expr: _col0\n                          type: string\n                    tag: -1\n                    value expressions:\n                          expr: _col1\n                          type: bigint\n        maprfs:/user/hadoop/tmp/hive/hive_2014-06-10_15-42-37_188_2403850033480056671-5/-mr-10003 \n          TableScan\n            Union\n              Select Operator\n                expressions:\n                      expr: _col0\n                      type: string\n                      expr: _col1\n                      type: bigint\n                outputColumnNames: _col0, _col1\n                Group By Operator\n                  aggregations:\n                        expr: sum(_col1)\n                  bucketGroup: false\n                  keys:\n                        expr: _col0\n                        type: string\n                  mode: hash\n                  outputColumnNames: _col0, _col1\n                  Reduce Output Operator\n                    key expressions:\n                          expr: _col0\n                          type: string\n                    sort order: +\n                    Map-reduce partition columns:\n                          expr: _col0\n                          type: string\n                    tag: -1\n                    value expressions:\n                          expr: _col1\n                          type: bigint\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations:\n                expr: sum(VALUE._col0)\n          bucketGroup: false\n          keys:\n                expr: KEY._col0\n                type: string\n          mode: mergepartial\n          outputColumnNames: _col0, _col1\n          Select Operator\n            expressions:\n                  expr: _col0\n                  type: string\n                  expr: _col1\n                  type: bigint\n            outputColumnNames: _col0, _col1\n            File Output Operator\n              compressed: false\n              GlobalTableId: 0\n              table:\n                  input format: org.apache.hadoop.mapred.TextInputFormat\n                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n\n  Stage: Stage-3\n    Map Reduce\n      Alias -> Map Operator Tree:\n        null-subquery1:z-subquery1:TBL \n          TableScan\n            alias: TBL\n            Select Operator\n              expressions:\n                    expr: b\n                    type: string\n              outputColumnNames: b\n              Group By Operator\n                aggregations:\n                      expr: count(1)\n                bucketGroup: false\n                keys:\n                      expr: b\n                      type: string\n                mode: hash\n                outputColumnNames: _col0, _col1\n                Reduce Output Operator\n                  key expressions:\n                        expr: _col0\n                        type: string\n                  sort order: +\n                  Map-reduce partition columns:\n                        expr: _col0\n                        type: string\n                  tag: -1\n                  value expressions:\n                        expr: _col1\n                        type: bigint\n      Reduce Operator Tree:\n        Group By Operator\n          aggregations:\n                expr: count(VALUE._col0)\n          bucketGroup: false\n          keys:\n                expr: KEY._col0\n                type: string\n          mode: mergepartial\n          outputColumnNames: _col0, _col1\n          Select Operator\n            expressions:\n                  expr: _col0\n                  type: string\n                  expr: _col1\n                  type: bigint\n            outputColumnNames: _col0, _col1\n            File Output Operator\n              compressed: false\n              GlobalTableId: 0\n              table:\n                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat\n                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\n\n  Stage: Stage-0\n    Fetch Operator\n      limit: -1\n{code}\n\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12651392","id":"12651392","filename":"HIVE-7205.1.patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-06-19T09:40:02.733+0000","size":27744,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12651392/HIVE-7205.1.patch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12651916","id":"12651916","filename":"HIVE-7205.2.patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-06-23T03:01:54.226+0000","size":29308,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12651916/HIVE-7205.2.patch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12653795","id":"12653795","filename":"HIVE-7205.3.patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-07-03T09:33:16.373+0000","size":45951,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12653795/HIVE-7205.3.patch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12673048","id":"12673048","filename":"HIVE-7205.4.patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-10-06T01:32:39.565+0000","size":45323,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12673048/HIVE-7205.4.patch.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"398657","customfield_12312823":null,"summary":"Wrong results when union all of grouping followed by group by with correlation optimization","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dimamah","name":"dimamah","key":"dimamah","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"dima machlin","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dimamah","name":"dimamah","key":"dimamah","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"dima machlin","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14037174","id":"14037174","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"Running preliminary test","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-06-19T09:40:38.485+0000","updated":"2014-06-19T09:40:38.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14039506","id":"14039506","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12651392/HIVE-7205.1.patch.txt\n\n{color:red}ERROR:{color} -1 due to 43 failed/errored test(s), 5669 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_auto_join18_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_count\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby2_map\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby2_map_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby2_map_skew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby2_noskew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby2_noskew_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby3_map\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby3_map_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby3_noskew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby3_noskew_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_bigdata\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_cube1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_map_ppr\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_map_ppr_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_multi_single_reducer\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_multi_single_reducer2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_ppr\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_ppr_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_rollup1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_sort_11\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_sort_8\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join18\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join18_multi_distinct\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_limit_pushdown\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_metadataonly1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_multi_insert_lateral_view\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_truncate_column_merge\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_count\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vectorization_limit\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vectorized_distinct_gby\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_count\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_dynpart_sort_optimization\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_groupby2\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_groupby3\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_limit_pushdown\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_bucket5\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_groupby2\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_infer_bucket_sort_reducers_power_two\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_ctas\norg.apache.hadoop.hive.ql.TestMTQueries.testMTQueries1\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/533/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/533/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-533/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 43 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12651392","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-06-20T23:02:41.015+0000","updated":"2014-06-20T23:02:41.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14049060","id":"14049060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12651916/HIVE-7205.2.patch.txt\n\n{color:red}ERROR:{color} -1 due to 16 failed/errored test(s), 5657 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer10\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer11\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer14\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer15\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer4\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer5\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer6\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer7\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer8\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer9\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_multiMapJoin2\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table\norg.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/648/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/648/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-648/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 16 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12651916","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-07-01T16:51:36.339+0000","updated":"2014-07-01T16:51:36.339+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14051489","id":"14051489","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12653795/HIVE-7205.3.patch.txt\n\n{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 5658 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table\norg.apache.hive.jdbc.miniHS2.TestHiveServer2.testConnection\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/671/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-Build/671/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-671/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 2 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12653795","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-07-03T14:19:03.215+0000","updated":"2014-07-03T14:19:03.215+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14053867","id":"14053867","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~yhuai] Can you review this one?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-07-07T17:05:04.289+0000","updated":"2014-07-07T17:05:04.289+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14054303","id":"14054303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"Sure. I will take a look at it.\n\nSeems the issue is that the MuxOperator for the last GroupByOperator cannot correctly determine when to call flush/endGroup/processGroup of the GroupByOperator because the UnionOperator creates a merging point of two branches in the operator tree.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-07-07T23:50:10.468+0000","updated":"2014-07-07T23:50:10.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14054383","id":"14054383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~yhuai] Exactly. I regret I've done too much modifications with the intention of simplifying interactions between operators. I'm good if you want to make a whole new patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-07-08T01:25:00.375+0000","updated":"2014-07-08T01:25:00.375+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14054454","id":"14054454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"[~navis] Simplifying interactions between operators is good. Let me spend sometime to understand the patch. My recent schedule is quite tight. I hope I can get you back late this week. Just want to double check. We will not have our next release for a while, right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-07-08T03:08:09.186+0000","updated":"2014-07-08T03:08:09.186+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14054599","id":"14054599","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~yhuai] Good! Take your time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-07-08T07:24:05.821+0000","updated":"2014-07-08T07:24:05.821+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14060383","id":"14060383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"[~navis] Thank you for the patch. I have left some comments at review board. In general, I feel that the logical on startGroup and endGroup is not very clear (my original implementation is not very clear either...). Can you explain the logic? So, I can better understand your change. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-07-14T06:54:11.655+0000","updated":"2014-07-14T06:54:11.655+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14069647","id":"14069647","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"Sorry for late reply. \n\nIn operator, there are startGroup()/endGroup()/flush() and no internal states for them, which is really confusing. So I've changed those to have similar cycle with initialize(), which means only when all parents are group-started, current operator can be group-started (same for end-group). You can imagine that \"endGroupIfNecessary\" in DeMux is not fit in this semantics. Thing are done like that. \n\nI think you can make whole better/simpler patch than this. Could you do that?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-07-22T01:14:06.986+0000","updated":"2014-07-22T01:14:06.986+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14081960","id":"14081960","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~yhuai] Did you get a chance to look at this one?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-08-01T06:10:47.777+0000","updated":"2014-08-01T06:10:47.777+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14082384","id":"14082384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"No yet. I will try to find sometime during the weekend.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-08-01T15:58:53.194+0000","updated":"2014-08-01T15:58:53.194+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14084158","id":"14084158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"My main concern is that because we use the right most table as the stream table, if hive.join.emit.interval is small, we can generate wrong results if we do not have endGroupIfNecessary.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-08-03T23:11:31.676+0000","updated":"2014-08-03T23:11:31.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14084215","id":"14084215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"Oh, I see. In the current patch, \"isLastInput\" takes special care for MuxOperator, so we will not generate wrong results. However, with this version, if my understanding is correct, we have to buffer rows from all tables in the reduce side join operator for cases like the last query in correlationoptimizer15.q (the right most table will not be streamable and we will have a higher memory footprint). I am not sure we want this behavior.\n\nI think one thing we may want to investigate is what will be the minimal change that can just fix the bug. I totally agree to improve the logic of startGroup()/endGroup()/flush(). I guess we need to have a clear plan first.\n\n[~ashutoshc] [~navis] I may not be able to come up with a patch soon. When will be our next release?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-08-04T01:47:36.336+0000","updated":"2014-08-04T01:47:36.336+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14091974","id":"14091974","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~yhuai] Since this is correctness issue, I think we should go ahead with Navis's fix, although as you pointed this may not be as performant as we want it to be. We can tackle performance issue with cleaner design once we have a clarity on it. In the meanwhile, fixing correctness issue looks prudent. What do you think?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-08-10T02:10:56.918+0000","updated":"2014-08-10T02:10:56.918+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14092308","id":"14092308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"[~ashutoshc]  IMO, [~yhuai] is original author of this optimizer and should get a chance to look into this. This is correctness issue but can be simply work-around by disabling the optimizer (which is disabled, by default). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2014-08-11T01:04:27.693+0000","updated":"2014-08-11T01:04:27.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14093129","id":"14093129","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"Yeah, fixing correctness bug is very important. \n\nHowever, the current patch also introduces a significant refactoring of the query evaluation path. I am not sure if this refactoring will not break other things. [~navis] Can you post a summary of how those operators work with your refactoring?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-08-11T18:41:46.219+0000","updated":"2014-08-11T18:41:46.219+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14160067","id":"14160067","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12673048/HIVE-7205.4.patch.txt\n\n{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 6525 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_stats_counter\norg.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler.testRevokeTimedOutWorkers\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1128/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1128/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1128/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 2 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12673048","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2014-10-06T07:34:06.255+0000","updated":"2014-10-06T07:34:06.255+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14173804","id":"14173804","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"body":"[~navis] Can you update the review board? I will take a look. Thank you.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhuai","name":"yhuai","key":"yhuai","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=yhuai&avatarId=23452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yhuai&avatarId=23452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yhuai&avatarId=23452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yhuai&avatarId=23452"},"displayName":"Yin Huai","active":true,"timeZone":"America/New_York"},"created":"2014-10-16T14:28:52.385+0000","updated":"2014-10-16T14:28:52.385+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12720333/comment/14605462","id":"14605462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dimamah","name":"dimamah","key":"dimamah","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"dima machlin","active":true,"timeZone":"Etc/UTC"},"body":"Will this patch be merged to future versions?\nUntil what version is it safe to apply this patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dimamah","name":"dimamah","key":"dimamah","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"dima machlin","active":true,"timeZone":"Etc/UTC"},"created":"2015-06-29T11:09:22.966+0000","updated":"2015-06-29T11:09:22.966+0000"}],"maxResults":21,"total":21,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-7205/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1wm1r:"}}