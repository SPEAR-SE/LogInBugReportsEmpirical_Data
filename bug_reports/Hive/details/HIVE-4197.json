{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12637457","self":"https://issues.apache.org/jira/rest/api/2/issue/12637457","key":"HIVE-4197","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323587","id":"12323587","description":"Hive 0.11.0","name":"0.11.0","archived":false,"released":true,"releaseDate":"2013-05-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-03-18T20:37:11.289+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Mar 28 21:55:23 UTC 2013","customfield_12310420":"317948","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_955122275_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-03-28T21:55:23.307+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4197/watchers","watchCount":6,"isWatching":false},"created":"2013-03-17T20:36:41.061+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12374609","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12374609","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12438744","key":"HIVE-896","self":"https://issues.apache.org/jira/rest/api/2/issue/12438744","fields":{"summary":"Add LEAD/LAG/FIRST/LAST analytical windowing functions to Hive.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-09-02T07:38:55.991+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320378","id":"12320378","name":"PTF-Windowing","description":"Partitioned Table Functions & Windowing"}],"timeoriginalestimate":null,"description":"The current behavior defers from the Standard in several significant places.\nPlease review attached doc; there are still a few open issues. Once we agree on the behavior, can proceed with fixing the implementation.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12575830","id":"12575830","filename":"WindowingSpecification.pdf","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-28T05:19:21.466+0000","size":178145,"mimeType":"application/pdf","content":"https://issues.apache.org/jira/secure/attachment/12575830/WindowingSpecification.pdf"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"318289","customfield_12312823":null,"summary":"Bring windowing support inline with SQL Standard","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13605597","id":"13605597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. Standard Compliance: we defer from the SQL standard here (Partition/Order spec), which only allows expressions to be Column References.\nI think we can keep allowing expressions. This is more powerful, subsumes column reference only and I don't see any confusion arising because of this.\n\nbq. the Sql Standard allows boundary amount to be any expression of type Unsigned Int. We are only allowing this to be a constant.\nWe are more restrictive than standard. But thats fine for now, we can improve on this later.\n\nbq. : we don’t plan to support this feature (window frame exclusion) in release 1.\nYeah.. lets defer this to later release.\n\nIn section 2, I didn't get the concept of source window spec and thereby subsequent points. Can you give an example in form of queries? That will help me formulate my opinion.\n\nbq.  How do we achieve this stable order? Any suggestions.\nThis implies we must enforce secondary sort in reduce sink, otherwise order of values for that key in reducer is unspecified. This effectively means that we are inserting an order spec. Since in this case, user has not specified an order spec, doing ordering on partitioning column is reasonable. I believe this is already the case in current implementation. Although this forces us to forgo some optimizations (predicate pushdown) but thats fine for first release. Later on, we can remember when we are introducing ordering ourselves vs when user has asked for it, to give those optimization rules a chance to fire. \n\nbq. FOLLOWING unsigned int NULL ANY ??\nI am also not clear what to do this in corner case. I think throwing an error is reasonable.\n\nbq. Speciﬁcation of a Range based Window: is not based on the Sort expression\nI think here we don't have a luxury to deviate from standard on this one. As you have noted this might be confusing. Better to remove it and be standard compliant. \n\nbq. • Notion of UDAFs that shouldn’t have a Window Frame: Rank, Dense_Rank, Percent_Rank, Cume_Dist, Lead, Lag are conﬁgured this way.\nI think its fine to keep existing behavior. Can't think of a use case where defining a window frame for these functions making sense.\n\nbq. Notion of Lead/Lag UDFs usable as arguments in UDAFs:\nI think we can keep this since it serves useful use case. Though if it is burdensome to implement or results in umaintainable code, I would prefer to remove it. So, I will leave this decision upto you.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-18T20:37:11.289+0000","updated":"2013-03-18T20:37:11.289+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13605646","id":"13605646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"Harish,\n\nThis is really helpful, thanks.  I have a few questions:\n\nSection 2.1, what is a Source Window Spec?\n\nSection 3, I can't see any way in an MR framework to guarantee order stability without adding an order clause.  I suppose we could add an implicit one that doesn't change the window frame, but that seems expensive.  I'd say just note that we don't guarantee a stable order here and if users want a stable order they should put in an order by.\n\nSection 3.1.2 The addition of +1 to all of the following specifications seems wrong.  If window definition says BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW I believe the spec stipulates that it will end at the current row, not one past the current row.  \n\nSection 3.1.3 \nWhere are we at on RANGE support?  I'm wondering if it would be better to focus on stabilizing ROWS support for now and adding RANGE support later.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-18T21:10:42.265+0000","updated":"2013-03-18T21:10:42.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13605743","id":"13605743","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"Ashutosh, thanks for reviewing.\n\n- agree with you on Partition/Order expressions, Boundary amount deviations from Standard.\n\n- Stable order issue:\nIt is not just restricted to when no order is specified. It also crops up when 2 rows have the same value on the Order expressions. This affects  the window frame and processing of functions that dependent on the order(rank,dense_rank...)\nOne thought is to add the FileName and FileOffset virtual columns to the Order Spec. \n\nSource Window Spec:\nas I understand this, it is the ability to reference another Window definition in the Query and inherit components from it. For e.g.\n\n{noformat}\nselect a,b, rank() over (w1 unbounded preceding and current row),\nfrom xyz\nwindow w1 (partition by x order by y)\n{noformat}\n\nThe effective window spec for rank() is:\n{noformat}\nrank() over (partition by x order by y w1 unbounded preceding and current row)\n{noformat}\n\nThe rule we have adopted is that each component Partition, Order, WindowFrame is independently inherited from a source Window Spec. Inheritance happens only if that component is not defined. As I said in the doc, it is not clear to me what the spec is mandating here.\n\n- Agree with your other points. \n1. The way we have Range Windows is confusing. Should associate it with the Order expression\n2. Don't see the point of allowing Windows on Lead, Lag, Rank etc.So then Jira 4192 can be resolved as '.working as designed'\n3. Lead/Lag UDFs will keep it in for now; but may remove if it becomes hard to maintain","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-18T22:23:38.994+0000","updated":"2013-03-18T22:23:38.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13605750","id":"13605750","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"Alan, thanks for reviewing.\n\n- Have explained the concept of Source Windowspec in the previous response to Ashutosh.\n- The stable sort issue also crops up when there multiple rows with the same Order expressions. Again, see previous response.\n- The Window Frame Range I was documenting was [start,end), so the end side is open ended. This an artifact of our implementation...\n- Range support is there; I think the changes we need to make are manageable. But if we run into major blocks, then agree we can defer this. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-18T22:30:32.455+0000","updated":"2013-03-18T22:30:32.455+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13607942","id":"13607942","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~alangates] Stable sort issue seems to be an important one, especially since because of shuffle enhancements between hadoop1 and hadoop2 sort is not stable between two for same query. Harish's proposal is to always add filename and file offset virtual column which I think will enforce stable sort. In absence of any other solution, this looks like fine to me. Do you think we can do any better? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-20T18:11:51.944+0000","updated":"2013-03-20T18:11:51.944+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13608243","id":"13608243","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. Stable sort issue seems to be an important one ...\n\nYeah, I hadn't thought about the point that even in ORDER BY our sort needs to be stable in order to give consistent results.  It sucks that we have to introduce a sort even in queries without an ORDER BY, but oh well.  I agree that FileName and FileOffset are a good proxy, as that will maintain stability in the sort.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-20T21:25:53.259+0000","updated":"2013-03-20T21:25:53.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13609987","id":"13609987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"Adding FileName, Offset Virtual Columns is not straightforward.\nConsider the following query:\n{noformat}\nselect p_mfgr, p_name, p_size, \nmin(p_retailprice),\nrank() over(partition by p_mfgr order by p_name)as r\nfrom part\ngroup by p_mfgr, p_name, p_size\n{noformat}\nAdding the VCs to the OrderSpec for rank requires that we add them to the Select List also; otherwise we get the error: Expression not in GROUP BY key 'INPUT__FILE__NAME'\n\nIt gets more challenging if the Query has Joins or SubQueries. \nIt will not work if the Query has a PTF(a PTF is not required to output the VCs).\nAny suggestions?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-22T06:26:02.596+0000","updated":"2013-03-22T06:26:02.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13610242","id":"13610242","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Hmm.. One way I can think of is to sort rows ourselves. We need to add an extra column in mapper (combination of task.id and monotonic increasing row number) and than in PTFOperator have an implementation of ByteBasedList which uses Priority Queue to store data in memory instead of ByteBuffer. This Priority Queue will insert data in order of this new column we added and dropping it soon after.\nHowever, this seems to me is pretty heavy-handed approach. I will prefer something simpler. Harish, this problem of stable sort is getting exposed only on hadoop2, so I will suggest for now lets focus on other issues as we think and come up with a better solution for it, since on hadoop1 we don't have such a problem.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-22T13:07:17.427+0000","updated":"2013-03-22T13:07:17.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13613618","id":"13613618","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"https://reviews.facebook.net/D9717 Review request on behalf of [~rhbutani]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-26T08:36:08.517+0000","updated":"2013-03-26T08:36:08.517+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13616062","id":"13616062","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"body":"upload updated doc.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-28T05:19:53.126+0000","updated":"2013-03-28T05:19:53.126+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12637457/comment/13616700","id":"13616700","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed to branch. Thanks, Harish!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-28T21:55:23.330+0000","updated":"2013-03-28T21:55:23.330+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-4197/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1iv1b:"}}