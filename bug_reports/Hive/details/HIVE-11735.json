{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12861793","self":"https://issues.apache.org/jira/rest/api/2/issue/12861793","key":"HIVE-11735","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-09-22T23:35:02.955+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jan 18 19:03:33 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1605742309_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_10178956385","customfield_12312321":null,"resolutiondate":"2016-01-18T19:03:33.710+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11735/watchers","watchCount":3,"isWatching":false},"created":"2015-09-04T09:31:55.103+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329278","id":"12329278","description":"Branch 1.0 release","name":"1.0.0","archived":false,"released":true,"releaseDate":"2015-02-04"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12329557","id":"12329557","name":"1.1.1","archived":false,"released":true,"releaseDate":"2015-05-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[{"id":"12454754","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12454754","type":{"id":"12310051","name":"Supercedes","inward":"is superceded by","outward":"supercedes","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310051"},"inwardIssue":{"id":"12918677","key":"HIVE-12590","self":"https://issues.apache.org/jira/rest/api/2/issue/12918677","fields":{"summary":"Repeated UDAFs with literals can produce incorrect result","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-02-16T23:50:44.728+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324798","id":"12324798","name":"Query Planning"}],"timeoriginalestimate":null,"description":"Hive if() udf is returns different results when string equality is used as condition, with case change. \nObservation:\n   1) if( name = 'chetna' , 3, 4) and if( name = 'Chetna', 3, 4) both are treated as equal.\n   2) The rightmost udf result is pushed to predicates on left side. Leading to same result for both the udfs.\n\nHow to reproduce the issue:\n1) CREATE TABLE `sample`(\n  `name` string)\nROW FORMAT SERDE\n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'\nSTORED AS INPUTFORMAT\n  'org.apache.hadoop.mapred.TextInputFormat'\nOUTPUTFORMAT\n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nTBLPROPERTIES (\n  'transient_lastDdlTime'='1425075745');\n\n2) insert into table sample values ('chetna');\n3) select min(if(name = 'chetna', 4, 3)) , min(if(name='Chetna', 4, 3))  from sample; \n    This will give result : \n    3    3\n    Expected result:\n    4    3\n4) select min(if(name = 'Chetna', 4, 3)) , min(if(name='chetna', 4, 3))  from sample; \n    This will give result \n    4    4\n    Expected result:\n    3    4\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12754389","id":"12754389","filename":"HIVE-11735.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-09-06T11:03:13.367+0000","size":4531,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12754389/HIVE-11735.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Different results when multiple if() functions are used ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14732343","id":"14732343","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"Issue is occurring while generating OPTree . \nCauses:\n1) lowercase conversion of table and column aliases in RowResolver class.\n2) Also in genSelectPlan, the aggregations are first converted to lowercase and then added to aggregations map.\n\nRemoving the toLowerCase() call from mentioned places resolved the issue for group by aggregations. \nNote this issue will happen in case of all aggregations, joins and select, the same logic is there for other operators too.\nWould like to contribute the patch if everyone agrees on the change. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-09-06T10:45:25.433+0000","updated":"2015-09-06T10:45:25.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14732348","id":"14732348","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"Attaching patch for the suggested approach. Please review it. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-09-06T11:03:13.370+0000","updated":"2015-09-06T11:03:13.370+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14903659","id":"14903659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~chetna], could you please update the \"affected version\"?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xuefuz","name":"xuefuz","key":"xuefuz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Xuefu Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-22T23:35:02.955+0000","updated":"2015-09-22T23:35:02.955+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14905244","id":"14905244","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:red}Overall{color}: -1 at least one tests failed\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12754389/HIVE-11735.patch\n\n{color:red}ERROR:{color} -1 due to 148 failed/errored test(s), 9578 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_auto_join10\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_auto_join30\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_auto_join31\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_bucketmapjoin_negative3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_case_sensitivity\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_join\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_rp_cross_product_check_2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_rp_join\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_rp_semijoin\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_semijoin\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_column_access_stats\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_correlationoptimizer11\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_create_view\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cross_product_check_1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cross_product_check_2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_decimal_6\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_dynamic_rdd_cache\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_explain_dependency\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_explain_logical\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby10\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby7\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby7_map\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby7_map_multi_single_reducer\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby7_map_skew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby7_noskew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby7_noskew_multi_single_reducer\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby8\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby8_map\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby8_map_skew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby8_noskew\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby9\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_complex_types\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_complex_types_multi_single_reducer\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_distinct_samekey\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_grouping_window\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_multi_single_reducer3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_groupby_position\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_having\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input16\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input22\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input4\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input4_cb_delim\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input_lazyserde\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input_part7\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_inputddl5\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_inputddl7\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join10\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join40\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join42\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join_array\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join_casesensitive\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lateral_view\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lateral_view_noalias\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lateral_view_onview\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lateral_view_outer\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lateral_view_ppd\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_limit_pushdown_negative\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lineage2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lineage3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_load_dyn_part14\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_multiMapJoin1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_multigroupby_singlemr\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_rcfile_bigdata\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_reduce_deduplicate_exclude_gby\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_runtime_skewjoin_mapjoin_spark\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_skewjoin\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_notin\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_table_access_keys_stats\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_inline\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union18\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union19\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_unionDistinct_1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union_ppr\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_unionall_unbalancedppd\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_decimal_6\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_groupby_reduce\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_join30\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vectorization_part\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vectorization_part_varchar\norg.apache.hadoop.hive.cli.TestContribCliDriver.testCliDriver_udtf_output_on_close\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_ppd_join\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_queries\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_timestamp\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_input16_cc\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_leftsemijoin_mr\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_auto_join30\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_cbo_join\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_cbo_semijoin\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_cross_product_check_1\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_cross_product_check_2\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_explainuser_1\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_having\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_skewjoin\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_unionDistinct_1\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_decimal_6\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_groupby_reduce\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_join30\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vectorization_part\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_input16_cc\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_leftsemijoin_mr\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_ql_rewrite_gbtoidx_cbo_2\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_join_cond_unqual_ambiguous_vc\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_auto_join10\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_auto_join30\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_auto_join31\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_bucketmapjoin_negative3\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_cbo_semijoin\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_column_access_stats\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_cross_product_check_1\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_cross_product_check_2\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_dynamic_rdd_cache\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby10\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby7\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby7_map\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby7_map_multi_single_reducer\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby7_map_skew\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby7_noskew\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby7_noskew_multi_single_reducer\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby8\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby8_map\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby8_map_skew\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby8_noskew\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby9\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby_complex_types\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby_complex_types_multi_single_reducer\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby_multi_single_reducer3\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_groupby_position\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_having\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join10\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join40\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join_array\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join_casesensitive\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_leftsemijoin_mr\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_load_dyn_part14\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_multigroupby_singlemr\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_rcfile_bigdata\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_runtime_skewjoin_mapjoin_spark\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_skewjoin\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_table_access_keys_stats\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_union18\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_union19\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_union_ppr\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_vectorization_part\norg.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn\norg.apache.hadoop.hive.ql.TestTxnCommands2.testInsertOverwriteWithSelfJoin\norg.apache.hive.hcatalog.api.TestHCatClient.testTableSchemaPropagation\norg.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchCommit_Json\norg.apache.hive.service.cli.TestEmbeddedThriftBinaryCLIService.testExecuteStatementParallel\n{noformat}\n\nTest results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5389/testReport\nConsole output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5389/console\nTest logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5389/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 148 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12754389 - PreCommit-HIVE-TRUNK-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2015-09-23T21:01:09.325+0000","updated":"2015-09-23T21:01:09.325+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14906596","id":"14906596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"[~xuefuz] I tested it on master branch, but we use 1.0.0, 0.14.0 and 1.2.1 in our production where we have noticed this issue. I made the changes only for groupby case, but since its a change in RowResolver class, it failing for other cases. Will fix it for all cases, and will submit the patch again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-09-24T16:27:29.224+0000","updated":"2015-09-24T16:27:29.224+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14961904","id":"14961904","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"[~ashutoshc]: This issue will occur in all queries wherever there are predicates based on case sensitive data. Any thoughts on whether I should proceed with fixing it for all. Because changing RowResolver class is causing test failures in other queries. Or its by design?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-10-17T13:28:51.827+0000","updated":"2015-10-17T13:28:51.827+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14962009","id":"14962009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I think problem here stems from \n{code}\naggregations.put(expressionTree.toStringTree().toLowerCase(), expressionTree);\n{code}\n\nI think for your particular query if you remove {{toLowerCase()}} would solve your problem. Do you really need other changes for column aliases and such in RR?\n\nIntent for this map is to detect duplicate functions in aggregations, so that we are not computing them twice. However, this is blindly doing {{toLoweCase()}} on full expression Tree, ignoring the fact that there might be constant literals in there. There are two possible solutions here : \n\n* Eliminate this logic altogether from this phase. Don't bother about duplicates in phase 1 analysis. Instead write a rule either on Calcite operator tree or Hive operator tree which walks on expressions and detects duplicates and fixes up operator tree to refer to 1 expression tree.\n* Write a utility function which takes expression tree as an argument and returns lower case version of its string tree, while leaving constant string literals in original case. Then use this string representation as a key in that map.\n\nIMHO, Option 1 is a cleaner approach. However, that might be a big change touching various pieces in planning.\nOption 2 is much more local and contained change, but kinda inelegant.\n\ncc: [~jpullokkaran] if he has other ideas. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-17T17:47:37.241+0000","updated":"2015-10-17T17:47:37.241+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/14963337","id":"14963337","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"body":"[~ashutoshc]: Changes in column aliases and RR are needed, because we use RR for intermediate tables too. While debugging I have noticed that all predicates becomes column aliases for intermediate tables. So for my query it was creating only one column due to toLowerCase(). Please correct if I am wrong.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chetna","name":"chetna","key":"chetna","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chetna Chaudhari","active":true,"timeZone":"Pacific/Auckland"},"created":"2015-10-19T13:56:47.711+0000","updated":"2015-10-19T13:56:47.711+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12861793/comment/15105673","id":"15105673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"This is now fixed via HIVE-12590","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-01-18T19:03:33.747+0000","updated":"2016-01-18T19:03:33.747+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11735/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2js8v:"}}