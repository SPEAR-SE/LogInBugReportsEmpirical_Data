{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12536077","self":"https://issues.apache.org/jira/rest/api/2/issue/12536077","key":"HIVE-2671","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2011-12-21 19:56:54.825","customfield_12310420":"221760","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2671/watchers","watchCount":1,"isWatching":false},"created":"2011-12-21T19:56:54.825+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-12-21T19:56:54.825+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313585","id":"12313585","name":"UDF","description":"This includes the UDFs and UDAFs"}],"timeoriginalestimate":null,"description":"When running a query that uses GenericUDTFJSONTuple there is a chance to hit a very nasty bug.\nIf the write pipeline fails the task will not detect this and will simply start skipping all the rows in the input.\n\nThe UDTF has a catch (Throwable) that catches an IOException and forwards null rows, which my guess is are filtered out by the filter operator down the line so the map task never tries to write them out.\n\nThis happens for every row in the input.\nas a result the query runs forever since it produces a log message for every row (we've seen tasks run for 20 hours instead of 20 minutes)\n\nThis is a stack trace of one of the tasks just in case:\nat org.apache.hadoop.io.compress.zlib.ZlibCompressor.deflateBytesDirect(Native Method)\nat org.apache.hadoop.io.compress.zlib.ZlibCompressor.compress(ZlibCompressor.java:315)\n- locked <0x000000009c174f78> (a org.apache.hadoop.io.compress.GzipCodec$GzipZlibCompressor)\nat org.apache.hadoop.io.compress.CompressorStream.compress(CompressorStream.java:76)\nat org.apache.hadoop.io.compress.CompressorStream.write(CompressorStream.java:71)\nat java.io.BufferedOutputStream.write(BufferedOutputStream.java:105)\n- locked <0x000000009c18d4f8> (a java.io.BufferedOutputStream)\nat java.io.DataOutputStream.write(DataOutputStream.java:90)\n- locked <0x000000009c18d4d8> (a java.io.DataOutputStream)\nat org.apache.hadoop.hive.ql.io.RCFile$Writer.flushRecords(RCFile.java:894)\nat org.apache.hadoop.hive.ql.io.RCFile$Writer.append(RCFile.java:875)\nat org.apache.hadoop.hive.ql.io.RCFileOutputFormat$2.write(RCFileOutputFormat.java:140)\nat org.apache.hadoop.hive.ql.exec.FileSinkOperator.processOp(FileSinkOperator.java:592)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.SelectOperator.processOp(SelectOperator.java:84)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.FilterOperator.processOp(FilterOperator.java:132)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.LateralViewJoinOperator.processOp(LateralViewJoinOperator.java:133)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.UDTFOperator.forwardUDTFOutput(UDTFOperator.java:112)\nat org.apache.hadoop.hive.ql.udf.generic.UDTFCollector.collect(UDTFCollector.java:44)\nat org.apache.hadoop.hive.ql.udf.generic.GenericUDTF.forward(GenericUDTF.java:81)\nat org.apache.hadoop.hive.ql.udf.generic.GenericUDTFJSONTuple.process(GenericUDTFJSONTuple.java:167)\nat org.apache.hadoop.hive.ql.exec.UDTFOperator.processOp(UDTFOperator.java:98)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.SelectOperator.processOp(SelectOperator.java:84)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.LateralViewForwardOperator.processOp(LateralViewForwardOperator.java:37)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.FilterOperator.processOp(FilterOperator.java:132)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.TableScanOperator.processOp(TableScanOperator.java:83)\nat org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)\nat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)\nat org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:531)\nat org.apache.hadoop.hive.ql.exec.ExecMapper.map(ExecMapper.java:143)\nat org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)\nat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:368)\nat org.apache.hadoop.mapred.MapTask.run(MapTask.java:309)\nat org.apache.hadoop.mapred.Child.main(Child.java:162)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"124064","customfield_12312823":null,"summary":"GenericUDTFJSONTuple ignores IOExceptions","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dms","name":"dms","key":"dms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dmytro Molkov","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dms","name":"dms","key":"dms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dmytro Molkov","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2671/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ll2n:"}}