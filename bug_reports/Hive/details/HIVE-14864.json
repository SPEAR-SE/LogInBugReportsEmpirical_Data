{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13008775","self":"https://issues.apache.org/jira/rest/api/2/issue/13008775","key":"HIVE-14864","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12340269","id":"12340269","name":"2.3.0","archived":false,"released":true,"releaseDate":"2017-07-18"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-09-30T19:39:33.032+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Apr 24 20:25:23 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1203947231_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_12784145021","customfield_12312321":null,"resolutiondate":"2017-03-10T22:23:54.385+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14864/watchers","watchCount":6,"isWatching":false},"created":"2016-09-30T00:49:02.210+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-05-07T18:49:25.818+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"In FileUtils.java the following code does not get executed even when src directory size is greater than HIVE_EXEC_COPYFILE_MAXSIZE because \nsrcFS.getFileStatus(src).getLen() returns 0 when src is a directory. We should use srcFS.getContentSummary(src).getLength() instead.\n\n{noformat}\n    /* Run distcp if source file/dir is too big */\n    if (srcFS.getUri().getScheme().equals(\"hdfs\") &&\n        srcFS.getFileStatus(src).getLen() > conf.getLongVar(HiveConf.ConfVars.HIVE_EXEC_COPYFILE_MAXSIZE)) {\n      LOG.info(\"Source is \" + srcFS.getFileStatus(src).getLen() + \" bytes. (MAX: \" + conf.getLongVar(HiveConf.ConfVars.HIVE_EXEC_COPYFILE_MAXSIZE) + \")\");\n      LOG.info(\"Launch distributed copy (distcp) job.\");\n      HiveConfUtil.updateJobCredentialProviders(conf);\n      copied = shims.runDistCp(src, dst, conf);\n      if (copied && deleteSource) {\n        srcFS.delete(src, true);\n      }\n    }\n{noformat}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12833308","id":"12833308","filename":"HIVE-14864.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-14T06:06:24.553+0000","size":3146,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12833308/HIVE-14864.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12833472","id":"12833472","filename":"HIVE-14864.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-14T23:14:35.980+0000","size":3147,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12833472/HIVE-14864.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12854547","id":"12854547","filename":"HIVE-14864.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-24T18:47:02.276+0000","size":4174,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12854547/HIVE-14864.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12856936","id":"12856936","filename":"HIVE-14864.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-09T04:23:19.920+0000","size":11136,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12856936/HIVE-14864.4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12833234","id":"12833234","filename":"HIVE-14864.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-13T23:14:34.919+0000","size":3684,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12833234/HIVE-14864.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Distcp is not called from MoveTask when src is a directory","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15536842","id":"15536842","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"body":"Does srcFS.getContentSummary(src).getLength() return total number of files in the directory ? \n\nI think this whole condition needs to be re-thought. Because AFAIK, DistCp speeds up copies when multiple\nfiles are involved. There is no advantage in DistCp'ing a single file, no matter how big that file. Which means\nHIVE_EXEC_COPYFILE_MAXSIZE does not make sense even for a file.\n\nIOW, we need to look into DistCp'ing directories only, and possibly ones which contain more than a threshold\nnumber of files.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohitsabharwal","name":"mohitsabharwal","key":"mohitsabharwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohit Sabharwal","active":true,"timeZone":"America/New_York"},"created":"2016-09-30T19:39:33.032+0000","updated":"2016-09-30T19:39:33.032+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15536870","id":"15536870","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"body":"Unfortunately, the documentation of ContentSummary.getLength() says ... returns the length :)\n\nThis is the implementation of getContentSummary() in FileSystem.java which suggests getLength is actually returning the sum of lengths of all the files within that directory.\n\n{noformat}\n  public ContentSummary getContentSummary(Path f) throws IOException {\n    FileStatus status = getFileStatus(f);\n    if (status.isFile()) {\n      // f is a file\n      return new ContentSummary(status.getLen(), 1, 0);\n    }\n    // f is a directory\n    long[] summary = {0, 0, 1};\n    for(FileStatus s : listStatus(f)) {\n      ContentSummary c = s.isDirectory() ? getContentSummary(s.getPath()) :\n                                     new ContentSummary(s.getLen(), 1, 0);\n      summary[0] += c.getLength();\n      summary[1] += c.getFileCount();\n      summary[2] += c.getDirectoryCount();\n    }\n    return new ContentSummary(summary[0], summary[1], summary[2]);\n  }\n{noformat}\n\nThese are the revelant constructors for ContentSummary.\n{noformat}\n  /** Constructor */\n  public ContentSummary(long length, long fileCount, long directoryCount) {\n    this(length, fileCount, directoryCount, -1L, length, -1L);\n  }\n\n  public ContentSummary(\n      long length, long fileCount, long directoryCount, long quota,\n      long spaceConsumed, long spaceQuota) {\n    this.length = length;\n    this.fileCount = fileCount;\n    this.directoryCount = directoryCount;\n    this.quota = quota;\n    this.spaceConsumed = spaceConsumed;\n    this.spaceQuota = spaceQuota;\n  }\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-30T19:49:13.394+0000","updated":"2016-09-30T19:49:13.394+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15536922","id":"15536922","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"body":"I looked into distcp documentation and I think you are right. It creates a list of files to be copied if src is a directory and this list is divided among a bunch of CopyMappers to do the actual copy. Do you have any ideas as to how should we evaluate the threshold of number of files when distcp is beneficial?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-30T20:11:08.535+0000","updated":"2016-09-30T20:11:08.535+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15536925","id":"15536925","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"body":"Adding [~spena] since he has worked on this before.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vihangk1","name":"vihangk1","key":"vihangk1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vihang Karajgaonkar","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-30T20:11:37.679+0000","updated":"2016-09-30T20:11:37.679+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15536989","id":"15536989","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"I run some tests with directories, and distcp is indeed faster than copying files one at a time. I don't know the threshold, we should investigate with different files to see it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2016-09-30T20:31:02.126+0000","updated":"2016-09-30T20:31:33.794+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15573503","id":"15573503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"Attaching a pre-lim patch just for reference. The patch is still a WIP.\n\nChanges are pretty simple, {{FileUtils.copy}} uses {{getContentSummary}} to get the number of files under the folder. It triggers a Distcp job based on the size of files under the folder + the number of files under the folder.\n\nIf only a single file needs to be copied, the {{ContentSummary}} length will be the size of that file, and the number of files under it will be 1.\n\nFor now the logic is pretty simple, if the number of files exceeds a threshold set by {{hive.exec.copyfile.maxnumfiles}} (which defaults to 1) and the size of the files exceeds a threshold set by hive.exec.copyfile.maxsize (which defaults to 32 MB), the Distcp job will be triggered.\n\nSo basically any folder that contains more than 1 file and whose total contents is greater than 32 MB.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-13T23:14:34.923+0000","updated":"2016-10-13T23:14:34.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15573955","id":"15573955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12833234/HIVE-14864.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 89 failed/errored test(s), 10534 tests executed\n*Failed tests:*\n{noformat}\nTestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[autoColumnStats_7]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[crtseltbl_serdeprops]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cte_3]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cte_4]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cte_mat_4]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cte_mat_5]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_00_nonpart_empty]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_01_nonpart]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_02_00_part_empty]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_02_part]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_03_nonpart_over_compat]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_04_all_part]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_04_evolved_parts]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_05_some_part]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_06_one_part]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_07_all_part_over_nonoverlap]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_08_nonpart_rename]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_09_part_spec_nonoverlap]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_10_external_managed]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_11_managed_external]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_12_external_location]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_13_managed_location]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_14_managed_location_over_existing]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_15_external_part]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_16_part_external]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_17_part_managed]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_18_part_external]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_19_00_part_external_location]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_19_part_external_location]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_20_part_managed_location]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_21_export_authsuccess]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_22_import_exist_authsuccess]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_23_import_part_authsuccess]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_24_import_nonexist_authsuccess]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_25_export_parentpath_has_inaccessible_children]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[exim_hidden_files]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[foldts]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[masking_9]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[materialized_view_describe]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[reloadJar]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[repl_2_exim_basic]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[repl_3_exim_metadata]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats_partial_size]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[temp_table]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[temp_table_gb1]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[temp_table_join1]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[temp_table_subquery1]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_tablesample_rows]\norg.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_load_data_to_encrypted_tables]\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[import_exported_table]\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[import_exported_table]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[authorization_import]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[ctas_noemptyfolder]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_01_nonpart_over_loaded]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_02_all_part_over_overlap]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_03_nonpart_noncompat_colschema]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_04_nonpart_noncompat_colnumber]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_05_nonpart_noncompat_coltype]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_06_nonpart_noncompat_storage]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_07_nonpart_noncompat_ifof]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_08_nonpart_noncompat_serde]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_09_nonpart_noncompat_serdeparam]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_10_nonpart_noncompat_bucketing]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_11_nonpart_noncompat_sorting]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_13_nonnative_import]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_14_nonpart_part]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_15_part_nonpart]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_16_part_noncompat_schema]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_17_part_spec_underspec]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_18_part_spec_missing]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_19_external_over_existing]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_20_managed_location_over_existing]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_21_part_managed_external]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_23_import_exist_authfail]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_24_import_part_authfail]\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[exim_25_import_nonexist_authfail]\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[temp_table]\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[temp_table_gb1]\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[temp_table_join1]\norg.apache.hadoop.hive.ql.history.TestHiveHistory.testHiveHistoryConfigDisabled\norg.apache.hadoop.hive.ql.history.TestHiveHistory.testHiveHistoryConfigEnabled\norg.apache.hadoop.hive.ql.history.TestHiveHistory.testQueryloglocParentDirNotExist\norg.apache.hadoop.hive.ql.history.TestHiveHistory.testSimpleQuery\norg.apache.hadoop.hive.ql.security.TestExtendedAcls.testExim\norg.apache.hadoop.hive.ql.security.TestFolderPermissions.testExim\norg.apache.hive.hcatalog.api.repl.commands.TestCommands.testBasicReplEximCommands\norg.apache.hive.hcatalog.api.repl.commands.TestCommands.testMetadataReplEximCommands\norg.apache.hive.hcatalog.api.repl.commands.TestCommands.testNoopReplEximCommands\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/1546/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/1546/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-Build-1546/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 89 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12833234 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-10-14T02:50:51.485+0000","updated":"2016-10-14T02:50:51.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15575303","id":"15575303","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12833308/HIVE-14864.1.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 20 failed/errored test(s), 10522 tests executed\n*Failed tests:*\n{noformat}\nTestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_globallimit]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[order_null]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[reloadJar]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union_fast_stats]\norg.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_load_data_to_encrypted_tables]\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver[hbase_bulk]\norg.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[import_exported_table]\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[import_exported_table]\norg.apache.hadoop.hive.ql.security.TestExtendedAcls.testExim\norg.apache.hadoop.hive.ql.security.TestFolderPermissions.testExim\norg.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0]\norg.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0]\norg.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1]\norg.apache.hive.jdbc.TestNoSaslAuth.org.apache.hive.jdbc.TestNoSaslAuth\norg.apache.hive.jdbc.authorization.TestHS2AuthzContext.org.apache.hive.jdbc.authorization.TestHS2AuthzContext\norg.apache.hive.jdbc.authorization.TestHS2AuthzSessionContext.org.apache.hive.jdbc.authorization.TestHS2AuthzSessionContext\norg.apache.hive.jdbc.authorization.TestJdbcMetadataApiAuth.org.apache.hive.jdbc.authorization.TestJdbcMetadataApiAuth\norg.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthUDFBlacklist.testBlackListedUdfUsage\norg.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthorization.org.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthorization\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/1563/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/1563/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1563/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 20 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12833308 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-10-14T13:17:51.797+0000","updated":"2016-10-14T13:17:51.797+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15577556","id":"15577556","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12833472/HIVE-14864.2.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 8 failed/errored test(s), 10564 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_globallimit]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[order_null]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union_fast_stats]\norg.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver[hbase_bulk]\norg.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0]\norg.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0]\norg.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1]\norg.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthorization.testBlackListedUdfUsage\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/1581/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/1581/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1581/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 8 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12833472 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-10-15T07:08:26.547+0000","updated":"2016-10-15T07:08:26.547+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15582459","id":"15582459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"A couple of comments:\n\n* Will srcFS.getContentSummary(src) cause extra time when source is on S3? If so, maybe we want to put this line inside the if() statement.\n\n* Once we're here, could you fix the message from HIVE_EXEC_COPYFILE_MAXSIZE to say (in Bytes) instead of (in Mb) ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2016-10-17T14:50:39.265+0000","updated":"2016-10-17T14:50:39.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15883299","id":"15883299","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"[~spena] comments addressed, rebased the patch. While writes to S3 won't hit this code path, its still useful for other destination filesystems.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-24T18:47:02.283+0000","updated":"2017-02-24T18:47:02.283+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15883969","id":"15883969","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12854547/HIVE-14864.3.patch\n\n{color:red}ERROR:{color} -1 due to no test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10259 tests executed\n*Failed tests:*\n{noformat}\nTestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)\norg.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)\norg.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=223)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/3768/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/3768/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3768/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 4 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12854547 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-02-25T02:53:42.510+0000","updated":"2017-02-25T02:53:42.510+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15888850","id":"15888850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"Can we add q-tests for this new variable?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2017-02-28T20:54:26.015+0000","updated":"2017-02-28T20:54:26.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15891510","id":"15891510","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"[~spena] am trying to write some qtests for this, do you know which CliDrivers run against HDFS filesystems? When I run the {{TestCliDriver}} all the URIs have schemes of either {{file}} or {{pfile}}. This code path only gets triggered if the scheme is {{hdfs}}.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-02T02:38:21.240+0000","updated":"2017-03-02T02:38:21.240+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15892913","id":"15892913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"Didn't the mini HDFS accepts hdfs?  Check all the encryption tests, such as encryption_ctas.q. They usually check for the hdfs scheme.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2017-03-02T20:21:16.092+0000","updated":"2017-03-02T20:21:16.092+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15895818","id":"15895818","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"{{FileSystem.getContentSummary()}} does a recursive treewalk, so is pathologically bad on a blobstore which has to mock directories through many., many HTTP requests.\n\nIf you need to use it, could you actually supply a patch (+ FS contract tests) for the method so that it uses listFiles(path, recursive=true)? That does the same treewalk against HDFS, but blobstores can do it as an O(1) listing call instead. If you can get that patch in, then enumerating the size of a blobstore tree will be fast","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-03-04T18:43:09.454+0000","updated":"2017-03-04T18:43:09.454+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15902460","id":"15902460","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"[~spena] I worked on this some more, and think a unit test may be better suited for this patch rather than a qtest. There are a number of different queries that could invoke this method (e.g. IMPORT queries use this method too), and more may be added in the future. I added some integration tests that run against a mini HDFS cluster, and some unit tests that just rely on mocking.\n\n[~stevel@apache.org] I agree, calling {{getContentSummary}} on S3 will be very slow. I've thought about filing a JIRA for the optimization you mentioned a few times, but never got around to doing it. Fortunately, this specific code won't be hit for S3, only for HDFS.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-09T04:27:21.912+0000","updated":"2017-03-09T04:27:21.912+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15902953","id":"15902953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12856936/HIVE-14864.4.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 10337 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hive.jdbc.TestMultiSessionsHS2WithLocalClusterSpark.testSparkQuery (batchId=219)\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-Build/4047/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-Build/4047/console\nTest logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4047/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 1 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12856936 - PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2017-03-09T12:08:12.091+0000","updated":"2017-03-09T12:08:12.091+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15903491","id":"15903491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"The patch looks good [~stakiar]\n+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2017-03-09T17:58:31.299+0000","updated":"2017-03-09T17:58:31.299+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15905795","id":"15905795","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"Thanks [~stakiar]. I committed the patch to upstream.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2017-03-10T22:23:54.437+0000","updated":"2017-03-10T22:23:54.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15906158","id":"15906158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftylev","name":"leftylev","key":"lefty@hortonworks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lefty%40hortonworks.com&avatarId=15906","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lefty%40hortonworks.com&avatarId=15906","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lefty%40hortonworks.com&avatarId=15906","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lefty%40hortonworks.com&avatarId=15906"},"displayName":"Lefty Leverenz","active":true,"timeZone":"America/New_York"},"body":"Doc note:  This adds *hive.exec.copyfile.maxnumfiles* to HiveConf.java and corrects the description of *hive.exec.copyfile.maxsize* (added in 1.1.0 by HIVE-8750 but not documented yet) so they need to be documented in the wiki.\n\n* [Configuration Properties -- Query and DDL Execution | https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-QueryandDDLExecution]\n\nAdded a TODOC2.2 label.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=leftylev","name":"leftylev","key":"lefty@hortonworks.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lefty%40hortonworks.com&avatarId=15906","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lefty%40hortonworks.com&avatarId=15906","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lefty%40hortonworks.com&avatarId=15906","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lefty%40hortonworks.com&avatarId=15906"},"displayName":"Lefty Leverenz","active":true,"timeZone":"America/New_York"},"created":"2017-03-11T10:20:22.797+0000","updated":"2017-03-11T10:20:22.797+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13008775/comment/15981833","id":"15981833","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"body":"I updated the documentation for this here: https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-QueryandDDLExecution","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stakiar","name":"stakiar","key":"stakiar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sahil Takiar","active":true,"timeZone":"Etc/UTC"},"created":"2017-04-24T20:25:23.930+0000","updated":"2017-04-24T20:25:23.930+0000"}],"maxResults":22,"total":22,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14864/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i34a9r:"}}