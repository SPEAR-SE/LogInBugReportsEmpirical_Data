{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12743489","self":"https://issues.apache.org/jira/rest/api/2/issue/12743489","key":"HIVE-8231","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2014-09-26T14:21:08.133+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 13 19:42:04 UTC 2014","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_771470692_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-10-02T08:26:47.805+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-8231/watchers","watchCount":3,"isWatching":false},"created":"2014-09-23T10:08:57.184+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326450","id":"12326450","description":"released","name":"0.14.0","archived":false,"released":true,"releaseDate":"2014-11-12"}],"issuelinks":[{"id":"12398130","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12398130","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12744712","key":"HIVE-8290","self":"https://issues.apache.org/jira/rest/api/2/issue/12744712","fields":{"summary":"With DbTxnManager configured, all ORC tables forced to be transactional","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-11-13T19:42:04.210+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Steps to show the bug :\n1. create table \n{code}\ncreate table encaissement_1b_64m like encaissement_1b;\n{code}\n2. check table \n{code}\ndesc encaissement_1b_64m;\ndfs -ls hdfs://nc-h04/user/hive/warehouse/casino.db/encaissement_1b_64m;\n{code}\neverything is ok:\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> desc encaissement_1b_64m;                                                                                                              +------------+------------+----------+--+\n|  col_name  | data_type  | comment  |\n+------------+------------+----------+--+\n| id         | int        |          |\n| idmagasin  | int        |          |\n| zibzin     | string     |          |\n| cheque     | int        |          |\n| montant    | double     |          |\n| date       | timestamp  |          |\n| col_6      | string     |          |\n| col_7      | string     |          |\n| col_8      | string     |          |\n+------------+------------+----------+--+\n9 rows selected (0.158 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> dfs -ls hdfs://nc-h04/user/hive/warehouse/casino.db/encaissement_1b_64m/;\n+-------------+--+\n| DFS Output  |\n+-------------+--+\n+-------------+--+\nNo rows selected (0.01 seconds)\n\n{noformat}\n\n3. Insert values into the new table\n{noformat}\ninsert into table encaissement_1b_64m VALUES (1, 1, '800000000909000000000000', 1, 12.5, '12/05/2014', '','','');\n{noformat}\n\n4. Check\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> select id from encaissement_1b_64m;\n+-----+--+\n| id  |\n+-----+--+\n+-----+--+\nNo rows selected (0.091 seconds)\n{noformat}\nThere are already a pb. I don't see the inserted row.\n\n5. When I'm checking HDFS directory, I see {{delta_0000421_0000421}} folder\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> dfs -ls hdfs://nc-h04/user/hive/warehouse/casino.db/encaissement_1b_64m/;\n+-----------------------------------------------------------------------------------------------------------------------------------------------------+--+\n|                                                                     DFS Output                                                                      |\n+-----------------------------------------------------------------------------------------------------------------------------------------------------+--+\n| Found 1 items                                                                                                                                       |\n| drwxr-xr-x   - hduser supergroup          0 2014-09-23 12:17 hdfs://nc-h04/user/hive/warehouse/casino.db/encaissement_1b_64m/delta_0000421_0000421  |\n+-----------------------------------------------------------------------------------------------------------------------------------------------------+--+\n2 rows selected (0.014 seconds)\n{noformat}\n\n6. Doing a major compaction solves the bug\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> alter table encaissement_1b_64m compact 'major';\nNo rows affected (0.046 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> dfs -ls hdfs://nc-h04/user/hive/warehouse/casino.db/encaissement_1b_64m/;\n+--------------------------------------------------------------------------------------------------------------------------------------------+--+\n|                                                                 DFS Output                                                                 |\n+--------------------------------------------------------------------------------------------------------------------------------------------+--+\n| Found 1 items                                                                                                                              |\n| drwxr-xr-x   - hduser supergroup          0 2014-09-23 12:21 hdfs://nc-h04/user/hive/warehouse/casino.db/encaissement_1b_64m/base_0000421  |\n+--------------------------------------------------------------------------------------------------------------------------------------------+--+\n2 rows selected (0.02 seconds)\n{noformat}\n \n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12672113","id":"12672113","filename":"a_beeline_insert.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T19:57:29.457+0000","size":43804,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12672113/a_beeline_insert.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12672112","id":"12672112","filename":"a_hiveserver2_insert.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T19:57:29.451+0000","size":179988,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12672112/a_hiveserver2_insert.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12672111","id":"12672111","filename":"b_beeline_insert.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T19:57:29.446+0000","size":10202,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12672111/b_beeline_insert.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12672110","id":"12672110","filename":"b_hiveserver2_insert.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T19:57:29.440+0000","size":52672,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12672110/b_hiveserver2_insert.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12672122","id":"12672122","filename":"c_beeline.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T20:19:26.723+0000","size":46131,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12672122/c_beeline.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12672121","id":"12672121","filename":"c_hiveserver2.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T20:19:26.717+0000","size":142069,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12672121/c_hiveserver2.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Error when insert into empty table with ACID","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14149134","id":"14149134","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"*seams to only affects ORC format*\n\nMore investigation on last trunk (26/09/2014):\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> drop table if exists foo6;\nNo rows affected (0.121 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> create table foo6 (id int);\nNo rows affected (0.08 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> insert into table foo6 VALUES(1);\nNo rows affected (2.823 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> select * from foo6;\n+----------+--+\n| foo6.id  |\n+----------+--+\n| 1        |\n+----------+--+\n1 row selected (0.079 seconds)\n0: jdbc:hive2://nc-h04:10000/casino>\n0: jdbc:hive2://nc-h04:10000/casino>\n0: jdbc:hive2://nc-h04:10000/casino> drop table if exists foo7;\nNo rows affected (0.127 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> create table foo7 (id int) STORED AS ORC;\nNo rows affected (0.059 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> insert into table foo7 VALUES(1);\nNo rows affected (1.707 seconds)\n0: jdbc:hive2://nc-h04:10000/casino> select * from foo7;\n+----------+--+\n| foo7.id  |\n+----------+--+\n+----------+--+\nNo rows selected (0.084 seconds)\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-26T13:26:25.448+0000","updated":"2014-09-26T13:26:25.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14149142","id":"14149142","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"I see in log :\n{noformat}\n2014-09-26 15:32:18,483 ERROR [Thread-8]: compactor.Initiator (Initiator.java:run(111)) - Caught exception while trying to determine if we should compact testsimon.values__tmp__table__11.  Marking clean to avoid repeated failures, java.lang.NullPointerException\n        at org.apache.hadoop.hive.ql.txn.compactor.Initiator.run(Initiator.java:88)\n\n2014-09-26 15:32:18,484 ERROR [Thread-8]: txn.CompactionTxnHandler (CompactionTxnHandler.java:markCleaned(355)) - Unable to delete compaction record\n{noformat}\n\nI wonder if there is a problem with the tables that store \"values\".\n\nEvery \"values\" table stay in database :\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> show tables;\n+-----------------------------------+--+\n|             tab_name              |\n+-----------------------------------+--+\n| classification_compte             |\n| dim_hotesse                       |\n...\n| societe                           |\n| testsimon__dim_lieu_sorted_dls__  |\n| values__tmp__table__10            |\n| values__tmp__table__11            |\n| values__tmp__table__12            |\n| values__tmp__table__2             |\n| values__tmp__table__3             |\n| values__tmp__table__4             |\n| values__tmp__table__5             |\n| values__tmp__table__6             |\n| values__tmp__table__7             |\n| values__tmp__table__8             |\n| values__tmp__table__9             |\n+-----------------------------------+--+\n47 rows selected (0.061 seconds)\n0: jdbc:hive2://nc-h04:10000/casino>\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-26T13:38:24.537+0000","updated":"2014-09-26T13:38:24.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14149206","id":"14149206","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"The values table should vanish as soon as you close the session that did the insert, since they are temp tables.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-26T14:21:08.133+0000","updated":"2014-09-26T14:21:08.133+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14149215","id":"14149215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"[~damien.carol], based on your output above it looks like you are reading the data via HS2 (since it says jdbc in your command line).  There was a definite bug in using ACID via HS2.  I'm curious if you still see this after HIVE-8203.  I'll have that one checked in as soon as the 24 hours after Eugene's +1 passes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-26T14:28:40.806+0000","updated":"2014-09-26T14:28:40.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14149938","id":"14149938","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"bq. \"... based on your output above it looks like you are reading the data via HS2.\"\n[~alangates] yes, I'm using HS2. I saw your comment on HIVE-8203 and I made the link. I'm waiting the fix of HIVE-8203 and I will re-test on real data.\nThe behaviour of \"values\" tables is still confusing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-26T20:38:37.923+0000","updated":"2014-09-26T20:38:37.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14151757","id":"14151757","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"[~alangates] I made lot of tests in WE. It seems that INSERT/DELETE/UPDATE doesn't work at all with concurrency enabled.\n\nIf I deactivate ACID with :\n{noformat}\n<!-- concurrency -->\n<property>\n  <name>hive.support.concurrency</name>\n  <value>false</value>\n</property>\n\n<!-- compactor org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager / org.apache.hadoop.hive.ql.lockmgr.DbTxnManager -->\n<property>\n  <name>hive.txn.manager</name>\n  <value>org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager</value>\n</property>\n{noformat}\nthen everything is ok.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-29T14:54:53.603+0000","updated":"2014-09-29T14:54:53.603+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14151758","id":"14151758","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"To be more precise, this commands works :\n{code}\ndrop table if exists foo6;\ncreate table foo6 (id int) clustered by (id) into 1 buckets;\ninsert into table foo6 VALUES(1);\nselect * from foo6;\n\ndrop table if exists foo7;\ncreate table foo7 (id int) STORED AS ORC;\ninsert into table foo7 VALUES(1);\nselect * from foo7;\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-29T14:56:44.506+0000","updated":"2014-09-29T14:56:44.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14151759","id":"14151759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"This bug is still here even with HIVE-8203 committed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-29T14:57:56.900+0000","updated":"2014-09-29T14:57:56.900+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14152007","id":"14152007","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"I think I can reproduce the same bug with 2 command line sessions doing things in the following order:\n\n# Start session 1\n# in session 1 insert into table\n# start session 2\n# in session 2 select * see all rows\n# in session 1, delete some rows\n# in session 1 selec *, see less rows\n# in session 2 select * , see all rows\n\nIf I stop and restart session 2 after this, than it sees the appropriate number of rows.  So either it isn't getting new transaction information for each query in the session, or the results are being cached somewhere on it.\n\nDoes this match the behavior you're seeing?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-29T18:22:47.258+0000","updated":"2014-09-29T18:22:47.258+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14152384","id":"14152384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"I need to test [~alangates] use case.\nI will also try another test:  stop and restart session between each query.\n\nFew details on my config:\n* We use Tez session\n* We use container re-use","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-29T22:09:55.658+0000","updated":"2014-09-29T22:09:55.658+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14152518","id":"14152518","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"At the moment I'm testing with MR.\n\nAlso, I see that if I do a query that causes an MR job (for instance {{select count (*))}}) then it gets the right result.\n\nIn looking through the logs the select * on session two (step 7 above) actually sees the wrong number of delta files in the directory.  I'm working on debugging whether this is because it is caching the file listing (which I doubt) or because it is caching the transaction information (more likely) and not seeing the newer files because it believes it shouldn't.  I have confirmed that Driver.runInternal (which encodes the transaction information) is encoding the right information, but that may not be being properly propagated to the FileSinkOperator reading the data. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-29T23:35:28.103+0000","updated":"2014-09-29T23:35:28.103+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14152951","id":"14152951","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"Restarting HDFS AND Yarn AND remote Metastore AND Hiveserver2 didn't helped.\nI think the bug comes because there are no \"base\" dir.\nWhen I'm doing major compaction. The base is created and I can see the new rows.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T08:32:13.277+0000","updated":"2014-09-30T08:32:13.277+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14152978","id":"14152978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"I don't think it's a cache issue. Doing stop/run of ALL daemons of the cluster change nothing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T08:57:43.867+0000","updated":"2014-09-30T08:57:43.867+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153012","id":"14153012","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"Another strange result, when I'm doing this query:\n{code}\nselect ROW__ID, INPUT__FILE__NAME, * from foo7;\n{code}\nI'm having this result :\n{noformat}\n+-----------------------------------------------+-----------------------------------------------------------------------------+----------+--+\n|                    row__id                    |                              input__file__name                              | foo7.id  |\n+-----------------------------------------------+-----------------------------------------------------------------------------+----------+--+\n| {\"transactionid\":536,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":537,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":538,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":539,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":540,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":541,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":542,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":544,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":545,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n| {\"transactionid\":546,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000542/bucket_00000  | 1        |\n+-----------------------------------------------+-----------------------------------------------------------------------------+----------+--+\n10 rows selected (0.168 seconds)\n{noformat}\n\nWhich is wrong.\n\nSee here :\n{noformat}\n0: jdbc:hive2://nc-h04:10000/casino> dfs -ls /user/hive/warehouse/casino.db/foo7;\n+-------------------------------------------------------------------------------------------------------------------------+--+\n|                                                       DFS Output                                                        |\n+-------------------------------------------------------------------------------------------------------------------------+--+\n| Found 4 items                                                                                                           |\n| drwxr-xr-x   - hduser supergroup          0 2014-09-30 11:29 /user/hive/warehouse/casino.db/foo7/base_0000542           |\n| drwxr-xr-x   - hduser supergroup          0 2014-09-30 11:30 /user/hive/warehouse/casino.db/foo7/delta_0000544_0000544  |\n| drwxr-xr-x   - hduser supergroup          0 2014-09-30 11:30 /user/hive/warehouse/casino.db/foo7/delta_0000545_0000545  |\n| drwxr-xr-x   - hduser supergroup          0 2014-09-30 11:30 /user/hive/warehouse/casino.db/foo7/delta_0000546_0000546  |\n+-------------------------------------------------------------------------------------------------------------------------+--+\n5 rows selected (0.025 seconds)\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T09:32:45.224+0000","updated":"2014-09-30T09:32:45.224+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153022","id":"14153022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"With block offset VC :\n{noformat}\n+-----------------------------------------------+-----------------------------------------------------------------------------+------------------------------+----------+--+\n|                    row__id                    |                              input__file__name                              | block__offset__inside__file  | foo7.id  |\n+-----------------------------------------------+-----------------------------------------------------------------------------+------------------------------+----------+--+\n| {\"transactionid\":536,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 61                           | 1        |\n| {\"transactionid\":537,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 122                          | 1        |\n| {\"transactionid\":538,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 183                          | 1        |\n| {\"transactionid\":539,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 244                          | 1        |\n| {\"transactionid\":540,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 306                          | 1        |\n| {\"transactionid\":541,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 367                          | 1        |\n| {\"transactionid\":542,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 428                          | 1        |\n| {\"transactionid\":544,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 489                          | 1        |\n| {\"transactionid\":545,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 550                          | 1        |\n| {\"transactionid\":546,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 612                          | 1        |\n| {\"transactionid\":547,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 612                          | 1        |\n| {\"transactionid\":548,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 612                          | 1        |\n| {\"transactionid\":549,\"bucketid\":0,\"rowid\":0}  | hdfs://nc-h04/user/hive/warehouse/casino.db/foo7/base_0000546/bucket_00000  | 612                          | 1        |\n+-----------------------------------------------+-----------------------------------------------------------------------------+------------------------------+----------+--+\n13 rows selected (0.162 seconds)\n{noformat}\n\nColumn {{input\\_\\_file\\_\\_name}} and {{block\\_\\_offset\\_\\_inside\\_\\_file}} have wrong values for the last 3 rows. These rows are in delta directories.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T09:51:13.201+0000","updated":"2014-09-30T09:51:13.201+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153279","id":"14153279","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"Ok, I'm not sure if we're chasing the same bug or not.  But I'll keep chasing the one I see and if we get lucky it will turn out to have the same root cause.\n\nCould you turn on debug level logging on your hive client and HiveServer2 instance, then do the insert and select that reproduces the error and attach both logs.  That would help me have an idea where things may be going wrong.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-30T15:26:12.211+0000","updated":"2014-09-30T15:26:12.211+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153281","id":"14153281","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"I mean JDBC client, not hive client.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-30T15:27:00.020+0000","updated":"2014-09-30T15:27:00.020+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153627","id":"14153627","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"I definitely think we are seeing separate issues.  I have a filed a new issue HIVE-8311 for what I am seeing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-30T19:33:13.874+0000","updated":"2014-09-30T19:33:13.874+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153669","id":"14153669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"Attached few files.\n\nUse case :\n1. drop table if exists foo7 (no log)\n2. create table foo7 (id int) STORED AS ORC (no log)\n3. insert into table foo7 VALUES(1) (log a_hiveserver2 and a_beeline)\n4. select * from foo7  (log b_hiveserver2 and b_beeline)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T19:57:29.463+0000","updated":"2014-09-30T19:57:29.463+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153682","id":"14153682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"[~alangates] I agree because every query in my cluster use the SAME Tez Session and reuse the same containers.\nFeel free to help me on this one once HIVE-8311 is out :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T20:10:48.367+0000","updated":"2014-09-30T20:10:48.367+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14153696","id":"14153696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"5. select distinct id from foo7 (log c_beeline and c_hiveserver2)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-09-30T20:19:26.730+0000","updated":"2014-09-30T20:19:26.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14155640","id":"14155640","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"body":"Damien, I'm definitely still trying to debug this.  But I'm juggling it with several other bugs, so it may be a day or until until I figure anything out.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alangates","name":"alangates","key":"alangates","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Gates","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-10-01T22:08:03.896+0000","updated":"2014-10-01T22:08:03.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14156223","id":"14156223","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"body":"[~alangates] HIVE-8290 solve this issue.\n\nAs HIVE-8290 is commited, HIVE don't try to use {{foo7}} as bucketed table.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=damien.carol","name":"damien.carol","key":"damien.carol","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10448","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"},"displayName":"Damien Carol","active":true,"timeZone":"Europe/Paris"},"created":"2014-10-02T08:25:58.535+0000","updated":"2014-10-02T08:25:58.535+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12743489/comment/14210686","id":"14210686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"body":"This has been fixed in 0.14 release. Please open new jira if you see any issues.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-11-13T19:42:04.204+0000","updated":"2014-11-13T19:42:04.204+0000"}],"maxResults":24,"total":24,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-8231/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i20dzb:"}}