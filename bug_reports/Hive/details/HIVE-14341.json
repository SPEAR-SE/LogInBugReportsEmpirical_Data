{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12992665","self":"https://issues.apache.org/jira/rest/api/2/issue/12992665","key":"HIVE-14341","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-07-29T10:47:45.213+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Sep 19 23:24:07 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14341/watchers","watchCount":1,"isWatching":false},"created":"2016-07-26T17:55:33.673+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334886","id":"12334886","name":"2.0.1","archived":false,"released":true,"releaseDate":"2016-05-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-09-19T23:24:07.927+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324798","id":"12324798","name":"Query Planning"}],"timeoriginalestimate":null,"description":"CREATE TABLE list_bucket_single (key STRING, value STRING)\n  SKEWED BY (key) ON (1,5,6) STORED AS DIRECTORIES;\n\nalter table list_bucket_single set skewed location (''1\"=\"/user/hive/warehouse/hdfs_skewed/new1\");\n\nWhile when you insert a row to key 1, the location falls back to the default one.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12820522","id":"12820522","filename":"HIVE-14341.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-07-27T18:40:08.706+0000","size":16036,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12820522/HIVE-14341.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12829272","id":"12829272","filename":"HIVE-14341.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-19T20:59:59.783+0000","size":19969,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12829272/HIVE-14341.2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Altered skewed location is not respected for list bucketing","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992665/comment/15396138","id":"15396138","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Attached patch-1: removed the code that we will reload skew mapping info from the directory rather than from the database. Seems incorrect from what I can tell since it would gather incorrect info after the following command e.g., it will get a map {{new1 => /user/hive/warehouse/hdfs_skewed/new1}.\n\nalter table list_bucket_single set skewed location (''1\"=\"/user/hive/warehouse/hdfs_skewed/new1\");\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-07-27T18:46:22.851+0000","updated":"2016-07-27T18:46:22.851+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992665/comment/15399119","id":"15399119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12820522/HIVE-14341.1.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 28 failed/errored test(s), 10348 tests executed\n*Failed tests:*\n{noformat}\nTestMiniTezCliDriver-script_pipe.q-orc_ppd_schema_evol_2a.q-join1.q-and-12-more - did not produce a TEST-*.xml file\nTestMiniTezCliDriver-vector_decimal_aggregate.q-vector_decimal_10_0.q-orc_vectorization_ppd.q-and-12-more - did not produce a TEST-*.xml file\nTestMsgBusConnection - did not produce a TEST-*.xml file\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_avro_nullable_union\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_infer_bucket_sort_list_bucket\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_lb_fs_stats\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_11\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_13\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_14\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_4\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_5\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_6\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_7\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_8\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_9\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_query_multiskew_1\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_query_multiskew_2\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_query_multiskew_3\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert\norg.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_list_bucket_dml_10\norg.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_list_bucket_dml_10\norg.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_avro_non_nullable_union\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_list_bucket_dml_2\n{noformat}\n\nTest results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/682/testReport\nConsole output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/682/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-682/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 28 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12820522 - PreCommit-HIVE-MASTER-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-07-29T10:47:45.213+0000","updated":"2016-07-29T10:47:45.213+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992665/comment/15504679","id":"15504679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"body":"Patch-2: made the changes so the desc command will show skewed location for those locations not updated explicitly. \n\nWith this patch, we will not automatically collect the skew mapping from the directory since that would cause the issue if the location is updated explicitly.\n\nRather, given a query like select * from list_bucket_single where key=1, if the skew location for key 1 is updated explicitly, then we will have the new location from HMS, otherwise, we will check the default location /list_bucket_single/key=1. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aihuaxu","name":"aihuaxu","key":"aihuaxu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aihua Xu","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-09-19T20:59:59.800+0000","updated":"2016-09-19T20:59:59.800+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12992665/comment/15505009","id":"15505009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12829272/HIVE-14341.2.patch\n\n{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.\n\n{color:red}ERROR:{color} -1 due to 17 failed/errored test(s), 10555 tests executed\n*Failed tests:*\n{noformat}\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_mapjoin]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[alter_skewed_table]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[create_skewed_table1]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ctas]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[infer_bucket_sort_list_bucket]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[list_bucket_dml_2]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[list_bucket_dml_4]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[list_bucket_dml_5]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[list_bucket_dml_6]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[list_bucket_dml_7]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[list_bucket_dml_8]\norg.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_join_part_col_char]\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_5]\norg.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3]\norg.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[list_bucket_dml_2]\norg.apache.hadoop.hive.metastore.TestMetaStoreMetrics.testMetaDataCounts\norg.apache.hive.jdbc.TestJdbcWithMiniHS2.testAddJarConstructorUnCaching\n{noformat}\n\nTest results: https://builds.apache.org/job/jenkins-PreCommit-HIVE-Build/1233/testReport\nConsole output: https://builds.apache.org/job/jenkins-PreCommit-HIVE-Build/1233/console\nTest logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/jenkins-PreCommit-HIVE-Build-1233/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\nTests exited with: TestsFailedException: 17 tests failed\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12829272 - jenkins-PreCommit-HIVE-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-09-19T23:24:07.927+0000","updated":"2016-09-19T23:24:07.927+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-14341/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i31ixz:"}}