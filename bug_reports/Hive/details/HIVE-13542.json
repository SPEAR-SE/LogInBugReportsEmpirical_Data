{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12959818","self":"https://issues.apache.org/jira/rest/api/2/issue/12959818","key":"HIVE-13542","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334255","id":"12334255","name":"2.1.0","archived":false,"released":true,"releaseDate":"2016-06-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-04-19T14:52:54.280+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat May 07 13:31:47 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_2_*:*_332131323_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_2_*:*_1215024817","customfield_12312321":null,"resolutiondate":"2016-05-06T20:56:17.469+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13542/watchers","watchCount":2,"isWatching":false},"created":"2016-04-18T23:10:21.386+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332641","id":"12332641","description":"Hive 2.0.0","name":"2.0.0","archived":false,"released":true,"releaseDate":"2016-02-15"}],"issuelinks":[{"id":"12464042","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12464042","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12949298","key":"HIVE-13269","self":"https://issues.apache.org/jira/rest/api/2/issue/12949298","fields":{"summary":"Simplify comparison expressions using column stats","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12464762","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12464762","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12962101","key":"HIVE-13601","self":"https://issues.apache.org/jira/rest/api/2/issue/12962101","fields":{"summary":"Deadline is not registered at some places in HiveMetastore before the ObjectStore/MetaStoreDirectSql APIs are invoked","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-06-21T15:12:24.794+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312590","id":"12312590","name":"Testing Infrastructure","description":"Tracks issues with tests and testing infrastructure."}],"timeoriginalestimate":null,"description":"These are the tables whose stats are missing in data/files/tpcds-perf/metastore_export/csv/TAB_COL_STATS.txt:\n\n* catalog_returns\n* catalog_sales\n* inventory\n* store_returns\n* store_sales\n* web_returns\n* web_sales\n\nThanks to [~jcamachorodriguez] for discovering this issue.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12799396","id":"12799396","filename":"HIVE-13542.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-19T00:05:35.981+0000","size":583525,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12799396/HIVE-13542.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12802469","id":"12802469","filename":"HIVE-13542.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-05T18:03:01.018+0000","size":590798,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12802469/HIVE-13542.2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Missing stats for tables in TPCDS performance regression suite","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15246806","id":"15246806","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"body":"cc-ing [~jcamachorodriguez] for review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-19T00:05:35.989+0000","updated":"2016-04-19T00:05:35.989+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15247892","id":"15247892","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks [~hsubramaniyan].\n\nI have been running some tests using your patch e.g. query7.q. Examining the logs I see the following message that seems to indicate we still have some kind of problem with the stats:\n\n{noformat}\nCaused by: org.apache.hadoop.hive.metastore.DeadlineException: The threadlocal Deadline is null, please register it first.\n        at org.apache.hadoop.hive.metastore.Deadline.checkTimeout(Deadline.java:149) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore$7.getJdoResult(ObjectStore.java:6686) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore$7.getJdoResult(ObjectStore.java:6664) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:2550) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTableColumnStatisticsInternal(ObjectStore.java:6663) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTableColumnStatistics(ObjectStore.java:6657) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_table_statistics_req(HiveMetaStore.java:4327) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getTableColumnStatistics(HiveMetaStoreClient.java:1570) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.getTableColumnStatistics(SessionHiveMetaStoreClient.java:347) ~[hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.metadata.Hive.getTableColumnStatistics(Hive.java:3317) ~[hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        ... 178 more\n2016-04-19T07:23:58,718 ERROR [ee2214e0-ff62-4617-a51c-45dfba3ae1c0 main[]]: calcite.RelOptHiveTable (RelOptHiveTable.java:updateColStats(395)) - No Stats for default@customer_demographics, Columns: cd_demo_sk\n2016-04-19T07:23:58,719 WARN  [ee2214e0-ff62-4617-a51c-45dfba3ae1c0 main[]]: parse.CalcitePlanner (CalcitePlanner.java:apply(993)) - Missing column stats (see previous messages), skipping join reordering in CBO\n{noformat}\n\nIn particular, that column is present in {{data/files/tpcds-perf/metastore_export/csv/TAB_COL_STATS.txt}}.\n\nI could avoid the DeadlineException by setting {{hive.metastore.fastpath}} to false in {{data/conf/perf-reg/hive-site.xml}}, thus avoiding bypassing the raw store proxy as we are using the ObjectStore in the PerfCliDriver. However, even after doing that, I still see the missing stats message.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-19T14:52:54.280+0000","updated":"2016-04-19T14:52:54.280+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15247977","id":"15247977","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~jcamachorodriguez] Thanks.\nIt seems there is a corrupt entry in TAB_COL_STATS.txt, can you please replace the line 101 (one with cd_demo_sk) to \n\n{code}\ndefault,customer_demographics,cd_demo_sk,int,1,1920800,,,,,1835839,0,,,,,1434571729,6296,_customer_demographics_\n{code}\n\nand see if it resolves the issue.\n\nThanks\nHari\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-19T15:25:58.617+0000","updated":"2016-04-19T15:25:58.617+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15248021","id":"15248021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~hsubramaniyan], still same problem. Can be reproduced running e.g. query7.q.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-19T15:48:44.849+0000","updated":"2016-04-19T15:48:44.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15252613","id":"15252613","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"body":"[~jcamachorodriguez] I looked at this after I made the change. This time it looks like a metastore client error and not a problem with the data.\n\n{code}\n16-04-21T11:45:55,201 DEBUG [f2995fd1-e4fc-4783-86cb-9264f715e540 main[]]: metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:timingTrace(864)) - Direct SQL query in 14.825303ms + 0.086336ms, the query is [select \"COLUMN_NAME\", \"COLUMN_TYPE\", \"LONG_LOW_VALUE\", \"LONG_HIGH_VALUE\", \"DOUBLE_LOW_VALU\\\nE\", \"DOUBLE_HIGH_VALUE\", \"BIG_DECIMAL_LOW_VALUE\", \"BIG_DECIMAL_HIGH_VALUE\", \"NUM_NULLS\", \"NUM_DISTINCTS\", \"AVG_COL_LEN\", \"MAX_COL_LEN\", \"NUM_TRUES\", \"NUM_FALSES\", \"LAST_ANALYZED\"  from \"TAB_COL_STATS\"  where \"DB_NAME\" = ? and \"TABLE_NAME\" = ? and \"COLUMN_NAME\" in (...)]\n2016-04-21T11:45:55,242 WARN  [f2995fd1-e4fc-4783-86cb-9264f715e540 main[]]: metastore.ObjectStore (ObjectStore.java:handleDirectSqlError(2602)) - Direct SQL failed, falling back to ORM\norg.apache.hadoop.hive.metastore.api.MetaException: The threadlocal Deadline is null, please register it first.\n        at org.apache.hadoop.hive.metastore.Deadline.newMetaException(Deadline.java:178) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.Deadline.checkTimeout(Deadline.java:149) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.makeColumnStats(MetaStoreDirectSql.java:1717) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.getTableStats(MetaStoreDirectSql.java:1201) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore$7.getSqlResult(ObjectStore.java:6849) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore$7.getSqlResult(ObjectStore.java:6846) ~[hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore$GetHelper.run(ObjectStore.java:2567) [hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTableColumnStatisticsInternal(ObjectStore.java:6845) [hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTableColumnStatistics(ObjectStore.java:6839) [hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_table_statistics_req(HiveMetaStore.java:4361) [hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getTableColumnStatistics(HiveMetaStoreClient.java:1613) [hive-metastore-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.getTableColumnStatistics(SessionHiveMetaStoreClient.java:347) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.metadata.Hive.getTableColumnStatistics(Hive.java:3317) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.stats.StatsUtils.getTableColumnStats(StatsUtils.java:758) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.optimizer.calcite.RelOptHiveTable.updateColStats(RelOptHiveTable.java:302) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.optimizer.calcite.RelOptHiveTable.getColStat(RelOptHiveTable.java:417) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.optimizer.calcite.RelOptHiveTable.getColStat(RelOptHiveTable.java:410) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan.getColStat(HiveTableScan.java:158) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.optimizer.calcite.stats.HiveRelMdDistinctRowCount.getDistinctRowCount(HiveRelMdDistinctRowCount.java:77) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at org.apache.hadoop.hive.ql.optimizer.calcite.stats.HiveRelMdDistinctRowCount.getDistinctRowCount(HiveRelMdDistinctRowCount.java:64) [hive-exec-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.7.0_79]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) ~[?:1.7.0_79]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.7.0_79]\n        at java.lang.reflect.Method.invoke(Method.java:606) ~[?:1.7.0_79]\n{code}\n\nIt seems  we need to register the Deadline before we can invoke the call on retrieving the table statistics. [~sershe] , looking at the stack trace is it possible to suggest a way to  make the fix at the client side.\n\nThanks\nHari","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-21T20:28:34.433+0000","updated":"2016-04-21T20:28:34.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15270256","id":"15270256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"body":"This jira is blocked by the fact that we are do the following:\n1. Move the TestPerfCliDriver to TestMiniTezCliDriver \n2. Move from derby to hbase metastore (as part of point 1).\n\nI will create a new jira and link it to this one when I start working on it.\nThe fix once available for the above points, will invalidate this one.\n\nThanks\nHari\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan","name":"hsubramaniyan","key":"hsubramaniyan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453"},"displayName":"Hari Sankar Sivarama Subramaniyan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-04T07:35:20.926+0000","updated":"2016-05-04T07:35:20.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15270429","id":"15270429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"body":"[~hsubramaniyan], [~ashutoshc], if this and HIVE-13061 are taking a bit of time, is it possible to set hive.metastore.fastpath to false and add the missing stats so TestPerfCliDriver works properly? That would unblock HIVE-13269 while TestPerfCliDriver is being migrated, right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jcamachorodriguez","name":"jcamachorodriguez","key":"jcamachorodriguez","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jesus Camacho Rodriguez","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-04T10:02:15.578+0000","updated":"2016-05-04T10:02:15.578+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15270504","id":"15270504","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"I am fine either ways. [~hsubramaniyan] ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-04T11:48:09.865+0000","updated":"2016-05-04T11:48:09.865+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15272902","id":"15272902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 pending tests","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-05T19:21:45.870+0000","updated":"2016-05-05T19:21:45.870+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15274719","id":"15274719","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Pushed to master. Thanks, [~hsubramaniyan]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-06T20:56:17.505+0000","updated":"2016-05-06T20:56:17.505+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12959818/comment/15275237","id":"15275237","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12802469/HIVE-13542.2.patch\n\n{color:red}ERROR:{color} -1 due to build exiting with an error\n\nTest results: http://ec2-54-177-240-2.us-west-1.compute.amazonaws.com/job/PreCommit-HIVE-MASTER-Build/204/testReport\nConsole output: http://ec2-54-177-240-2.us-west-1.compute.amazonaws.com/job/PreCommit-HIVE-MASTER-Build/204/console\nTest logs: http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-204/\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.TestCheckPhase\nExecuting org.apache.hive.ptest.execution.PrepPhase\nTests exited with: NonZeroExitCodeException\nCommand 'bash /data/hive-ptest/working/scratch/source-prep.sh' failed with exit status 1 and output '+ [[ -n /usr/java/jdk1.7.0_45-cloudera ]]\n+ export JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera\n+ JAVA_HOME=/usr/java/jdk1.7.0_45-cloudera\n+ export PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/lib64/qt-3.3/bin:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.7.0_45-cloudera/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin\n+ PATH=/usr/java/jdk1.7.0_45-cloudera/bin/:/usr/lib64/qt-3.3/bin:/usr/local/apache-maven-3.0.5/bin:/usr/java/jdk1.7.0_45-cloudera/bin:/usr/local/apache-ant-1.9.1/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/hiveptest/bin\n+ export 'ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m '\n+ ANT_OPTS='-Xmx1g -XX:MaxPermSize=256m '\n+ export 'M2_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128'\n+ M2_OPTS='-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128'\n+ cd /data/hive-ptest/working/\n+ tee /data/hive-ptest/logs/PreCommit-HIVE-MASTER-Build-204/source-prep.txt\n+ [[ false == \\t\\r\\u\\e ]]\n+ mkdir -p maven ivy\n+ [[ git = \\s\\v\\n ]]\n+ [[ git = \\g\\i\\t ]]\n+ [[ -z master ]]\n+ [[ -d apache-github-source-source ]]\n+ [[ ! -d apache-github-source-source/.git ]]\n+ [[ ! -d apache-github-source-source ]]\n+ cd apache-github-source-source\n+ git fetch origin\n+ git reset --hard HEAD\nHEAD is now at 3f3aa2a HIVE-12827: Vectorization: VectorCopyRow/VectorAssignRow/VectorDeserializeRow assign needs explicit isNull[offset] modification (errata.txt)\n+ git clean -f -d\n+ git checkout master\nAlready on 'master'\n+ git reset --hard origin/master\nHEAD is now at 3f3aa2a HIVE-12827: Vectorization: VectorCopyRow/VectorAssignRow/VectorDeserializeRow assign needs explicit isNull[offset] modification (errata.txt)\n+ git merge --ff-only origin/master\nAlready up-to-date.\n+ git gc\n+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh\n+ patchFilePath=/data/hive-ptest/working/scratch/build.patch\n+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]\n+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh\n+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch\nThe patch does not appear to apply with p0, p1, or p2\n'\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12802469 - PreCommit-HIVE-MASTER-Build","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2016-05-07T13:31:47.723+0000","updated":"2016-05-07T13:31:47.723+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13542/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2wagf:"}}