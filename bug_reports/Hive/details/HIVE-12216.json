{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12906197","self":"https://issues.apache.org/jira/rest/api/2/issue/12906197","key":"HIVE-12216","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Oct 27 19:21:33 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-12216/watchers","watchCount":4,"isWatching":false},"created":"2015-10-20T10:06:19.139+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329363","id":"12329363","name":"1.1.0","archived":false,"released":true,"releaseDate":"2015-03-07"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-08-29T17:41:30.508+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12324450","id":"12324450","name":"Parser","description":"Hive grammar"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12312586","id":"12312586","name":"Query Processor","description":"Tracks issues dealing with query processing."},{"self":"https://issues.apache.org/jira/rest/api/2/component/12315100","id":"12315100","name":"SQL","description":"Issues related to Hive Query Language and its conformance with ANSI SQL."}],"timeoriginalestimate":null,"description":"In case we use a where clause in a state where also joins are present, the clauses are not (always) respected. We have been able to reproduce this issue consistently with Hive 1.1.0 on MR, Hive 1.2.1 on Tez (MR Fails here). \n\nSo fo the below query we *do* get results back like:\n\n'gs.i_s_c = 23' (and this goes for all clauses!)\n\nCREATE TABLE tmp_hub_and_sats AS\nSELECT\n   f.dt,\n   f.t_c,\n   sum(f.transaction_amount) as amount,\n   sum(f.amount_euro) amount_euro,\n   IF(f.org_grid is null, f.org_cust, f.org_grid) as org,\n   IF(f.org_grid is null, 0, 1) as is_org_grid,\n   IF(f.org_up is null, if(f.org_grid is null, f.org_cust, f.org_grid), f.org_up) as org_up,\n   IF(f.to_grid is null, f.to_cust, f.to_grid) to,\n   IF(f.to_grid is null, 0, 1) as is_to_grid,\n   IF(f.to_up is null, if(f.to_grid is null, f.to_cust, f.to_grid), f.to_up) as to_up,\n   gh.i_g_c as customer_code_hub,\n   gs.i_g_c as customer_code_satellite\nfrom x_grid_orders f\nLEFT OUTER JOIN\n grid.grid gh\n ON f.org_grid = gh.hashed_gridid\nLEFT OUTER JOIN\n grid.grid gs\n ON f.to_grid = gs.hashed_gridid\nwhere\nIF(f.org_up is null, f.org_cust, f.org_up) <> IF(f.to_up is null, f.to_cust, f.to_up)\n AND\n (substring(gh.i_g_c, 1, 2) <> \"06\" or gh.i_g_c is null)\n AND\n (substring(gs.i_g_c, 1, 2) <> \"06\" or gs.i_g_c is null)\n AND\n (gh.i_s_c <> \"23\" or gh.i_s_c is null)\n AND\n (gs.i_s_c <> \"23\" or gs.i_s_c is null)\ngroup by\n f.dt,\n f.t_c,\n IF(f.org_grid is null, f.org_cust, f.org_grid),\n IF(f.org_grid is null, 0, 1),\n IF(f.org_up is null, if(f.org_grid is null, f.org_cust, f.org_grid), f.org_up),\n IF(f.to_grid is null, f.to_cust, f.to_grid),\n IF(f.to_grid is null, 0, 1),\n IF(f.to_up is null, if(f.to_grid is null, f.to_cust, f.to_grid), f.to_up),\n gh.i_g_c,\n gs.i_g_c","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"WHERE on the FROM table not (always) working when JOIN are present","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bolke","name":"bolke","key":"bolke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bolke de Bruin","active":true,"timeZone":"Europe/Amsterdam"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bolke","name":"bolke","key":"bolke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bolke de Bruin","active":true,"timeZone":"Europe/Amsterdam"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"CDH 5.4.7 HDP2.3.2 MR TEZ","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12906197/comment/14977003","id":"14977003","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bolke","name":"bolke","key":"bolke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bolke de Bruin","active":true,"timeZone":"Europe/Amsterdam"},"body":"Update: we have noticed this mainly happens with large datasets and smaller datasets do not seem to affected. Also we see a similar issue that we will report separately.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bolke","name":"bolke","key":"bolke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bolke de Bruin","active":true,"timeZone":"Europe/Amsterdam"},"created":"2015-10-27T19:21:33.885+0000","updated":"2015-10-27T19:21:33.885+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-12216/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2n8af:"}}