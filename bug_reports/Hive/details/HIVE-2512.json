{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12527695","self":"https://issues.apache.org/jira/rest/api/2/issue/12527695","key":"HIVE-2512","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2011-10-19T06:56:46.742+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Aug 22 18:22:54 UTC 2016","customfield_12310420":"89015","customfield_12312320":null,"customfield_12310222":"1_*:*_3_*:*_1691813078_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_2_*:*_151204833473","customfield_12312321":null,"resolutiondate":"2016-08-22T18:22:53.712+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2512/watchers","watchCount":4,"isWatching":false},"created":"2011-10-19T03:05:27.844+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-08-22T18:22:54.393+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"After HIVE-2145, the following query returns a semantic analysis error: \n\nFROM src SELECT * cluster by rand();\nFAILED: Error in semantic analysis: functions are not supported in order by\n\nLooking back at HIVE-2145, it's clear that the patch is more restrictive than necessary. \n\nChinna, are you able to work on it? Please let me know if you don't have cycles to do it now. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12500470","id":"12500470","filename":"HIVE-2512.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-24T15:41:04.836+0000","size":2089,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12500470/HIVE-2512.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12502924","id":"12502924","filename":"HIVE-2512.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-08T15:58:41.118+0000","size":11331,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12502924/HIVE-2512.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12499902","id":"12499902","filename":"HIVE-2512.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-20T18:01:06.944+0000","size":3698,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12499902/HIVE-2512.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123946","customfield_12312823":null,"summary":"After HIVE-2145, Hive disallow any use of function in cluster-by clause","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13130408","id":"13130408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"i will take a look now","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-19T06:56:46.742+0000","updated":"2011-10-19T06:56:46.742+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13130788","id":"13130788","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Cool. Thanks Chinna! Just a suggestions, I think reverting the change in HIVE-2145 and make a deeper investigation of why it threw NPE in the test case of HIVE-2145 and fix that seems to be a better solution. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-10-19T17:17:47.071+0000","updated":"2011-10-19T17:17:47.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13130867","id":"13130867","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"SemanticAnalyzer.genReduceSinkPlan() added a function validation check for orderby and sortby in the same flow clusterby also executing so it is throwing execption for the clusterby also.\n\nOrderby and Sortby wont support the functions so need to add the function validation check. \nNow validation check is modified like it should check only for the orderby and sortby.\n\nPatch is uploaded and testcases are executing","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-19T18:43:41.917+0000","updated":"2011-10-19T18:43:41.917+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13131850","id":"13131850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2479/\n-----------------------------------------------------------\n\nReview request for hive and Ning Zhang.\n\n\nSummary\n-------\n\nSemanticAnalyzer.genReduceSinkPlan() added a function validation check for orderby and sortby in the same flow clusterby also executing so it is throwing execption for the clusterby also.\n\nOrderby and Sortby wont support the functions so need to add the function validation check. \nNow validation check is modified like it should check only for the orderby and sortby.\n\n\nThis addresses bug HIVE-2512.\n    https://issues.apache.org/jira/browse/HIVE-2512\n\n\nDiffs\n-----\n\n  trunk/ql/src/test/results/clientnegative/sortby_function.q.out PRE-CREATION \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java 1186306 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1186306 \n  trunk/ql/src/test/queries/clientnegative/orderby_function.q 1186306 \n  trunk/ql/src/test/queries/clientnegative/sortby_function.q PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/orderby_function.q.out 1186306 \n\nDiff: https://reviews.apache.org/r/2479/diff\n\n\nTesting\n-------\n\nAll unit tests passed\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-20T18:06:10.769+0000","updated":"2011-10-20T18:06:10.769+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13132831","id":"13132831","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Chinna, I think the point for this JIRA is to allow functions in the orderby/sortby/clusterby, not just disallow them in some use cases found useful. In fact, we can find use cases for using functions in all orderby/osrtby/clusterby, and MySQL allows putting functions in the orderby clause for example.\n\nSo in order to fix this, I think we should examine what the root cause that HIVE-2145 gives NPE and fix that by still allowing functions in these clauses. The description of HIVE-2145 is misleading (in terms of suggested solutions), I've fixed that. Does this make sense?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-10-21T17:09:51.404+0000","updated":"2011-10-21T17:09:51.404+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13132882","id":"13132882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"when i am analysing the HIVE-2145 i have verified the sql syntax it is not allowing functions for orderby/sortby so i have added a function check validation. I did't verify the mysql use cases. With this impression i have analyzed HIVE-2512.\n\nI will check the MySQL use cases...Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-21T18:13:04.979+0000","updated":"2011-10-21T18:13:04.979+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13133035","id":"13133035","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"Chinna, the Hive wiki may only say it requires column names, but I think the syntax Hive.q may allow functions in orderby/sortby. \n\nAt the same time, would you mind upload a patch to revert HIVE-2145 first? Without reverting it, it breaks backward compatibility and have introduced some problems in our production. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-10-21T20:25:01.399+0000","updated":"2011-10-21T20:25:01.399+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13133836","id":"13133836","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"First i will upload patch to revert HIVE-2145.  sorry for the inconvenience.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-24T05:26:17.410+0000","updated":"2011-10-24T05:26:17.410+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13134173","id":"13134173","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"HIVE-2512.1.patch uploaded by reverting HIVE-2145","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-10-24T15:51:19.774+0000","updated":"2011-10-24T15:51:19.774+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13134290","id":"13134290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"+1. Thanks for the quick response Chinna. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-10-24T17:50:03.682+0000","updated":"2011-10-24T17:50:03.682+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13135312","id":"13135312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hive-trunk-h0.21 #1032 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1032/])\n    HIVE-2512. After HIVE-2145, Hive disallow any use of function in cluster-by clause (Chinna Rao Lalam via Ning Zhang)\n\nnzhang : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1188473\nFiles : \n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java\n* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java\n* /hive/trunk/ql/src/test/queries/clientnegative/orderby_function.q\n* /hive/trunk/ql/src/test/results/clientnegative/orderby_function.q.out\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2011-10-25T18:28:11.142+0000","updated":"2011-10-25T18:28:11.142+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13146373","id":"13146373","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"select key, count(1) cnt from src group by key order by count(1) limit 10;\n\nHere order by is requested with the aggregate function in execution flow of this query in org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory.DefaultExprProcessor.getXpathOrFuncExprNodeDesc(ASTNode, boolean, ArrayList<ExprNodeDesc>, TypeCheckCtx) while constructing ExprNodeGenericFuncDesc it is expecting GenericUDF() but here it is requested with aggregate function so it is returning null and it is throwing NullPointerException\n\nSo before constructing ExprNodeGenericFuncDesc added a check if it is UDAF throw exception\n\nAnd it should work with below queries ,\n\nselect key,min(key) from src group by key having min(key) > 100;\nselect key,min(key) as mininum from src group by key order by mininum;","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-08T16:01:39.767+0000","updated":"2011-11-08T16:01:39.767+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13146377","id":"13146377","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/2479/\n-----------------------------------------------------------\n\n(Updated 2011-11-08 16:03:21.111741)\n\n\nReview request for hive and Ning Zhang.\n\n\nChanges\n-------\n\nselect key, count(1) cnt from src group by key order by count(1) limit 10;\n\nHere order by is requested with the aggregate function in execution flow of this query in org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory.DefaultExprProcessor.getXpathOrFuncExprNodeDesc(ASTNode, boolean, ArrayList<ExprNodeDesc>, TypeCheckCtx) while constructing ExprNodeGenericFuncDesc it is expecting GenericUDF() but here it is requested with aggregate function so it is returning null and it is throwing NullPointerException\n\nSo before constructing ExprNodeGenericFuncDesc added a check if it is UDAF throw exception\n\nAnd it should work with below queries ,\n\nselect key,min(key) from src group by key having min(key) > 100;\nselect key,min(key) as mininum from src group by key order by mininum;\n\n\nSummary\n-------\n\nSemanticAnalyzer.genReduceSinkPlan() added a function validation check for orderby and sortby in the same flow clusterby also executing so it is throwing execption for the clusterby also.\n\nOrderby and Sortby wont support the functions so need to add the function validation check. \nNow validation check is modified like it should check only for the orderby and sortby.\n\n\nThis addresses bug HIVE-2512.\n    https://issues.apache.org/jira/browse/HIVE-2512\n\n\nDiffs (updated)\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java 1198626 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java 1198626 \n  trunk/ql/src/test/queries/clientnegative/orderby_function.q PRE-CREATION \n  trunk/ql/src/test/queries/clientnegative/orderby_function1.q PRE-CREATION \n  trunk/ql/src/test/queries/clientnegative/orderby_function2.q PRE-CREATION \n  trunk/ql/src/test/queries/clientnegative/sortby_function.q PRE-CREATION \n  trunk/ql/src/test/queries/clientpositive/orderby_function.q PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/orderby_function.q.out PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/orderby_function1.q.out PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/orderby_function2.q.out PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/sortby_function.q.out PRE-CREATION \n  trunk/ql/src/test/results/clientpositive/orderby_function.q.out PRE-CREATION \n\nDiff: https://reviews.apache.org/r/2479/diff\n\n\nTesting\n-------\n\nAll unit tests passed\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-08T16:03:51.520+0000","updated":"2011-11-08T16:03:51.520+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/13701598","id":"13701598","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"body":"This is an old one. What is the status here? Has this been superseded by something else or is the bug still existing? I suspect we will need to rebase. Is it still worth it to anyone?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"created":"2013-07-07T16:01:32.315+0000","updated":"2013-07-07T16:01:32.315+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12527695/comment/15431359","id":"15431359","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"Please open new jira, still it is a problem on master.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-22T18:22:54.078+0000","updated":"2016-08-22T18:22:54.078+0000"}],"maxResults":15,"total":15,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2512/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lkcf:"}}