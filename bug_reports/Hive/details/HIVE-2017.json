{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12500098","self":"https://issues.apache.org/jira/rest/api/2/issue/12500098","key":"HIVE-2017","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2011-03-04T11:12:13.448+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Aug 22 18:13:04 UTC 2016","customfield_12310420":"35813","customfield_12312320":null,"customfield_12310222":"1_*:*_3_*:*_166536479640_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_2_*:*_6341659580","customfield_12312321":null,"resolutiondate":"2016-08-22T18:13:04.713+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2017/watchers","watchCount":3,"isWatching":false},"created":"2011-03-01T20:30:47.262+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12337873","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12337873","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12494304","key":"HIVE-1872","self":"https://issues.apache.org/jira/rest/api/2/issue/12494304","fields":{"summary":"Hive process is exiting on executing ALTER query","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/3","description":"This issue is being actively worked on at the moment by the assignee.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/inprogress.png","name":"In Progress","id":"3","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12364819","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12364819","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12512993","key":"HIVE-2264","self":"https://issues.apache.org/jira/rest/api/2/issue/12512993","fields":{"summary":"Hive server is SHUTTING DOWN when invalid queries beeing executed.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-08-22T18:13:06.468+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Here's a snippet from Driver.execute():\n{code}\n            // TODO: This error messaging is not very informative. Fix that.\n            errorMessage = \"FAILED: Execution Error, return code \" + exitVal + \" from \"\n                + tsk.getClass().getName();\n            SQLState = \"08S01\";\n            console.printError(errorMessage);\n            if (running.size() != 0) {\n              taskCleanup();\n            }\n            return 9;\n{code}\nI simply returned in case of runtime errors without maintaining SessionState. It could cause resource leak mentioned in HIVE-1959. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12491233","id":"12491233","filename":"HIVE-2017.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-08-22T17:51:59.689+0000","size":8911,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12491233/HIVE-2017.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12494829","id":"12494829","filename":"HIVE-2017.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-09-16T17:32:13.357+0000","size":8947,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12494829/HIVE-2017.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12494931","id":"12494931","filename":"HIVE-2017.3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-09-17T18:14:35.164+0000","size":9289,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12494931/HIVE-2017.3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12502172","id":"12502172","filename":"HIVE-2017.4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-03T16:00:01.463+0000","size":9954,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12502172/HIVE-2017.4.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"123569","customfield_12312823":null,"summary":"Driver.execute() should maintaining SessionState in case of runtime errors","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nzhang","name":"nzhang","key":"nzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ning Zhang","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13002546","id":"13002546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"taskCleanup() is calling System.exit(9) it will exit from JVM. Here instead of calling \nSystem.exit(9) we need to kill the map-reduce & non MR processes","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-03-04T11:12:13.448+0000","updated":"2011-03-04T11:12:13.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13002809","id":"13002809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"body":"Yeah, see my comments in HIVE-1872 regarding the brokenness of the System.exit","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jvs","name":"jvs","key":"jvs","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Sichi","active":true,"timeZone":"Etc/UTC"},"created":"2011-03-04T20:55:28.247+0000","updated":"2011-03-04T20:55:28.247+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13088885","id":"13088885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"while processing two parallel tasks if one of the task fails the Driver.taskCleanup() will call system.exit() this will shutdown the jvm so it is replaced with the logic to stop the remaining tasks.. Here need to cleanup 2 kinds of tasks one is non-mr tasks and  mr tasks. For stopping non-mr tasks used the thread.interrupt() because every non-mr task will be executed as a thread and for mr tasks maintained a variable called jobKillUri's this variable will track the spawned job kill uri, in taskCleanup() if it is a mr task using this variable kill the job. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-08-22T18:20:38.762+0000","updated":"2011-08-22T18:20:38.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13088886","id":"13088886","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/1609/\n-----------------------------------------------------------\n\nReview request for hive, John Sichi and Ning Zhang.\n\n\nSummary\n-------\n\nwhile processing two parallel tasks if one of the task fails the Driver.taskCleanup() will call system.exit() this will shutdown the jvm so it is replaced with the logic to stop the remaining tasks.. Here need to cleanup 2 kinds of tasks one is non-mr tasks and  mr tasks. For stopping non-mr tasks used the thread.interrupt() because every non-mr task will be executed as a thread and for mr tasks maintained a variable called jobKillUri's this variable will track the spawned job kill uri, in taskCleanup() if it is a mr task using this variable kill the job. \n\n\nThis addresses bug HIVE-2017.\n    https://issues.apache.org/jira/browse/HIVE-2017\n\n\nDiffs\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1160102 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 1160102 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1160102 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java 1160102 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1160102 \n  trunk/ql/src/test/queries/clientnegative/alter_exit.q PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/alter_exit.q.out PRE-CREATION \n\nDiff: https://reviews.apache.org/r/1609/diff\n\n\nTesting\n-------\n\nAdded test case for this scenario.  Ran existing test cases\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-22T18:21:29.508+0000","updated":"2011-08-22T18:21:29.508+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13104702","id":"13104702","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"Patch become stale i will rebase the patch and i will upload","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-09-14T17:32:34.402+0000","updated":"2011-09-14T17:32:34.402+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13106619","id":"13106619","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/1609/\n-----------------------------------------------------------\n\n(Updated 2011-09-16 17:33:41.236186)\n\n\nReview request for hive, John Sichi and Ning Zhang.\n\n\nChanges\n-------\n\nRebased the patch on the latest trunk\n\n\nSummary\n-------\n\nwhile processing two parallel tasks if one of the task fails the Driver.taskCleanup() will call system.exit() this will shutdown the jvm so it is replaced with the logic to stop the remaining tasks.. Here need to cleanup 2 kinds of tasks one is non-mr tasks and  mr tasks. For stopping non-mr tasks used the thread.interrupt() because every non-mr task will be executed as a thread and for mr tasks maintained a variable called jobKillUri's this variable will track the spawned job kill uri, in taskCleanup() if it is a mr task using this variable kill the job. \n\n\nThis addresses bug HIVE-2017.\n    https://issues.apache.org/jira/browse/HIVE-2017\n\n\nDiffs (updated)\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1170977 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java 1170977 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1170977 \n  trunk/ql/src/test/queries/clientnegative/alter_exit.q PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/alter_exit.q.out PRE-CREATION \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1170977 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 1170977 \n\nDiff: https://reviews.apache.org/r/1609/diff\n\n\nTesting\n-------\n\nAdded test case for this scenario.  Ran existing test cases\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-09-16T17:35:09.064+0000","updated":"2011-09-16T17:35:09.064+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13143263","id":"13143263","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"body":"\n-----------------------------------------------------------\nThis is an automatically generated e-mail. To reply, visit:\nhttps://reviews.apache.org/r/1609/\n-----------------------------------------------------------\n\n(Updated 2011-11-03 16:01:16.713162)\n\n\nReview request for hive, John Sichi and Ning Zhang.\n\n\nChanges\n-------\n\nPatch becomes stale so rebased\n\n\nSummary\n-------\n\nwhile processing two parallel tasks if one of the task fails the Driver.taskCleanup() will call system.exit() this will shutdown the jvm so it is replaced with the logic to stop the remaining tasks.. Here need to cleanup 2 kinds of tasks one is non-mr tasks and  mr tasks. For stopping non-mr tasks used the thread.interrupt() because every non-mr task will be executed as a thread and for mr tasks maintained a variable called jobKillUri's this variable will track the spawned job kill uri, in taskCleanup() if it is a mr task using this variable kill the job. \n\n\nThis addresses bug HIVE-2017.\n    https://issues.apache.org/jira/browse/HIVE-2017\n\n\nDiffs (updated)\n-----\n\n  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1197183 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 1197183 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1197183 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java 1197183 \n  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1197183 \n  trunk/ql/src/test/queries/clientnegative/alter_exit.q PRE-CREATION \n  trunk/ql/src/test/results/clientnegative/alter_exit.q.out PRE-CREATION \n\nDiff: https://reviews.apache.org/r/1609/diff\n\n\nTesting\n-------\n\nAdded test case for this scenario.  Ran existing test cases\n\n\nThanks,\n\nchinna\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jiraposter%40reviews.apache.org","name":"jiraposter@reviews.apache.org","key":"jiraposter@reviews.apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"jiraposter@reviews.apache.org","active":true,"timeZone":"Etc/UTC"},"created":"2011-11-03T16:01:32.368+0000","updated":"2011-11-03T16:01:32.368+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13145224","id":"13145224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"body":"@Chinna, can you refresh it again ?\nThis is leading to conflicts - I will look at it","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=namit","name":"namit","key":"namit","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Namit Jain","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-07T04:40:38.758+0000","updated":"2011-11-07T04:40:38.758+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13145231","id":"13145231","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"I will rebase now and i will upload patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-07T05:20:34.334+0000","updated":"2011-11-07T05:20:34.334+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/13145497","id":"13145497","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi Namit,\n\n\nHere need to cleanup 2 kinds of tasks one is non-mr tasks and mr tasks. For stopping non-mr tasks used the thread.interrupt() because every non-mr task will be executed as a thread and for mr tasks maintained a variable called jobKillUri's this variable will track the spawned job kill uri, in taskCleanup() if it is a mr task using this variable kill the job.\n\nHere for the non-mr tasks thread.interrupt() may not help completely because they can catch InterruptedException and continue  and in some scenarios nothing it will do (As per API documentation)  other than just setting interrupt status to true for the thread these cases it will not stop the thread.\n\nSo we can add one variable like \"isInterrupted\" in Task.java and set it to true when we want to stop this (Ex in taskCleanup()) while execution of task before doing any major operation check this variable isInterrupted and if it is true return immediately  but with this approach we need add more checks for isInterrupted statements in all tasks.\n\nSo we need to add statements for checking  isInterrupted is set or not  in all the tasks before doing any operation it will take some good amount of time(Ex in ExecDriver before submitting the job) pls give u r inputs on this..\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2011-11-07T13:17:09.936+0000","updated":"2011-11-07T13:17:09.936+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12500098/comment/15431333","id":"15431333","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"body":"This is an old issue. This is not an issue on the master.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chinnalalam","name":"chinnalalam","key":"chinnalalam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chinna Rao Lalam","active":true,"timeZone":"Asia/Kolkata"},"created":"2016-08-22T18:13:04.883+0000","updated":"2016-08-22T18:13:04.883+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-2017/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0li0n:"}}