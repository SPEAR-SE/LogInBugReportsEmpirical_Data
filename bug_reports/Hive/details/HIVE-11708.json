{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12860910","self":"https://issues.apache.org/jira/rest/api/2/issue/12860910","key":"HIVE-11708","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2015-09-02T06:57:01.094+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Sep 02 08:24:41 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11708/watchers","watchCount":5,"isWatching":false},"created":"2015-09-01T06:45:21.833+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324986","id":"12324986","description":"released","name":"0.13.0","archived":false,"released":true,"releaseDate":"2014-04-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-09-02T08:24:41.411+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"According to Language Manual UDF, logical operators returns NULL if one of arguments is NULL.\nhttps://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-LogicalOperators\n\nBut query below fails with ClassCastException.\n{code}\nSELECT COUNT(*) AS c\nFROM tbl\nWHERE 1=1 AND NULL\n{code}\n\nException (on 0.13):\n{noformat}\n15/08/27 08:56:23 ERROR ql.Driver: FAILED: ClassCastException org.apache.hadoop.hive.serde2.objectinspector.primitive.WritableVoidObjectInspector cannot be cast to org.apache.hadoop.hive.serde2.objectinspector.primitive.BooleanObjectInspector\njava.lang.ClassCastException: org.apache.hadoop.hive.serde2.objectinspector.primitive.WritableVoidObjectInspector cannot be cast to org.apache.hadoop.hive.serde2.objectinspector.primitive.BooleanObjectInspector\n\tat org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd.initialize(GenericUDFOPAnd.java:52)\n\tat org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:116)\n\tat org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:231)\n\tat org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory$DefaultExprProcessor.getXpathOrFuncExprNodeDesc(TypeCheckProcFactory.java:934)\n\tat org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory$DefaultExprProcessor.process(TypeCheckProcFactory.java:1128)\n\tat org.apache.hadoop.hive.ql.lib.DefaultRuleDispatcher.dispatch(DefaultRuleDispatcher.java:90)\n\tat org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.dispatchAndReturn(DefaultGraphWalker.java:94)\n\tat org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.dispatch(DefaultGraphWalker.java:78)\n\tat org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.walk(DefaultGraphWalker.java:132)\n\tat org.apache.hadoop.hive.ql.lib.DefaultGraphWalker.startWalking(DefaultGraphWalker.java:109)\n\tat org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory.genExprNode(TypeCheckProcFactory.java:184)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genAllExprNodeDesc(SemanticAnalyzer.java:9716)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genExprNodeDesc(SemanticAnalyzer.java:9672)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genSelectPlan(SemanticAnalyzer.java:3208)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genSelectPlan(SemanticAnalyzer.java:3005)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:8228)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:8183)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:9015)\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:9281)\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:327)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:427)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:323)\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:980)\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1045)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:916)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:906)\n{noformat}\n\nI confirmed that Hive 1.2.1 of HDP2.3 Sandbox also raises this exception.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Logical operators raises ClassCastExceptions with NULL","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tagomoris","name":"tagomoris","key":"tagomoris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satoshi Tagomori","active":true,"timeZone":"Asia/Tokyo"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tagomoris","name":"tagomoris","key":"tagomoris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satoshi Tagomori","active":true,"timeZone":"Asia/Tokyo"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12860910/comment/14726859","id":"14726859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"body":"I tested this and it looks like it only happens when you use the literal \"NULL\". When you AND two columns together one of which happens to have NULL values it seems to work as intended.\n\nAre you seeing the same?\n\nI agree that it's still a bug but if this is the only scenario where it happens it'd be an edge case. Or are you seeing this for other queries as well?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"created":"2015-09-02T06:57:01.094+0000","updated":"2015-09-02T06:57:01.094+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12860910/comment/14726877","id":"14726877","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tagomoris","name":"tagomoris","key":"tagomoris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satoshi Tagomori","active":true,"timeZone":"Asia/Tokyo"},"body":"It also happens with query below:\n{code}\nSELECT *\nFROM testtbl\nWHERE 1=1 AND (map('a',1,'b',2))['c']\n{code}\n\nI don't have exact idea what's difference between {{(map('a',1,'b',2))['c']}} and a field which may contains NULL values.\nBut this case (NULL value from Hive query computation) seems a bit more serious than the scenario of NULL literal for me.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tagomoris","name":"tagomoris","key":"tagomoris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satoshi Tagomori","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-09-02T07:10:38.596+0000","updated":"2015-09-02T07:10:38.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12860910/comment/14726968","id":"14726968","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"body":"That's true. Good example, thank you.\n\nI'll try to take a look at this and will assign to me but if anyone gets to it before me please don't hesitate to reassign.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"created":"2015-09-02T08:10:53.363+0000","updated":"2015-09-02T08:10:53.363+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12860910/comment/14726982","id":"14726982","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tagomoris","name":"tagomoris","key":"tagomoris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satoshi Tagomori","active":true,"timeZone":"Asia/Tokyo"},"body":"Great! (y)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tagomoris","name":"tagomoris","key":"tagomoris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satoshi Tagomori","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-09-02T08:24:41.411+0000","updated":"2015-09-02T08:24:41.411+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-11708/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2jmv3:"}}