{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12664647","self":"https://issues.apache.org/jira/rest/api/2/issue/12664647","key":"HIVE-5125","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"2013-08-20 17:26:55.728","customfield_12310420":"344590","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-5125/watchers","watchCount":1,"isWatching":false},"created":"2013-08-20T17:26:55.728+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-08-20T17:26:55.728+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12320378","id":"12320378","name":"PTF-Windowing","description":"Partitioned Table Functions & Windowing"}],"timeoriginalestimate":null,"description":"There are 2 issues.\n- Ranking invocations must notify user of their relation to the Order clause.\n- When all fn invocations have the same Partition and Order spec, there is no need to talk about componentization in the error message.\n\nHere is more details about these issues. Pasting message posted on Hive User Group:\n\nRegarding the issue posted with rank and dense_rank. The example posted was:\n\nCREATE TABLE test (a INT);\nEXPLAIN\nSELECT\n DENSE_RANK() OVER (PARTITION BY a),\n a\nFROM test;\n\nSome comments on this:\n\n1. The underlying issue is the bug that ranking functions had to be lowercase.  This was fixed in Jira 4954 by Edward.\n    The ranking functions are rank, dense_rank, percent_rank and cume_dist.\n    Some details about this: we check for ranking functions and this check was looking for lowercase names.\n    More below on why we do this check.\n    The rest of hive: parser, functionRegistry etc is not case sensitive. So from a language perspective these\n    functions are not case sensitive.\n\n2. The ranking functions don't accept any arguments. They operate on the expressions specified in the order spec\n   of the window clause. Internally the ranking functions are implemented as UDAFs, so what we do is pass the\n   order expressions as arguments to the ranking functions.  So from a language perspective invoke ranking functions\n  without any arguments.\n\n3. Now the e.g. above is saying partition by 'a'; but no order is specified. Since no order is specified for the ranking functions\n   the order expression assumed is the partition expressions, in this it is 'a'. So the output of this e.g. would be all rows would\n   have a dense_rank = 1.\n\n4. The explanation for this case: DENSE_RANK() OVER (PARTITION BY a)\nyou got:\nFAILED: SemanticException Failed to breakup Windowing invocations into\nGroups. At least 1 group must only depend on input columns. Also check\nfor circular dependencies.\nUnderlying error:\norg.apache.hadoop.hive.ql.exec.UDFArgumentTypeException: One or more\narguments are expected.\n\nThe problem is DENSE_RANK didn't get flagged as a ranking function because of the lowercase bug.\nThis had the effect that we add the order expressions as arguments.\nIt got compiled into a dense_rank UDAF invocation. Which is than expecting at least 1 arg.\n\n5. The explanation for this case: dense_rank(a) OVER (PARTITION BY a)\n\nthis is the right behavior.\nBut I can see the confusion. The error message is not helpful. We should say something to the effect that ranking functions work of order expressions.\nAdding a Jira for this.\n\n6. What is is 'Failed to breakup Windowing invocations into\nGroups. At least 1 group must only depend on input columns. Also check\nfor circular dependencies.'\n\nWe allow for multiple window invocations in a Query. These may be on different partition and order specifications.\nInternally we go through a process of breaking up Window invocations into Groups and do translation on each Group.\nAgain in this case, we should provide better error messages. This message is confusing.\nWhen there is only 1 Group, we should just output the underlying message.\nAdding a Jira for this.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"344890","customfield_12312823":null,"summary":"Better error messages from Windowing queries","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhbutani","name":"rhbutani","key":"rhbutani","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Harish Butani","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[],"maxResults":0,"total":0,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-5125/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1nf9r:"}}