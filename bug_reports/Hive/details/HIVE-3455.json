{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12607356","self":"https://issues.apache.org/jira/rest/api/2/issue/12607356","key":"HIVE-3455","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324986","id":"12324986","description":"released","name":"0.13.0","archived":false,"released":true,"releaseDate":"2014-04-21"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-09-19T05:14:17.797+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Dec 06 00:55:59 UTC 2013","customfield_12310420":"242100","customfield_12312320":null,"customfield_12310222":"10002_*:*_3_*:*_10301105551_*|*_1_*:*_3_*:*_27320339216_*|*_5_*:*_2_*:*_264457_*|*_4_*:*_1_*:*_1179487074","customfield_12312321":null,"resolutiondate":"2013-12-06T00:55:59.065+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3455/watchers","watchCount":7,"isWatching":false},"created":"2012-09-12T22:49:22.817+0000","customfield_12310192":"the patch for the\nsrc/ql/src/java/org/apache/hadoop/hive/ql/udf/generic","customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["patch"],"customfield_12312333":null,"customfield_12310230":"correlation UDAF","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316336","id":"12316336","description":"released","name":"0.7.1","archived":false,"released":true,"releaseDate":"2011-06-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316178","id":"12316178","description":"released","name":"0.8.0","archived":false,"released":true,"releaseDate":"2011-12-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12319268","id":"12319268","description":"released","name":"0.8.1","archived":false,"released":true,"releaseDate":"2012-02-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12317742","id":"12317742","description":"released","name":"0.9.0","archived":false,"released":true,"releaseDate":"2012-04-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12320943","id":"12320943","description":"Unreleased","name":"0.9.1","archived":true,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12320745","id":"12320745","description":"released","name":"0.10.0","archived":false,"released":true,"releaseDate":"2013-01-11"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323587","id":"12323587","description":"Hive 0.11.0","name":"0.11.0","archived":false,"released":true,"releaseDate":"2013-05-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324312","id":"12324312","description":"released","name":"0.12.0","archived":false,"released":true,"releaseDate":"2013-10-15"}],"issuelinks":[{"id":"12364147","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12364147","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12471821","key":"HIVE-1549","self":"https://issues.apache.org/jira/rest/api/2/issue/12471821","fields":{"summary":"Add ANSI SQL correlation aggregate function CORR(X,Y).","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-12-06T00:55:59.109+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313585","id":"12313585","name":"UDF","description":"This includes the UDFs and UDAFs"}],"timeoriginalestimate":null,"description":"A simple test with 2 collinear vectors returns a wrong result.\nThe problem is the merge of variances, file:\n\nhttp://svn.apache.org/viewvc/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFCorrelation.java?revision=1157222&view=markup\n\nlines:\n347: myagg.xvar += xvarB + (xavgA - xavgB) * (xavgA - xavgB) * myagg.count;\n348: myagg.yvar += yvarB + (yavgA - yavgB) * (yavgA - yavgB) * myagg.count;\n\nthe correct merge should be like this:\n347: myagg.xvar += xvarB + (xavgA - xavgB) * (xavgA - xavgB) / myagg.count * nA * nB;\n348: myagg.yvar += yvarB + (yavgA - yavgB) * (yavgA - yavgB) / myagg.count * nA * nB;\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12617110","id":"12617110","filename":"HIVE-3455.1.patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-12-05T04:48:04.292+0000","size":6494,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12617110/HIVE-3455.1.patch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12595069","id":"12595069","filename":"HIVE3455.corrTest.tar.gz","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhartlaub","name":"jhartlaub","key":"jhartlaub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hartlaub","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T23:19:01.057+0000","size":3490,"mimeType":"application/x-gzip","content":"https://issues.apache.org/jira/secure/attachment/12595069/HIVE3455.corrTest.tar.gz"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12545764","id":"12545764","filename":"my.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-19T17:49:37.347+0000","size":2133,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12545764/my.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"12636","customfield_12312823":null,"summary":"ANSI CORR(X,Y) is incorrect","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13454461","id":"13454461","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"body":"284,285c282,283\n<         double xavgOld = myagg.xavg;\n<         double yavgOld = myagg.yavg;\n---\n>         double deltaX = vx - myagg.xavg;\n>         double deltaY = vy - myagg.yavg;\n287,288c285,286\n<         myagg.xavg += (vx - xavgOld) / myagg.count;\n<         myagg.yavg += (vy - yavgOld) / myagg.count;\n---\n>         myagg.xavg += deltaX / ((double) myagg.count);\n>         myagg.yavg += deltaY / ((double) myagg.count);\n290,292c288,290\n<             myagg.covar += (vx - xavgOld) * (vy - myagg.yavg);\n<             myagg.xvar += (vx - xavgOld) * (vx - myagg.xavg);\n<             myagg.yvar += (vy - yavgOld) * (vy - myagg.yavg);\n---\n>             myagg.covar += deltaX * (vy - myagg.yavg);\n>             myagg.xvar += deltaX * (vx - myagg.xavg);\n>             myagg.yvar += deltaY * (vy - myagg.yavg);\n345,350c343,351\n<           myagg.xavg = (xavgA * nA + xavgB * nB) / myagg.count;\n<           myagg.yavg = (yavgA * nA + yavgB * nB) / myagg.count;\n<           myagg.xvar += xvarB + (xavgA - xavgB) * (xavgA - xavgB) * myagg.count;\n<           myagg.yvar += yvarB + (yavgA - yavgB) * (yavgA - yavgB) * myagg.count;\n<           myagg.covar +=\n<               covarB + (xavgA - xavgB) * (yavgA - yavgB) * ((double) (nA * nB) / myagg.count);\n---\n>           double n=myagg.count;\n>           double nn=nA*nB/n;\n>           double dX = xavgA-xavgB;\n>           double dY = yavgA-yavgB;\n>           myagg.xavg = xavgA * nA / n + xavgB * nB / n;\n>           myagg.yavg = yavgA * nA / n + yavgB * nB / n;\n>           myagg.xvar  += xvarB  + dX * dX * nn ;\n>           myagg.yvar  += yvarB  + dY * dY * nn ;\n>           myagg.covar += covarB + dX * dY * nn;\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-12T23:00:36.419+0000","updated":"2012-09-12T23:00:36.419+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13454465","id":"13454465","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"body":"the test, the correct answer is 1.\nhive> select * from max_corr ;\nOK\n1\t2\n2\t4\n3\t6\nTime taken: 2.304 seconds\nhive> select corr(a,b) from max_corr ;\nTotal MapReduce jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks determined at compile time: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapred.reduce.tasks=<number>\nStarting Job = job_201207232322_2781, Tracking URL = http://*****/jobdetails.jsp?jobid=job_201207232322_2781\nKill Command = /usr/lib/hadoop/bin/hadoop job  -Dmapred.job.tracker=hdfs://***** -kill job_201207232322_2781\n2012-09-12 10:04:17,663 Stage-1 map = 0%,  reduce = 0%\n2012-09-12 10:04:20,681 Stage-1 map = 100%,  reduce = 0%\n2012-09-12 10:04:27,720 Stage-1 map = 100%,  reduce = 33%\n2012-09-12 10:04:28,728 Stage-1 map = 100%,  reduce = 100%\nEnded Job = job_201207232322_2781\nOK\n0.27586206896551724\nTime taken: 15.088 seconds\nhive> \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-12T23:06:56.486+0000","updated":"2012-09-12T23:06:56.486+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458414","id":"13458414","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"body":"I think your data file must be in error.\n\n{noformat}\nFROM (\n\nselect inline ( array( struct(1,2), struct(2,4), struct(3,6) ) ) as (x,y) from dummy limit 3\n\n) b select corr(b.x,b.y) \n\nOK\n0.9999999999999999\nTime taken: 9.436 seconds\n\n{noformat}\n\nand \n\n{noformat}\nhive> FROM (\n    > \n    > select inline ( array( struct(1,3), struct(2,2), struct(3,1) ) ) as (x,y) from dummy limit 3\n    > \n    > ) b select corr(b.x,b.y) ;\n\nMapred Local Task Succeeded . Convert the Join into MapJoin\nOK\n-0.9999999999999999\nTime taken: 10.842 seconds\n\n{noformat}\n\nLooks good compared to. http://my.safaribooksonline.com/book/databases/sql/9780596155322/ansi-sql-aggregate-functions/id3490390\n\nPlease re-open if I am wrong.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-19T05:14:17.797+0000","updated":"2012-09-19T05:14:17.797+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458416","id":"13458416","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"body":"the whole point of the bug is that the MERGE part is wrong, not the MAP, you can't test it with just inline array, you have to have at least to pieces to merge in a reducer. please check again the formula in the merge part.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-19T05:18:53.761+0000","updated":"2012-09-19T05:18:53.761+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458417","id":"13458417","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"body":"the whole point of the bug is that the MERGE part is wrong, not the MAP, you can't test it with just inline array, you have to have at least to pieces to merge in a reducer. please check again the formula in the merge part.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-19T05:19:18.878+0000","updated":"2012-09-19T05:19:18.878+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458422","id":"13458422","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"body":"I will look into this more. You example uses a select * which does not have a reduce phase. So I do not see how your example produces that result.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-19T05:32:20.291+0000","updated":"2012-09-19T05:32:20.291+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458427","id":"13458427","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"body":"I do have a cluster with 26 nodes, select * just an example of a simple table.\nThe table was created by \"create external table ... location ... ;\"\nFor this table \"select corr(a,b) from t;\" hive starts 2 mappers and 1 reducer.\nThe unit test for this function doesn't cover all cases.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-19T05:43:01.428+0000","updated":"2012-09-19T05:43:01.428+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458446","id":"13458446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"body":"Good catch I set the input format to NLineInput \n\ncreate table data6 (name string, x int, y int) stored as inputformat 'org.apache.hadoop.mapred.lib.NLineInputFormat' outputformat 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat';\n\nThis did indeed mess produce the wrongresults. Nice catch. Will patch shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-19T06:23:11.635+0000","updated":"2012-09-19T06:23:11.635+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458636","id":"13458636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"body":"Can you please attach your diff as something that will apply with patch -p0. I do not know how to apply your patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=appodictic","name":"appodictic","key":"appodictic","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Capriolo","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-19T12:32:40.390+0000","updated":"2012-09-19T12:32:40.390+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13458891","id":"13458891","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"body":"the patch for the\nsrc/ql/src/java/org/apache/hadoop/hive/ql/udf/generic","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maximbo","name":"maximbo","key":"maximbo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Maxim Bolotin","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-19T17:49:37.348+0000","updated":"2012-09-19T17:49:37.348+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13527286","id":"13527286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"body":"Patch needs a testcase. Maxim / Ed, if you guys are working on this, can you please add a testcase and update the patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ashutoshc","name":"ashutoshc","key":"ashutoshc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ashutosh Chauhan","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-12-08T23:12:11.331+0000","updated":"2012-12-08T23:12:11.331+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13724590","id":"13724590","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhartlaub","name":"jhartlaub","key":"jhartlaub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hartlaub","active":true,"timeZone":"America/Los_Angeles"},"body":"Attached are a data file, a \".q\" file and a \".q.out\" file that exercise the corr merge problem.  The patch in this ticket passes this test.  (test correlates a variable with itself using a CLUSTER BY column)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhartlaub","name":"jhartlaub","key":"jhartlaub","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hartlaub","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-30T23:19:01.060+0000","updated":"2013-07-30T23:19:01.060+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13795726","id":"13795726","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"body":"Clearing fix version. in hive the fix version is set after a patch is committed.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thejas","name":"thejas","key":"thejas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thejas&avatarId=15902","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thejas&avatarId=15902","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thejas&avatarId=15902","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thejas&avatarId=15902"},"displayName":"Thejas M Nair","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-10-15T22:13:20.518+0000","updated":"2013-10-15T22:13:20.518+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13834648","id":"13834648","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kostiantyn","name":"kostiantyn","key":"kostiantyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10445","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10445","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10445","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10445"},"displayName":"Kostiantyn Kudriavtsev","active":true,"timeZone":"Etc/UTC"},"body":"Hi all,\nI have dumped into the same issue. Maxim's patch is correct, I applied it and everything works correct\nI'm pretty sure it must be included into trunk ASAP, because of current Hive's implementation is incorrect","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kostiantyn","name":"kostiantyn","key":"kostiantyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10445","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10445","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10445","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10445"},"displayName":"Kostiantyn Kudriavtsev","active":true,"timeZone":"Etc/UTC"},"created":"2013-11-28T09:33:48.395+0000","updated":"2013-11-28T09:33:48.395+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13838833","id":"13838833","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kostiantyn","name":"kostiantyn","key":"kostiantyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10445","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10445","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10445","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10445"},"displayName":"Kostiantyn Kudriavtsev","active":true,"timeZone":"Etc/UTC"},"body":"Does Anybody work on including this path into release branches?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kostiantyn","name":"kostiantyn","key":"kostiantyn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10445","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10445","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10445","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10445"},"displayName":"Kostiantyn Kudriavtsev","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-04T11:47:24.265+0000","updated":"2013-12-04T11:47:24.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13839803","id":"13839803","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"This is apparently a bug. Rebased patch with a test case and +1 for me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-12-05T04:50:20.757+0000","updated":"2013-12-05T04:50:20.757+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13839866","id":"13839866","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"body":"\n\n{color:green}Overall{color}: +1 all checks pass\n\nHere are the results of testing the latest attachment:\nhttps://issues.apache.org/jira/secure/attachment/12617110/HIVE-3455.1.patch.txt\n\n{color:green}SUCCESS:{color} +1 4458 tests passed\n\nTest results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/525/testReport\nConsole output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/525/console\n\nMessages:\n{noformat}\nExecuting org.apache.hive.ptest.execution.PrepPhase\nExecuting org.apache.hive.ptest.execution.ExecutionPhase\nExecuting org.apache.hive.ptest.execution.ReportingPhase\n{noformat}\n\nThis message is automatically generated.\n\nATTACHMENT ID: 12617110","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hiveqa","name":"hiveqa","key":"hiveqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hiveqa&avatarId=17060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hiveqa&avatarId=17060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hiveqa&avatarId=17060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hiveqa&avatarId=17060"},"displayName":"Hive QA","active":true,"timeZone":"America/Chicago"},"created":"2013-12-05T06:32:02.833+0000","updated":"2013-12-05T06:32:02.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12607356/comment/13840758","id":"13840758","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"body":"Committed to trunk. Thanks Maxim!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navis","name":"navis","key":"navis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=navis&avatarId=19885","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=navis&avatarId=19885","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=navis&avatarId=19885","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=navis&avatarId=19885"},"displayName":"Navis","active":true,"timeZone":"Asia/Seoul"},"created":"2013-12-06T00:55:59.104+0000","updated":"2013-12-06T00:55:59.104+0000"}],"maxResults":18,"total":18,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-3455/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i02iqf:"}}