{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12974944","self":"https://issues.apache.org/jira/rest/api/2/issue/12974944","key":"HIVE-13908","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310843","id":"12310843","key":"HIVE","name":"Hive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-06-10T16:25:43.561+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jun 10 16:25:43 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13908/watchers","watchCount":3,"isWatching":false},"created":"2016-06-01T21:40:47.765+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-06-10T16:25:43.561+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Via beeline, although -35664.76 is inserted,  -35664.76171875 is displayed\n{noformat}\n0: jdbc:hive2://ts-0531-1.openstacklocal:2181> drop table test;\nNo rows affected (0.067 seconds)\n0: jdbc:hive2://ts-0531-1.openstacklocal:2181> create table test(f float);\nNo rows affected (0.248 seconds)\n0: jdbc:hive2://ts-0531-1.openstacklocal:2181> insert into table test values(-35664.76),(29497.34);\nINFO  : Tez session hasn't been created yet. Opening session\nINFO  : Dag name: insert into table tes...35664.76),(29497.34)(Stage-1)\nINFO  :\n\nINFO  : Status: Running (Executing on YARN cluster with App id application_1464727816747_0019)\n\nINFO  : Map 1: -/-\nINFO  : Map 1: 0/1\nINFO  : Map 1: 0/1\nINFO  : Map 1: 0(+1)/1\nINFO  : Map 1: 1/1\nINFO  : Loading data to table default.test from hdfs://ts-0531-5.openstacklocal:8020/apps/hive/warehouse/test/.hive-staging_hive_2016-06-01_20-16-32_885_9161749848563358684-1/-ext-10000\nINFO  : Table default.test stats: [numFiles=1, numRows=2, totalSize=19, rawDataSize=17]\nNo rows affected (31.725 seconds)\n0: jdbc:hive2://ts-0531-1.openstacklocal:2181> select * from test;\n+------------------+--+\n|      test.f      |\n+------------------+--+\n| -35664.76171875  |\n| 29497.33984375   |\n+------------------+--+\n2 rows selected (0.143 seconds)\n{noformat}\n\nThe issue is not seen via Hive CLI:\n{noformat}\nhive> create table test(f float);\nOK\nTime taken: 0.32 seconds\nhive> insert into table test values(-35664.76),(29497.34);\nQuery ID = hrt_qa_20160601202446_75f38c5d-f52b-45b3-b67a-8a8b0a194305\nTotal jobs = 1\nLaunching Job 1 out of 1\n\n\nStatus: Running (Executing on YARN cluster with App id application_1464727816747_0020)\n\n--------------------------------------------------------------------------------\n        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED\n--------------------------------------------------------------------------------\nMap 1 ..........   SUCCEEDED      1          1        0        0       0       0\n--------------------------------------------------------------------------------\nVERTICES: 01/01  [==========================>>] 100%  ELAPSED TIME: 7.66 s\n--------------------------------------------------------------------------------\nLoading data to table default.test\nTable default.test stats: [numFiles=1, numRows=2, totalSize=19, rawDataSize=17]\nOK\nTime taken: 11.477 seconds\nhive> select * from test;\nOK\n-35664.76\n29497.34\nTime taken: 0.144 seconds, Fetched: 2 row(s)\n{noformat}\n\nhdfs file shows expected value:\n{noformat}\n0: jdbc:hive2://ts-0531-1.openstacklocal:2181> dfs -cat hdfs://ts-0531-5.openstacklocal:8020/apps/hive/warehouse/test/000000_0\n0: jdbc:hive2://ts-0531-1.openstacklocal:2181> ;\n+-------------+--+\n| DFS Output  |\n+-------------+--+\n| -35664.76   |\n| 29497.34    |\n+-------------+--+\n{noformat}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12332384","id":"12332384","name":"1.2.1","archived":false,"released":true,"releaseDate":"2015-06-26"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Beeline adds extra fractional digits when you insert values to table with float data type ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=taksaito","name":"taksaito","key":"taksaito","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Takahiko Saito","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=taksaito","name":"taksaito","key":"taksaito","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10438","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10438","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10438","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10438"},"displayName":"Takahiko Saito","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12974944/comment/15324738","id":"15324738","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"body":"This issue is related to a Thrift communication. \n\nThe FLOAT data is correctly loaded on HS2, but in order to send it to beeline, it needs to cast it as DOUBLE because Thrift does not support FLOAT data types. This is where the decimals got extended. \n\nThis is the code where it happens:\nhttps://github.com/apache/hive/blob/master/serde/src/java/org/apache/hadoop/hive/serde2/thrift/ColumnBuffer.java#L368\n\n{noformat}\ncase FLOAT_TYPE:\n      nulls.set(size, field == null);\n      doubleVars()[size] = field == null ? 0 : new Double(field.toString());\n      break;\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=spena","name":"spena","key":"spena","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergio Peña","active":true,"timeZone":"America/Chicago"},"created":"2016-06-10T16:25:43.561+0000","updated":"2016-06-10T16:25:43.561+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HIVE-13908/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2yuov:"}}