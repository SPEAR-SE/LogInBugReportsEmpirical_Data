{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": null,
        "components": [{
            "description": "Tracks issues related to the HCatalog",
            "id": "12320409",
            "name": "HCatalog",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12320409"
        }],
        "created": "2014-09-24T20:58:09.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Eugene Koifman",
            "key": "ekoifman",
            "name": "ekoifman",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ekoifman",
            "timeZone": "America/Los_Angeles"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": null,
        "customfield_12310222": null,
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "1.0",
        "customfield_12310320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i20g9b:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Sep 24 23:22:07 UTC 2014",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "\nSuppose a Hive table has columns (a,b,c,d)\nIf a Pig script writing to this table produces schema (a,b,c) it works: 'd' will be NULL.\n\nIf a Pig script writing to this table produces schema (a,b,d) it fails with error below.\nThis is an old issue.  There is nothing in HCatalog documentation that indicates whether this should work.\n\nAlso, (a,c,b) would not work either.\n\n{noformat}\nRunning org.apache.hive.hcatalog.pig.TestOrcHCatStorer\nTests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 30.113 sec <<< FAILURE! - in org.apache.hive.hcatalog.pig.TestOrcHCatStorer\npartialSchemaSepcification(org.apache.hive.hcatalog.pig.TestOrcHCatStorer)  Time elapsed: 29.886 sec  <<< ERROR!\norg.apache.pig.impl.logicalLayer.FrontendException: Unable to store alias ABD\n\tat org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1635)\n\tat org.apache.pig.PigServer.registerQuery(PigServer.java:575)\n\tat org.apache.hive.hcatalog.mapreduce.HCatBaseTest.logAndRegister(HCatBaseTest.java:92)\n\tat org.apache.hive.hcatalog.pig.TestHCatStorer.partialSchemaSepcification(TestHCatStorer.java:1035)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:254)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:149)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:124)\n\tat org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:200)\n\tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:153)\n\tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:103)\nCaused by: org.apache.pig.impl.plan.VisitorException: \n<line 7, column 0> Output Location Validation Failed for: 'T More info to follow:\norg.apache.hive.hcatalog.common.HCatException : 2007 : Invalid column position in partition schema : Expected column <c> at position 3, found column <d>\n\tat org.apache.pig.newplan.logical.rules.InputOutputFileValidator$InputOutputFileVisitor.visit(InputOutputFileValidator.java:75)\n\tat org.apache.pig.newplan.logical.relational.LOStore.accept(LOStore.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:64)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.walk(DepthFirstWalker.java:53)\n\tat org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)\n\tat org.apache.pig.newplan.logical.rules.InputOutputFileValidator.validate(InputOutputFileValidator.java:45)\n\tat org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.compile(HExecutionEngine.java:303)\n\tat org.apache.pig.PigServer.compilePp(PigServer.java:1380)\n\tat org.apache.pig.PigServer.executeCompiledLogicalPlan(PigServer.java:1305)\n\tat org.apache.pig.PigServer.execute(PigServer.java:1297)\n\tat org.apache.pig.PigServer.access$400(PigServer.java:122)\n\tat org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1630)\n\tat org.apache.pig.PigServer.registerQuery(PigServer.java:575)\n\tat org.apache.hive.hcatalog.mapreduce.HCatBaseTest.logAndRegister(HCatBaseTest.java:92)\n\tat org.apache.hive.hcatalog.pig.TestHCatStorer.partialSchemaSepcification(TestHCatStorer.java:1035)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:254)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:149)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:124)\n\tat org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:200)\n\tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:153)\n\tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:103)\nCaused by: org.apache.hive.hcatalog.common.HCatException: org.apache.hive.hcatalog.common.HCatException : 2007 : Invalid column position in partition schema : Expected column <c> at position 3, found column <d>\n\tat org.apache.hive.hcatalog.common.HCatUtil.validatePartitionSchema(HCatUtil.java:258)\n\tat org.apache.hive.hcatalog.mapreduce.HCatBaseOutputFormat.setPartDetails(HCatBaseOutputFormat.java:231)\n\tat org.apache.hive.hcatalog.mapreduce.HCatOutputFormat.setSchema(HCatOutputFormat.java:244)\n\tat org.apache.hive.hcatalog.mapreduce.HCatOutputFormat.setSchema(HCatOutputFormat.java:231)\n\tat org.apache.hive.hcatalog.pig.HCatStorer.setStoreLocation(HCatStorer.java:206)\n\tat org.apache.pig.newplan.logical.rules.InputOutputFileValidator$InputOutputFileVisitor.visit(InputOutputFileValidator.java:68)\n\tat org.apache.pig.newplan.logical.relational.LOStore.accept(LOStore.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:64)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.depthFirst(DepthFirstWalker.java:66)\n\tat org.apache.pig.newplan.DepthFirstWalker.walk(DepthFirstWalker.java:53)\n\tat org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)\n\tat org.apache.pig.newplan.logical.rules.InputOutputFileValidator.validate(InputOutputFileValidator.java:45)\n\tat org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.compile(HExecutionEngine.java:303)\n\tat org.apache.pig.PigServer.compilePp(PigServer.java:1380)\n\tat org.apache.pig.PigServer.executeCompiledLogicalPlan(PigServer.java:1305)\n\tat org.apache.pig.PigServer.execute(PigServer.java:1297)\n\tat org.apache.pig.PigServer.access$400(PigServer.java:122)\n\tat org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1630)\n\tat org.apache.pig.PigServer.registerQuery(PigServer.java:575)\n\tat org.apache.hive.hcatalog.mapreduce.HCatBaseTest.logAndRegister(HCatBaseTest.java:92)\n\tat org.apache.hive.hcatalog.pig.TestHCatStorer.partialSchemaSepcification(TestHCatStorer.java:1035)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:254)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:149)\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:124)\n\tat org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:200)\n\tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:153)\n\tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:103)\n\n\nResults :\n\nTests in error: \n  TestOrcHCatStorer>TestHCatStorer.partialSchemaSepcification:1035->HCatBaseTest.logAndRegister:92 ? Frontend\n{noformat}\n\n\nReproducer (which can be added to org.apache.hive.hcatalog.pig.TestHCatStorer)\n{noformat}\n  @Test\n  public void partialSchemaSepcification() throws Exception {\n    driver.run(\"drop table if exists T\");\n    String createTable = \"create table T(a int, b int, c string, d string) stored as \" + getStorageFormat();\n    int retCode = driver.run(createTable).getResponseCode();\n    if (retCode != 0) {\n      throw new IOException(\"Failed to create table.\");\n    }\n    String[] inputData = {\"1\\t20\\tstr1\\tstr20\", \"2\\t30\\tstr2\\tstr30\", \"3\\t40\\tstr3\\tstr40\", \"4\\t50\\tstr4\\tstr40\"};\n    HcatTestUtils.createTestDataFile(INPUT_FILE_NAME, inputData);\n    int lineNumber = 1;\n    PigServer ps = createPigServer(true);\n    logAndRegister(ps, \"A1 = LOAD '\" + INPUT_FILE_NAME + \"' USING PigStorage() AS (a:int,b:int,c:chararray,d:chararray);\", lineNumber++);\n    logAndRegister(ps, \"ROW1 = FILTER A1 BY a == 1;\", lineNumber++);\n    logAndRegister(ps, \"ABC = FOREACH ROW1 GENERATE a,b,c;\", lineNumber++);\n    logAndRegister(ps, \"STORE ABC INTO 'T' USING \" + HCatStorer.class.getName() + \"();\", lineNumber++);\n\n    logAndRegister(ps, \"ROW2 = FILTER A1 BY a == 2;\", lineNumber++);\n    logAndRegister(ps, \"ABD = FOREACH ROW2 GENERATE a,b,d;\", lineNumber++);\n    logAndRegister(ps, \"STORE ABD INTO 'T' USING \" + HCatStorer.class.getName() + \"();\", lineNumber);\n    driver.run(\"select * from T\");\n    ArrayList<String> results = new ArrayList<String>();\n    driver.getResults(results);\n    Assert.assertEquals(2, results.size());\n    driver.run(\"drop table T\");\n  }\n{noformat}",
        "duedate": null,
        "environment": null,
        "fixVersions": [],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935"
            },
            "id": "12310843",
            "key": "HIVE",
            "name": "Hive",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310843"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Eugene Koifman",
            "key": "ekoifman",
            "name": "ekoifman",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ekoifman",
            "timeZone": "America/Los_Angeles"
        },
        "resolution": null,
        "resolutiondate": null,
        "status": {
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "id": "1",
            "name": "Open",
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "statusCategory": {
                "colorName": "blue-gray",
                "id": 2,
                "key": "new",
                "name": "To Do",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2"
            }
        },
        "subtasks": [],
        "summary": "Pig cursor written to Hive via HCat doesn't NULL-fill missing columns",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2014-09-25T01:10:00.000+0000",
        "versions": [{
            "archived": false,
            "description": "0.13 maintenance release 1",
            "id": "12326829",
            "name": "0.13.1",
            "releaseDate": "2014-06-06",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12326829"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-8247/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-8247/watchers",
            "watchCount": 0
        },
        "workratio": -1
    },
    "id": "12743860",
    "key": "HIVE-8247",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12743860"
}