[navis requested code review of "HIVE-5414 [jira] The result of show grant is not visible via JDBC".

Reviewers: JIRA

HIVE-5414 The result of show grant is not visible via JDBC

TEST PLAN
  EMPTY

REVISION DETAIL
  https://reviews.facebook.net/D13209

AFFECTED FILES
  jdbc/src/test/org/apache/hive/jdbc/TestJdbcDriver2.java
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
  ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/RoleDDLDesc.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/ShowGrantDesc.java
  ql/src/test/results/clientnegative/authorization_fail_3.q.out
  ql/src/test/results/clientnegative/authorization_fail_4.q.out
  ql/src/test/results/clientnegative/authorization_fail_5.q.out
  ql/src/test/results/clientnegative/authorization_fail_7.q.out
  ql/src/test/results/clientnegative/authorization_part.q.out
  ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
  ql/src/test/results/clientpositive/authorization_1.q.out
  ql/src/test/results/clientpositive/authorization_2.q.out
  ql/src/test/results/clientpositive/authorization_3.q.out
  ql/src/test/results/clientpositive/authorization_4.q.out
  ql/src/test/results/clientpositive/authorization_5.q.out
  ql/src/test/results/clientpositive/authorization_6.q.out
  ql/src/test/results/clientpositive/keyword_1.q.out
  service/src/java/org/apache/hive/service/CompositeService.java

MANAGE HERALD RULES
  https://reviews.facebook.net/herald/view/differential/

WHY DID I GET THIS EMAIL?
  https://reviews.facebook.net/herald/transcript/38823/

To: JIRA, navis
, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12606253/D13209.1.patch

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 4078 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_show_tblproperties
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_unset_table_view_property
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_unset_table_property
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_unset_view_property
org.apache.hcatalog.hbase.snapshot.lock.TestWriteLock.testRun
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/996/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/996/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests failed with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated., navis updated the revision "HIVE-5414 [jira] The result of show grant is not visible via JDBC".

  Fixed outputs

Reviewers: JIRA

REVISION DETAIL
  https://reviews.facebook.net/D13209

CHANGE SINCE LAST DIFF
  https://reviews.facebook.net/D13209?vs=40779&id=40941#toc

AFFECTED FILES
  jdbc/src/test/org/apache/hive/jdbc/TestJdbcDriver2.java
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
  ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/RoleDDLDesc.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/ShowGrantDesc.java
  ql/src/test/results/clientnegative/authorization_fail_3.q.out
  ql/src/test/results/clientnegative/authorization_fail_4.q.out
  ql/src/test/results/clientnegative/authorization_fail_5.q.out
  ql/src/test/results/clientnegative/authorization_fail_7.q.out
  ql/src/test/results/clientnegative/authorization_part.q.out
  ql/src/test/results/clientnegative/unset_table_property.q.out
  ql/src/test/results/clientnegative/unset_view_property.q.out
  ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
  ql/src/test/results/clientpositive/authorization_1.q.out
  ql/src/test/results/clientpositive/authorization_2.q.out
  ql/src/test/results/clientpositive/authorization_3.q.out
  ql/src/test/results/clientpositive/authorization_4.q.out
  ql/src/test/results/clientpositive/authorization_5.q.out
  ql/src/test/results/clientpositive/authorization_6.q.out
  ql/src/test/results/clientpositive/keyword_1.q.out
  ql/src/test/results/clientpositive/show_tblproperties.q.out
  ql/src/test/results/clientpositive/unset_table_view_property.q.out
  service/src/java/org/apache/hive/service/CompositeService.java

To: JIRA, navis
, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12606701/D13209.2.patch

{color:green}SUCCESS:{color} +1 4037 tests passed

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/1025/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/1025/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated., navis updated the revision "HIVE-5414 [jira] The result of show grant is not visible via JDBC".

  Rebased to trunk

Reviewers: JIRA

REVISION DETAIL
  https://reviews.facebook.net/D13209

CHANGE SINCE LAST DIFF
  https://reviews.facebook.net/D13209?vs=40941&id=44271#toc

AFFECTED FILES
  itests/hive-unit/src/test/java/org/apache/hive/jdbc/TestJdbcDriver2.java
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
  ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/RoleDDLDesc.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/ShowGrantDesc.java
  ql/src/test/results/clientnegative/authorization_fail_3.q.out
  ql/src/test/results/clientnegative/authorization_fail_4.q.out
  ql/src/test/results/clientnegative/authorization_fail_5.q.out
  ql/src/test/results/clientnegative/authorization_fail_7.q.out
  ql/src/test/results/clientnegative/authorization_part.q.out
  ql/src/test/results/clientnegative/unset_table_property.q.out
  ql/src/test/results/clientnegative/unset_view_property.q.out
  ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
  ql/src/test/results/clientpositive/authorization_1.q.out
  ql/src/test/results/clientpositive/authorization_2.q.out
  ql/src/test/results/clientpositive/authorization_3.q.out
  ql/src/test/results/clientpositive/authorization_4.q.out
  ql/src/test/results/clientpositive/authorization_5.q.out
  ql/src/test/results/clientpositive/authorization_6.q.out
  ql/src/test/results/clientpositive/keyword_1.q.out
  ql/src/test/results/clientpositive/show_tblproperties.q.out
  ql/src/test/results/clientpositive/unset_table_view_property.q.out
  service/src/java/org/apache/hive/service/CompositeService.java

To: JIRA, navis
, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12615544/D13209.3.patch

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 4684 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testNegativeCliDriver_mapreduce_stack_trace_hadoop20
{noformat}

Test results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/435/testReport
Console output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/435/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests failed with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12615544, Strange. I cannot reproduce the test failure., rerunning test, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12617287/HIVE-5414.4.patch.txt

{color:green}SUCCESS:{color} +1 4458 tests passed

Test results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/541/testReport
Console output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/541/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12617287, thejas has commented on the revision "HIVE-5414 [jira] The result of show grant is not visible via JDBC".

  The patch does not apply on trunk anymore. Can you also please rebase ?
  Sorry about the delay in reviewing this patch.

INLINE COMMENTS
  ql/src/java/org/apache/hadoop/hive/ql/plan/ShowGrantDesc.java:36 I think "property" would be a better name for column, than "key".
  itests/hive-unit/src/test/java/org/apache/hive/jdbc/TestJdbcDriver2.java:1816 can you also add test for column name and column type of result ?
  itests/hive-unit/src/test/java/org/apache/hive/jdbc/TestJdbcDriver2.java:1814 can you also add a test for 'show roles' ?

REVISION DETAIL
  https://reviews.facebook.net/D13209

To: JIRA, navis
Cc: Unknown Object (Phabricator User), thejas
, sorry, missed this., navis updated the revision "HIVE-5414 [jira] The result of show grant is not visible via JDBC".

  Addressed comments

Reviewers: JIRA

REVISION DETAIL
  https://reviews.facebook.net/D13209

CHANGE SINCE LAST DIFF
  https://reviews.facebook.net/D13209?vs=44271&id=46389#toc

AFFECTED FILES
  itests/hive-unit/src/test/java/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
  itests/hive-unit/src/test/java/org/apache/hive/jdbc/TestJdbcDriver2.java
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
  ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/RoleDDLDesc.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/ShowGrantDesc.java
  ql/src/test/results/clientnegative/authorization_fail_3.q.out
  ql/src/test/results/clientnegative/authorization_fail_4.q.out
  ql/src/test/results/clientnegative/authorization_fail_5.q.out
  ql/src/test/results/clientnegative/authorization_fail_7.q.out
  ql/src/test/results/clientnegative/authorization_part.q.out
  ql/src/test/results/clientnegative/unset_table_property.q.out
  ql/src/test/results/clientnegative/unset_view_property.q.out
  ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
  ql/src/test/results/clientpositive/authorization_1.q.out
  ql/src/test/results/clientpositive/authorization_2.q.out
  ql/src/test/results/clientpositive/authorization_3.q.out
  ql/src/test/results/clientpositive/authorization_4.q.out
  ql/src/test/results/clientpositive/authorization_5.q.out
  ql/src/test/results/clientpositive/authorization_6.q.out
  ql/src/test/results/clientpositive/keyword_1.q.out
  ql/src/test/results/clientpositive/show_tblproperties.q.out
  ql/src/test/results/clientpositive/unset_table_view_property.q.out

To: JIRA, navis
Cc: thejas
, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12620797/D13209.4.patch

{color:green}SUCCESS:{color} +1 4820 tests passed

Test results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/769/testReport
Console output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/769/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12620797, +1, thejas has commented on the revision "HIVE-5414 [jira] The result of show grant is not visible via JDBC".

  +1

REVISION DETAIL
  https://reviews.facebook.net/D13209

To: JIRA, navis
Cc: thejas
, Committed to trunk. Thanks Thejas for a review.]