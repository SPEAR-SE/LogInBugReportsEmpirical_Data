[[~ctang.ma], this is a duplicate of HIVE-15160. It is still work in progress. If you would like to try, the patch should work for most of the cases., Thanks, [~pxiong]. It looks like that my sample above does still not work with your patch.06 in HIVE-15160 when the hive.cbo.enable is disabled.  , [~ctang.ma], that is expected as my patch only changes CBO path. :)]