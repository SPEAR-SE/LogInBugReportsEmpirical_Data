[This is fixed in https://jira.apache.org/jira/browse/HIVE-19097, I'm attaching the patch for this work anyway in case anyone want to backport a simpler fix to older branches. [^HIVE-21074.patch]]