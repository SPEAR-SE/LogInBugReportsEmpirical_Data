[I'm facing the same issue with the following hive script
[code]
add file hdfs:///user/jpoullet/bridgeIris/HBase/getDoubleFloat.py;
add file hdfs:///user/jpoullet/bridgeIris/HBase/getDoubleFloat-reduce.py;
FROM (
	FROM vcf_hbase_hive_20141009 
	MAP vcf_hbase_hive_20141009.QUAL 
	USING 'python getDoubleFloat.py' 
	AS mydouble
	CLUSTER BY mydouble) map_output
     INSERT OVERWRITE TABLE doubletable 
     REDUCE map_output.mydouble
     USING 'python getDoubleFloat-reduce.py' 
     AS biased_mean;
[/code]

I'm getting the error message
Error while processing statement: FAILED: Execution Error, return code 20003 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask. An error occurred when trying to close the Operator running your custom script.


, For info I'm under CDH 5.1.3 but I don't think this makes a difference (Hive 0.12.0 is used), [~jpoullet] Could you try with the patch attached?, hi @Navis,i try this and it didnt work.]