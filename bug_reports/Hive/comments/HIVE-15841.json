[GitHub user omalley opened a pull request:

    https://github.com/apache/hive/pull/142

    HIVE-15841. Upgrade to ORC 1.3.2.

    

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/omalley/hive hive-15841

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/hive/pull/142.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #142
    
----
commit 3078b0f32fec97607b97fa31e29527da50631099
Author: Owen O'Malley <omalley@apache.org>
Date:   2017-02-07T23:27:31Z

    HIVE-15841. Upgrade to ORC 1.3.2.

----
, How does sarg applier know the column names now?, It gets them from the SchemaEvolution. In particular, they come from OrcInputFormat.getDesiredRowTypeDescr(...) which uses schema.evolution.columns and schema.evolution.columns.types or columns and columns.types from the config., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12852928/HIVE-15841.patch

{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 10238 tests executed
*Failed tests:*
{noformat}
TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cbo_rp_auto_join1] (batchId=3)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join31] (batchId=81)
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_join_with_different_encryption_keys] (batchId=159)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[multiMapJoin2] (batchId=152)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=148)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_outer_join1] (batchId=160)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_outer_join2] (batchId=160)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=223)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join31] (batchId=133)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3583/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3583/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3583/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 11 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12852928 - PreCommit-HIVE-Build, Resubmitted for another test run. Should this be upgraded to 1.3.3 directly?, Yes, I agree. Updating the patch now., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12852928/HIVE-15841.patch

{color:red}ERROR:{color} -1 due to build exiting with an error

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4274/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4274/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4274/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Tests exited with: NonZeroExitCodeException
Command 'bash /data/hiveptest/working/scratch/source-prep.sh' failed with exit status 1 and output '+ date '+%Y-%m-%d %T.%3N'
2017-03-21 21:38:36.156
+ [[ -n /usr/lib/jvm/java-8-openjdk-amd64 ]]
+ export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
+ JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
+ export PATH=/usr/lib/jvm/java-8-openjdk-amd64/bin/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/usr/lib/jvm/java-8-openjdk-amd64/bin/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ export 'ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m '
+ ANT_OPTS='-Xmx1g -XX:MaxPermSize=256m '
+ export 'MAVEN_OPTS=-Xmx1g '
+ MAVEN_OPTS='-Xmx1g '
+ cd /data/hiveptest/working/
+ tee /data/hiveptest/logs/PreCommit-HIVE-Build-4274/source-prep.txt
+ [[ false == \t\r\u\e ]]
+ mkdir -p maven ivy
+ [[ git = \s\v\n ]]
+ [[ git = \g\i\t ]]
+ [[ -z master ]]
+ [[ -d apache-github-source-source ]]
+ [[ ! -d apache-github-source-source/.git ]]
+ [[ ! -d apache-github-source-source ]]
+ date '+%Y-%m-%d %T.%3N'
2017-03-21 21:38:36.158
+ cd apache-github-source-source
+ git fetch origin
From https://github.com/apache/hive
   4f45536..9f5a3e3  master     -> origin/master
+ git reset --hard HEAD
HEAD is now at 4f45536 HIVE-16246: Support auto gather column stats for columns with trailing white spaces (Pengcheng XXiong, reviewed by Ashutosh Chauhan)
+ git clean -f -d
+ git checkout master
Already on 'master'
Your branch is behind 'origin/master' by 1 commit, and can be fast-forwarded.
  (use "git pull" to update your local branch)
+ git reset --hard origin/master
HEAD is now at 9f5a3e3 HIVE-16180 : LLAP: Native memory leak in EncodedReader (Sergey Shelukhin/Prasanth Jayachandran, reviewed by Prasanth Jayachandran/Sergey Shelukhin)
+ git merge --ff-only origin/master
Already up-to-date.
+ date '+%Y-%m-%d %T.%3N'
2017-03-21 21:38:37.431
+ patchCommandPath=/data/hiveptest/working/scratch/smart-apply-patch.sh
+ patchFilePath=/data/hiveptest/working/scratch/build.patch
+ [[ -f /data/hiveptest/working/scratch/build.patch ]]
+ chmod +x /data/hiveptest/working/scratch/smart-apply-patch.sh
+ /data/hiveptest/working/scratch/smart-apply-patch.sh /data/hiveptest/working/scratch/build.patch
error: patch failed: llap-server/src/java/org/apache/hadoop/hive/llap/io/encoded/OrcEncodedDataReader.java:26
error: llap-server/src/java/org/apache/hadoop/hive/llap/io/encoded/OrcEncodedDataReader.java: patch does not apply
The patch does not appear to apply with p0, p1, or p2
+ exit 1
'
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12852928 - PreCommit-HIVE-Build, Updated to ORC 1.3.3., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12859794/HIVE-15841.patch

{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10496 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=35)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_outer_join1] (batchId=162)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_outer_join2] (batchId=162)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4275/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4275/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4275/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12859794 - PreCommit-HIVE-Build, union_fast_stats failure seems to be related. , Updated the last test case output., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12859847/HIVE-15841.patch

{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 10496 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=35)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_outer_join1] (batchId=162)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_outer_join2] (batchId=162)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4285/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4285/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4285/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12859847 - PreCommit-HIVE-Build, stats changes in minispark failures also looks related. , +1. Pending test fix and new test run., .2 patch with spark golden files update, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12860247/HIVE-15841.2.patch

{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 10511 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=35)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=141)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4330/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4330/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4330/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12860247 - PreCommit-HIVE-Build, Committed to master. , Other test failures are already happening in master., Github user omalley closed the pull request at:

    https://github.com/apache/hive/pull/142
]