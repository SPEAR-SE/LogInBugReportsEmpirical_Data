[I add cloningQueryPlanKryo.remove() in function deserializePlan so that cloningQueryPlanKryo will be reinitialized at runtime., And there is another way to avoid this bug: setting hive.plan.serialization.format=javaXML in hive-site.xml,but it's forced to use JDK 1.8 which will fail using JDK 1.7 ., Not recommended. Poor performance., [~hizero] We are also seeing such issue. I don't quite follow what causes the issue. Can you explain more in details? Thanks., OK. The issue should have been fixed by HIVE-12302 which will set the classLoader to the new thread's one., sorry for late feedback.
sounds good. have you ever tested  it?]