[https://reviews.facebook.net/D5505, +1 Nice catch Namit., In general I think we should start adopting {{OutputCommitter}} functionality provided by MR framework instead of having our own {{JobClose}} operator. Whatever logic we want to run at the end of the query (which is done via JobClose currently) can be run in {{commitJob}} of last MR job for the query. This insulates us from having to keep a live hive client around for long running queries. Secondly, we are replicating functionality which is already provided by underlying framework. Possibly, this may also help us in avoiding bugs like this one.
This definitely is not in scope of this bug, but wanted to bring this up since while fixing this issue you might have more insights into why or why not this may be a good idea., All the tests passed.

[~ashutoshc], we can can definitely discuss it in a new jira.
We dont use OutputCommitter at all right now - since we write into tmp. directories and then move the temp. dirs into the 
final dir., Cool. I created HIVE-3489, Committed, thanks Namit., Integrated in Hive-trunk-hadoop2 #54 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/54/])
    HIVE-3477. Duplicate data possible with speculative execution for dynamic partitions. (njain via kevinwilfong) (Revision 1387833)

     Result = ABORTED
kevinwilfong : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1387833
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/JoinOperator.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java
, This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]