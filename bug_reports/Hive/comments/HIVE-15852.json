[[~ashutoshc] Ashutosh, sorry it took so long to open this Jira issue. Here's a summary of what I've found so far. While it's the easiest solution, I really don't want to revert HIVE-13040, I think the performance gains can be large, especially in the blobstore (s3a or azure) case, as empty file creation is far from free.

Happy to hear suggestions, and start a conversation., Gains of not creating empty files are huge even on HDFS, I don't think we want to loose those.

We should fix tablesampling. I am not aware of Pig's assumption for bucketing. Can you describe bit more what is that assumption? Anyway, even if it has that seems like assuming something in implementation, since there is no interface contract anywhere that # of buckets = # of files., [~ashutoshc] Yeah, I think that solution makes the most sense. Even if there are some hidden dependencies in other projects, as you say, there is no interface contract and so those assumptions should not even be made. 

I will take a look into how tablesampling can be improved. Hopefully the fix is not too wide.]