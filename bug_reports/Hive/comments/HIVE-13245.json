[[~mmccline] is this known issue?, Possibly the same as the off-by-1 error in HIVE-12896 (smaller test-case in there), [~prasanth_j] No, I have not seen this before.  And, it could be what Gopal said because it is going through Native Vector MapJoin but it isn't clear if the new Fast hash table is being used (HIVE-12896) or just the regular BytesBytesMultiHashMap is being used.

Is hive.vectorized.execution.mapjoin.native.fast.hashtable.enabled ON or OFF?, Yeah. The stacktrace looks similar. Possibly the same issue., It is ON in my tests., With hive.vectorized.execution.mapjoin.native.fast.hashtable.enabled=false the query runs fine.]