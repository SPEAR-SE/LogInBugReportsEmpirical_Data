[2011-03-23 12:40:18,154 ERROR exec.MapRedTask (MapRedTask.java:execute(261)) - Execution failed with exit status: 2
2011-03-23 12:40:18,208 ERROR exec.MapRedTask (MapRedTask.java:execute(261)) - Execution failed with exit status: 2
2011-03-23 12:40:18,342 ERROR ql.Driver (SessionState.java:printError(360)) - FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask
2011-03-23 12:40:18,354 ERROR ql.Driver (SessionState.java:printError(360)) - FAILED: Hive Internal Error: java.lang.IllegalStateException(Shutdown in progress)
java.lang.IllegalStateException: Shutdown in progress
	at java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:39)
	at java.lang.Runtime.addShutdownHook(Runtime.java:192)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:1392)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:196)
	at org.apache.hadoop.fs.FileSystem.getLocal(FileSystem.java:167)
	at org.apache.hadoop.hive.ql.Context.getLocalScratchDir(Context.java:168)
	at org.apache.hadoop.hive.ql.Context.getLocalTmpFileURI(Context.java:286)
	at org.apache.hadoop.hive.ql.parse.DDLSemanticAnalyzer.analyzeInternal(DDLSemanticAnalyzer.java:223)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:238)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:344)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:817)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:151)
	at org.apache.hadoop.hive.service.ThriftHive$Processor$execute.process(ThriftHive.java:764)
	at org.apache.hadoop.hive.service.ThriftHive$Processor.process(ThriftHive.java:742)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:253)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:619)

2011-03-23 12:40:18,485 ERROR exec.MapRedTask (MapRedTask.java:execute(261)) - Execution failed with exit status: 2
, On the Context class this call seems to go wrong:
FileSystem fs = FileSystem.getLocal(conf); 

There must be something wrong with the config but what it is I don't know., It seems we are trying to add some scratchDir stuff to an instance which is shutting down. Perhaps this is an effect and not the initial cause. Still it's not nice it's shutting down the entire service because of this.]