[will take a look., Overall looks good to me.

minor comments:

1. in GroupByOp's flush,       
countAfterReport = 0; should put in the beginning of the function?
2. in AbstractMapjoin
    heartbeatInterval = HiveConf.getIntVar(hconf,
        HiveConf.ConfVars.HIVESENDHEARTBEAT);

is not needed? because the parent common join op already has that.


, I just committed. Thanks Siying!]