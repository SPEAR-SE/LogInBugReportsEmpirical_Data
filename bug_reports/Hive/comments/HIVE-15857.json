[Without the new CastStringToLong class, conversion falls to VectorUDFAdaptor.

{code}
vector.VectorExpressionDescriptor: getVectorExpressionClass udf UDFToInteger descriptor: Argument Count = 1, mode = PROJECTION, Argument Types = {STRING}, Input Expression Types = {COLUMN}
vector.VectorExpressionDescriptor: getVectorExpressionClass doesn't match CastTimestampToLong Argument Count = 1, mode = PROJECTION, Argument Types = {TIMESTAMP}, Input Expression Types = {COLUMN}
vector.VectorExpressionDescriptor: getVectorExpressionClass doesn't match CastDoubleToLong Argument Count = 1, mode = PROJECTION, Argument Types = {FLOAT_FAMILY}, Input Expression Types = {COLUMN}
vector.VectorExpressionDescriptor: getVectorExpressionClass doesn't match CastDecimalToLong Argument Count = 1, mode = PROJECTION, Argument Types = {DECIMAL}, Input Expression Types = {COLUMN}
vector.VectorizationContext: No vector udf found for UDFToInteger, descriptor: Argument Count = 1, mode = PROJECTION, Argument Types = {STRING}, Input Expression Types = {COLUMN}
vector.VectorizationContext: We will try to use the VectorUDFAdaptor for GenericUDFBridge ==> UDFToInteger (Column[tmp_values_col1]) because hive.vectorized.adaptor.usage.mode=all
{code}, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12851809/HIVE-15857.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 9 failed/errored test(s), 10242 tests executed
*Failed tests:*
{noformat}
TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_char_2] (batchId=63)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_coalesce_2] (batchId=65)
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver[encryption_join_with_different_encryption_keys] (batchId=159)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_bucket] (batchId=143)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_char_2] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_coalesce_2] (batchId=152)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=223)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3463/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3463/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3463/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12851809 - PreCommit-HIVE-Build, Relevant test failures (vector_char_2, vector_coalesce_2, vector_bucket) are all golden file EXPLAIN differences show CastStringToLong being used instead of VectorUDFAdaptor., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12854088/HIVE-15857.02.patch

{color:green}SUCCESS:{color} +1 due to 28 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 8 failed/errored test(s), 10254 tests executed
*Failed tests:*
{noformat}
TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_char_2] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_coalesce_2] (batchId=66)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=223)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vector_count_distinct] (batchId=106)
org.apache.hive.hcatalog.pig.TestHCatLoaderComplexSchema.testTupleInBagInTupleInBag[1] (batchId=173)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3717/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3717/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3717/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 8 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12854088 - PreCommit-HIVE-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12855959/HIVE-15857.03.patch

{color:red}ERROR:{color} -1 due to build exiting with an error

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3933/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3933/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3933/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Tests exited with: ExecutionException: java.util.concurrent.ExecutionException: java.io.IOException: Could not create /data/hiveptest/logs/PreCommit-HIVE-Build-3933/succeeded/28-TestCliDriver-input11_limit.q-nonreserved_keywords_input37.q-partition_char.q-and-27-more
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12855959 - PreCommit-HIVE-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12856331/HIVE-15857.04.patch

{color:green}SUCCESS:{color} +1 due to 28 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10327 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[escape_comments] (batchId=229)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vector_between_in] (batchId=119)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3971/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3971/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3971/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12856331 - PreCommit-HIVE-Build, Is it possible to have an RB without out file changes? :), +1 w/one small comment. There is some repetitive code that is handled less repetitively elsewhere in vectorization iirc (e.g. selectedInUse where it does int index = sIU ? sel[i] : i, instead of having 2 separate loops). I am assuming this is due to vectorization requirements that they are all handled separately :), [~sershe] Thank you for your review!!, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12856698/HIVE-15857.05.patch

{color:green}SUCCESS:{color} +1 due to 28 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 10332 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=147)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vector_between_in] (batchId=119)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4016/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4016/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4016/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12856698 - PreCommit-HIVE-Build, Fixup a few Q files -- no Hive QA rerun., Committed to master.]