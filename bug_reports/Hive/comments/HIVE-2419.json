[This is an annoying problem, especially for new hive users. We have fixed the problem in our internal version of hive by simply create the hive.metastore.warehouse.dir during the semantic analysis phase., Seems MoveTask.moveFile(Path, Path, boolean) throws this exception when it trying to rename the path., Instead of SemanticAnalyzer, HiveMetaStore should be the one creating WH dir when its starting up. We don't wh dir to be owned by first user happening to run query, rather WH dir should be owned by user running metastore service. 
Metastore already has a logic to create default db (if not exists) while its initializing, we need very similar logic for creating wh dir during same initialization.
 , What if /user/hive does not exist?
What if /user does not exist?

Maybe it is better to let people make the directories themselves. Or simply have a pre-flight startup check in init scripts or a java main., [~appodictic], those are valid concerns but are orthogonal to the point of this issue: address the asymmetry between {{CREATE TABLE}} and {{CREATE TABLE AS SELECT}}, where the former creates the directory but the latter does not.]