[Issue is that while merging this n-way join we copied expressions from one join tree into another without paying attention to fact that they could be in different order. There are two workarounds for it:
* Introduce any udf on join condition like cast column to string.
* Rewrite the query so that expressions are in same order in two join.

First one disables the join merge altogether, thereby avoiding buggy code-path. So, it will avoid the bug but will result in 2 jobs and thereby suboptimal performance. Second one is a better workaround since join merging will still happen, but since original order of expressions is maintained, bug doesn't kick in. , Thanks to [~rhbutani] for help in debugging this to point me to right places to look into., https://reviews.apache.org/r/26162/, +1, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12671935/HIVE-8298.patch

{color:green}SUCCESS:{color} +1 6371 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1051/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1051/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1051/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12671935, Committed to trunk. [~vikram.dixit] It will be good to have this in 0.14 as well., +1 for 0.14., Committed to 0.14, This has been fixed in 0.14 release. Please open new jira if you see any issues.
]