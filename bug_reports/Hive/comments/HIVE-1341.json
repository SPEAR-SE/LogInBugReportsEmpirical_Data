[HIVE-1341.patch fixes both 1340 & 1341. , +1

will commit if tests pass, Committed. Thanks Ning]