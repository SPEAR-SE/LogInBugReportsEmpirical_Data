[looks good. +1, can you add a testcase?, not sure how to add test case without minimr setup (need a real dfs instance - i think right now we are using file:// for fs), yeah, it wouldn't work. so we should commit this patch then.]