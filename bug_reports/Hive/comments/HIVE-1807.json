[can you add a unit test? otherwise it looks good., a new patch addressed Ning's comments, +1. started testing., Committed. Thanks Yongqiang!]