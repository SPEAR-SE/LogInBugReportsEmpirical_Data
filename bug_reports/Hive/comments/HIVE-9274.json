[Looks like this behavior has changed due to HIVE-6584. In DDLTask the input and output format classes are only persisted when explicitly specified. I wonder if the documentation in https://cwiki.apache.org/confluence/display/Hive/StorageHandlers should be updated (under open issues: "Names of helper classes such as input format and output format are saved into the metastore based on what the storage handler returns during CREATE TABLE; it would be better to leave these null in case they are changed later as part of a handler upgrade").]