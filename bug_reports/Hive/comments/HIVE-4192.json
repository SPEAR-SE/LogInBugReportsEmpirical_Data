[Yes in our implementation we disallow Window Frames on rank, dense_rank, cume_dist, percent_rank, lead and lag. Didn't make sense to allow a Window Frame on these. This is documented in Jira 4197. Should be fixed/resolved by Jira 4197., I agree with Harish. Semantically, it does look weird to define window frame for lead. Similarly for rank. Alan, do you think we should still support this?, This seems to be in line with the way postgres handles it, as they ignore the window frame when working with these functions.  So it seems fine., I see. We can possibly do the same, ie silently drop the window frame if specified. But to me throwing exception is better. Consider user says
{noformat}
select i, lead(s) over (partition by bin order by d desc rows between current row and 10 following) from over100k;
{noformat}
and than expect he will get difference between current row and 10th row following current one for lead (s) column. This is illegal, but since we are silently dropping window frame we won't notice this and return results to him, which will be different than his expectations. Throwing exception at compile time (ie current behavior) seems best alternative for such scenarios., I agree throwing exception at compile time is better than silently dropping the window frame.]