[Since Hadoop classpath is not setting correctly in build-common.xml "test" target, even currently we did not add avro jars into hive execution classpath, it is still running OK.

While, we may get class def not found error, if not putting avro jars into the hive mapreduce job execution classpath:

Caused by: java.lang.ClassNotFoundException: org.apache.avro.io.DatumReader, review request submitted:
https://reviews.facebook.net/D4209, I can see this happening but when exactly do we get this error?, @Edward:

I found this error when I am backporting HIVE-895 to an old version of Hive(CDH3), where I did not put avro jars into hive execution classpath, and kept having the following exception:

java.lang.ClassNotFoundException: org.apache.avro.io.DatumReader

We do not have this error on current trunk, since Hadoop classpath is not setting correctly in build-common.xml "test" target. I think this should be fixed in HIVE-3274.

I think fixing this would emphasis that it is not enough to put avro jars in the hive client classpath. Avro jars should be put in hive execution(the mapreduce job) classpath. This would prevent future bugs.

What do you think about it?

Thanks,
Zhenxiao, +1. Will commit if tests pass., Committed to trunk. Thanks Zhenxiao!, Integrated in Hive-trunk-h0.21 #1581 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1581/])
    HIVE-3273 [jira] Add avro jars into hive execution classpath
(Zhenxiao Luo via Carl Steinbach)

Summary:
HIVE-3273: Add avro jars into hive execution classpath

avro*.jar should be added to hive execution classpath

Test Plan: EMPTY

Reviewers: JIRA, cwsteinbach

Reviewed By: cwsteinbach

Differential Revision: https://reviews.facebook.net/D4209 (Revision 1367708)

     Result = SUCCESS
cws : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1367708
Files : 
* /hive/trunk/ql/build.xml
, Integrated in Hive-trunk-hadoop2 #54 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/54/])
    HIVE-3273 [jira] Add avro jars into hive execution classpath
(Zhenxiao Luo via Carl Steinbach)

Summary:
HIVE-3273: Add avro jars into hive execution classpath

avro*.jar should be added to hive execution classpath

Test Plan: EMPTY

Reviewers: JIRA, cwsteinbach

Reviewed By: cwsteinbach

Differential Revision: https://reviews.facebook.net/D4209 (Revision 1367708)

     Result = ABORTED
cws : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1367708
Files : 
* /hive/trunk/ql/build.xml
, This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]