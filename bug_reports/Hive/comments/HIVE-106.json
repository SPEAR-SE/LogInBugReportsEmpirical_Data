[https://issues.apache.org/jira/browse/HIVE-113 might fix this - i remember we were using MetadataTypedColumnSetSerDe to serialize/deserialize data across map-reduce boundary, until sort by and distribute by is done.
, Josh, can you provide the data files for the tables activities and users which was failing, Josh, this problem should have been fixed - can you provide a testcase ? otherwise, i will close this issue]