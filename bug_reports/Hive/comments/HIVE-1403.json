[this patch report progress periodically during closing all the files. , +1

looks good - will commit if the tests pass, Committed. Thanks Ning, The previous patch doesn't seem to be complete.
This patch will cover the timeout case under multiple directories., Siying, the new patch looks good in general, but can you open a different JIRA and upload your patch to that?]