[use local buffer instead of static, This is not committed yet. Reopening for review.]