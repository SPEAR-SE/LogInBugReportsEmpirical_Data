[navis requested code review of "HIVE-4932 [jira] PTFOperator fails resetting PTFPersistence".

Reviewers: JIRA

HIVE-4932 PTFOperator fails resetting PTFPersistence

From mailing list http://www.mail-archive.com/user@hive.apache.org/msg08811.html,

PTFOperator fails with stack trace like this.

Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Reset on PersistentByteBasedList not supported
	at org.apache.hadoop.hive.ql.exec.PTFPersistence$PersistentByteBasedList.reset(PTFPersistence.java:895)
	at org.apache.hadoop.hive.ql.exec.PTFPersistence$PartitionedByteBasedList.reset(PTFPersistence.java:456)
	at org.apache.hadoop.hive.ql.exec.PTFPartition.reset(PTFPartition.java:67)
	at org.apache.hadoop.hive.ql.exec.PTFOperator.processOp(PTFOperator.java:132)
	at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:504)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:848)
	at org.apache.hadoop.hive.ql.exec.ExtractOperator.processOp(ExtractOperator.java:45)
	at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:504)
	at org.apache.hadoop.hive.ql.exec.mr.ExecReducer.reduce(ExecReducer.java:249)
	... 7 more

TEST PLAN
  EMPTY

REVISION DETAIL
  https://reviews.facebook.net/D11823

AFFECTED FILES
  ql/src/java/org/apache/hadoop/hive/ql/exec/PTFPersistence.java
  ql/src/test/queries/clientpositive/ptf_reuse_memstore.q
  ql/src/test/results/clientpositive/ptf_reuse_memstore.q.out

MANAGE HERALD RULES
  https://reviews.facebook.net/herald/view/differential/

WHY DID I GET THIS EMAIL?
  https://reviews.facebook.net/herald/transcript/28077/

To: JIRA, navis
, I will look later tonight., I tested the patch and it resolved the problem for my use case (which used to reliably fail before)., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12594135/HIVE-4932.D11823.1.patch

{color:green}SUCCESS:{color} +1 2652 tests passed

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/186/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/186/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.CleanupPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated., +1, Thanks Navis. Your a force., This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.]