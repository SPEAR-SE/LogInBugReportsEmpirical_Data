[Fixed BFS implementation., cc: [~ashitg], [~pattipaka], +1, pending tests, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12855555/HIVE-16086.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 12 failed/errored test(s), 10283 tests executed
*Failed tests:*
{noformat}
TestCommandProcessorFactory - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestDbTxnManager - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestDummyTxnManager - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestHiveInputSplitComparator - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestIndexType - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
TestSplitFilter - did not produce a TEST-*.xml file (likely timed out) (batchId=272)
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[escape_comments] (batchId=229)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=140)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=224)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=224)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vector_between_in] (batchId=119)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3888/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3888/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3888/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 12 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12855555 - PreCommit-HIVE-Build, Thanks [~kiran.kolli] for the patch. Can you please add a test case too? There are some tests in {{TestHiveMetastoreChecker}} which you may want to take a look., [~vihangk1] sure will add a test., [~vihangk1] Real validation for this is to assert the #call to fs.listStatus. This require mocking FS. 

From the test code I see that only Predefined FS's are loaded. Do you know if there is a way to inject mock FS? Other possibility is to use reflection and access private method directly. Do we allow reflection in UTs?, [~kiran.kolli] https://github.com/apache/hive/blob/branch-2.1/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestInputOutputFormat.java#L1142-L1159

has a mock FS and list status. It also has some tests that look up for statistics so that you can know the number of invocations., [~prasanth_j] ORC tests are testing files directly so it can play with mock objects directly. In-case of 'TetHiveMetastoreChecker' its entry point is 'HiveMetaStoreChecker.checkMetastore' which doesn't give that flexibility. , Hi [~kiran.kolli] I thought initially that this is a bug which leads to incorrect behavior. But after looking at the patch carefully this looks like a improvement to the singleThreaded implementation. Please correct me if I am wrong but if not, can you change the JIRA type to Improvement. I thought this results in some incorrect behavior which would have been easy to replicate in a test case.

In such a case I think it is okay to skip test case since [~prasanth_j] has already given a +1. , [~vihangk1] its yes and no. Yes from enumeration perspective but No from the end result perspective. FindUnknownPartition returns Set which de-dupes them so end-result is same. With-out this fix, enumeration will do waster work exponentially but not the end-result. 

, [~prasanth_j] As commented earlier this change is an optimization and no functional impact. Could you please commit the patch. , Test failures are unrelated and are happening in other jiras as well.
Committed patch to master. Thanks Kiran for the contribution!]