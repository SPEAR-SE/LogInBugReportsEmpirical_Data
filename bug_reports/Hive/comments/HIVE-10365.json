[Not a code issue. It works after increasing the thread stack size., I happened to see this in a spark-executor during a query as well.  Just leaving a note in case someone else hits this.

The solution is to set spark.executor.extraJavaOptions to a sufficiently high -Xss value.]