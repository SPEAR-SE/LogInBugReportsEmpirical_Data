[hbutani requested code review of "HIVE-4130 [jira] Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs".

Reviewers: JIRA, ashutoshc

support default vals for Lead/Lag UDFs

support a default value arg
	both amt and defaultValue args can be optional

TEST PLAN
  existing tests

REVISION DETAIL
  https://reviews.facebook.net/D10233

AFFECTED FILES
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java
  ql/src/test/queries/clientpositive/windowing_expressions.q
  ql/src/test/results/clientpositive/windowing_expressions.q.out

MANAGE HERALD RULES
  https://reviews.facebook.net/herald/view/differential/

WHY DID I GET THIS EMAIL?
  https://reviews.facebook.net/herald/transcript/24459/

To: JIRA, ashutoshc, hbutani
, ashutoshc has requested changes to the revision "HIVE-4130 [jira] Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs".

  Mostly looks good. Some comments.

INLINE COMMENTS
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java:60 This catch block is no longer required I think. Now that we ascertain arguments.length > 1 there cant be NPE here.
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java:66 Bit confused here. In case of this exception, isnt it better to just throw exception, instead of setting amt to max. What do you think?
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java:113 This can be removed. We have same code down below.

REVISION DETAIL
  https://reviews.facebook.net/D10233

BRANCH
  HIVE-4130

ARCANIST PROJECT
  hive

To: JIRA, ashutoshc, hbutani
, hbutani updated the revision "HIVE-4130 [jira] Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs".

    - amt param should be a constant int

Reviewers: ashutoshc, JIRA

REVISION DETAIL
  https://reviews.facebook.net/D10233

CHANGE SINCE LAST DIFF
  https://reviews.facebook.net/D10233?vs=31995&id=32109#toc

AFFECTED FILES
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java
  ql/src/test/queries/clientpositive/windowing_expressions.q
  ql/src/test/results/clientpositive/windowing_expressions.q.out

To: JIRA, ashutoshc, hbutani
, ashutoshc has requested changes to the revision "HIVE-4130 [jira] Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs".

  Couple more comments.

INLINE COMMENTS
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java:98 Shouldn't the default value of amt be 1 ?
  ql/src/test/queries/clientpositive/windowing_expressions.q:38 It will be good to add a testcase which exercises non-default values like sum(lag(p_retailprice,3,29.43))

REVISION DETAIL
  https://reviews.facebook.net/D10233

BRANCH
  HIVE-4130

ARCANIST PROJECT
  hive

To: JIRA, ashutoshc, hbutani
, [~rhbutani] There are few minor comments on this jira. If you have time and can take a look at it that will be great. It wil be good to include this in 0.11, hbutani updated the revision "HIVE-4130 [jira] Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs".

  set default amt to 1; add test for default value

Reviewers: ashutoshc, JIRA

REVISION DETAIL
  https://reviews.facebook.net/D10233

CHANGE SINCE LAST DIFF
  https://reviews.facebook.net/D10233?vs=32109&id=32535#toc

AFFECTED FILES
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java
  ql/src/test/queries/clientpositive/windowing_expressions.q
  ql/src/test/results/clientpositive/windowing_expressions.q.out

To: JIRA, ashutoshc, hbutani
, ashutoshc has accepted the revision "HIVE-4130 [jira] Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs".

  +1 will  commit if  tests pass

REVISION DETAIL
  https://reviews.facebook.net/D10233

BRANCH
  HIVE-4130

ARCANIST PROJECT
  hive

To: JIRA, ashutoshc, hbutani
, Committed to trunk. Thanks, Harish!, Integrated in Hive-trunk-hadoop2 #169 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/169/])
    HIVE-4130 : Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs (Harish Butani via Ashutosh Chauhan) (Revision 1470312)

     Result = ABORTED
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1470312
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java
* /hive/trunk/ql/src/test/queries/clientpositive/windowing_expressions.q
* /hive/trunk/ql/src/test/results/clientpositive/windowing_expressions.q.out
, Integrated in Hive-trunk-h0.21 #2074 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2074/])
    HIVE-4130 : Bring the Lead/Lag UDFs interface in line with Lead/Lag UDAFs (Harish Butani via Ashutosh Chauhan) (Revision 1470312)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1470312
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFLeadLag.java
* /hive/trunk/ql/src/test/queries/clientpositive/windowing_expressions.q
* /hive/trunk/ql/src/test/results/clientpositive/windowing_expressions.q.out
]