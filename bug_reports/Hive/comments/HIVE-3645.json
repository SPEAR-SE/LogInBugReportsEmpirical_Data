[
Looking at PIG-2791 looks like the following needs to be done:

1. Use getDefaultBlockSize(Path) and getDefaultReplication(Path) instead of getDefaultBlockSize() and getDefaultReplication(). As the ones without Path argument wont work in case of federated namenode. These methods need to 
be shimmed.
 
2. Bump hadoop dependency to 2.0.0-alpha as  getDefaultBlockSize(Path)/getDefaultReplication(Path) are  not available in 0.23.1
, Review for trunk: https://reviews.facebook.net/D6765, Review for branch: https://reviews.facebook.net/D6813, Thanks, Arup. I have run the test from the original description using the jars you gave me with attached patch applied, and the test passed. , +1 will commit if tests pass., Committed to trunk. Thanks, Arup!, Thanks Ashutosh for looking into the patch. If the branch patch looks fine can you please commit this to 0.9 branch as well?, Integrated in Hive-trunk-h0.21 #1821 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1821/])
    HIVE-3645 : RCFileWriter does not implement the right function to support Federation (Arup Malakar via Ashutosh Chauhan) (Revision 1414286)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1414286
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java
* /hive/trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
* /hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
* /hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
* /hive/trunk/shims/src/common-secure/java/org/apache/hadoop/hive/shims/HadoopShimsSecure.java
* /hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java
, Committed to 0.9 branch., Thank you Ashutosh., Integrated in Hive-0.9.1-SNAPSHOT-h0.21-keepgoing=false #219 (See [https://builds.apache.org/job/Hive-0.9.1-SNAPSHOT-h0.21-keepgoing=false/219/])
    HIVE-3645 : RCFileWriter does not implement the right function to support Federation (Arup Malakar via Ashutosh Chauhan) (Revision 1417220)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1417220
Files : 
* /hive/branches/branch-0.9/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java
* /hive/branches/branch-0.9/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
* /hive/branches/branch-0.9/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
* /hive/branches/branch-0.9/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
* /hive/branches/branch-0.9/shims/src/common-secure/java/org/apache/hadoop/hive/shims/HadoopShimsSecure.java
* /hive/branches/branch-0.9/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java
, Integrated in Hive-0.9.1-SNAPSHOT-h0.21 #219 (See [https://builds.apache.org/job/Hive-0.9.1-SNAPSHOT-h0.21/219/])
    HIVE-3645 : RCFileWriter does not implement the right function to support Federation (Arup Malakar via Ashutosh Chauhan) (Revision 1417220)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1417220
Files : 
* /hive/branches/branch-0.9/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java
* /hive/branches/branch-0.9/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
* /hive/branches/branch-0.9/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
* /hive/branches/branch-0.9/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
* /hive/branches/branch-0.9/shims/src/common-secure/java/org/apache/hadoop/hive/shims/HadoopShimsSecure.java
* /hive/branches/branch-0.9/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java
, I am getting the following compilation errors with this patch on branch-0.9:

{code}
ivy-retrieve-hadoop-shim:
     [echo] Project: shims
    [javac] Compiling 1 source file to /wd/hive/build/shims/classes
    [javac] /wd/hive/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java:118: error: method getDefaultBlockSize in class FileSystem cannot be applied to given types;
    [javac]     return fs.getDefaultBlockSize(path);
    [javac]              ^
    [javac]   required: no arguments
    [javac]   found: Path
    [javac]   reason: actual and formal argument lists differ in length
    [javac] /wd/hive/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java:123: error: method getDefaultReplication in class FileSystem cannot be applied to given types;
    [javac]     return fs.getDefaultReplication(path);
    [javac]              ^
    [javac]   required: no arguments
    [javac]   found: Path
    [javac]   reason: actual and formal argument lists differ in length
    [javac] 2 errors

BUILD FAILED
/wd/hive/build.xml:319: The following error occurred while executing this line:
/wd/hive/build.xml:169: The following error occurred while executing this line:
/wd/hive/shims/build.xml:90: The following error occurred while executing this line:
/wd/hive/shims/build.xml:93: The following error occurred while executing this line:
/wd/hive/shims/build.xml:82: Compile failed; see the compiler error output for details.
{code}

I am building with the default Hadoop version., From: https://issues.apache.org/jira/browse/HIVE-3754?focusedCommentId=13506596&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13506596
You can use either of
{code}
ant clean package -Dhadoop.version=0.23.3 -Dhadoop-0.23.version=0.23.3 -Dhadoop.mr.rev=23
ant clean package -Dhadoop.version=2.0.0-alpha -Dhadoop-0.23.version=2.0.0-alpha -Dhadoop.mr.rev=23
{code}

See HIVE-3754 for more details.

I also see that default hadoop 23 version is 0.23.3 for branch-0.9 as well, so this should have worked without the arguments:
{code}
hadoop-0.23.version=0.23.3
{code}, Integrated in Hive-trunk-hadoop2 #54 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/54/])
    HIVE-3645 : RCFileWriter does not implement the right function to support Federation (Arup Malakar via Ashutosh Chauhan) (Revision 1414286)

     Result = ABORTED
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1414286
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java
* /hive/trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
* /hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
* /hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
* /hive/trunk/shims/src/common-secure/java/org/apache/hadoop/hive/shims/HadoopShimsSecure.java
* /hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java
]