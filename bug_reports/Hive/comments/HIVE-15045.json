[Oracle which uses slightly different syntax allows both variants:
{code}
select empno, deptno, count(distinct empno) from scott.emp group by grouping sets (empno, deptno);
select empno, deptno, count(distinct empno) from scott.emp group by cube (empno, deptno);
{code}, [~jcamachorodriguez] I am assuming this wont be covered by HIVE-16102 as this needs support for distinct in grouping set (groupby) runtime operator which isn't there yet., [~ashutoshc], it will not. However, I have been checking the rule to expand distinct into grouping sets, and I guess it could be extended to cover this case, although the rewriting would be more complex. The Calcite equivalent rule has additional logic that is not in the Hive rule, maybe it is also worthy taking a look at that.]