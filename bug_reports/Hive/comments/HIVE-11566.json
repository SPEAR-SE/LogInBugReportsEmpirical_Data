[HIVE-11587 contains this improvement.]