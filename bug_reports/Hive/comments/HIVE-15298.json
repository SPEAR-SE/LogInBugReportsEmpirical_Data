[I couldn't reproduce it locally, but at first glance this seems like an ordering issue.
I added an order by to sample2.q to see if this fixes anything., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12841298/HIVE-15298.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 9 failed/errored test(s), 10738 tests executed
*Failed tests:*
{noformat}
TestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=103)
	[skewjoinopt3.q,smb_mapjoin_4.q,timestamp_comparison.q,union_remove_10.q,mapreduce2.q,bucketmapjoin_negative.q,udf_in_file.q,auto_join12.q,skewjoin.q,vector_left_outer_join.q,semijoin.q,skewjoinopt9.q,smb_mapjoin_3.q,stats10.q,nullgroup4.q]
org.apache.hadoop.hive.cli.TestCliDriver.org.apache.hadoop.hive.cli.TestCliDriver (batchId=50)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=134)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample2] (batchId=96)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/2361/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/2361/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-2361/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12841298 - PreCommit-HIVE-Build, Something is wrong with the test report. Between these two consecutive runs:
https://builds.apache.org/job/PreCommit-HIVE-Build/2360/testReport/
https://builds.apache.org/job/PreCommit-HIVE-Build/2361/testReport/
The age of the test failure for sample 2 went from 20 to 1. There should be a build where this test succeeded., Can you find out which jira could cause the test failures?  , Unfortunately no.
I think the failures are caused by select statements with no guaranteed orderings (hence my approach to add order by to the select clauses). My change would only make the tests deterministic, but I don't know why they started failing so consistently now., Reuploading the same patch as the precommit tests didn't run for the second iteration., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12841753/HIVE-15298.2.patch

{color:green}SUCCESS:{color} +1 due to 4 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 14 failed/errored test(s), 10762 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.org.apache.hadoop.hive.cli.TestCliDriver (batchId=50)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_schema_evol_3a] (batchId=134)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=134)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample2] (batchId=96)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample6] (batchId=121)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample7] (batchId=121)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample9] (batchId=111)
org.apache.hive.hcatalog.pig.TestHCatLoaderComplexSchema.testSyntheticComplexSchema[2] (batchId=171)
org.apache.hive.hcatalog.pig.TestHCatLoaderComplexSchema.testSyntheticComplexSchema[3] (batchId=171)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/2414/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/2414/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-2414/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 14 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12841753 - PreCommit-HIVE-Build, Cancelling the patch to investigate failures., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12842333/HIVE-15298.3.patch

{color:green}SUCCESS:{color} +1 due to 5 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 9 failed/errored test(s), 10767 tests executed
*Failed tests:*
{noformat}
TestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=98)
	[skewjoinopt15.q,auto_join18.q,list_bucket_dml_2.q,input1_limit.q,load_dyn_part3.q,union_remove_14.q,auto_sortmerge_join_14.q,auto_sortmerge_join_15.q,union10.q,bucket_map_join_tez2.q,groupby5_map_skew.q,join_reorder.q,sample1.q,bucketmapjoin8.q,union34.q]
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=134)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=92)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample2] (batchId=96)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample4] (batchId=100)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample6] (batchId=121)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample7] (batchId=121)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample9] (batchId=111)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/2488/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/2488/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-2488/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12842333 - PreCommit-HIVE-Build, Forgot to update the spark q out files, but the CLIDriver failures are fixed now. I will regenerate the spark q out files as well., Regenerated qout files for spark., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12842385/HIVE-15298.4.patch

{color:green}SUCCESS:{color} +1 due to 5 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 10754 tests executed
*Failed tests:*
{noformat}
TestMiniLlapLocalCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=143)
	[vectorized_rcfile_columnar.q,vector_elt.q,explainuser_1.q,multi_insert.q,tez_dml.q,vector_bround.q,schema_evol_orc_acid_table.q,vector_when_case_null.q,orc_ppd_schema_evol_1b.q,vector_join30.q,vectorization_11.q,cte_3.q,update_tmp_table.q,vector_decimal_cast.q,groupby_grouping_id2.q,vector_decimal_round.q,tez_smb_empty.q,orc_merge6.q,vector_decimal_trailing.q,cte_5.q,tez_union.q,cbo_rp_subq_not_in.q,vector_decimal_2.q,columnStatsUpdateForStatsOptimizer_1.q,vector_outer_join3.q,schema_evol_text_vec_part_all_complex.q,tez_dynpart_hashjoin_2.q,auto_sortmerge_join_12.q,offset_limit.q,tez_union_multiinsert.q]
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_sortmerge_join_2] (batchId=44)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=134)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_based_fetch_decision] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_5] (batchId=91)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/2497/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/2497/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-2497/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12842385 - PreCommit-HIVE-Build, +1, Thanks Barna for the work and Jason for reviewing. Pushed to master.]