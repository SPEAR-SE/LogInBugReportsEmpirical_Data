[can you add a test where there is no map-side aggregate and there is a count distinct? this case will be useful when the cardinality of the distinct column is very high and the data is not partitioned on the distinct column., added more tests, +1 

looks good. Will commit if the tests pass., Committed to trunk and back-ported to 0.3. Thanks Namit! ]