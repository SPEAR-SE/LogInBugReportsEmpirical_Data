[I think the bug is with usage of Object.equals for the comparison.  Doing a toString on both sides first seems like a reasonable fix given the current spec for the function, or we could do whatever Paul did for IN.
, Fix UDF field(), will take a look., discussed with Siying offline.
1. use ObjectInspectUtils.compare
2. add more test, the first argument can also be a column
3. add a negative test for complex types., use ObjectInspector.compare() and add some test cases., I just committed. Thanks Siying!]