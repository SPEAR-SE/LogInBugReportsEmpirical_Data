[[https://reviews.apache.org/r/39741/|https://reviews.apache.org/r/39741/], [~vgumashta] fix for the retry logic, can you take a look when you get a chance?  Thanks, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12769437/HIVE-12280.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 9733 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver_hbase_queries
org.apache.hadoop.hive.hwi.TestHWISessionManager.testHiveDriver
org.apache.hive.jdbc.TestSSL.testSSLVersion
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5850/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5850/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5850/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12769437 - PreCommit-HIVE-TRUNK-Build, Minor update to improve the test., [~thejas] [~jxiang] can one of you help take a look?, With the patch, a random HS2 will be used even if the HS2 is specified in the URL properties. For the test, it should be ok if the property object is not re-used, right?, I might be mistaken as I'm not the original author, but from my understanding the host/port is not parsed from URL during the service-discovery mode (looked at callstack of JdbcConnectionParams.setHost() and setPort()).

The second comment, I assume you mean to make a new property map?  Yea I can do that., Chatted with Szehon. +1. At least, in discovery mode, all connection related properties should be from the ZK to be consistent., Thanks for the review., +1 . Thanks for adding the test, thats very valuable!
Yes, host/port of HS2 should not be specified in jdbc url, if zookeeper service discovery mode is being used.
, Committed to master, thanks all for review., [~szehon] Thanks for identifying and fixing this. I think we should get this in branch-1 as well., Makes sense, I will backport, Backported to branch-1, Does this need to be documented in the wiki?

* [HiveServer2 Clients | https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients], [~leftylev] This fixes a bug that was introduced in an unreleased version. So no doc update is needed.
, Okay, thanks Thejas.]