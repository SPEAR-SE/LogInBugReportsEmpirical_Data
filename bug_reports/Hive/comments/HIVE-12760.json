[[~mingren], could you checkout the latest version of Hive on master? I got the following result when i tried to reproduce your problem:
{code}
1	2
2	2
{code}, Thanks for reply! I have tried to test on the lastest version which did work right. 

Is there a way to make a patch for Hive 1.2.1 version,because upgrading code can't be easily done., Thanks for reply! I have tried to test on the lastest version which did work right. 

Is there a way to make a patch for Hive 1.2.1 version,because upgrading code can't be easily done., Thanks for reply! I have tried to test on the lastest version which did work right. 

Is there a way to make a patch for Hive 1.2.1 version,because upgrading code can't be easily done., Thanks for reply! I have tried to test on the lastest version which did work right. 

Is there a way to make a patch for Hive 1.2.1 version,because upgrading code can't be easily done., Thanks for reply! I have tried to test on the lastest version which did work right. 

Is there a way to make a patch for Hive 1.2.1 version,because upgrading code can't be easily done., Thanks for reply! I have tried to test on the latest version which did work right. 

Is there a way to make a patch for Hive 1.2.1 version,because upgrading code can't be easily done., Sorry for repeated comments cause of bad network, [~mingren] if you like, you can do a bisect on git and find out the exact patch. Let me know if you need any help. Thanks., Thanks,I'll try, I have done the work as you've said. I found commit 4a0784a50316beae970d74a062014dec44a0dd0f works fine.

still I can't find out the exact patch! there are too many differences between current code and Hive 1.2.1 release code]