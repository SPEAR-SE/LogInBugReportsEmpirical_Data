[NO PRECOMMIT TESTS

Adding the missed code and unit test for the same., Patch 2 cleans up the imports.

+[~brocknoland] can you review this?, +1 thx!, Committed to trunk, thanks for review.]