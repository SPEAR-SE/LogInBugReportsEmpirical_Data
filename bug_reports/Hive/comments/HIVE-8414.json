[Attached preliminary fix. Will add unittest to exercise., [~cdrome] The current patch looks good - thanks for catching this. Let me know whenever you think it's ready for review.]