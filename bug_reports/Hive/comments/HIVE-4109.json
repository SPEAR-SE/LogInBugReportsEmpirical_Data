[[~rhbutani] Yeah.. I wasn't sure either about legality of such queries. Thats why I tried it on postgres. Amazingly, they succeeded on postgres. Need to dig more into it., this should be fixed with 4197, First query works. Added test case in the patch and verified results against pg. Second doesn't because of multiple sort columns without a window frame restriction. Though a close variant of that does work. Added it as testcase., +1, Committed to branch. ]