[[~aihuaxu] Could you help me review this patch?, [~szehon] [~dongc] [~Ferd] Could you help me review this code?, +1 makes sense from my end., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12748010/HIVE-11401.1.patch

{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 9278 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.ql.io.parquet.TestParquetRecordReaderWrapper.testBuilder
org.apache.hadoop.hive.ql.io.parquet.TestParquetRecordReaderWrapper.testBuilderComplexTypes
org.apache.hadoop.hive.ql.io.parquet.TestParquetRecordReaderWrapper.testBuilderComplexTypes2
org.apache.hadoop.hive.ql.io.parquet.TestParquetRecordReaderWrapper.testBuilderFloat
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression1
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression10
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression2
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression3
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression4
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression5
org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg.testExpression7
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4764/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4764/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4764/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 11 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12748010 - PreCommit-HIVE-TRUNK-Build, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12748071/HIVE-11401.2.patch

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 9277 tests executed
*Failed tests:*
{noformat}
TestCustomAuthentication - did not produce a TEST-*.xml file
org.apache.hadoop.hive.ql.exec.tez.TestDynamicPartitionPruner.testMultipleSourcesOrdering1
org.apache.hadoop.hive.ql.exec.tez.TestDynamicPartitionPruner.testMultipleSourcesOrdering2
org.apache.hadoop.hive.ql.exec.tez.TestDynamicPartitionPruner.testSingleSourceMultipleFiltersOrdering1
org.apache.hadoop.hive.ql.exec.tez.TestDynamicPartitionPruner.testSingleSourceMultipleFiltersOrdering2
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4768/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4768/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4768/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12748071 - PreCommit-HIVE-TRUNK-Build, The tests are not related with this patch. I run them in my local system, and they're working correct., Thanks [~szehon] for the review.]