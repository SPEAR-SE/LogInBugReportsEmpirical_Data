[This is going to be merged to HIVE-2042]