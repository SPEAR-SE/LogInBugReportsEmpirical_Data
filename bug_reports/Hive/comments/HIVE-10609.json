[This doesn't fail on my combined build of HIVE-9743 and HIVE-10565.  Will verify again when those JIRAs go in., Removing fix version of 1.2.0 in preparation of release, since this is not a blocker for 1.2.0., [~sushanth]

This fix is needed to keep queries from crashing.
Please include in 1.2.0, Given that we've already begun the RC process, no new features or bugfixes are to be requested unless they are release blockers. Release blockers can only be either an outages or regressions.

Per my understanding, this matches neither, since:

a) Outage : Vectorization is an optional feature in hive and not turned on by default - thus, it does not break regular operation.
b) Regression : Again, vectorization being new, it should not be considered a regression.

I think this can be included for 1.2.1, which is intended to be a stabilization update on 1.2.0, but probably not for 1.2.0. 

Thoughts? If my reasoning for why this does not make the bar is incorrect, please do let me know(preferrably by replying to the VOTE thread on hive-dev asking for a deferral of the RC), and we can discuss whether or not this merits holding up the release process. Also, for any other release blockers, please mark the release status page ( https://cwiki.apache.org/confluence/display/Hive/Hive+1.2+Release+Status ) to request inclusions - that way, they are more visible., Per discussion with Mostafa, I'll add this to the tentative list for 1.2 - i.e., it will not be considered a release blocker for 1.2.0, but if it gets done before the RC process ends, we will include it in the next RC being built, and include it for 1.2.0. Otherwise, it will make it in a stabilization 1.2.1 release.

I'll update the fix version of this bug with the appropriate version at that time., 
Struggling to get a repro.

From the stack trace, it is the non-native Vector Map Join under Tez.

With these options, I get no failure.

{noformat}
SET hive.vectorized.execution.enabled=true;
set hive.mapjoin.hybridgrace.hashtable=false;
SET hive.vectorized.execution.mapjoin.native.enabled=false;
set hive.cbo.enable=true;
set hive.fetch.task.conversion=none;
SET hive.auto.convert.join=true;
SET hive.auto.convert.join.noconditionaltask=true;
SET hive.auto.convert.join.noconditionaltask.size=1000000000;
set hive.exec.dynamic.partition.mode=nonstrict;
{noformat}

Here is the EXPLAIN output:
{noformat}
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Map 11 <- Map 14 (BROADCAST_EDGE), Map 15 (BROADCAST_EDGE), Map 16 (BROADCAST_EDGE), Map 17 (BROADCAST_EDGE), Map 18 (BROADCAST_EDGE), Map 19 (BROADCAST_EDGE), Map 20 (BROADCAST_EDGE), Map 21 (BROADCAST_EDGE), Map 22 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Map 23 <- Map 25 (BROADCAST_EDGE)
        Map 27 <- Map 26 (BROADCAST_EDGE), Map 28 (BROADCAST_EDGE), Map 29 (BROADCAST_EDGE), Map 30 (BROADCAST_EDGE), Map 31 (BROADCAST_EDGE), Map 32 (BROADCAST_EDGE)
        Map 33 <- Map 27 (BROADCAST_EDGE), Map 35 (BROADCAST_EDGE), Map 36 (BROADCAST_EDGE), Map 37 (BROADCAST_EDGE), Map 38 (BROADCAST_EDGE), Map 39 (BROADCAST_EDGE), Map 40 (BROADCAST_EDGE), Map 41 (BROADCAST_EDGE), Map 42 (BROADCAST_EDGE), Map 43 (BROADCAST_EDGE), Reducer 24 (BROADCAST_EDGE)
        Map 5 <- Map 10 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 12 <- Map 11 (SIMPLE_EDGE), Reducer 34 (BROADCAST_EDGE)
        Reducer 13 <- Reducer 12 (SIMPLE_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
        Reducer 24 <- Map 23 (SIMPLE_EDGE)
        Reducer 34 <- Map 33 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  Statistics: Num rows: 1441548 Data size: 2515527468 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (cs_item_sk is not null and cs_order_number is not null) (type: boolean)
                    Statistics: Num rows: 360387 Data size: 628881867 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 cs_item_sk (type: int), cs_order_number (type: int)
                        1 cr_item_sk (type: int), cr_order_number (type: int)
                      outputColumnNames: _col14, _col24, _col60, _col61, _col62
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 396425 Data size: 691770068 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col24), sum(((_col60 + _col61) + _col62))
                        keys: _col14 (type: int)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 396425 Data size: 691770068 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 396425 Data size: 691770068 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(19,2))
            Execution mode: vectorized
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 12 Data size: 25632 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((s_store_sk is not null and s_store_name is not null) and s_zip is not null) (type: boolean)
                    Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: s_store_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: s_store_sk (type: int)
                      Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                      value expressions: s_store_name (type: string), s_zip (type: string)
                    Select Operator
                      expressions: s_store_sk (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        keys: _col0 (type: int)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                        Dynamic Partitioning Event Operator
                          Target Input: store_sales
                          Partition key expr: ss_store_sk
                          Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                          Target column: ss_store_sk
                          Target Vertex: Map 4
            Execution mode: vectorized
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: cd1
                  Statistics: Num rows: 1920800 Data size: 538778449 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: cd_demo_sk is not null (type: boolean)
                    Statistics: Num rows: 960400 Data size: 269389224 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: int)
                        1 cd_demo_sk (type: int)
                      outputColumnNames: _col2, _col5, _col6, _col7, _col10, _col11, _col18, _col51, _col52, _col53, _col107, _col138, _col168, _col188, _col197
                      input vertices:
                        0 Map 5
                      Statistics: Num rows: 1056440 Data size: 296328152 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col51 (type: int)
                          1 cd_demo_sk (type: int)
                        outputColumnNames: _col2, _col5, _col6, _col7, _col10, _col11, _col18, _col52, _col53, _col107, _col138, _col168, _col188, _col197, _col209
                        input vertices:
                          1 Map 14
                        Statistics: Num rows: 1162084 Data size: 325960974 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col7 (type: int)
                            1 p_promo_sk (type: int)
                          outputColumnNames: _col2, _col5, _col6, _col10, _col11, _col18, _col52, _col53, _col107, _col138, _col168, _col188, _col197, _col209
                          input vertices:
                            1 Map 15
                          Statistics: Num rows: 1278292 Data size: 358557079 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col5 (type: int)
                              1 hd_demo_sk (type: int)
                            outputColumnNames: _col2, _col6, _col10, _col11, _col18, _col52, _col53, _col107, _col138, _col168, _col188, _col197, _col209, _col242
                            input vertices:
                              1 Map 16
                            Statistics: Num rows: 1406121 Data size: 394412795 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col52 (type: int)
                                1 hd_demo_sk (type: int)
                              outputColumnNames: _col2, _col6, _col10, _col11, _col18, _col53, _col107, _col138, _col168, _col188, _col197, _col209, _col242, _col250
                              input vertices:
                                1 Map 17
                              Statistics: Num rows: 1546733 Data size: 433854083 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col6 (type: int)
                                  1 ca_address_sk (type: int)
                                outputColumnNames: _col2, _col10, _col11, _col18, _col53, _col107, _col138, _col168, _col188, _col197, _col209, _col242, _col250, _col259, _col260, _col263, _col266
                                input vertices:
                                  1 Map 18
                                Statistics: Num rows: 1701406 Data size: 477239501 Basic stats: COMPLETE Column stats: NONE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col53 (type: int)
                                    1 ca_address_sk (type: int)
                                  outputColumnNames: _col2, _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col242, _col250, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282
                                  input vertices:
                                    1 Map 19
                                  Statistics: Num rows: 1871546 Data size: 524963462 Basic stats: COMPLETE Column stats: NONE
                                  Map Join Operator
                                    condition map:
                                         Inner Join 0 to 1
                                    keys:
                                      0 _col242 (type: int)
                                      1 ib_income_band_sk (type: int)
                                    outputColumnNames: _col2, _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col250, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282
                                    input vertices:
                                      1 Map 20
                                    Statistics: Num rows: 2058700 Data size: 577459820 Basic stats: COMPLETE Column stats: NONE
                                    Map Join Operator
                                      condition map:
                                           Inner Join 0 to 1
                                      keys:
                                        0 _col250 (type: int)
                                        1 ib_income_band_sk (type: int)
                                      outputColumnNames: _col2, _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282
                                      input vertices:
                                        1 Map 21
                                      Statistics: Num rows: 2264570 Data size: 635205815 Basic stats: COMPLETE Column stats: NONE
                                      Map Join Operator
                                        condition map:
                                             Inner Join 0 to 1
                                             Inner Join 0 to 2
                                        keys:
                                          0 _col2 (type: int)
                                          1 i_item_sk (type: int)
                                          2 _col0 (type: int)
                                        outputColumnNames: _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282, _col301, _col306, _col318, _col322
                                        input vertices:
                                          1 Map 22
                                          2 Reducer 2
                                        Statistics: Num rows: 4982054 Data size: 1397452823 Basic stats: COMPLETE Column stats: NONE
                                        Filter Operator
                                          predicate: ((((_col197 <> _col209) and (_col318) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate')) and _col306 BETWEEN 35 AND 45) and _col306 BETWEEN 36 AND 50) (type: boolean)
                                          Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                          Select Operator
                                            expressions: _col322 (type: string), _col301 (type: int), _col168 (type: string), _col188 (type: string), _col259 (type: string), _col260 (type: string), _col263 (type: string), _col266 (type: string), _col275 (type: string), _col276 (type: string), _col279 (type: string), _col282 (type: string), 2000 (type: int), _col107 (type: int), _col138 (type: int), _col10 (type: decimal(7,2)), _col11 (type: decimal(7,2)), _col18 (type: decimal(7,2))
                                            outputColumnNames: _col322, _col301, _col168, _col188, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282, _col76, _col107, _col138, _col10, _col11, _col18
                                            Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                            Group By Operator
                                              aggregations: count(), sum(_col10), sum(_col11), sum(_col18)
                                              keys: _col322 (type: string), _col301 (type: int), _col168 (type: string), _col188 (type: string), _col259 (type: string), _col260 (type: string), _col263 (type: string), _col266 (type: string), _col275 (type: string), _col276 (type: string), _col279 (type: string), _col282 (type: string), _col76 (type: int), _col107 (type: int), _col138 (type: int)
                                              mode: hash
                                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                                              Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                              Reduce Output Operator
                                                key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: int), _col13 (type: int), _col14 (type: int)
                                                sort order: +++++++++++++++
                                                Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: int), _col13 (type: int), _col14 (type: int)
                                                Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                                value expressions: _col15 (type: bigint), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2))
            Execution mode: vectorized
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: cd2
                  Statistics: Num rows: 1920800 Data size: 538778449 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: cd_demo_sk is not null (type: boolean)
                    Statistics: Num rows: 960400 Data size: 269389224 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: cd_demo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: cd_demo_sk (type: int)
                      Statistics: Num rows: 960400 Data size: 269389224 Basic stats: COMPLETE Column stats: NONE
                      value expressions: cd_marital_status (type: string)
            Execution mode: vectorized
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  Statistics: Num rows: 300 Data size: 385624 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: p_promo_sk is not null (type: boolean)
                    Statistics: Num rows: 150 Data size: 192812 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: p_promo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: p_promo_sk (type: int)
                      Statistics: Num rows: 150 Data size: 192812 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: hd1
                  Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
                    Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: hd_demo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: hd_demo_sk (type: int)
                      Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                      value expressions: hd_income_band_sk (type: int)
            Execution mode: vectorized
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: hd2
                  Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
                    Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: hd_demo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: hd_demo_sk (type: int)
                      Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                      value expressions: hd_income_band_sk (type: int)
            Execution mode: vectorized
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: ad1
                  Statistics: Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ca_address_sk is not null (type: boolean)
                    Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ca_address_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ca_address_sk (type: int)
                      Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                      value expressions: ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
            Execution mode: vectorized
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: ad2
                  Statistics: Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ca_address_sk is not null (type: boolean)
                    Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ca_address_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ca_address_sk (type: int)
                      Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                      value expressions: ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
            Execution mode: vectorized
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: ib1
                  Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ib_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ib_income_band_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ib_income_band_sk (type: int)
                      Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: ib2
                  Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ib_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ib_income_band_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ib_income_band_sk (type: int)
                      Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 18000 Data size: 29671008 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((i_item_sk is not null and (i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate')) and i_current_price BETWEEN 35 AND 45) and i_current_price BETWEEN 36 AND 50) (type: boolean)
                    Statistics: Num rows: 1125 Data size: 1854438 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: i_item_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: i_item_sk (type: int)
                      Statistics: Num rows: 1125 Data size: 1854438 Basic stats: COMPLETE Column stats: NONE
                      value expressions: i_current_price (type: decimal(7,2)), i_color (type: string), i_product_name (type: string)
            Execution mode: vectorized
        Map 23 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  Statistics: Num rows: 1441548 Data size: 2515527468 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (cs_item_sk is not null and cs_order_number is not null) (type: boolean)
                    Statistics: Num rows: 360387 Data size: 628881867 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 cs_item_sk (type: int), cs_order_number (type: int)
                        1 cr_item_sk (type: int), cr_order_number (type: int)
                      outputColumnNames: _col14, _col24, _col60, _col61, _col62
                      input vertices:
                        1 Map 25
                      Statistics: Num rows: 396425 Data size: 691770068 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col24), sum(((_col60 + _col61) + _col62))
                        keys: _col14 (type: int)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 396425 Data size: 691770068 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 396425 Data size: 691770068 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(19,2))
            Execution mode: vectorized
        Map 25 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  Statistics: Num rows: 144067 Data size: 152549408 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (cr_item_sk is not null and cr_order_number is not null) (type: boolean)
                    Statistics: Num rows: 36017 Data size: 38137616 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: cr_item_sk (type: int), cr_order_number (type: int)
                      sort order: ++
                      Map-reduce partition columns: cr_item_sk (type: int), cr_order_number (type: int)
                      Statistics: Num rows: 36017 Data size: 38137616 Basic stats: COMPLETE Column stats: NONE
                      value expressions: cr_refunded_cash (type: decimal(7,2)), cr_reversed_charge (type: decimal(7,2)), cr_store_credit (type: decimal(7,2))
            Execution mode: vectorized
        Map 26 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 2750370 Data size: 3717170032 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((((((ss_item_sk is not null and ss_ticket_number is not null) and ss_customer_sk is not null) and ss_sold_date_sk is not null) and ss_cdemo_sk is not null) and ss_promo_sk is not null) and ss_hdemo_sk is not null) and ss_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 10744 Data size: 14520691 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ss_item_sk (type: int), ss_ticket_number (type: int)
                      sort order: ++
                      Map-reduce partition columns: ss_item_sk (type: int), ss_ticket_number (type: int)
                      Statistics: Num rows: 10744 Data size: 14520691 Basic stats: COMPLETE Column stats: NONE
                      value expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_promo_sk (type: int), ss_wholesale_cost (type: decimal(7,2)), ss_list_price (type: decimal(7,2)), ss_coupon_amt (type: decimal(7,2)), ss_store_sk (type: int)
            Execution mode: vectorized
        Map 27 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 287514 Data size: 291997400 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
                    Statistics: Num rows: 71879 Data size: 72999857 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 ss_item_sk (type: int), ss_ticket_number (type: int)
                        1 sr_item_sk (type: int), sr_ticket_number (type: int)
                      outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22
                      input vertices:
                        0 Map 26
                      Statistics: Num rows: 79066 Data size: 80299844 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: int)
                          1 c_customer_sk (type: int)
                        outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col54, _col55
                        input vertices:
                          1 Map 28
                        Statistics: Num rows: 86972 Data size: 88329830 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: int)
                            1 d_date_sk (type: int)
                          outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col54, _col55
                          input vertices:
                            1 Map 29
                          Statistics: Num rows: 95669 Data size: 97162815 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col55 (type: int)
                              1 d_date_sk (type: int)
                            outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col54, _col107
                            input vertices:
                              1 Map 30
                            Statistics: Num rows: 105235 Data size: 106879098 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col54 (type: int)
                                1 d_date_sk (type: int)
                              outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col107, _col138
                              input vertices:
                                1 Map 31
                              Statistics: Num rows: 115758 Data size: 117567010 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col22 (type: int)
                                  1 s_store_sk (type: int)
                                outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col51, _col52, _col53, _col107, _col138, _col168, _col188
                                input vertices:
                                  1 Map 32
                                Statistics: Num rows: 127333 Data size: 129323713 Basic stats: COMPLETE Column stats: NONE
                                Reduce Output Operator
                                  key expressions: _col4 (type: int)
                                  sort order: +
                                  Map-reduce partition columns: _col4 (type: int)
                                  Statistics: Num rows: 127333 Data size: 129323713 Basic stats: COMPLETE Column stats: NONE
                                  value expressions: _col2 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col10 (type: decimal(7,2)), _col11 (type: decimal(7,2)), _col18 (type: decimal(7,2)), _col51 (type: int), _col52 (type: int), _col53 (type: int), _col107 (type: int), _col138 (type: int), _col168 (type: string), _col188 (type: string)
            Execution mode: vectorized
        Map 28 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 100000 Data size: 85628164 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((((c_customer_sk is not null and c_first_sales_date_sk is not null) and c_first_shipto_date_sk is not null) and c_current_cdemo_sk is not null) and c_current_hdemo_sk is not null) and c_current_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 1563 Data size: 1338368 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: c_customer_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: c_customer_sk (type: int)
                      Statistics: Num rows: 1563 Data size: 1338368 Basic stats: COMPLETE Column stats: NONE
                      value expressions: c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
            Execution mode: vectorized
        Map 29 
            Map Operator Tree:
                TableScan
                  alias: d1
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (d_date_sk is not null and (d_year = 2001)) (type: boolean)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: d_date_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: d_date_sk (type: int)
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  Statistics: Num rows: 144067 Data size: 152549408 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (cr_item_sk is not null and cr_order_number is not null) (type: boolean)
                    Statistics: Num rows: 36017 Data size: 38137616 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: cr_item_sk (type: int), cr_order_number (type: int)
                      sort order: ++
                      Map-reduce partition columns: cr_item_sk (type: int), cr_order_number (type: int)
                      Statistics: Num rows: 36017 Data size: 38137616 Basic stats: COMPLETE Column stats: NONE
                      value expressions: cr_refunded_cash (type: decimal(7,2)), cr_reversed_charge (type: decimal(7,2)), cr_store_credit (type: decimal(7,2))
            Execution mode: vectorized
        Map 30 
            Map Operator Tree:
                TableScan
                  alias: d2
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: d_date_sk is not null (type: boolean)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: d_date_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: d_date_sk (type: int)
                      Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_year (type: int)
            Execution mode: vectorized
        Map 31 
            Map Operator Tree:
                TableScan
                  alias: d3
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: d_date_sk is not null (type: boolean)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: d_date_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: d_date_sk (type: int)
                      Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_year (type: int)
            Execution mode: vectorized
        Map 32 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 12 Data size: 25632 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((s_store_sk is not null and s_store_name is not null) and s_zip is not null) (type: boolean)
                    Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: s_store_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: s_store_sk (type: int)
                      Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                      value expressions: s_store_name (type: string), s_zip (type: string)
                    Select Operator
                      expressions: s_store_sk (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        keys: _col0 (type: int)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                        Dynamic Partitioning Event Operator
                          Target Input: store_sales
                          Partition key expr: ss_store_sk
                          Statistics: Num rows: 2 Data size: 4272 Basic stats: COMPLETE Column stats: NONE
                          Target column: ss_store_sk
                          Target Vertex: Map 26
            Execution mode: vectorized
        Map 33 
            Map Operator Tree:
                TableScan
                  alias: cd1
                  Statistics: Num rows: 1920800 Data size: 538778449 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: cd_demo_sk is not null (type: boolean)
                    Statistics: Num rows: 960400 Data size: 269389224 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: int)
                        1 cd_demo_sk (type: int)
                      outputColumnNames: _col2, _col5, _col6, _col7, _col10, _col11, _col18, _col51, _col52, _col53, _col107, _col138, _col168, _col188, _col197
                      input vertices:
                        0 Map 27
                      Statistics: Num rows: 1056440 Data size: 296328152 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col51 (type: int)
                          1 cd_demo_sk (type: int)
                        outputColumnNames: _col2, _col5, _col6, _col7, _col10, _col11, _col18, _col52, _col53, _col107, _col138, _col168, _col188, _col197, _col209
                        input vertices:
                          1 Map 35
                        Statistics: Num rows: 1162084 Data size: 325960974 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col7 (type: int)
                            1 p_promo_sk (type: int)
                          outputColumnNames: _col2, _col5, _col6, _col10, _col11, _col18, _col52, _col53, _col107, _col138, _col168, _col188, _col197, _col209
                          input vertices:
                            1 Map 36
                          Statistics: Num rows: 1278292 Data size: 358557079 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col5 (type: int)
                              1 hd_demo_sk (type: int)
                            outputColumnNames: _col2, _col6, _col10, _col11, _col18, _col52, _col53, _col107, _col138, _col168, _col188, _col197, _col209, _col242
                            input vertices:
                              1 Map 37
                            Statistics: Num rows: 1406121 Data size: 394412795 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col52 (type: int)
                                1 hd_demo_sk (type: int)
                              outputColumnNames: _col2, _col6, _col10, _col11, _col18, _col53, _col107, _col138, _col168, _col188, _col197, _col209, _col242, _col250
                              input vertices:
                                1 Map 38
                              Statistics: Num rows: 1546733 Data size: 433854083 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col6 (type: int)
                                  1 ca_address_sk (type: int)
                                outputColumnNames: _col2, _col10, _col11, _col18, _col53, _col107, _col138, _col168, _col188, _col197, _col209, _col242, _col250, _col259, _col260, _col263, _col266
                                input vertices:
                                  1 Map 39
                                Statistics: Num rows: 1701406 Data size: 477239501 Basic stats: COMPLETE Column stats: NONE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col53 (type: int)
                                    1 ca_address_sk (type: int)
                                  outputColumnNames: _col2, _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col242, _col250, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282
                                  input vertices:
                                    1 Map 40
                                  Statistics: Num rows: 1871546 Data size: 524963462 Basic stats: COMPLETE Column stats: NONE
                                  Map Join Operator
                                    condition map:
                                         Inner Join 0 to 1
                                    keys:
                                      0 _col242 (type: int)
                                      1 ib_income_band_sk (type: int)
                                    outputColumnNames: _col2, _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col250, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282
                                    input vertices:
                                      1 Map 41
                                    Statistics: Num rows: 2058700 Data size: 577459820 Basic stats: COMPLETE Column stats: NONE
                                    Map Join Operator
                                      condition map:
                                           Inner Join 0 to 1
                                      keys:
                                        0 _col250 (type: int)
                                        1 ib_income_band_sk (type: int)
                                      outputColumnNames: _col2, _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282
                                      input vertices:
                                        1 Map 42
                                      Statistics: Num rows: 2264570 Data size: 635205815 Basic stats: COMPLETE Column stats: NONE
                                      Map Join Operator
                                        condition map:
                                             Inner Join 0 to 1
                                             Inner Join 0 to 2
                                        keys:
                                          0 _col2 (type: int)
                                          1 i_item_sk (type: int)
                                          2 _col0 (type: int)
                                        outputColumnNames: _col10, _col11, _col18, _col107, _col138, _col168, _col188, _col197, _col209, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282, _col301, _col306, _col318, _col322
                                        input vertices:
                                          1 Map 43
                                          2 Reducer 24
                                        Statistics: Num rows: 4982054 Data size: 1397452823 Basic stats: COMPLETE Column stats: NONE
                                        Filter Operator
                                          predicate: ((((_col197 <> _col209) and (_col318) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate')) and _col306 BETWEEN 35 AND 45) and _col306 BETWEEN 36 AND 50) (type: boolean)
                                          Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                          Select Operator
                                            expressions: _col322 (type: string), _col301 (type: int), _col168 (type: string), _col188 (type: string), _col259 (type: string), _col260 (type: string), _col263 (type: string), _col266 (type: string), _col275 (type: string), _col276 (type: string), _col279 (type: string), _col282 (type: string), 2001 (type: int), _col107 (type: int), _col138 (type: int), _col10 (type: decimal(7,2)), _col11 (type: decimal(7,2)), _col18 (type: decimal(7,2))
                                            outputColumnNames: _col322, _col301, _col168, _col188, _col259, _col260, _col263, _col266, _col275, _col276, _col279, _col282, _col76, _col107, _col138, _col10, _col11, _col18
                                            Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                            Group By Operator
                                              aggregations: count(), sum(_col10), sum(_col11), sum(_col18)
                                              keys: _col322 (type: string), _col301 (type: int), _col168 (type: string), _col188 (type: string), _col259 (type: string), _col260 (type: string), _col263 (type: string), _col266 (type: string), _col275 (type: string), _col276 (type: string), _col279 (type: string), _col282 (type: string), _col76 (type: int), _col107 (type: int), _col138 (type: int)
                                              mode: hash
                                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                                              Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                              Reduce Output Operator
                                                key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: int), _col13 (type: int), _col14 (type: int)
                                                sort order: +++++++++++++++
                                                Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: int), _col13 (type: int), _col14 (type: int)
                                                Statistics: Num rows: 622756 Data size: 174681392 Basic stats: COMPLETE Column stats: NONE
                                                value expressions: _col15 (type: bigint), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2))
            Execution mode: vectorized
        Map 35 
            Map Operator Tree:
                TableScan
                  alias: cd2
                  Statistics: Num rows: 1920800 Data size: 538778449 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: cd_demo_sk is not null (type: boolean)
                    Statistics: Num rows: 960400 Data size: 269389224 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: cd_demo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: cd_demo_sk (type: int)
                      Statistics: Num rows: 960400 Data size: 269389224 Basic stats: COMPLETE Column stats: NONE
                      value expressions: cd_marital_status (type: string)
            Execution mode: vectorized
        Map 36 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  Statistics: Num rows: 300 Data size: 385624 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: p_promo_sk is not null (type: boolean)
                    Statistics: Num rows: 150 Data size: 192812 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: p_promo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: p_promo_sk (type: int)
                      Statistics: Num rows: 150 Data size: 192812 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 37 
            Map Operator Tree:
                TableScan
                  alias: hd1
                  Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
                    Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: hd_demo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: hd_demo_sk (type: int)
                      Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                      value expressions: hd_income_band_sk (type: int)
            Execution mode: vectorized
        Map 38 
            Map Operator Tree:
                TableScan
                  alias: hd2
                  Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
                    Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: hd_demo_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: hd_demo_sk (type: int)
                      Statistics: Num rows: 1800 Data size: 192600 Basic stats: COMPLETE Column stats: NONE
                      value expressions: hd_income_band_sk (type: int)
            Execution mode: vectorized
        Map 39 
            Map Operator Tree:
                TableScan
                  alias: ad1
                  Statistics: Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ca_address_sk is not null (type: boolean)
                    Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ca_address_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ca_address_sk (type: int)
                      Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                      value expressions: ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
            Execution mode: vectorized
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 2750370 Data size: 3717170032 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((((((ss_item_sk is not null and ss_ticket_number is not null) and ss_customer_sk is not null) and ss_sold_date_sk is not null) and ss_cdemo_sk is not null) and ss_promo_sk is not null) and ss_hdemo_sk is not null) and ss_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 10744 Data size: 14520691 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ss_item_sk (type: int), ss_ticket_number (type: int)
                      sort order: ++
                      Map-reduce partition columns: ss_item_sk (type: int), ss_ticket_number (type: int)
                      Statistics: Num rows: 10744 Data size: 14520691 Basic stats: COMPLETE Column stats: NONE
                      value expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_promo_sk (type: int), ss_wholesale_cost (type: decimal(7,2)), ss_list_price (type: decimal(7,2)), ss_coupon_amt (type: decimal(7,2)), ss_store_sk (type: int)
            Execution mode: vectorized
        Map 40 
            Map Operator Tree:
                TableScan
                  alias: ad2
                  Statistics: Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ca_address_sk is not null (type: boolean)
                    Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ca_address_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ca_address_sk (type: int)
                      Statistics: Num rows: 25000 Data size: 27987864 Basic stats: COMPLETE Column stats: NONE
                      value expressions: ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
            Execution mode: vectorized
        Map 41 
            Map Operator Tree:
                TableScan
                  alias: ib1
                  Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ib_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ib_income_band_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ib_income_band_sk (type: int)
                      Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 42 
            Map Operator Tree:
                TableScan
                  alias: ib2
                  Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ib_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: ib_income_band_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: ib_income_band_sk (type: int)
                      Statistics: Num rows: 10 Data size: 120 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 43 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 18000 Data size: 29671008 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((i_item_sk is not null and (i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate')) and i_current_price BETWEEN 35 AND 45) and i_current_price BETWEEN 36 AND 50) (type: boolean)
                    Statistics: Num rows: 1125 Data size: 1854438 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: i_item_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: i_item_sk (type: int)
                      Statistics: Num rows: 1125 Data size: 1854438 Basic stats: COMPLETE Column stats: NONE
                      value expressions: i_current_price (type: decimal(7,2)), i_color (type: string), i_product_name (type: string)
            Execution mode: vectorized
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 287514 Data size: 291997400 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
                    Statistics: Num rows: 71879 Data size: 72999857 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 ss_item_sk (type: int), ss_ticket_number (type: int)
                        1 sr_item_sk (type: int), sr_ticket_number (type: int)
                      outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22
                      input vertices:
                        0 Map 4
                      Statistics: Num rows: 79066 Data size: 80299844 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: int)
                          1 c_customer_sk (type: int)
                        outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col54, _col55
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 86972 Data size: 88329830 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: int)
                            1 d_date_sk (type: int)
                          outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col54, _col55
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 95669 Data size: 97162815 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col55 (type: int)
                              1 d_date_sk (type: int)
                            outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col54, _col107
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 105235 Data size: 106879098 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col54 (type: int)
                                1 d_date_sk (type: int)
                              outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col22, _col51, _col52, _col53, _col107, _col138
                              input vertices:
                                1 Map 9
                              Statistics: Num rows: 115758 Data size: 117567010 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col22 (type: int)
                                  1 s_store_sk (type: int)
                                outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col10, _col11, _col18, _col51, _col52, _col53, _col107, _col138, _col168, _col188
                                input vertices:
                                  1 Map 10
                                Statistics: Num rows: 127333 Data size: 129323713 Basic stats: COMPLETE Column stats: NONE
                                Reduce Output Operator
                                  key expressions: _col4 (type: int)
                                  sort order: +
                                  Map-reduce partition columns: _col4 (type: int)
                                  Statistics: Num rows: 127333 Data size: 129323713 Basic stats: COMPLETE Column stats: NONE
                                  value expressions: _col2 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col10 (type: decimal(7,2)), _col11 (type: decimal(7,2)), _col18 (type: decimal(7,2)), _col51 (type: int), _col52 (type: int), _col53 (type: int), _col107 (type: int), _col138 (type: int), _col168 (type: string), _col188 (type: string)
            Execution mode: vectorized
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 100000 Data size: 85628164 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((((c_customer_sk is not null and c_first_sales_date_sk is not null) and c_first_shipto_date_sk is not null) and c_current_cdemo_sk is not null) and c_current_hdemo_sk is not null) and c_current_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 1563 Data size: 1338368 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: c_customer_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: c_customer_sk (type: int)
                      Statistics: Num rows: 1563 Data size: 1338368 Basic stats: COMPLETE Column stats: NONE
                      value expressions: c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
            Execution mode: vectorized
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: d1
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (d_date_sk is not null and (d_year = 2000)) (type: boolean)
                    Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: d_date_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: d_date_sk (type: int)
                      Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: d2
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: d_date_sk is not null (type: boolean)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: d_date_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: d_date_sk (type: int)
                      Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_year (type: int)
            Execution mode: vectorized
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: d3
                  Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: d_date_sk is not null (type: boolean)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: d_date_sk (type: int)
                      sort order: +
                      Map-reduce partition columns: d_date_sk (type: int)
                      Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                      value expressions: d_year (type: int)
            Execution mode: vectorized
        Reducer 12 
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string), KEY._col10 (type: string), KEY._col11 (type: string), KEY._col12 (type: int), KEY._col13 (type: int), KEY._col14 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                Statistics: Num rows: 311378 Data size: 87340696 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: int), _col15 (type: bigint), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2)), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                  outputColumnNames: _col0, _col1, _col10, _col11, _col12, _col15, _col16, _col17, _col18, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 311378 Data size: 87340696 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: int), _col2 (type: string), _col3 (type: string)
                      1 _col1 (type: int), _col2 (type: string), _col3 (type: string)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col15, _col16, _col17, _col18, _col21, _col22, _col31, _col34, _col35, _col36, _col37
                    input vertices:
                      1 Reducer 34
                    Statistics: Num rows: 342515 Data size: 96074767 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: (((((_col12 = 2000) and (_col31 = 2001)) and (_col34 <= _col15)) and (_col2 = _col21)) and (_col3 = _col22)) (type: boolean)
                      Statistics: Num rows: 7135 Data size: 2001353 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col15 (type: bigint), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2)), _col35 (type: decimal(17,2)), _col36 (type: decimal(17,2)), _col37 (type: decimal(17,2)), _col3 (type: string), _col34 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
                        outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                        Statistics: Num rows: 7135 Data size: 2001353 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: string), _col20 (type: bigint)
                          sort order: +++
                          Statistics: Num rows: 7135 Data size: 2001353 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col12 (type: bigint), _col13 (type: decimal(17,2)), _col14 (type: decimal(17,2)), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2))
            Execution mode: vectorized
        Reducer 13 
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: string), VALUE._col5 (type: string), VALUE._col6 (type: string), VALUE._col7 (type: string), VALUE._col8 (type: string), 2000 (type: int), VALUE._col10 (type: bigint), VALUE._col11 (type: decimal(17,2)), VALUE._col12 (type: decimal(17,2)), VALUE._col13 (type: decimal(17,2)), VALUE._col14 (type: decimal(17,2)), VALUE._col15 (type: decimal(17,2)), VALUE._col16 (type: decimal(17,2)), 2001 (type: int), KEY.reducesinkkey2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20
                Statistics: Num rows: 7135 Data size: 2001353 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 7135 Data size: 2001353 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: vectorized
        Reducer 2 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 198212 Data size: 345884161 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col1 > (2 * _col2)) (type: boolean)
                  Statistics: Num rows: 66070 Data size: 115293556 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 66070 Data size: 115293556 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 66070 Data size: 115293556 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Reducer 24 
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 198212 Data size: 345884161 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col1 > (2 * _col2)) (type: boolean)
                  Statistics: Num rows: 66070 Data size: 115293556 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 66070 Data size: 115293556 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 66070 Data size: 115293556 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized
        Reducer 34 
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string), KEY._col10 (type: string), KEY._col11 (type: string), KEY._col12 (type: int), KEY._col13 (type: int), KEY._col14 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                Statistics: Num rows: 311378 Data size: 87340696 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: int), _col12 (type: int), _col15 (type: bigint), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2)), _col2 (type: string), _col3 (type: string)
                  outputColumnNames: _col1, _col12, _col15, _col16, _col17, _col18, _col2, _col3
                  Statistics: Num rows: 311378 Data size: 87340696 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string)
                    sort order: +++
                    Map-reduce partition columns: _col1 (type: int), _col2 (type: string), _col3 (type: string)
                    Statistics: Num rows: 311378 Data size: 87340696 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col12 (type: int), _col15 (type: bigint), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2)), _col18 (type: decimal(17,2))
            Execution mode: vectorized

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink
{noformat}, Will verify against latest. 
Did anything in the code path change in recent patches ? 

Thanks 
Mostafa

, HIVE-9743 changed the non-native VectorMapJoinOperator., [~mmccline]
Still repros on latest.
First attempt to simplify the query failed, will keep trying., I think the hint from the exception is that we are mixing a string with a double column.

[~mmccline]
Can you provide a patch which prints out the column IDs or such so that we can narrow this down?

, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12731779/HIVE-10609.01.patch

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 8919 tests executed
*Failed tests:*
{noformat}
TestHiveAuthFactory - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_left_outer_join2
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_static
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_left_outer_join2
org.apache.hive.jdbc.TestSSL.testSSLFetchHttp
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3839/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3839/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3839/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12731779 - PreCommit-HIVE-TRUNK-Build, [~mmccline]
I tried the patch on TPC-DS 200GB and query runs fine and returns correct results., [~mmokhtar] Thanks for verifying it!

Fix left join filtered code.

[Note: the Tez results for vector_left_outer_join2.q are wrong.  This is a known issue solved by pending HIVE-10565], 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12731842/HIVE-10609.02.patch

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 8921 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_static
org.apache.hive.jdbc.TestMultiSessionsHS2WithLocalClusterSpark.testSparkQuery
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3843/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3843/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3843/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12731842 - PreCommit-HIVE-TRUNK-Build, Test failures are not related to the changes here., +1 LGTM., [~sushanth] can this still go in 1.2 or has that boat sailed?, Committed to both 1.2 and master. Thanks Matt!, This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]