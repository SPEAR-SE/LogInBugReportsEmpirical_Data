[Preliminary patch to make it build (somewhat, I didn't make the original on master). 
I suspect that we'd need to have two builds for binary compat, similar to how we used to with hadoop1 vs 2. Consider e.g. netty API changes in ShuffleHandler - we take netty library from Hadoop, and I suspect even if those are changed to use a reflection-based, single-build netty-shim (like the JVM monitor changes), the version built against one netty won't work with the other.

 cc [~sseth] [~gopalv] [~jnp] [~hagleitn], [~spena] did some work on this. It might worth to take a look this jira: HIVE-15016, I do not know if he did take a look at these things lately, just thought that it would be good idea to connect the two jiras :) ]