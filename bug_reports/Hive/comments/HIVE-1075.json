[+1 looks good. will commit if tests pass., Committed to trunk. Thanks Zheng!]