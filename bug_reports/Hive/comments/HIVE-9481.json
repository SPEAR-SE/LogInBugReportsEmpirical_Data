[

{color:red}Overall{color}: -1 no tests executed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12696947/HIVE-9481.patch

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2689/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2689/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2689/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Tests exited with: ExecutionException: org.apache.hive.ptest.execution.ssh.SSHExecutionException: RSyncResult [localFile=/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2689/succeeded/TestHBaseMinimrCliDriver, remoteFile=/home/hiveptest/54.225.0.71-hiveptest-0/logs/, getExitCode()=12, getException()=null, getUser()=hiveptest, getHost()=54.225.0.71, getInstance()=0]: 'Address 54.225.0.71 maps to ec2-54-225-0-71.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
TEST-TestHBaseMinimrCliDriver-TEST-org.apache.hadoop.hive.cli.TestHBaseMinimrCliDriver.xml
           0   0%    0.00kB/s    0:00:00
        4836 100%    4.61MB/s    0:00:00 (xfer#1, to-check=3/5)
hive.log
           0   0%    0.00kB/s    0:00:00
    50233344  24%   47.81MB/s    0:00:03
    98369536  48%   46.84MB/s    0:00:02
rsync: write failed on "/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2689/succeeded/TestHBaseMinimrCliDriver/hive.log": No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (213 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.225.0.71 maps to ec2-54-225-0-71.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on "/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2689/succeeded/TestHBaseMinimrCliDriver/hive.log": No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (213 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.225.0.71 maps to ec2-54-225-0-71.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on "/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2689/succeeded/TestHBaseMinimrCliDriver/hive.log": No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (213 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.225.0.71 maps to ec2-54-225-0-71.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on "/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2689/succeeded/TestHBaseMinimrCliDriver/hive.log": No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (213 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
Address 54.225.0.71 maps to ec2-54-225-0-71.compute-1.amazonaws.com, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
receiving incremental file list
./
hive.log
           0   0%    0.00kB/s    0:00:00
rsync: write failed on "/data/hive-ptest/logs/PreCommit-HIVE-TRUNK-Build-2689/succeeded/TestHBaseMinimrCliDriver/hive.log": No space left on device (28)
rsync error: error in file IO (code 11) at receiver.c(301) [receiver=3.0.6]
rsync: connection unexpectedly closed (213 bytes received so far) [generator]
rsync error: error in rsync protocol data stream (code 12) at io.c(600) [generator=3.0.6]
'
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12696947 - PreCommit-HIVE-TRUNK-Build, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12697214/HIVE-9481.2.patch

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 7520 tests executed
*Failed tests:*
{noformat}
TestSparkClient - did not produce a TEST-*.xml file
org.apache.hive.jdbc.TestSSL.testSSLFetchHttp
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2700/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2700/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2700/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12697214 - PreCommit-HIVE-TRUNK-Build, the error for the failed test is not related to the patch
{noformat}
java.sql.SQLException: Could not open client transport with JDBC Uri: jdbc:hive2://localhost:53698/default;ssl=true;sslTrustStore=%2Fhome%2Fhiveptest%2F54.144.54.75-hiveptest-2%2Fapache-svn-trunk-source%2Fitests%2Fhive-unit%2F..%2F..%2F%2Fdata%2Ffiles%2Ftruststore.jks;trustStorePassword=HiveJdbc?hive.server2.transport.mode=http;hive.server2.thrift.http.path=cliservice;: Could not create http connection to jdbc:hive2://localhost:53698/default;ssl=true;sslTrustStore=%2Fhome%2Fhiveptest%2F54.144.54.75-hiveptest-2%2Fapache-svn-trunk-source%2Fitests%2Fhive-unit%2F..%2F..%2F%2Fdata%2Ffiles%2Ftruststore.jks;trustStorePassword=HiveJdbc?hive.server2.transport.mode=http;hive.server2.thrift.http.path=cliservice;. org.apache.http.conn.HttpHostConnectException: Connection to https://localhost:53698 refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:579)
	at sun.security.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:618)
	at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:414)
	at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:180)
	at org.apache.http.impl.conn.ManagedClientConnectionImpl.open(ManagedClientConnectionImpl.java:294)
	at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:643)
	at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:479)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:906)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:827)
	at org.apache.thrift.transport.THttpClient.flushUsingHttpClient(THttpClient.java:251)
	at org.apache.thrift.transport.THttpClient.flush(THttpClient.java:313)
	at org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:65)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.send_OpenSession(TCLIService.java:150)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:142)
	at org.apache.hive.jdbc.HiveConnection.createHttpTransport(HiveConnection.java:249)
	at org.apache.hive.jdbc.HiveConnection.openTransport(HiveConnection.java:187)
	at org.apache.hive.jdbc.HiveConnection.<init>(HiveConnection.java:163)
	at org.apache.hive.jdbc.HiveDriver.connect(HiveDriver.java:105)
	at java.sql.DriverManager.getConnection(DriverManager.java:571)
	at java.sql.DriverManager.getConnection(DriverManager.java:215)
	at org.apache.hive.jdbc.TestSSL.testSSLFetchHttp(TestSSL.java:360)
{noformat}, In SemanticAnalyzer.doPhase1 you have a comment "for partitioned tables, should we use partition rather than table here?"  No, you're correct to use table, as you cannot always know which partition to use (dynamic partitioning) or you may be inserting into multiple partitions.

If I read the patch correctly it does not yet support dynamic partitions.  That's fine, but I didn't see any guards to throw an error if the user attempts to use both together.  

You should add some .q file tests to make sure this works end-to-end., patch 4 include dynamic partition support and tests.  It still needs some refactoring but mostly done., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12697667/HIVE-9481.4.patch

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 7543 tests executed
*Failed tests:*
{noformat}
org.apache.hive.jdbc.TestSSL.testSSLFetchHttp
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2739/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2739/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2739/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12697667 - PreCommit-HIVE-TRUNK-Build, [~alangates], could you review patch 5 please, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12697897/HIVE-9481.5.patch

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 7548 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.thrift.TestHadoop20SAuthBridge.testMetastoreProxyUser
org.apache.hadoop.hive.thrift.TestHadoop20SAuthBridge.testSaslWithHiveMetaStore
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2750/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2750/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2750/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12697897 - PreCommit-HIVE-TRUNK-Build, both test failures are NPE at HiveMetaStore.getDelegationToken(HiveMetaStore.java:5618) and not related to the patch., Reviewing patch 5., +1, with a couple of test caveats:
insert_into_with_schema3.q assumes the source table but does not create it, which means it won't work unless it's run after insert_into_with_schema2.q

In clientpositive/insert_into_with_schema.q I think it would be good to add a dynamic partitioning test where one of the non-partition columns is missing., 1. 'source' table doesn't need to exist in insert_into_with_schema3.q since provided column schema is validated against 'target1' first and produces the expected error message.  I added Create Table for 'source' anyway for clarity.
2. none of the insert statements into 'pageviews' supply pageviews.source column, which is not a partition column so I think this is covered.

I did roll a new patch for #1 and because I tweaked the grammar in the error message insert_into_with_schema3.q., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12698516/HIVE-9481.6.patch

{color:green}SUCCESS:{color} +1 7550 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2784/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2784/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2784/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12698516 - PreCommit-HIVE-TRUNK-Build, Committed to trunk.  Thanks [~alangates] for the review, This should be documented in the wiki here:

* [LanguageManual DML -- Inserting data into Hive Tables from queries | https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertingdataintoHiveTablesfromqueries]

If it also applies to INSERT ... VALUES, mention it here:

* [LanguageManual DML -- Inserting values into tables from SQL | https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertingvaluesintotablesfromSQL], This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira., added note to https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-Synopsis.1, This solution only works for INSERT INTO statements but not for INSERT OVERWRITE TABLE statements. Do you plan to add this feature?]