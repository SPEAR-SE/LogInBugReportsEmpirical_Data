[patch-1: take a simple approach to limit the history file size when flushing the data to the file. Currently it's default to 100M rather than making it configurable., Seems we are solving the same issue in both places. Resolve as dup.]