[Fixed the problem and added a test case., +1. 

Looks good. Will commit once the tests pass.
, committed. Thanks Zheng!!
]