[This is reproducible in master when {{hive.cbo.enable=false}}., Yes, Whenever we are using select statement, it works perfect. Within CTE with NULL Check is causing issue, let me check If hive.cbo.enable = true will resolve this issue., [~jcamachorodriguez], after I apply the patch in https://issues.apache.org/jira/browse/HIVE-13602, the error disappears. Will add a new test case in HIVE-13602 as well.... [~Mahens] and [~dmarkovitz], could u try the patch and confirm? If so, we can close it as duplicate. Thanks. , Thanks [~pxiong]!, resolved as duplicate of HIVE-13602. Added a test case for CTE as well. Thanks [~jcamachorodriguez] for the investigation!]