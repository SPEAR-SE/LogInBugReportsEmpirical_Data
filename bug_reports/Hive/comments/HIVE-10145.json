[After more thought, I feel it does not make sense to inherit the admin role users only in case when SQL Standard authorization is enabled, as that is just one of the possible authorization modes, that would be confusing. There is not much value I see in that added complexity. I will keep things simple and just let users set the AM level permissions using tez.am.*-acls properties.

Only DAG level access control will be set from HiveServer2. This is to ensure that end users running queries with doAs=false still have access to the DAG information for DAGs corresponding to their query.

Updating the proposal in description.
, From hive side looks OK +1. Would be good to get a review from tez guys as well., Thanks for the view [~vikram.dixit]. I did some manual testing to verify this works.

[~hitesh] I think I have run into what looks like a Tez bug during tests.
Though I set the end user as the view and write user, the user does not get added to the writers list.

GET http://localhost:8188/ws/v1/timeline/domain/Tez_ATS_application_1428012550608_0017_hive_20150403011754_26c51eb0-6ef5-4f5a-8285-f14640b0c1b1:1
Gives - 
{code}
{
id: "Tez_ATS_application_1428012550608_0017_hive_20150403011754_26c51eb0-6ef5-4f5a-8285-f14640b0c1b1:1",
owner: "hive",
readers: "hive,hrt_qa ",
writers: "hive",
createdtime: 1428023886613,
modifiedtime: 1428023886613
}
{code}

I see that calls to getUsersWithModifyACLs are missing from ATSHistoryACLPolicyManager.java, it has only calls to getUsersWithViewACLs. Is there any existing bug tracking that issue ?
, No open jira. Can you please go ahead and create one? Thanks., [~hitesh] Created TEZ-2277 to track the issue.
, 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12709140/HIVE-10145.1.patch

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 8699 tests executed
*Failed tests:*
{noformat}
TestCustomAuthentication - did not produce a TEST-*.xml file
TestMinimrCliDriver-smb_mapjoin_8.q - did not produce a TEST-*.xml file
org.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler.testRevokeTimedOutWorkers
org.apache.hive.jdbc.TestSSL.testSSLFetchHttp
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3273/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3273/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3273/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12709140 - PreCommit-HIVE-TRUNK-Build, [~hitesh] Does the patch look good to you, from a Tez perspective ?
, Patch committed to trunk. Thanks for the review [~vikram.dixit] and the guidance [~hitesh]
, Does this need any documentation?, I don't think this needs documentation, this is the intuitive behavior.
, Thanks [~thejas]., This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]