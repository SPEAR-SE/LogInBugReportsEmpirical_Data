[still running the tests, In the Hadoop world, ugi information is saved in conf.

I think Hive should call:

{code}
class UnixUserGroupInformation:
public static UnixUserGroupInformation login(Configuration conf, boolean save = true);
{code}

on session start.

User can modify "ugi" through "set" if they want.

And hooks will get ugi information from HiveConf.


If we want to keep the interface of hooks intact, we can get the ugi information from HiveConf by using UnixUserGroupInformation.UGI_PROPERTY_NAME.
, A better way would be:

when Hive session starts, we should call:
{code}
class UnixUserGroupInformation:
  public static UnixUserGroupInformation login(Configuration conf, boolean save=true);
{code}

to save the ugi to HiveConf.

Then users are free to change ugi using "set" command if they want.

Hooks will get ugi from HiveConf just as the main query.


If we want to keep the Hooks interface, we can get the ugi from hiveconf when we call the hooks.
, i think we do something similar in DDLTask (for getting the username for table owner)., hive.880.2.patch: nitpick: Can we do "log.WARN" in the places that we ignore the exceptions?
We can change DDLTask to use the same logic in the same transaction if you want.
, added log messages - will do DDLTask cleanup in a separate jira later, I will change it to stringifyException(e) instead of e.getMessage(), otherwise it will be hard to know what happened.
Otherwise it looks OK. will test and commit.
, Somehow the patch failed the unit tests., Committed. Thanks Namit!, Actually this is only fixed in trunk - the patch does not work for branch-0.4.]