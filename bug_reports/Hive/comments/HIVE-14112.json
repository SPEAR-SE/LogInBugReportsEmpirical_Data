[CC [~ashutoshc], This is just a workaround. Proper way to fix is to provide storage handler a way to tell estimated size of table to compiler which then can use that info for planning. Infact, that interface already exists {{org.apache.hadoop.hive.ql.metadata.InputEstimator}} and is used in {{SimpleFetchOptimizer}} Lets make use of this interface for join algo selection as well in compiler.]