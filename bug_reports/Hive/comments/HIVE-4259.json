[Adds colExprMap to sel operator. Fixes test cases union_remove_[2,14,24,5,8,9].q, https://reviews.facebook.net/D9819, Could you update test results? When I ran tests, it includes diffs of union_remove_3,4,5,7,8,9,14,22,23,24., I thought I did. You have to apply HIVE-4179 (blocking issue) first in order to see those pass. Do you see the failures with both patches in place?, I've commented in wrong issue, sorry(intended HIVE-4179). 
Would it be better to merge this with HIVE-4179? I remember other hive committers prefer one patch for an issue. (Also it's hard to review), I've actually created the two new issues because I felt they are not all the same issue. One is about the union optimization not correctly removing/merging operators, this one is about the sem analyzer not creating sel operators correctly. There are two more to get the union_remove_* tests back on track. Seems these tests just haven't been run for a while.

I thought this would make reviewing/refreshing patches easier as well. I've ran the union_remove test cases with both patches separately and updated the golden files that either patch fixes respectively.

Does that make sense?, [~hagleitn] Yes, I know it's all separate issues with all different reasons. Running tests., Assuming HIVE-4179 is applied, here's the before and after applying this patch results in terms of union_remove failures:

{noformat}
failures before: 10, 12, 13, 14, 24, 5, 8, 9
 failures after: 10, 12, 13
{noformat}

So this one takes care of: 14, 24, 4, 8, 9., [~navis]: Sorry didn't see the review comment on phabricator earlier. I've replied now., [~navis] Patch looks good to me. Unless you have more comments for it, will commit if tests pass., All tests passed., +1, Committed to trunk. Thanks, Gunther!, Integrated in Hive-trunk-h0.21 #2044 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2044/])
    HIVE-4259 : SEL operator created with missing columnExprMap for unions (Gunther Hagleitner via Ashutosh Chauhan) (Revision 1464248)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1464248
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_14.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_2.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_24.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_5.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_8.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_9.q.out
, Integrated in Hive-trunk-hadoop2 #138 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/138/])
    HIVE-4259 : SEL operator created with missing columnExprMap for unions (Gunther Hagleitner via Ashutosh Chauhan) (Revision 1464248)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1464248
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_14.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_2.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_24.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_5.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_8.q.out
* /hive/trunk/ql/src/test/results/clientpositive/union_remove_9.q.out
]