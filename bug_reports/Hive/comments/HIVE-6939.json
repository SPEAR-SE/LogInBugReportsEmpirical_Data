[It appears that on hadoop-2 there are multiple output files for this test, whereas on hadoop-1 there is just a single file.  Also the test looks like it assumes there is just a single file to compare to.
This test for some reason is specifying 5 reducers.  I've been told that hadoop-1 Hive did not obey the number of reducers, while hadoop-2 does.  This could explain why this test works for hadoop-1 since if it only ever used 1 reducer and generated a single output file.

Changing this test to use just a single reducer allows the test to pass with hadoop-2.  Does anyone know the history of this test and why it was set to use 5 reducers?, Patch changes test to use single reducer so that there is just a single output file., Description of test says " test reduce with multiple tagged inputs." so I dont think it has any specific intention for # of reducers = 5. So, # of reducers = 1, sounds good to me. +1, Committed to trunk., This has been fixed in 0.14 release. Please open new jira if you see any issues.
]