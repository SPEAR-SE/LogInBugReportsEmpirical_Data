[This patch includes the following changes:

  1) correctly pruning partitions based on the partition specification in ANALYZE TABLE command.
  2) adding a Hive.getPartitionsByNames() method to get a list of partitions based on their names. Previous we'll have to use Hive.getPartitions which get all partitions as Partition objects and then filter out partitions that doesn't satisfy spec. This is very expensive for tables with large number of partitions. This could be further improved by using the partition filtering pushdown feature once it is fully supported. 
  3) Caching the list of partitions in tableSpec so that StatsTask does not need to get the list of partitions again. 
  4) adding a explicit variable tableSpec to indicate its type (TABLE_ONLY, STATIC_PARTITION, DYNAMIC_PARTITION) rather than relying on implicit checking on partHandle. , @Paul, are you working on optimizing Hive.getPartitionsByNames() by using partition filtering ?
, +1, Committed. Thanks Ning]