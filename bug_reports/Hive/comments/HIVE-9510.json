[attach  LOG file , I moved this from CALCITE to HIVE because even though the error comes from Calcite code, it should be investigated as a Hive issue. The likely cause is that Hive did not set up its metadata provider correctly., Thanks! When i set org.apache.calcite.plan.RelOptPlanner.level=FINE ,  it could be executed correctly. So i  don't agree with you say.What do you think?, In Calcite, metadata providers are adapters. The Calcite engine will call into the adapter, provided in this case by Hive, to get extra information. In this case it only asks for extra information when you increase the logging level. Calcite is assuming Hive implemented its metadata provider correctly but I am guessing that it did not -- in which case, the error is in Hive code.]