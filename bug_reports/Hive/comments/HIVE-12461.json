[There are 2 problems that cause build failure.

1. HIVE-11180 incorrectly resolved conflicts in HiveConf which resulted in one of the config values introduced in HIVE-11587 to be removed.

The fix is to put the parameter back in HiveConf.

2. cancelDeleteOnExit() was implemented in HADOOP-8635 and is only available starting from 0.23.3. So, with hadoop-1 this method is not available.

The fix is to use hadoop shims. I decided to shim the operation "delete and cancel" instead of just "cancel", because having no-op "cancel" operation might be not what a user expects. However, together with "delete", "cancel" is more of an optimization., +1, [~xuefuz], do you know why Hive QA hasn't run tests for this patch for 3 days already?, No idea. I haven't seen test runs on branch-1 for a long time. If you can test locally that the build passes with hadoop-1/2, I think we can go ahead committing the patch., I've verified that build passes fine for me for branch-1 with -Phadoop-1 and -Phadoop-2., Patch committed to branch-1. Thanks, Aleksei!, No doc needed:  *hive.mapjoin.optimized.hashtable.probe.percent* will be documented for HIVE-11587.]