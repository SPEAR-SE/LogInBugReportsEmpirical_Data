[Attaching initial patch to get some feedback from Hive QA., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12862156/HIVE-16389.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 10577 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[drop_with_concurrency] (batchId=234)
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[escape_comments] (batchId=234)
org.apache.hive.jdbc.TestJdbcDriver2.testResultSetMetaData (batchId=220)
org.apache.hive.jdbc.TestJdbcDriver2.testSelectExecAsync2 (batchId=220)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testConnection (batchId=235)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testIsValid (batchId=235)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testIsValidNeg (batchId=235)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testNegativeProxyAuth (batchId=235)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testNegativeTokenAuth (batchId=235)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testProxyAuth (batchId=235)
org.apache.hive.minikdc.TestJdbcWithDBTokenStore.testTokenAuth (batchId=235)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4566/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4566/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4566/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 11 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12862156 - PreCommit-HIVE-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12862209/HIVE-16389.2.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 10579 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[drop_with_concurrency] (batchId=235)
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[escape_comments] (batchId=235)
org.apache.hive.jdbc.TestJdbcDriver2.testResultSetMetaData (batchId=221)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4579/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4579/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4579/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12862209 - PreCommit-HIVE-Build, The patch looks good. I left a few minor comments on the RB.
+1, Thanks [~spena]! Any chance you could re-publish the your comments? For some reason they aren't showing up for me, are they showing up for you? (https://reviews.apache.org/r/58236/)., done., Thanks [~spena] updated the RB. Before we merge this, could you also take a look at HIVE-16363 - it also touches the Hooks API. It has some refactoring of the tests that would make adding tests for this JIRA much easier., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12862581/HIVE-16389.3.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10561 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[drop_with_concurrency] (batchId=234)
org.apache.hadoop.hive.cli.TestBeeLineDriver.testCliDriver[escape_comments] (batchId=234)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=143)
org.apache.hive.jdbc.TestJdbcDriver2.testResultSetMetaData (batchId=221)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4618/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4618/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4618/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12862581 - PreCommit-HIVE-Build, [~stakiar] Can you re-submit the patch so it is tested with the changes on HIVE-16363?, [~spena] rebased the patch and added some more unit tests. Attached updated patch file and updated the RB., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12864553/HIVE-16389.5.patch

{color:green}SUCCESS:{color} +1 due to 2 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 10623 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_index] (batchId=226)
org.apache.hadoop.hive.cli.TestSparkNegativeCliDriver.org.apache.hadoop.hive.cli.TestSparkNegativeCliDriver (batchId=237)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4829/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4829/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4829/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12864553 - PreCommit-HIVE-Build, [~spena] could you take a look? Thanks., The patch looks good.
+1, [~stakiar] I committed to master now. Do you want this patch to branch-2 as well? If so, could you attach a new one to run tests on branch-2? If not, then you can close it., Thanks [~spena], we probably can just stick to master. Will close this., Hive 3.0.0 has been released so closing this jira.]