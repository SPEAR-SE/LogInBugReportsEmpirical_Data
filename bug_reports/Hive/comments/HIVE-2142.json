[Please correct the error message syntax as follows (since it is a user-facing message): 

"total number of created files now is " + numFiles + ", exceeds ").append(upperLimit);

should be changed to:

"total number of created files now is " + numFiles + ", which exceeds ").append(upperLimit);

Otherwise it looks fine. , opened follow up jira HIVE-2143 for testing., +1, Committed. Thanks Yongqiang!]