[I spent some time understanding the logic. Seems like we are only doing the token validation when the client connects to the metastore. After the client gets the token, it's free to talk to metastore, while the token could have expired. 

To fully solve the issue, similar to http request, we need to carry token for each request to the metastore, the metastore needs to validate the token before processing each request. If the token is expired, then the client should get notified and try to get a new token. If the token is near-expired (e.g., half-way of the token life time), then we should renew the token to expend to a full life time. 

Hope it makes sense.]