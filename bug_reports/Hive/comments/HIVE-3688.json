[The TestParseNegative and TestNegativeCliDriver tests are failing because of a difference in iterator ordering experienced by JDK7.

The TestNegativeCliDriver tests are failing because JDK7 breaks backward compatibility with XMLEncoder as per http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6882911, Attached branc 0.9 and trunk patches., Branch 0.9:
https://reviews.facebook.net/D6927
https://reviews.facebook.net/D6933

Trunk:
https://reviews.facebook.net/D6939
https://reviews.facebook.net/D6945

Had to split the patch into two parts to upload to phabricator.
, Chris,
Reviewing a 7MB patch is non-trivial. If it could be logically broken down in smaller patches, that will make things easier. I will suggest to break down the patch per three major areas as you have identified: 
Three types of failures: exception message is different, candidate method list ordering is different, backward incompatibility of XMLEncode causes different plan serialization., I'm not sure if generating different sets of output file is the best approach to address the issue. It can become unmanageable if the number of dimensions rises. Right now, we have jvm version, hadoop version, etc. Image down the road we have JDK8.

I would think it's better for hive to generate more deterministic result which doesn't vary with JVM version. For instance, we can order the output of "show grant" so that the set of the privileges returned doesn't vary in order(HIVE-4858)., Aggree on [~xuefuz], Hey guys, I haven't seen much progress on this. I plan on taking TestParse forward in HIVE-5064., [~brocknoland] that would be great. I'll remove the TestParse parts of this patch and resubmit for the TestNegativeCliDriver cases only. Thanks.]