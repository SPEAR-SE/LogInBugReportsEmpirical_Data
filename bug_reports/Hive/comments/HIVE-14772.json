[Verified the issue, issue occurs on release-2.1.0 branch . But unable to reproduce it on master branch. Will need to check what fixed this issue. , https://github.com/apache/hive/commit/ab605910e45cfa65b9895399f09194801f2cc091
Is this the solution that fixed the issue in master branch?, [~alunarbeach] Not really, the NPE is already worked around with a boolean before that commit. Ugly!

But using a set should probably remove the NPE so applying what you link to should do the trick I guess.]