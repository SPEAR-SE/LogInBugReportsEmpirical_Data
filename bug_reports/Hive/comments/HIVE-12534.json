[[~mmccline] fyi, HIve-12479 fixes the query mentioned in this bug. But it returned wrong results with another query involving date.. Will attach the plan shortly.  Setting "set hive.vectorized.execution.reduce.enabled=false;" / "set hive.vectorized.execution.enabled=false" fixes the problem, [~rajesh.balamohan] can you update this or file a new bug for that please?, [~sershe] - Attaching the explain plan for the query which failed (this was tried in llap).  Instead of completely turning off vectorization, setting "hive.vectorized.execution.mapjoin.native.fast.hashtable.enabled=false" helps in returning correct results. , There are a bunch of tests that include vectorization of the year and month functions in vectorized_date_funcs.q and that test passes with hive.vectorized.execution.mapjoin.native.fast.hashtable.enabled=false.

And with hive.vectorized.execution.mapjoin.native.fast.hashtable.enabled=true.

(Tests run on master)

I need a repro., Assigning to [~rajesh.balamohan], This is duplicated by HIVE-12479 and HIVE-12535]