[will take a look., can you move the new code out of the for loop? And also pls confirm that mysql has the same semantic here. Otherwise, we need to fix the underlying problem., Thanks Yongqiang. The patch just disables it by throws an exception when the case happens.
It is true that MySQL support such semantic, but MySQL also support other weird semantics like duplicated group by keys.  , Ted, how difficult do you think it is to fix the underlying problem? some ideas?, Thanks Yongqiang. I traced the problem again, and it turned out quit simple. The error was introduced by RowResolver not handled well in  ReduceSinkOperator.
Please review the patch again, thanks., +1

will commit after tests pass. Thanks Ted!, Ted, can you update your patch based on the trunk? (probably just need to regenerate some output files)
sorry, after 1517 committed, the patch can not be applied cleanly.]