[Since that fix effectively broke stats, can it be rolled back until a proper fix is made?, yes, im generating a roll-back patch, because we do (insert or overwrite)
so we can first delete all then insert all., because we do (insert or overwrite)
so we can first delete all then insert all., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12666101/HIVE-7944.1.patch

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 6142 tests executed
*Failed tests:*
{noformat}
org.apache.hive.service.TestHS2ImpersonationWithRemoteMS.testImpersonation
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/613/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/613/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-613/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12666101, [~pxiong] Have you tested this with mysql which has tables pre-created (not auto created via datanucleus)? I think there might be issues because in those cases csid & partid being null will prevent data from getting inserted in db. 
I think let just simply revert HIVE-7876 before we figure out proper fix for this., +1 for the revert idea, reverse the patch, reverse the patch, After I tested this with mysql which has tables pre-created (not auto created via datanucleus), I find that my method does not work. Thus, I followed the "revert idea"

https://reviews.apache.org/r/25281/, +1, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12666289/HIVE-7944.2.patch

{color:green}SUCCESS:{color} +1 6142 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/621/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/621/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-621/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12666289, Committed to trunk. Thanks, Pengcheng!, This has been fixed in 0.14 release. Please open new jira if you see any issues.
]