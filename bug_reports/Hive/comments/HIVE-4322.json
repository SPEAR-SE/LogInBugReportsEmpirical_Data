[[~sxyuan] Good write up. thank you for working on it., sxyuan requested code review of "HIVE-4322 [jira] SkewedInfo in Metastore Thrift API cannot be deserialized in Python".

Reviewers: gangtimliu

See JIRA for description.

TEST PLAN
  Ran both hadoop20 and hadoop23 tests.

REVISION DETAIL
  https://reviews.facebook.net/D10203

AFFECTED FILES
  service/src/gen/thrift/gen-php/hive_service
  service/src/gen/thrift/gen-php/hive_service/ThriftHive.php
  service/src/gen/thrift/gen-php/hive_service/hive_service_types.php
  metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
  metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java
  metastore/src/gen/thrift/gen-py/hive_metastore/ttypes.py
  metastore/src/gen/thrift/gen-cpp/hive_metastore_types.cpp
  metastore/src/gen/thrift/gen-cpp/hive_metastore_types.h
  metastore/src/gen/thrift/gen-rb/hive_metastore_types.rb
  metastore/src/gen/thrift/gen-php/hive_metastore_constants.php
  metastore/src/gen/thrift/gen-php/metastore/Types.php
  metastore/src/gen/thrift/gen-php/ThriftHiveMetastore.php
  metastore/src/gen/thrift/gen-php/hive_metastore_types.php
  metastore/src/gen/thrift/gen-php/hive_metastore
  metastore/src/gen/thrift/gen-php/hive_metastore/hive_metastore_constants.php
  metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php
  metastore/src/gen/thrift/gen-php/hive_metastore/hive_metastore_types.php
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SkewedInfo.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/EnvironmentContext.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SkewedValueList.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Schema.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/PrincipalPrivilegeSet.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Database.java
  metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java
  metastore/if/hive_metastore.thrift
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/listbucketingpruner/ListBucketingPruner.java
  ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java
  ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
  ql/src/java/org/apache/hadoop/hive/ql/metadata/formatting/MetaDataFormatUtils.java
  ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
  ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
  ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java
  ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
  ql/src/gen/thrift/gen-php/queryplan
  ql/src/gen/thrift/gen-php/queryplan/queryplan_types.php

MANAGE HERALD RULES
  https://reviews.facebook.net/herald/view/differential/

WHY DID I GET THIS EMAIL?
  https://reviews.facebook.net/herald/transcript/24381/

To: gangtimliu, sxyuan
Cc: kevinwilfong, JIRA
, +1 after test passes, gangtimliu has commented on the revision "HIVE-4322 [jira] SkewedInfo in Metastore Thrift API cannot be deserialized in Python".

  code lgtm.

  looking at hadoop 23 tests.

INLINE COMMENTS
  metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java:1127 what's difference in this line? thanks

REVISION DETAIL
  https://reviews.facebook.net/D10203

To: gangtimliu, sxyuan
Cc: kevinwilfong, JIRA
, sxyuan has commented on the revision "HIVE-4322 [jira] SkewedInfo in Metastore Thrift API cannot be deserialized in Python".

INLINE COMMENTS
  metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java:1127 Just fixed the name of the function.

REVISION DETAIL
  https://reviews.facebook.net/D10203

To: gangtimliu, sxyuan
Cc: kevinwilfong, JIRA
, gangtimliu has accepted the revision "HIVE-4322 [jira] SkewedInfo in Metastore Thrift API cannot be deserialized in Python".

  thanks

REVISION DETAIL
  https://reviews.facebook.net/D10203

BRANCH
  svn

ARCANIST PROJECT
  hive

To: gangtimliu, sxyuan
Cc: kevinwilfong, JIRA
, Committed. thank Samuel Yuan., Integrated in Hive-trunk-h0.21 #2062 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2062/])
    HIVE-4322: SkewedInfo in Metastore Thrift API cannot be deserialized in Python (Samuel Yuan via Gang Tim Liu) (Revision 1467491)

     Result = FAILURE
gangtimliu : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1467491
Files : 
* /hive/trunk/metastore/if/hive_metastore.thrift
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/hive_metastore_types.cpp
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/hive_metastore_types.h
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Database.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/EnvironmentContext.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/PrincipalPrivilegeSet.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Schema.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SkewedInfo.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SkewedValueList.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
* /hive/trunk/metastore/src/gen/thrift/gen-php/metastore/Types.php
* /hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ttypes.py
* /hive/trunk/metastore/src/gen/thrift/gen-rb/hive_metastore_types.rb
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java
* /hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/formatting/MetaDataFormatUtils.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/listbucketingpruner/ListBucketingPruner.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java
, Integrated in Hive-trunk-hadoop2 #157 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/157/])
    HIVE-4322: SkewedInfo in Metastore Thrift API cannot be deserialized in Python (Samuel Yuan via Gang Tim Liu) (Revision 1467491)

     Result = FAILURE
gangtimliu : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1467491
Files : 
* /hive/trunk/metastore/if/hive_metastore.thrift
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/hive_metastore_types.cpp
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/hive_metastore_types.h
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Database.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/EnvironmentContext.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Index.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/PrincipalPrivilegeSet.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Schema.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SkewedInfo.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SkewedValueList.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Table.java
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
* /hive/trunk/metastore/src/gen/thrift/gen-php/metastore/Types.php
* /hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ttypes.py
* /hive/trunk/metastore/src/gen/thrift/gen-rb/hive_metastore_types.rb
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java
* /hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/formatting/MetaDataFormatUtils.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/listbucketingpruner/ListBucketingPruner.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ListBucketingCtx.java
, This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.]