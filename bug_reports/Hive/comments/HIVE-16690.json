[Please help review, [~hagleitn], [~sseth], +1 pending tests. Does this work in a cluster?, Thanks [~sershe] for review! It works in a cluster. Later I'll submit additional patch combining HIVE-14731 and this one for jenkins., Upload addendum patch which avoids accessing uninitialized Llap cluster info (which cause NPE)., +1 for the addendum. If cross product does end up getting invoked, is it possible to log the configured value for parallelism? This can be in a follow up jira. Also, I think this clusterstate lookup is very avoidable if cross product is not invoked. Don't need to invoke the ZK registry for each query (even though it does cache records for 2 minutes)]