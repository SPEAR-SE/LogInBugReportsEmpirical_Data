[+1, [~rhbutani]
The correct plan is not getting generated, most likely because HIVE-8280 is not addressed yet.
item x store_sales should match the PK/FK pattern and currently PK returns selectivity of 1 due to issue mentioned in HIVE-8280.

{code}
2014-10-07 01:17:16,747 DEBUG [main]: parse.SemanticAnalyzer (SemanticAnalyzer.java:apply(12316)) - HiveSortRel(sort0=[$0], sort1=[$1], sort2=[$20], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 424827.22498719255, cumulative cost = {6.678648133048896E9 rows, 424827.22498719255 cpu, 0.0 io}, id = 1311
  HiveProjectRel(product_name=[$0], store_name=[$2], store_zip=[$3], b_street_number=[$4], b_streen_name=[$5], b_city=[$6], b_zip=[$7], c_street_number=[$8], c_street_name=[$9], c_city=[$10], c_zip=[$11], syear=[$12], cnt=[$13], s1=[$14], s2=[$15], s3=[$16], s11=[$22], s21=[$23], s31=[$24], syear1=[$20], cnt1=[$21]): rowcount = 424827.22498719255, cumulative cost = {6.216184283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1309
    HiveFilterRel(condition=[<=($21, $13)]): rowcount = 424827.22498719255, cumulative cost = {6.216184283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1307
      HiveProjectRel(product_name=[$0], item_sk=[$1], store_name=[$2], store_zip=[$3], b_street_number=[$4], b_streen_name=[$5], b_city=[$6], b_zip=[$7], c_street_number=[$8], c_street_name=[$9], c_city=[$10], c_zip=[$11], syear=[$12], cnt=[$13], s1=[$14], s2=[$15], s3=[$16], item_sk0=[$17], store_name0=[$18], store_zip0=[$19], syear0=[$20], cnt0=[$21], s10=[$22], s20=[$23], s30=[$24]): rowcount = 1274481.6749615776, cumulative cost = {6.216184283941706E9 rows, 0.0 cpu, 0.0 io}, id = 3711
        HiveJoinRel(condition=[AND(AND(=($1, $17), =($2, $18)), =($3, $19))], joinType=[inner]): rowcount = 1274481.6749615776, cumulative cost = {6.216184283941706E9 rows, 0.0 cpu, 0.0 io}, id = 3706
          HiveProjectRel(product_name=[$0], item_sk=[$1], store_name=[$2], store_zip=[$3], b_street_number=[$4], b_streen_name=[$5], b_city=[$6], b_zip=[$7], c_street_number=[$8], c_street_name=[$9], c_city=[$10], c_zip=[$11], syear=[$12], cnt=[$15], s1=[$16], s2=[$17], s3=[$18]): rowcount = 800000.0, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1209
            HiveAggregateRel(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}], agg#0=[count()], agg#1=[sum($15)], agg#2=[sum($16)], agg#3=[sum($17)]): rowcount = 800000.0, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1207
              HiveProjectRel($f0=[$53], $f1=[$50], $f2=[$27], $f3=[$28], $f4=[$39], $f5=[$40], $f6=[$41], $f7=[$42], $f8=[$44], $f9=[$45], $f10=[$46], $f11=[$47], $f12=[$21], $f13=[$23], $f14=[$25], $f15=[$8], $f16=[$9], $f17=[$10]): rowcount = 3.1094552702569574E8, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1205
                HiveProjectRel(ss_item_sk=[$0], ss_customer_sk=[$1], ss_cdemo_sk=[$2], ss_hdemo_sk=[$3], ss_addr_sk=[$4], ss_store_sk=[$5], ss_promo_sk=[$6], ss_ticket_number=[$7], ss_wholesale_cost=[$8], ss_list_price=[$9], ss_coupon_amt=[$10], ss_sold_date_sk=[$11], sr_item_sk=[$12], sr_ticket_number=[$13], c_customer_sk=[$14], c_current_cdemo_sk=[$15], c_current_hdemo_sk=[$16], c_current_addr_sk=[$17], c_first_shipto_date_sk=[$18], c_first_sales_date_sk=[$19], d_date_sk=[$20], d_year=[$21], d_date_sk0=[$22], d_year0=[$23], d_date_sk1=[$24], d_year1=[$25], s_store_sk=[$26], s_store_name=[$27], s_zip=[$28], cd_demo_sk=[$29], cd_marital_status=[$30], cd_demo_sk0=[$31], cd_marital_status0=[$32], p_promo_sk=[$37], hd_demo_sk=[$33], hd_income_band_sk=[$34], hd_demo_sk0=[$38], hd_income_band_sk0=[$39], ca_address_sk=[$45], ca_street_number=[$46], ca_street_name=[$47], ca_city=[$48], ca_zip=[$49], ca_address_sk0=[$50], ca_street_number0=[$51], ca_street_name0=[$52], ca_city0=[$53], ca_zip0=[$54], ib_income_band_sk=[$35], ib_income_band_sk0=[$40], i_item_sk=[$41], i_current_price=[$42], i_color=[$43], i_product_name=[$44], cs_item_sk=[$36]): rowcount = 3.1094552702569574E8, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 3704
                  HiveJoinRel(condition=[=($17, $50)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 3702
                    HiveJoinRel(condition=[=($4, $45)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {5.90283875691601E9 rows, 0.0 cpu, 0.0 io}, id = 3700
                      HiveJoinRel(condition=[=($0, $41)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {5.591093229890314E9 rows, 0.0 cpu, 0.0 io}, id = 3698
                        HiveJoinRel(condition=[=($16, $38)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {5.280147701864618E9 rows, 0.0 cpu, 0.0 io}, id = 3696
                          HiveJoinRel(condition=[=($6, $37)], joinType=[inner]): rowcount = 4.015947855294367E8, cumulative cost = {4.878545716335181E9 rows, 0.0 cpu, 0.0 io}, id = 3693
                            HiveJoinRel(condition=[=($0, $36)], joinType=[inner]): rowcount = 4.015947855294367E8, cumulative cost = {4.476950480805744E9 rows, 0.0 cpu, 0.0 io}, id = 3691
                              HiveJoinRel(condition=[=($3, $33)], joinType=[inner]): rowcount = 4.015947855294367E8, cumulative cost = {4.0753556942763076E9 rows, 0.0 cpu, 0.0 io}, id = 3689
                                HiveFilterRel(condition=[<>($30, $32)]): rowcount = 5.186708209219766E8, cumulative cost = {3.556677673354331E9 rows, 0.0 cpu, 0.0 io}, id = 1153
                                  HiveProjectRel(ss_item_sk=[$0], ss_customer_sk=[$1], ss_cdemo_sk=[$2], ss_hdemo_sk=[$3], ss_addr_sk=[$4], ss_store_sk=[$5], ss_promo_sk=[$6], ss_ticket_number=[$7], ss_wholesale_cost=[$8], ss_list_price=[$9], ss_coupon_amt=[$10], ss_sold_date_sk=[$11], sr_item_sk=[$31], sr_ticket_number=[$32], c_customer_sk=[$21], c_current_cdemo_sk=[$22], c_current_hdemo_sk=[$23], c_current_addr_sk=[$24], c_first_shipto_date_sk=[$25], c_first_sales_date_sk=[$26], d_date_sk=[$14], d_year=[$15], d_date_sk0=[$27], d_year0=[$28], d_date_sk1=[$29], d_year1=[$30], s_store_sk=[$16], s_store_name=[$17], s_zip=[$18], cd_demo_sk=[$12], cd_marital_status=[$13], cd_demo_sk0=[$19], cd_marital_status0=[$20]): rowcount = 3.6306957464538364E9, cumulative cost = {3.556677673354331E9 rows, 0.0 cpu, 0.0 io}, id = 2300
                                    HiveJoinRel(condition=[AND(=($0, $31), =($7, $32))], joinType=[inner]): rowcount = 3.6306957464538364E9, cumulative cost = {3.556677673354331E9 rows, 0.0 cpu, 0.0 io}, id = 2298
                                      HiveJoinRel(condition=[=($1, $21)], joinType=[inner]): rowcount = 1.297271788131117E9, cumulative cost = {2.203827880223214E9 rows, 0.0 cpu, 0.0 io}, id = 2296
                                        HiveJoinRel(condition=[=($5, $16)], joinType=[inner]): rowcount = 5.50076554E8, cumulative cost = {1.6521513262232141E9 rows, 0.0 cpu, 0.0 io}, id = 2289
                                          HiveJoinRel(condition=[=($11, $14)], joinType=[inner]): rowcount = 5.50076554E8, cumulative cost = {1.1020745602232141E9 rows, 0.0 cpu, 0.0 io}, id = 2287
                                            HiveJoinRel(condition=[=($2, $12)], joinType=[inner]): rowcount = 5.50076554E8, cumulative cost = {5.51997354E8 rows, 0.0 cpu, 0.0 io}, id = 1877
                                              HiveProjectRel(ss_item_sk=[$1], ss_customer_sk=[$2], ss_cdemo_sk=[$3], ss_hdemo_sk=[$4], ss_addr_sk=[$5], ss_store_sk=[$6], ss_promo_sk=[$7], ss_ticket_number=[$8], ss_wholesale_cost=[$10], ss_list_price=[$11], ss_coupon_amt=[$18], ss_sold_date_sk=[$22]): rowcount = 5.50076554E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 909
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.store_sales]]): rowcount = 5.50076554E8, cumulative cost = {0}, id = 55
                                              HiveProjectRel(cd_demo_sk=[$0], cd_marital_status=[$2]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1239
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_demographics]]): rowcount = 1920800.0, cumulative cost = {0}, id = 56
                                            HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 652.2232142857142, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1129
                                              HiveFilterRel(condition=[=($6, 2000)]): rowcount = 652.2232142857142, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1127
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 65
                                          HiveProjectRel(s_store_sk=[$0], s_store_name=[$5], s_zip=[$25]): rowcount = 212.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1235
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.store]]): rowcount = 212.0, cumulative cost = {0}, id = 54
                                        HiveJoinRel(condition=[=($6, $10)], joinType=[inner]): rowcount = 1600000.0, cumulative cost = {6866898.0 rows, 0.0 cpu, 0.0 io}, id = 2294
                                          HiveJoinRel(condition=[=($7, $8)], joinType=[inner]): rowcount = 1600000.0, cumulative cost = {5193849.0 rows, 0.0 cpu, 0.0 io}, id = 2292
                                            HiveJoinRel(condition=[=($3, $0)], joinType=[inner]): rowcount = 1600000.0, cumulative cost = {3520800.0 rows, 0.0 cpu, 0.0 io}, id = 1886
                                              HiveProjectRel(cd_demo_sk=[$0], cd_marital_status=[$2]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1239
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_demographics]]): rowcount = 1920800.0, cumulative cost = {0}, id = 56
                                              HiveProjectRel(c_customer_sk=[$0], c_current_cdemo_sk=[$2], c_current_hdemo_sk=[$3], c_current_addr_sk=[$4], c_first_shipto_date_sk=[$5], c_first_sales_date_sk=[$6]): rowcount = 1600000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1217
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer]]): rowcount = 1600000.0, cumulative cost = {0}, id = 59
                                            HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1227
                                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 65
                                          HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1227
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 65
                                      HiveProjectRel(sr_item_sk=[$1], sr_ticket_number=[$8]): rowcount = 5.5578005E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 912
                                        HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.store_returns]]): rowcount = 5.5578005E7, cumulative cost = {0}, id = 62
                                HiveJoinRel(condition=[=($1, $2)], joinType=[inner]): rowcount = 7200.0, cumulative cost = {7220.0 rows, 0.0 cpu, 0.0 io}, id = 3424
                                  HiveProjectRel(hd_demo_sk=[$0], hd_income_band_sk=[$1]): rowcount = 7200.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1253
                                    HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 53
                                  HiveProjectRel(ib_income_band_sk=[$0]): rowcount = 20.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1269
                                    HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.income_band]]): rowcount = 20.0, cumulative cost = {0}, id = 63
                              HiveProjectRel(cs_item_sk=[$0]): rowcount = 1.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1201
                                HiveFilterRel(condition=[>($1, *(CAST(2):DOUBLE NOT NULL, $2))]): rowcount = 1.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1199
                                  HiveAggregateRel(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 38846.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1197
                                    HiveProjectRel($f0=[$0], $f1=[$2], $f2=[+(+($5, $6), $7)]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1195
                                      HiveProjectRel(cs_item_sk=[$0], cs_order_number=[$1], cs_ext_list_price=[$2], cr_item_sk=[$3], cr_order_number=[$4], cr_refunded_cash=[$5], cr_reversed_charge=[$6], cr_store_credit=[$7]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1446
                                        HiveJoinRel(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1441
                                          HiveProjectRel(cs_item_sk=[$14], cs_order_number=[$16], cs_ext_list_price=[$24]): rowcount = 2.86549727E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1283
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.catalog_sales]]): rowcount = 2.86549727E8, cumulative cost = {0}, id = 45
                                          HiveProjectRel(cr_item_sk=[$1], cr_order_number=[$15], cr_refunded_cash=[$22], cr_reversed_charge=[$23], cr_store_credit=[$24]): rowcount = 2.8798881E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1285
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.catalog_returns]]): rowcount = 2.8798881E7, cumulative cost = {0}, id = 46
                            HiveProjectRel(p_promo_sk=[$0]): rowcount = 450.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1249
                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.promotion]]): rowcount = 450.0, cumulative cost = {0}, id = 58
                          HiveJoinRel(condition=[=($1, $2)], joinType=[inner]): rowcount = 7200.0, cumulative cost = {7220.0 rows, 0.0 cpu, 0.0 io}, id = 3480
                            HiveProjectRel(hd_demo_sk=[$0], hd_income_band_sk=[$1]): rowcount = 7200.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1253
                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 53
                            HiveProjectRel(ib_income_band_sk=[$0]): rowcount = 20.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1269
                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.income_band]]): rowcount = 20.0, cumulative cost = {0}, id = 63
                        HiveProjectRel(i_item_sk=[$0], i_current_price=[$5], i_color=[$17], i_product_name=[$21]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1185
                          HiveFilterRel(condition=[AND(in($17, 'maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate'), between(false, $5, 35, +(35, 10)), between(false, $5, +(35, 1), +(35, 15)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1183
                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.item]]): rowcount = 48000.0, cumulative cost = {0}, id = 68
                      HiveProjectRel(ca_address_sk=[$0], ca_street_number=[$2], ca_street_name=[$3], ca_city=[$6], ca_zip=[$9]): rowcount = 800000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1261
                        HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_address]]): rowcount = 800000.0, cumulative cost = {0}, id = 61
                    HiveProjectRel(ca_address_sk=[$0], ca_street_number=[$2], ca_street_name=[$3], ca_city=[$6], ca_zip=[$9]): rowcount = 800000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1261
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_address]]): rowcount = 800000.0, cumulative cost = {0}, id = 61
          HiveProjectRel(item_sk=[$1], store_name=[$2], store_zip=[$3], syear=[$12], cnt=[$15], s1=[$16], s2=[$17], s3=[$18]): rowcount = 800000.0, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1303
            HiveAggregateRel(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}], agg#0=[count()], agg#1=[sum($15)], agg#2=[sum($16)], agg#3=[sum($17)]): rowcount = 800000.0, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1301
              HiveProjectRel($f0=[$53], $f1=[$50], $f2=[$27], $f3=[$28], $f4=[$39], $f5=[$40], $f6=[$41], $f7=[$42], $f8=[$44], $f9=[$45], $f10=[$46], $f11=[$47], $f12=[$21], $f13=[$23], $f14=[$25], $f15=[$8], $f16=[$9], $f17=[$10]): rowcount = 3.1094552702569574E8, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 1299
                HiveProjectRel(ss_item_sk=[$0], ss_customer_sk=[$1], ss_cdemo_sk=[$2], ss_hdemo_sk=[$3], ss_addr_sk=[$4], ss_store_sk=[$5], ss_promo_sk=[$6], ss_ticket_number=[$7], ss_wholesale_cost=[$8], ss_list_price=[$9], ss_coupon_amt=[$10], ss_sold_date_sk=[$11], sr_item_sk=[$12], sr_ticket_number=[$13], c_customer_sk=[$14], c_current_cdemo_sk=[$15], c_current_hdemo_sk=[$16], c_current_addr_sk=[$17], c_first_shipto_date_sk=[$18], c_first_sales_date_sk=[$19], d_date_sk=[$20], d_year=[$21], d_date_sk0=[$22], d_year0=[$23], d_date_sk1=[$24], d_year1=[$25], s_store_sk=[$26], s_store_name=[$27], s_zip=[$28], cd_demo_sk=[$29], cd_marital_status=[$30], cd_demo_sk0=[$31], cd_marital_status0=[$32], p_promo_sk=[$37], hd_demo_sk=[$33], hd_income_band_sk=[$34], hd_demo_sk0=[$38], hd_income_band_sk0=[$39], ca_address_sk=[$45], ca_street_number=[$46], ca_street_name=[$47], ca_city=[$48], ca_zip=[$49], ca_address_sk0=[$50], ca_street_number0=[$51], ca_street_name0=[$52], ca_city0=[$53], ca_zip0=[$54], ib_income_band_sk=[$35], ib_income_band_sk0=[$40], i_item_sk=[$41], i_current_price=[$42], i_color=[$43], i_product_name=[$44], cs_item_sk=[$36]): rowcount = 3.1094552702569574E8, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 3002
                  HiveJoinRel(condition=[=($17, $50)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {6.214584283941706E9 rows, 0.0 cpu, 0.0 io}, id = 3000
                    HiveJoinRel(condition=[=($4, $45)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {5.90283875691601E9 rows, 0.0 cpu, 0.0 io}, id = 2998
                      HiveJoinRel(condition=[=($0, $41)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {5.591093229890314E9 rows, 0.0 cpu, 0.0 io}, id = 2996
                        HiveJoinRel(condition=[=($16, $38)], joinType=[inner]): rowcount = 3.1094552702569574E8, cumulative cost = {5.280147701864618E9 rows, 0.0 cpu, 0.0 io}, id = 2994
                          HiveJoinRel(condition=[=($6, $37)], joinType=[inner]): rowcount = 4.015947855294367E8, cumulative cost = {4.878545716335181E9 rows, 0.0 cpu, 0.0 io}, id = 2991
                            HiveJoinRel(condition=[=($0, $36)], joinType=[inner]): rowcount = 4.015947855294367E8, cumulative cost = {4.476950480805744E9 rows, 0.0 cpu, 0.0 io}, id = 2989
                              HiveJoinRel(condition=[=($3, $33)], joinType=[inner]): rowcount = 4.015947855294367E8, cumulative cost = {4.0753556942763076E9 rows, 0.0 cpu, 0.0 io}, id = 2987
                                HiveFilterRel(condition=[<>($30, $32)]): rowcount = 5.186708209219766E8, cumulative cost = {3.556677673354331E9 rows, 0.0 cpu, 0.0 io}, id = 1247
                                  HiveProjectRel(ss_item_sk=[$0], ss_customer_sk=[$1], ss_cdemo_sk=[$2], ss_hdemo_sk=[$3], ss_addr_sk=[$4], ss_store_sk=[$5], ss_promo_sk=[$6], ss_ticket_number=[$7], ss_wholesale_cost=[$8], ss_list_price=[$9], ss_coupon_amt=[$10], ss_sold_date_sk=[$11], sr_item_sk=[$31], sr_ticket_number=[$32], c_customer_sk=[$21], c_current_cdemo_sk=[$22], c_current_hdemo_sk=[$23], c_current_addr_sk=[$24], c_first_shipto_date_sk=[$25], c_first_sales_date_sk=[$26], d_date_sk=[$14], d_year=[$15], d_date_sk0=[$27], d_year0=[$28], d_date_sk1=[$29], d_year1=[$30], s_store_sk=[$16], s_store_name=[$17], s_zip=[$18], cd_demo_sk=[$12], cd_marital_status=[$13], cd_demo_sk0=[$19], cd_marital_status0=[$20]): rowcount = 3.6306957464538364E9, cumulative cost = {3.556677673354331E9 rows, 0.0 cpu, 0.0 io}, id = 1873
                                    HiveJoinRel(condition=[AND(=($0, $31), =($7, $32))], joinType=[inner]): rowcount = 3.6306957464538364E9, cumulative cost = {3.556677673354331E9 rows, 0.0 cpu, 0.0 io}, id = 1871
                                      HiveJoinRel(condition=[=($1, $21)], joinType=[inner]): rowcount = 1.297271788131117E9, cumulative cost = {2.203827880223214E9 rows, 0.0 cpu, 0.0 io}, id = 1869
                                        HiveJoinRel(condition=[=($5, $16)], joinType=[inner]): rowcount = 5.50076554E8, cumulative cost = {1.6521513262232141E9 rows, 0.0 cpu, 0.0 io}, id = 1862
                                          HiveJoinRel(condition=[=($11, $14)], joinType=[inner]): rowcount = 5.50076554E8, cumulative cost = {1.1020745602232141E9 rows, 0.0 cpu, 0.0 io}, id = 1860
                                            HiveJoinRel(condition=[=($2, $12)], joinType=[inner]): rowcount = 5.50076554E8, cumulative cost = {5.51997354E8 rows, 0.0 cpu, 0.0 io}, id = 1450
                                              HiveProjectRel(ss_item_sk=[$1], ss_customer_sk=[$2], ss_cdemo_sk=[$3], ss_hdemo_sk=[$4], ss_addr_sk=[$5], ss_store_sk=[$6], ss_promo_sk=[$7], ss_ticket_number=[$8], ss_wholesale_cost=[$10], ss_list_price=[$11], ss_coupon_amt=[$18], ss_sold_date_sk=[$22]): rowcount = 5.50076554E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 909
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.store_sales]]): rowcount = 5.50076554E8, cumulative cost = {0}, id = 55
                                              HiveProjectRel(cd_demo_sk=[$0], cd_marital_status=[$2]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1239
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_demographics]]): rowcount = 1920800.0, cumulative cost = {0}, id = 56
                                            HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 652.2232142857142, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1223
                                              HiveFilterRel(condition=[=($6, +(2000, 1))]): rowcount = 652.2232142857142, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1221
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 65
                                          HiveProjectRel(s_store_sk=[$0], s_store_name=[$5], s_zip=[$25]): rowcount = 212.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1235
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.store]]): rowcount = 212.0, cumulative cost = {0}, id = 54
                                        HiveJoinRel(condition=[=($6, $10)], joinType=[inner]): rowcount = 1600000.0, cumulative cost = {6866898.0 rows, 0.0 cpu, 0.0 io}, id = 1867
                                          HiveJoinRel(condition=[=($7, $8)], joinType=[inner]): rowcount = 1600000.0, cumulative cost = {5193849.0 rows, 0.0 cpu, 0.0 io}, id = 1865
                                            HiveJoinRel(condition=[=($3, $0)], joinType=[inner]): rowcount = 1600000.0, cumulative cost = {3520800.0 rows, 0.0 cpu, 0.0 io}, id = 1459
                                              HiveProjectRel(cd_demo_sk=[$0], cd_marital_status=[$2]): rowcount = 1920800.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1239
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_demographics]]): rowcount = 1920800.0, cumulative cost = {0}, id = 56
                                              HiveProjectRel(c_customer_sk=[$0], c_current_cdemo_sk=[$2], c_current_hdemo_sk=[$3], c_current_addr_sk=[$4], c_first_shipto_date_sk=[$5], c_first_sales_date_sk=[$6]): rowcount = 1600000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1217
                                                HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer]]): rowcount = 1600000.0, cumulative cost = {0}, id = 59
                                            HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1227
                                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 65
                                          HiveProjectRel(d_date_sk=[$0], d_year=[$6]): rowcount = 73049.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1227
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 65
                                      HiveProjectRel(sr_item_sk=[$1], sr_ticket_number=[$8]): rowcount = 5.5578005E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 912
                                        HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.store_returns]]): rowcount = 5.5578005E7, cumulative cost = {0}, id = 62
                                HiveJoinRel(condition=[=($1, $2)], joinType=[inner]): rowcount = 7200.0, cumulative cost = {7220.0 rows, 0.0 cpu, 0.0 io}, id = 2722
                                  HiveProjectRel(hd_demo_sk=[$0], hd_income_band_sk=[$1]): rowcount = 7200.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1253
                                    HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 53
                                  HiveProjectRel(ib_income_band_sk=[$0]): rowcount = 20.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1269
                                    HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.income_band]]): rowcount = 20.0, cumulative cost = {0}, id = 63
                              HiveProjectRel(cs_item_sk=[$0]): rowcount = 1.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1295
                                HiveFilterRel(condition=[>($1, *(CAST(2):DOUBLE NOT NULL, $2))]): rowcount = 1.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1293
                                  HiveAggregateRel(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)]): rowcount = 38846.0, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1291
                                    HiveProjectRel($f0=[$0], $f1=[$2], $f2=[+(+($5, $6), $7)]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1289
                                      HiveProjectRel(cs_item_sk=[$0], cs_order_number=[$1], cs_ext_list_price=[$2], cr_item_sk=[$3], cr_order_number=[$4], cr_refunded_cash=[$5], cr_reversed_charge=[$6], cr_store_credit=[$7]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1439
                                        HiveJoinRel(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner]): rowcount = 6.692553251460564E8, cumulative cost = {3.15348608E8 rows, 0.0 cpu, 0.0 io}, id = 1434
                                          HiveProjectRel(cs_item_sk=[$14], cs_order_number=[$16], cs_ext_list_price=[$24]): rowcount = 2.86549727E8, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1283
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.catalog_sales]]): rowcount = 2.86549727E8, cumulative cost = {0}, id = 45
                                          HiveProjectRel(cr_item_sk=[$1], cr_order_number=[$15], cr_refunded_cash=[$22], cr_reversed_charge=[$23], cr_store_credit=[$24]): rowcount = 2.8798881E7, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1285
                                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.catalog_returns]]): rowcount = 2.8798881E7, cumulative cost = {0}, id = 46
                            HiveProjectRel(p_promo_sk=[$0]): rowcount = 450.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1249
                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.promotion]]): rowcount = 450.0, cumulative cost = {0}, id = 58
                          HiveJoinRel(condition=[=($1, $2)], joinType=[inner]): rowcount = 7200.0, cumulative cost = {7220.0 rows, 0.0 cpu, 0.0 io}, id = 2778
                            HiveProjectRel(hd_demo_sk=[$0], hd_income_band_sk=[$1]): rowcount = 7200.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1253
                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 53
                            HiveProjectRel(ib_income_band_sk=[$0]): rowcount = 20.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1269
                              HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.income_band]]): rowcount = 20.0, cumulative cost = {0}, id = 63
                        HiveProjectRel(i_item_sk=[$0], i_current_price=[$5], i_color=[$17], i_product_name=[$21]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1279
                          HiveFilterRel(condition=[AND(in($17, 'maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate'), between(false, $5, 35, +(35, 10)), between(false, $5, +(35, 1), +(35, 15)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1277
                            HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.item]]): rowcount = 48000.0, cumulative cost = {0}, id = 68
                      HiveProjectRel(ca_address_sk=[$0], ca_street_number=[$2], ca_street_name=[$3], ca_city=[$6], ca_zip=[$9]): rowcount = 800000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1261
                        HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_address]]): rowcount = 800000.0, cumulative cost = {0}, id = 61
                    HiveProjectRel(ca_address_sk=[$0], ca_street_number=[$2], ca_street_name=[$3], ca_city=[$6], ca_zip=[$9]): rowcount = 800000.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1261
                      HiveTableScanRel(table=[[tpcds_bin_partitioned_orc_200_orig.customer_address]]): rowcount = 800000.0, cumulative cost = {0}, id = 61
{code}, Patch fixes the issue.
+1, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12673249/HIVE-8315.1.patch

{color:green}SUCCESS:{color} +1 6528 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1150/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1150/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1150/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12673249, Committed to trunk. Thanks, Harish!
[~vikram.dixit] it will be good to have this in 0.14 as well., +1 for 0.14, Committed to 0.14, This has been fixed in 0.14 release. Please open new jira if you see any issues.
]