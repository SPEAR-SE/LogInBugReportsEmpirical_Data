[For now, just fail better (and later) - long capacity was really still bounded to integer, causing not-power-of-2 error during overflow.

We should consider expanding hashtable to multiple arrays., [~wzheng] can you take a look? Thanks, Actually nm, not resizing will not merely make it fail, it will make it extremely slow as load factor approaches 1. It's better to fail., A better patch, +1 for failing early, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12854085/HIVE-16012.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 10254 tests executed
*Failed tests:*
{noformat}
TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3711/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3711/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3711/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12854085 - PreCommit-HIVE-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12854085/HIVE-16012.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 10254 tests executed
*Failed tests:*
{noformat}
TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
org.apache.hive.beeline.TestBeeLineWithArgs.testQueryProgress (batchId=211)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3716/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3716/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3716/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12854085 - PreCommit-HIVE-Build, Committed to master after also adding the mention of dynamic hash join to the error message (that was the problem in the original query we saw this in), Thanks for the review!]