[I have a patch for this which is almost complete. Only the configuration variable that enables/disables the feature is not working fine. I'm attaching the patch in case someone wants to take it up.
https://reviews.facebook.net/D4479, https://reviews.facebook.net/D4491, Should be reviewed after https://issues.apache.org/jira/browse/HIVE-3074]