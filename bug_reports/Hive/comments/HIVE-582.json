[It seems that the wrong plan is generated when setting hive.map.aggr=false, and the reduce output nothing(because of the column pruning). Reducer got nothing, so the exception occured., looks good , Committed. Thanks Yongqiang]