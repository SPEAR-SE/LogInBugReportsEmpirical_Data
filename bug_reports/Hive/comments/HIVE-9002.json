[3 candidate ways to fix it
(1) fix that within HiveParser.g
(2) fix that in QB by rewriting
(3) partially reverse the patch of https://issues.apache.org/jira/browse/HIVE-6189 and use subqueries for union all

[~jpullokkaran], could you please take a look? , resolved in HIVE-9039, This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]