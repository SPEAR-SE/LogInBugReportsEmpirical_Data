[This will block HIVE-9039. [~jpullokkaran] and [~vikram.dixit], could you please take a look? The error remains in the most recent trunk (that is, after HIVE-9055 is checked in)., There is no error when it is run on MR., And, the following queries got no error when they are run on Tez:

SELECT key, value FROM(

      SELECT key, value FROM src

        UNION ALL

      SELECT key, value FROM src

      )t1 group by  key, value;
      
SELECT distinct key FROM (

      SELECT key, value FROM(

      SELECT key, value FROM src

        UNION ALL

      SELECT key, value FROM src

      )t1 group by  key, value)t2;, [~pxiong] I was able to run the query you mentioned above only getting a diff in the result. Can you try again with the latest changes and see it it works?, Quick shot., Thanks [~navis]. I also tested the patch with other test cases and it works so far so good. , 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12687926/HIVE-9141.1.patch.txt

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 6714 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_schemeAuthority
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2121/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2121/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2121/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12687926 - PreCommit-HIVE-TRUNK-Build, [~navis] Nice patch. Simplifies the code as well. However, it looks like with this change, the followingWork can never be a union work because of moving the code. Do you see any way followingWork can be union work? I think we can remove that piece of the code as well as remove the getFollowingWorkIndex method as well. Thoughts?, +1 This also fixes {{optimize_nullscan.q}} breakage introduced by HIVE-9055, Committed to trunk. Thanks, Navis!
[~vikram.dixit] I have committed this since this one was also blocking HIVE-9106 in addition to resulting a breakage of test. If there is a way to improve on patch we can take that up on follow-on., [~vikram.dixit] My patch was just a quick shot (as I stated submitting the patch) thinking that parents of root should reference the work of root operator instead of currently evolving work. As it's committed already, you can try that in following issue. Frankly, I don't know well on tez compiling., Should we include this in hive 0.14.1 ?
cc [~vikram.dixit]
, Updating release version for jiras resolved in 1.0.0 .
, This issue has been fixed in Apache Hive 1.0.0. If there is any issue with the fix, please open a new jira to address it.
]