[CREATE EXTERNAL TABLE does not require the user to specify a LOCATION clause:

{code}
hive> CREATE EXTERNAL TABLE ext(a INT);
OK
hive> DESCRIBE FORMATTED ext;
...                	 
Location:           	file:/user/hive/warehouse/ext	 <--- NOT GOOD
Table Type:         	EXTERNAL_TABLE      	 
hive> 
{code}

We should make the following changes:
* Require the user to specify a valid LOCATION clause for CREATE EXTERNAL TABLE statements.
* Throw an error if the user specifies a LOCATION that is a subdirectory of hive.metastore.warehouse.dir, Implementing the above changes seems to break TestHBaseCliDriver_hbase_queries.q
Some EXTERNAL tables are created in that test but they throw an error if I try to specify a LOCATION.

Any thoughts?, Non-native external tables (such as HBase tables) should neither require nor allow a LOCATION clause., initial patch, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/1444/
-----------------------------------------------------------

Review request for John Sichi and Carl Steinbach.


Summary
-------

-Require the user to specify a valid LOCATION clause for CREATE EXTERNAL TABLE statements (except non-native tables).
-Throw an error if the user specifies a LOCATION that is a subdirectory of hive.metastore.warehouse.dir


This addresses bug hive-2310.
    https://issues.apache.org/jira/browse/hive-2310


Diffs
-----

  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java 1155176 
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1155176 
  trunk/ql/src/test/queries/clientnegative/create_external.q PRE-CREATION 
  trunk/ql/src/test/queries/clientnegative/external2.q 1155176 
  trunk/ql/src/test/queries/clientpositive/alter2.q 1155176 
  trunk/ql/src/test/queries/clientpositive/create_like.q 1155176 
  trunk/ql/src/test/queries/clientpositive/create_like_view.q 1155176 
  trunk/ql/src/test/results/clientnegative/create_external.q.out PRE-CREATION 
  trunk/ql/src/test/results/clientnegative/external2.q.out 1155176 
  trunk/ql/src/test/results/clientpositive/alter2.q.out 1155176 
  trunk/ql/src/test/results/clientpositive/create_like.q.out 1155176 
  trunk/ql/src/test/results/clientpositive/create_like_view.q.out 1155176 

Diff: https://reviews.apache.org/r/1444/diff


Testing
-------

unit tests pass


Thanks,

Franklin

, What about following:
{code}
create table mytbl (a string) location '/tmp/tbl';
{code}

Is it fine to allow location for a table without it being 'external' ? I think semantics should be if you want to specify location then table must be external.
, @Ashutosh, HIVE-109 deals with restricting location only to external tables., @Franklin: Looks like the patch has gone stale. If you rebase it I will take a look. Thanks., Rebase since patch was stale]