[Is hive.merge.mapfiles=true? If so the second merge job should be fired. Am I missing something?, Ended Job = 450290112, job is filtered out (removed at runtime).

the second job seems be filtered out at runtime, I'm confused. Do you mean the second job should not be started or the second job should not be filtered out? I've tested the behaviors before and after HIVE-1307, and they are the same and always fires the merge job. , @Ning, there should be no merge job for insert directory, we only used to merge for inserting into tables and partitions before, @namit, merging happens even before HIVE-1307. There does not seems to exist a unit test for this feature -- no merge for inserting to directory). BTW, what's the rationale behind this? , Taked to Namit and Yongqiang, this is not a bug. INSERT OVERWRITE to (HDFS) directory should be merged as before. INSERT OVERWRITE LOCAL DIRECTORY cannot be merged and this is not the case. ]