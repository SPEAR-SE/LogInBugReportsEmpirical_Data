[[~ashutoshc] can you please checkout this bug., This will work in container mode, but may not in llap mode with long running process. There we may need to keep track of lifecycle of the file., [~ashutoshc] i am not sure i am getting this, is it the delete on exit that won't work ? , deleteOnExit() is called when process exists. For container mode, process will terminate immediately and clean up will happen. For llap, process won't exit once RecordWriter is done, since its long running process waiting to execute next query. So, clean up wont happen until llap deamon goes down, which likely is not useful., [~ashutoshc] please checkout the new fix. The delete is done on the close call., I am not sure if we package apache-commons-io in druid handler jar. If not, we probably dont want to add a dependency on it just for this minor convenience method.
Other than that, looks good., [~ashutoshc] valid point but hive common is using that method as well so i think it is ok to use it.
https://github.com/b-slim/hive/blob/38ad77929980dc155dcc4a5d009a9a855eb5b017/common/src/java/org/apache/hadoop/hive/common/FileUtils.java#L755-L755
, I checked commons-io is not packaged with hive-exec so it wont be available on task nodes. All callers of FileUtils in hive-common are in front end, so it wont be an issue for it. But if we add it here, we will need commons-io jar on task nodes., +1 seems like we commons-io indeed is available., [~bslim] Would you like to make it Patch Available so we get a QA run., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12853996/HIVE-15951.2.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 10258 tests executed
*Failed tests:*
{noformat}
TestDerbyConnector - did not produce a TEST-*.xml file (likely timed out) (batchId=235)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3747/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3747/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3747/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12853996 - PreCommit-HIVE-Build, Pushed to master. Thanks, Slim!]