[what happens in the test

./ql/src/test/queries/clientpositive/union.q

the seems to have the same general pattern as the reported query...
, The test runs in a different mode I think. I remember the output file names of the tests looks different from what the file names are from the jobs on the cluster., Needed for the first release.
, This will be fixed as part of https://issues.apache.org/jira/browse/HIVE-318]