[Suggested patch that also checks if user requires SASL ]