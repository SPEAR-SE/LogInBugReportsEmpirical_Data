[hive strip spaces for char(lengh) type,  and then store value to parquet.  Other parquet reader may read striped value which is different from original.

   public void write(Object value) {
      String v = inspector.getPrimitiveJavaObject(value).getStrippedValue();
      recordConsumer.addBinary(Binary.fromString(v));
    }

[~Ferd], do you think this is a valid case? Shouldn't it store the real value? , In ConvertAstToSeachArg.java we can find that Hive is using padding string of HiveChar as Search argument, while in parquet DataWritableWriter it stripes HiveChar spaces, and thus lead to search failed.  Actually hive should not strip tail spaces for parquet since parquet could do encoding, such as RLE, to deal with this. So update to using padding value.

[~Ferd], please take a look on this., Thanks [~junjie] for reaching me about this. Why do we still need to pad the string? Should we save as its original format instead of either stripping or padding?, Thanks [~Ferd] to response so quickly.

It depends on how HiveChar defined and used in other place or other format, Hive should have unified usage on HiveChar.  According to HiveChar/HiveCharWritable definition in HiveChar/HiveCharWriable.java as below:
/**
 * HiveChar.
 * String values will be padded to full char length.
 * Character legnth, comparison, hashCode should ignore trailing spaces.
 */

We can know the original value of HiveChar should include padding spaces. So in ConvertAstToSearchArg.java#boxLiteral return padding value.
, GitHub user cjjnjust opened a pull request:

    https://github.com/apache/hive/pull/383

    HIVE-17593: DataWritableWriter strip spaces for CHAR type which causeâ€¦

    Parquet DataWritableWriter strip tailing spaces for HiveChar type, which cause predicate push down failed to work due to ConvertAstToSearchArg constructs predicate with tailing space.  Actually, according to HiveChar definition, it should contains padded value. ParquetOutputFormat can handle tailing spaces through encoding. 

You can merge this pull request into a Git repository by running:

    $ git pull https://github.com/cjjnjust/hive HIVE-17593

Alternatively you can review and apply these changes as the patch at:

    https://github.com/apache/hive/pull/383.patch

To close this pull request, make a commit to your master/trunk branch
with (at least) the following in the commit message:

    This closes #383
    
----
commit 03230c732d657706c6a95f90e16ed5c81d411af7
Author: Chen, Junjie <cjjnjust@...>
Date:   2018-06-29T23:32:52Z

    HIVE-17593: DataWritableWriter strip spaces for CHAR type which cause PPD not work

----
, | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
|| || || || {color:brown} master Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 23s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  1s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 37s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  3m 47s{color} | {color:blue} ql in master has 2287 extant Findbugs warnings. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 54s{color} | {color:green} master passed {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 23s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  3m 55s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 52s{color} | {color:green} the patch passed {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 12s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 22m  7s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |
| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12297/dev-support/hive-personality.sh |
| git revision | master / 1c33fea |
| Default Java | 1.8.0_111 |
| findbugs | v3.0.0 |
| modules | C: ql U: ql |
| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12297/yetus.txt |
| Powered by | Apache Yetus    http://yetus.apache.org |


This message was automatically generated.

, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12929711/HIVE-17593.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 14638 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_parquet_types] (batchId=69)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testMultipleTriggers2 (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerCustomCreatedDynamicPartitions (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerCustomCreatedDynamicPartitionsMultiInsert (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerCustomCreatedDynamicPartitionsUnionAll (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerCustomCreatedFiles (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerCustomNonExistent (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerCustomReadOps (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerHighBytesRead (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerHighShuffleBytes (batchId=247)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerVertexRawInputSplitsNoKill (batchId=247)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/12297/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/12297/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12297/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.YetusPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 11 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12929711 - PreCommit-HIVE-Build, vectorized_parquet_types.q failed due to my patch, the qtest.out should be changed also according to types definition:
Char types are similar to Varchar but they are fixed-length meaning that values shorter than the specified length value are padded with spaces but trailing spaces are not important during comparisons. The maximum length is fixed at 255.

https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types#LanguageManualTypes-CharcharChar, | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
|| || || || {color:brown} master Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  8m 22s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  5s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 38s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  4m  7s{color} | {color:blue} ql in master has 2286 extant Findbugs warnings. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 56s{color} | {color:green} master passed {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 27s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  4s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m  4s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 39s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m 18s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 57s{color} | {color:green} the patch passed {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 13s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 24m 15s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |
| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12332/dev-support/hive-personality.sh |
| git revision | master / d83a0be |
| Default Java | 1.8.0_111 |
| findbugs | v3.0.0 |
| modules | C: ql U: ql |
| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12332/yetus.txt |
| Powered by | Apache Yetus    http://yetus.apache.org |


This message was automatically generated.

, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12929939/HIVE-17593.2.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 44 failed/errored test(s), 14632 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestBeeLineDriver.org.apache.hadoop.hive.cli.TestBeeLineDriver (batchId=261)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorized_parquet_types] (batchId=69)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_parquet_types] (batchId=172)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testAlterPartition (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testAlterTable (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testAlterTableCascade (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testAlterViewParititon (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testColumnStatistics (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testComplexTable (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testComplexTypeApi (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testConcurrentMetastores (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDBLocationChange (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDBOwner (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDBOwnerChange (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDatabase (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDatabaseLocation (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDatabaseLocationWithPermissionProblems (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDropDatabaseCascadeMVMultiDB (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testDropTable (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testFilterLastPartition (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testFilterSinglePartition (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testFunctionWithResources (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testGetConfigValue (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testGetMetastoreUuid (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testGetSchemaWithNoClassDefFoundError (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testGetTableObjects (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testGetUUIDInParallel (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testJDOPersistanceManagerCleanup (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testListPartitionNames (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testListPartitions (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testListPartitionsWihtLimitEnabled (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testNameMethods (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testPartition (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testPartitionFilter (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testRenamePartition (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testRetriableClientWithConnLifetime (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testSimpleFunction (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testSimpleTable (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testSimpleTypeApi (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testStatsFastTrivial (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testSynchronized (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testTableDatabase (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testTableFilter (batchId=217)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testValidateTableCols (batchId=217)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/12332/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/12332/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12332/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.YetusPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 44 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12929939 - PreCommit-HIVE-Build, | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
|| || || || {color:brown} master Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 24s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  6s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 39s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  4m  5s{color} | {color:blue} ql in master has 2286 extant Findbugs warnings. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 58s{color} | {color:green} master passed {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 25s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  6s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m  6s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 39s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m 20s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 13s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 23m 19s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |
| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12357/dev-support/hive-personality.sh |
| git revision | master / cc8ac97 |
| Default Java | 1.8.0_111 |
| findbugs | v3.0.0 |
| modules | C: ql U: ql |
| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12357/yetus.txt |
| Powered by | Apache Yetus    http://yetus.apache.org |


This message was automatically generated.

, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12930050/HIVE-17593.3.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 14635 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_parquet_types] (batchId=172)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/12357/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/12357/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12357/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.YetusPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12930050 - PreCommit-HIVE-Build, the failed tests are not related. 

[~Ferd], take a look?
, Is this diff caused by padding?
{code:java}
214,217c214,217
< a     1 a   3 48.88 1
< ab    2 ab  3 8.72 1
< abc   3 abc 3 90.21 1
< abcd  4 abcd 4 3.89 1
---
> a     5 a   3 48.88 1
> ab    5 ab  3 8.72 1
> abc   5 abc 3 90.21 1
> abcd  5 abcd 4 3.89 1
555,558c555,558
< a     1 a   3 48.88 1
< ab    2 ab  3 8.72 1
< abc   3 abc 3 90.21 1
< abcd  4 abcd 4 3.89 1
---
> a     5 a   3 48.88 1
> ab    5 ab  3 8.72 1
> abc   5 abc 3 90.21 1
> abcd  5 abcd 4 3.89 1
{code}
, [~Ferd], yes, previous qtest result uses stripped value for char type verification, and I change to use padding value according to char definition. , I see. The test report is a little bit out of date since your patch should already updated the output file. And could you also update Tez and LLAP output file as well? 
LGTM +1 pending on the refreshed test report., Thanks [~Ferd], I think the last test report already cover my latest HIVE-17593.3.patch. , My fault. You should update LLAP's output file. See "org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_parquet_types] (batchId=172)", It's my fault, will update llap side as well., [~Ferd]ï¼Œ I may understand the definition in wrong way.  As I listed definition in above, length, comparison, and hashcode should be ignored for HiveChar, so we should not change LENGTH(column) all to 5 in qtest result. Furthermore, I checked HiveChar conversion in other places, such as PrimitiveObjectInspectorConverter.java and PrimitiveObjectInspectorOrUtils.java in hive serder2 package, they use stripped value explicitly. 

So I think the easy way is to change ConvertAstToSeachArgs.java to use stripped value for HiveChar as well., Any unit test to cover the change for the new patch? And do we need to resolve HIVE-17261 first so that searching argument can finally be used?, [~Ferd], I haven't perform fully unit tests locally,  let me delete it firstly since it will trigger hive build test.

As for HIVE-17261, it depends on this issue.


, The previous unit test failure (vectorized_parquet_types.q) is because of different length UDF used for CHAR.  

When performing query in non-vectorized mode, GenericUDFLength is used to calculate length of column, it converts the primitive value to string by using PrimitiveObjectInspectorUtil.getString, in which the tailing spaces is ignored for CHAR type.
However, when performing query in vectorized mode, StringLength is used to calculate the length of column, it treats column as byte array and doesn't consider the column type. , | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
|| || || || {color:brown} master Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  8m 16s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  3s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 38s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  3m 51s{color} | {color:blue} ql in master has 2289 extant Findbugs warnings. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 56s{color} | {color:green} master passed {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 19s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red}  0m 38s{color} | {color:red} ql: The patch generated 1 new + 58 unchanged - 1 fixed = 59 total (was 59) {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m  3s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 58s{color} | {color:green} the patch passed {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 13s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 23m 28s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |
| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12591/dev-support/hive-personality.sh |
| git revision | master / d8306cf |
| Default Java | 1.8.0_111 |
| findbugs | v3.0.0 |
| checkstyle | http://104.198.109.242/logs//PreCommit-HIVE-Build-12591/yetus/diff-checkstyle-ql.txt |
| modules | C: ql U: ql |
| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12591/yetus.txt |
| Powered by | Apache Yetus    http://yetus.apache.org |


This message was automatically generated.

, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12931423/HIVE-17593.4.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 14650 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorStringExpressions.testStringLength (batchId=300)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/12591/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/12591/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12591/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.YetusPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12931423 - PreCommit-HIVE-Build, | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
|| || || || {color:brown} master Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 41s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  0s{color} | {color:green} master passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 36s{color} | {color:green} master passed {color} |
| {color:blue}0{color} | {color:blue} findbugs {color} | {color:blue}  3m 44s{color} | {color:blue} ql in master has 2291 extant Findbugs warnings. {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 54s{color} | {color:green} master passed {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m 21s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red}  0m 37s{color} | {color:red} ql: The patch generated 1 new + 58 unchanged - 1 fixed = 59 total (was 59) {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  4m  0s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 54s{color} | {color:green} the patch passed {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 11s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 22m 24s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Optional Tests |  asflicense  javac  javadoc  findbugs  checkstyle  compile  |
| uname | Linux hiveptest-server-upstream 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /data/hiveptest/working/yetus_PreCommit-HIVE-Build-12617/dev-support/hive-personality.sh |
| git revision | master / 1b5903b |
| Default Java | 1.8.0_111 |
| findbugs | v3.0.0 |
| checkstyle | http://104.198.109.242/logs//PreCommit-HIVE-Build-12617/yetus/diff-checkstyle-ql.txt |
| modules | C: ql U: ql |
| Console output | http://104.198.109.242/logs//PreCommit-HIVE-Build-12617/yetus.txt |
| Powered by | Apache Yetus    http://yetus.apache.org |


This message was automatically generated.

, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12931657/HIVE-17593.5.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:green}SUCCESS:{color} +1 due to 14649 tests passed

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/12617/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/12617/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-12617/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.YetusPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12931657 - PreCommit-HIVE-Build, [~Ferd], All unit tests passed,  the checkstyle issue is from original code. Could you please have a look?, [~Ferd], can we merge this now?]