[Implementations of FileSystem that don't adhere to the spec have been a
recurring problem -- see the linked issues., I grepped through the Hive source code and found this problem in many places.

Instead of modifying all of these files to add null checks I recommend instead that we
create a HiveFileSystem wrapper class and put the checks there, and then modify
Hive code to access FileSystem objects through the wrapper. This will allow Hive
to rely on the FileSystem spec even when implementations of the FileSystem
spec don't adhere to it.]