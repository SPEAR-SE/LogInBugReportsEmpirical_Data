[Patch-1: simple change to handle special case of dropping default partition. If partition spec is p = '__HIVE_DEFAULT_PARTITION__', internally treats p as string type and compares the existing partitions against such string. For the other case like p=3, treats p as int and compares against such integer., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12834389/HIVE-11208.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 206 failed/errored test(s), 10565 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[alter_partition_coltype] (batchId=23)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[alter_partition_update_status] (batchId=79)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[autoColumnStats_8] (batchId=13)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[bucketmapjoin10] (batchId=46)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[bucketmapjoin11] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[columnstats_partlvl_dp] (batchId=46)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[combine2] (batchId=6)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cp_sel] (batchId=56)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[drop_partitions_filter2] (batchId=40)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[explain_dependency2] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[explain_dependency] (batchId=38)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[explain_logical] (batchId=58)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[filter_numeric] (batchId=71)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_auto_unused] (batchId=35)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_bitmap] (batchId=55)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_bitmap_rc] (batchId=47)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_compact] (batchId=19)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_compact_2] (batchId=24)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[input_part3] (batchId=79)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[input_part4] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[input_part6] (batchId=24)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join28] (batchId=74)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join32] (batchId=17)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join33] (batchId=14)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join_merge_multi_expressions] (batchId=19)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[limit_partition_metadataonly] (batchId=56)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part10] (batchId=19)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part11] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part12] (batchId=73)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part13] (batchId=62)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part1] (batchId=75)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part2] (batchId=52)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part3] (batchId=11)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part4] (batchId=56)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part6] (batchId=32)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part7] (batchId=10)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part8] (batchId=59)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[load_dyn_part9] (batchId=35)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[mapjoin1] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[mapjoin_subquery] (batchId=45)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[merge3] (batchId=52)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[merge_dynamic_partition] (batchId=37)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[null_column] (batchId=22)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[orc_int_type_promotion] (batchId=37)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_coltype_literals] (batchId=12)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_condition_remover] (batchId=23)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_date] (batchId=13)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_decode_name] (batchId=72)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_special_char] (batchId=39)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_timestamp] (batchId=32)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_type_check] (batchId=70)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_type_in_plan] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_varchar1] (batchId=58)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_varchar2] (batchId=33)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat10] (batchId=29)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat11] (batchId=6)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat12] (batchId=74)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat15] (batchId=27)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat16] (batchId=34)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat2] (batchId=77)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat3] (batchId=46)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat5] (batchId=3)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat6] (batchId=6)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat8] (batchId=61)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat9] (batchId=63)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[partition_wise_fileformat] (batchId=16)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[pcr] (batchId=54)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[pcs] (batchId=44)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[pointlookup4] (batchId=66)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_vc] (batchId=74)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[regex_col] (batchId=14)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[select_unquote_and] (batchId=1)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[select_unquote_or] (batchId=34)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sort_merge_join_desc_7] (batchId=24)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats0] (batchId=51)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats12] (batchId=55)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats13] (batchId=72)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats2] (batchId=54)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats4] (batchId=71)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats6] (batchId=25)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats7] (batchId=47)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats8] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats_noscan_1] (batchId=51)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats_partial_size] (batchId=17)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats_partscan_1_23] (batchId=79)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[stats_ppr_all] (batchId=52)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union_remove_18] (batchId=6)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union_view] (batchId=13)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[updateBasicStats] (batchId=56)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_join_part_col_char] (batchId=21)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_mr_diff_schema_alias] (batchId=57)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorization_part] (batchId=27)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vectorization_part_varchar] (batchId=36)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[dynamic_partition_pruning_2] (batchId=133)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[explainuser_2] (batchId=134)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[autoColumnStats_1] (batchId=139)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[autoColumnStats_2] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[auto_sortmerge_join_16] (batchId=145)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[bucket_map_join_tez1] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[bucketsortoptimize_insert_2] (batchId=136)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[column_access_stats] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[columnstats_part_coltype] (batchId=148)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[dynamic_partition_pruning] (batchId=141)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[join32_lessSize] (batchId=136)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[load_dyn_part1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[load_dyn_part2] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[load_dyn_part3] (batchId=137)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[metadataonly1] (batchId=148)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[orc_split_elimination] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[sample10] (batchId=144)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[selectDistinctStar] (batchId=149)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[stats_noscan_1] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_mr_diff_schema_alias] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorization_part] (batchId=141)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorization_part_varchar] (batchId=143)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_dynamic_partition_pruning] (batchId=141)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[auto_sortmerge_join_16] (batchId=157)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[vector_join_part_col_char] (batchId=90)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[bucket_mapjoin_wrong_table_metadata_2] (batchId=83)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[dyn_part2] (batchId=83)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[mismatch_columns_insertion] (batchId=83)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[stats_partialscan_autogether] (batchId=83)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[stats_partscan_norcfile] (batchId=83)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_sortmerge_join_16] (batchId=114)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[bucket_map_join_tez1] (batchId=128)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[bucketmapjoin10] (batchId=113)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[bucketmapjoin11] (batchId=122)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[bucketsortoptimize_insert_2] (batchId=94)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[column_access_stats] (batchId=116)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join28] (batchId=128)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join32] (batchId=100)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join32_lessSize] (batchId=95)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join33] (batchId=99)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join_merge_multi_expressions] (batchId=101)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[limit_partition_metadataonly] (batchId=118)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part10] (batchId=101)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part11] (batchId=122)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part12] (batchId=127)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part13] (batchId=121)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part1] (batchId=128)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part2] (batchId=116)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part3] (batchId=97)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part4] (batchId=118)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part6] (batchId=107)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part7] (batchId=96)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part8] (batchId=120)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[load_dyn_part9] (batchId=108)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[mapjoin1] (batchId=95)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[mapjoin_subquery] (batchId=113)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[pcr] (batchId=117)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[sample10] (batchId=112)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats0] (batchId=115)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats12] (batchId=118)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats13] (batchId=126)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats2] (batchId=117)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats6] (batchId=104)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats7] (batchId=114)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats8] (batchId=122)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats_noscan_1] (batchId=116)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[stats_partscan_1_23] (batchId=130)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[union_remove_18] (batchId=95)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[union_view] (batchId=98)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[vectorization_part] (batchId=105)
org.apache.hadoop.hive.metastore.TestMetastoreExpr.testPartitionExpr (batchId=236)
org.apache.hadoop.hive.ql.TestTxnCommands2.testBucketizedInputFormat (batchId=256)
org.apache.hadoop.hive.ql.TestTxnCommands2WithSplitUpdate.testBucketizedInputFormat (batchId=266)
org.apache.hadoop.hive.ql.TestTxnCommands2WithSplitUpdateAndVectorization.testBucketizedInputFormat (batchId=263)
org.apache.hadoop.hive.ql.security.authorization.plugin.TestHiveAuthorizerCheckInvocation.testInputSomeColumnsUsedJoin (batchId=206)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1] (batchId=164)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[0] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[1] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[2] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[3] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[6] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTable[0] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTable[1] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTable[2] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTable[3] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatDynamicPartitioned.testHCatDynamicPartitionedTable[6] (batchId=174)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[0] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[1] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[2] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[3] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[6] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTable[0] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTable[1] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTable[2] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTable[3] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatDynamicPartitionedTable[6] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatExternalDynamicCustomLocation[0] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatExternalDynamicCustomLocation[1] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatExternalDynamicCustomLocation[2] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatExternalDynamicCustomLocation[3] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatExternalDynamicPartitioned.testHCatExternalDynamicCustomLocation[6] (batchId=176)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[0] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[1] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[2] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[3] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTableMultipleTask[6] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTable[0] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTable[1] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTable[2] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTable[3] (batchId=171)
org.apache.hive.hcatalog.mapreduce.TestHCatMutableDynamicPartitioned.testHCatDynamicPartitionedTable[6] (batchId=171)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/1694/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/1694/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1694/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 206 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12834389 - PreCommit-HIVE-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12834936/HIVE-11208.2.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 10583 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[orc_ppd_basic] (batchId=131)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[current_date_timestamp] (batchId=144)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1] (batchId=164)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/1768/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/1768/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1768/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12834936 - PreCommit-HIVE-Build, patch-3: handle the hive_default_partition as a special constant and compare them in equal and not equal specially., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12837161/HIVE-11208.3.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 10629 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[join_acid_non_acid] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=145)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_3] (batchId=90)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/1966/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/1966/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1966/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12837161 - PreCommit-HIVE-Build, [~aihuaxu], for patch3, do you need to cover case such as >= , <=  ?, If there is __HIVE_DEFAULT_PARTITION__, we just want it to support = and !=. Those operators like GenericUDFOPGreaterThan(>) will return null  for the case of __HIVE_DEFAULT_PARTITION__ > 3 automatically  e.g. since it will try to do the int conversion and returns as null. So  default partition won't be dropped by x > 3 operator., The change looks good. +1
, Thanks Yongzhi for reviewing. Pushed to master., Why does this add special handing only to 2 UDFs? In fact, why should special handling be necessary? It looks like evaluators are invalid, see  HIVE-15923  where it fails in a different UDF.
Evaluators should instead return null for this case; or, every UDF would need this magic., See HIVE-15923; I think it would be better to revert this patch, otherwise I'll fix it there. Test attached there - breaks any filters on part columns that have the default partitions, and are not =/!=.
The fundamental problem is that exprs are not supposed to be exposed to UDFs; exprs should be evaluated to comparable Hive data objects., [~sershe] Yeah. That seems to be a problem. Please go ahead to revert the patch and we can rethink about the new way for this jira so we have clean implementation., Actually that change would be fine. Here is the thought on the implementation: default partition is a special value although internally we use a string to represent it. We can reserve default keyword for it. It will only support x = default or x != default. Other comparisons actually should error out during  earlier compilation time. Hope that makes sense to you.




, [~sershe] I checked HIVE-15923 but didn't get what kind of queries are failing? 

For the comparison like default > 3, it should return null since these two are not comparable.

Regarding " exprs are not supposed to be exposed to UDFs". Yeah, I remember I realize I should add another level for that constant but probably I was lazy on that.

Let me check the fix for HIVE-15923. Probably better we can add 'default' keyword and support x is default or x = default syntax. ]