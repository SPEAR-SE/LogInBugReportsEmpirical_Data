[Files to reproduce described issues., I will take a look later today, Barrett have you confirmed the issue in trunk?, I confirmed in trunk that the parse issue is no longer and issue
{code}
Time taken: 0.487 seconds
hive> SELECT
    > fco.cmscustid,fco.orderdate, RANK(fco.orderdate) w
    > FROM
    > fake_customer_orders fco
    > window
    > w as (partition by fco.cmscustid order by fco.orderdate);
FAILED: SemanticException Failed to breakup Windowing invocations into Groups. At least 1 group must only depend on input columns. Also check for circular dependencies.
Underlying error: Ranking Functions can take no arguments
hive> SELECT
    > fco.cmscustid,fco.orderdate, rank(fco.orderdate) w
    > FROM
    > fake_customer_orders fco
    > window
    > w as (partition by fco.cmscustid order by fco.orderdate);
FAILED: SemanticException Failed to breakup Windowing invocations into Groups. At least 1 group must only depend on input columns. Also check for circular dependencies.
Underlying error: Ranking Functions can take no arguments
{code}

I think this was fixed in HIVE-4879, or one of the other ranking cleanups I did. RANK() should not accept arguments, none of the unit tests take arguments. I am going to mark this as closed since it is fixed in trunk. If the actual results are wrong (I think your suggesting that )please open another ticket, Ranking functions not matching name is fixed in trunk.]