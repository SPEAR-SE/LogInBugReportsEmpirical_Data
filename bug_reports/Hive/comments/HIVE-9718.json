[The bug aside, the DISTRIBUTE BY will result in a sub-optimal plan.

Have you tried removing the DISTRIBUTE BY and instead using the automatic reducer injection?

https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.optimize.sort.dynamic.partition
, Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Thanks for the comment. Yes, this optimization helps in preparing a better plan. Having said that, this bug breaks backward compatibility(this query works on Hive-0.13.1 and Hive-0.11). Ideal way is to fix this and make it compatible. , Apologies for the spam. Some constancy issue with Jira, made me to add the same comment again and again. , You need to name your patch file per https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing for automated QA to run., Patches for trunk, 0.14 release, 1.0 release, [~pavan101] Are you still working on this? If so, would you like to rebase the patch ?, Fixed via HIVE-9655]