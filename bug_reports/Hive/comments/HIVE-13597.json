[A new patch; the revert causes a lot of conflicts, so the tests and review are probably needed., [~thejas] can you take a look?, retry for HiveQA, +1, Will commit after HiveQA, Again..., Committed to master.]