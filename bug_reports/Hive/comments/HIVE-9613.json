[i came accross the same problem, any ideas?, I wasn't able to reproduce the issue in both 0.14 and upstream trunk. Can you share the configuration properties you used? Maybe it's caused by some optimization., this sql script i tested output the 4th column with wrong values, thank you for your reply Chao. 

I just set up a new hive of version 1.0 in my cluster,and didn't change any configuration ,and the results is still the same , strange.

i will just attached the sql i tested , could you take any time to test it and let me know it is ok or not . Best regards  and happy Chinese new year. 
, OK, I was able to reproduce the issue on my cluster too. Previously I was using CLI local mode.
Strangely, the plan looks different when it is running on a cluster versus running locally.
I'll look more into this issue.., Hi [~spyfree], sorry I was wrong before - in the upstream trunk I don't get this issue anymore.
It appears that this is an issue in ColumnPruner and is already fixed in HIVE-9327., seems an issue in ColumnPruner and  fixed in HIVE-9327 , Hi,[~csun], I just tested the upstream trunk and the issue is gone.
Thank you for your time and next time i will do some test in the upstream trunk first.
I will close this one as fixed~, This problem is fixed in 1.2.0 but the fix is embedded in a large refactor patch. HIVE-9613.1.patch contains just the fix for the issue. I'd like to backport to 1.0 and 1.1 (both are affected). Ok with you [~vikram.dixit] and [~brocknoland]?, +1 for 1.0, This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]