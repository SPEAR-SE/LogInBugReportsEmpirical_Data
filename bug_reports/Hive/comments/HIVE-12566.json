[I verified the query in MySQL and Oracle, they all return following results
{code}
2	NULL	CD5415192225530	00071	NULL	NULL	NULL
{code}
The issue exists since Hive 0.13. I wonder if it is related to HIVE-5555/HIVE-5557 because the where clause COALESCE(l.la,'EMPTY')=COALESCE(r.ra,'EMPTY') is pushed down to the join condition, and no row in rtable match those in ltable when using the new join condition 
l.lk1 = r.rk1 AND l.lk2 = r.rk2 and COALESCE(l.la,'EMPTY')=COALESCE(r.ra,'EMPTY'), 
therefore the extra row (1	NULL	CD5415192314304	  00071	NULL	NULL	NULL) returns. 
[~rhbutani] & [~ashutoshc] Do you have any insight to this issue? Thanks, I think that pushing down of where clause to join condition should not be applicable to any outer join. Otherwise, the initially matched rows from two joined tables might no longer match with more join conditions, and an extra row will result in some outer join cases. 
For an example, in above provided case, the ltable row (1,NULL,CD5415192314304,00071) could join with rtable row (1,CD5415192314304,00071) on condition (l.lk1 = r.rk1 AND l.lk2 = r.rk2), and generates a joined row (1,NULL,CD5415192314304,00071, 1,CD5415192314304,00071), but which is filtered out in the final result due to not meeting the where clause.
But if the where clause is pushed down to the join condition, the rtable row (1,CD5415192314304,00071) does no longer match ltable row (1,NULL,CD5415192314304,00071) on the new stricter condition
(l.lk1 = r.rk1 AND l.lk2 = r.rk2 and COALESCE(l.la,'EMPTY')=COALESCE(r.ra,'EMPTY')), therefore the resulted left joined row will be (1,NULL,CD5415192314304,00071, NULL, NULL, NULL). Since this row meets the where clause, it won't be filtered out and thus an extra row is resulted., Disable the pushdown of where clause to join condition in outer join., Patch has been uploaded to RB https://reviews.apache.org/r/40897/ , thanks in advance for review., +1, but let's see what the precommit-test will say., [~jcamachorodriguez] was looking at this piece of code recently. Jesus, would you also like to review this one?, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12775495/HIVE-12566.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 32 failed/errored test(s), 9841 tests executed
*Failed tests:*
{noformat}
TestHWISessionManager - did not produce a TEST-*.xml file
TestMiniTezCliDriver-dynpart_sort_optimization2.q-vector_char_mapjoin1.q-tez_insert_overwrite_local_directory_1.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_udf_max
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_index_auto_mult_tables_compact
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join_cond_pushdown_unqual5
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_dynamic_partition_pruning
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vectorized_dynamic_partition_pruning
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_mergejoin
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.common.metrics.metrics2.TestCodahaleMetrics.testGauge
org.apache.hadoop.hive.metastore.TestAuthzApiEmbedAuthorizerInRemote.org.apache.hadoop.hive.metastore.TestAuthzApiEmbedAuthorizerInRemote
org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs.testFetchingPartitionsWithDifferentSchemas
org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs.testGetPartitionSpecs_WithAndWithoutPartitionGrouping
org.apache.hadoop.hive.metastore.TestPartitionNameWhitelistValidation.testAppendPartitionWithCommas
org.apache.hadoop.hive.metastore.TestPartitionNameWhitelistValidation.testAppendPartitionWithValidCharacters
org.apache.hadoop.hive.ql.security.TestAuthorizationPreEventListener.testListener
org.apache.hadoop.hive.ql.security.TestClientSideAuthorizationProvider.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestExtendedAcls.org.apache.hadoop.hive.ql.security.TestExtendedAcls
org.apache.hadoop.hive.ql.security.TestFolderPermissions.org.apache.hadoop.hive.ql.security.TestFolderPermissions
org.apache.hadoop.hive.ql.security.TestMetastoreAuthorizationProvider.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestMultiAuthorizationPreEventListener.org.apache.hadoop.hive.ql.security.TestMultiAuthorizationPreEventListener
org.apache.hadoop.hive.ql.security.TestStorageBasedClientSideAuthorizationProvider.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationDrops.testDropDatabase
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationDrops.testDropPartition
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationDrops.testDropTable
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationProvider.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationProviderWithACL.testSimplePrivileges
org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.testMetastoreProxyUser
org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.testSaslWithHiveMetaStore
org.apache.hive.hcatalog.mapreduce.TestHCatPartitionPublish.org.apache.hive.hcatalog.mapreduce.TestHCatPartitionPublish
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.jdbc.miniHS2.TestHs2Metrics.testMetrics
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6230/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6230/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6230/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 32 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12775495 - PreCommit-HIVE-TRUNK-Build, Rebased and recreated new qtest join_cond_pushdown_unqual5.q output file. Other tests are either aged failed tests or due to infra issue (connection refused).
Resubmitted the new patch., Indeed by SQL semantics, the predicate specified in the {{ON}} clause should be applied on the Join. However, the predicate in the {{WHERE}} clause should be applied after the Join is made. Thus, the condition in the {{WHERE}} clause cannot be pushed into the Join for outer joins. Change looks good to me, +1, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12775784/HIVE-12566.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 8 failed/errored test(s), 9897 tests executed
*Failed tests:*
{noformat}
TestHWISessionManager - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_udf_max
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_dynamic_partition_pruning
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vectorized_dynamic_partition_pruning
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_mergejoin
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs.testGetPartitionSpecs_WithAndWithoutPartitionGrouping
org.apache.hive.jdbc.TestSSL.testSSLVersion
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6250/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6250/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6250/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 8 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12775784 - PreCommit-HIVE-TRUNK-Build, None of 8 failed tests is related to this patch., Committed to 2.1.0 and 1.3.0. Thanks [~xuefuz] and [~jcamachorodriguez] for review., Will this also be committed to 2.0.0 (branch-2.0)?, Thanks, [~leftylev], I backported it to 2.0.0]