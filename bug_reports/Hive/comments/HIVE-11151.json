[Added another check to not intro {{is not null}} filters on constants., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12742954/HIVE-11151.2.patch

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 9133 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_auto_join8
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_join8
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_auto_join8
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver_join8
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4451/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4451/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4451/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12742954 - PreCommit-HIVE-TRUNK-Build, [~ashutoshc], I have a question on the InputRefValidator and the _no need to add not null filter for a constant_. Do you think the check should be added to HiveJoinAddNotNullRule too? I think so... We can open a different issue for that, I just wanted to know what you think.

A couple of comments on the code:
- "isnotnull" string could be held in a _private static final_ variable in the class; I think it will help us tracking easily the constants in the class (as in HiveJoinAddNotNullRule).
- To avoid cast to HepRelVertex (I'm guessing this might not be safe at some point in the future) to get the children (lines 74-75), we can replace the super call in the constructor by:
{code}
    super(operand(Join.class,
              operand(RelNode.class, any()),
              operand(RelNode.class, any())));
{code}
and then extract the operators by:
{code}
Join join = call.rel(0);
RelNode lChild = call.rel(1);
RelNode rChild = call.rel(2);
{code}

Otherwise, looks good to me., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12742983/HIVE-11151.3.patch

{color:green}SUCCESS:{color} +1 9133 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4458/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4458/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4458/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12742983 - PreCommit-HIVE-TRUNK-Build, If we decide to do it, the additional check in HiveJoinAddNotNullRule could be added in HIVE-11110 in fact., [~jcamachorodriguez] That check seems to be already present in that rule.
{code}
  RelDataType keyType = input.getRowType().getFieldList().get(pos).getType();
        // Nothing to do if key cannot be null
        if (!keyType.isNullable()) {
          continue;
        }
{code}

Or are you thinking of something else?

Addressed other review comments on .4 patch
, OK, I didn't remember it was there :) Thanks, +1, Pushed to master., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12743102/HIVE-11151.4.patch

{color:green}SUCCESS:{color} +1 9133 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4465/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4465/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4465/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12743102 - PreCommit-HIVE-TRUNK-Build]