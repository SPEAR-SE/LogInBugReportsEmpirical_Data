[Add a test case to reproduce the issue.

cc [~aihuaxu] & [~navis]  similar issue https://issues.apache.org/jira/browse/HIVE-14805, https://issues.apache.org/jira/browse/HIVE-10875, Thanks [~niklaus.xiao] to report this. I will take a look. So does this case work with MR but not with Spark?, Yes, MR engine works fine., [~niklaus.xiao] Seems I can see the same issue on MR . It treats base@dt=2017 as directInput as well. It happens when hive.cbo.enable is true. When hive.cbo.enable is false, I don't see such issue.

Can you try the latest version as well to see if you see the same?, [~aihuaxu] I tried 1.3.0-SNAPSHOT didn't see the issue when use MR engine, I'll try to use the latest version., [~aihuaxu] this is my test result with the latest version, 2.2.0-SNAPSHOT: 
MR + CBO on -> issue exists
MR + CBO off -> issue doesnot exists
Spark + CBO on -> issue exists, OK. Thanks for confirming. That's also what I noticed. I found the root cause for that, but it's a little tough to fix. I'm still investigating it., Any progress on this ?]