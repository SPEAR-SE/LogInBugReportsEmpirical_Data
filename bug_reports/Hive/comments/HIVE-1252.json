[Can you reduce the test data size - I mean create a new table with fewer rows - or you can use src1 to show the same problem, A new patch integrated Namit's comments. Thanks Namit!, Can you change the test to add:

m.value is not null in the second join - it is painful to verify the results., a new patch added m.value is not null and m.value!=''  , Committed. Thanks Yongqiang]