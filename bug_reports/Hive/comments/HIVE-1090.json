[will be merged as part of https://issues.apache.org/jira/browse/HIVE-1094, Committed. Thanks Yongqiang]