[The patch is to:
1. preserve the column stats in a partitioned table rename
2. since the column stats are no more invalidated during a table rename, I renamed the alter_table_invalidate_column_stats.q to alter_table_column_stats.q, Patch has been uploaded to RB. [~pxiong], could you help to review it. Thanks., LGTM. +1 pending tests., Reattach the patch to kick off precommit test., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12865159/HIVE-16147.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 10 failed/errored test(s), 10636 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_index] (batchId=225)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_table_stats] (batchId=50)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[alter_table_stats_status] (batchId=51)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=143)
org.apache.hadoop.hive.cli.TestSparkNegativeCliDriver.org.apache.hadoop.hive.cli.TestSparkNegativeCliDriver (batchId=236)
org.apache.hadoop.hive.metastore.TestEmbeddedHiveMetaStore.testAlterViewParititon (batchId=200)
org.apache.hadoop.hive.metastore.TestRemoteHiveMetaStore.testAlterViewParititon (batchId=203)
org.apache.hadoop.hive.metastore.TestSetUGIOnBothClientServer.testAlterViewParititon (batchId=199)
org.apache.hadoop.hive.metastore.TestSetUGIOnOnlyClient.testAlterViewParititon (batchId=197)
org.apache.hadoop.hive.metastore.TestSetUGIOnOnlyServer.testAlterViewParititon (batchId=208)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4886/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4886/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4886/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 10 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12865159 - PreCommit-HIVE-Build, Fixed the failed tests., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12865390/HIVE-16147.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 10640 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_index] (batchId=225)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=143)
org.apache.hadoop.hive.ql.parse.TestParseNegativeDriver.testCliDriver[wrong_distinct2] (batchId=233)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4894/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4894/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4894/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12865390 - PreCommit-HIVE-Build, The test failures are not related to the patch. [~pxiong], could you help to review it again? Thanks, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12865390/HIVE-16147.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 10635 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_index] (batchId=225)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4912/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4912/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4912/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12865390 - PreCommit-HIVE-Build, The only one test failure is not related to this patch. [~pxiong] could you review the patch? Thanks, [~ctang.ma], may i ask what did u change from the 1st patch? thanks., [~pxiong] Thanks for looking into this. Yeah, I made some changes to fix the test failures and also optimized the code a little. I have uploaded the 2nd patch to RB requesting for the review., +1, Committed to 2.4.0 and 3.0.0. Thanks [~pxiong] for review., Hive 3.0.0 has been released so closing this jira.]