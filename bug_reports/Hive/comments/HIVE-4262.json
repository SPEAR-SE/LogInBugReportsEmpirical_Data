[hbutani requested code review of "HIVE-4262 [jira] fix last_value UDAF behavior".

Reviewers: JIRA, ashutoshc

fix last_value

When an Order Spec is present in an Over clause
last_value should return the value from the last row that matches the current row's Sort Key.
See egs here http://msdn.microsoft.com/en-us/library/hh231517.aspx

TEST PLAN
  added new test to window_navfn.q

REVISION DETAIL
  https://reviews.facebook.net/D9837

AFFECTED FILES
  data/files/flights_tiny.txt
  data/files/part.rc
  data/files/part.seq
  ql/src/java/org/apache/hadoop/hive/ql/parse/WindowingSpec.java
  ql/src/test/queries/clientpositive/windowing_navfn.q
  ql/src/test/results/clientpositive/windowing_navfn.q.out

MANAGE HERALD RULES
  https://reviews.facebook.net/herald/view/differential/

WHY DID I GET THIS EMAIL?
  https://reviews.facebook.net/herald/transcript/23463/

To: JIRA, ashutoshc, hbutani
, ashutoshc has commented on the revision "HIVE-4262 [jira] fix last_value UDAF behavior".

  A minor comment. Also, you might need to rebase this on trunk.

INLINE COMMENTS
  ql/src/java/org/apache/hadoop/hive/ql/parse/WindowingSpec.java:241 It will be good to define as LAST_VALUE as public static final string in FunctionRegistry just like for LEAD, LAG etc. and than refer that in Registry as well as here.

REVISION DETAIL
  https://reviews.facebook.net/D9837

To: JIRA, ashutoshc, hbutani
, hbutani updated the revision "HIVE-4262 [jira] fix last_value UDAF behavior".

    - merge
    - Merge remote-tracking branch 'origin/ptf' into ptf
    - HIVE-4262 [jira] fix last_value UDAF behavior
    - HIVE-4262 [jira] fix last_value UDAF behavior

Reviewers: JIRA, ashutoshc

REVISION DETAIL
  https://reviews.facebook.net/D9837

CHANGE SINCE LAST DIFF
  https://reviews.facebook.net/D9837?vs=30813&id=31245#toc

AFFECTED FILES
  data/files/flights_tiny.txt
  data/files/part.rc
  data/files/part.seq
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
  ql/src/java/org/apache/hadoop/hive/ql/parse/WindowingSpec.java
  ql/src/test/queries/clientpositive/windowing_navfn.q
  ql/src/test/results/clientpositive/windowing_navfn.q.out

To: JIRA, ashutoshc, hbutani
, ashutoshc has accepted the revision "HIVE-4262 [jira] fix last_value UDAF behavior".

  +1 will commit if tests pass.

REVISION DETAIL
  https://reviews.facebook.net/D9837

BRANCH
  HIVE-4262

ARCANIST PROJECT
  hive

To: JIRA, ashutoshc, hbutani
, Committed to trunk. Thanks, Harish!, Integrated in Hive-trunk-h0.21 #2049 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2049/])
    HIVE-4262 : fix last_value UDAF behavior (Harish Butani via Ashutosh Chauhan) (Revision 1465172)

     Result = ABORTED
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1465172
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/WindowingSpec.java
* /hive/trunk/ql/src/test/queries/clientpositive/windowing_navfn.q
* /hive/trunk/ql/src/test/results/clientpositive/windowing_navfn.q.out
]