[Adding order by might slow down the test. Preferable way is to add tag "--sort_query_result" (something like that)., Thanks [~xuefuz] for the suggestion.  I looked at  --SORT_QUERY_RESULTS and it seems it sorts the output after the query has run. 
So with a query like
{noformat}
select key, count(*) from src group by key limit 10
{noformat}
--SORT_QUERY_RESULTS will sort the output, but the results of the query are not sorted before the limit is applied, so this is not enough to make the query deterministic. But using 
{noformat}
select key, count(*) from src group by key order by key limit 10
{noformat}
is, I think deterministic.

The queries in spark_local_queries.q are very small and adding the 'order by' does not seem to make a significant difference to elapsed time.
, This is a small change, Makes sense, [~asherman]. Thanks for the explanation.

+1, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12893545/HIVE-17868.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 9 failed/errored test(s), 11315 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[date_2] (batchId=79)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[llap_acid_fast] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[optimize_nullscan] (batchId=163)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[resourceplan] (batchId=158)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=204)
org.apache.hadoop.hive.ql.parse.TestReplicationScenarios.testConstraints (batchId=221)
org.apache.hadoop.hive.ql.parse.authorization.plugin.sqlstd.TestOperation2Privilege.checkHiveOperationTypeMatch (batchId=269)
org.apache.hive.jdbc.TestTriggersTezSessionPoolManager.testTriggerHighShuffleBytes (batchId=228)
org.apache.hive.jdbc.TestTriggersWorkloadManager.testTriggerHighShuffleBytes (batchId=228)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/7445/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/7445/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-7445/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12893545 - PreCommit-HIVE-Build, Test failures are unrelated to my change. In addition I checked that the test I changed did run. 
Thanks [~xuefuz] for reviewing. 
[~stakiar] can you take a look and push if you approve? Thanks, +1

Pushed to master., Thanks for the push, This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.]