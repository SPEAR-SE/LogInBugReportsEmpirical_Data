[[~vaddebalu]: can you post the output of "explain <query>" with {{set hive.execution.engine=tez;}} ?, Plan not optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 2 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Map 1
         File Output Operator [FS_10]
            compressed:false
            Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
            table:{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}
            Select Operator [SEL_9]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
               Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator [MAPJOIN_14]
               |  condition map:[{"":"Left Outer Join0 to 1"}]
               |  HybridGraceHashJoin:true
               |  keys:{"Map 2":"_col0 (type: bigint)","Map 1":"_col0 (type: bigint)"}
               |  outputColumnNames:["_col0","_col2","_col3"]
               |  Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
               |<-Map 2 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_7]
               |     key expressions:_col0 (type: bigint)
               |     Map-reduce partition columns:_col0 (type: bigint)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:_col1 (type: string)
               |     Select Operator [SEL_5]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
               |        Filter Operator [FIL_13]
               |           predicate:false (type: boolean)
               |           Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
               |           TableScan [TS_3]
               |              alias:tabletest
               |              Statistics:Num rows: 2 Data size: 10 Basic stats: COMPLETE Column stats: NONE
               |<-Select Operator [SEL_2]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
                     Filter Operator [FIL_12]
                        predicate:(n = 1) (type: boolean)
                        Statistics:Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_0]
                           alias:tabletest
                           Statistics:Num rows: 2 Data size: 10 Basic stats: COMPLETE Column stats: NONE

Time taken: 0.196 seconds, Fetched: 49 row(s), [~vaddebalu]: I can't reproduce this issue in the latest hive, so it is likely to have been fixed between 1.2.0 and 2.1.0

My query runs return

{code}
1       NULL    NULL    empty   -1
Time taken: 2.526 seconds, Fetched: 1 row(s)
{code}, This issue is same as https://issues.apache.org/jira/browse/HIVE-14027, Closed as duplicate of HIVE-14027.]