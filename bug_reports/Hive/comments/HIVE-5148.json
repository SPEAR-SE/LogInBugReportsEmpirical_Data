[committed to branch, It seems that I have to set "hive.optimize.true" to true otherwise I get an NPE when quitting hive CLI. That's because Hive SessionState doesn't check whether TezSessionState is NULL before closing it. , Thanks [~mauzhang]. I've opened HIVE-6097. I've changed the session handling slightly recently and broke this.]