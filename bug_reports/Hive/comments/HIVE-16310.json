[tested with the q file in the description, before the patch is
{code}
{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"pxiong_20170327214643_9a73bc1d-d074-4308-9b7c-aa0f5feac22f:33","Edges:":{"Map 4":{"parent":"Reducer 3","type":"BROADCAST_EDGE"},"Reducer 2":[{"parent":"Map 1","type":"SIMPLE_EDGE"},{"parent":"Map 4","type":"SIMPLE_EDGE"}],"Reducer 3":{"parent":"Map 1","type":"CUSTOM_SIMPLE_EDGE"}},"DagName:":"","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"t1","filterExpr:":"(tinyint_col_3 > 3) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"TS_0","children":{"Filter Operator":{"predicate:":"(tinyint_col_3 > 3) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"FIL_26","children":{"Select Operator":{"expressions:":"tinyint_col_3 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_27","children":[{"Reduce Output Operator":{"key expressions:":"_col0 (type: tinyint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: tinyint)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"RS_28"}},{"Select Operator":{"expressions:":"_col0 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_29","children":{"Group By Operator":{"aggregations:":["min(_col0)","max(_col0)","bloom_filter(_col0, expectedEntries=2)"],"mode:":"hash","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_30","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: tinyint), _col1 (type: tinyint), _col2 (type: binary)","OperatorId:":"RS_31"}}}}}}]}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"no inputs"},"Map 4":{"Map Operator Tree:":[{"TableScan":{"alias:":"t2","filterExpr:":"((tinyint_col_20 > 3) and (tinyint_col_20 BETWEEN DynamicValue(RS_6_t1_tinyint_col_20_min) AND DynamicValue(RS_6_t1_tinyint_col_20_max) and in_bloom_filter(tinyint_col_20, DynamicValue(RS_6_t1_tinyint_col_20_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"TS_3","children":{"Filter Operator":{"predicate:":"((tinyint_col_20 > 3) and (tinyint_col_20 BETWEEN DynamicValue(RS_6_t1_tinyint_col_20_min) AND DynamicValue(RS_6_t1_tinyint_col_20_max) and in_bloom_filter(tinyint_col_20, DynamicValue(RS_6_t1_tinyint_col_20_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"FIL_34","children":{"Select Operator":{"expressions:":"tinyint_col_20 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_35","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: tinyint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: tinyint)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"RS_36"}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"no inputs"},"Reducer 2":{"Execution mode:":"llap","Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"outputColumnNames:":["_col1"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"MERGEJOIN_25","children":{"Select Operator":{"expressions:":"_col1 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_9","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_10"}}}}}}},"Reducer 3":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=2)"],"mode:":"final","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_32","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: tinyint), _col1 (type: tinyint), _col2 (type: binary)","OperatorId:":"RS_33"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_37"}}}}}}
{code}
after the patch is
{code}
{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"pxiong_20170327210546_07b8bd9f-275b-4ce6-92f2-974f3eafcc83:33","Edges:":{"Map 4":{"parent":"Reducer 3","type":"BROADCAST_EDGE"},"Reducer 2":[{"parent":"Map 1","type":"SIMPLE_EDGE"},{"parent":"Map 4","type":"SIMPLE_EDGE"}],"Reducer 3":{"parent":"Map 1","type":"CUSTOM_SIMPLE_EDGE"}},"DagName:":"","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"t1","filterExpr:":"(tinyint_col_3 > 3) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"TS_0","children":{"Filter Operator":{"predicate:":"(tinyint_col_3 > 3) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"FIL_13","children":{"Select Operator":{"expressions:":"tinyint_col_3 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_2","children":[{"Reduce Output Operator":{"key expressions:":"_col0 (type: tinyint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: tinyint)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"RS_6","OutputOperators:":"[JOIN_8]"}},{"Select Operator":{"expressions:":"_col0 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_20","children":{"Group By Operator":{"aggregations:":["min(_col0)","max(_col0)","bloom_filter(_col0, expectedEntries=2)"],"mode:":"hash","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: tinyint), _col1 (type: tinyint), _col2 (type: binary)","OperatorId:":"RS_22","OutputOperators:":"[GBY_23]"}}}}}}]}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"no inputs"},"Map 4":{"Map Operator Tree:":[{"TableScan":{"alias:":"t2","filterExpr:":"((tinyint_col_20 > 3) and (tinyint_col_20 BETWEEN DynamicValue(RS_6_t1_tinyint_col_20_min) AND DynamicValue(RS_6_t1_tinyint_col_20_max) and in_bloom_filter(tinyint_col_20, DynamicValue(RS_6_t1_tinyint_col_20_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"TS_3","children":{"Filter Operator":{"predicate:":"((tinyint_col_20 > 3) and (tinyint_col_20 BETWEEN DynamicValue(RS_6_t1_tinyint_col_20_min) AND DynamicValue(RS_6_t1_tinyint_col_20_max) and in_bloom_filter(tinyint_col_20, DynamicValue(RS_6_t1_tinyint_col_20_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"FIL_14","children":{"Select Operator":{"expressions:":"tinyint_col_20 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_5","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: tinyint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: tinyint)","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"RS_7","OutputOperators:":"[JOIN_8]"}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"no inputs"},"Reducer 2":{"Execution mode:":"llap","Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"outputColumnNames:":["_col1"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"MERGEJOIN_25","children":{"Select Operator":{"expressions:":"_col1 (type: tinyint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","OperatorId:":"SEL_9","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_10"}}}}}}},"Reducer 3":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=2)"],"mode:":"final","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: tinyint), _col1 (type: tinyint), _col2 (type: binary)","OperatorId:":"RS_24","OutputOperators:":"[TS_3]"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_37"}}}}}}
{code}
Due to the masked pattern, it is not necessary to include a q test., [~ashutoshc], could u take a look? Thanks., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12860807/HIVE-16310.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 11 failed/errored test(s), 10514 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=35)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_outer_join3] (batchId=31)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_outer_join4] (batchId=79)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_outer_join6] (batchId=39)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_aggregate_without_gby] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_bround] (batchId=146)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_if_expr] (batchId=141)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_timestamp] (batchId=155)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3] (batchId=94)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[vector_join_part_col_char] (batchId=94)
org.apache.hive.hcatalog.api.TestHCatClient.testTransportFailure (batchId=172)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/4409/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/4409/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-4409/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 11 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12860807 - PreCommit-HIVE-Build, +1 seems like few golden files need updating., I took a look at all the golden files and the changes are legitimate. I pushed the patch to master. Thanks [~ashutoshc] for the review.]