[patch uploaded, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12840986/HIVE-15314.1.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 9 failed/errored test(s), 10718 tests executed
*Failed tests:*
{noformat}
TestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=114)
	[join39.q,bucketsortoptimize_insert_7.q,vector_distinct_2.q,join11.q,union13.q,dynamic_rdd_cache.q,auto_sortmerge_join_16.q,windowing.q,union_remove_3.q,skewjoinopt7.q,stats7.q,annotate_stats_join.q,multi_insert_lateral_view.q,ptf_streaming.q,join_1to1.q]
TestSparkCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=128)
	[union_remove_15.q,bucket_map_join_tez1.q,groupby7_noskew.q,bucketmapjoin1.q,subquery_multiinsert.q,auto_join8.q,auto_join6.q,groupby2_map_skew.q,lateral_view_explode2.q,join28.q,load_dyn_part1.q,skewjoinopt17.q,skewjoin_union_remove_1.q,union_remove_20.q,bucketmapjoin5.q]
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample2] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample4] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample6] (batchId=60)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample7] (batchId=59)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[sample9] (batchId=38)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[transform_ppr2] (batchId=133)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=91)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/2338/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/2338/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-2338/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12840986 - PreCommit-HIVE-Build, Failed cases are not related, hi [~prasanth_j]
This is an logging problem, i see you are lead of logging. could you please give suggestions ?, I guess the intention here is to log and set error status in thrift response. If my understanding is correct, these exceptions are logged just for debugging purpose and are usually handled/acted upon by the clients. In case of error response, the client will throw HiveException that will contain the stacktrace received from ThriftCLIService. 

[~thejas] I guess that was your initial intention, right?, when queries failed, i checked the log /tmp/hadoop/hive.log and found that
2016-11-30T11:52:49,401 WARN  [909b45b3-deed-4a39-a54d-864e97b057b3909b45b3-deed-4a39-a54d-864e97b057b3b6b20a18-cef5-4b3b-ae09-65ab5f8c880eb6b20a18-cef5-4b3b-ae09-65ab5f8c880ec671ec17-c7a4-4811-a9f8-68bb4bbcb9a5c671ec17-c7a4-4811-a9f8-68bb4bbcb9a555adbcc6-c1fa-4646-9c83-92a1f3c21b4155adbcc6-c1fa-4646-9c83-92a1f3c21b41HiveServer2-Handler-Pool: Thread-42]: thrift.ThriftCLIService (ThriftCLIService.java:ExecuteStatement(515)) - Error executing statement:

Here is 'WARN', but messages contains 'Error executing statement'. So i'm confused. If it's 'ERROR',maybe i understand it's serious error

That's point

thanks [~prasanth_j]'s reply, I believe this is set to warn because it is not an HS2 code error (which is like a wrapper around the Driver code in most cases), but an error while running the query. In these cases, the underlying driver code usually logs it at error level. 
Also, the client is sent the error as well.

cc [~prasadm] [~vgumashta]
, hi [~thejas]
If this is not a problem, please close this issue.
Thanks.]