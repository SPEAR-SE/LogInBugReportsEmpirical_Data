[[~ashutoshc] can you please see if this is sufficient., Can you paste sample output for this?, Also, it will be useful to get time spent in generateTaskTree() and optimizeTaskPlan() method., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12796609/HIVE-13407.1.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 9974 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap3
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7458/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7458/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-7458/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12796609 - PreCommit-HIVE-TRUNK-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12797139/HIVE-13407.2.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 35 failed/errored test(s), 9945 tests executed
*Failed tests:*
{noformat}
TestCustomAuthentication - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_ivyDownload
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap3
org.apache.hadoop.hive.llap.daemon.impl.TestTaskExecutorService.testPreemptionQueueComparator
org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskCommunicator.testFinishableStateUpdateFailure
org.apache.hadoop.hive.metastore.TestFilterHooks.org.apache.hadoop.hive.metastore.TestFilterHooks
org.apache.hadoop.hive.metastore.TestMetaStoreEventListenerOnlyOnCommit.testEventStatus
org.apache.hadoop.hive.metastore.TestPartitionNameWhitelistValidation.testAppendPartitionWithCommas
org.apache.hadoop.hive.metastore.TestPartitionNameWhitelistValidation.testAppendPartitionWithValidCharacters
org.apache.hadoop.hive.ql.lockmgr.TestDbTxnManager2.lockConflictDbTable
org.apache.hadoop.hive.ql.security.TestAuthorizationPreEventListener.testListener
org.apache.hadoop.hive.ql.security.TestExtendedAcls.org.apache.hadoop.hive.ql.security.TestExtendedAcls
org.apache.hadoop.hive.ql.security.TestFolderPermissions.org.apache.hadoop.hive.ql.security.TestFolderPermissions
org.apache.hadoop.hive.ql.security.TestMetastoreAuthorizationProvider.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestMultiAuthorizationPreEventListener.org.apache.hadoop.hive.ql.security.TestMultiAuthorizationPreEventListener
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationDrops.testDropDatabase
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationDrops.testDropPartition
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationProvider.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationProviderWithACL.testSimplePrivileges
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationReads.testReadDbFailure
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationReads.testReadDbSuccess
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationReads.testReadTableFailure
org.apache.hadoop.hive.ql.security.TestStorageBasedMetastoreAuthorizationReads.testReadTableSuccess
org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.testDelegationTokenSharedStore
org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.testMetastoreProxyUser
org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.testSaslWithHiveMetaStore
org.apache.hive.jdbc.TestSSL.testSSLFetchHttp
org.apache.hive.service.TestHS2ImpersonationWithRemoteMS.org.apache.hive.service.TestHS2ImpersonationWithRemoteMS
org.apache.hive.spark.client.TestSparkClient.testAddJarsAndFiles
org.apache.hive.spark.client.TestSparkClient.testCounters
org.apache.hive.spark.client.TestSparkClient.testErrorJob
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testMetricsCollection
org.apache.hive.spark.client.TestSparkClient.testSimpleSparkJob
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7489/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/7489/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-7489/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 35 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12797139 - PreCommit-HIVE-TRUNK-Build, +1 please paste sample output from this new logging., Actually instead of {{PerfLogger.Optimizer}} we shall use {{PerfLogger.TezCompiler}} for these logs., Here is the sample output :
{code}
2016-04-21T14:32:29,269 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogBegin(130)) - <PERFLOG method=TezCompiler from=org.apache.hadoop.hive.ql.parse.TezCompiler>
2016-04-21T14:32:29,308 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogEnd(170)) - </PERFLOG method=TezCompiler start=1461274349269 end=1461274349308 duration=39 from=org.apache.hadoop.hive.ql.parse.TezCompiler Setup dynamic partition pruning>
2016-04-21T14:32:29,308 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogBegin(130)) - <PERFLOG method=TezCompiler from=org.apache.hadoop.hive.ql.parse.TezCompiler>
2016-04-21T14:32:29,379 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogEnd(170)) - </PERFLOG method=TezCompiler start=1461274349308 end=1461274349379 duration=71 from=org.apache.hadoop.hive.ql.parse.TezCompiler Setup stats in the operator plan>
2016-04-21T14:32:29,379 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogBegin(130)) - <PERFLOG method=TezCompiler from=org.apache.hadoop.hive.ql.parse.TezCompiler>
2016-04-21T14:32:29,411 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogEnd(170)) - </PERFLOG method=TezCompiler start=1461274349379 end=1461274349411 duration=32 from=org.apache.hadoop.hive.ql.parse.TezCompiler Run the optimizations that use stats for optimization>
2016-04-21T14:32:29,411 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogBegin(130)) - <PERFLOG method=TezCompiler from=org.apache.hadoop.hive.ql.parse.TezCompiler>
2016-04-21T14:32:29,424 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogEnd(170)) - </PERFLOG method=TezCompiler start=1461274349411 end=1461274349424 duration=13 from=org.apache.hadoop.hive.ql.parse.TezCompiler Run cycle analysis for partition pruning>
2016-04-21T14:32:29,427 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogBegin(130)) - <PERFLOG method=TezCompiler from=org.apache.hadoop.hive.ql.parse.TezCompiler>
2016-04-21T14:32:29,499 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogEnd(170)) - </PERFLOG method=TezCompiler start=1461274349427 end=1461274349499 duration=72 from=org.apache.hadoop.hive.ql.parse.TezCompiler generateTaskTree>
2016-04-21T14:32:29,502 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogBegin(130)) - <PERFLOG method=TezCompiler from=org.apache.hadoop.hive.ql.parse.TezCompiler>
2016-04-21T14:32:29,558 DEBUG [1ddcd17e-7e14-49c5-aaf4-b8cf68f6ef87 main[]]: log.PerfLogger (PerfLogger.java:PerfLogEnd(170)) - </PERFLOG method=TezCompiler start=1461274349502 end=1461274349558 duration=56 from=org.apache.hadoop.hive.ql.parse.TezCompiler optimizeTaskPlan>
{code}, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12800075/HIVE-13407.3.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 9980 tests executed
*Failed tests:*
{noformat}
TestHWISessionManager - did not produce a TEST-*.xml file
TestMiniTezCliDriver-dynpart_sort_optimization2.q-tez_dynpart_hashjoin_3.q-orc_vectorization_ppd.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap3
org.apache.hive.beeline.TestSchemaTool.testSchemaInit
{noformat}

Test results: http://ec2-54-177-240-2.us-west-1.compute.amazonaws.com/job/PreCommit-HIVE-MASTER-Build/30/testReport
Console output: http://ec2-54-177-240-2.us-west-1.compute.amazonaws.com/job/PreCommit-HIVE-MASTER-Build/30/console
Test logs: http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-30/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12800075 - PreCommit-HIVE-MASTER-Build, Pushed to master. Thanks, Hari!]