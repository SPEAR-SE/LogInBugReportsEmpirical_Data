[[~pxiong] Could you please take a look at the change in HIVE-13566 and let me know if the overwritten changes were inadvertent that may have been lost during rebase or were they intentional? Thanks, It was lost during rebase and they were not intentional at all. I am sorry about that and please add them back. Thanks., [~pxiong] No problem at all. Its all good. Thanks for the quick confirmation. , The fix and test is exactly same as HIVE-13502. , [~aihuaxu] Could you please re-review and re-commit please? Thank you, The patch looks good. +1 pending test., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12812031/HIVE-14062.1.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 10251 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_constantPropagateForSubQuery
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap3
org.apache.hive.jdbc.TestJdbcWithMiniLlap.testLlapInputFormatEndToEnd
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/199/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/199/console
Test logs: http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-199/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12812031 - PreCommit-HIVE-MASTER-Build, The test failures do not appear related to the fix. So +1 for me., Pushed to branch-2.1 and master. We just have 2.1 released, so I guess it's 2.1.1 and 2.2.0., Thanks Naveen for the work to correct it., [~ngangam] [~aihuaxu] looks like "Named Connection URLs" (HIVE-13670) was not fixed, see:
{code:none}
       String saveUrl = getUrlToUse(url);
-      props.setProperty("url", saveUrl);
+      props.setProperty(JdbcConnectionParams.PROPERTY_URL, url);
{code}

Observing wrong behavior with BigTop 2.1.1:
{code:none}
$ BEELINE_URL_BLUE="jdbc:hive2://my-dataproc-m-0:10000/"
$ beeline -u blue 
scan complete in 1ms
scan complete in 1406ms
No known driver to handle "blue"
Beeline version 2.1.1 by Apache Hive
$ beeline -u blue -d hive2
Connecting to blue
hive2
Beeline version 2.1.1 by Apache Hive
0: blue (closed)> !connect blue
scan complete in 1ms
scan complete in 1405ms
No known driver to handle "blue"
0: blue (closed)>
{code}]