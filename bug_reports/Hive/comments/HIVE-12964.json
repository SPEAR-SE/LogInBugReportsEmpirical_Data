[[~prasanth_j] can you take a look? At least to see if this is a real issue or some test issue that we can fix later., I'll also look to see how big of a problem this is., [~sershe] Can you take a look at this patch?, testFetchResultsOfLogWithExecutionMode still fails for me with this patch, full rebuild and Java 7, The actual reason was not setting a state flag during filtering the messages. So one PerfLogger msg got into OperationLog causing the failure. The changing of the state flag depends upon the arrival of the messages. In Master, some msg arrived early and flipped the flag but in branch-2.0 PerfLogger msg arrived early and the first instance of PerfLogger msg did not flip the excludeMatches flag. We should commit this patch both to master and branch-2.0., [~sershe] Could you review the new patch? The changes in the initial patches are no longer required. If user wants perf logs to be redirected then they can always do so from log4j2.properties file. By default, perf logs go to hive.log at DEBUG level. , Committed. Thanks!, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12785411/HIVE-12964.2.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10032 tests executed
*Failed tests:*
{noformat}
TestSparkCliDriver-timestamp_lazy.q-bucketsortoptimize_insert_4.q-date_udf.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.service.cli.TestEmbeddedThriftBinaryCLIService.testExecuteStatementAsync
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6827/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6827/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6827/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12785411 - PreCommit-HIVE-TRUNK-Build]