[I've found where the problem comes from.
The RowResolver class uses table alias and column alias as key to store ColumnInfo. 
The RowResolver also has a putExpression method to save expressionsempty-string ("") as the table alias together with the
string rendering of the ASTNode as the column alias for matching expressions in GROUP BY with those in the SELECT list.

The problem is when creating the new RowResolver, the program now only copies the column information and the table alias was tossed.
I think adding new RowResolver with the old RowResolver will solve the problem., I met some other problems about aliases.
1."select t.c as c0 from t group by c0" doesn't work.
2."select t.c as c0 from t order by c0" works.
3."select t.c as c0 from t group by a.k order by a.k" doesn't work.

I can see ql now doesn't allow 2, but 3 is important for the project I'm working on. , Please review the patch., Running ant test, I got 41 failures in TestCliDriver.

Also, this patch will need some new unit tests to provide coverage for the fix., This is fixed via HIVE-3107. Feel free to reopen if there are still cases which should be supported and currently are not.]