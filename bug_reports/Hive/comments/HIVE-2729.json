[Sorry, it turns out this wasn't Hive's fault after all. The issue was with a corner case of JNI usage - probably the same corner case that caused HIVE-2163. If the first thread to use libhdfs isn't the same thread that started the JVM from C code, then the thread's context classloader will be null.]