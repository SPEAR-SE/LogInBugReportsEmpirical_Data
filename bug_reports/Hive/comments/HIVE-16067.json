[[~rajesh.balamohan] - please take a look.

This sends out a container complete message to tez when working with llap, which would normally come from the RM., +1; why was getContext().containerStopRequested removed?, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12855275/HIVE-16067.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 10298 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[schema_evol_text_vec_table] (batchId=147)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=223)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/3856/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/3856/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-3856/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12855275 - PreCommit-HIVE-Build, Thanks for the review. Committing.

bq. why was getContext().containerStopRequested removed?
There's several ways a container can complete. The normal flow with YARN containers is to send a message to the NM if we want to terminate the container. That's not required for LLAP. The alternate case is that a container kills itself, in which case sending a message to the NM is not required. Tez handles both, so got rid of the unnecessary message stopRequested (nothing was actually done in this case). LLAP now moves directly into a completed state.]