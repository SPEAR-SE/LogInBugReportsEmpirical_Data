[[~gopalv]/[~sershe] Can someone plz review this patch? Its a minor fix., +1 if tests pass, Added fix for HIVE-9080 here as both are relevant (in the same class). The new changes is to address updation of file statistics from stripe statistics properly. [~sershe] Can you take a look at the new changes? Updating file statistics in the presence of complex column types (struct, union, list, map) is addressed with this new change., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12686741/HIVE-9067.2.patch

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 6702 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_optimize_nullscan
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2052/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2052/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2052/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12686741 - PreCommit-HIVE-TRUNK-Build, +1, [~vikram.dixit] Can we have this for 0.14.1? This is to fix a bug in ORC concatenation., Committed patch to trunk. Waiting for [~vikram.dixit] feedback for 0.14.1 before resolving this issue.
, +1 for 0.14, committed to trunk and branch-0.14.1, Updating release version for jiras resolved in 1.0.0 .
, This issue has been fixed in Apache Hive 1.0.0. If there is any issue with the fix, please open a new jira to address it.
, dose this patch really work? i didnt get it work on 0.14. Someone can help me?, [~Feng Yuan]. This patch went in 1.0.0 (which is 0.14.1). What exact hive version are you using?, 0.14.0 thanks!, is there anything need to be append(code modification like sth),because this patch is applyed in 1.0.0 but if i want to use it in 0.14.0?, 1.0.0 is based off 0.14.0 branch. So this HIVE-9067.2.patch should apply to 0.14.0 source as well., hi Prasanth Jayachandran ,i have try it again,and i still cant get it through,i get these two errors:

when i try "insert into table orc_table select * from test_table;"--example in HIVE-9080.
i get:
[Error 30017]: Skipping stats aggregation by error org.apache.hadoop.hive.ql.metadata.HiveException: [Error 30001]: StatsPublisher cannot be initialized. There was a error in the initialization of StatsPublisher, and retrying might help. If you dont want the query to fail because accurate statistics could not be collected, set hive.stats.reliable=false

when try this: alter table orc_table concatenate,get:
Error: java.lang.IllegalArgumentException: Column has wrong number of index entries found: 0 expected: 1
        at org.apache.hadoop.hive.ql.io.orc.WriterImpl$TreeWriter.writeStripe(WriterImpl.java:726)
        at org.apache.hadoop.hive.ql.io.orc.WriterImpl$StructTreeWriter.writeStripe(WriterImpl.java:1614)
        at org.apache.hadoop.hive.ql.io.orc.WriterImpl.flushStripe(WriterImpl.java:1996)
        at org.apache.hadoop.hive.ql.io.orc.WriterImpl.close(WriterImpl.java:2288)
        at org.apache.hadoop.hive.ql.exec.OrcFileMergeOperator.closeOp(OrcFileMergeOperator.java:215)
        at org.apache.hadoop.hive.ql.io.merge.MergeFileMapper.close(MergeFileMapper.java:98)
        at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:450)
        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)
        at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:163)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:415)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
        at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.DDLTask

if there anything i need to done?
can you gave me some suggestions?
thank you and have a good day!!, [~Feng Yuan] Do you have a small reproducible test case? I can take a look at if you can attach the dataset that you are using., like this:
test_table`s data:
imgtop\N\N\N00mobile_contentgeneral66naMinixexact_matchAndroidfalsefalsetrueNEO-X7-216A0216Mozilla/5.0 (Linux; U; Android 4.2.2; ar-eg; NEO-X7-216A Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30none\NOnline Breedband B.V.eindhovenNL83.117.26.125truetrue51.445.48\N565406014182415864288907390719148304469jsonLive122\N14182415864288907390719148304469mobapp00||38664.14.181.22017597571-80a7-11e4-b1d6-5254000414181696001418238000
imgtop\N65772487\N00politicsmobile_contentdatinggeneralringtones66naMicrosoftexact_matchWindowsfalsefalsefalseGeneric Windows Mobile320240Mozilla/4.0 (compatible; MSIE 4.01; Windows CE; PPC)none\NAircel Ltd.kolkatamobile wirelessIN101.218.108.20mobile gatewaytruetrue22.569702148437588.36968994140625DISHNETIND\N28014182415864284741441834639756033xmlLive76\N14182415864284741441834639756033mobweb00||6054.175.7.64\N\N14181696001418238000
imgtop\N\N\N00mobile_contentgeneral66naMinixexact_matchAndroidfalsefalsetrueNEO-X7-216A0216Mozilla/5.0 (Linux; U; Android 4.2.2; ar-eg; NEO-X7-216A Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30none\NOnline Breedband B.V.eindhovenNL83.117.26.125truetrue51.445.48\N565406014182415864288907390719148304469jsonLive122\N14182415864288907390719148304469mobapp00||38664.14.181.22017597571-80a7-11e4-b1d6-5254000414181696001418238000
imgtop\N65772487\N00politicsmobile_contentdatinggeneralringtones66naMicrosoftexact_matchWindowsfalsefalsefalseGeneric Windows Mobile320240Mozilla/4.0 (compatible; MSIE 4.01; Windows CE; PPC)none\NAircel Ltd.kolkatamobile wirelessIN101.218.108.20mobile gatewaytruetrue22.569702148437588.36968994140625DISHNETIND\N28014182415864284741441834639756033xmlLive76\N14182415864284741441834639756033mobweb00||6054.175.7.64\N\N14181696001418238000

it`s exactly the reproducible in the HIVE-9080., I just tried the test case provided in HIVE-9080, in hive-0.14.0 and hive-1.0.1 binaries. In hive-0.14.0 the job failed and in hive-1.0.1 (which includes the patch) the job succeeded. , thank you for your help!i will dive into it to make out how could it works in 0.14.0., i try this https://github.com/apache/hive/commit/06f10fe4136a83fe0b631954280adc03635ebb63 base on your HIVE-9067.patch2 get it works!]