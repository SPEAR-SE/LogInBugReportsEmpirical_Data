[what's the some real issue? [~teddy.choi], In my case it was some bug I introduced locally with my patch... spent some of time tracking transaction calls before realizing the real error was hidden. Different potential bugs in metastore can also cause this though., Review request on https://reviews.apache.org/r/14302/, Nice. You can retry open though, right?, I was trying to be more cautious :) but, yes the change can be limited to commit and rollback only., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12604735/HIVE-5181.2.patch

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 3151 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.metastore.TestRawStoreTxn.testCheckNoRetryMethods
org.apache.hive.hcatalog.templeton.tool.TestJobIDParser.testParseHive
org.apache.hive.hcatalog.templeton.tool.TestJobIDParser.testParseJar
org.apache.hive.hcatalog.templeton.tool.TestJobIDParser.testParsePig
org.apache.hive.hcatalog.templeton.tool.TestJobIDParser.testParseStreaming
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/867/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/867/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests failed with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated., +1, testCheckNoRetryMethods might be a real failure, otherwise +1, [~sershe] yes, it was the real failures. I updated the patch y'day to allow retry on open, but the test was still checking for the annotation on open which caused the failures. The latest attachment .3.patch has that fixed. It runs fine locally, waiting for the next pre-commit run should be clean., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12604827/HIVE-5181.3.patch

{color:green}SUCCESS:{color} +1 3151 tests passed

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/875/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/875/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated., Committed to trunk. Thanks, Prasad!, FAILURE: Integrated in Hive-trunk-hadoop1-ptest #181 (See [https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/181/])
HIVE-5181 : RetryingRawStore should not retry on logical failures (e.g. from commit) (Prasad Mujumdar via Ashutosh Chauhan) (hashutosh: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1526107)
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RetryingRawStore.java
* /hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestRawStoreTxn.java
, FAILURE: Integrated in Hive-trunk-hadoop2-ptest #115 (See [https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/115/])
HIVE-5181 : RetryingRawStore should not retry on logical failures (e.g. from commit) (Prasad Mujumdar via Ashutosh Chauhan) (hashutosh: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1526107)
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RetryingRawStore.java
* /hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestRawStoreTxn.java
, FAILURE: Integrated in Hive-trunk-h0.21 #2358 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2358/])
HIVE-5181 : RetryingRawStore should not retry on logical failures (e.g. from commit) (Prasad Mujumdar via Ashutosh Chauhan) (hashutosh: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1526107)
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RetryingRawStore.java
* /hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestRawStoreTxn.java
, ABORTED: Integrated in Hive-trunk-hadoop2 #457 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/457/])
HIVE-5181 : RetryingRawStore should not retry on logical failures (e.g. from commit) (Prasad Mujumdar via Ashutosh Chauhan) (hashutosh: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1526107)
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RetryingRawStore.java
* /hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestRawStoreTxn.java
, just wanted to report my finding...as I see this is been committed to hive 0.13

I didnt get this issue resolved by the patch provided here for the same issue I am having in hive-0.12
looks like the problem lies somewhere the way DB pool dealing with transaction, and switching to DBCP (HIVE-4996.patch) fixed and in some way confirmed it.

Thanks
Jay, They are probably two different issues.]