[The bug disappears when the broadcast mapjoin has been pushed out of the Reducer 5.

This is only an error in a scenario where the hashtable is not built for each version of the plan - which never happens for 1 container Tez., Attached a patch that is a bug detector.  It adds default cases for the switch stmts that create the native vector map join classes.  And assert the hash table is not null.

If this patch doesn't trigger, then the only other idea I have is I did have a problem with MapJoinBytesTableContainer.isSupportedKey rejecting using the MapJoinBytesTableContainer when I had already approved it for native vector map join.  But that should have resulted in a cast error., This bug has something to do with the cached hashtables, being reloaded during runtime - is not a direct issue with planning., Wrong jira, [~mmccline] can you take a look?, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12771683/HIVE-12208.2.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 9779 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_rp_annotate_stats_groupby
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.hwi.TestHWISessionManager.testHiveDriver
org.apache.hive.jdbc.TestSSL.testSSLVersion
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5996/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/5996/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-5996/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12771683 - PreCommit-HIVE-TRUNK-Build, LGTM +1, Committed to master and branch-1]