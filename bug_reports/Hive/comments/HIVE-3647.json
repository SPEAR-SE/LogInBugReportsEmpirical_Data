[https://reviews.facebook.net/D6369, comment on the diff, Agree with you completely, Kevin.

Had not done a submit patch, since I wanted to run all the tests first., Are we being overly conservative by asserting the bucketing columns to be the exactly the same as sorting columns?

For example, for
{code}
CREATE TABLE T2(key STRING, val STRING)
CLUSTERED BY key SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE;
{code}
we should still be able to optimize (as "complete match") the Group by on {{key}} alone.

P.S: I don't have a phabricator account and it wouldn't let me login via my GitHub account. Not sure who to talk to., Agreed with Mark, Namit, can you make that change as well?, Thanks Mark, I will make the change, Comments on Phabricator., addressed comments + added new tests, Made a comment on Phabricator. I didn't go through the whole review but I will do that once I hear your thoughts on the comment., Agreed, it can be incorporated, although it should not be a common case.

I can add the following rule:
if (grouping cols == sorting Cols)
 if all bucketing columns are part of sorting cols (any order) 
   complete match, addressed comments from Mark., More comments!, addressed comments, +1, Committed, thanks Namit., Integrated in Hive-trunk-h0.21 #1806 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1806/])
    HIVE-3647. map-side groupby wrongly due to HIVE-3432. (njain via kevinwilfong) (Revision 1411349)

     Result = FAILURE
kevinwilfong : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1411349
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_1.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_2.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_3.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_4.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_5.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_skew_1.q
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_1.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_2.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_3.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_4.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_5.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_skew_1.q.out
, Integrated in Hive-trunk-hadoop2 #54 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/54/])
    HIVE-3647. map-side groupby wrongly due to HIVE-3432. (njain via kevinwilfong) (Revision 1411349)

     Result = ABORTED
kevinwilfong : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1411349
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GroupByOptimizer.java
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_1.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_2.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_3.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_4.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_5.q
* /hive/trunk/ql/src/test/queries/clientpositive/groupby_sort_skew_1.q
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_1.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_2.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_3.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_4.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_5.q.out
* /hive/trunk/ql/src/test/results/clientpositive/groupby_sort_skew_1.q.out
, This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]