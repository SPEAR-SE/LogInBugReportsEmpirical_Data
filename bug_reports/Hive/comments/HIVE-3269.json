[I failed to solve similar issue(HIVE-2954). There should be a entity something like BlockAliasResolver, which handles various column aliases in SELECT/GROUPBY/ORDERBY/CLUSTERBYs., Wont it be good to take a similar approach like groupby ?
I mean, have a dummy select first, and then cluster by/order by can resolve.

But then, it would be difficult to support column aliases., Yes, adding dummy column was not hard. But alias problem was quite difficult.]