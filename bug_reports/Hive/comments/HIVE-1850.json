[Even though, DDLTask.alterTable() does a checkValidity for the table after all the alterations, this problem is not found. Because getDeserializer() was not getting it from the Metastore with modified properties. 
Patch does the required change and add regression test. , canceling patch as one of the tests is failing., Fixed the test failure(protectmode.q) with the patch on review board., 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/1233/
-----------------------------------------------------------

Review request for hive.


Summary
-------

alter table set serdeproperties bypasses regexps checks (leaves table in a non-recoverable state?)


This addresses bug HIVE-1850.
    https://issues.apache.org/jira/browse/HIVE-1850


Diffs
-----

  trunk/ql/src/test/results/clientnegative/create_table_wrong_regex.q.out PRE-CREATION 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1151047 
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java 1151047 
  trunk/ql/src/test/queries/clientnegative/alter_table_wrong_regex.q PRE-CREATION 
  trunk/ql/src/test/queries/clientnegative/create_table_wrong_regex.q PRE-CREATION 
  trunk/ql/src/test/results/clientnegative/alter_table_wrong_regex.q.out PRE-CREATION 

Diff: https://reviews.apache.org/r/1233/diff


Testing
-------

All tests pass with the patch.


Thanks,

Amareshwari

, @Amareshwari: I see a diff in TestCliDriver.protectmode. Can you please take a look and see if you get the same result? Thanks., This patch fixes protectmode failure., +1

, Committed. Thanks Amareshwari, Integrated in Hive-trunk-h0.21 #1036 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1036/])
    HIVE-1850 alter table set serdeproperties bypasses regexps checks
(leaves table in a non-recoverable state?) (Amareshwari Sriramadasu via namit)

namit : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1189026
Files : 
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
* /hive/trunk/ql/src/test/queries/clientnegative/alter_table_wrong_regex.q
* /hive/trunk/ql/src/test/queries/clientnegative/create_table_wrong_regex.q
* /hive/trunk/ql/src/test/results/clientnegative/alter_table_wrong_regex.q.out
* /hive/trunk/ql/src/test/results/clientnegative/create_table_wrong_regex.q.out
]