[The reason for the difference in behavior between 0.7 and 0.9 is different default InputFormat used.

Having said that, the root cause is that the query planner detects this scan query on virtual column as meta only scan and converts the scan operation on the partition to meta only scan and sets {{OneNullRowInputFormat}} as the partition's InputFormat, which *always* emits exactly one row irrespective of whether a partition exists or not.

And this one row (null) is sent to mapper as input which forward this to reducer and eventually to query result.

A temporary fix for this problem is to disable MetadataOnlyOptimizer in hive-site.xml.

{code}
<property>
  <name>hive.optimize.metadataonly</name>
  <value>false</value>
</property>
{code}

Though this has some performance penalty in certain cases, it is better than reverting to HiveInputFormat., Attaching a proposed patch where, if the partition descriptor is empty, use the table's InputFormat Class as the InputFormat Class for the split.]