[There are 3 readers stripe reader, data reader and metadata reader. I think close() should call cleanupReaders() which should close all 3 readers. This patch seems to miss closing data reader in cleanupReaders() and stripe reader in close() method. [~sershe] Can you please confirm if it is safe to close all 3 readers in cleanupReaders() and close()? You are more familiar with this part of code., It should be, orcReader is instanceof Reader which closes the file internally. The attached patch looks good to me, +1. Pending tests, Thanks [~prasanth_j], [~sershe]. Submitting the patch for jenkins job., Pushed to master & branch-2.1 Thanks [~rajesh.balamohan], 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12811001/HIVE-14031.1.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 10 failed/errored test(s), 10235 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_acid_globallimit
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_constantPropagateForSubQuery
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_13
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_repair
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver_index_bitmap3
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_table_nonprintable
org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testPartitionsCheck
org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testTableCheck
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/157/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/157/console
Test logs: http://ec2-50-18-27-0.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-157/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 10 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12811001 - PreCommit-HIVE-MASTER-Build]