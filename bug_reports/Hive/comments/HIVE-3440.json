[This is NOT running on hadoop23, even on the current trunk, build with:
$ant test -Dtest.continue.on.failure=false

Could get the error.

Also found that it happens here:
https://builds.apache.org/job/Hive-trunk-h0.21/1651/consoleFull

Seems like missing jackson mapper library., Found that this is due to missing jackson mapper library.

From the build log, we could see it start failing after HIVE-3393 is commited:

Build#1637 is passed:
https://builds.apache.org/job/Hive-trunk-h0.21/1637/consoleFull

Build#1638 is failing:
https://builds.apache.org/job/Hive-trunk-h0.21/1638/consoleFull

I think to fix it. We need to put jackson-mapper dependency into ql, so that when pdk is running GenericUDTFJSONTuple.java, ObjectMapper initialization, no such NoClassDefFoundError., Review Request submitted at:
https://reviews.facebook.net/D5265

With this patch, pdk pluginTest is passed when triggered by both builtin and pdk:
$ant test -Dtest.continue.on.failure=false, Zhenxiao: after applying the patch I still saw the failure with following log in build/pdk/test-plugin/build/TEST-org.apache.hive.pdk.PluginTest.txt
{code}
Testsuite: org.apache.hive.pdk.PluginTest
Tests run: 1, Failures: 1, Errors: 0, Time elapsed: 15.87 sec
------------- Standard Error -----------------
Testcase: SELECT tp_rot13('Mixed Up!') FROM onerow; took 2.834 sec
	FAILED
expected:<[Zvkrq Hc!]> but was:<[
Hive history file=/tmp/hortonas/hive_job_log_hortonas_201209071914_1143556441.txt
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
12/09/07 19:14:34 WARN conf.HiveConf: hive-site.xml not found on CLASSPATH
Execution log at: /tmp/hortonas/hortonas_20120907191414_d81163ac-2bec-4910-a4b0-ffba6e87a4a0.log
Job running in-process (local Hadoop)
Hadoop job information for null: number of mappers: 0; number of reducers: 0
2012-09-07 19:14:36,315 null map = 0%,  reduce = 0%
Ended Job = job_local_0001 with errors
Error during job, obtaining debugging information...
Execution failed with exit status: 2
Obtaining error information

Task failed!
Task ID:
  Stage-1

Logs:

/tmp/hortonas/hive.log
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask]>
junit.framework.ComparisonFailure: expected:<[Zvkrq Hc!]> but was:<[
Hive history file=/tmp/hortonas/hive_job_log_hortonas_201209071914_1143556441.txt
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
12/09/07 19:14:34 WARN conf.HiveConf: hive-site.xml not found on CLASSPATH
Execution log at: /tmp/hortonas/hortonas_20120907191414_d81163ac-2bec-4910-a4b0-ffba6e87a4a0.log
Job running in-process (local Hadoop)
Hadoop job information for null: number of mappers: 0; number of reducers: 0
2012-09-07 19:14:36,315 null map = 0%,  reduce = 0%
Ended Job = job_local_0001 with errors
Error during job, obtaining debugging information...
Execution failed with exit status: 2
Obtaining error information

Task failed!
Task ID:
  Stage-1

Logs:

/tmp/hortonas/hive.log
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask]>
	at org.apache.hive.pdk.PluginTest.runTest(PluginTest.java:59)
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)
	at junit.extensions.TestSetup$1.protect(TestSetup.java:23)
	at junit.extensions.TestSetup.run(TestSetup.java:27)
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)
	at junit.extensions.TestSetup$1.protect(TestSetup.java:23)
	at junit.extensions.TestSetup.run(TestSetup.java:27)


{code}, and the following log in /tmp/hortonas/hortonas_20120907191414_d81163ac-2bec-4910-a4b0-ffba6e87a4a0.log
{code}
java.lang.RuntimeException: Error in configuring object
	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:354)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:307)
	at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:177)
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
	... 5 more
Caused by: java.lang.RuntimeException: Error in configuring object
	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
	at org.apache.hadoop.mapred.MapRunner.configure(MapRunner.java:34)
	... 10 more
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
	... 13 more
Caused by: java.lang.RuntimeException: Map operator initialization failed
	at org.apache.hadoop.hive.ql.exec.ExecMapper.configure(ExecMapper.java:121)
	... 18 more
Caused by: java.lang.NoClassDefFoundError: org/codehaus/jackson/map/ObjectMapper
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDTFJSONTuple.<clinit>(GenericUDTFJSONTuple.java:54)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:113)
	at org.apache.hadoop.hive.ql.exec.FunctionRegistry.registerGenericUDTF(FunctionRegistry.java:545)
	at org.apache.hadoop.hive.ql.exec.FunctionRegistry.registerGenericUDTF(FunctionRegistry.java:539)
	at org.apache.hadoop.hive.ql.exec.FunctionRegistry.<clinit>(FunctionRegistry.java:472)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:154)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:98)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:137)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:898)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluatorsAndReturnStruct(Operator.java:924)
	at org.apache.hadoop.hive.ql.exec.SelectOperator.initializeOp(SelectOperator.java:60)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:358)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:434)
	at org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:390)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.initializeOp(TableScanOperator.java:166)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:358)
	at org.apache.hadoop.hive.ql.exec.MapOperator.initializeOp(MapOperator.java:441)
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:358)
	at org.apache.hadoop.hive.ql.exec.ExecMapper.configure(ExecMapper.java:98)
	... 18 more
Caused by: java.lang.ClassNotFoundException: org.codehaus.jackson.map.ObjectMapper
	at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:251)
	at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)
{code}, +1 I ran ant very-clean package test after applying the patch, and did not get this exception (just running ant test directly still gives the exception)

Thanks Zhenxiao, I will commit once the tests finish., Committed, thanks Zhenxiao Luo., Integrated in Hive-trunk-h0.21 #1665 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1665/])
    HIVE-3440. Fix pdk PluginTest failing on trunk-h0.21 (Zhenxiao Luo via kevinwilfong) (Revision 1384032)

     Result = SUCCESS
kevinwilfong : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1384032
Files : 
* /hive/trunk/ql/ivy.xml
, Integrated in Hive-trunk-hadoop2 #54 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/54/])
    HIVE-3440. Fix pdk PluginTest failing on trunk-h0.21 (Zhenxiao Luo via kevinwilfong) (Revision 1384032)

     Result = ABORTED
kevinwilfong : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1384032
Files : 
* /hive/trunk/ql/ivy.xml
, This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]