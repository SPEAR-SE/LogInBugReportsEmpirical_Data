[Initial patch for review; will add tests and update]