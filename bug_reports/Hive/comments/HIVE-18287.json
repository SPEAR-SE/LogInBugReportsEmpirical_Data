[It needs to use FileSystem.access methods to verify permission, so that effective permission that includes Ranger permissions is used.

This might be an issue with Sentry based permission as well cc [~akolb]].

, When Sentry is enabled, Hive runs everything as 'hive' user, so 'hive' user needs permissions to scratch dir. Sentry doesn't control scratch dir permissions. How does this work with Ranger?]