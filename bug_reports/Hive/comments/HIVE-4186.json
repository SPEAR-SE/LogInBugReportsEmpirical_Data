[patch is attached., [~rhbutani] Can you add testcase in a .q file and add it in your patch ?, its attached., There is no file data/files/part_tiny.txt on trunk at the moment. However since this bug occur during query compile phase, you don't need load data statement in any case. Even selecting on empty table will demonstrate the problem. So, I will suggest to get rid of load data statement from the patch for now., new patch is attached., +1 running tests., Committed to trunk. Thanks, Harish!, Integrated in Hive-trunk-h0.21 #2023 (See [https://builds.apache.org/job/Hive-trunk-h0.21/2023/])
    HIVE-4186 : NPE in ReduceSinkDeDuplication (Harish Butani via Ashutosh Chauhan) (Revision 1458524)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1458524
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java
* /hive/trunk/ql/src/test/queries/clientpositive/reducesink_dedup.q
* /hive/trunk/ql/src/test/results/clientpositive/reducesink_dedup.q.out
, Integrated in Hive-trunk-hadoop2 #138 (See [https://builds.apache.org/job/Hive-trunk-hadoop2/138/])
    HIVE-4186 : NPE in ReduceSinkDeDuplication (Harish Butani via Ashutosh Chauhan) (Revision 1458524)

     Result = FAILURE
hashutosh : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1458524
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java
* /hive/trunk/ql/src/test/queries/clientpositive/reducesink_dedup.q
* /hive/trunk/ql/src/test/results/clientpositive/reducesink_dedup.q.out
]