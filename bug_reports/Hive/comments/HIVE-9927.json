[the reason is because SkewJoinResolver will generate map join, and CommonJoinResolver will optimize skewjoin plan again, this cause problem.  
the simplest fix is just change the order of these two ,   put CommonJoinResolver before SkewJoinResolver ., after change the optimizer order,i test the [runtime_skewjoin_mapjoin_spark.q|https://github.com/apache/hive/blob/master/ql/src/test/queries/clientpositive/runtime_skewjoin_mapjoin_spark.q]   and [hive-14557|https://issues.apache.org/jira/browse/HIVE-14557],   both will be ok.  could you look at this [~lirui], [~wenli], thanks for looking into this issue. Do you want to work on it?]