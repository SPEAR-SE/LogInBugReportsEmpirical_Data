[Fixed by myself. 

Hadoop 3.0.0 use 9820 as the default RPC port while prior and later versions all used 8020, which leads to a compatibility problem.

I upgrade Hadoop to 3.0.3 and the compaction works perfectly now.

See this issue:
[Change default NameNode RPC port back to 8020|https://issues.apache.org/jira/browse/HDFS-12990]

 

 , Not a bug of Hive, but a compatibility problem of HDFS.]