[+1. Will commit after test., After a discussion with Yongqiang, there was a problem with nulls - can you hold on ?, Ignore my previous comment, we can handle nulls in a follow-up, it is a independent problem.
Filed: https://issues.apache.org/jira/browse/HIVE-1029 for the same, Committed. Thanks Namit!]