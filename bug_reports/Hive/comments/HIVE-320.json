[Do you have a testcase, I was not able to reproduce it.

, sounds like a blocker to me. 

Can we get a test case please (DDL, data etc)?, I'm generating the input into the schema using a custom serde. I'll work on stripping it down to get you a test case you can reproduce from but it may take some time. This is still consistently reproducible for me., Isnt there a workaround where users can specify 'column is not null' in the where clause?, I would still consider this a BLOCKER - the user may want to nulls. Too simple a test to ignore., Load balancing..., Found the bug - can someone review it - pretty simple change, looks good. +1, Fixes problem on my on my test case also.

Spent the better part of yesterday trying to distill a test case for you guys. It seems to happen only if there are at least two rows with the count(distinct) column null on both. Possibly it only occurs for custom serdes because as I was trying to adapt our proprietary format to something that I could post, it seemed that by using TextInputformat, the problem would go away. Can't confirm this 100% though. Since I saw a patch had been submitted, I stopped working on figuring it out.
, committed. Thanks Namit!!]