[Added a test case which makes the error appear in current implementation and fixed the bug., +1

The patch looks good - will commit after testing.
In the future, please use the convention: 

hive.<jira number>.1.patch
hive.<jira number>.2.patch
hive.<jira number>.3.patch
..


for the patches., Committed. Thanks Marcin, Integrated in Hive-trunk-h0.21 #829 (See [https://builds.apache.org/job/Hive-trunk-h0.21/829/])
    HIVE-2287 Error during UNARCHIVE of a partition
(Marcin Kurczych via namit)

namit : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1147366
Files : 
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
* /hive/trunk/ql/src/test/results/clientpositive/archive.q.out
* /hive/trunk/ql/src/test/queries/clientpositive/archive.q
]