[This patch removes the try catch block to allow the tests to fail if an unexpected exception is thrown. It also changes the various "empty string" checks to check for null values, which seems to be the current behaviour. The final piece is that internalInitialize was run twice, causing it to empty the string tokenizer and failing the tests., I think we should get rid of DynamicSerde and TCLSeperatedProtocol completely - it is not being used much anyway.
We should phase it out - in that case, I am not sure if we should invest in fixing bugs in that area. 

Your patch looks OK, but in the long run, I am not sure whether we want to support Dynamic SerDe or not., I think we should keep the internalInitialize() call in TCTLSeparatedProtocol, because people are not required to call initialize (per Thrift TProtocol interface).
Otherwise it looks good.

Given the interests of parsing apache logs, I think we will have to keep TCTLSeparatedProtocol for some time.
, Would the best alternative to DynamicSerde and TCLSeperatedProtocol be to implement a custom Apache weblog serde? I assume it is a reasonably common use case to parse weblogs.

If the internalInitialize() call is left in both the constructor and the initialize method it breaks the tests. The first call will consume the data from the transport and by the time the second call comes there won't be any data left to initialize with, resulting in a NullPointerException. Perhaps all the initializing can be moved to the constructor?, Johan, that makes sense - I agree we don't need "initialize" call in the constructor now.
The patch looks good. I will test the patch and commit.
, Committed. Thanks Johan!]