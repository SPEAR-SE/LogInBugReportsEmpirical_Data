[@binlijin,
Can you add a test case along with the patch?, @Ashutosh Chauhan
I add a test case in hive-2520.2.patch, njain requested code review of "HIVE-2520 [jira] left semi join will duplicate data".
Reviewers: JIRA

  HIVE-2520

  CREATE TABLE sales (name STRING, id INT)
  ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';

  CREATE TABLE things (id INT, name STRING)
  ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';

  The 'sales' table has data in a file: sales.txt, and the data is：
  Joe 2
  Hank 2

  The 'things' table has data int two files: things.txt and things2.txt：
  The content of things.txt is :
  2 Tie
  The content of things2.txt is :
  2 Tie

  SELECT * FROM sales LEFT SEMI JOIN things ON (sales.id = things.id);
  will output：
  Joe 2
  Joe 2
  Hank 2
  Hank 2
  so the result is wrong.

  In CommonJoinOperator left semi join should use " genObject(null, 0, new IntermediateObject(new ArrayList<span class="error">[numAliases]</span>, 0), true); " to generate data.
  but now it uses " genUniqueJoinObject(0, 0); " to generate data.
  This patch will solve this problem.

TEST PLAN
  EMPTY

REVISION DETAIL
  https://reviews.facebook.net/D717

AFFECTED FILES
  data/files/things.txt
  data/files/sales.txt
  data/files/things2.txt
  ql/src/test/results/clientpositive/leftsemijoin.q.out
  ql/src/test/queries/clientpositive/leftsemijoin.q
  ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java

MANAGE HERALD DIFFERENTIAL RULES
  https://reviews.facebook.net/herald/view/differential/

WHY DID I GET THIS EMAIL?
  https://reviews.facebook.net/herald/transcript/1563/

Tip: use the X-Herald-Rules header to filter Herald messages in your client.
, +1, Committed. Thanks binlijin, Integrated in Hive-trunk-h0.23.0 #13 (See [https://builds.apache.org/job/Hive-trunk-h0.23.0/13/])
    HIVE-2520 left semi join will duplicate data
(binlijin via namit)

namit : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1212738
Files : 
* /hive/trunk/data/files/sales.txt
* /hive/trunk/data/files/things.txt
* /hive/trunk/data/files/things2.txt
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java
* /hive/trunk/ql/src/test/queries/clientpositive/leftsemijoin.q
* /hive/trunk/ql/src/test/results/clientpositive/leftsemijoin.q.out
, Integrated in Hive-trunk-h0.21 #1137 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1137/])
    HIVE-2520 left semi join will duplicate data
(binlijin via namit)

namit : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1212738
Files : 
* /hive/trunk/data/files/sales.txt
* /hive/trunk/data/files/things.txt
* /hive/trunk/data/files/things2.txt
* /hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java
* /hive/trunk/ql/src/test/queries/clientpositive/leftsemijoin.q
* /hive/trunk/ql/src/test/results/clientpositive/leftsemijoin.q.out
, This issue is closed now. It was released with the fix in 0.9.0. If there is a problem, please open a new jira and link this one with that.]