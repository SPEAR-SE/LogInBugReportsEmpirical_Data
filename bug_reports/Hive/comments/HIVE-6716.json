[+1 LGTM, wondering though if it would be easy to write a unit test for it., [~prasanth_j] It is the same bug as I mentioned in https://issues.apache.org/jira/browse/HIVE-6631, right? If so, I will mark that one as duplicate., [~yhuai] yes it looks like the same one.. in your description if cg1 inner struct is null then it will throw NPE.. You can mark it as duplicate., ok. Have marked that one. Thanks., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12635937/HIVE-6716.1.patch

{color:red}ERROR:{color} -1 due to 2 failed/errored test(s), 5442 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_auto_sortmerge_join_16
org.apache.hive.service.cli.thrift.TestThriftBinaryCLIService.testExecuteStatementAsync
{noformat}

Test results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1930/testReport
Console output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1930/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12635937, Test failures are not related., +1 for 0.13, Committed to trunk and branch. Thanks [~prasanth_j]!]