[keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null 

Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/
-----------------------------------------------------------

(Updated 2011-11-09 09:04:42.416457)


Review request for hive, Siying Dong and Kevin Wilfong.


Changes
-------

I thought this patch is going to fix the bug in HIVE-2247, so I should put HIVE-2247 in the bugs field...It seems it is not like what I think.


Summary (updated)
-------

keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null

Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch


This addresses bug HIVE-2562.
    https://issues.apache.org/jira/browse/HIVE-2562


Diffs
-----

  trunk/metastore/if/hive_metastore.thrift 1199598 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199598 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199598 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199598 
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199598 
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199598 
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199598 
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199598 
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199598 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199598 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199598 

Diff: https://reviews.apache.org/r/2783/diff


Testing
-------


Thanks,

Weiyan

, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/#review3131
-----------------------------------------------------------



trunk/metastore/if/hive_metastore.thrift
<https://reviews.apache.org/r/2783/#comment6944>

    can this function just called rename_partition().


- Ning


On 2011-11-09 09:04:42, Weiyan Wang wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/2783/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-11-09 09:04:42)
bq.  
bq.  
bq.  Review request for hive, Siying Dong and Kevin Wilfong.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null
bq.  
bq.  Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch
bq.  
bq.  
bq.  This addresses bug HIVE-2562.
bq.      https://issues.apache.org/jira/browse/HIVE-2562
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    trunk/metastore/if/hive_metastore.thrift 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199598 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199598 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199598 
bq.  
bq.  Diff: https://reviews.apache.org/r/2783/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Weiyan
bq.  
bq.

, Remove the files /tmp/*9000 from your machine.
load_fs.q will succeed after that, 

bq.  On 2011-11-09 17:01:46, Ning Zhang wrote:
bq.  > trunk/metastore/if/hive_metastore.thrift, line 373
bq.  > <https://reviews.apache.org/r/2783/diff/2/?file=56941#file56941line373>
bq.  >
bq.  >     can this function just called rename_partition().

I agree with Ning's comment about the function name, everything else looks good to me.


- Kevin


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/#review3131
-----------------------------------------------------------


On 2011-11-09 09:04:42, Weiyan Wang wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/2783/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-11-09 09:04:42)
bq.  
bq.  
bq.  Review request for hive, Siying Dong and Kevin Wilfong.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null
bq.  
bq.  Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch
bq.  
bq.  
bq.  This addresses bug HIVE-2562.
bq.      https://issues.apache.org/jira/browse/HIVE-2562
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    trunk/metastore/if/hive_metastore.thrift 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199598 
bq.    trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199598 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199598 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199598 
bq.  
bq.  Diff: https://reviews.apache.org/r/2783/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Weiyan
bq.  
bq.

, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/
-----------------------------------------------------------

(Updated 2011-11-09 21:38:50.463372)


Review request for hive, Siying Dong and Kevin Wilfong.


Changes
-------

Address Ning's comment


Summary
-------

keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null

Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch


This addresses bug HIVE-2562.
    https://issues.apache.org/jira/browse/HIVE-2562


Diffs (updated)
-----

  trunk/metastore/if/hive_metastore.thrift 1199943 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199943 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199943 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199943 
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199943 
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199943 
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199943 
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199943 
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199943 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199943 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199943 

Diff: https://reviews.apache.org/r/2783/diff


Testing
-------


Thanks,

Weiyan

, 

bq.  On 2011-11-09 17:01:46, Ning Zhang wrote:
bq.  > trunk/metastore/if/hive_metastore.thrift, line 373
bq.  > <https://reviews.apache.org/r/2783/diff/2/?file=56941#file56941line373>
bq.  >
bq.  >     can this function just called rename_partition().
bq.  
bq.  Kevin Wilfong wrote:
bq.      I agree with Ning's comment about the function name, everything else looks good to me.

I am still running all unit tests.


- Weiyan


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/#review3131
-----------------------------------------------------------


On 2011-11-09 21:38:50, Weiyan Wang wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/2783/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-11-09 21:38:50)
bq.  
bq.  
bq.  Review request for hive, Siying Dong and Kevin Wilfong.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null
bq.  
bq.  Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch
bq.  
bq.  
bq.  This addresses bug HIVE-2562.
bq.      https://issues.apache.org/jira/browse/HIVE-2562
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    trunk/metastore/if/hive_metastore.thrift 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199943 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199943 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199943 
bq.  
bq.  Diff: https://reviews.apache.org/r/2783/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Weiyan
bq.  
bq.

, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/#review3141
-----------------------------------------------------------



trunk/metastore/if/hive_metastore.thrift
<https://reviews.apache.org/r/2783/#comment6951>

    can you keep the comments for this method (after reverting the changes to the comments as well). 



trunk/metastore/if/hive_metastore.thrift
<https://reviews.apache.org/r/2783/#comment6952>

    the comment here is not clear. are you changing the name of new_part with the name specified by part_vals or you want to change the partition identified by part_vals with the name found in new_part? 


- Ning


On 2011-11-09 21:38:50, Weiyan Wang wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/2783/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-11-09 21:38:50)
bq.  
bq.  
bq.  Review request for hive, Siying Dong and Kevin Wilfong.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null
bq.  
bq.  Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch
bq.  
bq.  
bq.  This addresses bug HIVE-2562.
bq.      https://issues.apache.org/jira/browse/HIVE-2562
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    trunk/metastore/if/hive_metastore.thrift 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199943 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199943 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199943 
bq.  
bq.  Diff: https://reviews.apache.org/r/2783/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Weiyan
bq.  
bq.

, Change comment in the thrift api, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/
-----------------------------------------------------------

(Updated 2011-11-10 05:46:57.500909)


Review request for hive, Siying Dong and Kevin Wilfong.


Summary
-------

keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null

Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch


This addresses bug HIVE-2562.
    https://issues.apache.org/jira/browse/HIVE-2562


Diffs (updated)
-----

  trunk/metastore/if/hive_metastore.thrift 1199943 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199943 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199943 
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199943 
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199943 
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199943 
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199943 
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199943 
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199943 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199943 
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199943 

Diff: https://reviews.apache.org/r/2783/diff


Testing
-------


Thanks,

Weiyan

, +1. Will commit if tests pass. , 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/2783/#review3150
-----------------------------------------------------------

Ship it!


- Ning


On 2011-11-10 05:46:57, Weiyan Wang wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/2783/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-11-10 05:46:57)
bq.  
bq.  
bq.  Review request for hive, Siying Dong and Kevin Wilfong.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null
bq.  
bq.  Run the "ant test". Only load_fs.q fails, but after I revert the patch and run "ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false" it still fails. So I think it's not a bug introduced by my patch
bq.  
bq.  
bq.  This addresses bug HIVE-2562.
bq.      https://issues.apache.org/jira/browse/HIVE-2562
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    trunk/metastore/if/hive_metastore.thrift 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199943 
bq.    trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199943 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199943 
bq.    trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199943 
bq.  
bq.  Diff: https://reviews.apache.org/r/2783/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Weiyan
bq.  
bq.

, Committed. Thanks Weiyan!, Integrated in Hive-trunk-h0.21 #1075 (See [https://builds.apache.org/job/Hive-trunk-h0.21/1075/])
    HIVE-2562. HIVE-2247 Changed the Thrift API causing compatibility issues. (Weiyan Wang via Ning Zhang)

nzhang : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1200442
Files : 
* /hive/trunk/metastore/if/hive_metastore.thrift
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h
* /hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp
* /hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
* /hive/trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php
* /hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote
* /hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py
* /hive/trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
* /hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
]