[All of them have order by clause. Likely same root cause as HIVE-4190., Actually all of them have window range spec, so then this is different than HIVE-4190. [~alangates] Can you upload a result diff for one of these queries. This could be related to stable sort issue., A diff from last night's run for the query:

select i, f, avg(d) over (partition by i order by f desc rows between 5 preceding and 5 following) from over100k;

Based on the output this doesn't look like a sort stability issue., Note, other than the query listed in the above comments all of the other queries using ROWS BETWEEN now produce correct results.
, One way this query is different from others is it has desc. Alan, can you run this query without desc and see if it still produces wrong results. If not, likely we have a bug in order by desc., The desc definitely causes an issue when you forget to put it into the verification query.  Once you do that all is good.  I'm closing this as invalid because the rest of the queries work now (the result of other patches checked in I assume) and this last one was a test error.]