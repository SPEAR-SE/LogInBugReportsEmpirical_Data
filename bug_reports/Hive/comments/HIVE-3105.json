[@Kevin: This is a duplicate of HIVE-3013. Can you please review that patch? Thanks.]