[I looked at Shrikrishna's query and the task logs. The mapper was spending time in processMapLocalWork() without reporting.
Attached patch fixes the problem., With a minor change from the earlier patch., What is the size of small table? and the number of rows in small table?, bq. What is the size of small table? and the number of rows in small table?
Small table has around 500 million rows. Big table has around 10000 million rows., The changes look good - but it might conflict with https://issues.apache.org/jira/browse/HIVE-1641 which is a much bigger patch, ans nearly ready.
So, I think we should hold on for HIVE-1672 till we are done with HIVE-1641, The patch failed to apply cleanly after HIVE-1641.

Can you regenerate the patch ?, I think the bug is not present after HIVE-1641 code changes. Will verify and upload a patch if it still exists., Can you close the jira if it has been fixed ?, The queries (Shrikrishna reported) run fine with HIVE-1641. This JIRA can be closed., Thanks Thiruvel. Closing it as duplicate.]