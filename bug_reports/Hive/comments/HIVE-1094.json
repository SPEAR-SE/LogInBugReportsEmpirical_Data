[I am not sure this is a good idea - for the last table, unless you stop streaming, you never know the size, hive.1094.patch contains a fix for both hive-1094 and hive-1090, +1

looks good - will commit if tests pass, committed. Thanks Yongqiang]