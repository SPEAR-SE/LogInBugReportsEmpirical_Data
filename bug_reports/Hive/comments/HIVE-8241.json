[Looks like the wrong ObjectInspector is used when vectorization is on., keyObject inspector is :
    org.apache.hadoop.hive.serde2.objectinspector.StandardStructObjectInspector<org.apache.hadoop.hive.serde2.objectinspector.primitive.WritableIntObjectInspector@4efbea36> 
while it should be 
    org.apache.hadoop.hive.serde2.objectinspector.StandardStructObjectInspector<org.apache.hadoop.hive.serde2.objectinspector.StandardUnionObjectInspectoruniontype<struct<_col0:int>>>, Issue starts in VectorExpressionWriterFactory.processVectorExpressions(List<ExprNodeDesc>, List<String>, SingleOIDClosure) line: 1044	
, [~gopalv]]