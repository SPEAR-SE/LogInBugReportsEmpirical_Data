[It turns out to be a bug in hive-0.23 for not supporting viewfs scheme. It's summed up as below:
[http://jason4zhu.blogspot.hk/2018/04/hive-on-spark-unable-to-find-class.html], Hey [~jason4z], thanks for reporting the this. The issue should have been fixed in HIVE-16292 and the fix version is 2.3.0. Which Hive version are you using? The code snippet in your blog post seems to be from an older version.]