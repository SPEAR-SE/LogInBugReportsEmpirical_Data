[The longValue function in Decimal128 rounds the value. HiveDecimal just discards the fractional part. This patch adds another method to Decimal128, that discards the fractional part, and is used in the CastDecimalToLong expression., Can you put this up on ReviewBoard?, Review board: https://reviews.apache.org/r/18808/, Updated patch addresses review comments., +1, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12633312/HIVE-6511.4.patch

{color:green}SUCCESS:{color} +1 5374 tests passed

Test results: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1674/testReport
Console output: http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1674/console

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12633312, I have committed this., This has been fixed in 0.14 release. Please open new jira if you see any issues.
]