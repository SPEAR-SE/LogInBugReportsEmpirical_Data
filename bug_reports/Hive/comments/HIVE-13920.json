[[~gopalv] fyi, Preallocating might actually allocate large number of arrays without actual need - a 10,000 row split shouldn't need 128 vector batches pre-created and adding to the garbage.

The allocation is currently inside the actual reader inner loop, which is a problem because for the first 128 invocations (& more), the allocation is actually performed.

The 128x more allocations than the regular Tez codepath is the problem, moving it around to a different part of code doesn't fix the actual perf issue., Well, it would remove the allocation from the path that is JITted.
We can assume that at least a few can be pre-allocated (10-50?); also that it matters more for larger splits (not large, 10s of ks of rows) than for 10k-size splits that are fast enough as it is.]