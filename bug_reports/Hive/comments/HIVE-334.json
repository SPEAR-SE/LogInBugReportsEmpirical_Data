[union3 output is non-deterministic right now. needs to be sorted., cant you just add a sort by clause to the query instead of storing it into a temporary table and then doing cluster by?, the test is for the case where unions write to a common table/directory. if i put a sort or cluster by after the unions - then the unions will not write to a directory - they will send data to reducesinkoperator. so we will lose coverage intended by the test., ah ok.

+1, committed. Thanks Joydeep!!]