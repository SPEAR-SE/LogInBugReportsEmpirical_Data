[i am not creating tmp directory and then renaming that to partition path since that is already being done in copy/replaceFiles() in Hive.java

so this would work for a table as well., there is a conflict with HIVE-324 which didn't get checked into trunk. so need to merge this with that patch before checking into trunk, another attempt at this.. merged with HIVE-324, branch 0.3 patch, +1.
Looks good. Will test and commit.
, previous doesn't solve the problem completely. there is another place where partition is getting created. so fixed that one as well., added a test for this., +1

Looks fine to me.

Will commit after running tests.
, I am not able to apply the latest patch to 0.3 branch. Can you upload a new one?, it merges for me with some offsets and compiles fine.
, committed. Thanks Prasad!!]