[[~gopalv] take a look?, I don't think the HashMap is a good idea, IdentityHashMap is safer.

Made the memoization more obvious in the attached patch., +1 your patch is better., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12704937/HIVE-9984.2.patch

{color:green}SUCCESS:{color} +1 7769 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3050/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/3050/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-3050/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12704937 - PreCommit-HIVE-TRUNK-Build, Committed to trunk. Thanks [~gopalv]!, Doc note:  This adds *hive.reorder.nway.joins* to HiveConf.java, so it needs to be documented for 1.2.0 in the wiki.

* [Configuration Properties -- Query and DDL Execution | https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-QueryandDDLExecution], Do you want to wait the release of 1.2.0 to update the wiki or we can do it now?, Do you want to wait the release of 1.2.0 to update the wiki or we can do it now?, Now is fine, because the wiki gives the release number for each configuration parameter.  Thanks [~damien.carol]!, This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]