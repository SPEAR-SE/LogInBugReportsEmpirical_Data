[Stacktrace
{code}
Exception running child : java.lang.NullPointerException
  at java.util.Hashtable.put(Hashtable.java:459)
  at java.util.Hashtable.putAll(Hashtable.java:523)
  at org.apache.hadoop.hive.common.StringableMap.toProperties(StringableMap.java:77)
  at org.apache.hadoop.hive.ql.txn.compactor.CompactorMR$CompactorMap.getWriter(CompactorMR.java:660)
  at org.apache.hadoop.hive.ql.txn.compactor.CompactorMR$CompactorMap.map(CompactorMR.java:636)
  at org.apache.hadoop.hive.ql.txn.compactor.CompactorMR$CompactorMap.map(CompactorMR.java:610)
{code}
, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12890671/HIVE-17391.01.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 7 failed/errored test(s), 11202 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_predicate_pushdown] (batchId=232)
org.apache.hadoop.hive.cli.TestAccumuloCliDriver.testCliDriver[accumulo_single_sourced_multi_insert] (batchId=232)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[optimize_nullscan] (batchId=162)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=157)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_explainuser_1] (batchId=171)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query14] (batchId=240)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query23] (batchId=240)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/7154/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/7154/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-7154/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12890671 - PreCommit-HIVE-Build, Talked with Ashutosh regarding this jira. Got great inputs.

I think we can differentiate the following cases in StringableMap.java's methods. 
Specifically its toString() and its constructors when it loops on Map.Entry's to process each entry. 
1. key is not null nor empty string, value is null.
2. key is not null nor empty string, value is empty string.

Another factor is Properties which is inherited from Hashtable<K, V> which does not allow null key nor value (vs StringableMap which is inherited from HashMap<K, V>).
So when StringableMap is converting itself to Properties object, we gets to the NullPointerException problem
of this jira simply Hashtable is supposed to throw a NullPointerException when a caller tries to add 
null key/value. , 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12891824/HIVE-17391.02.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 7 failed/errored test(s), 11224 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[optimize_nullscan] (batchId=162)
org.apache.hadoop.hive.cli.TestSparkPerfCliDriver.testCliDriver[query16] (batchId=241)
org.apache.hadoop.hive.cli.TestSparkPerfCliDriver.testCliDriver[query94] (batchId=241)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query14] (batchId=239)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query16] (batchId=239)
org.apache.hadoop.hive.cli.TestTezPerfCliDriver.testCliDriver[query94] (batchId=239)
org.apache.hadoop.hive.cli.control.TestDanglingQOuts.checkDanglingQOut (batchId=202)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/7275/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/7275/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-7275/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12891824 - PreCommit-HIVE-Build, [~eugene.koifman] 
Hey Eugene, 
Please review patch 02. 
Thanks, 
Steve. , there is leftover System.out
and some indentation issues

otherwise 
LGTM +1
, [~eugene.koifman]
Reflected on Eugene's comments. 
Thanks, Eugene. , committed to master (Hive 3.0)
thanks Steve for the contribution, This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.]