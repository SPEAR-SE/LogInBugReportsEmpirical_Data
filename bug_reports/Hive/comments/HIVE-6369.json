[{code}
2014-01-30 10:56:50,753 INFO  [main] mapreduce.Job (Job.java:printTaskEvents(1424)) - Task Id : attempt_1390984584295_0015_r_004034_0, Status : FAILED
Error: java.lang.ArrayIndexOutOfBoundsException: 26
        at org.apache.hadoop.hive.ql.io.orc.RunLengthIntegerWriterV2.preparePatchedBlob(RunLengthIntegerWriterV2.java:593)
        at org.apache.hadoop.hive.ql.io.orc.RunLengthIntegerWriterV2.determineEncoding(RunLengthIntegerWriterV2.java:541)
        at org.apache.hadoop.hive.ql.io.orc.RunLengthIntegerWriterV2.flush(RunLengthIntegerWriterV2.java:682)
        at org.apache.hadoop.hive.ql.io.orc.WriterImpl$IntegerTreeWriter.writeStripe(WriterImpl.java:752)
        at org.apache.hadoop.hive.ql.io.orc.WriterImpl$StructTreeWriter.writeStripe(WriterImpl.java:1330)
{code}, [~gopalv] Can you please check if HIVE-5991 patch is available in your test environment?, If it happens with the trunk, then my suspicion is that there are 64 bit values which causes overflow in mask creation. I will take a look at it once HIVE-5991 is confirmed., Yes, this is from a recent build.

But to make absolutely sure I disassembled the RLE writer from the built jar

{code}
private void preparePatchedBlob();
  Code:
   0:	lconst_1
   1:	aload_0
   2:	getfield	#142; //Field brBits95p:I
   5:	lshl
   6:	lconst_1
   7:	lsub
   8:	lstore_1
{code}

I can see that the operations are all lshl (long shift left) instead of ishl (integer shift left)., Awesome! Will look into it., Assigning this bug to me., Duplicate of HIVE-6382]