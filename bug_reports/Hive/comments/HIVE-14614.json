[[~spena] and [~mohitsabharwal] Can you please review the patch when you get a chance? Thanks!, Nit: I'd just define a new HADOOP_LOCAL_FS_SCHEME and do
{code}
+        isLocal = path.toUri().getScheme().equals(HADOOP_LOCAL_FS_SCHEME);
{code}
for readability.

Otherwise LGTM pending tests. [~spena] should take a look since he worked on HIVE-14270. , Patch looks good. Mohit's idea looks good to for better readability. 
We still need to check for (path != null), but the next line could be the above one., I looked into the implementation of Path. It is possible that the scheme can be null if you create a path without giving it a scheme eg new Path("/tmp/hive"). So I think we should have a null check for scheme as well. Updated the patch, adding suggestions from [~spena] and [~mohitsabharwal]. Thanks for the review., JIRA seems to be renaming my old patch with the same name as the new patch. Attaching it one more time., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12825498/HIVE-14614.3.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 6 failed/errored test(s), 10462 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.org.apache.hadoop.hive.cli.TestCliDriver
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_mapjoin]
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ctas]
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_join_part_col_char]
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[acid_bucket_pruning]
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3]
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/1001/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/1001/console
Test logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-1001/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 6 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12825498 - PreCommit-HIVE-MASTER-Build, +1, [~vihangk1] I will apply the patch2. There is only one line difference, and It is better than creating another variable that is repeated.
, [~vihangk1] One more thing, could you add some unit tests on {{TestContext.java}} ?, Attaching the patch with added testcase for local paths for the getTempDirForPath method in TestContext.java as suggested by [~spena], Attaching the patch one more time. HiveQA seems to not picking it up. Old logs are lost. Will monitor the new runs to check the logs., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12826047/HIVE-14614.05.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 10466 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.org.apache.hadoop.hive.cli.TestCliDriver
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[acid_mapjoin]
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[vector_join_part_col_char]
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainuser_3]
org.apache.hive.jdbc.TestJdbcWithMiniHS2.testAddJarConstructorUnCaching
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/1034/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/1034/console
Test logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-1034/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12826047 - PreCommit-HIVE-MASTER-Build, Patch looks good.
+1, thanks [~vihangk1] I committed to master 2.2]