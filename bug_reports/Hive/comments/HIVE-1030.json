[+1

will commit if the tests pass, Currently there are other places using File.createTempFile in the persistent data structures (HashMapWrapper and RowContainer). We have the File.deleteOnExit(true) set to ensure the temp file got deleted when the job is killed or normal exit. Is there any issue there as well? Should we also convert that to using ScratchDir?, Committed. Thanks Zheng, Good catch Ning. Here is another place to fix (HIVE-1030.2.patch).

I guess HashMapWrapper runs in mapper or reducer.
It should be OK because in mapper/reducer, Hadoop automatically sets java.io.tmpdir according to http://hadoop.apache.org/common/docs/r0.18.3/mapred_tutorial.html
And java.io.tmpdir is used in File.getTempDir.
]