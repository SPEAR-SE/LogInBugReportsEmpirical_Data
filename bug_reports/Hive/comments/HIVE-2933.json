[Can you add a test ?, test added., please review it., +1 will commit if tests pass., Error messages have changed. Ransom, can you regenerate the patch., after my test.
hive 0.9 and 0.10 also have this problems.
so I create patchs for them., 0.10 metastore is already changed. it doesn't contains. 
so remove 0.10 patch., recommit it., add patchs for 0.8.1 and 0.10.
all patchs was tested.please review it., Please supply the patch for trunk only.

Also, there should no nullpointerexception error message checked in, in trunk , analyze command returns "FAILED: NullPointerException null",
 so it's already fixed in trunk.
I remove patch for trunk.
, please review patch for 0.9, Typically we do not backport patches. Sorry we did not get to this sooner., can we close it? because it's already fixed in trunk., Fixed in trunk, This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]