[TestStreaming_3
TestStreaming_4
TestMapReduce_2
TestPig_9

, Should close the file in finally block instead. Update the patch., I would update the comment with something like "need to close() because in some FileSystem implementations flush() is no-op"
With that modification I'm +1
, Add the comments Eugene suggested., +1, I am sorry, this patch does not apply to trunk anymore. Can you please rebase ?
Can you also use name like HIVE-5540.X.patch  ? That works with the precommit test formats -  https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing, Resync with trunk., Patch committed to trunk.]