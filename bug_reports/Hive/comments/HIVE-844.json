[some test fixes, @hive.844.1.patch:

Reviewed with Namit offline:
1.ppr.PartitionPruner.onlyContainsPartnCols should look for nondeterministic functions as well. (Please add a test for that);
2. We can do the FetchTask logic before splitting the plans instead of while splitting.
, Committed. Thanks Namit!]