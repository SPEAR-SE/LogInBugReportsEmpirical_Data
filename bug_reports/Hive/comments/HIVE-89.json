[Based on the error message, one row of the data has "2004-12-22" in the column for computing max/min/avg.

I will change the UDAFs to detect it and treat these numbers as NULL.
, Thank you a lot.
    , Hi Zheng Shao,
 
    But min , max  can't for date type .It's very useful function for date type .  
  
    Can you have plan for this demand?  , It's already fixed in the new hive code from http://svn.apache.org/repos/asf/hadoop/hive/trunk

YihuieyChyi, one temporary way to do min/max for the date is to extract the year, month and day out of the date using predefined functions provided by Hive.

can you open a new ticket for the direct support of the date type functions?, Thank you a lot . 
I'll try it ,and give you feedback.]