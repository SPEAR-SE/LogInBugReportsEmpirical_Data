[Dropping an external table should not delete data. Are you saying that 'create table like' does not preserver the external property?, It seems that "create external table like"  does not preserve the external property.  

Note that both the original table S and the new table T are external, and data loss will only occur when creating T using statement
"create external table T like S location L".  No data loss if T with full table definitions (i.e, does not use like statement)

, https://reviews.apache.org/r/604/, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/604/
-----------------------------------------------------------

Review request for hive.


Summary
-------

Review request for HIVE-2086.  The external parameters were being set, but then being zeroed out by a call to params.clear(), resulting in an external table that wasn't marked as external.


This addresses bug HIVE-2086.
    https://issues.apache.org/jira/browse/HIVE-2086


Diffs
-----

  build-common.xml 9f21a69 
  data/files/ext_test/test.dat PRE-CREATION 
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 9d8919c 
  ql/src/test/queries/clientpositive/create_like.q 2edde83 
  ql/src/test/results/clientpositive/create_like.q.out 63a8939 

Diff: https://reviews.apache.org/r/604/diff


Testing
-------

Automated tests added


Thanks,

Jonathan

, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/604/#review507
-----------------------------------------------------------



ql/src/test/queries/clientpositive/create_like.q
<https://reviews.apache.org/r/604/#comment1031>

    the $var is cool!


- Ning


On 2011-04-15 01:34:56, Jonathan Natkins wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/604/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-04-15 01:34:56)
bq.  
bq.  
bq.  Review request for hive.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  Review request for HIVE-2086.  The external parameters were being set, but then being zeroed out by a call to params.clear(), resulting in an external table that wasn't marked as external.
bq.  
bq.  
bq.  This addresses bug HIVE-2086.
bq.      https://issues.apache.org/jira/browse/HIVE-2086
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    build-common.xml 9f21a69 
bq.    data/files/ext_test/test.dat PRE-CREATION 
bq.    ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 9d8919c 
bq.    ql/src/test/queries/clientpositive/create_like.q 2edde83 
bq.    ql/src/test/results/clientpositive/create_like.q.out 63a8939 
bq.  
bq.  Diff: https://reviews.apache.org/r/604/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  Automated tests added
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Jonathan
bq.  
bq.

, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/604/#review508
-----------------------------------------------------------

Ship it!


- Ning


On 2011-04-15 01:34:56, Jonathan Natkins wrote:
bq.  
bq.  -----------------------------------------------------------
bq.  This is an automatically generated e-mail. To reply, visit:
bq.  https://reviews.apache.org/r/604/
bq.  -----------------------------------------------------------
bq.  
bq.  (Updated 2011-04-15 01:34:56)
bq.  
bq.  
bq.  Review request for hive.
bq.  
bq.  
bq.  Summary
bq.  -------
bq.  
bq.  Review request for HIVE-2086.  The external parameters were being set, but then being zeroed out by a call to params.clear(), resulting in an external table that wasn't marked as external.
bq.  
bq.  
bq.  This addresses bug HIVE-2086.
bq.      https://issues.apache.org/jira/browse/HIVE-2086
bq.  
bq.  
bq.  Diffs
bq.  -----
bq.  
bq.    build-common.xml 9f21a69 
bq.    data/files/ext_test/test.dat PRE-CREATION 
bq.    ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 9d8919c 
bq.    ql/src/test/queries/clientpositive/create_like.q 2edde83 
bq.    ql/src/test/results/clientpositive/create_like.q.out 63a8939 
bq.  
bq.  Diff: https://reviews.apache.org/r/604/diff
bq.  
bq.  
bq.  Testing
bq.  -------
bq.  
bq.  Automated tests added
bq.  
bq.  
bq.  Thanks,
bq.  
bq.  Jonathan
bq.  
bq.

, +1. Will commit if tests pass. , Jonathan, there are a few diffs in the unit tests (1 in TestHBaseCliDriver and 6 in TestCliDriver). Can you take a look?, Sorry about that, I've updated the diffs.  This time, there shouldn't be any failures, 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/604/
-----------------------------------------------------------

(Updated 2011-04-27 16:00:50.150750)


Review request for hive.


Changes
-------

Fixing test diffs


Summary
-------

Review request for HIVE-2086.  The external parameters were being set, but then being zeroed out by a call to params.clear(), resulting in an external table that wasn't marked as external.


This addresses bug HIVE-2086.
    https://issues.apache.org/jira/browse/HIVE-2086


Diffs (updated)
-----

  build-common.xml 00c3680 
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 22fde53 
  ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java 06a0447 
  ql/src/test/queries/clientpositive/create_like.q 2edde83 
  ql/src/test/results/clientpositive/create_like.q.out 63a8939 

Diff: https://reviews.apache.org/r/604/diff


Testing
-------

Automated tests added


Thanks,

Jonathan

, +1
, @Johnathan, there are some tests failing. In particular the newly added test also failed (the output attached). Can you take a look and see if it is caused by newly committed patches (I've tested on the lasted trunk). , Has this patch been committed or is anyone still working on this particular patch?, It looks like this was actually just fixed today, as a part of HIVE-1218.  However, that fix didn't add any regression tests for this bug, so I'm going to prepare an updated patch once I finish running the test suite., 
-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/604/
-----------------------------------------------------------

(Updated 2011-07-19 16:50:07.742470)


Review request for hive.


Changes
-------

The bug was fixed as a part of HIVE-1218, and this diff adds some regression tests for this particular issue.


Summary
-------

Review request for HIVE-2086.  The external parameters were being set, but then being zeroed out by a call to params.clear(), resulting in an external table that wasn't marked as external.


This addresses bug HIVE-2086.
    https://issues.apache.org/jira/browse/HIVE-2086


Diffs (updated)
-----

  build-common.xml b6807fa 
  data/files/ext_test/test.dat PRE-CREATION 
  ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java 6d742e5 
  ql/src/test/queries/clientpositive/create_like.q 3f8e58d 
  ql/src/test/results/clientpositive/create_like.q.out 118235e 

Diff: https://reviews.apache.org/r/604/diff


Testing
-------

Automated tests added


Thanks,

Jonathan

, Just regression tests, +1. Will commit if tests pass., Committed to trunk. Thanks Natty!, Integrated in Hive-trunk-h0.21 #841 (See [https://builds.apache.org/job/Hive-trunk-h0.21/841/])
    HIVE-2086. Add test coverage for external table data loss issue (Jonathan Natkins via cws)

cws : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1149331
Files : 
* /hive/trunk/data/files/ext_test
* /hive/trunk/ql/src/test/queries/clientpositive/create_like.q
* /hive/trunk/ql/src/test/results/clientpositive/create_like.q.out
* /hive/trunk/data/files/ext_test/test.dat
* /hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
* /hive/trunk/build-common.xml
]