[Close it as invalid. You should increase the memory of container. (set hive.tez.container.size=<container_size>), Such issues should be sent to user@hive.apache.org for memory tuning guidance as they are usually not bugs but rather due to misconfigurations or require certain params to be tuned. , [~wyukawa]: this looks more like a Hive issue than a Tez specific issue. I have moved this into Hive for now.

A complete analysis of the issue requires a heapdump and at least, a basic report from Eclipse MAT. Do

set hive.tez.java.opts=-XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+UseNUMA -XX:+UseG1GC -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/;

and whenever this happens, the machine will write a *.hprof file to /tmp/.

You can generate a bug report from that file with the help of Eclipse MAT - the report .zip file has something like http://www.eclipse.org/mat/about/overview.png

]