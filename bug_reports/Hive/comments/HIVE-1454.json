[it's difficult to add queries that can test this. the reason is that we need two different valid and different Hadoop FileSystems to replicate this problem. this is not trivial.

medium term - as part of HIVE-1408 - i will add a new dummy Hadoop filesystem (that will just use local storage underneath). Then we will be able to systematically test this using our regression queries., +1. will commit after tests pass., I just committed. Thanks Joydeep!, Yongqiang - did u commit this to 0.6 as well?, no, i only committed it to trunk. Do you need me to commit this to 0.6 as well?, Also committed this patch to branch-0.6.]