[Looks like it is trying to cast s1 as the type of s1.f4 

{code}
        rb.currVal =
          GenericUDAFRank.copyToStandardObject(parameters, inputOI, ObjectInspectorCopyOption.JAVA);
{code}

gets parameters[0] as a Struct instead of getting it as two different integer values. The struct is not extracted into two values - but remains as a LazyStruct., When GenericUDAFRank is initialized, it inits correctly with input as "org.apache.hadoop.hive.serde2.objectinspector.primitive.WritableIntObjectInspector" output as "org.apache.hadoop.hive.serde2.objectinspector.primitive.JavaIntObjectInspector". But somewhere in the processing, it is changed to "LazyBinaryStruct"]