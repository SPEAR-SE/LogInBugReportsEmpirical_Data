[[~mmccline] This looks like a vectorization issue. I tried to repro this issue initially thinking its related to ORC PPD. But the issue seems to be with vectorization. Disabling vectorization returns correct result as text format. 

[~the6campbells] Thanks for reporting the issue. Temporary workaround for this issue is to disable vectorization by setting hive.vectorized.execution.enabled=false;, MR: VectorMapJoinOperator input batch:

{code}
VectorizedBatchUtil.java:debugDisplayOneRow(694)) - process row 0 (col 0) 0 (col 1) NULL 
VectorizedBatchUtil.java:debugDisplayOneRow(694)) - process row 1 (col 0) 1 (col 1) -1 
VectorizedBatchUtil.java:debugDisplayOneRow(694)) - process row 2 (col 0) 2 (col 1) 0 
VectorizedBatchUtil.java:debugDisplayOneRow(694)) - process row 3 (col 0) 3 (col 1) 1 
VectorizedBatchUtil.java:debugDisplayOneRow(694)) - process row 4 (col 0) 4 (col 1) 10 
{code}

Very strange -- the key expressions are both empty?

{code}
  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: tsint
            Statistics: Num rows: 5 Data size: 36 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rnum (type: int), csint (type: smallint)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 5 Data size: 36 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 
                  1 
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 5 Data size: 39 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: _col1 BETWEEN _col3 AND _col3 (type: boolean)
                  Statistics: Num rows: 2 Data size: 15 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: int), _col2 (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2 Data size: 15 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      Statistics: Num rows: 2 Data size: 15 Basic stats: COMPLETE Column stats: NONE
                      table:
                          input format: org.apache.hadoop.mapred.TextInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Execution mode: vectorized
      Local Work:
        Map Reduce Local Work
{code}, Ok, empty condition map is because the join is a cross join.

FilterLongColumnBetween works on scalar input.  Why was it chosen to evaluate the BETWEEN clause on the column tsint.csint?, The leftValue and rightValue being passed to FilterLongColumnBetween are the column number not a left or right scalar., VectorizationContext needs to not vectorize this query when the left or right is a non-constant., LGTM, +1, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12775633/HIVE-11372.01.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 12 failed/errored test(s), 9876 tests executed
*Failed tests:*
{noformat}
TestHWISessionManager - did not produce a TEST-*.xml file
TestMiniTezCliDriver-vectorization_16.q-schema_evol_orc_acidvec_mapwork_part.q-vector_partitioned_date_time.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_udf_max
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_vector_between_columns
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_dynamic_partition_pruning
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_vectorized_dynamic_partition_pruning
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_mergejoin
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_shutdown
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver_vector_between_columns
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs.testGetPartitionSpecs_WithAndWithoutPartitionGrouping
org.apache.hive.jdbc.TestSSL.testSSLVersion
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6236/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6236/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6236/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 12 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12775633 - PreCommit-HIVE-TRUNK-Build, New tests failed due to new hive.mapred.mode=nonstrict requirement., Committed to master, [~mmccline], since Dec. 2 any commit to master is for release 2.1.0, not 2.0.0.

Sergey's message to dev@hive said:  "branch-2.0 has been created as of git commit bbe23403cf34e27af04a271c49d484d2fbbd8656.  Please use 2.1 fixVersion for master commits and backport JIRAs that should go into 2.0 release to the release branch.", (The release branch is branch-2.0.), Committed to branch-1, Committed to branch-2.0]