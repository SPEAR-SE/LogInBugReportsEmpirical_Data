[Wouldn't the new node not have the fragment to start with?
So, either it has both the fragment and then finishable update, or neither?, Using dynamic ports will avoid this to a large extent. The actual fix is likely to required a change in Tez to propagate additional node information from the scheduler to the task communicator, and the task communicator to watch for node failure updates.
https://issues.apache.org/jira/browse/HIVE-15164 changes the default port., Finishable updates are sent out at the vertex level, instead of the fragment level.]