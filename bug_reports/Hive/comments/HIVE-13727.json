[The rejection of the first query doesn't seem to be justified. It's a typical top-n query, but the data is available in two tables. So an optimized way of getting top-n is to get the top-n values from both tables and getting top-n from 2n elements, instead of from the entire union of two tables. 

, The issue might be because of HIVE-9039 https://github.com/apache/hive/commit/87a7e134a49df80220a73c48d104d5cea722e76c, [~prongs] Was this query used to work prior to HIVE-9039 commit ?, [~ashutoshc] I've only been following hive master for a few months now. I haven't tested this thing on hive master prior to HIVE-9039. Though I've used hive 0.13 releases and it used to work there. , I got the exception when parsing sql with hive1.2.1]