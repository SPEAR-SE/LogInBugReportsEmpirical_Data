[
Detailed system log:

{code}
2015-08-03 23:08:08,920 INFO  [main]: physical.Vectorizer (Vectorizer.java:specializeMapJoinOperator(1517)) - Vectorizer vectorizeOperator map join hashTableKind HASH_SET hashTableKeyType MULTI_KEY
2015-08-03 23:08:08,920 INFO  [main]: vector.VectorizationContext (VectorizationContext.java:<init>(184)) - VectorizationContext consructor reference contextName MAPJOIN level 1
2015-08-03 23:08:08,920 DEBUG [main]: vector.VectorizationContext (VectorizationContext.java:getVectorExpression(450)) - Input Expression = string, Vectorized Expression = IdentityExpression[0]
2015-08-03 23:08:08,920 DEBUG [main]: vector.VectorizationContext (VectorizationContext.java:getVectorExpression(450)) - Input Expression = string, Vectorized Expression = IdentityExpression[2]
2015-08-03 23:08:08,921 DEBUG [main]: vector.VectorizationContext (VectorizationContext.java:getVectorExpression(450)) - Input Expression = string, Vectorized Expression = IdentityExpression[0]
2015-08-03 23:08:08,921 DEBUG [main]: vector.VectorizationContext (VectorizationContext.java:getVectorExpression(450)) - Input Expression = string, Vectorized Expression = IdentityExpression[1]
2015-08-03 23:08:08,921 DEBUG [main]: vector.VectorizationContext (VectorizationContext.java:getVectorExpression(450)) - Input Expression = string, Vectorized Expression = IdentityExpression[2]
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(453)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor order [0, 1]
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(454)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor posBigTable 0
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(455)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor posSingleVectorMapJoinSmallTable 1
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(457)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableKeyColumnMap [0, 2]
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(458)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableKeyTypeNames [string, string]
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(460)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableValueColumnMap [0, 1, 2]
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(461)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableValueTypeNames [string, string, string]
2015-08-03 23:08:08,921 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(463)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor smallTableIndices [1, -1, 0]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(464)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor smallTableRetainList [0, 1, 2]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(466)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor firstSmallTableOutputColumn 3
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(467)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor smallTableOutputCount 3
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(469)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableRetainedMapping source columns: [0, 1, 2], output columns: [0, 1, 2], type names: [string, string, string]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(471)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableOuterKeyMapping source columns: [], output columns: [], type names: []
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(473)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor smallTableMapping source columns: [0], output columns: [3], type names: [string]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(475)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor bigTableByteColumnVectorColumns []
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(476)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor smallTableByteColumnVectorColumns [3]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(478)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor outputProjection [0, 1, 2, 2, 3, 0]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:determineCommonInfo(479)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor outputTypeNames [string, string, string, string, string, string]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(511)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor outputColumnNames [_col0, _col1, _col2, _col6, _col7, _col8]
2015-08-03 23:08:08,922 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(523)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor addProjectionColumn 0 columnName _col0 outputColumn 0
2015-08-03 23:08:08,923 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(523)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor addProjectionColumn 1 columnName _col1 outputColumn 1
2015-08-03 23:08:08,923 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(523)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor addProjectionColumn 2 columnName _col2 outputColumn 2
2015-08-03 23:08:08,923 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(523)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor addProjectionColumn 3 columnName _col6 outputColumn 2
2015-08-03 23:08:08,923 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(523)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor addProjectionColumn 4 columnName _col7 outputColumn 3
2015-08-03 23:08:08,923 DEBUG [main]: mapjoin.VectorMapJoinCommonOperator (VectorMapJoinCommonOperator.java:setupVOutContext(523)) - null, MAPJOIN_19 VectorMapJoinCommonOperator constructor addProjectionColumn 5 columnName _col8 outputColumn 0
2015-08-03 23:08:08,923 INFO  [main]: physical.Vectorizer (Vectorizer.java:specializeMapJoinOperator(1587)) - Vectorizer vectorizeOperator map join class VectorMapJoinLeftSemiMultiKeyOperator
2015-08-03 23:08:08,923 INFO  [main]: physical.Vectorizer (Vectorizer.java:vectorizeOperator(1717)) - vectorizeOperator org.apache.hadoop.hive.ql.exec.vector.mapjoin.VectorMapJoinLeftSemiMultiKeyOperator
2015-08-03 23:08:08,923 INFO  [main]: physical.Vectorizer (Vectorizer.java:vectorizeOperator(1718)) - vectorizeOperator org.apache.hadoop.hive.ql.plan.MapJoinDesc
2015-08-03 23:08:08,923 DEBUG [main]: physical.Vectorizer (Vectorizer.java:process(754)) - Vectorized MapWork operator MAPJOIN added vectorization context Context name MAPJOIN, level 1, sorted projectionColumnMap {0=_col0, 1=_col1, 2=_col2, 3=_col7}, sorted scratchColumnTypeMap {3=String}
{code}, Offhand, as Gopal suspected, it seems like the Join is marked as LEFT_SEMI_JOIN, but the the smallTableIndices [1, -1, 0]  and smallTableRetainList [0, 1, 2] are asking for non-key columns.  The Native Vector MapJoin classes VectorMapJoinLeftSemi{Long|MultiKey|String}Operator are optimized to not output non-key columns.  Thus, the NPE.

So, looks like planner is mis-classifying the query and the Vectorizer class checking for specialization needs to be paranoid and verify LEFT SEMI characteristics., Would be great to narrow down the planner issue here, so that the vectorizer doesn't wallpaper over a bad plan., Not misclassifying but not pruning the small table non-key columns for the join result output., Hi [~mmccline], 

Is there any progress for this JIRA? We hit the same error. 

Thanks,
Selina , No progress.  There is a work-around: specify the columns you want instead of using select *, This (or a very similar top of callstack) also happens for simpler queries  - e.g. select * from foo where decimal_id in (1234, 134535, 4545) (in has integers, the in column is a decimal)]