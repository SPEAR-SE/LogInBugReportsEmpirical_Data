[I am getting some compilation errors while applying this patch - URI and URISyntaxException not found.
Can you import the relevant packages/files and then resubmit the patch ?, Sorry about that - upload the wrong patch for this and 1007., +1

will commit if the tests pass and will file a follow-up jira of inconsistent path formats in pathToPartitionInfo, Committed. Thanks Dave]