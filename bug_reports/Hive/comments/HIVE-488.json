[a simple work around is to create the partition before doing insert overwrite using query like below

alter table hive_test_dst add partition( pcol1='test_part', pcol2='test_part');, if the partition is to be copied to  a/b/c and if a/b doesn't exist, rename(tmpdir, a/b/c) fails. this failure case was never caught but with HIVE-442 this bug is exposed since HIVE-442 explicitly does not create the partition before data is moved. this patch tries to create parent directory (a/b) so it preserves the semantics of not creating a partition until data is moved.

also removed 'add partition' since load automatically creates the partition if one doesn't exist., added the data file used in the test., I think the checkin was not meant for HIVE-488.

Also, how will the code work for the case where the partition hierarchy is n deep where n >= 3 ?
, Looks like this is a JIRA bug.

+1 for the fix.
, this looks like it's been committed for a while .. - mark as fixed?]