[#1) disable optimization in case the literal can't be evaluated on the other branch, +1 
Although we may potentially introduce casts, I think its better to not do that for such type-unsafe queries., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12888072/HIVE-17568.01.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 171 failed/errored test(s), 11047 tests executed
*Failed tests:*
{noformat}
TestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=230)
TestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=230)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[annotate_stats_join_pkfk] (batchId=14)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join11] (batchId=8)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join12] (batchId=23)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join13] (batchId=77)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join14] (batchId=14)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join16] (batchId=38)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join27] (batchId=86)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join4] (batchId=68)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join5] (batchId=70)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join8] (batchId=83)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[auto_join_without_localtask] (batchId=1)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cbo_const] (batchId=17)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cbo_rp_auto_join1] (batchId=3)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cbo_rp_outer_join_ppr] (batchId=7)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[comments] (batchId=36)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[correlationoptimizer10] (batchId=74)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[correlationoptimizer13] (batchId=10)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[correlationoptimizer8] (batchId=12)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[correlationoptimizer9] (batchId=6)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[create_view] (batchId=39)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[cross_join_merge] (batchId=6)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[empty_join] (batchId=76)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[filter_cond_pushdown] (batchId=58)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[filter_join_breaktask] (batchId=72)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[fouter_join_ppr] (batchId=31)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[gby_star] (batchId=16)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[groupby_position] (batchId=38)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_auto_mult_tables] (batchId=82)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[index_auto_mult_tables_compact] (batchId=34)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join11] (batchId=51)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join12] (batchId=39)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join13] (batchId=3)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join14] (batchId=20)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join16] (batchId=29)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join34] (batchId=68)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join35] (batchId=63)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join38] (batchId=77)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join4] (batchId=62)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join5] (batchId=67)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join8] (batchId=46)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[join_vc] (batchId=4)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[louter_join_ppr] (batchId=42)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[mapjoin_mapjoin] (batchId=48)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[mergejoins] (batchId=2)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[mergejoins_mixed] (batchId=69)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[outer_join_ppr] (batchId=19)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_gby_join] (batchId=35)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_join2] (batchId=40)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_join3] (batchId=18)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_join] (batchId=35)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_outer_join1] (batchId=41)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_outer_join2] (batchId=30)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_outer_join3] (batchId=45)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_outer_join4] (batchId=64)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[ppd_random] (batchId=82)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[rcfile_null_value] (batchId=26)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[regex_col] (batchId=15)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[router_join_ppr] (batchId=77)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[subquery_in_having] (batchId=56)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[udf_mask_hash] (batchId=28)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union22] (batchId=13)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union24] (batchId=58)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union27] (batchId=5)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[union_offcbo] (batchId=44)
org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver[hbase_queries] (batchId=95)
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver[unionDistinct_1] (batchId=143)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[auto_smb_mapjoin_14] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[auto_sortmerge_join_9] (batchId=159)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[bucket_map_join_tez2] (batchId=148)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[bucketsortoptimize_insert_7] (batchId=157)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[cbo_rp_lineage2] (batchId=147)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[constprog_semijoin] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[dynamic_partition_pruning] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[empty_join] (batchId=161)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[explainuser_1] (batchId=153)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[explainuser_4] (batchId=154)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[filter_join_breaktask] (batchId=160)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[hybridgrace_hashjoin_1] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[lineage2] (batchId=157)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[lineage3] (batchId=155)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[llap_vector_nohybridgrace] (batchId=151)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[mapjoin_mapjoin] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[smb_mapjoin_14] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[smb_mapjoin_4] (batchId=150)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[smb_mapjoin_5] (batchId=163)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[smb_mapjoin_6] (batchId=152)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[subquery_in] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[subquery_multi] (batchId=149)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[subquery_notin] (batchId=160)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[subquery_scalar] (batchId=154)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[subquery_views] (batchId=148)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[tez_dynpart_hashjoin_1] (batchId=162)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[tez_smb_empty] (batchId=153)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[tez_vector_dynpart_hashjoin_1] (batchId=160)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_auto_smb_mapjoin_14] (batchId=152)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vector_inner_join] (batchId=160)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[vectorized_dynamic_partition_pruning] (batchId=152)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[constprog_semijoin] (batchId=171)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_dynamic_partition_pruning] (batchId=169)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_dynamic_partition_pruning_3] (batchId=171)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_dynamic_partition_pruning_mapjoin_only] (batchId=170)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_explainuser_1] (batchId=170)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_use_op_stats] (batchId=169)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_use_ts_stats_for_mapjoin] (batchId=170)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_vectorized_dynamic_partition_pruning] (batchId=169)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[vector_inner_join] (batchId=171)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_1] (batchId=99)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_2] (batchId=100)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[explainanalyze_4] (batchId=100)
org.apache.hadoop.hive.cli.TestMiniTezCliDriver.testCliDriver[hybridgrace_hashjoin_1] (batchId=99)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[drop_table_failure2] (batchId=89)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=234)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=234)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query40] (batchId=234)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query72] (batchId=234)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query75] (batchId=234)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query80] (batchId=234)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query85] (batchId=234)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join11] (batchId=105)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join12] (batchId=111)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join13] (batchId=136)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join14] (batchId=107)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join16] (batchId=117)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join27] (batchId=139)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join4] (batchId=131)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join5] (batchId=132)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join8] (batchId=138)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_join_without_localtask] (batchId=101)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_smb_mapjoin_14] (batchId=126)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[auto_sortmerge_join_9] (batchId=129)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[bucket_map_join_tez2] (batchId=106)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[bucketsortoptimize_insert_7] (batchId=123)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[filter_join_breaktask] (batchId=133)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[groupby_position] (batchId=117)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join11] (batchId=123)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join12] (batchId=118)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join13] (batchId=102)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join14] (batchId=110)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join16] (batchId=114)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join34] (batchId=131)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join35] (batchId=128)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join38] (batchId=135)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join4] (batchId=128)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join5] (batchId=130)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join8] (batchId=121)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[join_vc] (batchId=102)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[louter_join_ppr] (batchId=119)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[mapjoin_mapjoin] (batchId=122)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[mergejoins] (batchId=101)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[mergejoins_mixed] (batchId=131)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[outer_join_ppr] (batchId=110)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_gby_join] (batchId=116)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_join2] (batchId=119)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_join3] (batchId=109)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_join] (batchId=116)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_outer_join1] (batchId=119)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_outer_join2] (batchId=115)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_outer_join3] (batchId=120)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[ppd_outer_join4] (batchId=129)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[router_join_ppr] (batchId=135)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[smb_mapjoin_14] (batchId=127)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[smb_mapjoin_4] (batchId=111)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[smb_mapjoin_5] (batchId=139)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[smb_mapjoin_6] (batchId=115)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[subquery_in] (batchId=128)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[union22] (batchId=107)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[union24] (batchId=126)
org.apache.hadoop.hive.cli.TestSparkCliDriver.testCliDriver[union27] (batchId=103)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/6913/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/6913/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6913/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 171 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12888072 - PreCommit-HIVE-Build, #2) add missing getType() to compare the basetype instead of the ref, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12888226/HIVE-17568.02.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 9 failed/errored test(s), 11051 tests executed
*Failed tests:*
{noformat}
TestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=231)
TestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=231)
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver[create_view] (batchId=39)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[constprog_semijoin] (batchId=158)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[constprog_semijoin] (batchId=171)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_explainuser_1] (batchId=170)
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testCliDriver[drop_table_failure2] (batchId=89)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=235)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/6931/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/6931/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6931/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12888226 - PreCommit-HIVE-Build, seems like failure of consprog_semijoin is related:
in this query:
https://github.com/apache/hive/blob/39d8d73e7b7584a48f46ad6b455da6b87e80ea51/ql/src/test/queries/clientpositive/constprog_semijoin.q#L24
the false predicate is lost
, the problem arises from the fact that the two types differ in nullability:

{code}
import static org.junit.Assert.assertEquals;

import org.apache.calcite.jdbc.JavaTypeFactoryImpl;
import org.apache.calcite.rel.type.RelDataType;
import org.apache.calcite.sql.type.SqlTypeName;
import org.junit.Ignore;
import org.junit.Test;

public class CalciteTypeCompare {
  JavaTypeFactoryImpl typeFactory = new JavaTypeFactoryImpl();
  RelDataType b0 = typeFactory.builder().add("t", SqlTypeName.BOOLEAN).nullable(true).build();
  RelDataType b1 = typeFactory.builder().add("t", SqlTypeName.BOOLEAN).nullable(false).build();
  RelDataType b1x = typeFactory.builder().add("x", SqlTypeName.BOOLEAN).nullable(false).build();

  @Test
  @Ignore("this test case will fail; because these types are different")
  public void compareTypesIgnoringNullability() {
    assertEquals(b0, b1);
  }

  @Test
  public void typeSqlNameEquals() {
    assertEquals(b0.getSqlTypeName(), b1.getSqlTypeName());
  }

  @Test
  public void typeSqlNameEqualsIgnoresFieldName() {
    assertEquals(b0.getSqlTypeName(), b1x.getSqlTypeName());
  }
}
{code}

I complement the patch with an addition check for the {{sqlTypeName()}}, #3) add also {{getSqlTypeName()}} comparision, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12888807/HIVE-17568.03.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 7 failed/errored test(s), 11062 tests executed
*Failed tests:*
{noformat}
TestAccumuloCliDriver - did not produce a TEST-*.xml file (likely timed out) (batchId=231)
TestDummy - did not produce a TEST-*.xml file (likely timed out) (batchId=231)
org.apache.hadoop.hive.cli.TestMiniLlapLocalCliDriver.testCliDriver[union_fast_stats] (batchId=156)
org.apache.hadoop.hive.cli.TestMiniSparkOnYarnCliDriver.testCliDriver[spark_explainuser_1] (batchId=170)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query14] (batchId=235)
org.apache.hadoop.hive.cli.TestPerfCliDriver.testCliDriver[query23] (batchId=235)
org.apache.hive.jdbc.TestJdbcDriver2.testSelectExecAsync2 (batchId=226)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/6974/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/6974/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-6974/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12888807 - PreCommit-HIVE-Build, failures are unrelated.
relying on the sqltype prevents the regression. [~ashutoshc] could you take another look?, +1, Pushed to master., This jira is resolved and released with Hive 3.0 If you find an issue with it, please create a new jira.]