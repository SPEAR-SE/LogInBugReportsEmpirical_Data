[Find attached the log of the hadoop Job, and the implementations of my custom udfs.
, For what it's worth, here is the plan of the second hadoop job which is been executed. The two generic udf seems to be declared on ExprNodeGenericFuncDesc (l. 490-538), Actually there was some classpath issues, the version of jackson use by hadoop and mine are conflicting. The result is that my genericUDF failed to be instanciated, and the XMLDecoder, rather than reporting the error, returns null. Hence the NPE.

I suggest the XMLDecoder should always fail on error. See the attached patch., +1 will commit if tests pass., Patch fails ant test -Dtestcase=TestNegativeCliDriver -Dqfile=udfnull.q ]