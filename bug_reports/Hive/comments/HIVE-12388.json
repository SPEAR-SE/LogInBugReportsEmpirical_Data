[Thanks for catching the issue, patch makes sense.

minor comments:  
1. Can test be added if not too difficult?  (I thought TestJdbcDriver should have had it)
2. Can log for IllegalArgumentException be WARNING?, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12771918/HIVE-12388.1.patch.txt

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 5 failed/errored test(s), 9780 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_cbo_rp_annotate_stats_groupby
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_index_bitmap_auto
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.hwi.TestHWISessionManager.testHiveDriver
org.apache.hive.jdbc.TestSSL.testSSLVersion
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6012/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6012/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6012/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12771918 - PreCommit-HIVE-TRUNK-Build, Hi, I was investigating and able to write a unit test in TestJdbcDriver2 to reproduce this case (and add some more tests for EXTERNAL_TABLE table type in getTables), and also fix the log level.

(Sorry for taking over! as we are interested in this patch).

[~navis] [~aihuaxu] could you guys help take a look?, [~szehon] The patch looks good. 

Minor issues:
1.  {{LOG.info("Invalid hive table type " + hiveTypeName);}} does it make sense to log as a warning rather than info?
2. On Line 1181, the assert signature should be  assertEquals(expected, actual)., Thanks Aihua for catching those., +1. Patch looks good to me., Committed to trunk.  Thanks Navis for patch and Aihua for review.]