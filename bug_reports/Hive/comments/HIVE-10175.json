[{code}
METHOD                         DURATION(ms) 
parse                                  462
semanticAnalyze                      9,312
TezBuildDag                            569
TezSubmitToRunningDag                    5
TotalPrepTime                       11,343
{code}

Save 2 seconds by doing

{code}
set hive.tez.dynamic.partition.pruning=false;

METHOD                         DURATION(ms) 
parse                                  449
semanticAnalyze                      7,254
TezBuildDag                            527
TezSubmitToRunningDag                   16
TotalPrepTime                        9,190
{code}

save 9 seconds off default planning with

{code}
set hive.optimize.ppd=false;
set hive.tez.dynamic.partition.pruning=false;

METHOD                         DURATION(ms) 
parse                                  446
semanticAnalyze                      2,089
TezBuildDag                            578
TezSubmitToRunningDag                    4
TotalPrepTime                        4,249
{code}
, [~gopalv] do you have more info about where the time is spent and what the query is? I'm looking at the dynamic pruner and what you ask isn't easy to do. The reason is that the synthetic predicate gets inserted by a logical opt early on. The dynamic pruner has to find these and nuke them, because the synthetic ones can't be executed. So now I'm looking for alternatives to speed this up.

I don't understand for instance how it can take 2 seconds to scan an expression tree. Maybe something else bust?, Checking the PartitionPruner - it seems we already have a fast path for "prune()." If you have more details about where the time is spent this would help., [~hagleitn]: Review please?, +1, Pushed to master and branch-1, thanks [~jcamachorodriguez]!, Reverting this patch as this needs to cycle-break & fold out the SyntheticJoin predicates even if the target table is unpartitioned., The issue is only visible in TPC-H q21, which hit the following error in the nightly runs.

{code}
Caused by: java.lang.RuntimeException: Cannot find ExprNodeEvaluator for the exprNodeDesc = RS[4]
        at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.get(ExprNodeEvaluatorFactory.java:57)
        at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.<init>(ExprNodeGenericFuncEvaluator.java:100)
        at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.get(ExprNodeEvaluatorFactory.java:51)
        at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.<init>(ExprNodeGenericFuncEvaluator.java:100)
        at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory.get(ExprNodeEvaluatorFactory.java:51)
        at org.apache.hadoop.hive.ql.exec.FilterOperator.initializeOp(FilterOperator.java:59)
        ... 21 more
{code}]