[This patch fixes references in JoinContext.  I discovered the outdated references while trying to run a join optimizer that runs after this one., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12686163/HIVE-9060.patch

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 6700 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_ql_rewrite_gbtoidx_cbo_1
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2015/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2015/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2015/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12686163 - PreCommit-HIVE-TRUNK-Build, [~xuefuz] can you review if you get a chance?  The test failure doesn't look related, as it is in other runs as well., Patch looks good. One minor comment, it seems cleaner if we iterate over the map's entry set in the inner for loop. Also, qbJoinTree.getAliasToOpInfo() seems repeated a few times in the block.
{code}
+      for (String alias : qbJoinTree.getAliasToOpInfo().keySet()) {
+        Operator<? extends OperatorDesc> opInfo = qbJoinTree.getAliasToOpInfo().get(alias);
+        if (opInfo == cSEL) {
+          qbJoinTree.getAliasToOpInfo().put(alias, pSEL);
+        }
{cide}, Addressing review comments., It seems there is still a duplication of {code}qbJoinTree.getAliasToOpInfo(){code}, but I think I can fix that when I commit it., Sorry I missed that, that would be good thanks., Actually seems precommit tests hasnt started yet.  I'll just make the fix., +1 pending on tests., Ptest framework had some intermittent issues, submitting again., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12686644/HIVE-9060.3.patch

{color:red}ERROR:{color} -1 due to 1 failed/errored test(s), 6701 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_ql_rewrite_gbtoidx_cbo_1
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2042/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2042/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2042/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12686644 - PreCommit-HIVE-TRUNK-Build, Committed to trunk and merged to Spark branch. Thanks, Szehon.]