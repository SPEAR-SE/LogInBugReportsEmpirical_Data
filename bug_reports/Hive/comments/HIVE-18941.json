[[~akolb] and for the person who will work on this issue. There is a logic on the MetaStoreListenerNotifier.notifyEvent() methods that add a flag to the listener response parameters that specify whether such listener is executed inside an active transaction or not. This was very useful for Sentry to detect if some non-listener calls where indeed called inside a current transaction and ignore them if they are.

The logic is like this:
{noformat}
if (ms != null) {
    event.putParameter(HIVE_METASTORE_TRANSACTION_ACTIVE, Boolean.toString(ms.isActiveTransaction()));
}
{noformat}
See the code:
[https://github.com/apache/hive/blob/master/standalone-metastore/src/main/java/org/apache/hadoop/hive/metastore/MetaStoreListenerNotifier.java#L291]

 

 ]