[I got same NPE error when executing HQL as below, however if I disable 'tez' execution engine, the error is gone. Not sure whether it is related with 'tez' engine.

set hive.execution.engine=tez;

INSERT OVERWRITE TABLE temp_cust_trade_flows
SELECT t.*, m.mcht_name FROM (
	SELECT /*+ MAPJOIN(card2custs) */ a.pos_flow_no AS flow_no,        
			'0' AS flow_type,
			b.cust_no,
			a.merch_id,
			b.card_id,
			b.card_type,
			a.tran_time,
			a.trans_type as tran_type,
			a.trans_amount as tran_amount
	FROM temp_pos_trade_flows a left join card2custs b ON (a.card_id = b.card_id)
	UNION ALL
	SELECT /*+ MAPJOIN(card2custs) */ a.flow_no,
		   '1' AS flow_type,
		   a.cust_no,
		   b.merc_no AS merch_id,     
		   a.acct_no AS card_id,
		   a.acct_type AS card_type,
		   concat(a.flat_trad_date, a.flat_trad_time) AS tran_time,
		   '1021' AS tran_type,
		   a.amt1 AS tran_amount
	FROM temp_online_trade_flows a left join temp_online_trade_flow_details b on(a.flow_no = b.flow_no)
	WHERE a.trad_sts = '00'
) t left join merchant_infos m on(t.merch_id = m.mcht_no);, [~mmokhtar] does this still happen on trunk?, [~hagleitn]
Query runs fine.
Resolved., This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]