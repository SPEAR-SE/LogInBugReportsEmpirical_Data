[Rebased to latest branch, Committed to branch.]