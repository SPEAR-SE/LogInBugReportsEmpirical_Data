[Attaching a patch for trunk/.

While working on this JIRA, I noticed that {{HadoopShims.checkFileAccess()}} returns {{void}} and indicates access-failures using exceptions. Please correct me if I'm wrong, but wouldn't returning a boolean be less clumsy? There is currently no way to distinguish between a legitimate "false" return from an actual exception condition., 

{color:red}Overall{color}: -1 at least one tests failed

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12678333/HIVE-8626.1.patch

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 6607 tests executed
*Failed tests:*
{noformat}
org.apache.hive.hcatalog.streaming.TestStreaming.testInterleavedTransactionBatchCommits
org.apache.hive.hcatalog.streaming.TestStreaming.testTransactionBatchEmptyCommit
org.apache.hive.minikdc.TestJdbcWithMiniKdc.testNegativeTokenAuth
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1567/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/1567/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-1567/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12678333 - PreCommit-HIVE-TRUNK-Build, Could someone kindly have a look at this one?, Patch looks good. +1

bq. I noticed that HadoopShims.checkFileAccess() returns void and indicates access-failures using exceptions.
In the use cases that were in mind when it was implemented, it is useful to have an error message detailing why the permission was denied. I would argue that isWritable() should also return an exception and we should log that in the error  that is getting logged when it returns false.

Regarding the duplicate check in HMS, I agree we should at least have a config to turn it off. The purpose of adding it there i believe was to prevent cases where metadata change is made but it is not possible to make the file change.
, [~mithun] Can you please rebase this patch ?
, Yes, [~thejas], will do., Rebased, and simplified slightly. Removed unused imports, etc., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12701799/HIVE-8626.2.patch

{color:green}SUCCESS:{color} +1 7576 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2915/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/2915/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-2915/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12701799 - PreCommit-HIVE-TRUNK-Build, Thanks for the patch [~mithun]!
, This issue has been fixed and released as part of the 1.2.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.]