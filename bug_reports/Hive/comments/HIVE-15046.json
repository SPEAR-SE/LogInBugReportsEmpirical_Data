[[~ashutoshc], could you review this one? Since we do not have integration tests yet, I did not realize about it when we upgraded to Calcite 1.10., +1, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12835014/HIVE-15046.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 3 failed/errored test(s), 10602 tests executed
*Failed tests:*
{noformat}
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1] (batchId=164)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/1781/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/1781/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1781/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 3 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12835014 - PreCommit-HIVE-Build, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12835258/HIVE-15046.01.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 4 failed/errored test(s), 10621 tests executed
*Failed tests:*
{noformat}
org.apache.hadoop.hive.cli.TestHBaseCliDriver.testCliDriver[hbase_bulk] (batchId=89)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJarWithoutAddDriverClazz[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[0] (batchId=164)
org.apache.hive.beeline.TestBeelineArgParsing.testAddLocalJar[1] (batchId=164)
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-Build/1808/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-Build/1808/console
Test logs: http://104.198.109.242/logs/PreCommit-HIVE-Build-1808/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 4 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12835258 - PreCommit-HIVE-Build, [~ashutoshc], would you mind taking a look at the new patch? :) The new patch addresses other issues discovered while testing; I have updated the description of the issue to describe them. Thanks!, In DruidGroupByQueryRecordReader, I think we need more robust handling, lets say I have 3 dimensions d1, d2, d3. Its possible that d2,d3 is missing in some segments and query is on d2,d3. Can current code handle that? What about d2 is missing in segment and query is on d2,d3. Lastly, d2,d3 is missing in segment and query is on d3.
Other changes look good., Thanks for checking [~ashutoshc]. I have double checked the code: if we have multiple dimensions and some segments are missing the results for some of them (no matter the position), this should be handled properly by the code in {{nextKeyValue}} method (specifically logic to refresh indexes) plus the fix that is added in this patch. Basically, all combinations are created, adding NULL for those dimensions that lack a value., Ok.. cool. Can you make originalColumnNames transient? Since OI gets serialized we don't want plan size to increase unnecessarily. 
+1 after that change., Changed field to transient and pushed to master. Thanks for reviewing [~ashutoshc]!]