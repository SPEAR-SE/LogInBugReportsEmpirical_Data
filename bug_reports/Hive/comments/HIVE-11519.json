[why does 1.2.1 would set kryo as the default serde tool?
as it say this is a big bug of kryo., is these all kryo`s bug beyong 2.22? @[~gopalv] @[~xuefuz], [~Feng Yuan]: That doesn't actually explain anything - can you post the query + explain?, Is there a test case or steps to reproduce the error?, .3 patch from HIVE-12175 should hopefully fix this. I suspect that colExprMap is not removed by cloning plan kryo thread local whereas its removed in other kryo objects., [~Feng Yuan] Can you provide a small test case/query that reproduces this issue? I can help you with the fix., i test about 60m data in hive2.0.0 and this probleam shows again]