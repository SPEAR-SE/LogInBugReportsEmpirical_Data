[[~sershe], could u be more specific about the problem? isMergeRequired was first introduced in 
{code}
commit 1fcfc31ea5c23aec3f3bf610e8938804a750ee5d
Author: Gunther Hagleitner <gunther@apache.org>
Date:   Mon Nov 4 01:34:01 2013 +0000

    HIVE-5734: Enable merge/move tasks for Tez (Gunther Hagleitner)

    git-svn-id: https://svn.apache.org/repos/asf/hive/branches/tez@1538485 13f79535-47bb-0310-9956-ffa450edef68
{code}, [~pxiong] there's the code that creates a stats task in there added by 
{noformat}
commit b53794b83e8bf678cca96946ec757449ae95d93d
Author: Pengcheng Xiong <pxiong@apache.org>
Date:   Sun Jul 17 12:20:42 2016 -0700

    HIVE-14236: CTAS with UNION ALL puts the wrong stats in Tez (Pengcheng Xiong, reviewed by Ashutosh Chauhan)
{noformat}

I am not sure what adding stats task has to do with checking if merge is required :P

As an example, we had an issue that Tez didn't work on HBase (or something like that) that was really perplexing. It turned out that some part of handler setup was inserted into an explain-related method (I don't know why) that was called for every query. Then thru some unrelated changes, the explain-related method was changed to only be called for explain queries (which is a logical change)... the end result was that handler was no longer configured properly and there was a bug that was hard to figure out.
I stumbled upon this code and wanted to avoid a similar pattern here... ]