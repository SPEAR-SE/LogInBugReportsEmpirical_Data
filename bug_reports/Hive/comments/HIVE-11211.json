[[~mmokhtar], could you please review it? Thanks., [~hagleitn]
FYI , [~prasanth_j] HIVE-8168 introduced state info in JoinStatsRule.
This seems like a  logical error as JoinStatsRule gets reused for different joins in the same query tree., [~pxiong] Could you change the name of getSelectivity to getCardinality or some thing similar. This method is actually returning cardinality as opposed to selectivity., 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12744344/HIVE-11211.02.patch

{color:green}SUCCESS:{color} +1 9138 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4548/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4548/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4548/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12744344 - PreCommit-HIVE-TRUNK-Build, .03 patch changes the name to getCardinality following [~jpullokkaran]'s suggestion., +1, 

{color:green}Overall{color}: +1 all checks pass

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12744529/HIVE-11211.03.patch

{color:green}SUCCESS:{color} +1 9146 tests passed

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4557/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/4557/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-4557/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12744529 - PreCommit-HIVE-TRUNK-Build, Patch committed to master and branch-1. Thanks [~pxiong] for the fix and [~jpullokkaran] for the review!, Fix version only shows 2.0.0, although this was also committed to branch-1 (for 1.3.0) and recently to branch-1.2 (for 1.2.2).

Commit f428af1d2908588dd68eb30cde2f158bf9ef04c0 for branch-1.2 (1.2.2).
Commit 64d8582cb8d357216ef7fa208f68548ceb1ef2d3 for branch-1 (1.3.0).
Commit 42326958148c2558be9c3d4dfe44c9e735704617 for master (2.0.0).]