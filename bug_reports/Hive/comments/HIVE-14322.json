[Setting DN autocreate flag to true also helps, but that means going back on the changes in HIVE-1841. I think we should continue to disable autocreate and use schematool instead. So this is not a suitable workaround.

Until we have a fix in DN for this, I think we should downgrade the DN version  in hive to allow the use of postgres.
I will follow up with a bug in DN as well.

, It's suspicious that it would work with auto-create but not with a script, which has nothing to do with DN as such.
I wonder if the syntax in the script (""COLUMN_TYPE" character varying(128) DEFAULT NULL::character varying) has anything to do with it? Should we change these to NULL and would it help?

Can you reference a DN bug if you file one?
, Patch for rolling back the upgrade of DN., [~sershe] Sorry, I should have been more clear.
I didn't mean actually auto-creating the schema made the difference. What I meant was using a schema created with schematool, but running metastore with the -hiveconf datanucleus.schema.autoCreateColumns=true option made a difference.
 , Adding link to question I posted on [DN forum|http://www.datanucleus.org/servlet/forum/viewthread_thread,7985_lastpage,yes#38388]

Needs to be followed up with a bug report.
, We can also set datanucleus.rdbms.initializeColumnInfo=NONE to address this, it appears (see the thread). I wonder if it has any other repercussions., [~thejas] the patch. I am not sure if we need to add this anywhere else... I see configs in the source tree set autoCreateAll, but it seems like it should work without such setting (and validateTables/etc. is not set), +1
, datanucleus.rdbms.useColumnDefaultWhenNull was added in DN. I will file a follow-up JIRA to use that when it's released., QA failed due to some unrelated checksum error, grrrr, Same patch, And again. Looks like it never got picked up., 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12821063/HIVE-14322.04.patch

{color:red}ERROR:{color} -1 due to no test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 7 failed/errored test(s), 10418 tests executed
*Failed tests:*
{noformat}
TestMsgBusConnection - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_avro_nullable_union
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_avro_non_nullable_union
org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService.testDelayedLocalityNodeCommErrorImmediateAllocation
org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.stringifyValidTxns
org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxnRange
{noformat}

Test results: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/712/testReport
Console output: https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/712/console
Test logs: http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-712/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 7 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12821063 - PreCommit-HIVE-MASTER-Build, Committed. Thanks for the review!, FYI https://twitter.com/datanucleus/status/760060502143668225, Thanks!, Doc note:  This adds *datanucleus.rdbms.initializeColumnInfo* to HiveConf.java in 2.0.2, 2.1.1, and 2.2.0 so it will need to be documented in the MetaStore section of Configuration Properties for those releases.

* [Configuration Properties -- MetaStore | https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-MetaStore]

What other values can be used, besides NONE?

Added labels TODOC2.0 (for 2.0.2), TODOC2.1.1, and TODOC2.2 (not needed if 2.1.1 is released before 2.2.0).]