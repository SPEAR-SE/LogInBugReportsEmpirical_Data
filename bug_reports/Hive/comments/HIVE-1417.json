[Expanded test coverage to include join and group by, but this bug doesn't show up during unit tests because the underlying filesystem is not HDFS., will review, committed. Thanks Paul]