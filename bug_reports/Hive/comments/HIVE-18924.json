[this bug doesn't seems to be present on the current master

{code}
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partition=true;

drop table if exists t_stage;
drop table if exists t_prod;

CREATE TABLE IF NOT EXISTS t_stage (
        start_date timestamp,
        end_date timestamp
)
PARTITIONED BY (
        dt string
);

create table if not exists t_prod (
        start_date timestamp,
        end_date timestamp
)
PARTITIONED BY (
        dt string,
        hr string
)
STORED as ORC;

insert into t_stage partition(dt='2016-03-10') values
        ('2016-03-01 06:08:44','2017-02-01 07:08:44');

insert overwrite table t_prod
PARTITION(dt, hr)
select
      	UNIX_TIMESTAMP(stg.start_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as start_date,
        UNIX_TIMESTAMP(stg.end_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as end_date,
        date_format(cast(UNIX_TIMESTAMP(stg.start_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as timestamp),"yyyy-MM-dd") as dt,
        date_format(cast(UNIX_TIMESTAMP(stg.start_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as timestamp),"HH") as hr
from t_stage stg
        where stg.dt = '2016-03-10';

select
      	UNIX_TIMESTAMP(stg.start_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as start_date,
        UNIX_TIMESTAMP(stg.end_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as end_date,
        date_format(cast(UNIX_TIMESTAMP(stg.start_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as timestamp),"yyyy-MM-dd") as dt,
        date_format(cast(UNIX_TIMESTAMP(stg.start_date, "yyyy-MM-dd'T'hh:mm:ss'Z'") * 1000 as timestamp),"HH") as hr
from t_stage stg
        where stg.dt = '2016-03-10';

select * from t_prod;

{code}

]