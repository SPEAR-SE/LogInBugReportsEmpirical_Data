[Reported by [~kamboj] on https://issues.apache.org/jira/browse/HIVE-2791?focusedCommentId=13506756&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13506756 and I verified bug still exists on trunk. Workaround of disabling the optimization gets the correct behavior as well., Ashutosh,
I've verified the query is working when both HIVE-3699 and HIVE-3849 are applied., Two sub-issues related to it are checked in.]