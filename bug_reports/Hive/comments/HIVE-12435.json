[[~taksaito]: this query isn't vectorized in branch-1 (only in 2.0), Thanks for the info, [~gopalv]. That explains why the above passes with hive v 1.2.

There is also another query which fails:
I have the table:
{noformat}
select bool0, key, num0, num1 from calcs;
NULL	key09	NULL	12.4
true	key10	NULL	10.32
false	key11	NULL	2.47
NULL	key12	NULL	12.05
NULL	key13	NULL	10.37
true	key14	NULL	7.1
false	key15	NULL	16.81
NULL	key16	NULL	7.12
true	key00	12.3	8.42
false	key01	-12.3	6.71
NULL	key02	15.7	9.78
true	key03	-15.7	7.43
false	key04	3.5	9.05
NULL	key05	-3.5	9.38
true	key06	0.0	16.42
false	key07	NULL	11.38
NULL	key08	10.0	9.47
{noformat}

When I run the following with vectorization enabled, it returns the following:
{noformat}
SELECT bool0, key, SUM((CASE WHEN bool0 THEN CAST(num0 AS DOUBLE) WHEN NOT bool0 THEN CAST(num1 AS DOUBLE) ELSE NULL END)) FROM Calcs GROUP BY bool0, key, num1;
NULL	 key02	0.0
NULL key05	0.0
NULL	 key08	0.0
NULL	 key09	0.0
NULL	 key12	0.0
NULL	 key13	0.0
NULL	 key16	0.0
false	 key01	6.71
false	 key04	9.05
false	 key07	11.38
false	 key11	2.47
false	 key15	16.81
true	key00	12.3
true	key03	-15.7
true	key06	0.0
true	key10	NULL
true	key14	NULL
{noformat}

When vectorization is disabled, it returns NULL for the sum instead of 0 when bool0=NULL :
{noformat}
NULL	 key02	NULL
NULL	 key05	NULL
NULL	 key08	NULL
NULL	 key09	NULL
NULL	 key12	NULL
NULL	 key13	NULL
NULL	 key16	NULL
false	 key01	6.71
false	 key04	9.05
false	 key07	11.38
false	 key11	2.47
false	 key15	16.81
true	 key00	12.3
true	 key03	-15.7
true	 key06	0.0
true	 key10	NULL
true	 key14	NULL
{noformat}

Please let me know in a case if this needs to be addressed in another JIRA., Let me triage this issue into a root-cause.

The HIVE-12209 change exposes more codepaths to NULL arguments, will walk through the case before asking for a different JIRA., [~mmccline] can you take a look? Incorrect results with vectorization, I've done some looking at this.  I have a Q file that repros created from description.  I don't understand how the CASE WHEN is being executed via VectorUDFAdaptor yet., The vectorized row batch output from the VectorSelectOperator is:

{code}
./target/tmp/log/hive.log:2015-12-09T17:58:25,452 INFO  [LocalJobRunner Map Task Executor #0[]]: vector.VectorizedBatchUtil (VectorizedBatchUtil.java:debugDisplayOneRow(694)) - VectorSelectOperator exit... row 0 (col 0) bytes: 'key1' (col 1) 1 
./target/tmp/log/hive.log:2015-12-09T17:58:25,452 INFO  [LocalJobRunner Map Task Executor #0[]]: vector.VectorizedBatchUtil (VectorizedBatchUtil.java:debugDisplayOneRow(694)) - VectorSelectOperator exit... row 1 (col 0) bytes: 'key2' (col 1) 0 
./target/tmp/log/hive.log:2015-12-09T17:58:25,452 INFO  [LocalJobRunner Map Task Executor #0[]]: vector.VectorizedBatchUtil (VectorizedBatchUtil.java:debugDisplayOneRow(694)) - VectorSelectOperator exit... row 2 (col 0) bytes: 'key3' (col 1) NULL 
./target/tmp/log/hive.log:2015-12-09T17:58:25,452 INFO  [LocalJobRunner Map Task Executor #0[]]: vector.VectorizedBatchUtil (VectorizedBatchUtil.java:debugDisplayOneRow(694)) - VectorSelectOperator exit... row 3 (col 0) bytes: 'key4' (col 1) 0 
./target/tmp/log/hive.log:2015-12-09T17:58:25,452 INFO  [LocalJobRunner Map Task Executor #0[]]: vector.VectorizedBatchUtil (VectorizedBatchUtil.java:debugDisplayOneRow(694)) - VectorSelectOperator exit... row 4 (col 0) bytes: 'key5' (col 1) NULL 
{code}

and given the input this looks correct:

{code}
key1	true
key2	false
key3	NULL
key4	false
key5	NULL
{code}, Next: look at flow from VectorSelectOperator to VectorReduceOperator and then the reduce-side VectorGroupByOperator., Ok, VectorUDAFCount.aggregateInputSelection is looking at scratch column 3 as input.
isRepeating = false, noNulls = true, vector = {1, 0, 0, 0, 0}

But there should be NULLs!, This assumption is fragile
{code}
PrimitiveCategory primitiveCategory = ((PrimitiveTypeInfo) expr.getTypeInfo()).getPrimitiveCategory();
{code}

Can you instead get TypeInfo object and see if it is an instance of PrimitiveTypeInfo and of type VOID?, Review comments., +1, Patch run seems to have disappeared down the rabbit hole., Patch #3 also disappeared down rabbit hole., Started Hive QA for #4 as http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6348/, 

Here are the results of testing the latest attachment:
https://issues.apache.org/jira/secure/attachment/12777494/HIVE-12435.04.patch

{color:green}SUCCESS:{color} +1 due to 1 test(s) being added or modified.

{color:red}ERROR:{color} -1 due to 16 failed/errored test(s), 9897 tests executed
*Failed tests:*
{noformat}
TestHWISessionManager - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_order2
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union9
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_dynamic
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs.testGetPartitionSpecs_WithAndWithoutPartitionGrouping
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.jdbc.miniHS2.TestHs2Metrics.testMetrics
org.apache.hive.spark.client.TestSparkClient.testAddJarsAndFiles
org.apache.hive.spark.client.TestSparkClient.testCounters
org.apache.hive.spark.client.TestSparkClient.testErrorJob
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testMetricsCollection
org.apache.hive.spark.client.TestSparkClient.testRemoteClient
org.apache.hive.spark.client.TestSparkClient.testSimpleSparkJob
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
{noformat}

Test results: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6348/testReport
Console output: http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6348/console
Test logs: http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6348/

Messages:
{noformat}
Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 16 tests failed
{noformat}

This message is automatically generated.

ATTACHMENT ID: 12777494 - PreCommit-HIVE-TRUNK-Build, None of the failures look related., Committd to master., Committed to branch-1, Committed to branch-2.0, [~mmccline], I don't see the commit to branch-1 (or the changes in github)., Now pushed.  Thanks for noticing.]