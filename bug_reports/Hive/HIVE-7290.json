{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": null,
        "components": [
            {
                "description": "Issues related to support for multiple Datasbases/Schemas",
                "id": "12317906",
                "name": "Database/Schema",
                "self": "https://issues.apache.org/jira/rest/api/2/component/12317906"
            },
            {
                "description": "Tracks issue dealing with metastore.",
                "id": "12312584",
                "name": "Metastore",
                "self": "https://issues.apache.org/jira/rest/api/2/component/12312584"
            }
        ],
        "created": "2014-06-25T18:30:38.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Bala Krishna",
            "key": "bala krishna",
            "name": "Bala Krishna",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Bala+Krishna",
            "timeZone": "Etc/UTC"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2014-12-19T07:40:09.508+0000",
        "customfield_12310222": null,
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "0.0",
        "customfield_12310320": null,
        "customfield_12310420": "401898",
        "customfield_12310920": "401967",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i1x6dj:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Feb 23 08:51:18 UTC 2016",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "Hi folks,\n\nwe're seeing an intermittent issue between our Hive 0.13 metastore and mysql instance. After being idle for about 5 minutes or so, any transactions involving the metastore and mysql causes the following error to appear in the metastore log:\n\n2014-06-09 05:13:52,066 ERROR bonecp.ConnectionHandle (ConnectionHandle.java:markPossiblyBroken(388)) - Database access problem. Killing off this connection and all remaining connectio\nns in the connection pool. SQL State = 08S01\n2014-06-09 05:13:52,068 ERROR metastore.RetryingHMSHandler (RetryingHMSHandler.java:invoke(157)) - Retrying HMSHandler after 1000 ms (attempt 1 of 1) with error: javax.jdo.JDODataStore\nException: Communications link failure\n\nThe last packet successfully received from the server was 502,751 milliseconds ago.  The last packet sent successfully to the server was 1 milliseconds ago.\n        at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:451)\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:275)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getMTable(ObjectStore.java:900)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTable(ObjectStore.java:832)\n        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)\n\n[full stack trace is below]\n\nSubsequent transactions go through fine, however. This only occurs if the metastore has has been idle for a while.\n\nWe've been looking at the code and the problem seems to lie in the channel between the driver and metastore connection pool. We looked at the wait time configuration settings both mysql and BoneCP. Both of them are set for max value. \n\nOur hive 0.12 install uses DBCP for datanucleus.connectionPoolingType, not BoneCP and we don't see these issues there. We are not running Tez.\n\nThis seems like such a basic issue that we'd thought to check and see if anyone else has encountered it. Any insights would be greatly appreciated.\n\n=================\n\nFull stack trace:\n\n2014-06-09 05:13:52,066 ERROR bonecp.ConnectionHandle (ConnectionHandle.java:markPossiblyBroken(388)) - Database access problem. Killing off this connection and all remaining connectio\nns in the connection pool. SQL State = 08S01\n2014-06-09 05:13:52,068 ERROR metastore.RetryingHMSHandler (RetryingHMSHandler.java:invoke(157)) - Retrying HMSHandler after 1000 ms (attempt 1 of 1) with error: javax.jdo.JDODataStore\nException: Communications link failure\n\nThe last packet successfully received from the server was 502,751 milliseconds ago.  The last packet sent successfully to the server was 1 milliseconds ago.\n        at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:451)\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:275)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getMTable(ObjectStore.java:900)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTable(ObjectStore.java:832)\n        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)\n        at com.sun.proxy.$Proxy0.getTable(Unknown Source)\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_table(HiveMetaStore.java:1559)\n        at sun.reflect.GeneratedMethodAccessor15.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:105)\n        at com.sun.proxy.$Proxy11.get_table(Unknown Source)\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$get_table.getResult(ThriftHiveMetastore.java:8146)\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$get_table.getResult(ThriftHiveMetastore.java:8130)\n        at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n        at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:110)\n        at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:415)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1491)\n        at org.apache.hadoop.hive.shims.HadoopShimsSecure.doAs(HadoopShimsSecure.java:500)\n        at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:118)\n        at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:206)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nNestedThrowablesStackTrace:\ncom.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet successfully received from the server was 502,751 milliseconds ago.  The last packet sent successfully to the server was 1 milliseconds ago.\n        at sun.reflect.GeneratedConstructorAccessor41.newInstance(Unknown Source)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:526)\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n        at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1117)\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3603)\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3492)\n        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4043)\n        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2503)\n        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2664)\n        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2788)\n        at com.mysql.jdbc.ConnectionImpl.setAutoCommit(ConnectionImpl.java:5282)\n        at com.jolbox.bonecp.ConnectionHandle.setAutoCommit(ConnectionHandle.java:1292)\n        at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:440)\n        at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getXAResource(ConnectionFactoryImpl.java:378)\n        at org.datanucleus.store.connection.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:328)\n        at org.datanucleus.store.connection.AbstractConnectionFactory.getConnection(AbstractConnectionFactory.java:94)\n        at org.datanucleus.store.AbstractStoreManager.getConnection(AbstractStoreManager.java:430)\n        at org.datanucleus.store.AbstractStoreManager.getConnection(AbstractStoreManager.java:396)\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.performExecute(JDOQLQuery.java:621)\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1786)\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1672)\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:266)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getMTable(ObjectStore.java:900)\n        at org.apache.hadoop.hive.metastore.ObjectStore.getTable(ObjectStore.java:832)\n        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:108)\n        at com.sun.proxy.$Proxy0.getTable(Unknown Source)\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_table(HiveMetaStore.java:1559)\n        at sun.reflect.GeneratedMethodAccessor15.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:105)\n        at com.sun.proxy.$Proxy11.get_table(Unknown Source)\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$get_table.getResult(ThriftHiveMetastore.java:8146)\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$get_table.getResult(ThriftHiveMetastore.java:8130)\n        at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n        at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:110)\n        at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:415)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1491)\n        at org.apache.hadoop.hive.shims.HadoopShimsSecure.doAs(HadoopShimsSecure.java:500)\n        at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:118)\n        at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:206)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nCaused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.\n        at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:3052)\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3503)\n        ... 44 more",
        "duedate": null,
        "environment": "Hadoop 2.2.0\nHive 0.13.1,HIve 0.14.0\nBoneCP 0.8.0.RELEASE",
        "fixVersions": [],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935"
            },
            "id": "12310843",
            "key": "HIVE",
            "name": "Hive",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310843"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Bala Krishna",
            "key": "bala krishna",
            "name": "Bala Krishna",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Bala+Krishna",
            "timeZone": "Etc/UTC"
        },
        "resolution": null,
        "resolutiondate": null,
        "status": {
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "id": "1",
            "name": "Open",
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "statusCategory": {
                "colorName": "blue-gray",
                "id": 2,
                "key": "new",
                "name": "To Do",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2"
            }
        },
        "subtasks": [],
        "summary": "BoneCP Connection Pooling throwing JDODataStoreException with Hive 0.13.1 ",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2016-02-23T08:51:18.000+0000",
        "versions": [
            {
                "archived": false,
                "description": "released",
                "id": "12326450",
                "name": "0.14.0",
                "releaseDate": "2014-11-12",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12326450"
            },
            {
                "archived": false,
                "description": "0.13 maintenance release 1",
                "id": "12326829",
                "name": "0.13.1",
                "releaseDate": "2014-06-06",
                "released": true,
                "self": "https://issues.apache.org/jira/rest/api/2/version/12326829"
            }
        ],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-7290/votes",
            "votes": 1
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-7290/watchers",
            "watchCount": 14
        },
        "workratio": -1
    },
    "id": "12723713",
    "key": "HIVE-7290",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12723713"
}