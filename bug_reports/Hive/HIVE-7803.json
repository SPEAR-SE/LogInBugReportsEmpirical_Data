{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244"
            },
            "displayName": "Selina Zhang",
            "key": "selinazh",
            "name": "selinazh",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=selinazh",
            "timeZone": "America/Los_Angeles"
        },
        "components": [{
            "description": "Tracks issues related to the HCatalog",
            "id": "12320409",
            "name": "HCatalog",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12320409"
        }],
        "created": "2014-08-20T19:11:01.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244"
            },
            "displayName": "Selina Zhang",
            "key": "selinazh",
            "name": "selinazh",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=selinazh",
            "timeZone": "America/Los_Angeles"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2014-08-28T21:43:07.194+0000",
        "customfield_12310222": "3_*:*_2_*:*_693090786_*|*_10002_*:*_1_*:*_5605429311_*|*_1_*:*_2_*:*_17155155_*|*_5_*:*_1_*:*_0",
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "2.0",
        "customfield_12310320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i1z59z:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Nov 01 21:32:16 UTC 2014",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "One of our users reports they see intermittent failures due to attempt directories in the input paths. We found with speculative execution turned on, two mappers tried to commit task at the same time using the same committed task path,  which cause the corrupt output directory. \n\nThe original Pig script:\n{code}\nSTORE AdvertiserDataParsedClean INTO '$DB_NAME.$ADVERTISER_META_TABLE_NAME'\nUSING org.apache.hcatalog.pig.HCatStorer();\n{code}\n\nTwo mappers\nattempt_1405021984947_5394024_m_000523_0: KILLED\nattempt_1405021984947_5394024_m_000523_1: SUCCEEDED\n\nattempt_1405021984947_5394024_m_000523_0 was killed right after the commit.\n\nAs a result, it created corrupt directory as \n  \n/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/task_1405021984947_5394024_m_000523/\ncontaining \n   part-m-00523 (from attempt_1405021984947_5394024_m_000523_0)\nand \n   attempt_1405021984947_5394024_m_000523_1/part-m-00523\n\nNamenode Audit log\n==========================\n1. 2014-08-05 05:04:36,811 INFO FSNamesystem.audit: ugi=* ip=ipaddress1 cmd=create \nsrc=/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/_temporary/attempt_1405021984947_5394024_m_000523_0/part-m-00523\n dst=null  perm=user:group:rw-r-----\n\n2. 2014-08-05 05:04:53,112 INFO FSNamesystem.audit: ugi=* ip=ipaddress2  cmd=create \nsrc=/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/_temporary/attempt_1405021984947_5394024_m_000523_1/part-m-00523\n dst=null  perm=user:group:rw-r-----\n\n3. 2014-08-05 05:05:13,001 INFO FSNamesystem.audit: ugi=* ip=ipaddress1 cmd=rename \nsrc=/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/_temporary/attempt_1405021984947_5394024_m_000523_0\ndst=/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/task_1405021984947_5394024_m_000523\nperm=user:group:rwxr-x---\n\n4. 2014-08-05 05:05:13,004 INFO FSNamesystem.audit: ugi=* ip=ipaddress2  cmd=rename \nsrc=/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/_temporary/attempt_1405021984947_5394024_m_000523_1\ndst=/projects/.../tablename/_DYN0.7192688458252056/load_time=201408050000/type=complete/_temporary/1/task_1405021984947_5394024_m_000523\nperm=user:group:rwxr-x---\n\nAfter consulting our Hadoop core team, we was pointed out some HCat code does not participating in the two-phase commit protocol, for example in FileRecordWriterContainer.close():\n{code}\n            for (Map.Entry<String, org.apache.hadoop.mapred.OutputCommitter> entry : baseDynamicCommitters.entrySet()) {\n                org.apache.hadoop.mapred.TaskAttemptContext currContext = dynamicContexts.get(entry.getKey());\n                OutputCommitter baseOutputCommitter = entry.getValue();\n                if (baseOutputCommitter.needsTaskCommit(currContext)) {\n                    baseOutputCommitter.commitTask(currContext);\n                }\n            }\n{code}\n",
        "duedate": null,
        "environment": null,
        "fixVersions": [],
        "issuelinks": [{
            "id": "12400296",
            "inwardIssue": {
                "fields": {
                    "issuetype": {
                        "avatarId": 21133,
                        "description": "A problem which impairs or prevents the functions of the product.",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                        "id": "1",
                        "name": "Bug",
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                        "subtask": false
                    },
                    "priority": {
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
                        "id": "2",
                        "name": "Critical",
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/2"
                    },
                    "status": {
                        "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                        "id": "6",
                        "name": "Closed",
                        "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                        "statusCategory": {
                            "colorName": "green",
                            "id": 3,
                            "key": "done",
                            "name": "Done",
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
                        }
                    },
                    "summary": "HIVE-7803 doesn't handle Pig MultiQuery, can cause data-loss."
                },
                "id": "12746579",
                "key": "HIVE-8394",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/12746579"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12400296",
            "type": {
                "id": "12310000",
                "inward": "is duplicated by",
                "name": "Duplicate",
                "outward": "duplicates",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
            }
        }],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "id": "2",
            "name": "Critical",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935"
            },
            "id": "12310843",
            "key": "HIVE",
            "name": "Hive",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310843"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=selinazh&avatarId=19244",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=selinazh&avatarId=19244",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=selinazh&avatarId=19244",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=selinazh&avatarId=19244"
            },
            "displayName": "Selina Zhang",
            "key": "selinazh",
            "name": "selinazh",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=selinazh",
            "timeZone": "America/Los_Angeles"
        },
        "resolution": {
            "description": "A fix for this issue is checked into the tree and tested.",
            "id": "1",
            "name": "Fixed",
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1"
        },
        "resolutiondate": "2014-11-01T21:32:16.000+0000",
        "status": {
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "id": "5",
            "name": "Resolved",
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "statusCategory": {
                "colorName": "green",
                "id": 3,
                "key": "done",
                "name": "Done",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3"
            }
        },
        "subtasks": [],
        "summary": "Enable Hadoop speculative execution may cause corrupt output directory (dynamic partition)",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2014-11-01T21:32:16.000+0000",
        "versions": [{
            "archived": false,
            "description": "0.13 maintenance release 1",
            "id": "12326829",
            "name": "0.13.1",
            "releaseDate": "2014-06-06",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12326829"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-7803/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-7803/watchers",
            "watchCount": 3
        },
        "workratio": -1
    },
    "id": "12735500",
    "key": "HIVE-7803",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12735500"
}