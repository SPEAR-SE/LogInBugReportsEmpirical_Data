{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "fields": {
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "aggregatetimeestimate": null,
        "aggregatetimeoriginalestimate": null,
        "aggregatetimespent": null,
        "assignee": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hsubramaniyan&avatarId=23453",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hsubramaniyan&avatarId=23453",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hsubramaniyan&avatarId=23453",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=hsubramaniyan&avatarId=23453"
            },
            "displayName": "Hari Sankar Sivarama Subramaniyan",
            "key": "hsubramaniyan",
            "name": "hsubramaniyan",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=hsubramaniyan",
            "timeZone": "America/Los_Angeles"
        },
        "components": [{
            "id": "12325007",
            "name": "Hive",
            "self": "https://issues.apache.org/jira/rest/api/2/component/12325007"
        }],
        "created": "2016-06-10T22:39:34.000+0000",
        "creator": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Nita Dembla",
            "key": "ndembla",
            "name": "ndembla",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ndembla",
            "timeZone": "America/New_York"
        },
        "customfield_10010": null,
        "customfield_12310191": null,
        "customfield_12310192": null,
        "customfield_12310220": "2016-06-23T21:36:25.250+0000",
        "customfield_12310222": null,
        "customfield_12310230": null,
        "customfield_12310250": null,
        "customfield_12310290": null,
        "customfield_12310291": null,
        "customfield_12310300": null,
        "customfield_12310310": "7.0",
        "customfield_12310320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12310920": "9223372036854775807",
        "customfield_12310921": null,
        "customfield_12311020": null,
        "customfield_12311024": null,
        "customfield_12311120": null,
        "customfield_12311820": "0|i2zbfb:",
        "customfield_12312022": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "customfield_12312026": null,
        "customfield_12312220": null,
        "customfield_12312320": null,
        "customfield_12312321": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312324": null,
        "customfield_12312325": null,
        "customfield_12312326": null,
        "customfield_12312327": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312330": null,
        "customfield_12312331": null,
        "customfield_12312332": null,
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12312335": null,
        "customfield_12312336": null,
        "customfield_12312337": null,
        "customfield_12312338": null,
        "customfield_12312339": null,
        "customfield_12312340": null,
        "customfield_12312341": null,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Oct 24 23:45:31 UTC 2016",
        "customfield_12312720": null,
        "customfield_12312823": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "customfield_12312923": null,
        "customfield_12313422": "false",
        "customfield_12313520": null,
        "description": "TPCDS fact tables (store_sales, catalog_sales) have 1800+ partitions and when the query does not a filter on the partition column, metastore queries generated have a large IN clause listing all the partition names. Most RDBMS systems have issues optimizing large IN clause and even when a good index plan is chosen , comparing to 1800+ string values will not lead to best execution time.\n\nWhen all partitions are chosen, not specifying the partition list and having filters only on table and column name will generate the same result set as long as there are no concurrent modifications to partition list of the hive table (adding/dropping partitions).\n\nFor eg: For TPCDS query18, the metastore query gathering partition column statistics runs in 0.5 secs in Mysql. Following is output from mysql log\n\n{noformat}\n-- Query_time: 0.482063  Lock_time: 0.003037 Rows_sent: 1836  Rows_examined: 18360\nselect count(\"COLUMN_NAME\") from \"PART_COL_STATS\"\n where \"DB_NAME\" = 'tpcds_bin_partitioned_orc_30000' and \"TABLE_NAME\" = 'catalog_sales' \n and \"COLUMN_NAME\" in \n('cs_bill_customer_sk','cs_bill_cdemo_sk','cs_item_sk','cs_quantity','cs_list_price','cs_sales_price','cs_coupon_amt','cs_net_profit') and \"PARTITION_NAME\" in \n('cs_sold_date_sk=2450815','cs_sold_date_sk=2450816','cs_sold_date_sk=2450817','cs_sold_date_sk=2450818','cs_sold_date_sk=2450819','cs_sold_date_sk=2450820','cs_sold_date_sk=2450821','cs_sold_date_sk=2450822','cs_sold_date_sk=2450823','cs_sold_date_sk=2450824','cs_sold_date_sk=2450825','cs_sold_date_sk=2450826','cs_sold_date_sk=2450827','cs_sold_date_sk=2450828','cs_sold_date_sk=2450829','cs_sold_date_sk=2450830','cs_sold_date_sk=2450831','cs_sold_date_sk=2450832','cs_sold_date_sk=2450833','cs_sold_date_sk=2450834','cs_sold_date_sk=2450835','cs_sold_date_sk=2450836','cs_sold_date_sk=2450837','cs_sold_date_sk=2450838','cs_sold_date_sk=2450839','cs_sold_date_sk=2450840','cs_sold_date_sk=2450841','cs_sold_date_sk=2450842','cs_sold_date_sk=2450843','cs_sold_date_sk=2450844','cs_sold_date_sk=2450845','cs_sold_date_sk=2450846','cs_sold_date_sk=2450847','cs_sold_date_sk=2450848','cs_sold_date_sk=2450849','cs_sold_date_sk=2450850','cs_sold_date_sk=2450851','cs_sold_date_sk=2450852','cs_sold_date_sk=2450853','cs_sold_date_sk=2450854','cs_sold_date_sk=2450855','cs_sold_date_sk=2450856',...,'cs_sold_date_sk=2452654') group by \"PARTITION_NAME\";\n{noformat}\n\nFunctionally equivalent query runs in 0.1 seconds\n{noformat}\n--Query_time: 0.121296  Lock_time: 0.000156 Rows_sent: 1836  Rows_examined: 18360\nselect count(\"COLUMN_NAME\") from \"PART_COL_STATS\"\n where \"DB_NAME\" = 'tpcds_bin_partitioned_orc_30000' and \"TABLE_NAME\" = 'catalog_sales'  and \"COLUMN_NAME\" in \n('cs_bill_customer_sk','cs_bill_cdemo_sk','cs_item_sk','cs_quantity','cs_list_price','cs_sales_price','cs_coupon_amt','cs_net_profit')\n group by \"PARTITION_NAME\";\n\n{noformat}\n\nIf removing the partition list seems drastic, its also possible to simply list the range since hive gets a ordered list of partition names. This performs equally well as earlier query\n\n{noformat}\n# Query_time: 0.143874  Lock_time: 0.000154 Rows_sent: 1836  Rows_examined: 18360\nSET timestamp=1464014881;\nselect count(\"COLUMN_NAME\") from \"PART_COL_STATS\" where \"DB_NAME\" = 'tpcds_bin_partitioned_orc_30000' and \"TABLE_NAME\" = 'catalog_sales'  and \"COLUMN_NAME\" in \n('cs_bill_customer_sk','cs_bill_cdemo_sk','cs_item_sk','cs_quantity','cs_list_price','cs_sales_price','cs_coupon_amt','cs_net_profit')\n  and \"PARTITION_NAME\" >= 'cs_sold_date_sk=2450815' and \"PARTITION_NAME\" <= 'cs_sold_date_sk=2452654' \ngroup by \"PARTITION_NAME\";\n{noformat}\n\nAnother thing to check is the IN clause of column names. Columns in projection list of hive query are mentioned here. Not sure if statistics of these columns are required for hive query optimization.",
        "duedate": null,
        "environment": null,
        "fixVersions": [],
        "issuelinks": [],
        "issuetype": {
            "avatarId": 21133,
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "id": "1",
            "name": "Bug",
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "subtask": false
        },
        "labels": [],
        "lastViewed": null,
        "priority": {
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "id": "3",
            "name": "Major",
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3"
        },
        "progress": {
            "progress": 0,
            "total": 0
        },
        "project": {
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935",
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935"
            },
            "id": "12310843",
            "key": "HIVE",
            "name": "Hive",
            "projectCategory": {
                "description": "Scalable Distributed Computing",
                "id": "10292",
                "name": "Hadoop",
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292"
            },
            "self": "https://issues.apache.org/jira/rest/api/2/project/12310843"
        },
        "reporter": {
            "active": true,
            "avatarUrls": {
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452",
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452"
            },
            "displayName": "Nita Dembla",
            "key": "ndembla",
            "name": "ndembla",
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ndembla",
            "timeZone": "America/New_York"
        },
        "resolution": null,
        "resolutiondate": null,
        "status": {
            "description": "A patch for this issue has been uploaded to JIRA by a contributor.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/document.png",
            "id": "10002",
            "name": "Patch Available",
            "self": "https://issues.apache.org/jira/rest/api/2/status/10002",
            "statusCategory": {
                "colorName": "yellow",
                "id": 4,
                "key": "indeterminate",
                "name": "In Progress",
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/4"
            }
        },
        "subtasks": [],
        "summary": "Hive metastore queries when there is no filter on partition column are inefficient",
        "timeestimate": null,
        "timeoriginalestimate": null,
        "timespent": null,
        "updated": "2016-10-24T23:45:31.000+0000",
        "versions": [{
            "archived": false,
            "id": "12335837",
            "name": "2.2.0",
            "releaseDate": "2017-07-25",
            "released": true,
            "self": "https://issues.apache.org/jira/rest/api/2/version/12335837"
        }],
        "votes": {
            "hasVoted": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-13995/votes",
            "votes": 0
        },
        "watches": {
            "isWatching": false,
            "self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-13995/watchers",
            "watchCount": 5
        },
        "workratio": -1
    },
    "id": "12977778",
    "key": "HIVE-13995",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/12977778"
}