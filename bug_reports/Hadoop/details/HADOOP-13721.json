{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13012162","self":"https://issues.apache.org/jira/rest/api/2/issue/13012162","key":"HADOOP-13721","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337975","id":"12337975","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-10-13T22:50:24.549+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Oct 14 21:19:48 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1155890_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_83138665","customfield_12312321":null,"resolutiondate":"2016-10-14T21:09:51.547+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-13721/watchers","watchCount":5,"isWatching":false},"created":"2016-10-13T21:44:59.416+0000","customfield_12310192":"The unused method getTrashCanLocation has been removed. This method has long been superceded by FileSystem#getTrashRoot.","customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10342","value":"Incompatible change","id":"10342"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337975","id":"12337975","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-10-14T21:19:48.748+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12318800","id":"12318800","name":"viewfs","description":"View file system (Federation) "}],"timeoriginalestimate":null,"description":"\n{{ViewFileSystem}} which extends {{FileSystem}} has a public method {{getTrashCanLocation}} which is neither overridden nor used by anybody. Looks like it existed when the file was created, and also I see the implementation returning homeDirectory which might not be the expected one in cases of {{expunge}}. So, inclined to remove this stale and potentially dangerous method unless anyone has any concerns. \n\n{code}\n  public Path getTrashCanLocation(final Path f) throws FileNotFoundException {\n    final InodeTree.ResolveResult<FileSystem> res = \n      fsState.resolve(getUriPath(f), true);\n    return res.isInternalDir() ? null : res.targetFileSystem.getHomeDirectory();\n  }\n{code}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337975","id":"12337975","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12833212","id":"12833212","filename":"HADOOP-13721.01.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-13T22:04:05.152+0000","size":982,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12833212/HADOOP-13721.01.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Remove stale method ViewFileSystem#getTrashCanLocation","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15573334","id":"15573334","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"body":"* {{expunge}} command relies on {{fs.trash.classname}} property or the default impl {{TrashPolicyDefault}}. The default Trash policy  relies on {{FileSystem#getTrashRoot}} to get the trash directory. \n* Currently I couldn't find any users for {{ViewFileSystem#getTrashCanLocation}}. Also the implementation is wrong, which return the home directory for the trash can.\n\nSo, inclined to remove this method {{ViewFileSystem#getTrashCanLocation}} for good. \n\n[~andrew.wang] can you please let me know if I am overlooking something very obvious here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-13T22:04:05.156+0000","updated":"2016-10-13T22:04:05.156+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15573456","id":"15573456","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 18s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  7m 27s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  7m 48s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 26s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  7s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 13s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 33s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 46s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 45s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  7m 28s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  7m 28s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 27s{color} | {color:green} hadoop-common-project/hadoop-common: The patch generated 0 new + 61 unchanged - 1 fixed = 61 total (was 62) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 59s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 31s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 42s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 16s{color} | {color:green} hadoop-common in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 24s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 41m 50s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:9560f25 |\n| JIRA Issue | HADOOP-13721 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12833212/HADOOP-13721.01.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux a921af304247 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 0a85d07 |\n| Default Java | 1.8.0_101 |\n| findbugs | v3.0.0 |\n|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/10775/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/10775/console |\n| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-13T22:50:24.549+0000","updated":"2016-10-13T22:50:24.549+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15573605","id":"15573605","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"Good find Manoj. This is almost certainly supposed to be getTrashRoot and family.\n\nRelated question though, does the default getTrashRoot implementation work for ViewFileSystem? It seems like we need to defer to the resolved filesystem's implementation, since DFS for instance re-implements it to support encryption zones.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-14T00:11:36.232+0000","updated":"2016-10-14T00:11:36.232+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15576172","id":"15576172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"body":"\n{{Expunge}} works with {{ViewFileSystem}}.\n\nThe way Expunge works is \n{code}\n    @Override\n    protected void processArguments(LinkedList<PathData> args)\n    throws IOException {\n      FileSystem[] childFileSystems =\n          FileSystem.get(getConf()).getChildFileSystems();\n      if (null != childFileSystems) {\n        for (FileSystem fs : childFileSystems) {\n          Trash trash = new Trash(fs, getConf());\n          trash.expunge();\n          trash.checkpoint();\n        }\n      } else {\n      ... \n    }\n{code}\n\nSince {{ViewFileSystem}} implements getChildFileSystems() and exports all the mounted file systems, expunge is invoked on the all these mounted filesystems.\n\n{noformat}\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls /\nFound 4 items\n-r-xr-xr-x   - manoj staff          0 2016-10-14 11:30 /nn0\n-r-xr-xr-x   - manoj staff          0 2016-10-14 11:30 /nn1\n-r-xr-xr-x   - manoj staff          0 2016-10-14 11:30 /nn2\n-r-xr-xr-x   - manoj staff          0 2016-10-14 11:30 /nn3\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls /nn0\nFound 1 items\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls -R /nn0\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user/manoj\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -mkdir -p /nn0/delete/test1\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -mkdir -p /nn0/delete/test2\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls -R /nn0\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/delete/test1\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/delete/test2\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user/manoj\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -rm -r /nn0/delete/test1\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls -R /nn0\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:32 /nn0/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/delete/test2\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash/Current\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash/Current/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/user/manoj/.Trash/Current/delete/test1\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -rm -r -skipTrash /nn0/delete/test2\nDeleted /nn0/delete/test2\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls -R /nn0\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:33 /nn0/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash/Current\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash/Current/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/user/manoj/.Trash/Current/delete/test1\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -expunge\nmanoj@~/work/test/hadev-mg(master)*: hdfs dfs -ls -R /nn0\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:33 /nn0/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:27 /nn0/user\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj\ndrwx------   - manoj supergroup          0 2016-10-14 11:34 /nn0/user/manoj/.Trash\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash/161014113451\ndrwx------   - manoj supergroup          0 2016-10-14 11:32 /nn0/user/manoj/.Trash/161014113451/delete\ndrwxr-xr-x   - manoj supergroup          0 2016-10-14 11:31 /nn0/user/manoj/.Trash/161014113451/delete/test1\n{noformat}\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-14T18:56:18.333+0000","updated":"2016-10-14T18:56:18.333+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15576482","id":"15576482","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"Gotcha. Looking at the Shell code, it resolves the child filesystem before creating the Trash, and calls getTrashRoot correctly. Emptying is handled server-side by each namenode.\n\nLGTM +1 will commit shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-14T21:07:30.651+0000","updated":"2016-10-14T21:07:30.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15576488","id":"15576488","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed to trunk.\n\nManoj, do you want to do another JIRA to mark this method as @Deprecated in branch-2?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-14T21:09:53.703+0000","updated":"2016-10-14T21:09:53.703+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13012162/comment/15576519","id":"15576519","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #10616 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/10616/])\nHADOOP-13721. Remove stale method ViewFileSystem#getTrashCanLocation. (wang: rev aee538be6c2ab324de4d7834cd3347959272de01)\n* (edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/viewfs/ViewFileSystem.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-14T21:19:48.748+0000","updated":"2016-10-14T21:19:48.748+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-13721/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i34v4f:"}}