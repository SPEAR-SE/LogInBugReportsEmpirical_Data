{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12991668","self":"https://issues.apache.org/jira/rest/api/2/issue/12991668","key":"HADOOP-13404","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2016-07-22T16:40:40.375+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jul 25 02:56:28 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_263636440_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-07-25T02:56:55.235+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-13404/watchers","watchCount":4,"isWatching":false},"created":"2016-07-22T01:42:59.090+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-07-25T02:56:55.468+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"In our reliability test, in namenode, inject fault like cpu 100% consumed, after fault injection, for existing connection, all the request will hangs forever, not timeout. for new coming connection, it will failover to another namenode in HA deployment.\n\nThere is no timeout mechanism for calls on established connection.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"RPC call hangs when server side CPU overloaded","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shihaoliang","name":"shihaoliang","key":"shihaoliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Shi","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shihaoliang","name":"shihaoliang","key":"shihaoliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Shi","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12991668/comment/15388747","id":"15388747","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shihaoliang","name":"shihaoliang","key":"shihaoliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Shi","active":true,"timeZone":"Asia/Shanghai"},"body":"I think there are 2 solution\n\n1) add ping response in RPC server, and check the response in client side. Need client side and server side modification, which may have some compatibility issue.\n2) add thread to scan the  calls inside the connection, send timeout exception to the response if the call do not get response for a long time. This is only client side solution.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shihaoliang","name":"shihaoliang","key":"shihaoliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Shi","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-07-22T01:49:00.798+0000","updated":"2016-07-22T01:49:00.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12991668/comment/15389805","id":"15389805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"There is definitely a timeout mechanism in the client. Depending on your release, ipc.client.rpc-timeout.ms=timeout; or ipc.client.ping=false, ipc.ping.interval=timeout.  If you set ipc.client.ping=true, it will just verify that the connection is up, not that the other end is responsive.\n\nAfter a failover, the client will get standby exceptions as the handlers drain the callq.  The standby to active transition should not have occurred until the former went into standby (which sends the standby exceptions).  The transition must have been forced and effectively created an active/active condition.  In this invalid state, yes, clients with no timeout will hang forever while the NN is hung - \"Works as designed\".  If the hung active was stopped, clients would failover.  \n\nPlease test the timeouts and close as invalid unless there's a bug in the timeouts or standby transition.\n\nbq. Need client side and server side modification, which may have some compatibility issue.\nAlthough not needed here, -100 for an incompatible change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2016-07-22T16:40:40.375+0000","updated":"2016-07-22T16:40:40.375+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12991668/comment/15391275","id":"15391275","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shihaoliang","name":"shihaoliang","key":"shihaoliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Shi","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks for the explanation, issue is solved,\nclose the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shihaoliang","name":"shihaoliang","key":"shihaoliang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Peter Shi","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-07-25T02:56:28.897+0000","updated":"2016-07-25T02:56:28.897+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-13404/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i31csf:"}}