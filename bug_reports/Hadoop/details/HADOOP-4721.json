{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12409182","self":"https://issues.apache.org/jira/rest/api/2/issue/12409182","key":"HADOOP-4721","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2008-11-25T10:58:31.964+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Dec 08 16:29:09 UTC 2008","customfield_12310420":"126691","customfield_12312320":null,"customfield_12310222":"3_*:*_1_*:*_1139507838_*|*_1_*:*_1_*:*_3547720_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2008-12-08T16:29:09.558+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-4721/watchers","watchCount":1,"isWatching":false},"created":"2008-11-25T10:58:14.691+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313438","id":"12313438","description":"","name":"0.20.0","archived":false,"released":true,"releaseDate":"2009-04-22"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-04-29T08:51:39.126+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311440","id":"12311440","name":"test","description":"Testing support software"}],"timeoriginalestimate":null,"description":"The root cause may be my lifecycle changes, but I'm seeing an OOM in TestSetupAndCleanupFailure\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12394657","id":"12394657","filename":"log4j.properties","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T15:51:20.876+0000","size":2895,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12394657/log4j.properties"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"104156","customfield_12312823":null,"summary":"OOM in .TestSetupAndCleanupFailure","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"64 bit linux with JRockit 64-bit JVM","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650524","id":"12650524","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"Stack trace \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T10:58:31.964+0000","updated":"2008-11-25T10:58:31.964+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650525","id":"12650525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"Stack Trace (resent)\n\n    [junit] Exception in thread \"Main Thread\" java.lang.OutOfMemoryError: allocLargeObjectOrArray - Object size: 164626424, Num elements: 164626404\n    [junit]     at java.util.Arrays.copyOf(Arrays.java:2786)\n    [junit]     at java.io.ByteArrayOutputStream.toByteArray(ByteArrayOutputStream.java:133)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:448)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:911)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:768)\n    [junit] Running org.apache.hadoop.mapred.TestSetupAndCleanupFailure\n    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec\n    [junit] Test org.apache.hadoop.mapred.TestSetupAndCleanupFailure FAILED (timeout)\n\nThis is in ant,\n\n            if (startTestSuiteSuccess) {\n                sendOutAndErr(new String(outStrm.toByteArray()),\n                              new String(errStrm.toByteArray()));\n            }\n\nAnd it is triggered by either of the streams being too big for junit to handle. This is something to x-file with Ant, but there is also a root cause somewhere to deal with -what is creating 164MB worth of stdout or stderr?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T11:00:51.162+0000","updated":"2008-11-25T11:00:51.162+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650586","id":"12650586","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"Patching Ant to handle this gracefully (by catching the OOM exception and skipping the conversion) shows the underlying cause, its Log4J that is running out of memory\n\n\n\njava.lang.OutOfMemoryError: requested array is larger than heap\nat java.util.Arrays.copyOf(Arrays.java:2786)\nat java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:94)\nat java.io.PrintStream.write(PrintStream.java:430)\nat sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:202)\nat sun.nio.cs.StreamEncoder.implFlushBuffer(StreamEncoder.java:272)\nat sun.nio.cs.StreamEncoder.implFlush(StreamEncoder.java:276)\nat sun.nio.cs.StreamEncoder.flush(StreamEncoder.java:122)\nat java.io.OutputStreamWriter.flush(OutputStreamWriter.java:212)\nat org.apache.log4j.helpers.QuietWriter.flush(QuietWriter.java:58)\nat org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:316)\nat org.apache.log4j.WriterAppender.append(WriterAppender.java:160)\nat org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:251)\nat org.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:66)\nat org.apache.log4j.Category.callAppenders(Category.java:206)\nat org.apache.log4j.Category.forcedLog(Category.java:391)\nat org.apache.log4j.Category.log(Category.java:856)\nat org.apache.commons.logging.impl.Log4JLogger.info(Log4JLogger.java:133)\nat org.apache.hadoop.hdfs.MiniDFSCluster.shutdown(MiniDFSCluster.java:550)\nat org.apache.hadoop.mapred.TestSetupAndCleanupFailure.testWithDFS(TestSetupAndCleanupFailure.java:107)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T14:48:56.603+0000","updated":"2008-11-25T14:48:56.603+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650589","id":"12650589","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"This is in this line: \n\nLOG.info(\"Shutting down the Mini HDFS Cluster\");\n\nCould be something to discuss with Team Log4J. But the underlying cause is, presumably, that a few hundred MB of text are somehow being written out and neither Ant nor Log4J are happy with this. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T14:54:26.183+0000","updated":"2008-11-25T14:54:26.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650591","id":"12650591","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"body":"Hello Steve,\n\nDo you know the size of the buffer of FileAppender? Could you please provide your log4j.properties file?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T15:14:01.968+0000","updated":"2008-11-25T15:14:01.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650594","id":"12650594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"body":"Try setting the 'immediateFlush'  property of your FileAppender to true. \n\nIf that is already the case, is it possible that the data being logged is very large?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T15:36:40.844+0000","updated":"2008-11-25T15:36:40.844+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650598","id":"12650598","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"This is the log4J config file; its the hadoop log4j with the debug logger altered to not print the thread info -that was causing a deadlock on JRockit","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T15:51:20.924+0000","updated":"2008-11-25T15:51:20.924+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650618","id":"12650618","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"body":"Which one is the \"debug logger\"? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T16:39:04.615+0000","updated":"2008-11-25T16:39:04.615+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650629","id":"12650629","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"that's a point. Hang on, I'm not sure thats' the log4 properties file used in test runs","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T17:09:58.763+0000","updated":"2008-11-25T17:09:58.763+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650632","id":"12650632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"the properties file used in my test runs is \n\n# log4j configuration used during build and unit tests\n\nlog4j.rootLogger=info,stdout\nlog4j.threshhold=ALL\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%d{ISO8601} [%t] %-5p %c{2} %x- %m%n\n\nIt's different from the one in SVN because of HADOOP-3654 \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T17:15:43.163+0000","updated":"2008-11-25T17:15:43.163+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650641","id":"12650641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"body":"There is nothing wrong with the above config file. Moreover, it is already configured for immediate flush which is the default. \n\n1) Which version of log4j is this? \n2) Are you really sure that the message being logged is not huge or somehow becomes huge? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T17:38:45.631+0000","updated":"2008-11-25T17:38:45.631+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650646","id":"12650646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"body":"Looking at the source code of MiniDFSCluster.java [1], I can't see any references to logging. \n\nWhat happens when you disable logging altogether? Maybe there is no memory because there is a leak somewhere unrelated to log4j.\n\n[1] http://tinyurl.com/69soss\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ceki%40qos.ch","name":"ceki@qos.ch","key":"ceki@qos.ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ceki%40qos.ch&avatarId=16609","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ceki%40qos.ch&avatarId=16609","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ceki%40qos.ch&avatarId=16609","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ceki%40qos.ch&avatarId=16609"},"displayName":"Ceki Gülcü","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T17:46:33.421+0000","updated":"2008-11-25T17:46:33.421+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650757","id":"12650757","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"I dont think there is a memory leak, I just fear that too much is being buffered -even on console output- though it could be hidden by Ant playing games underneath. If Ant is still buffering everything going to stdout and log4j is pushing to stdout, Ant could be the cause even though it is not in the stack trace. \n\nI will downgrade logging level to INFO and see if that is enough to make the problem go away.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-25T21:49:54.604+0000","updated":"2008-11-25T21:49:54.604+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650952","id":"12650952","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"Ceki, we're running 1.1.15. \n\nIf I set logging to ERROR then the test succeeds in <3 minutes and all is well. Things go wrong at DEBUG level. It could be there's too much stuff coming to stdout for ant, or there could be some looping going on. Or it could be a JRockit x64 problem. I'll try some more experiments (same code under a sun JVM, more selective log levels, etc)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-26T10:59:38.580+0000","updated":"2008-11-26T10:59:38.580+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12650963","id":"12650963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"The trigger for this is my having the following line in src/test/log4.properties\n\nlog4j.logger.org.apache.hadoop.mapred=DEBUG\n\nDoes anyone else see the same problem if they add this to their log4 properties file?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-26T11:34:33.969+0000","updated":"2008-11-26T11:34:33.969+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409182/comment/12654451","id":"12654451","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"body":"I now think this is a problem with Ant setting up junit to log the output; at debug level this test just creates too much data. There's no solution to this within og4j or hadoop. Closing as WONTFIX. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_l","name":"steve_l","key":"steve_l","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Loughran","active":true,"timeZone":"Etc/UTC"},"created":"2008-12-08T16:29:09.535+0000","updated":"2008-12-08T16:29:09.535+0000"}],"maxResults":16,"total":16,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-4721/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0i6jz:"}}