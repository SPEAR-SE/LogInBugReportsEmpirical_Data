{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12544263","self":"https://issues.apache.org/jira/rest/api/2/issue/12544263","key":"HADOOP-8115","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-02-27T16:46:10.954+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Jun 28 03:21:15 UTC 2014","customfield_12310420":"229500","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-8115/watchers","watchCount":5,"isWatching":false},"created":"2012-02-27T15:37:03.549+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-06-28T03:21:15.395+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"The order of loading configuration files (and thus the order of priority from least to most) seems to be as follows:\ncore-default.xml, core-site.xml, hdfs-default.xml, hdfs-site.xml.\n\nThis means that a configuration parameter that is set in hdfs-default.xml will override that value set in core-site.xml. \n\nEither\n(1) Parameters should be able to go in any site.xml file, and override any default.xml, even if they don't \"match\", or\n(2) Putting a parameter in the \"wrong\" site.xml file should be considered an error, and result in at the very least a warning.\nWhat in fact happens is that the parameter is silently ignored, which is the worst combination.\n\nI my opinion, it is counter-intuitive that a value in a site.xml file should be overridden by a value in a default.xml file, so I would choose option (1).\n\nThe particular example here was dfs.http.address, by the way.\n\nI marked this as major rather than minor since it was not at all obvious what the problem (and therefore the workaround was) and eventually required attaching to a running production service with a debugger to find out why the parameter I was setting was being ignored.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"43804","customfield_12312823":null,"summary":"configuration entry in core-site.xml gets silently ignored","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=happyharris","name":"happyharris","key":"happyharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Harris","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=happyharris","name":"happyharris","key":"happyharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Harris","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"v 0.20.203.0\nStandard tar release (i.e. not Cloudera or anything)\nUbuntu","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12544263/comment/13217270","id":"13217270","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"body":"Unfortunately the order of loading is not always consistent.  Just look at the bug I just did HDFS-3012.  Because we us static blocks to load the resources those static blocks are executed when the class file that contains them is loaded.  The order that class files are loaded is based off of when java decided to load the file, and because java currently does lazy loading it tends to only load them when code inside that class file is actually going to be executed for the first time.  Because core-default.xml and core-site.xml are part of the Configuration class they are always going to be the first to load.  But there is no guarantee the order that others will come in, or even if they will be loaded, which is the problem that showed up in HDFS-3012.\n\nBecause the ordering cannot really be controlled when using static blocks to load the configuration the only way to really do (1) is to give each file some sort of a globally universal priority.  Who wins when a configuration value is in hdfs-site.xml and also in mapred-site.xml?  We have that problem now, but because we tend to support more of (2) by convention instead of having the enforcement it is not really as much of a concern as if we officially support (1).  I personally would prefer to see option (2) as it is closer to what we do now, but I am not sure what the proper way is to implement it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=revans2","name":"revans2","key":"revans2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Joseph Evans","active":true,"timeZone":"America/Chicago"},"created":"2012-02-27T16:46:10.954+0000","updated":"2012-02-27T16:46:10.954+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12544263/comment/13217363","id":"13217363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"Never leave the *-default.xml files in conf/ in modern versions of Hadoop.  Bad Things(tm) always seem to happen.\n\nLately I've been debating actually just having blank versions of hdfs-site.xml and mapred-site.xml and merging everything back into core-site.xml like the olden days.  It isn't of much practical use to have different versions of these files. Plus as we look towards doing an (internal) rewrite of the startup scripts to autogen the config information, it removes the decision making around which file is supposed to get which config.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2012-02-27T18:38:24.498+0000","updated":"2012-02-27T18:38:24.498+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12544263/comment/13217371","id":"13217371","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=happyharris","name":"happyharris","key":"happyharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Harris","active":true,"timeZone":"Etc/UTC"},"body":"The order of loading wrt. mapred vs. hdfs vs. core is not something that can easily be made consistent. However default vs. site looks like it should be fairly straightforward. The full set of files gets re-loaded whenever a configuration file gets added to the list so it would be straightforward to make sure that the default ones are loaded first. This could be done based on the file names, based on whether they are in the jar files or the file system, or more properly by having the callers of Configuration.addDefaultResource say whether the resource is a default or not.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=happyharris","name":"happyharris","key":"happyharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Harris","active":true,"timeZone":"Etc/UTC"},"created":"2012-02-27T18:43:43.085+0000","updated":"2012-02-27T18:43:43.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12544263/comment/13217380","id":"13217380","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=happyharris","name":"happyharris","key":"happyharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Harris","active":true,"timeZone":"Etc/UTC"},"body":"Clarification based on Allen's comment: in my case, the -default.xml files were not in the conf directories, they were the ones from the jar files. I should have said -default.xml resources.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=happyharris","name":"happyharris","key":"happyharris","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Harris","active":true,"timeZone":"Etc/UTC"},"created":"2012-02-27T18:46:16.827+0000","updated":"2012-02-27T18:46:16.827+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12544263/comment/14046715","id":"14046715","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=globar","name":"globar","key":"globar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Globar","active":true,"timeZone":"Etc/UTC"},"body":"Why are we using the static blocks to load these resources. Shouldn't the configuration classes constructor explicitly load all of the config files: core, hdfs, mapred, etc? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=globar","name":"globar","key":"globar","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Globar","active":true,"timeZone":"Etc/UTC"},"created":"2014-06-28T03:21:15.395+0000","updated":"2014-06-28T03:21:15.395+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-8115/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07v3b:"}}