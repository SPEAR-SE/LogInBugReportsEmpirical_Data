{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13066566","self":"https://issues.apache.org/jira/rest/api/2/issue/13066566","key":"HADOOP-14350","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2017-04-25T11:31:23.295+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed May 17 20:33:34 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-14350/watchers","watchCount":2,"isWatching":false},"created":"2017-04-25T03:25:58.812+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334005","id":"12334005","description":"2.7.3 release","name":"2.7.3","archived":false,"released":true,"releaseDate":"2016-08-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-05-17T20:33:34.102+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12330961","id":"12330961","name":"common"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12312526","id":"12312526","name":"security"}],"timeoriginalestimate":null,"description":"For the sample code below:\n{code}\npublic class TestKrb {\n  public static void main(String[] args) throws IOException {\n    String user = args[0], path = args[1];\n    UserGroupInformation ugi = UserGroupInformation.loginUserFromKeytabAndReturnUGI(user, path);\n    System.out.println(\"Login successfully\");\n  }\n}\n{code}\nWhen I use IBM JDK and pass a relative path for the Kerberos keytab, it will throw error messages.  According to the debug log, it always tries to read the keytab from the root path.  See the debug logs below:\n\n\nIn above log, the useKeytab=<value> entry is showing a <value> prefaced by a leading \"//\".  It appears that HADOOP is adjusting the user supplied keytab file and most likely prefacing it with something like \"FILE://\", which would cause the resulting IBM normalized value to then be prefaced by \"//\" before the user supplied keytab file.  This is the cause for why relative paths used with HADOOP are not working with IBM JVM's.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Relative path for Kerberos keytab is not working on IBM JDK","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"IBM JDK","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/15982317","id":"15982317","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"body":"java version \"1.8.0\"\nJava(TM) SE Runtime Environment (build pxa6480sr4fp1-20170215_01(SR4 FP1))\nIBM J9 VM (build 2.8, JRE 1.8.0 Linux amd64-64 Compressed References 20170209_336038 (JIT enabled, AOT enabled)\nJ9VM - R28_20170209_0201_B336038\nJIT  - tr.r14.java.green_20170125_131456\nGC   - R28_20170209_0201_B336038_CMPRSS\nJ9CL - 20170209_336038)\nJCL - 20170215_01 based on Oracle jdk8u121-b13","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"created":"2017-04-25T03:28:07.922+0000","updated":"2017-04-25T03:28:07.922+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/15982737","id":"15982737","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"What happens on Hadoop 2.8?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-04-25T11:31:23.295+0000","updated":"2017-04-25T11:31:23.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/15984142","id":"15984142","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"body":"I try Hadoop 2.8, but also get the same error messages.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"created":"2017-04-26T04:21:09.770+0000","updated":"2017-04-26T04:21:09.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/16000305","id":"16000305","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"body":"Can anyone help on this issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-08T05:55:40.677+0000","updated":"2017-05-08T05:55:40.677+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/16000519","id":"16000519","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"OK, I think right now you are going to have to help us deal with this as you are the one with the IBM JDK. Know that Kerberos is one area where the implementations vary between JDK implementations and versions, and that because we need more detailed APIs than the public ones, it's fairly low level and brittle. We are [scared of kerberos|https://www.gitbook.com/book/steveloughran/kerberos_and_hadoop/details]\n\nLooking at the Hadoop code when a keytab is passed it, we're assuming its absolute:   \n{code}\nprivate static String prependFileAuthority(String keytabPath) {\n    return keytabPath.startsWith(\"file://\") ? keytabPath\n        : \"file://\" + keytabPath;\n  }\n{code}\n\nI *suspect* that this could be a cause, but it makes me worry that changing this will break other things everywhere else -and that the use of URLs implies that the Kerberos code expects absolute paths.\n\nCan't you just set it up with an absolute path? I don't even see a relative file:local.keytab ref working, as that would only confuse the condition.\n\nOtherwise, with Hadoop 2.8 you can now run [[KDiag|http://hadoop.apache.org/docs/r2.8.0/hadoop-project-dist/hadoop-common/SecureMode.html#Troubleshooting_with_KDiag] which tries to make sense of what's going on. Can you run that with all the logging on and see if it helps?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-05-08T09:47:17.696+0000","updated":"2017-05-08T09:47:17.696+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/16011660","id":"16011660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"body":"Actually we are running Spark job on yarn application. Spark will copy the keytab to its working directory and pass the relative path to the login method. We are not able to configure Spark to use absolute path.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shuitingjianle","name":"shuitingjianle","key":"shuitingjianle","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Wen Yuan Chen","active":true,"timeZone":"Etc/UTC"},"created":"2017-05-16T02:44:25.130+0000","updated":"2017-05-16T02:44:25.130+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/16014713","id":"16014713","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"Stack trace from example\n{code}\n2017-04-19 02:29:13,982 DEBUG [org.apache.hadoop.metrics2.lib.MutableMetricsFactory] - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginSuccess with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, sampleName=Ops, always=false, type=DEFAULT, value=[Rate of successful kerberos logins and latency (milliseconds)], valueName=Time)\n2017-04-19 02:29:13,990 DEBUG [org.apache.hadoop.metrics2.lib.MutableMetricsFactory] - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginFailure with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, sampleName=Ops, always=false, type=DEFAULT, value=[Rate of failed kerberos logins and latency (milliseconds)], valueName=Time)\n2017-04-19 02:29:13,991 DEBUG [org.apache.hadoop.metrics2.lib.MutableMetricsFactory] - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.getGroups with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, sampleName=Ops, always=false, type=DEFAULT, value=[GetGroups], valueName=Time)\n2017-04-19 02:29:13,992 DEBUG [org.apache.hadoop.metrics2.impl.MetricsSystemImpl] - UgiMetrics, User and group related metrics\n[KRB_DBG_CFG] Config:main:   Java config file: /opt/ibm/java/jre/lib/security/krb5.conf\n[KRB_DBG_CFG] Config:main:   Loaded from Java config\n2017-04-19 02:29:14,175 DEBUG [org.apache.hadoop.security.Groups] -  Creating new Groups object\n2017-04-19 02:29:14,178 DEBUG [org.apache.hadoop.util.NativeCodeLoader] - Trying to load the custom-built native-hadoop library...\n2017-04-19 02:29:14,179 DEBUG [org.apache.hadoop.util.NativeCodeLoader] - Failed to load native-hadoop with error: java.lang.UnsatisfiedLinkError: hadoop (Not found in java.library.path)\n2017-04-19 02:29:14,179 DEBUG [org.apache.hadoop.util.NativeCodeLoader] - java.library.path=/opt/ibm/java/jre/lib/amd64/compressedrefs:/opt/ibm/java/jre/lib/amd64:/usr/lib64:/usr/lib\n2017-04-19 02:29:14,179 WARN [org.apache.hadoop.util.NativeCodeLoader] - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n2017-04-19 02:29:14,180 DEBUG [org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback] - Falling back to shell based\n2017-04-19 02:29:14,180 DEBUG [org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback] - Group mapping impl=org.apache.hadoop.security.ShellBasedUnixGroupsMapping\n2017-04-19 02:29:14,334 DEBUG [org.apache.hadoop.util.Shell] - setsid exited with exit code 0\n2017-04-19 02:29:14,334 DEBUG [org.apache.hadoop.security.Groups] - Group mapping impl=org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback; cacheTimeout=300000; warningDeltaMs=5000\nIBMJGSSProvider Build-Level: -20161128\n[JGSS_DBG_CRED]  main JAAS config: principal=job/analytics\n[JGSS_DBG_CRED]  main JAAS config: credsType=initiate and accept\n[JGSS_DBG_CRED]  main config: useDefaultCcache=false\n[JGSS_DBG_CRED]  main config: useCcache=null\n[JGSS_DBG_CRED]  main config: useDefaultKeytab=false\n[JGSS_DBG_CRED]  main config: useKeytab=//job.keytab\n[JGSS_DBG_CRED]  main JAAS config: forwardable=false (default)\n[JGSS_DBG_CRED]  main JAAS config: renewable=false (default)\n[JGSS_DBG_CRED]  main JAAS config: proxiable=false (default)\n[JGSS_DBG_CRED]  main JAAS config: tryFirstPass=false (default)\n[JGSS_DBG_CRED]  main JAAS config: useFirstPass=false (default)\n[JGSS_DBG_CRED]  main JAAS config: moduleBanner=false (default)\n[JGSS_DBG_CRED]  main JAAS config: interactive login? no\n[JGSS_DBG_CRED]  main JAAS config: refreshKrb5Config = true\n[KRB_DBG_CFG] Config:main:   Java config file: /opt/ibm/java/jre/lib/security/krb5.conf\n[KRB_DBG_CFG] Config:main:   Loaded from Java config\n[KRB_DBG_KDC] KdcComm:main:   >>> KdcAccessibility: reset\n[KRB_DBG_KDC] KdcComm:main:   >>> KdcAccessibility: reset\n[JGSS_DBG_CRED]  main Try keytab for principal=job/analytics\n[KRB_DBG_KTAB] KeyTab:main:   >>> KeyTab: trying to load keytab file /job.keytab\n[KRB_DBG_KTAB] KeyTab:main:   >>> KeyTab: exception /job.keytab (No such file or directory)\nKey for the principal job/analytics@KDC.LON02.HADOOP not available in //job.keytab\n[KRB_DBG_CCHE] Credentials:main:   >>> Credentials: Created Credentials with 0 keys. Key types:\n[JGSS_DBG_CRED]  main Done retrieving Kerberos creds from keytab\n[JGSS_DBG_CRED]  main Retrieving Kerberos creds from cache for principal=job/analytics\n[JGSS_DBG_CRED]  main Non-interactive login; no callbacks necessary.\n[JGSS_DBG_CRED]  main No Kerberos creds in cache for principal job/analytics\n[JGSS_DBG_CRED]  main Doing Kerberos login for principal job/analytics@KDC.LON02.HADOOP\n2017-04-19 02:29:14,381 DEBUG [org.apache.hadoop.security.UserGroupInformation] - hadoop login\nException in thread \"main\" java.io.IOException: Login failure for job/analytics from keytab job.keytab\n\tat org.apache.hadoop.security.UserGroupInformation.loginUserFromKeytabAndReturnUGI(UserGroupInformation.java:1103)\n\tat com.TestKrb.main(TestKrb.java:10)\nCaused by: javax.security.auth.login.FailedLoginException: Null key\n\tat com.ibm.security.jgss.i18n.I18NException.throwFailedLoginException(I18NException.java:1)\n\tat com.ibm.security.auth.module.Krb5LoginModule.a(Krb5LoginModule.java:355)\n\tat com.ibm.security.auth.module.Krb5LoginModule.b(Krb5LoginModule.java:515)\n\tat com.ibm.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:411)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:95)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:508)\n\tat javax.security.auth.login.LoginContext.invoke(LoginContext.java:788)\n\tat javax.security.auth.login.LoginContext.access$000(LoginContext.java:196)\n\tat javax.security.auth.login.LoginContext$5.run(LoginContext.java:721)\n\tat javax.security.auth.login.LoginContext$5.run(LoginContext.java:719)\n\tat java.security.AccessController.doPrivileged(AccessController.java:686)\n\tat javax.security.auth.login.LoginContext.invokeCreatorPriv(LoginContext.java:719)\n\tat javax.security.auth.login.LoginContext.login(LoginContext.java:593)\n\tat org.apache.hadoop.security.UserGroupInformation.loginUserFromKeytabAndReturnUGI(UserGroupInformation.java:1092)\n\t... 1 more\n{code}\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-05-17T20:31:04.530+0000","updated":"2017-05-17T20:31:04.530+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13066566/comment/16014717","id":"16014717","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"OK, I understand. \n\n# spark should be setting the absolute path\n# hadoop should handle relative paths anyway.\n\nActually, Hadoop should have a version of the login command which takes a {{File}} object and so remove the ambiguity. But that'd take a while to get code downstream to switch to, even if we do it in Hadoop itself.\n\nIf you attach the spark stack, we can create a JIRA there and link it, so I'll see about fixing it there while we do some absolution in Hadoop. Spark's releasing faster, so this could maybe get to a 2.2.x release before long","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-05-17T20:33:34.102+0000","updated":"2017-05-17T20:33:34.102+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-14350/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3e1pz:"}}