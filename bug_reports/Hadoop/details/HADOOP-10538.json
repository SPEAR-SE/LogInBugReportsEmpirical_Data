{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12710275","self":"https://issues.apache.org/jira/rest/api/2/issue/12710275","key":"HADOOP-10538","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2014-04-24T21:04:59.934+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Nov 10 13:19:43 UTC 2017","customfield_12310420":"388597","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_39739630_*|*_4_*:*_1_*:*_111946344034_*|*_5_*:*_2_*:*_139156","customfield_12312321":null,"resolutiondate":"2017-11-10T13:19:43.052+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10538/watchers","watchCount":3,"isWatching":false},"created":"2014-04-24T10:02:40.312+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324147","id":"12324147","description":"maintenance release on branch-1.2","name":"1.2.1","archived":false,"released":true,"releaseDate":"2013-08-01"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-11-10T13:19:43.128+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The TaskTracker always failed to startup when it running on Cygwin. And the error info logged in xxx-tasktracker-xxxx.log is :\n2014-04-21 22:13:51,439 DEBUG org.apache.hadoop.mapred.TaskRunner: putting jobToken file name into environment D:/hadoop/mapred/local/taskTracker/pxie/jobcache/job_201404212205_0001/jobToken\n2014-04-21 22:13:51,439 INFO org.apache.hadoop.mapred.JvmManager: Killing JVM: jvm_201404212205_0001_m_1895177159\n2014-04-21 22:13:51,439 WARN org.apache.hadoop.mapred.TaskRunner: attempt_201404212205_0001_m_000000_0 : Child Error\njava.lang.NumberFormatException: For input string: \"\"\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Integer.parseInt(Integer.java:504)\n\tat java.lang.Integer.parseInt(Integer.java:527)\n\tat org.apache.hadoop.mapred.JvmManager$JvmManagerForType$JvmRunner.kill(JvmManager.java:552)\n\tat org.apache.hadoop.mapred.JvmManager$JvmManagerForType.killJvmRunner(JvmManager.java:314)\n\tat org.apache.hadoop.mapred.JvmManager$JvmManagerForType.reapJvm(JvmManager.java:378)\n\tat org.apache.hadoop.mapred.JvmManager$JvmManagerForType.access$000(JvmManager.java:189)\n\tat org.apache.hadoop.mapred.JvmManager.launchJvm(JvmManager.java:122)\n\tat org.apache.hadoop.mapred.TaskRunner.launchJvmAndWait(TaskRunner.java:292)\n\tat org.apache.hadoop.mapred.TaskRunner.run(TaskRunner.java:251)\n2014-04-21 22:13:51,511 DEBUG org.apache.hadoop.ipc.Server: IPC Server listener on 59983: disconnecting client 127.0.0.1:60154. Number of active connections: 1\n2014-04-21 22:13:51,531 WARN org.apache.hadoop.fs.FileUtil: Failed to set permissions of path: ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"388848","customfield_12312823":null,"summary":"NumberFormatException happened  when hadoop 1.2.1 running on Cygwin","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxie","name":"pxie","key":"pxie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"peter xie","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxie","name":"pxie","key":"pxie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"peter xie","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"OS: windows 7 / Cygwin\n","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12710275/comment/13979553","id":"13979553","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxie","name":"pxie","key":"pxie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"peter xie","active":true,"timeZone":"Asia/Shanghai"},"body":"After reading the core code of hadoop 1.2.1,  and the root cause is clear now.  \nthe details is :\nDuring startup , the tasktracker will open an child process  to by executing the script  \"taskjvm.sh\",  and this script will run the main method in   org.apache.hadoop.mapred.Child.  In this main method,  there has below code :   \n   -----------------------------------------\n    String pid = \"\";\n    if (!Shell.WINDOWS) {\n      pid = System.getenv().get(\"JVM_PID\");\n    }\n    JvmContext context = new JvmContext(jvmId, pid);\n    .......................\n    final JvmContext jvmContext = context;\n    try {\n      while (true) {\n        ..........................;\n        JvmTask myTask = umbilical.getTask(context);\n  ----------------------------------------------\nObviously , that the pid saved to JvmContext is empty under windows platform,  an this pid will send to tacktracker via RPC interface \"getTask\" .\nBut in the kill method of JvmManager of parent process , only the null value checked for pidStr . So when parse the pidStr to int , the NumberFormatException happed likes it showed in log.\n     ----------------------------------------------------------\n      synchronized void kill() throws IOException, InterruptedException {\n        if (!killed) {\n          TaskController controller = tracker.getTaskController();\n          // Check inital context before issuing a kill to prevent situations\n          // where kill is issued before task is launched.\n          String pidStr = jvmIdToPid.get(jvmId);\n          if (null != pidStr) {\n            String user = env.conf.getUser();\n            int pid = Integer.parseInt(pidStr);\n            try {\n              // start a thread that will kill the process dead\n              if (sleeptimeBeforeSigkill > 0) {\n                new DelayedProcessKiller(user, pid, sleeptimeBeforeSigkill, \n                                         Signal.KILL).start();\n                controller.signalTask(user, pid, Signal.TERM);\n              } else {\n                controller.signalTask(user, pid, Signal.KILL);\n              }\n            } catch (IOException e) {\n              LOG.error(\"Catch Exception caused by lack of user information to prevent inconsistent state: \", e);\n            }\n          } else {\n            LOG.info(String.format(\"JVM Not killed %s but just removed\", jvmId\n                .toString()));\n          }\n          killed = true;\n        }\n      }\n\n-------------------------------------------------\nThe solution i used in my local is : the null value check instead of \"!StringUtils.isBlank(pidStr)\" .  \n But i have another question is why the pid is hard code to empty in window paltform ?  \n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pxie","name":"pxie","key":"pxie","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"peter xie","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-04-24T10:27:41.829+0000","updated":"2014-04-24T10:27:41.829+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12710275/comment/13980288","id":"13980288","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Hadoop is not supported on Cygwin.\n\nPlease see [these instructions|https://wiki.apache.org/hadoop/Hadoop2OnWindows] for how to run Hadoop 2.2+ on Windows natively.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-24T21:04:59.934+0000","updated":"2014-04-24T21:04:59.934+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12710275/comment/13980291","id":"13980291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Never mind, I missed that this is Hadoop 1.2.1 although it is right there in the title.\n\nI would recommend upgrading to Hadoop 2.4 unless you have a compelling reason to stick with 1.x. It is stable and works natively on Windows.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-04-24T21:07:19.092+0000","updated":"2014-04-24T21:07:19.092+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12710275/comment/16247488","id":"16247488","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"body":"It's obsolete. 1.x is not supported. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"created":"2017-11-10T13:19:43.119+0000","updated":"2017-11-10T13:19:43.119+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10538/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1uxt3:"}}