{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12946384","self":"https://issues.apache.org/jira/rest/api/2/issue/12946384","key":"HADOOP-12869","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-03-03T04:48:12.423+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sun Apr 10 16:07:26 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-12869/watchers","watchCount":12,"isWatching":false},"created":"2016-03-03T03:13:02.799+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327179","id":"12327179","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12327583","id":"12327583","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335733","id":"12335733","description":"3.0.0-alpha1 release","name":"3.0.0-alpha1","archived":false,"released":true,"releaseDate":"2016-09-03"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-05-12T18:23:45.399+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312526","id":"12312526","name":"security"}],"timeoriginalestimate":null,"description":"Here is the comment of {{FilterInputStream#read()}}:\n{noformat}\n    /**\n     * Reads the next byte of data from this input stream. The value\n     * byte is returned as an <code>int</code> in the range\n     * <code>0</code> to <code>255</code>. If no byte is available\n     * because the end of the stream has been reached, the value\n     * <code>-1</code> is returned. This method blocks until input data\n     * is available, the end of the stream is detected, or an exception\n     * is thrown.\n     * <p>\n     * This method\n     * simply performs <code>in.read()</code> and returns the result.\n     *\n     * @return     the next byte of data, or <code>-1</code> if the end of the\n     *             stream is reached.\n     * @exception  IOException  if an I/O error occurs.\n     * @see        java.io.FilterInputStream#in\n     */\n    public int read() throws IOException {\n        return in.read();\n    }\n{noformat}\nHere is the implementation of {{CryptoInputStream#read()}} in Hadoop Common:\n{noformat}\n@Override\npublic int read() throws IOException {\n  return (read(oneByteBuf, 0, 1) == -1) ? -1 : (oneByteBuf[0] & 0xff);\t\t\n}\n{noformat}\nThe return value of {{read(oneByteBuf, 0, 1)}} maybe 1, -1 and 0:\nFor {{1}}: we should return the content of {{oneByteBuf}}\nFor {{-1}}: we should return {{-1}} to stand for the end of stream\nFor {{0}}: it means we didn't get decryption data back and it is not the end of the stream, we should continue to decrypt the stream. But it return {{0}} on {{read()}} in current implementation, it means the decrypted content is {{0}} and it is incorrect.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12791088","id":"12791088","filename":"HADOOP-12869.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-03-03T03:16:23.469+0000","size":968,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12791088/HADOOP-12869.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12791107","id":"12791107","filename":"HADOOP-12869.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-03-03T06:11:03.172+0000","size":897,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12791107/HADOOP-12869.002.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"CryptoInputStream#read() may return incorrect result","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15177100","id":"15177100","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"body":"Added [~dian.fu] who investigated this issue together with me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-03-03T03:44:37.391+0000","updated":"2016-03-03T03:44:37.391+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15177156","id":"15177156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 10s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red} 0m 0s {color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 6m 57s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 6m 1s {color} | {color:green} trunk passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 6m 53s {color} | {color:green} trunk passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 21s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 6s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 35s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 53s {color} | {color:green} trunk passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 2s {color} | {color:green} trunk passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 41s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 5m 58s {color} | {color:green} the patch passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 5m 58s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 6m 46s {color} | {color:green} the patch passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 6m 46s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 21s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 0s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 52s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 55s {color} | {color:green} the patch passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 4s {color} | {color:green} the patch passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 7m 42s {color} | {color:green} hadoop-common in the patch passed with JDK v1.8.0_72. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 7m 53s {color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_95. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 24s {color} | {color:green} Patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 61m 4s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12791088/HADOOP-12869.001.patch |\n| JIRA Issue | HADOOP-12869 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 5b47f0573f72 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 27941a1 |\n| Default Java | 1.7.0_95 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_72 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_95 |\n| findbugs | v3.0.0 |\n| JDK v1.7.0_95  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/8767/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/8767/console |\n| Powered by | Apache Yetus 0.3.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-03T04:48:12.423+0000","updated":"2016-03-03T04:48:12.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15177299","id":"15177299","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"body":"Updated patch to make logic simple","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dapengsun","name":"dapengsun","key":"dapengsun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dapeng Sun","active":true,"timeZone":"Asia/Shanghai"},"created":"2016-03-03T06:11:03.179+0000","updated":"2016-03-03T06:11:03.179+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15177396","id":"15177396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue} 0m 12s {color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green} 0m 0s {color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:red}-1{color} | {color:red} test4tests {color} | {color:red} 0m 0s {color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 6m 37s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 5m 52s {color} | {color:green} trunk passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 6m 43s {color} | {color:green} trunk passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green} 0m 20s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 3s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 13s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 32s {color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 53s {color} | {color:green} trunk passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 3s {color} | {color:green} trunk passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 0m 40s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 5m 49s {color} | {color:green} the patch passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 5m 49s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 6m 42s {color} | {color:green} the patch passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 6m 42s {color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} checkstyle {color} | {color:red} 0m 21s {color} | {color:red} hadoop-common-project/hadoop-common: patch generated 2 new + 32 unchanged - 0 fixed = 34 total (was 32) {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 1m 0s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green} 0m 14s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green} 0m 0s {color} | {color:green} Patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green} 1m 50s {color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 0m 52s {color} | {color:green} the patch passed with JDK v1.8.0_72 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green} 1m 1s {color} | {color:green} the patch passed with JDK v1.7.0_95 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 6m 48s {color} | {color:green} hadoop-common in the patch passed with JDK v1.8.0_72. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 7m 11s {color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_95. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green} 0m 22s {color} | {color:green} Patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black} 58m 26s {color} | {color:black} {color} |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:0ca8df7 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12791107/HADOOP-12869.002.patch |\n| JIRA Issue | HADOOP-12869 |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 84991624b8ac 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 27941a1 |\n| Default Java | 1.7.0_95 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_72 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_95 |\n| findbugs | v3.0.0 |\n| checkstyle | https://builds.apache.org/job/PreCommit-HADOOP-Build/8771/artifact/patchprocess/diff-checkstyle-hadoop-common-project_hadoop-common.txt |\n| JDK v1.7.0_95  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/8771/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/8771/console |\n| Powered by | Apache Yetus 0.3.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2016-03-03T07:17:04.123+0000","updated":"2016-03-03T07:17:04.123+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15179849","id":"15179849","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=busbey","name":"busbey","key":"busbey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=busbey&avatarId=13233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=busbey&avatarId=13233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=busbey&avatarId=13233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=busbey&avatarId=13233"},"displayName":"Sean Busbey","active":true,"timeZone":"America/Chicago"},"body":"Please add a test that shows the issue.\n\nThe docs for the [read method we call claim|https://docs.oracle.com/javase/7/docs/api/java/io/FilterInputStream.html#read(byte[],%20int,%20int)]:\n\n{code}\npublic int read(byte[] b,\n       int off,\n       int len)\n         throws IOException\n\nReads up to len bytes of data from this input stream into an array of bytes. If len is not zero, the method blocks until some input is available; otherwise, no bytes are read and 0 is returned.\n{code}\n\nWe pass in a len of 1. If FIS is blocking until \"some\" input is available, shouldn't that mean it has to have >= 1 byte available?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=busbey","name":"busbey","key":"busbey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=busbey&avatarId=13233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=busbey&avatarId=13233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=busbey&avatarId=13233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=busbey&avatarId=13233"},"displayName":"Sean Busbey","active":true,"timeZone":"America/Chicago"},"created":"2016-03-04T12:56:15.123+0000","updated":"2016-03-04T12:56:15.123+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15187433","id":"15187433","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=busbey","name":"busbey","key":"busbey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=busbey&avatarId=13233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=busbey&avatarId=13233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=busbey&avatarId=13233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=busbey&avatarId=13233"},"displayName":"Sean Busbey","active":true,"timeZone":"America/Chicago"},"body":"FYI, I've been trying to write a test that reproduces this problem. So far I haven't managed to get anything other than correct results and -1s.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=busbey","name":"busbey","key":"busbey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=busbey&avatarId=13233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=busbey&avatarId=13233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=busbey&avatarId=13233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=busbey&avatarId=13233"},"displayName":"Sean Busbey","active":true,"timeZone":"America/Chicago"},"created":"2016-03-09T17:16:30.288+0000","updated":"2016-03-09T17:16:30.288+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15187773","id":"15187773","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"body":"The documentation for {{InputStream#read}} says:\n\n{{If len is zero, then no bytes are read and 0 is returned; otherwise, there is an attempt to read at least one byte. If no byte is available because the stream is at end of file, the value -1 is returned; otherwise, at least one byte is read and stored into b.}}\n\nIt seems clear that an {{InputStream}} which returns {{0}} when {{len != 0}} is not following the spec.  Of course, we might have such an implementation somewhere in Hadoop, but it would be a bug.  Perhaps we should throw an exception rather than looping, to make users aware of the bug in the wrapped {{InputStream}}.  There is no guarantee that looping is the right thing to do in the case of a buggy {{InputStream}} (say, one which returns 0 on EOF rather than -1).\n\nI don't see how we can have a unit test for this, unless we deliberately mock up a buggy {{InputStream}}.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cmccabe","name":"cmccabe","key":"cmccabe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cmccabe&avatarId=29060","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cmccabe&avatarId=29060","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cmccabe&avatarId=29060","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cmccabe&avatarId=29060"},"displayName":"Colin P. McCabe","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-03-09T19:47:11.963+0000","updated":"2016-03-09T19:47:11.963+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15224980","id":"15224980","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"[~dapengsun] / [~busbey] / [~cmccabe], do you think 2.7.3 (later in the week) should wait for this? Is this any close to getting ready in that time frame? Please let me know either ways, tx.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-04T20:24:13.197+0000","updated":"2016-04-04T20:24:13.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15224983","id":"15224983","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=busbey","name":"busbey","key":"busbey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=busbey&avatarId=13233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=busbey&avatarId=13233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=busbey&avatarId=13233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=busbey&avatarId=13233"},"displayName":"Sean Busbey","active":true,"timeZone":"America/Chicago"},"body":"I don't think it needs to wait.  As Colin mentioned, this is more a symptom than the root problem. Unless we know what the root issue is it's too hard to tell the severity or how long it's been around.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=busbey","name":"busbey","key":"busbey","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=busbey&avatarId=13233","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=busbey&avatarId=13233","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=busbey&avatarId=13233","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=busbey&avatarId=13233"},"displayName":"Sean Busbey","active":true,"timeZone":"America/Chicago"},"created":"2016-04-04T20:25:56.269+0000","updated":"2016-04-04T20:25:56.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12946384/comment/15234168","id":"15234168","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Okay, then I'll drop the target-versions. Once there is a root-cause, please add it back to the appropriate release-trains. Tx.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-04-10T16:07:26.361+0000","updated":"2016-04-10T16:07:26.361+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-12869/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2u2jz:"}}