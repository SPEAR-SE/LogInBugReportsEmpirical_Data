{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12742004","self":"https://issues.apache.org/jira/rest/api/2/issue/12742004","key":"HADOOP-11098","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329058","id":"12329058","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12335733","id":"12335733","description":"3.0.0-alpha1 release","name":"3.0.0-alpha1","archived":false,"released":true,"releaseDate":"2016-09-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2014-09-17T23:09:48.820+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Oct 05 03:17:23 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_33051635753_*|*_5_*:*_1_*:*_0_*|*_10002_*:*_1_*:*_35383092","customfield_12312321":null,"resolutiondate":"2015-10-04T23:18:31.899+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-11098/watchers","watchCount":11,"isWatching":false},"created":"2014-09-17T00:28:13.216+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12325254","id":"12325254","description":"2.3.0 release","name":"2.3.0","archived":false,"released":true,"releaseDate":"2014-02-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12331977","id":"12331977","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[{"id":"12450020","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12450020","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12832093","key":"HDFS-8464","self":"https://issues.apache.org/jira/rest/api/2/issue/12832093","fields":{"summary":"hdfs namenode UI shows \"Max Non Heap Memory\" is -1 B","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12396999","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12396999","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12741205","key":"HADOOP-11090","self":"https://issues.apache.org/jira/rest/api/2/issue/12741205","fields":{"summary":"[Umbrella] Support Java 8 in Hadoop","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}},{"id":"12397044","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12397044","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12628084","key":"HBASE-7608","self":"https://issues.apache.org/jira/rest/api/2/issue/12628084","fields":{"summary":"Considering Java 8","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/5","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/14","id":"14","description":"An overarching type made of sub-tasks","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21130&avatarType=issuetype","name":"Umbrella","subtask":false,"avatarId":21130}}}},{"id":"12489703","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12489703","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"13030178","key":"HDFS-11271","self":"https://issues.apache.org/jira/rest/api/2/issue/13030178","fields":{"summary":"Typo in NameNode UI","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/5","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-12-22T16:45:45.155+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I noticed this because the NameNode UI shows \"Max Non Heap Memory\" which after some digging I found correlates to MaxDirectMemorySize.\n\nJDK7\n{noformat}\nHeap Memory used 16.75 GB of 23 GB Heap Memory. Max Heap Memory is 23.7 GB.\nNon Heap Memory used 57.32 MB of 67.38 MB Commited Non Heap Memory. Max Non Heap Memory is 130 MB. \n{noformat}\n\nJDK8\n{noformat}\nHeap Memory used 3.02 GB of 7.65 GB Heap Memory. Max Heap Memory is 23.7 GB.\nNon Heap Memory used 103.12 MB of 104.41 MB Commited Non Heap Memory. Max Non Heap Memory is -1 B. \n{noformat}\n\nMore information in first comment.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329058","id":"12329058","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12764940","id":"12764940","filename":"after.png","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T13:21:17.935+0000","size":88906,"mimeType":"image/png","content":"https://issues.apache.org/jira/secure/attachment/12764940/after.png"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12764941","id":"12764941","filename":"HADOOP-11098.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T13:28:41.225+0000","size":2851,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12764941/HADOOP-11098.001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"[JDK8] Max Non Heap Memory default changed between JDK7 and 8","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tthompso","name":"tthompso","key":"tthompso","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tthompso&avatarId=21659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tthompso&avatarId=21659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tthompso&avatarId=21659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tthompso&avatarId=21659"},"displayName":"Travis Thompson","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tthompso","name":"tthompso","key":"tthompso","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tthompso&avatarId=21659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tthompso&avatarId=21659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tthompso&avatarId=21659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tthompso&avatarId=21659"},"displayName":"Travis Thompson","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"JDK8","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14136582","id":"14136582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tthompso","name":"tthompso","key":"tthompso","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tthompso&avatarId=21659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tthompso&avatarId=21659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tthompso&avatarId=21659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tthompso&avatarId=21659"},"displayName":"Travis Thompson","active":true,"timeZone":"America/Los_Angeles"},"body":"Knowing the GUI is served from JMX, I looked into JMX and found this:\n{code}\n  {\n  \"beans\" : [ {\n    ...\n    \"MemNonHeapMaxM\" : -9.536743E-7,\n    ...\n  },\n{code}\n\nwhich is getting set here:\n\n{code:title=hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java}\n  private void getMemoryUsage(MetricsRecordBuilder rb) {\n    MemoryUsage memNonHeap = memoryMXBean.getNonHeapMemoryUsage();\n    MemoryUsage memHeap = memoryMXBean.getHeapMemoryUsage();\n    Runtime runtime = Runtime.getRuntime();\n    rb.addGauge(MemNonHeapUsedM, memNonHeap.getUsed() / M)\n      .addGauge(MemNonHeapCommittedM, memNonHeap.getCommitted() / M)\n      .addGauge(MemNonHeapMaxM, memNonHeap.getMax() / M)\n      .addGauge(MemHeapUsedM, memHeap.getUsed() / M)\n      .addGauge(MemHeapCommittedM, memHeap.getCommitted() / M)\n      .addGauge(MemHeapMaxM, memHeap.getMax() / M)\n      .addGauge(MemMaxM, runtime.maxMemory() / M);\n  }\n{code}\n\nAccording to [this | http://docs.oracle.com/javase/8/docs/api/java/lang/management/MemoryUsage.html#getMax--], getMax() returns -1 if the max is unlimited.\n{quote}\npublic long getMax()\nReturns the maximum amount of memory in bytes that can be used for memory management. This method returns -1 if the maximum memory size is undefined.\n{quote}\nAnd according to [this | http://docs.oracle.com/cd/E15289_01/doc.40/e15062/optionxx.htm#BABGCFFB], you set the non-heap max with {{-XX:MaxDirectMemorySize}}, but it claims it's unlimited by default.\n{quote}\nDefault Value\nThe default value is zero, which means the maximum direct memory is unbounded.\n{quote}\nThis is obviously the case in JDK8, but I haven't been able to find any references to the default changing between JDK7 and JDK8 yet.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tthompso","name":"tthompso","key":"tthompso","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tthompso&avatarId=21659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tthompso&avatarId=21659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tthompso&avatarId=21659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tthompso&avatarId=21659"},"displayName":"Travis Thompson","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-17T00:39:56.830+0000","updated":"2014-09-17T00:39:56.830+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14138172","id":"14138172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"bq. And according to this , you set the non-heap max with -XX:MaxDirectMemorySize, but it claims it's unlimited by default.\n\nAccording to the link, MaxDirectMemorySize sets the NIO buffer size. I wouldn't expect that to be the same thing as the non-heap max. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2014-09-17T23:09:48.820+0000","updated":"2014-09-17T23:09:48.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14138283","id":"14138283","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tthompso","name":"tthompso","key":"tthompso","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tthompso&avatarId=21659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tthompso&avatarId=21659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tthompso&avatarId=21659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tthompso&avatarId=21659"},"displayName":"Travis Thompson","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. According to the link, MaxDirectMemorySize sets the NIO buffer size. I wouldn't expect that to be the same thing as the non-heap max.\n\nYeah after reading more it looks like that's definitely the case, I don't remember what I initially read that lead me to believe that, it's been a while since I actually looked at this (this ticket is a copy of an internal ticket).\n\nIt looks like this is probably related to \"PermGen\" going away and now having \"Metaspace\", which is part of the heap now where PermGen was not (more [here | http://javaeesupportpatterns.blogspot.com/2013/02/java-8-from-permgen-to-metaspace.html]).  Anyways, I haven't actually found a way to cap non-heap yet and I'm not sure it's actually even necessary anymore?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tthompso","name":"tthompso","key":"tthompso","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tthompso&avatarId=21659","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tthompso&avatarId=21659","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tthompso&avatarId=21659","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tthompso&avatarId=21659"},"displayName":"Travis Thompson","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-09-18T00:40:14.823+0000","updated":"2014-09-18T00:40:14.823+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14768986","id":"14768986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"The problem can be easily reproduced by running the following code in Java 7 and Java 8 respectively.\n{code}\n  public static void main(String[] args) {\n    final String p = \"java.version\";\n    System.out.println(p + \" = \" + System.getProperty(p));\n        \n    MemoryMXBean b = ManagementFactory.getMemoryMXBean();\n    MemoryUsage memNonHeap = b.getNonHeapMemoryUsage();\n    System.out.println(\"max = \" + memNonHeap.getMax());\n  }\n{code}\n- java 7\n{code}\njava.version = 1.7.0_60\nmax = 136314880\n{code}\n- java 8\n{code}\njava.version = 1.8.0_60\nmax = -1\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-16T14:09:11.643+0000","updated":"2015-09-16T14:09:11.643+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14791376","id":"14791376","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"It looks like that this problem is closely related to the new Java 8 Metaspace.  By default the metaspace, which is a part of the non-heap memory, is unbounded.  As a result, the non-heap memory is unbounded, i.e. memNonHeap.getMax() returns -1 in the code above.  If we set a limit to the MaxMetaspaceSize, the non-heap memory becomes bounded; see output below\n\n- java 8  with -XX:MaxMetaspaceSize=128M\n{code}\njava.version = 1.8.0_60\nmax = 1459617792\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-17T00:49:29.908+0000","updated":"2015-09-17T00:49:29.908+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14940407","id":"14940407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"[~szetszwo] thank you for taking a look at this issue. How about treating \"-1\" as a special value in the case on JDK8?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-01T21:02:19.136+0000","updated":"2015-10-01T21:02:19.136+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14940654","id":"14940654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"Sound good.  Let's show <unbounded> in the NameNode UI.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-02T00:51:09.623+0000","updated":"2015-10-02T00:51:09.623+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14941015","id":"14941015","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajisakaa","name":"ajisakaa","key":"ajisakaa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ajisakaa&avatarId=17238","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ajisakaa&avatarId=17238","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ajisakaa&avatarId=17238","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ajisakaa&avatarId=17238"},"displayName":"Akira Ajisaka","active":true,"timeZone":"Asia/Tokyo"},"body":"bq. Let's show <unbounded> in the NameNode UI.\nSounds good for NameNode UI. By the way, how about JvmMetrics?\n{code}\n.addGauge(MemNonHeapMaxM, memNonHeap.getMax() / M)\n{code}\nIf memNonHeap.getMax() is -1, can we set some other value such as 0 or remove the metric instead of displaying -9.536743E-7?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajisakaa","name":"ajisakaa","key":"ajisakaa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ajisakaa&avatarId=17238","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ajisakaa&avatarId=17238","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ajisakaa&avatarId=17238","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ajisakaa&avatarId=17238"},"displayName":"Akira Ajisaka","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-10-02T11:02:56.666+0000","updated":"2015-10-02T11:02:56.666+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14941224","id":"14941224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ajisakaa] good point. Zero or LONG_MAX looks fine to me. Let me implement this feature.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-02T14:54:44.602+0000","updated":"2015-10-02T14:54:44.602+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14941234","id":"14941234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"I think LONG_MAX is more precise expression in the JVM's case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-02T15:08:46.213+0000","updated":"2015-10-02T15:08:46.213+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14941261","id":"14941261","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"Either LONG_MAX or -1 is fine.  Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-02T15:25:34.645+0000","updated":"2015-10-02T15:25:34.645+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14941277","id":"14941277","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"On a second thought, Long.MAX_VALUE = 9223372036854775807 has too many digits.  It may lead to a display problem.  Also, other applications cannot easily tell whether it means unbounded or it is a valid setting.  They cannot show it as <unbounded> in their UI. So -1 may be better.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-02T15:41:36.291+0000","updated":"2015-10-02T15:41:36.291+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14941412","id":"14941412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajisakaa","name":"ajisakaa","key":"ajisakaa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ajisakaa&avatarId=17238","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ajisakaa&avatarId=17238","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ajisakaa&avatarId=17238","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ajisakaa&avatarId=17238"},"displayName":"Akira Ajisaka","active":true,"timeZone":"Asia/Tokyo"},"body":"bq. So -1 may be better.\n+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajisakaa","name":"ajisakaa","key":"ajisakaa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ajisakaa&avatarId=17238","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ajisakaa&avatarId=17238","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ajisakaa&avatarId=17238","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ajisakaa&avatarId=17238"},"displayName":"Akira Ajisaka","active":true,"timeZone":"Asia/Tokyo"},"created":"2015-10-02T17:08:28.146+0000","updated":"2015-10-02T17:08:28.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942664","id":"14942664","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"Attaching a screenshot after fixing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T13:21:17.939+0000","updated":"2015-10-04T13:21:17.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942666","id":"14942666","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"Attaching a patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T13:28:41.237+0000","updated":"2015-10-04T13:28:41.237+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942675","id":"14942675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 patch looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T14:09:32.838+0000","updated":"2015-10-04T14:09:32.838+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942740","id":"14942740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"\\\\\n\\\\\n| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | pre-patch |  19m 19s | Pre-patch trunk compilation is healthy. |\n| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |\n| {color:red}-1{color} | tests included |   0m  0s | The patch doesn't appear to include any new or modified tests.  Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. |\n| {color:green}+1{color} | javac |   7m 44s | There were no new javac warning messages. |\n| {color:green}+1{color} | javadoc |  10m  7s | There were no new javadoc warning messages. |\n| {color:red}-1{color} | release audit |   0m 15s | The applied patch generated 1 release audit warnings. |\n| {color:red}-1{color} | checkstyle |   1m 44s | The applied patch generated  5 new checkstyle issues (total was 19, now 24). |\n| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |\n| {color:green}+1{color} | install |   1m 28s | mvn install still works. |\n| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |\n| {color:green}+1{color} | findbugs |   4m 17s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |\n| {color:red}-1{color} | common tests |   7m 31s | Tests failed in hadoop-common. |\n| {color:red}-1{color} | hdfs tests | 200m 11s | Tests failed in hadoop-hdfs. |\n| | | 253m 52s | |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed unit tests | hadoop.metrics2.impl.TestGangliaMetrics |\n|   | hadoop.hdfs.web.TestWebHdfsContentLength |\n|   | hadoop.hdfs.web.TestWebHDFSOAuth2 |\n|   | hadoop.hdfs.security.TestDelegationTokenForProxyUser |\n|   | hadoop.hdfs.TestCrcCorruption |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Patch URL | http://issues.apache.org/jira/secure/attachment/12764941/HADOOP-11098.001.patch |\n| Optional Tests | javadoc javac unit findbugs checkstyle |\n| git revision | trunk / 3b85bd7 |\n| Release Audit | https://builds.apache.org/job/PreCommit-HADOOP-Build/7765/artifact/patchprocess/patchReleaseAuditProblems.txt |\n| checkstyle |  https://builds.apache.org/job/PreCommit-HADOOP-Build/7765/artifact/patchprocess/diffcheckstylehadoop-common.txt |\n| hadoop-common test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/7765/artifact/patchprocess/testrun_hadoop-common.txt |\n| hadoop-hdfs test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/7765/artifact/patchprocess/testrun_hadoop-hdfs.txt |\n| Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/7765/testReport/ |\n| Java | 1.7.0_55 |\n| uname | Linux asf906.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/7765/console |\n\n\nThis message was automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-04T17:52:46.478+0000","updated":"2015-10-04T17:52:46.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942850","id":"14942850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"All tests are not related to the patch.\n\nFollowing tests are fails without patch - created HDFS-9195 and HDFS-9196 for addressing the problem:\n{quote}\n  TestDelegationTokenForProxyUser.testWebHdfsDoAs:163 expected:<...ocalhost:44528/user/[Proxy]User> but was:<...ocalhost:44528/user/[Real]User>\n  TestWebHdfsContentLength.testPutOp:116 expected:<0> but was:<null>\n  TestWebHdfsContentLength.testPutOpWithRedirect:130 expected:<[chunked]> but was:<[0]>\n{quote}\n\nThe failures of TestCrcCorruption and TestGangliaMetrics are occasional one - ran all tests locally and confirmed that they passes. \n\nThanks for the review, committing this shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T23:09:49.190+0000","updated":"2015-10-04T23:09:49.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942856","id":"14942856","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"body":"Committed this to trunk and branch-2. Thanks [~szetszwo] for your review, [~ajisakaa] and [~aw] for your comment,  and [~tthompso] for your report.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ozawa","name":"ozawa","key":"ozawa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ozawa&avatarId=21740","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ozawa&avatarId=21740","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ozawa&avatarId=21740","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ozawa&avatarId=21740"},"displayName":"Tsuyoshi Ozawa","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-10-04T23:18:31.971+0000","updated":"2015-10-04T23:18:31.971+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942859","id":"14942859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-trunk-Commit #8565 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/8565/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n* hadoop-common-project/hadoop-common/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-04T23:23:34.275+0000","updated":"2015-10-04T23:23:34.275+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942877","id":"14942877","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Hadoop-Yarn-trunk-Java8 #486 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/486/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n* hadoop-common-project/hadoop-common/CHANGES.txt\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-05T01:17:13.638+0000","updated":"2015-10-05T01:17:13.638+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942879","id":"14942879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Yarn-trunk #1217 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/1217/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n* hadoop-common-project/hadoop-common/CHANGES.txt\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-05T01:25:17.431+0000","updated":"2015-10-05T01:25:17.431+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942884","id":"14942884","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk #2422 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2422/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-common-project/hadoop-common/CHANGES.txt\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-05T01:55:26.014+0000","updated":"2015-10-05T01:55:26.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942887","id":"14942887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #478 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/478/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n* hadoop-common-project/hadoop-common/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-05T02:18:52.558+0000","updated":"2015-10-05T02:18:52.558+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942893","id":"14942893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk #2393 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2393/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n* hadoop-common-project/hadoop-common/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-05T03:12:29.055+0000","updated":"2015-10-05T03:12:29.055+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12742004/comment/14942894","id":"14942894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #453 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/453/])\nHADOOP-11098. [JDK8] Max Non Heap Memory default changed between JDK7 (ozawa: rev 30e2f836a26490a24c7ddea754dd19f95b24bbc8)\n* hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/dfshealth.html\n* hadoop-common-project/hadoop-common/CHANGES.txt\n* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/metrics2/source/JvmMetrics.java\n* hadoop-hdfs-project/hadoop-hdfs/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-10-05T03:17:23.995+0000","updated":"2015-10-05T03:17:23.995+0000"}],"maxResults":26,"total":26,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-11098/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i204v3:"}}