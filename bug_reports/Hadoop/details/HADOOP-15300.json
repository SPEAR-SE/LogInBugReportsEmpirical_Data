{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13143667","self":"https://issues.apache.org/jira/rest/api/2/issue/13143667","key":"HADOOP-15300","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Mar 08 20:02:42 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15300/watchers","watchCount":1,"isWatching":false},"created":"2018-03-08T19:59:48.054+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12341432","id":"12341432","description":"3.1.0 release","name":"3.1.0","archived":false,"released":true,"releaseDate":"2018-04-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-03-08T20:02:42.817+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12331123","id":"12331123","name":"fs/adl"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12328416","id":"12328416","name":"fs/azure","description":"Azure WASB filesystem client"}],"timeoriginalestimate":null,"description":"If you use {{distcp -update}} to an adl or wasb store, repeatedly, all the source files are copied up every time. In contrast, if you use hdfs:// or s3a:// as a destination, only the new ones are uploaded. hdfs uses checksums for a diff, but s3a is just returning file length and relying on distcp logic being \"if either src or dest doesn't do checksums, only compare file len\"\r\n\r\nsomehow that's not kicking in. Tested for file:  and hdfs sources, wasb and adl dests","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"distcp -update to WASB and ADL copies up all the files, always","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143667/comment/16391851","id":"16391851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"distcp to s3a\r\n\r\n{code}\r\n2018-03-08 15:09:17,385 [main] INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1658)) - Job job_local1068976850_0001 completed successfully\r\n2018-03-08 15:09:17,394 [main] INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1665)) - Counters: 25\r\n\tFile System Counters\r\n\t\tFILE: Number of bytes read=1622306\r\n\t\tFILE: Number of bytes written=1634552\r\n\t\tFILE: Number of read operations=0\r\n\t\tFILE: Number of large read operations=0\r\n\t\tFILE: Number of write operations=0\r\n\t\tS3A: Number of bytes read=0\r\n\t\tS3A: Number of bytes written=897647\r\n\t\tS3A: Number of read operations=1688\r\n\t\tS3A: Number of large read operations=0\r\n\t\tS3A: Number of write operations=902\r\n\tMap-Reduce Framework\r\n\t\tMap input records=96\r\n\t\tMap output records=0\r\n\t\tInput split bytes=306\r\n\t\tSpilled Records=0\r\n\t\tFailed Shuffles=0\r\n\t\tMerged Map outputs=0\r\n\t\tGC time elapsed (ms)=63\r\n\t\tTotal committed heap usage (bytes)=752877568\r\n\tFile Input Format Counters \r\n\t\tBytes Read=34752\r\n\tFile Output Format Counters \r\n\t\tBytes Written=16\r\n\tDistCp Counters\r\n\t\tBandwidth in Btyes=32392\r\n\t\tBytes Copied=461862\r\n\t\tBytes Expected=461862\r\n\t\tFiles Copied=69\r\n\t\tDIR_COPY=27\r\n{code}\r\n\r\nsecond\r\n{code}\r\n018-03-08 15:10:07,937 [main] INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1658)) - Job job_local864019435_0001 completed successfully\r\n2018-03-08 15:10:07,944 [main] INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1665)) - Counters: 24\r\n\tFile System Counters\r\n\t\tFILE: Number of bytes read=724653\r\n\t\tFILE: Number of bytes written=1651348\r\n\t\tFILE: Number of read operations=0\r\n\t\tFILE: Number of large read operations=0\r\n\t\tFILE: Number of write operations=0\r\n\t\tS3A: Number of bytes read=0\r\n\t\tS3A: Number of bytes written=0\r\n\t\tS3A: Number of read operations=389\r\n\t\tS3A: Number of large read operations=0\r\n\t\tS3A: Number of write operations=0\r\n\tMap-Reduce Framework\r\n\t\tMap input records=96\r\n\t\tMap output records=69\r\n\t\tInput split bytes=304\r\n\t\tSpilled Records=0\r\n\t\tFailed Shuffles=0\r\n\t\tMerged Map outputs=0\r\n\t\tGC time elapsed (ms)=6\r\n\t\tTotal committed heap usage (bytes)=529530880\r\n\tFile Input Format Counters \r\n\t\tBytes Read=34752\r\n\tFile Output Format Counters \r\n\t\tBytes Written=11169\r\n\tDistCp Counters\r\n\t\tBandwidth in Btyes=0\r\n\t\tBytes Skipped=461862\r\n\t\tDIR_COPY=27\r\n\t\tFiles Skipped=69\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2018-03-08T20:01:07.433+0000","updated":"2018-03-08T20:01:07.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13143667/comment/16391853","id":"16391853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"wasb updates every time. As does adl\r\n{code:java}\r\n\tFile System Counters\r\n\t\tFILE: Number of bytes read=1640418\r\n\t\tFILE: Number of bytes written=1636188\r\n\t\tFILE: Number of read operations=0\r\n\t\tFILE: Number of large read operations=0\r\n\t\tFILE: Number of write operations=0\r\n\t\tWASB: Number of bytes read=0\r\n\t\tWASB: Number of bytes written=915753\r\n\t\tWASB: Number of read operations=0\r\n\t\tWASB: Number of large read operations=0\r\n\t\tWASB: Number of write operations=0\r\n\tMap-Reduce Framework\r\n\t\tMap input records=96\r\n\t\tMap output records=0\r\n\t\tInput split bytes=308\r\n\t\tSpilled Records=0\r\n\t\tFailed Shuffles=0\r\n\t\tMerged Map outputs=0\r\n\t\tGC time elapsed (ms)=16\r\n\t\tTotal committed heap usage (bytes)=408944640\r\n\tFile Input Format Counters \r\n\t\tBytes Read=34752\r\n\tFile Output Format Counters \r\n\t\tBytes Written=16\r\n\tDistCp Counters\r\n\t\tBandwidth in Btyes=12212\r\n\t\tBytes Copied=461862\r\n\t\tBytes Expected=461862\r\n\t\tFiles Copied=69\r\n\t\tDIR_COPY=27\r\n      118.98 real        13.33 user         1.83 sys\r\n{code}\r\nUpdated\r\n{code:java}\r\n2018-03-08 15:21:44,045 [main] INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1665)) - Counters: 25\r\n\tFile System Counters\r\n\t\tFILE: Number of bytes read=1635633\r\n\t\tFILE: Number of bytes written=1630856\r\n\t\tFILE: Number of read operations=0\r\n\t\tFILE: Number of large read operations=0\r\n\t\tFILE: Number of write operations=0\r\n\t\tWASB: Number of bytes read=0\r\n\t\tWASB: Number of bytes written=910462\r\n\t\tWASB: Number of read operations=0\r\n\t\tWASB: Number of large read operations=0\r\n\t\tWASB: Number of write operations=0\r\n\tMap-Reduce Framework\r\n\t\tMap input records=96\r\n\t\tMap output records=0\r\n\t\tInput split bytes=306\r\n\t\tSpilled Records=0\r\n\t\tFailed Shuffles=0\r\n\t\tMerged Map outputs=0\r\n\t\tGC time elapsed (ms)=18\r\n\t\tTotal committed heap usage (bytes)=457179136\r\n\tFile Input Format Counters \r\n\t\tBytes Read=35264\r\n\tFile Output Format Counters \r\n\t\tBytes Written=16\r\n\tDistCp Counters\r\n\t\tBandwidth in Btyes=10566\r\n\t\tBytes Copied=461862\r\n\t\tBytes Expected=461862\r\n\t\tFiles Copied=69\r\n\t\tDIR_COPY=27\r\n      129.40 real        14.55 user         2.08 sys\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2018-03-08T20:02:42.817+0000","updated":"2018-03-08T20:02:42.817+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15300/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3r2c7:"}}