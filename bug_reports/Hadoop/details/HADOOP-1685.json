{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12375437","self":"https://issues.apache.org/jira/rest/api/2/issue/12375437","key":"HADOOP-1685","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312565","id":"12312565","description":"","name":"0.15.0","archived":false,"released":true,"releaseDate":"2007-10-19"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2007-08-09T06:03:57.946+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Aug 09 06:03:57 UTC 2007","customfield_12310420":"125359","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_214860392_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_733200967","customfield_12312321":null,"resolutiondate":"2007-08-09T06:03:57.981+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-1685/watchers","watchCount":0,"isWatching":false},"created":"2007-08-06T18:22:57.589+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312579","id":"12312579","description":"","name":"0.13.1","archived":false,"released":true,"releaseDate":"2007-07-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:52:24.188+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The following error occurs many times on a job where I have defined the number of reduce tasks to be less than the default number of reduce tasks defined in my hadoop-site.xml.    Working off my novice understanding of hadoop infrastructure at this point, it appears that the jobTracker is not honoring the mapred.reduce.tasks as defined in the job-conf, and instead is using the default.\n\nMap output lost, rescheduling: getMapOutput(task_0010_m_000002_0,6) failed :\njava.io.EOFException\n\tat java.io.DataInputStream.readFully(DataInputStream.java:180)\n\tat java.io.DataInputStream.readLong(DataInputStream.java:399)\n\tat org.apache.hadoop.mapred.TaskTracker$MapOutputServlet.doGet(TaskTracker.java:1911)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:747)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:860)\n\tat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:427)\n\tat org.mortbay.jetty.servlet.WebApplicationHandler.dispatch(WebApplicationHandler.java:475)\n\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:567)\n\tat org.mortbay.http.HttpContext.handle(HttpContext.java:1565)\n\tat org.mortbay.jetty.servlet.WebApplicationContext.handle(WebApplicationContext.java:635)\n\tat org.mortbay.http.HttpContext.handle(HttpContext.java:1517)\n\tat org.mortbay.http.HttpServer.service(HttpServer.java:954)\n\tat org.mortbay.http.HttpConnection.service(HttpConnection.java:814)\n\tat org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:981)\n\tat org.mortbay.http.HttpConnection.handle(HttpConnection.java:831)\n\tat org.mortbay.http.SocketListener.handleConnection(SocketListener.java:244)\n\tat org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:357)\n\tat org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:534)\n\nie.  \nhadoop-site.xml defines mapred.reduce.tasks=7,\nIn my job I define mapred.reduce.tasks=3\n\nI get many errors looking for:\ngetMapOutput(task_0010_m_000002_0,3)\ngetMapOutput(task_0010_m_000002_0,4)\ngetMapOutput(task_0010_m_000002_0,5)\ngetMapOutput(task_0010_m_000002_0,6)\n\nThis additional error appears to be a side-effect of the actual problem (it stopped happening when I change the job-conf to match default number of reduce tasks):\ntask_0010_m_000016_0: log4j:ERROR Failed to close the task's log with the exception: java.io.IOException: Bad file descriptor\ntask_0010_m_000016_0:   at java.io.FileOutputStream.writeBytes(Native Method)\ntask_0010_m_000016_0:   at java.io.FileOutputStream.write(FileOutputStream.java:260)\ntask_0010_m_000016_0:   at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\ntask_0010_m_000016_0:   at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\ntask_0010_m_000016_0:   at org.apache.hadoop.mapred.TaskLog$Writer.writeIndexRecord(TaskLog.java:251)\ntask_0010_m_000016_0:   at org.apache.hadoop.mapred.TaskLog$Writer.close(TaskLog.java:235)\ntask_0010_m_000016_0:   at org.apache.hadoop.mapred.TaskLogAppender.close(TaskLogAppender.java:67)\ntask_0010_m_000016_0:   at org.apache.log4j.AppenderSkeleton.finalize(AppenderSkeleton.java:124)\ntask_0010_m_000016_0:   at java.lang.ref.Finalizer.invokeFinalizeMethod(Native Method)\ntask_0010_m_000016_0:   at java.lang.ref.Finalizer.runFinalizer(Finalizer.java:83)\ntask_0010_m_000016_0:   at java.lang.ref.Finalizer.access$100(Finalizer.java:14)\ntask_0010_m_000016_0:   at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:160)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"106089","customfield_12312823":null,"summary":"Possible getMapOutput() failures on tasktracker when mapred.reduce.tasks is overriden in job","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jorgenj","name":"jorgenj","key":"jorgenj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jorgen Johnson","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jorgenj","name":"jorgenj","key":"jorgenj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jorgen Johnson","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"6 node cluster, all running on Redhat Enterprise 3.0 Standard Server (Update 4), running on java6, 2 nodes are xen virts","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375437/comment/12518621","id":"12518621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"body":"This is caused by misunderstanding of the config system in a way that should be fixed by HADOOP-785. In particular, hadoop-site.xml does NOT set defaults. The values in it are forced onto the client. So by forcing the number of reduces on some of the machines, but not others, you got bad results. Basically, the number of reduces is a client value that is being overridden by the server's configuration file.\n\nThat said, a lot of us are looking forward to a lot less confusion once HADOOP-785 is done. The current situation is very confusing with lots of strange corner cases. \n\nThe proper place to define the default number of maps and reduces is in mapred-defaults.xml.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-09T06:03:57.946+0000","updated":"2007-08-09T06:03:57.946+0000"}],"maxResults":1,"total":1,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-1685/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0iihj:"}}