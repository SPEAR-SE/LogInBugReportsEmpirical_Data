{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12379890","self":"https://issues.apache.org/jira/rest/api/2/issue/12379890","key":"HADOOP-2009","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2007-10-09T04:37:01.528+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 03 15:03:02 UTC 2011","customfield_12310420":"34270","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_121211714778_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-08-11T18:48:00.989+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-2009/watchers","watchCount":3,"isWatching":false},"created":"2007-10-08T20:52:46.266+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312579","id":"12312579","description":"","name":"0.13.1","archived":false,"released":true,"releaseDate":"2007-07-26"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-11-03T15:03:02.774+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311543","id":"12311543","name":"build","description":"Build scripts"}],"timeoriginalestimate":null,"description":"Looks like this was already reported (but not resolved on the the list): http://tinyurl.com/2rwu6x\n\nI would like to compile libhadoop on amd64/Fedora and everything seems kosher until I hit this compile error:\n\n     [exec] /home/jssarma/fbprojects/hadoop-0.13.1/src/native/src/org/apache/hadoop/io/compress/lzo/LzoCompressor.c:116: error: syntax error before ',' token\n\nthe line in question is:\n\n    // Load liblzo2.so                                                                                    \n    liblzo2 = dlopen(HADOOP_LZO_LIBRARY, RTLD_LAZY | RTLD_GLOBAL);\n\nseems like this is being set by:\n\nconfigure:#define HADOOP_LZO_LIBRARY ${ac_cv_libname_lzo2}\n\nI tried executing the relevant part of configure by hand:\n\n  if test -z \"`${CC} -o conftest conftest.c -llzo2 2>&1`\"; then\n        if test ! -z \"`which objdump`\"; then\n      ac_cv_libname_lzo2=\"`objdump -p conftest | grep NEEDED | grep lzo2 | sed 's/\\W*NEEDED\\W*\\(.*\\)\\W*$/\\\n\\\"\\1\\\"/'`\"\n\nThis is not working on my system, since:\n> objdump -p conftest | grep NEEDED                         \n  NEEDED      libc.so.6\n\nSo that would explain the compile error. Editing the configure script manually for now works.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"105902","customfield_12312823":null,"summary":"configure script for compiling hadoop native doesn't set lzo lib name correctly","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Fedora, amd64","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533260","id":"12533260","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"body":"Joydeep,\n\nI don't have access to an amd64-fedora box, could you please try this and let me know?\n\n{noformat}\n$ echo 'int main(int argc, char **argv){return 0;}' > conftest.c\n$ gcc -o conftest conftest.c -llzo2\n$ objdump -p conftest | grep NEEDED\n{noformat}\n\non my system I get:\n{noformat}\n$ objdump -p conftest | grep NEEDED\n  NEEDED      liblzo2.so.2\n  NEEDED      libc.so.6\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-09T04:37:01.528+0000","updated":"2007-10-09T04:37:01.528+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533433","id":"12533433","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"body":"as i reported - i have already tried this out (retried just in case). On my platform - i only see libc.so.6 as the required library. \n\nI am wondering if it is because i don't have .so versions of lz libraries - only .a:\n[jssarma@dev046 if]$ ls -l /usr/local/lib/*lzo2*\n-rw-r--r--  1 root root 847206 Feb 28  2007 /usr/local/lib/liblzo2.a\n-rwxr-xr-x  1 root root    752 Feb 28  2007 /usr/local/lib/liblzo2.la\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"created":"2007-10-09T17:51:14.464+0000","updated":"2007-10-09T17:51:14.464+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533442","id":"12533442","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"body":"Yes, that is weird. The rpm which got you lzo2 shud come with both dynamic and static versions of lzo... could you check and maybe reinstall lzo? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-09T18:22:58.553+0000","updated":"2007-10-09T18:22:58.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533446","id":"12533446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"body":"As I mentioned - i already have a workaround - i edited configure to hard code the library path.\n\nI don't know how lzo was installed - the system was imaged by IT folks and it is the way it is. The issue is how to help the next person who hits this error. Clearly, if grep NEEDED returns empty - there's  an error - and either the script/build needs to stop. Perhaps you might want to just print out an error from configure and ask them to change the script. or get it off a environment variable. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"created":"2007-10-09T18:33:22.917+0000","updated":"2007-10-09T18:33:22.917+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533459","id":"12533459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"body":"The idea of using gnu's auto* toolset is to not rely on hard-coded paths since they are system/distribution specific.\n\nSo, well, any information you provide does help in solving the problem for the next user. Clearly it is easier to fix if you could confirm that the compile went through with liblzo2.so being present on your system, else there might be other doors to knock-on. \n\nBtw, could you also attach the output of the entire compilation process i.e. the parts where configure checks for zlib/lzo headers and so on?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-09T19:07:09.529+0000","updated":"2007-10-09T19:07:09.529+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533463","id":"12533463","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"body":"here's the log. i think that the error should be detected in configure and auto-configuration should either fail outright or print a loud warning that compilation of native libs will not work unless some steps are taken. It might take me some more time to test with .so\n\n     [exec] if /bin/sh ../../../../../../../libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I.\\\n -I/home/jssarma/fbprojects/hadoop-0.13.1/src/native/src/org/apache/hadoop/io/compress/lzo -I../../\\\n../../../../..  -I/usr/local/java/include -I/usr/local/java/include/linux -I/home/jssarma/fbproject\\\ns/hadoop-0.13.1/src/native/src  -g -Wall -fPIC -O2 -m64 -g -O2 -MT LzoCompressor.lo -MD -MP -MF \".d\\\neps/LzoCompressor.Tpo\" -c -o LzoCompressor.lo /home/jssarma/fbprojects/hadoop-0.13.1/src/native/src\\\n/org/apache/hadoop/io/compress/lzo/LzoCompressor.c; \\\n     [exec] then mv -f \".deps/LzoCompressor.Tpo\" \".deps/LzoCompressor.Plo\"; else rm -f \".deps/LzoCo\\\nmpressor.Tpo\"; exit 1; fi\n     [exec]  gcc -DHAVE_CONFIG_H -I. -I/home/jssarma/fbprojects/hadoop-0.13.1/src/native/src/org/ap\\\nache/hadoop/io/compress/lzo -I../../../../../../.. -I/usr/local/java/include -I/usr/local/java/incl\\\nude/linux -I/home/jssarma/fbprojects/hadoop-0.13.1/src/native/src -g -Wall -fPIC -O2 -m64 -g -O2 -M\\\nT LzoCompressor.lo -MD -MP -MF .deps/LzoCompressor.Tpo -c /home/jssarma/fbprojects/hadoop-0.13.1/sr\\\nc/native/src/org/apache/hadoop/io/compress/lzo/LzoCompressor.c  -fPIC -DPIC -o .libs/LzoCompressor.\\\no\n     [exec] /home/jssarma/fbprojects/hadoop-0.13.1/src/native/src/org/apache/hadoop/io/compress/lzo\\\n/LzoCompressor.c: In function 'Java_org_apache_hadoop_io_compress_lzo_LzoCompressor_initIDs':\n     [exec] /home/jssarma/fbprojects/hadoop-0.13.1/src/native/src/org/apache/hadoop/io/compress/lzo\\\n/LzoCompressor.c:116: error: syntax error before '/' token\n     [exec] make[2]: Leaving directory `/home/jssarma/fbprojects/hadoop-0.13.1/build/native/Linux-a\\\nmd64-64/src/org/apache/hadoop/io/compress/lzo'\n     [exec] make[2]: *** [LzoCompressor.lo] Error 1\n     [exec] make[1]: Leaving directory `/home/jssarma/fbprojects/hadoop-0.13.1/build/native/Linux-a\\\nmd64-64'\n     [exec] make[1]: *** [all-recursive] Error 1\n     [exec] make: *** [all] Error 2\n\nBUILD FAILED\n/home/jssarma/fbprojects/hadoop-0.13.1/build.xml:285: exec returned: 2\n        at org.apache.tools.ant.taskdefs.ExecTask.runExecute(ExecTask.java:591)\n        at org.apache.tools.ant.taskdefs.ExecTask.runExec(ExecTask.java:617)\n        at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:452)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"created":"2007-10-09T19:29:46.832+0000","updated":"2007-10-09T19:29:46.832+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12533465","id":"12533465","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"body":"sorry - u were probably looking for this:\n\nchecking for lzo/lzo1.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'...\nchecking lzo/lzo1a.h usability... yes\nchecking lzo/lzo1a.h presence... yes\nchecking for lzo/lzo1a.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo1b.h usability... yes\nchecking lzo/lzo1b.h presence... yes\nchecking for lzo/lzo1b.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo1c.h usability... yes\nchecking lzo/lzo1c.h presence... yes\nchecking for lzo/lzo1c.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo1f.h usability... yes\nchecking lzo/lzo1f.h presence... yes\nchecking for lzo/lzo1f.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo1x.h usability... yes\nchecking lzo/lzo1x.h presence... yes\nchecking for lzo/lzo1x.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo1y.h usability... yes\nchecking lzo/lzo1y.h presence... yes\nchecking for lzo/lzo1y.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo1z.h usability... yes\nchecking lzo/lzo1z.h presence... yes\nchecking for lzo/lzo1z.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo2a.h usability... yes\nchecking lzo/lzo2a.h presence... yes\nchecking for lzo/lzo2a.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking lzo/lzo_asm.h usability... yes\nchecking lzo/lzo_asm.h presence... yes\nchecking for lzo/lzo_asm.h... yes\nchecking Checking for the 'actual' dynamic-library for '-llzo2'... (cached)\nchecking for an ANSI C-conforming const... yes\nchecking for memset... yes\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jsensarma","name":"jsensarma","key":"jsensarma","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Joydeep Sen Sarma","active":true,"timeZone":"Asia/Kolkata"},"created":"2007-10-09T19:33:12.183+0000","updated":"2007-10-09T19:33:12.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/12679049","id":"12679049","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"body":"I have a similar problem using FreeBSD 7.1.\n\nac_cv_libname_$1=\"`objdump -p conftest | grep NEEDED | grep $1 | sed 's/\\W*NEEDED\\W*\\(.*\\)\\W*$/\\\"\\1\\\"/'`\"\n\nA sample objdump output line is:\n  NEEDED      libc.so.7\nthe sed regex resolves this to:\n\"      libc.so.7\"\nwith four extra spaces in front of the lib name. This causes the lib to fail loading.\nManually changing the config.h works but I don't know how to fix this regex.\n\nTo find this out I changed the following line in ZLibCompressor (and the other files):\n\t\tTHROW(env, \"java/lang/UnsatisfiedLinkError\", \"Cannot load libz.so\");\nto\n\t\tTHROW(env, \"java/lang/UnsatisfiedLinkError\", dlerror());\nand changed ZlibCompressor.java to include a LOG and actually output the exception message thrown in the native code. As it is now the message is simply discarded and the only message that is shown is \"Failed to load/initialize native-zlib library\". Not very helpful :)\n\nI'm not sure if I should open a new issue for this last part but I believe it would be a sensible default behaviour.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lars_francke","name":"lars_francke","key":"lars_francke","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"},"displayName":"Lars Francke","active":true,"timeZone":"Europe/Berlin"},"created":"2009-03-05T03:05:12.923+0000","updated":"2009-03-05T03:05:12.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/13083373","id":"13083373","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"LZO was removed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-08-11T18:48:01.024+0000","updated":"2011-08-11T18:48:01.024+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12379890/comment/13143228","id":"13143228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=miguno","name":"miguno","key":"miguno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=miguno&avatarId=26959","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=miguno&avatarId=26959","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=miguno&avatarId=26959","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=miguno&avatarId=26959"},"displayName":"Michael Noll","active":true,"timeZone":"Europe/Amsterdam"},"body":"FYI: The reason might be a problem with ld and how it is configured to work by default.  We have run into basically the exact same error when trying to build the hadoop-lzo libraries from [1].\n\nI described the problem (for hadoop-lzo) in length here:\nhttps://github.com/kevinweil/hadoop-lzo/issues/33\n\nIn a nutshell, the problem is that some systems run ld with a default setting of {{\"\\--as-needed\"}} whereas others have {{\"\\--no-as-needed\"}}.  The build will only work if you run ld with the latter, i.e. {{\"\\--no-as-needed\"}}.  We run into this error when we tried to build hadoop-lzo on Ubuntu 11.10, which is the first Ubuntu version where the default behavior of ld has been changed to {{\\--as-needed}}.\n\nNow the reason why this has an effect is the way that the Hadoop LZO library is being searched for in {{src/native/configure}}.  It is using a dummy C script and compiles it by running gcc with \"-llzo2\":\n\n{code}\n// from src/native/configure:\necho 'int main(int argc, char **argv){return 0;}' > conftest.c\n{code}\n\nHowever, the dummy C script does not actually use lzo2 directly, so whether the lzo2 library will be linked or not depends now on whether ld is being run with {{\"\\--as-needed\"}} or with {{\"\\--no-as-needed\"}}.\n\nI provided a patch [2] for hadoop-lzo that fixes this problem by setting {{LDFLAGS}} (env var) in ant's {{build.xml}}.  The same fix solves this build error for Hadoop 0.20.203.0, too:\n\n{code}\n    <exec dir=\"${build.native}\" executable=\"sh\" failonerror=\"true\">\n          <env key=\"OS_NAME\" value=\"${os.name}\"/>\n          <env key=\"OS_ARCH\" value=\"${os.arch}\"/>\n          <env key=\"JVM_DATA_MODEL\" value=\"${sun.arch.data.model}\"/>\n          <env key=\"HADOOP_NATIVE_SRCDIR\" value=\"${native.src.dir}\"/>\n          <env key=\"LDFLAGS\" value=\"-Wl,--no-as-needed\"/>     <== add this line\n          <arg line=\"${native.src.dir}/configure\"/>\n    </exec>\n{code}\n\nIf this seems like a reasonable approach (I'm not a C expert) I can provide a similar patch for Hadoop 0.20.20x as well.\n\n[1] https://github.com/kevinweil/hadoop-lzo\n[2] https://github.com/kevinweil/hadoop-lzo/pull/34","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=miguno","name":"miguno","key":"miguno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=miguno&avatarId=26959","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=miguno&avatarId=26959","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=miguno&avatarId=26959","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=miguno&avatarId=26959"},"displayName":"Michael Noll","active":true,"timeZone":"Europe/Amsterdam"},"created":"2011-11-03T15:03:02.660+0000","updated":"2011-11-03T15:03:02.660+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-2009/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ihbz:"}}