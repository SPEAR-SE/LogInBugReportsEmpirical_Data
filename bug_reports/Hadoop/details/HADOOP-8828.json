{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12599934","self":"https://issues.apache.org/jira/rest/api/2/issue/12599934","key":"HADOOP-8828","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-09-20T13:44:07.302+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Feb 02 02:13:37 UTC 2017","customfield_12310420":"246639","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-8828/watchers","watchCount":30,"isWatching":false},"created":"2012-07-24T02:16:54.796+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12376429","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12376429","type":{"id":"12310010","name":"Incorporates","inward":"is part of","outward":"incorporates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"},"outwardIssue":{"id":"12672249","key":"HADOOP-10016","self":"https://issues.apache.org/jira/rest/api/2/issue/12672249","fields":{"summary":"Distcp should support copy from a secure Hadoop 1 cluster to an insecure Hadoop 2 cluster","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}},{"id":"12376428","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12376428","type":{"id":"12310010","name":"Incorporates","inward":"is part of","outward":"incorporates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"},"outwardIssue":{"id":"12672263","key":"HADOOP-10017","self":"https://issues.apache.org/jira/rest/api/2/issue/12672263","fields":{"summary":"Fix NPE in DFSClient#getDelegationToken when doing Distcp from a secured cluster to an insecured cluster","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}},{"id":"12358053","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12358053","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12606683","key":"HDFS-3905","self":"https://issues.apache.org/jira/rest/api/2/issue/12606683","fields":{"summary":"Secure cluster cannot use hftp to an insecure cluster","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-02-02T02:13:37.999+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/4","description":"This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/reopened.png","name":"Reopened","id":"4","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12319644","id":"12319644","name":"tools/distcp","description":"Distcp"}],"timeoriginalestimate":null,"description":"Users currently can't distcp from secure to insecure clusters.\n\nRelevant background from ATM:\n\nThere's no plumbing to make the HFTP client use AuthenticatedURL in the case security is enabled. This means that even though you have the servlet filter correctly configured on the server, the client doesn't know how to properly authenticate to that filter.\n\nThe crux of the issue is that security is enabled globally instead of per-file system. The trick of using HFTP as the source FS works when the source is insecure, but not the source is secure.\n\nNormal cp with two hdfs:// URL can be made to work. There is indeed logic in o.a.h.ipc.Client to fall back to using simple authentication if your client config has security enabled (hadoop.security.authentication set to \"kerberos\") and the server responds with a response for simple authentication. Thing is, there are at least 3 bugs with this that I bumped into. All three can be worked around.\n\n1) If your client config has security enabled you *must* have a valid Kerberos TGT, even if you're interacting with an insecure cluster. The hadoop client unfortunately tries to read the local ticket cache before it tries to connect to the server, and so doesn't know that it won't need Kerberos credentials.\n\n2) Even though the destination NN is insecure, it has to have a Kerberos principal created for it. You don't need a keytab, and you don't need to change any settings on the destination NN. The principal just needs to exist in the principal database. This is again because the hadoop client will, before connecting to the remote NN, try to get a service ticket for the hdfs/f.q.d.n principal for the remote NN. If this fails, it won't even get to the part where it tries to connect to the insecure NN and falls back to simple auth.\n\n3) Once you get through problems 1 and 2, you will try to connect to the remote, insecure NN. This will work, but the reported principal name of your user will include a realm that the remote NN doesn't know about. You will either need to change the default_realm setting in /etc/krb5.conf on the insecure NN to be the same as the secure NN, or you will need to add some custom hadoop.security.auth_to_local mappings on the insecure NN so it knows how to translate this long principal name into a short name.\n\nEven with all these changes, distcp still won't work since the first thing it tries to do when submitting the job is to get a delegation token for all the involved NNs, which won't work since the insecure NN isn't running a DT secret manager. I haven't been able to figure out a way around this, except to make a custom distcp which doesn't necessarily do this.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"43337","customfield_12312823":null,"summary":"Support distcp from secure to insecure clusters","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[{"id":"12672249","key":"HADOOP-10016","self":"https://issues.apache.org/jira/rest/api/2/issue/12672249","fields":{"summary":"Distcp should support copy from a secure Hadoop 1 cluster to an insecure Hadoop 2 cluster","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}},{"id":"12672263","key":"HADOOP-10017","self":"https://issues.apache.org/jira/rest/api/2/issue/12672263","fields":{"summary":"Fix NPE in DFSClient#getDelegationToken when doing Distcp from a secured cluster to an insecured cluster","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13459596","id":"13459596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"Which versions are you observing this behavior?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2012-09-20T13:44:07.302+0000","updated":"2012-09-20T13:44:07.302+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13464481","id":"13464481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"I believe this was 2.0 or a trunk build around that time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-27T06:06:01.352+0000","updated":"2012-09-27T06:06:01.352+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13464523","id":"13464523","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Btw here's the current failure mode for secure to insecure using hftp and webhdfs (thanks to Stephen Chu).\n\nCaused by: java.io.IOException: Couldn't setup connection for schu@HAL.CLOUDERA.COM to hdfs/c1204.hal.cloudera.com@HAL.CLOUDERA.COM\nat org.apache.hadoop.ipc.Client$Connection$1.run(Client.java:540)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.Subject.doAs(Subject.java:396)\nat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1332)\nat org.apache.hadoop.ipc.Client$Connection.handleSaslConnectionFailure(Client.java:512)\nat org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:596)\nat org.apache.hadoop.ipc.Client$Connection.access$1700(Client.java:220)\nat org.apache.hadoop.ipc.Client.getConnection(Client.java:1213)\nat org.apache.hadoop.ipc.Client.call(Client.java:1140)\n... 22 more\nCaused by: javax.security.sasl.SaslException: GSS initiate failed [Caused by GSSException: No valid credentials provided (Mechanism level: Server not found in Kerberos database\\\n(7) - UNKNOWN_SERVER)]\nat com.sun.security.sasl.gsskerb.GssKrb5Client.evaluateChallenge(GssKrb5Client.java:194)\nat org.apache.hadoop.security.SaslRpcClient.saslConnect(SaslRpcClient.java:137)\nat org.apache.hadoop.ipc.Client$Connection.setupSaslConnection(Client.java:423)\nat org.apache.hadoop.ipc.Client$Connection.access$1300(Client.java:220)\nat org.apache.hadoop.ipc.Client$Connection$2.run(Client.java:589)\nat org.apache.hadoop.ipc.Client$Connection$2.run(Client.java:586)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.Subject.doAs(Subject.java:396)\nat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1332)\nat org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:585)\n... 25 more\nCaused by: GSSException: No valid credentials provided (Mechanism level: Server not found in Kerberos database (7) - UNKNOWN_SERVER)\nat sun.security.jgss.krb5.Krb5Context.initSecContext(Krb5Context.java:663)\nat sun.security.jgss.GSSContextImpl.initSecContext(GSSContextImpl.java:230)\nat sun.security.jgss.GSSContextImpl.initSecContext(GSSContextImpl.java:162)\nat com.sun.security.sasl.gsskerb.GssKrb5Client.evaluateChallenge(GssKrb5Client.java:175)\n... 34 more\nCaused by: KrbException: Server not found in Kerberos database (7) - UNKNOWN_SERVER\nat sun.security.krb5.KrbTgsRep.<init>(KrbTgsRep.java:64)\nat sun.security.krb5.KrbTgsReq.getReply(KrbTgsReq.java:185)\nat sun.security.krb5.internal.CredentialsUtil.serviceCreds(CredentialsUtil.java:294)\nat sun.security.krb5.internal.CredentialsUtil.acquireServiceCreds(CredentialsUtil.java:106)\nat sun.security.krb5.Credentials.acquireServiceCreds(Credentials.java:557)\nat sun.security.jgss.krb5.Krb5Context.initSecContext(Krb5Context.java:594)\n... 37 more\nCaused by: KrbException: Identifier doesn't match expected value (906)\nat sun.security.krb5.internal.KDCRep.init(KDCRep.java:133)\nat sun.security.krb5.internal.TGSRep.init(TGSRep.java:58)\nat sun.security.krb5.internal.TGSRep.<init>(TGSRep.java:53)\nat sun.security.krb5.KrbTgsRep.<init>(KrbTgsRep.java:46)\n... 42 more","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-09-27T07:29:53.919+0000","updated":"2012-09-27T07:29:53.919+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13464774","id":"13464774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"Owen and I were just discussing a few weeks ago if we should always attempt a kerberos connection if the user has kerberos credentials.  It's odd that we assume that all clusters are insecure if the local cluster is insecure.  It should be a simple and compatible change because an insecure NN's sasl will kick the user back to simple auth if presented with kerberos.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2012-09-27T14:28:42.619+0000","updated":"2012-09-27T14:28:42.619+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13644644","id":"13644644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"body":"To copy data from a secure cluster to insecure cluster, run the distcp on the secure cluster. It would be a security problem to run the distcp on the insecure cluster because you would need tokens for the secure cluster and they wouldn't be protected by the insecure cluster.\n\nOf course that means you'll need to use webhdfs or hdfs rpc to perform the write, but that is far better than encouraging users to open up security holes in their secure clusters.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-04-29T16:52:20.440+0000","updated":"2013-04-29T16:52:20.440+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13645797","id":"13645797","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"FYI, this problem should be addressed by SASL changes in RPCv9.  The client won't attempt kerberos if the server doesn't support it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2013-04-30T18:10:01.264+0000","updated":"2013-04-30T18:10:01.264+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/13786411","id":"13786411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm reopening this JIRA as we found some subtle problems in HADOOP-10016 and HADOOP-10017.\n\nI've tested the set up of copying from a secure Hadoop cluster to secure Hadoop 2 cluster using distcp, and have found some subtle problems:\n\n1. There is a NPE in the trunk which fails the distcp job (addressed in HADOOP-10017).\n2. When copying from a secure Hadoop 1 cluster to an insecure Hadoop 2 cluster, the Hadoop 1 cluster cannot handle this case because it lacks of negotiation and fallback mechanisms during authentications. (addressed in HADOOP-10016).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wheat9","name":"wheat9","key":"wheat9","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haohui Mai","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-10-04T17:51:18.163+0000","updated":"2013-10-04T17:51:18.163+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/14235887","id":"14235887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Tobi","name":"Tobi","key":"tobi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tobi Vollebregt","active":true,"timeZone":"America/Los_Angeles"},"body":"Any progress on this?\n\nI ran into a variant of this recently when using HBase ExportSnapshot to copy from a secure to an insecure cluster. I was able to workaround using a custom WebHDFS implementation for the insecure cluster, that I used using {{-Dfs.webhdfs.impl=<classpath>.SimpleAuthWebHdfsFileSystem}}:\n\n{code:java}\npublic class SimpleAuthWebHdfsFileSystem extends WebHdfsFileSystem {\n  @Override public Token<DelegationTokenIdentifier> getDelegationToken(String renewer)\n      throws IOException {\n    return null;\n  }\n}\n{code} \n\nSecure cluster is running Hadoop 2.3.0 / CDH 5.1.2\nInsecure cluster is running Hadoop 2.0.0 / CDH 4.6.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Tobi","name":"Tobi","key":"tobi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tobi Vollebregt","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-12-05T18:52:13.349+0000","updated":"2014-12-05T18:52:13.349+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12599934/comment/15849295","id":"15849295","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ddimatos","name":"ddimatos","key":"ddimatos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ddimatos&avatarId=26787","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ddimatos&avatarId=26787","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ddimatos&avatarId=26787","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ddimatos&avatarId=26787"},"displayName":"Demetrios Dimatos","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi, \nI am wondering if there is any updates on this before I invest time digging deeper for a solution. I to have seen this issue as described going from a Kerberized Secure Hadoop 2.7.3 Cluster to an insecure Hadoop 2.7.3 cluster. My use case is below, let me know if there is something more I can help with while I have the configuration available. \n\nhadoop distcp -D ipc.client.fallback-to-simple-auth-allowed=true hdfs://secure.com/tmp/tests/test.txt hdfs://insecure.com/tmp/tests/test-kerb-non-kerb-simple-auth.txt\n\nThe distcp command returns with an java.io.EOFException and the NN log has in it a \"NoMatchingRule: No rules applied to...\" error.\nThanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ddimatos","name":"ddimatos","key":"ddimatos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ddimatos&avatarId=26787","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ddimatos&avatarId=26787","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ddimatos&avatarId=26787","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ddimatos&avatarId=26787"},"displayName":"Demetrios Dimatos","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-02T02:13:37.999+0000","updated":"2017-02-02T02:13:37.999+0000"}],"maxResults":9,"total":9,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-8828/votes","votes":5,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07s7j:"}}