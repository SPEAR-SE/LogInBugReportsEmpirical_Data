{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12735757","self":"https://issues.apache.org/jira/rest/api/2/issue/12735757","key":"HADOOP-10991","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2014-08-21T14:47:46.551+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sun Aug 24 07:48:39 UTC 2014","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_13214586_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-08-21T14:47:46.531+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10991/watchers","watchCount":3,"isWatching":false},"created":"2014-08-21T11:07:31.971+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":["namenode"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326263","id":"12326263","description":"2.5.0 release","name":"2.5.0","archived":false,"released":true,"releaseDate":"2014-08-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-08-24T07:48:39.485+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310689","id":"12310689","name":"fs","description":"Generic FileSystem code"}],"timeoriginalestimate":null,"description":"Since my homedir is on shared NFS, I couldn't create a user for hadoop on /home. Therefore, I've used:\nuseradd hadoop --home /hadoop\n\nwhich worked well. I've adjusted HADOOP_HOME and friends to match correctly. Running hdfs namenode -format failed:\n{noformat}\n14/08/21 13:57:35 INFO namenode.NNConf: XAttrs enabled? true\n14/08/21 13:57:35 INFO namenode.NNConf: Maximum size of an xattr: 16384\n14/08/21 13:57:35 INFO namenode.FSImage: Allocated new BlockPoolId: BP-1696511243-10.103.234.197-1408618655940\n14/08/21 13:57:35 WARN namenode.NameNode: Encountered exception during format: \njava.io.IOException: Cannot create directory /home/hadoop/hadoopdata/hdfs/namenode/current\n\tat org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.clearDirectory(Storage.java:334)\n\tat org.apache.hadoop.hdfs.server.namenode.NNStorage.format(NNStorage.java:546)\n\tat org.apache.hadoop.hdfs.server.namenode.NNStorage.format(NNStorage.java:567)\n\tat org.apache.hadoop.hdfs.server.namenode.FSImage.format(FSImage.java:148)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.format(NameNode.java:926)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1354)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:1473)\n14/08/21 13:57:35 FATAL namenode.NameNode: Exception in namenode join\njava.io.IOException: Cannot create directory /home/hadoop/hadoopdata/hdfs/namenode/current\n\tat org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.clearDirectory(Storage.java:334)\n\tat org.apache.hadoop.hdfs.server.namenode.NNStorage.format(NNStorage.java:546)\n\tat org.apache.hadoop.hdfs.server.namenode.NNStorage.format(NNStorage.java:567)\n\tat org.apache.hadoop.hdfs.server.namenode.FSImage.format(FSImage.java:148)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.format(NameNode.java:926)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1354)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:1473)\n14/08/21 13:57:35 INFO util.ExitUtil: Exiting with status 1\n14/08/21 13:57:35 INFO namenode.NameNode: SHUTDOWN_MSG: \n/************************************************************\nSHUTDOWN_MSG: Shutting down NameNode at lgdrm432.xiodrm.lab.emc.com/10.103.234.197\n{noformat}\n\nThe error seems to be clear:\n{noformat}\njava.io.IOException: Cannot create directory /home/hadoop/hadoopdata/hdfs/namenode/current\n{noformat}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"'hadoop namenode -format' fails if user hadoop homedir is not under /home","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mykaul","name":"mykaul","key":"mykaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yaniv Kaul","active":true,"timeZone":"Asia/Jerusalem"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mykaul","name":"mykaul","key":"mykaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yaniv Kaul","active":true,"timeZone":"Asia/Jerusalem"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"CentOS 6.5","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12735757/comment/14105419","id":"14105419","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"This is either:\n\na) permissions issue in /home/hadoop\nb) misconfiguration in hdfs-site.xml\n\nI've run namenode format in many many directories, including /home and not /home.\n\nIt should be noted that changing HADOOP_PREFIX has zero influence on where the NN fsimage gets created.\n\nClosing as cannot reproduce.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2014-08-21T14:47:46.551+0000","updated":"2014-08-21T14:47:46.551+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12735757/comment/14108298","id":"14108298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mykaul","name":"mykaul","key":"mykaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yaniv Kaul","active":true,"timeZone":"Asia/Jerusalem"},"body":"Agree - mea culpa -  configuration issue - indeed etc/hdfs-site.xml was incorrectly set. Fixing it solved the problem - thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mykaul","name":"mykaul","key":"mykaul","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yaniv Kaul","active":true,"timeZone":"Asia/Jerusalem"},"created":"2014-08-24T07:48:39.485+0000","updated":"2014-08-24T07:48:39.485+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10991/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1z6hb:"}}