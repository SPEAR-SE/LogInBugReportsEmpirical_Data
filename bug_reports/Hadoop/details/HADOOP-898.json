{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12360696","self":"https://issues.apache.org/jira/rest/api/2/issue/12360696","key":"HADOOP-898","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312257","id":"12312257","description":"","name":"0.11.0","archived":false,"released":true,"releaseDate":"2007-02-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-01-17T20:05:24.560+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jan 18 19:52:40 UTC 2007","customfield_12310420":"125040","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_86127888_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_1323045721","customfield_12312321":null,"resolutiondate":"2007-01-18T19:52:40.673+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-898/watchers","watchCount":0,"isWatching":false},"created":"2007-01-17T19:57:12.785+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:42:15.036+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"My namenode is generating a constant stream of NullPointerExceptions. The log looks like:\n\n2007-01-17 19:51:27,461 INFO org.apache.hadoop.ipc.Server: IPC Server handler 3\non 50000 call error: java.io.IOException: java.lang.NullPointerException\njava.io.IOException: java.lang.NullPointerException\n        at org.apache.hadoop.dfs.FSNamesystem.addStoredBlock(FSNamesystem.java:1621)\n        at org.apache.hadoop.dfs.FSNamesystem.processReport(FSNamesystem.java:1563)\n        at org.apache.hadoop.dfs.NameNode.blockReport(NameNode.java:573)\n        at sun.reflect.GeneratedMethodAccessor6.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:589)\n        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:337)\n        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:538)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12349199","id":"12349199","filename":"898-post-803-revert.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nidaley","name":"nidaley","key":"nidaley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nigel Daley","active":true,"timeZone":"Etc/UTC"},"created":"2007-01-18T18:51:10.145+0000","size":673,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12349199/898-post-803-revert.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12349118","id":"12349118","filename":"HADOOP-898.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T21:30:36.229+0000","size":13914,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12349118/HADOOP-898.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12349125","id":"12349125","filename":"HADOOP-898-2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T23:50:20.597+0000","size":915,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12349125/HADOOP-898-2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"106683","customfield_12312823":null,"summary":"namenode generates infinite stream of null pointers","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465534","id":"12465534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"This must be my changes that got checked in yesterday. I am looking into this.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T20:05:24.560+0000","updated":"2007-01-17T20:05:24.560+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465555","id":"12465555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"storedBlock is null.\nThis NPE implies node N is listed as one of the nodes that has a block B (in blocksMap) but N.blocks map does not contain B.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T20:46:19.556+0000","updated":"2007-01-17T20:46:19.556+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465569","id":"12465569","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"\nAttached HADOOP-898.patch that reverses the patch in HADOOP-803 and one line change for patch in HADOOP-855 (changing List<> to Collection).\n\nOwen could you try the patch in your build? Thanks.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T21:33:08.913+0000","updated":"2007-01-17T21:33:08.913+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465602","id":"12465602","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"You add block to containingNodes inside addStoredBlock(), but add this same block to the\nDatanodeDescriptor.blocks outside of addStoredBlock().\nIf something goes wrong in addStoredBlock() and it throws an exception AFTER the block\nwas added to containingNodes, will that be the case we are seeing now?\n\nWe should think how to add blocks to the DatanodeDescriptor inside addStoredBlock().\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T23:21:11.469+0000","updated":"2007-01-17T23:21:11.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465606","id":"12465606","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"That can explain this case.. I still need to get used thinking in exceptions. I will check if client got an IPC exception.\nBoth addStoredBlock() and addBlock() can be called outside the while() loop. So they could be just one function.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T23:33:54.887+0000","updated":"2007-01-17T23:33:54.887+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465615","id":"12465615","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"\nAttached much smaller 2.patch that basically check if storedBlock is null. \n\nAn IPC exception that Konstantin mentioned  would create same situation before HADOOP-803 as well (i.e. containingNodes has N but N does not have the block) . I am not sure yet whether that is ok or if it could lead to some other problems. Only difference now is that we are requiring that such a situation not exist.  The attached patch allows this apparent inconsistency just like before.\n\nBoth patches pass 'ant test'.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-17T23:55:01.594+0000","updated":"2007-01-17T23:55:01.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465634","id":"12465634","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"\nBoth patches worked in Owen's cluster.\n\nDoug, could you apply HADOOP-898-2.patch to the current trunk while I look more into the problem? The first patch is much more conservative and reverts whole of HADOOP-803, we could do this if we don't find more about the problem soon. I am fairly confident of the second patch.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-18T01:36:22.967+0000","updated":"2007-01-18T01:36:22.967+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465661","id":"12465661","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nidaley","name":"nidaley","key":"nidaley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nigel Daley","active":true,"timeZone":"Etc/UTC"},"body":"-1 for  HADOOP-898-2.patch\n\n+1 for  HADOOP-898.patch.  \n\nOf the two patches, I find that only HADOOP-898.patch reduces the probability of TestSmallBlock failing from around 20% to 0% after 100+ runs.\n\nFor those interested, when TestSmallBlock fails, it's because one call to blocks[i].getNumBytes() in the FSNamesystem.getDatanodeHints() method returns 0 when it should return 1.  Since it is sporadic, it seems like a synchronization/timing issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nidaley","name":"nidaley","key":"nidaley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nigel Daley","active":true,"timeZone":"Etc/UTC"},"created":"2007-01-18T06:38:21.290+0000","updated":"2007-01-18T06:38:21.290+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465664","id":"12465664","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"\nThanks Nigel. Was the test failing 20% of the time before any of these patches? Was it occationally failing before HADOOP-803 was checked in?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-18T06:59:49.754+0000","updated":"2007-01-18T06:59:49.754+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465823","id":"12465823","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"body":"Not sure whether the issues I see are related to this bug or not. \n\nAlong with sporadic failures of TestSmallBlock testcase, I also see TestPread failing once in a while with the exception:\nImpossible situation: could not find target position 8192\njava.io.IOException: Impossible situation: could not find target position 8192\n        at org.apache.hadoop.dfs.DFSClient$DFSInputStream.read(DFSClient.java:873)\n        at org.apache.hadoop.fs.FSInputStream.readFully(FSInputStream.java:61)\n        at org.apache.hadoop.fs.FSDataInputStream$Checker.readFully(FSDataInputStream.java:155)\n        at org.apache.hadoop.fs.FSDataInputStream$PositionCache.readFully(FSDataInputStream.java:212)\n        at org.apache.hadoop.fs.FSDataInputStream$Buffer.readFully(FSDataInputStream.java:265)\n        at org.apache.hadoop.fs.FSDataInputStream.readFully(FSDataInputStream.java:315)\n        at org.apache.hadoop.dfs.TestPread.pReadFile(TestPread.java:92)\n        at org.apache.hadoop.dfs.TestPread.testPreadDFS(TestPread.java:119)\n\nOnce I also saw the TestDFSShell failing (forgot to note the exception). \n\nThe DFS has become somewhat flaky lately.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"created":"2007-01-18T17:37:15.020+0000","updated":"2007-01-18T17:37:15.020+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465824","id":"12465824","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"body":"During a run of the sort benchmark many reduces failed with these exceptions:\n\nEXCEPTION TRACE #1\n----------------------------------\njava.lang.NullPointerException\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.closeBackupStream(DFSClient.java:972)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:1219)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.flush(DFSClient.java:1181)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.write(DFSClient.java:1163)\n\tat org.apache.hadoop.fs.FSDataOutputStream$Summer.write(FSDataOutputStream.java:85)\n\tat org.apache.hadoop.fs.FSDataOutputStream$PositionCache.write(FSDataOutputStream.java:114)\n\tat java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n\tat java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n\tat java.io.DataOutputStream.flush(DataOutputStream.java:106)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:140)\n\tat org.apache.hadoop.io.SequenceFile$Writer.close(SequenceFile.java:558)\n\tat org.apache.hadoop.mapred.SequenceFileOutputFormat$1.close(SequenceFileOutputFormat.java:72)\n\tat org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:331)\n\tat org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:1367)\n\nEXCEPTION TRACE #2\n---------------------------------\njava.io.IOException: Trying to write to backupStream but it already closed or not open\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.flushData(DFSClient.java:1195)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.flush(DFSClient.java:1183)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:1315)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat org.apache.hadoop.fs.FSDataOutputStream$Summer.close(FSDataOutputStream.java:99)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat org.apache.hadoop.io.SequenceFile$Writer.close(SequenceFile.java:558)\n\tat org.apache.hadoop.mapred.SequenceFileOutputFormat$1.close(SequenceFileOutputFormat.java:72)\n\tat org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:331)\n\tat org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:1367)\n\nEXCEPTION TRACE #3 (this is Hadoop-758 I think)\n----------------------------------------------------------------------\njava.io.FileNotFoundException: /export/crawlspace/kryptonite/ddas/dfs/data/tmp/client-1257934407504380214 (No such file or directory)\n\tat java.io.FileInputStream.open(Native Method)\n\tat java.io.FileInputStream.(FileInputStream.java:106)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.endBlock(DFSClient.java:1229)\n\tat org.apache.hadoop.dfs.DFSClient$DFSOutputStream.close(DFSClient.java:1318)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat org.apache.hadoop.fs.FSDataOutputStream$Summer.close(FSDataOutputStream.java:98)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat java.io.FilterOutputStream.close(FilterOutputStream.java:143)\n\tat org.apache.hadoop.io.SequenceFile$Writer.close(SequenceFile.java:558)\n\tat org.apache.hadoop.mapred.SequenceFileOutputFormat$1.close(SequenceFileOutputFormat.java:72)\n\tat org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:331)\n\tat org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:1367)\n\nEXCEPTION TRACE #4 (although this I think has something to do with RPC timing out at the namenode, I hadn't encountered this exception in a long long time)\n--------------------------------------------------------\njava.net.SocketTimeoutException: timed out waiting for rpc response\n\tat org.apache.hadoop.ipc.Client.call(Client.java:467)\n\tat org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:164)\n\tat org.apache.hadoop.dfs.$Proxy1.getProtocolVersion(Unknown Source)\n\tat org.apache.hadoop.ipc.RPC.getProxy(RPC.java:248)\n\tat org.apache.hadoop.dfs.DFSClient.(DFSClient.java:105)\n\tat org.apache.hadoop.dfs.DistributedFileSystem.initialize(DistributedFileSystem.java:65)\n\tat org.apache.hadoop.fs.FileSystem.get(FileSystem.java:160)\n\tat org.apache.hadoop.fs.FileSystem.getNamed(FileSystem.java:119)\n\tat org.apache.hadoop.fs.FileSystem.get(FileSystem.java:91)\n\tat org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:1366)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"created":"2007-01-18T17:47:11.281+0000","updated":"2007-01-18T17:47:11.281+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465834","id":"12465834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"> Impossible situation: could not find target position 8192\n> java.io.IOException: Impossible situation: could not find target position 8192\nI don't think this is related. We should file a different bug.\n\n>java.lang.NullPointerException\n>at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.closeBackupStream(DFSClient.java:972)\nNot related to this bug but caused by one of my recent patches. will fix today.\n\n#2 is not a bug. #2 and #3 need patch in HADOOP-758.\n\nI don't know much about #4 but my understanding is that RPC timeouts are expected with a busy nameserver. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-18T18:24:54.073+0000","updated":"2007-01-18T18:24:54.073+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465839","id":"12465839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"Regd 898-post-803-revert.patch Nigel Daley wrote:\n> Rather than apply a patch that effectively reverts HADOOP-803, it would \n> be better to revert the patch using svn and then apply the neccessary \n> (one line) patch to re-introduce the change needed by the overlapping \n> HADOOP-855 patch.  The svn command that I've applied and tested is:\n> \n> svn merge -r 496845:496844 .\n> \n> (where . is my trunk directory)\n> \n> I will also attach the one line diff that was necessary to apply after \n> the above merge command.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-18T19:04:50.987+0000","updated":"2007-01-18T19:04:50.987+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12360696/comment/12465851","id":"12465851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"body":"I just committed this.  Thanks, Nigel & Raghu!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-01-18T19:52:40.663+0000","updated":"2007-01-18T19:52:40.663+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-898/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0im5j:"}}