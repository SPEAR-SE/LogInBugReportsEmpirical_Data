{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13203336","self":"https://issues.apache.org/jira/rest/api/2/issue/13203336","key":"HADOOP-15991","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-12-13T12:12:53.335+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Dec 17 23:43:12 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15991/watchers","watchCount":4,"isWatching":false},"created":"2018-12-10T02:18:13.489+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12342324","id":"12342324","description":"3.2 release","name":"3.2.0","archived":false,"released":false}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jack-Lee","name":"Jack-Lee","key":"jack-lee","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"lqjacklee","active":true,"timeZone":"Asia/Hong_Kong"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-12-17T23:43:12.786+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311814","id":"12311814","name":"fs/s3","description":"S3A filesystem client and other S3 connectivity issues"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12311440","id":"12311440","name":"test","description":"Testing support software"}],"timeoriginalestimate":null,"description":"timeout of S3 mpu tests","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"testMultipartUpload timing out","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jack-Lee","name":"Jack-Lee","key":"jack-lee","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"lqjacklee","active":true,"timeZone":"Asia/Hong_Kong"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jack-Lee","name":"Jack-Lee","key":"jack-lee","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"lqjacklee","active":true,"timeZone":"Asia/Hong_Kong"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203336/comment/16720089","id":"16720089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"{code}\r\n2018-12-10 09:58:56,482 [Thread-746] INFO contract.AbstractFSContractTestBase (AbstractFSContractTestBase.java:setup(184)) - Test filesystem = s3a://jack-testlambda implemented by S3AFileSystem{uri=s3a://jack-testlambda, workingDir=s3a://jack-testlambda/user/jack, inputPolicy=normal, partSize=104857600, enableMultiObjectsDelete=true, maxKeys=5000, readAhead=65536, blockSize=33554432, multiPartThreshold=2147483647, serverSideEncryptionAlgorithm='NONE', blockFactory=org.apache.hadoop.fs.s3a.S3ADataBlocks$DiskBlockFactory@3111299f, metastore=DynamoDBMetadataStore\r\n\r\n{region=ap-southeast-1, tableName=test-h}\r\n\r\n, authoritative=false, useListV1=false, magicCommitter=false, boundedExecutor=BlockingThreadPoolExecutorService{SemaphoredDelegatingExecutor\r\n\r\n{permitCount=25, available=25, waiting=0}\r\n\r\n, activeCount=0}, unboundedExecutor=java.util.concurrent.ThreadPoolExecutor@78c596aa[Running, pool size = 10, active threads = 0, queued tasks = 0, completed tasks = 20], credentials=AWSCredentialProviderList[refcount= 2: [SimpleAWSCredentialsProvider, EnvironmentVariableCredentialsProvider, com.amazonaws.auth.InstanceProfileCredentialsProvider@4a214309], statistics \\{18901220 bytes read, 18912956 bytes written, 580 read ops, 0 large read ops, 843 write ops}, metrics {\r\n\r\n{Context=s3aFileSystem}\r\n\r\n{s3aFileSystemId=94fd09ed-8145-4d1e-b11b-678151785e0b} \\{bucket=jack-testlambda} \\{stream_opened=28} \\{stream_close_operations=28} \\{stream_closed=28} \\{stream_aborted=0} \\{stream_seek_operations=0} \\{stream_read_exceptions=0} \\{stream_forward_seek_operations=0} \\{stream_backward_seek_operations=0} \\{stream_bytes_skipped_on_seek=0} \\{stream_bytes_backwards_on_seek=0} \\{stream_bytes_read=18901220} \\{stream_read_operations=2734} \\{stream_read_fully_operations=0} \\{stream_read_operations_incomplete=2171} \\{stream_bytes_read_in_close=0} \\{stream_bytes_discarded_in_abort=0} \\{files_created=49} \\{files_copied=20} \\{files_copied_bytes=9441684} \\{files_deleted=79} \\{fake_directories_deleted=630} \\{directories_created=98} \\{directories_deleted=19} \\{ignored_errors=71} \\{op_copy_from_local_file=0} \\{op_create=55} \\{op_create_non_recursive=6} \\{op_delete=74} \\{op_exists=80} \\{op_get_file_checksum=8} \\{op_get_file_status=923} \\{op_glob_status=19} \\{op_is_directory=0} \\{op_is_file=0} \\{op_list_files=8} \\{op_list_located_status=0} \\{op_list_status=51} \\{op_mkdirs=114} \\{op_open=28} \\{op_rename=20} \\{object_copy_requests=0} \\{object_delete_requests=198} \\{object_list_requests=337} \\{object_continue_list_requests=0} \\{object_metadata_requests=560} \\{object_multipart_aborted=0} \\{object_put_bytes=18904764} \\{object_put_requests=147} \\{object_put_requests_completed=147} \\{stream_write_failures=0} \\{stream_write_block_uploads=0} \\{stream_write_block_uploads_committed=0} \\{stream_write_block_uploads_aborted=0} \\{stream_write_total_time=0} \\{stream_write_total_data=18904764} \\{committer_commits_created=0} \\{committer_commits_completed=0} \\{committer_jobs_completed=0} \\{committer_jobs_failed=0} \\{committer_tasks_completed=0} \\{committer_tasks_failed=0} \\{committer_bytes_committed=0} \\{committer_bytes_uploaded=0} \\{committer_commits_failed=0} \\{committer_commits_aborted=0} \\{committer_commits_reverted=0} \\{committer_magic_files_created=0} \\{s3guard_metadatastore_put_path_request=166} \\{s3guard_metadatastore_initialization=1} \\{s3guard_metadatastore_retry=0} \\{s3guard_metadatastore_throttled=0} \\{store_io_throttled=0} \\{object_put_requests_active=0} \\{object_put_bytes_pending=0} \\{stream_write_block_uploads_active=0} \\{stream_write_block_uploads_pending=49} \\{stream_write_block_uploads_data_pending=0} \\{S3guard_metadatastore_put_path_latencyNumOps=1} \\{S3guard_metadatastore_put_path_latency50thPercentileLatency=427507288} \\{S3guard_metadatastore_put_path_latency75thPercentileLatency=427507288} \\{S3guard_metadatastore_put_path_latency90thPercentileLatency=427507288} \\{S3guard_metadatastore_put_path_latency95thPercentileLatency=427507288} \\{S3guard_metadatastore_put_path_latency99thPercentileLatency=427507288} \\{S3guard_metadatastore_throttle_rateNumEvents=0} \\{S3guard_metadatastore_throttle_rate50thPercentileFrequency (Hz)=0} \\{S3guard_metadatastore_throttle_rate75thPercentileFrequency (Hz)=0} \\{S3guard_metadatastore_throttle_rate90thPercentileFrequency (Hz)=0} \\{S3guard_metadatastore_throttle_rate95thPercentileFrequency (Hz)=0} \\{S3guard_metadatastore_throttle_rate99thPercentileFrequency (Hz)=0} }}\r\n 2018-12-10 10:01:50,127 [Thread-746] INFO s3a.ITestS3AContractMultipartUploader (ITestS3AContractMultipartUploader.java:teardown(108)) - Teardown: aborting outstanding uploads under s3a://jack-testlambda/test\r\n 2018-12-10 10:01:50,618 [Thread-746] INFO s3a.ITestS3AContractMultipartUploader (ITestS3AContractMultipartUploader.java:teardown(110)) - Found 0 incomplete uploads\r\n\r\njava.lang.Exception: test timed out after 180000 milliseconds\r\n\r\nat java.net.SocketInputStream.socketRead0(Native Method)\r\n at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\r\n at java.net.SocketInputStream.read(SocketInputStream.java:171)\r\n at java.net.SocketInputStream.read(SocketInputStream.java:141)\r\n at sun.security.ssl.InputRecord.readFully(InputRecord.java:465)\r\n at sun.security.ssl.InputRecord.read(InputRecord.java:503)\r\n at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:975)\r\n at sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:933)\r\n at sun.security.ssl.AppInputStream.read(AppInputStream.java:105)\r\n at com.amazonaws.thirdparty.apache.http.impl.io.SessionInputBufferImpl.streamRead(SessionInputBufferImpl.java:137)\r\n at com.amazonaws.thirdparty.apache.http.impl.io.SessionInputBufferImpl.fillBuffer(SessionInputBufferImpl.java:153)\r\n at com.amazonaws.thirdparty.apache.http.impl.io.SessionInputBufferImpl.readLine(SessionInputBufferImpl.java:282)\r\n at com.amazonaws.thirdparty.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:138)\r\n at com.amazonaws.thirdparty.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:56)\r\n at com.amazonaws.thirdparty.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:259)\r\n at com.amazonaws.thirdparty.apache.http.impl.DefaultBHttpClientConnection.receiveResponseHeader(DefaultBHttpClientConnection.java:163)\r\n at com.amazonaws.thirdparty.apache.http.impl.conn.CPoolProxy.receiveResponseHeader(CPoolProxy.java:165)\r\n at com.amazonaws.thirdparty.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:273)\r\n at com.amazonaws.http.protocol.SdkHttpRequestExecutor.doReceiveResponse(SdkHttpRequestExecutor.java:82)\r\n at com.amazonaws.thirdparty.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125)\r\n at com.amazonaws.thirdparty.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:272)\r\n at com.amazonaws.thirdparty.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)\r\n at com.amazonaws.thirdparty.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)\r\n at com.amazonaws.thirdparty.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)\r\n at com.amazonaws.thirdparty.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)\r\n at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1238)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1058)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:743)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:717)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:699)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:667)\r\n at com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:649)\r\n at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:513)\r\n at com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient.doInvoke(AmazonDynamoDBClient.java:3443)\r\n at com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient.invoke(AmazonDynamoDBClient.java:3419)\r\n at com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient.executeGetItem(AmazonDynamoDBClient.java:1787)\r\n at com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient.getItem(AmazonDynamoDBClient.java:1762)\r\n at com.amazonaws.services.dynamodbv2.document.internal.GetItemImpl.doLoadItem(GetItemImpl.java:77)\r\n at com.amazonaws.services.dynamodbv2.document.internal.GetItemImpl.getItem(GetItemImpl.java:66)\r\n at com.amazonaws.services.dynamodbv2.document.Table.getItem(Table.java:608)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.lambda$getConsistentItem$2(DynamoDBMetadataStore.java:525)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore$$Lambda$22/1870510662.execute(Unknown Source)\r\n at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)\r\n at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:265)\r\n at org.apache.hadoop.fs.s3a.Invoker$$Lambda$16/750351714.execute(Unknown Source)\r\n at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:322)\r\n at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:261)\r\n at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:236)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.getConsistentItem(DynamoDBMetadataStore.java:522)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.innerGet(DynamoDBMetadataStore.java:560)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.get(DynamoDBMetadataStore.java:540)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.get(DynamoDBMetadataStore.java:531)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.lambda$listChildren$4(DynamoDBMetadataStore.java:627)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore$$Lambda$38/2053745802.execute(Unknown Source)\r\n at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)\r\n at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:265)\r\n at org.apache.hadoop.fs.s3a.Invoker$$Lambda$16/750351714.execute(Unknown Source)\r\n at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:322)\r\n at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:261)\r\n at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:236)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.listChildren(DynamoDBMetadataStore.java:611)\r\n at org.apache.hadoop.fs.s3a.s3guard.DescendantsIterator.next(DescendantsIterator.java:132)\r\n at org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore.deleteSubtree(DynamoDBMetadataStore.java:505)\r\n at org.apache.hadoop.fs.s3a.S3AFileSystem.innerDelete(S3AFileSystem.java:1802)\r\n at org.apache.hadoop.fs.s3a.S3AFileSystem.delete(S3AFileSystem.java:1711)\r\n at org.apache.hadoop.fs.contract.ContractTestUtils.rm(ContractTestUtils.java:402)\r\n at org.apache.hadoop.fs.contract.ContractTestUtils.cleanup(ContractTestUtils.java:378)\r\n at org.apache.hadoop.fs.contract.AbstractFSContractTestBase.deleteTestDirInTeardown(AbstractFSContractTestBase.java:213)\r\n at org.apache.hadoop.fs.contract.AbstractFSContractTestBase.teardown(AbstractFSContractTestBase.java:204)\r\n at org.apache.hadoop.fs.contract.s3a.ITestS3AContractMultipartUploader.teardown(ITestS3AContractMultipartUploader.java:114)\r\n at sun.reflect.GeneratedMethodAccessor22.invoke(Unknown Source)\r\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n at java.lang.reflect.Method.invoke(Method.java:498)\r\n at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)\r\n at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)\r\n at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)\r\n at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)\r\n\r\n {code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2018-12-13T12:12:53.335+0000","updated":"2018-12-13T12:12:53.335+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203336/comment/16720106","id":"16720106","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"\"Interesting\", as they say. Stack trace implies it was in DynamoDB during test teardown itself.\r\n\r\n# what happens if you don't run with s3guard on?\r\n# what are the s3guard settings for that bucket (e.g IO allocation).\r\n# How far is that AWS region from you?\r\n# and what is your bandwidth, especially uploading\r\n\r\n3.2+ has a lot of support for dealing with DDB throttling -from the printed metrics I don't see any throttling events\r\n\r\nyou can set the test timeout for scale tests by setting the property fs.s3a.scale.test.timeout to a value in seconds. Do that on the maven build and it will also tune the maven timeout too, so the test runner itself doesn't break.\r\n\r\nLooking at the code in the MPU test it should be timing out after 30 minutes, not 3 which is something to worry about. Maybe we're passing it up wrong (it's retrofitted the scale params to a contract test, see)\r\n\r\nYou can try setting a smaller partition size at {{-Dfs.s3a.scale.test.huge.partitionsize=5M}} ; this uploads half as much data. \r\n\r\nLooking at where timeouts can come in from the test runner, if you run the test as a unit test (-Dtest=ITest....) you'd see more problems, but I'm not sure that any of the scale tests will kick in then.\r\n\r\nReturning to the problem:\r\n# switch to a smaller partition size (5M is the minimum)\r\n# see if a bigger scale test timeout on the build command line helps\r\n# see if you want to spend time debugging how timeouts get picked up; maybe some log statement\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2018-12-13T12:33:19.976+0000","updated":"2018-12-13T12:33:19.976+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13203336/comment/16723479","id":"16723479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jack-Lee","name":"Jack-Lee","key":"jack-lee","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"lqjacklee","active":true,"timeZone":"Asia/Hong_Kong"},"body":"# what happens if you don't run with s3guard on?\r\n ## The configuration is off\r\n # what are the s3guard settings for that bucket (e.g IO allocation).\r\n ## the default one, just change the region and credentials\r\n # How far is that AWS region from you?\r\n ## PING s3.ap-south-1.amazonaws.com (52.219.66.29): 56 data bytes\r\n64 bytes from 52.219.66.29: icmp_seq=0 ttl=32 time=513.278 ms\r\n # and what is your bandwidth, especially uploading\r\n ## \r\nDOWNLOAD 48.58 Mbps /UPLOAD 3.46 Mbps\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Jack-Lee","name":"Jack-Lee","key":"jack-lee","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34055","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"},"displayName":"lqjacklee","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2018-12-17T23:43:12.786+0000","updated":"2018-12-17T23:43:12.786+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15991/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|s01bzs:"}}