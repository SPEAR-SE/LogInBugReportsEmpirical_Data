{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13150137","self":"https://issues.apache.org/jira/rest/api/2/issue/13150137","key":"HADOOP-15471","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12331977","id":"12331977","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2018-04-11T20:15:21.545+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Jun 08 23:25:56 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15471/watchers","watchCount":14,"isWatching":false},"created":"2018-04-04T20:31:35.221+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12331977","id":"12331977","description":"2.7.1 release","name":"2.7.1","archived":false,"released":true,"releaseDate":"2015-07-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-06-08T23:25:56.715+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310689","id":"12310689","name":"fs","description":"Generic FileSystem code"}],"timeoriginalestimate":null,"description":"The hdfs dfs -ls -R command is sequential in nature and is very slow for a HCFS system. We have seen around 6 mins for 40K directory/files structure.\r\n\r\nThe proposal is to use multithreading approach to speed up recursive list, du and count operations.\r\n\r\nWe have tried a ForkJoinPool implementation to improve performance for recursive listing operation.\r\n\r\n[https://github.com/jasoncwik/hadoop-release/tree/parallel-fs-cli]\r\n\r\ncommit id : \r\n\r\n82387c8cd76c2e2761bd7f651122f83d45ae8876\r\n\r\nAnother implementation is to use Java Executor Service to improve performance to run listing operation in multiple threads in parallel. This has significantly reduced the time to 40 secs from 6 mins.\r\n\r\n \r\n\r\n ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12342315","id":"12342315","description":"2.7.6 release","name":"2.7.6","archived":false,"released":true,"releaseDate":"2018-04-16"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12921587","id":"12921587","filename":"HDFS-13398.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-02T14:52:17.941+0000","size":9694,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12921587/HDFS-13398.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12923285","id":"12923285","filename":"HDFS-13398.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-14T12:58:02.590+0000","size":3664,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12923285/HDFS-13398.002.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12925175","id":"12925175","filename":"HDFS-13398.003.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-25T17:21:32.886+0000","size":25304,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12925175/HDFS-13398.003.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12918395","id":"12918395","filename":"parallelfsPatch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-10T14:42:54.041+0000","size":7285,"mimeType":"text/html","content":"https://issues.apache.org/jira/secure/attachment/12918395/parallelfsPatch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Hdfs recursive listing operation is very slow","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"HCFS file system where HDP 2.6.1 is connected to ECS (Object Store).","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16434508","id":"16434508","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitkhare04","name":"arpitkhare04","key":"arpitkhare04","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Khare","active":true,"timeZone":"Etc/UTC"},"body":"Cc: [~arpitagarwal]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitkhare04","name":"arpitkhare04","key":"arpitkhare04","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Khare","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-11T20:15:21.545+0000","updated":"2018-04-11T20:15:21.545+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16434512","id":"16434512","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitkhare04","name":"arpitkhare04","key":"arpitkhare04","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Khare","active":true,"timeZone":"Etc/UTC"},"body":"[~ajaysachdev] : Is this the same functionality which we are trying to achive?\r\nhttps://issues.apache.org/jira/browse/HDFS-11786","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitkhare04","name":"arpitkhare04","key":"arpitkhare04","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Khare","active":true,"timeZone":"Etc/UTC"},"created":"2018-04-11T20:18:03.521+0000","updated":"2018-04-11T20:18:03.521+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16441039","id":"16441039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for working on this [~ajaysachdev] and [~jcwik]. Please find my comments as following.\r\n\r\n1) The current patch is not applying right now. Can you please rebase the patch over latest trunk ?\r\n2) Also can you please upload the patch with filename as \"HDFS-13398.001.patch\". Please follow the guidelines for naming the patch as https://wiki.apache.org/hadoop/HowToContribute#Naming_your_patch.\r\n3) Also can the config \"fs.threads\" can be replaced with a command line argument. I feel that will help in controlling the parallelization for each command. We can certainly have a default value in the case it is not specified.\r\n4) Also it will be great if some unit tests can be added for the patch.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-04-17T15:40:00.258+0000","updated":"2018-04-17T15:52:05.473+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16461122","id":"16461122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"Hi Mukul/Arpit,\r\n\r\nSorry for late response. We would like to get a formal review process for this patch before we deploy on customer site. I will work on items #3 and #4 above. Also I was unable to find trunk branch in \r\n\r\n[https://github.com/hortonworks/hadoop-release.] So we have used HDP tag -\r\n\r\nHDP-2.6.2.0-205-tag\r\n\r\nI have also attached the patch against this tag. I would appreciate if you could take a look at code and get a review as well.\r\n\r\n \r\n\r\nThanks\r\n\r\nAjay[^HDFS-13398.001.patch]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-02T14:52:25.525+0000","updated":"2018-05-02T14:52:25.525+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16469244","id":"16469244","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the updated patch [~ajaysachdev]. The Apache Hadoop trunk can be found at \"git clone git://git.apache.org/hadoop.git\". Please refer to https://wiki.apache.org/hadoop/GitAndHadoop for details.\r\n\r\nPlease rebase the patch over the latest Apache Hadoop trunk obtained from the above location.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-05-09T18:18:00.882+0000","updated":"2018-05-09T18:18:00.882+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16472582","id":"16472582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaynmalu23","name":"ajaynmalu23","key":"ajaynmalu23","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"I have attached apache hadoop trunk multithreading diff. Please take a look at code review and provide comments.\r\n\r\n \r\n\r\nThanks\r\n\r\nAjay","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaynmalu23","name":"ajaynmalu23","key":"ajaynmalu23","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-11T20:13:30.125+0000","updated":"2018-05-11T20:13:30.125+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16472922","id":"16472922","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi [~ajaysachdev], I cannot see a patch uploaded to the jira. Can you please upload the patch to the jira :)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-05-12T05:46:15.347+0000","updated":"2018-05-12T05:46:15.347+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16473546","id":"16473546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks [~ajaysachdev].\r\n\r\nI am still not able to see the \"HDFS-13398.002.patch\" patch in Attachments section of the jira.\r\nI tried reviewing the HDFS-13398.001.patch but the patch does not apply on the latest trunk.\r\n\r\nPlease submit the patch by using the Attachment section of the jira. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-05-13T16:15:00.973+0000","updated":"2018-05-13T16:15:00.973+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16474010","id":"16474010","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=linyiqun","name":"linyiqun","key":"linyiqun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=linyiqun&avatarId=25258","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=linyiqun&avatarId=25258","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=linyiqun&avatarId=25258","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=linyiqun&avatarId=25258"},"displayName":"Yiqun Lin","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi [~ajaysachdev], I just take a quick look for the v001 patch. One comment from me:\r\n\r\nIn the v001 patch, we introduced the ForkJoinPool to execute commands in an asyn way. Since we make this change in Command class that means this will also make sense for other fs sub-commands, not only -du, -ls commands. Will this be thread-safe to run in other fs commands?\r\n\r\nIn addition, looks like this JIRA should move into Hadoop Common.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=linyiqun","name":"linyiqun","key":"linyiqun","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=linyiqun&avatarId=25258","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=linyiqun&avatarId=25258","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=linyiqun&avatarId=25258","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=linyiqun&avatarId=25258"},"displayName":"Yiqun Lin","active":true,"timeZone":"Asia/Shanghai"},"created":"2018-05-14T10:20:13.448+0000","updated":"2018-05-14T10:20:13.448+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16474147","id":"16474147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"Hi Mukul,\r\n\r\nI have attached the new patch to JIRA.\r\n\r\n \r\n\r\nCheers,\r\n\r\nAjay","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-14T12:59:09.600+0000","updated":"2018-05-14T12:59:09.600+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16474335","id":"16474335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"Hi Yiqun,\r\n\r\nThanks for taking the time to take a look at the patch. I have also uploaded the 2nd version of the patch against apache trunk. I would appreciate if you could provide some feedback against that version as well. This patch is intended for our customer which is using ViPRFS interface and they only want to run -ls -R/-du and count commands of FsShell. I agree that if there is any mutable shared state that any of sub-commands such as usagesTable in FsUsage.java class then we will wrap synchronized block around it to make it thread-safe. As a long term solution we would like to optimize all FsShell commands to take use of this ForkJoin Pool Framework and then all sub-commands implementation can ensure that any shared state are thread-safe.\r\n\r\n \r\n\r\nThanks\r\n\r\nAjay","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-14T15:10:46.090+0000","updated":"2018-05-14T15:10:46.090+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16474369","id":"16474369","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shahrs87","name":"shahrs87","key":"shahrs87","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rushabh S Shah","active":true,"timeZone":"Etc/UTC"},"body":"[~ajaysachdev]: Thanks for the patch.\r\nDo you have performance numbers for {{ForkJoinPool}} approach. Sorry if I have missed that part.\r\nAlso for {{fs.threads}}, did you compare with different #threads and evaluate what #threads is recommended.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shahrs87","name":"shahrs87","key":"shahrs87","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rushabh S Shah","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-14T15:41:10.202+0000","updated":"2018-05-14T15:41:10.202+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16474674","id":"16474674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"Hi Rushabh,\r\n\r\nThats a good question. As you may know FJP is very critical for multi-core systems and it forks large tasks into smaller subtasks and then joins (waits) individual results to form final result (Divide and Conquer approach). We tried different number for parallelism (ie number of threads) in ForkJoinPool framework such as 8, 16, 32 and 64. The use case was a directory/file hierarchy structure of 40K+ and a nested tree-level. In this scenario we were able to demonstrate that a numberOfThreads=32 was ideal configuration. So our tests were based off these variables.\r\n\r\nFsShell commands (single threaded approach) -\r\n\r\nls -R -> 12 mins\r\n\r\ndu -> 14 mins\r\n\r\ncount -> 14 mins\r\n\r\n \r\n\r\nFsShell commands (FJP approach) -\r\n\r\nls -R -> 3 mins\r\n\r\ndu -> 2 mins\r\n\r\ncount -> 9 mins\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-14T19:16:59.345+0000","updated":"2018-05-14T19:16:59.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16478429","id":"16478429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks for the  [^HDFS-13398.002.patch] [~ajaysachdev]. Some major comments on the patch.\r\n\r\n1) The current recursion in Command@recursePath uses the depth variable to recurse down the tree. I feel we should synchronize and localize the modification to this variable.\r\n2) Apache Hadoop uses, 2 spaces for indentation. Please use the same coding guidelines in the patch.\r\n3) Lets also add a unit test for this patch, We can add a unit test where a multi level directory structure is parsed through both the current method as well as the new method in the patch and lets compare the results to verify the validity of the patch.\r\n4) Also I feel in place of a config variable \"fs.threads\", number of threads should be made a command line argument, so that the user can control the number of threads for each invocation of the command.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-05-17T03:07:30.722+0000","updated":"2018-05-17T03:07:30.722+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16479336","id":"16479336","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"I have incorporated all items above. I am in process of putting some unit tests as well and testing these out. For number of threads option I have opted for -T <number of threads> in command line argument. The \"du\" command already had a lower -t option for storage type.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-17T16:36:03.350+0000","updated":"2018-05-17T16:36:03.350+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16491040","id":"16491040","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"Attaching the latest patch which has Count multithreaded optimization as well. Also added unit tests to diff. Let me know if there are any more comments.\r\n\r\n \r\n\r\nThanks\r\n\r\nAjay[^HDFS-13398.003.patch]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-25T17:21:39.188+0000","updated":"2018-05-25T17:21:39.188+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16496792","id":"16496792","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"body":"Hello Mukul/Yiqun/Rishabh,\r\n\r\nPlease let me know if you have any comments on latest patch.\r\n\r\nAppreciate your help!\r\n\r\nAjay","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ajaysachdev","name":"ajaysachdev","key":"ajaysachdev","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ajay Sachdev","active":true,"timeZone":"Etc/UTC"},"created":"2018-05-31T16:15:25.506+0000","updated":"2018-05-31T16:15:25.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16497568","id":"16497568","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Submitting the patch to trigger jenkins.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=msingh","name":"msingh","key":"msingh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukul Kumar Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2018-06-01T05:07:45.757+0000","updated":"2018-06-01T05:07:45.757+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16497660","id":"16497660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\r\n\\\\\r\n\\\\\r\n|| Vote || Subsystem || Runtime || Comment ||\r\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 14s{color} | {color:blue} Docker mode activated. {color} |\r\n|| || || || {color:brown} Prechecks {color} ||\r\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\r\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 3 new or modified test files. {color} |\r\n|| || || || {color:brown} trunk Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 26m 15s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 27m 49s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 53s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 10s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 12m 28s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |\r\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  1m 40s{color} | {color:green} trunk passed {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 57s{color} | {color:green} trunk passed {color} |\r\n|| || || || {color:brown} Patch Compile Tests {color} ||\r\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 48s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 29m 10s{color} | {color:green} the patch passed {color} |\r\n| {color:red}-1{color} | {color:red} javac {color} | {color:red} 29m 10s{color} | {color:red} root generated 1 new + 1489 unchanged - 0 fixed = 1490 total (was 1489) {color} |\r\n| {color:orange}-0{color} | {color:orange} checkstyle {color} | {color:orange}  0m 52s{color} | {color:orange} hadoop-common-project/hadoop-common: The patch generated 47 new + 101 unchanged - 0 fixed = 148 total (was 101) {color} |\r\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  8s{color} | {color:green} the patch passed {color} |\r\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\r\n| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green} 10m  8s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |\r\n| {color:red}-1{color} | {color:red} findbugs {color} | {color:red}  1m 43s{color} | {color:red} hadoop-common-project/hadoop-common generated 4 new + 0 unchanged - 0 fixed = 4 total (was 0) {color} |\r\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 58s{color} | {color:green} the patch passed {color} |\r\n|| || || || {color:brown} Other Tests {color} ||\r\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}  8m 20s{color} | {color:red} hadoop-common in the patch failed. {color} |\r\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 38s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\r\n| {color:black}{color} | {color:black} {color} | {color:black}124m 50s{color} | {color:black} {color} |\r\n\\\\\r\n\\\\\r\n|| Reason || Tests ||\r\n| FindBugs | module:hadoop-common-project/hadoop-common |\r\n|  |  Boxing/unboxing to parse a primitive org.apache.hadoop.fs.shell.Count.processOptions(LinkedList)  At Count.java:org.apache.hadoop.fs.shell.Count.processOptions(LinkedList)  At Count.java:[line 140] |\r\n|  |  Possible null pointer dereference of status in org.apache.hadoop.fs.shell.Count$ContentSummaryTask.compute() on exception path  Dereferenced at Count.java:status in org.apache.hadoop.fs.shell.Count$ContentSummaryTask.compute() on exception path  Dereferenced at Count.java:[line 277] |\r\n|  |  Boxing/unboxing to parse a primitive org.apache.hadoop.fs.shell.FsUsage$Du.processOptions(LinkedList)  At FsUsage.java:org.apache.hadoop.fs.shell.FsUsage$Du.processOptions(LinkedList)  At FsUsage.java:[line 193] |\r\n|  |  Boxing/unboxing to parse a primitive org.apache.hadoop.fs.shell.Ls.processOptions(LinkedList)  At Ls.java:org.apache.hadoop.fs.shell.Ls.processOptions(LinkedList)  At Ls.java:[line 155] |\r\n| Failed junit tests | hadoop.fs.TestFsShellCopy |\r\n|   | hadoop.cli.TestCLI |\r\n|   | hadoop.fs.shell.TestLs |\r\n|   | hadoop.fs.shell.TestCount |\r\n|   | hadoop.fs.shell.find.TestFind |\r\n\\\\\r\n\\\\\r\n|| Subsystem || Report/Notes ||\r\n| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:abb62dd |\r\n| JIRA Issue | HADOOP-15471 |\r\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12925175/HDFS-13398.003.patch |\r\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  shadedclient  findbugs  checkstyle  |\r\n| uname | Linux 6956ede0deb0 3.13.0-139-generic #188-Ubuntu SMP Tue Jan 9 14:43:09 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux |\r\n| Build tool | maven |\r\n| Personality | /testptch/patchprocess/precommit/personality/provided.sh |\r\n| git revision | trunk / 7dd26d5 |\r\n| maven | version: Apache Maven 3.3.9 |\r\n| Default Java | 1.8.0_162 |\r\n| findbugs | v3.1.0-RC1 |\r\n| javac | https://builds.apache.org/job/PreCommit-HADOOP-Build/14713/artifact/out/diff-compile-javac-root.txt |\r\n| checkstyle | https://builds.apache.org/job/PreCommit-HADOOP-Build/14713/artifact/out/diff-checkstyle-hadoop-common-project_hadoop-common.txt |\r\n| findbugs | https://builds.apache.org/job/PreCommit-HADOOP-Build/14713/artifact/out/new-findbugs-hadoop-common-project_hadoop-common.html |\r\n| unit | https://builds.apache.org/job/PreCommit-HADOOP-Build/14713/artifact/out/patch-unit-hadoop-common-project_hadoop-common.txt |\r\n|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/14713/testReport/ |\r\n| Max. process+thread count | 1516 (vs. ulimit of 10000) |\r\n| modules | C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common |\r\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/14713/console |\r\n| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |\r\n\r\n\r\nThis message was automatically generated.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=genericqa","name":"genericqa","key":"genericqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=genericqa&avatarId=33630","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=genericqa&avatarId=33630","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=genericqa&avatarId=33630","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=genericqa&avatarId=33630"},"displayName":"genericqa","active":true,"timeZone":"Etc/UTC"},"created":"2018-06-01T07:15:27.885+0000","updated":"2018-06-01T07:15:27.885+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13150137/comment/16506689","id":"16506689","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jnp","name":"jnp","key":"jnp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jitendra Nath Pandey","active":true,"timeZone":"Etc/UTC"},"body":"[~ajaysachdev], please review the javac/findbugs issues and test failures. Please fix them if they are related to this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jnp","name":"jnp","key":"jnp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jitendra Nath Pandey","active":true,"timeZone":"Etc/UTC"},"created":"2018-06-08T23:25:56.715+0000","updated":"2018-06-08T23:25:56.715+0000"}],"maxResults":20,"total":20,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15471/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3s5pj:"}}