{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13047832","self":"https://issues.apache.org/jira/rest/api/2/issue/13047832","key":"HADOOP-14142","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2017-03-03T11:54:17.123+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 03 11:59:47 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_47810613_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2017-03-03T11:59:47.323+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-14142/watchers","watchCount":2,"isWatching":false},"created":"2017-03-02T22:42:56.753+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334005","id":"12334005","description":"2.7.3 release","name":"2.7.3","archived":false,"released":true,"releaseDate":"2016-08-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-03-03T11:59:47.363+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311814","id":"12311814","name":"fs/s3","description":"S3A filesystem client and other S3 connectivity issues"}],"timeoriginalestimate":null,"description":"Hi:\n\nS3A seems to prefix unexpected prefix to my s3 path\n\nSpecifically, in the debug log below the following line is unexpected\n\n>  GET /myBkt8/?max-keys=1&prefix=user%2Fvardhan%2F&delimiter=%2F HTTP/1.1\n\nIt is not clear where the \"prefix\" is coming from and why.\n\n\nI executed the following commands\n\nsc.setLogLevel(\"DEBUG\")\nsc.hadoopConfiguration.set(\"fs.s3a.impl\",\"org.apache.hadoop.fs.s3a.S3AFileSystem\")\nsc.hadoopConfiguration.set(\"fs.s3a.endpoint\",\"webscaledemo.netapp.com:8082\")\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\",\"\")\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\",\"\")\nsc.hadoopConfiguration.set(\"fs.s3a.path.style.access\",\"false\")\nval s3Rdd = sc.textFile(\"s3a://myBkt98\")\ns3Rdd.count()\n\n\n----\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"S3A - Adding unexpected prefix","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vardhanv","name":"vardhanv","key":"vardhanv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vishnu Vardhan","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vardhanv","name":"vardhanv","key":"vardhanv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vishnu Vardhan","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13047832/comment/15894203","id":"15894203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"Log. Vishnu: we like to have stacks and logs in a comment so it doesn't get included with every email; use the \\{noformat } or \\{code} header and footer to keep the text unformatted thanks\n{code}\n\napplication/x-www-form-urlencoded; charset=utf-8\nThu, 02 Mar 2017 22:40:25 GMT\n/myBkt8/\"\n17/03/02 14:40:25 DEBUG request: Sending Request: GET https://webscaledemo.netapp.com:8082 /myBkt8/ Parameters: (max-keys: 1, prefix: user/vardhan/, delimiter: /, ) Headers: (Authorization: AWS 2SNAJYEMQU45YPVYC89D:M8GbLXUuAJ2w5pGx4WJ6hJF3324=, User-Agent: aws-sdk-java/1.7.4 Mac_OS_X/10.12.3 Java_HotSpot(TM)_64-Bit_Server_VM/25.60-b23/1.8.0_60, Date: Thu, 02 Mar 2017 22:40:25 GMT, Content-Type: application/x-www-form-urlencoded; charset=utf-8, ) \n17/03/02 14:40:25 DEBUG PoolingClientConnectionManager: Connection request: [route: {s}->https://webscaledemo.netapp.com:8082][total kept alive: 0; route allocated: 0 of 15; total allocated: 0 of 15]\n17/03/02 14:40:25 DEBUG PoolingClientConnectionManager: Connection leased: [id: 10][route: {s}->https://webscaledemo.netapp.com:8082][total kept alive: 0; route allocated: 1 of 15; total allocated: 1 of 15]\n17/03/02 14:40:25 DEBUG DefaultClientConnectionOperator: Connecting to webscaledemo.netapp.com:8082\n17/03/02 14:40:25 DEBUG PoolingClientConnectionManager: Closing connections idle longer than 60 SECONDS\n17/03/02 14:40:25 DEBUG PoolingClientConnectionManager: Closing connections idle longer than 60 SECONDS\n17/03/02 14:40:26 DEBUG RequestAddCookies: CookieSpec selected: default\n17/03/02 14:40:26 DEBUG RequestAuthCache: Auth cache not set in the context\n17/03/02 14:40:26 DEBUG RequestProxyAuthentication: Proxy auth state: UNCHALLENGED\n17/03/02 14:40:26 DEBUG SdkHttpClient: Attempt 1 to execute request\n17/03/02 14:40:26 DEBUG DefaultClientConnection: Sending request: GET /myBkt8/?max-keys=1&prefix=user%2Fvardhan%2F&delimiter=%2F HTTP/1.1\n17/03/02 14:40:26 DEBUG wire:  >> \"GET /myBkt8/?max-keys=1&prefix=user%2Fvardhan%2F&delimiter=%2F HTTP/1.1[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"Host: webscaledemo.netapp.com:8082[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"Authorization: AWS 2SNAJYEMQU45YPVYC89D:M8GbLXUuAJ2w5pGx4WJ6hJF3324=[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"User-Agent: aws-sdk-java/1.7.4 Mac_OS_X/10.12.3 Java_HotSpot(TM)_64-Bit_Server_VM/25.60-b23/1.8.0_60[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"Date: Thu, 02 Mar 2017 22:40:25 GMT[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"Content-Type: application/x-www-form-urlencoded; charset=utf-8[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"Connection: Keep-Alive[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  >> \"[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG headers: >> GET /myBkt8/?max-keys=1&prefix=user%2Fvardhan%2F&delimiter=%2F HTTP/1.1\n17/03/02 14:40:26 DEBUG headers: >> Host: webscaledemo.netapp.com:8082\n17/03/02 14:40:26 DEBUG headers: >> Authorization: AWS 2SNAJYEMQU45YPVYC89D:M8GbLXUuAJ2w5pGx4WJ6hJF3324=\n17/03/02 14:40:26 DEBUG headers: >> User-Agent: aws-sdk-java/1.7.4 Mac_OS_X/10.12.3 Java_HotSpot(TM)_64-Bit_Server_VM/25.60-b23/1.8.0_60\n17/03/02 14:40:26 DEBUG headers: >> Date: Thu, 02 Mar 2017 22:40:25 GMT\n17/03/02 14:40:26 DEBUG headers: >> Content-Type: application/x-www-form-urlencoded; charset=utf-8\n17/03/02 14:40:26 DEBUG headers: >> Connection: Keep-Alive\n17/03/02 14:40:26 DEBUG wire:  << \"HTTP/1.1 200 OK[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"Date: Thu, 02 Mar 2017 22:40:26 GMT[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"Connection: KEEP-ALIVE[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"Server: StorageGRID/10.3.0.1[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"x-amz-request-id: 563477649[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"Content-Length: 266[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"Content-Type: application/xml[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"[\\r][\\n]\"\n17/03/02 14:40:26 DEBUG DefaultClientConnection: Receiving response: HTTP/1.1 200 OK\n17/03/02 14:40:26 DEBUG headers: << HTTP/1.1 200 OK\n17/03/02 14:40:26 DEBUG headers: << Date: Thu, 02 Mar 2017 22:40:26 GMT\n17/03/02 14:40:26 DEBUG headers: << Connection: KEEP-ALIVE\n17/03/02 14:40:26 DEBUG headers: << Server: StorageGRID/10.3.0.1\n17/03/02 14:40:26 DEBUG headers: << x-amz-request-id: 563477649\n17/03/02 14:40:26 DEBUG headers: << Content-Length: 266\n17/03/02 14:40:26 DEBUG headers: << Content-Type: application/xml\n17/03/02 14:40:26 DEBUG SdkHttpClient: Connection can be kept alive indefinitely\n17/03/02 14:40:26 DEBUG XmlResponsesSaxParser: Sanitizing XML document destined for handler class com.amazonaws.services.s3.model.transform.XmlResponsesSaxParser$ListBucketHandler\n17/03/02 14:40:26 DEBUG wire:  << \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>[\\n]\"\n17/03/02 14:40:26 DEBUG wire:  << \"<ListBucketResult xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\"><Name>myBkt8</Name><Prefix>user/vardhan/</Prefix><Marker></Marker><MaxKeys>1</MaxKeys><Delimiter>/</Delimiter><IsTruncated>false</IsTruncated></ListBucketResult>\"\n17/03/02 14:40:26 DEBUG PoolingClientConnectionManager: Connection [id: 10][route: {s}->https://webscaledemo.netapp.com:8082] can be kept alive indefinitely\n17/03/02 14:40:26 DEBUG PoolingClientConnectionManager: Connection released: [id: 10][route: {s}->https://webscaledemo.netapp.com:8082][total kept alive: 1; route allocated: 1 of 15; total allocated: 1 of 15]\n17/03/02 14:40:26 DEBUG XmlResponsesSaxParser: Parsing XML response document with handler: class com.amazonaws.services.s3.model.transform.XmlResponsesSaxParser$ListBucketHandler\n17/03/02 14:40:26 DEBUG XmlResponsesSaxParser: Examining listing for bucket: myBkt8\n17/03/02 14:40:26 DEBUG request: Received successful response: 200, AWS Request ID: 563477649\n17/03/02 14:40:26 DEBUG S3AFileSystem: Not Found: s3a://myBkt8/user/vardhan\norg.apache.hadoop.mapred.InvalidInputException: Input path does not exist: s3a://myBkt8\n  at org.apache.hadoop.mapred.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:287)\n  at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:229)\n  at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:315)\n  at org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:202)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)\n  at scala.Option.getOrElse(Option.scala:121)\n  at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)\n  at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)\n  at scala.Option.getOrElse(Option.scala:121)\n  at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1958)\n  at org.apache.spark.rdd.RDD.count(RDD.scala:1157)\n  ... 53 elided\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-03-03T11:54:17.123+0000","updated":"2017-03-03T11:54:17.123+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13047832/comment/15894206","id":"15894206","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"Updating version info. Vishnu\n# please add version number of Hadoop version.\n# \"critical\" is more an interpretation of the project, rather than how much it matters to you. Sorry.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-03-03T11:56:32.140+0000","updated":"2017-03-03T11:56:32.140+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13047832/comment/15894211","id":"15894211","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"And closing as invalid. It's your home directory, which is the default unless you put a trailing \"/\" on the path. \n\nAs stated before, If you are trying to show your S3 implementation works with hadoop, run the hadoop-aws test suite first. For spark, [try these tests|https://github.com/steveloughran/spark-cloud-examples]\n\nEither way, immediately panicing with critical bug reports isn't going to fix the problem. You've got partway there with the logging, but take advantage of the code: step through it to see what's happening. It's what we end up doing","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2017-03-03T11:59:47.360+0000","updated":"2017-03-03T11:59:47.360+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-14142/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3avnz:"}}