{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12405994","self":"https://issues.apache.org/jira/rest/api/2/issue/12405994","key":"HADOOP-4373","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313211","id":"12313211","description":"","name":"0.19.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-10-08T11:18:59.364+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Oct 16 15:55:49 UTC 2008","customfield_12310420":"126503","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_25349740_*|*_1_*:*_1_*:*_616950309_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_3122439674","customfield_12312321":null,"resolutiondate":"2008-10-15T20:18:03.517+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-4373/watchers","watchCount":0,"isWatching":false},"created":"2008-10-08T09:53:03.468+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313211","id":"12313211","description":"","name":"0.19.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:40:32.246+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Guaranteed Capacity calculation is not calculated correctly.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12392023","id":"12392023","filename":"HADOOP-4373.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-13T18:01:31.439+0000","size":6528,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12392023/HADOOP-4373.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12391934","id":"12391934","filename":"HADOOP-4373.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-11T12:40:54.632+0000","size":5867,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12391934/HADOOP-4373.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12391725","id":"12391725","filename":"HADOOP-4373.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-08T11:43:29.119+0000","size":843,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12391725/HADOOP-4373.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"104360","customfield_12312823":null,"summary":"Guaranteed Capacity calculation is not calculated correctly","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karams","name":"karams","key":"karams","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karam Singh","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karams","name":"karams","key":"karams","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karam Singh","active":true,"timeZone":"Asia/Kolkata"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12637840","id":"12637840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karams","name":"karams","key":"karams","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karam Singh","active":true,"timeZone":"Asia/Kolkata"},"body":"Settings: \nCluster is of 107 nodes out which 106 runs tasktrackers\nConfigured 4 qeueues -:\n\ndefault gc_percent=10\ntest_q1 gc_percent=20\ntest_q2\tgc_precent=30\ntest_q3 gc_percent=40\n\nAfter starting  mapred cluster.  \nJobTracker UI shows -:\nNodes=106, Map Task Capacity=212, Reduce Task Capacity=212\tAvg. Tasks/Node=4.00\n\nQueue Information shows -:\nQueue Name Scheduling Information\ndefault    Guaranteed Capacity Maps (%) :10.0, Guaranteed Capacity Reduces (%) :10.0, Current Capacity Maps : 0, Current Capacity Reduces : 0\ntest_q1    Guaranteed Capacity Maps (%) :20.0, Guaranteed Capacity Reduces (%) :20.0, Current Capacity Maps : 0, Current Capacity Reduces : 0\ntest_q2    Guaranteed Capacity Maps (%) :30.0, Guaranteed Capacity Reduces (%) :30.0, Current Capacity Maps : 0, Current Capacity Reduces : 0\ntest_q3    Guaranteed Capacity Maps (%) :40.0, Guaranteed Capacity Reduces (%) :40.0, Current Capacity Maps : 0, Current Capacity Reduces : 0\n\n\nAnd Job track log shows -:\n2008-10-08 09:46:48,053 DEBUG org.apache.hadoop.mapred.CapacityTaskScheduler: After updating QSI objects:\n2008-10-08 09:46:48,053 DEBUG org.apache.hadoop.mapred.CapacityTaskScheduler:  Queue 'default'(map): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***  Queue 'test_q1'(map): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***  Queue 'test_q2'(map): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***  Queue 'test_q3'(map): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***\n2008-10-08 09:46:48,053 DEBUG org.apache.hadoop.mapred.CapacityTaskScheduler: After updating QSI objects:\n2008-10-08 09:46:48,053 DEBUG org.apache.hadoop.mapred.CapacityTaskScheduler:  Queue 'default'(reduce): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***  Queue 'test_q1'(reduce): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***  Queue 'test_q2'(reduce): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***  Queue 'test_q3'(reduce): run=0, gc=0, wait=0, run jobs=0, wait jobs=0***\n\nRan running  about 15 jobs. \ngc for all 4 queues remained 0 all the time.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=karams","name":"karams","key":"karams","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karam Singh","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-08T09:53:20.240+0000","updated":"2008-10-08T09:53:20.240+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12637871","id":"12637871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"The observed behavior is because we compute the guaranteed capacity as follows:\n{code}\nprivate synchronized void updateQSIObjects() {\n      int slotsDiff = getClusterCapacity()- numSlots;\n      numSlots += slotsDiff;\n      for (QueueSchedulingInfo qsi: queueInfoMap.values()) {\n        // compute new GCs and ACs, if TT slots have changed\n        if (slotsDiff != 0) {\n          qsi.guaranteedCapacity +=\n            (qsi.guaranteedCapacityPercent*slotsDiff/100);\n        }\n     //...\n}\n{code}\n\nThe intent, it appears, is that after a certain steady state is reached, i.e. after the time the guaranteed capacities for queues reaches some % of the total capacity, guaranteed capacities are updated by a differential based on the difference in slots. While this seems right, the problem is that the pre-condition never occurs.\n\n{{getClusterCapacity()}} gets the number of map/reduce slots currently known. When the cluster is starting up, this value gradually increases. Typically, {{slotsDiff}} will be equal to the number of slots on a TT, as each TT joins in. This, in turn, is typically much less than 100 (say 2, or 4, or some such). So, if the {{guaranteedCapacityPercent}} is a small value as well, something like 10% or so, the product is < 100, and so the capacity is always 0.\n\nTrying out a patch which modifies the computation as follows:\n{code}\nif (slotsDiff != 0) {\n  qsi.guaranteedCapacity =\n       (int)(qsi.guaranteedCapacityPercent*numSlots/100);\n}\n{code}\ni.e. if there is a difference in slots, we don't compute the differential, but rather the actual capacity. Does this seem right ?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-08T11:18:59.364+0000","updated":"2008-10-08T11:18:59.364+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12637879","id":"12637879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"BTW, I observed some odd behavior of java with the current code. I am sure there are good explanations, but it was just counter intuitive.\n\nFor e.g.\n{code}\nif (slotsDiff != 0) {\n  qsi.guaranteedCapacity +=\n    qsi.guaranteedCapacityPercent*slotsDiff/100;\n}\n{code}\nhas the following type of expression: {{int += float*int/100}}. I expected this to actually be a compile time error, because of the loss in precision. Indeed, {{int = float*int/100}} does give a compile time error.\n\nAlso, in the {{QueueComparator}} class, we have the following expression:\n{code}\ndouble r1 = (double)q1.numRunningTasks/(double)q1.guaranteedCapacity;\ndouble r2 = (double)q2.numRunningTasks/(double)q2.guaranteedCapacity;\n{code}\n\nI thought this would give a divide by zero somewhere. However, because of the cast to double, this works fine, and the result is two NaN or Infinite numbers, which when compared returned -1.\n\nBecause it is not fully explained, the simple fix I've proposed above may not be complete. I will continue to see if there are more gotchas involving guaranteed capacity.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-08T11:31:00.869+0000","updated":"2008-10-08T11:31:00.869+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12637881","id":"12637881","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"Simple patch that implements the proposed change to guaranteed capacity computation. With this, Karam verified that the capacities are shown properly now. Attaching this patch, just to enable QA to move forward.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-08T11:43:29.226+0000","updated":"2008-10-08T11:43:29.226+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12638591","id":"12638591","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vivekr","name":"vivekr","key":"vivekr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vivek Ratan","active":true,"timeZone":"Etc/UTC"},"body":"bq. f there is a difference in slots, we don't compute the differential, but rather the actual capacity. Does this seem right ?\n\nThis seems right. Recompute the GC for each queue, if the total cluster capacity has changed. \n\nbq. I thought this would give a divide by zero somewhere.\n\nGC for a queue really houldn't be zero. Maybe we should ensure that in _CapacityTaskScheduler.start()_. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vivekr","name":"vivekr","key":"vivekr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vivek Ratan","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-10T17:10:08.344+0000","updated":"2008-10-10T17:10:08.344+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12638747","id":"12638747","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"The new patch preserves the change done in the first one, and makes two additional changes:\n\n- It modifies the queue comparator so that queues which do not have a Guaranteed capacity come to the end of the list of queues\n- No jobs are picked from a queue that does not have a guaranteed capacity.\n\nIt adds a test case that tests that GC is correctly computed, and jobs are not assigned if GCs are zero for a queue.\n\nVivek, when the cluster is starting up and TTs are reporting in, based on the percentage, GC for a queue could be zero. This is a transient condition, and we can just make sure that we don't consider such a queue for assignment of tasks. My rationale is if a queue doesn't have capacities, it cannot get tasks.\n\nLet me know if this makes sense.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-11T12:45:52.138+0000","updated":"2008-10-11T12:45:52.138+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639021","id":"12639021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Few comments. We can\n - stop looking at more queues once we spot a queue with zero guaranteed capacity, in TaskSchedulingMgr.assignTasks. This works because of the ordering of queues.\n - also skip queues with on zero capacities in TaskSchedulingMgr.reclaimCapacity. This can avoid some unnecessary comparisons.\n - have a check for queues with zero capacity *percentages*. This is perhaps what Vivek intended.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-10-13T11:11:04.247+0000","updated":"2008-10-13T11:11:04.247+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639140","id":"12639140","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"I incorporated the first two comments. \n\nThe last one I've not done. One reason is that a check for capacity percentages is already done in HADOOP-4178 which is committed to trunk. Unfortunately, it does not check for zero capacities. Hence two patches will need to be generated to handle this - one for Hadoop 0.19, and one for trunk. Since it is only error handling, I am thinking it is not worth that much effort.\n\nThe second is, specifying a value of zero for guaranteed capacity, along with this patch, I think makes a nice way to disable a queue. Arguably, this is better done by explicitly having a configuration parameter for enabling / disabling a queue. But until that comes, I am thinking this is a nice side effect to have.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-13T18:05:32.896+0000","updated":"2008-10-13T18:05:32.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639354","id":"12639354","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Zero percentages can be handled later. +1 for the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-10-14T09:10:48.578+0000","updated":"2008-10-14T09:10:48.578+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639834","id":"12639834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"Results of test-patch:\n\n     [exec] +1 overall.\n\n     [exec]     +1 @author.  The patch does not contain any @author tags.\n\n     [exec]     +1 tests included.  The patch appears to include 3 new or modified tests.\n\n     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n     [exec]     +1 Eclipse classpath. The patch retains Eclipse classpath integrity.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-15T13:14:39.594+0000","updated":"2008-10-15T13:14:39.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639839","id":"12639839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"body":"Since this patch touches only capacity scheduler, I ran contrib tests, and all of them have passed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yhemanth","name":"yhemanth","key":"yhemanth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hemanth Yamijala","active":true,"timeZone":"Asia/Kolkata"},"created":"2008-10-15T13:31:21.348+0000","updated":"2008-10-15T13:31:21.348+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639940","id":"12639940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12392023/HADOOP-4373.patch\n  against trunk revision 704818.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3466/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3466/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3466/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3466/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-15T19:35:19.800+0000","updated":"2008-10-15T19:35:19.800+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12639949","id":"12639949","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"body":"I just committed this. Thanks, Hemanth!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-10-15T20:18:03.498+0000","updated":"2008-10-15T20:18:03.498+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405994/comment/12640199","id":"12640199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-trunk #635 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/635/])\n    HADOOP-4426. TestCapacityScheduler broke due to the two commits HADOOP-4053 and . This patch fixes that. Contributed by Hemanth Yamijala.\n. Fix calculation of Guaranteed Capacity for the capacity-scheduler. Contributed by Hemanth Yamijala.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-16T15:55:49.756+0000","updated":"2008-10-16T15:55:49.756+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-4373/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0i7tb:"}}