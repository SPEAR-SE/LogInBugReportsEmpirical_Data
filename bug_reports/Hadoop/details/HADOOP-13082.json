{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12964706","self":"https://issues.apache.org/jira/rest/api/2/issue/12964706","key":"HADOOP-13082","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/7","id":"7","description":"Later","name":"Later"},"customfield_12312322":null,"customfield_12310220":"2016-05-04T13:00:50.381+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon May 09 15:46:40 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_516033347_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-05-09T15:46:40.045+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-13082/watchers","watchCount":4,"isWatching":false},"created":"2016-05-03T16:26:06.751+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315569","id":"12315569","description":"","name":"0.23.0","archived":false,"released":true,"releaseDate":"2011-11-11"}],"issuelinks":[{"id":"12465581","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12465581","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12509487","key":"HADOOP-7363","self":"https://issues.apache.org/jira/rest/api/2/issue/12509487","fields":{"summary":"TestRawLocalFileSystemContract is needed","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/6","id":"6","description":"A new unit, integration or system test.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/requirement.png","name":"Test","subtask":false}}}},{"id":"12465677","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12465677","type":{"id":"12310050","name":"Regression","inward":"is broken by","outward":"breaks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310050"},"inwardIssue":{"id":"12660943","key":"HADOOP-9805","self":"https://issues.apache.org/jira/rest/api/2/issue/12660943","fields":{"summary":"Refactor RawLocalFileSystem#rename for improved testability.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-08-02T14:35:47.490+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310689","id":"12310689","name":"fs","description":"Generic FileSystem code"}],"timeoriginalestimate":null,"description":"FileSystemContractBaseTest#testRenameFileMoveToNonExistentDirectory: creates a file then move it to a non-existing directory. It should fail but it will not (with RawLocalFileSystem) because in RawLocalFileSystem#rename(Path, Path) method we have a fallback behavior that accomplishes the rename by a full copy. The full copy will create the new directory and copy the file there.\n\nI see two possible solutions here:\n# Remove the fallback full copy behavior\n# Before full cp we should check whether the parent directory exists or not. If not return false an do not do the full copy.\n\nThe fallback logic was added by HADOOP-9805.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"RawLocalFileSystem does not fail when moving file to a non-existing directory","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15269014","id":"15269014","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"body":"[~stevel@apache.org] [~mattf] [~arpitagarwal],\nKindly advise.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"created":"2016-05-03T16:37:32.894+0000","updated":"2016-05-03T16:37:32.894+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15270580","id":"15270580","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"good catch —and very good for finding the root cause, as it means that if it is the problem, then its only in the not-yet-shipped 2.8+ code.\n\nI think the fallback logic is there for cross volume rename; if I have two volumes mounted on the FS, /mnt/v1 and /mnt/v2, then a {{rename(\"/mnt/v1/file.txt\", \"/mnt/v2/\")} can only work with copy. Should we support that? I'm not sure now, after all, the raw OS doesn't do this, does it?\n\nAt the very least, the fallback code must do that directory existence check, as you suggested.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2016-05-04T13:00:50.381+0000","updated":"2016-05-04T13:00:50.381+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15271503","id":"15271503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"HADOOP-9805 is mostly just a refactoring of a patch I wrote for HADOOP-9507 to provide POSIX-like behavior on Windows by allowing full replacement of a destination directory if it's empty.  I think the only logical difference of HADOOP-9805 is that it added an explicit check for running on Windows.  I'd be surprised if HADOOP-9805 introduced the problem.\n\nI don't think either HADOOP-9507 or HADOOP-9805 are the root cause of the current problem though.  Instead, I think the behavior you see is a result of the final {{FileUtil#copy}} call.  That line of code goes waaaay back.  (I stopped digging through the git log at 2008, but the code even pre-dates that.)\n\nWe have to assume that there are wide ecosystem dependencies on this behavior for {{RawLocalFileSystem}}, so I don't think it's realistic to change that behavior right now.  This is different from HDFS semantics, where the rename would fail.  The contract tests are largely derived from HDFS semantics.  The local file system is an unusual one-off in several ways, and clients have different expectations for its semantics compared to HDFS or an alternative Hadoop-compatible file system.\n\nTo address this test failure, I think it would be appropriate for the test suite subclass to override {{testRenameFileMoveToNonExistentDirectory}} and annotate it with {{@Ignore}}.  The semantics exercised by the test are not applicable to the local file system, so it makes sense to skip it.  Alternatively, we could introduce another contract flag to control the test's behavior.  I think that would be overkill though, because I'm pretty sure this is going to be a one-off for the local file system.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-04T21:55:46.513+0000","updated":"2016-05-04T21:55:46.513+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15272089","id":"15272089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"body":"[~stevel@apache.org], [~cnauroth],\n\nThank you guys for getting back to me.\n\nFirst of all, yes, fallback logic was added way before HADOOP-9805.\n\nI looked into it a bit deeper and it seems this rename situation is not that simple. We have 9 methods in FileSystemContractBaseTest which is broken and 6 of 9 is broken by fallback logic.\nI have a small list about it (it was my notes during the debugging):\n{code}testRenameFileMoveToNonExistentDirectory\n\tFallback creates the missing directory\ntestRenameDirectoryAsExistingFile\n\tMove fails but fallback behavior throws exception. Test expects only a false\ntestRenameDirectoryMoveToNonExistentDirectory\n\tFallback creates the missing directory\ntestRenameChildDirForbidden\n\tFallback will throw an exception (cannot copy x to ist subdirectory y) but contract expects just a false\ntestMoveDirUnderParent\n\trenameTo return false (which is good) but fallback throws exception while test does not expect exception\ntestRenameNonExistentPath\n\trename returns with false but fallback throws exception\n{code}\n\nbq. I'm not sure now, after all, the raw OS doesn't do this, does it?\nYes, it does. In case of one volume mv command do just a rename. The inode will not change. In case of multi-volume the OS does a copy-delete.\n\nI checked Jakarta IO commons and Guava how do they handle this and they use the same solution as we do in RawLocalFileSystem (if renameTo false, do a copy-delete). It is not good for us because we do not know why the renameTo returned false (so we can't decide whether the false was returned due to cross-volume move or other problem).\nFrom JDK 7 a new method was introduced. [Files.move|https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#move%28java.nio.file.Path,%20java.nio.file.Path,%20java.nio.file.CopyOption...%29] do more or less the same as renameTo and it handles the cross-volume situation.\n\nNow I am confused what to do:\n# Skip this one and solve others\n# Skip all the rename related contracts\n# Solve all the broken contracts with FileUtil#copy\n# Solve all the contracts with [Files.move|https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#move%28java.nio.file.Path,%20java.nio.file.Path,%20java.nio.file.CopyOption...%29]\n# Other\n\nWhat do you guys think?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"created":"2016-05-05T08:54:15.339+0000","updated":"2016-05-05T08:54:15.339+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15272168","id":"15272168","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"\nShort term, lets skip those tests. As {{FileSystemContractBaseTest}} is a Junit 3 test, it can't be @Ignored; you have to just override those test cases with empty ones...it doesn't show up in the test reporter.\n\nOther things to note\n\n# really FS.rename() should follow the semantics of the posix {{rename()}} command [http://pubs.opengroup.org/onlinepubs/9699919799/functions/rename.html] *not that of {{mv}}*. \n# HDFS doesn't quite get it right\n# an other things vary\n\nThis is something we allude to in the filesystem.md specification file [http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/filesystem/filesystem.html].\n\nLooking at it, it actually calls out what HDFS does compared to Local FS, stating \"this is what happens\". I didn't look into the details of why locafs was doing that when I wrote that doc and the contract tests, just mentioned it happened and added a flag for the contract tests {{\"rename-creates-dest-dirs\"}}, which should be set to indicate behaviour.\n\n\nShort term: just set that option in the contract-test-options XML file to get through the tests.\n\nMid term: we do need to look at this; moving to java 7 IO would be a start ... there's a JIRA there which nobody has every fully addressed. Maybe that'll be something to work on *after* getting all these tests in.\n\n(BTW: thanks for your due diligence in determining the history of this feature and what other code gets up to —your thoroughness is appreciated)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2016-05-05T10:30:03.862+0000","updated":"2016-05-05T10:30:03.862+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15272332","id":"15272332","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"body":"Thanks for your reply. I will skip rename related tests now.\nbq. just set that option in the contract-test-options XML file to get through the tests\nI do not really understand this. \"rename-creates-dest-dirs\" are set  correctly now in either in localfs.xml or rawlocal.xml. I can't find contract-test-options.\n\nWhich do you think the best resolution for this JIRA? \"Later\" maybe?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"created":"2016-05-05T13:39:12.370+0000","updated":"2016-05-05T13:39:12.370+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15272899","id":"15272899","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. I do not really understand this. \"rename-creates-dest-dirs\" are set correctly now in either in localfs.xml or rawlocal.xml. I can't find contract-test-options.\n\nI think the issue may be that the failure is in {{FileSystemContractBaseTest}}.  This is a \"contract\" test suite, but it predates the larger contract test framework that Steve wrote, so it doesn't respect the contract options like rename-creates-dest-dirs.\n\nShort-term, I think skipping via a subclass override makes sense.  Longer term, perhaps we need to look at consolidating all test suites named \"Contract\" back into the larger contract test framework.  There is likely some redundancy between the test cases, and eliminating the redundancy might improve test execution times.\n\nAs far as this JIRA, I agree with resolving it as Later.  I don't anticipate being able to change this behavior of {{RawLocalFileSystem}} any time soon because of the downstream ecosystem dependencies.\n\nEchoing Steve's comment, thank you very much for digging into this.  Semantic differences across the different file systems are tricky issues.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cnauroth","name":"cnauroth","key":"cnauroth","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"},"displayName":"Chris Nauroth","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-05-05T19:18:17.277+0000","updated":"2016-05-05T19:18:17.277+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12964706/comment/15276531","id":"15276531","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"body":"Thanks for both of your help. I am closing this JIRA with Later resolution.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boky01","name":"boky01","key":"boky01","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=boky01&avatarId=29244","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=boky01&avatarId=29244","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=boky01&avatarId=29244","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=boky01&avatarId=29244"},"displayName":"Andras Bokor","active":true,"timeZone":"Europe/Budapest"},"created":"2016-05-09T15:46:40.083+0000","updated":"2016-05-09T15:46:40.083+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-13082/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2x40n:"}}