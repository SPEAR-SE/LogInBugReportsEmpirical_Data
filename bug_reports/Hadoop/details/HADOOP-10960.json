{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12733384","self":"https://issues.apache.org/jira/rest/api/2/issue/12733384","key":"HADOOP-10960","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12312322":null,"customfield_12310220":"2014-08-12T05:11:57.244+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Aug 12 05:35:18 UTC 2014","customfield_12310420":"411412","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_5923176_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2014-08-12T05:11:57.209+0000","workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10960/watchers","watchCount":3,"isWatching":false},"created":"2014-08-12T03:33:14.080+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":"2.2,redhat,crash","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":604800,"aggregatetimeoriginalestimate":604800,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12325048","id":"12325048","description":"2.2.0 release","name":"2.2.0","archived":false,"released":true,"releaseDate":"2013-10-15"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-08-12T05:35:18.688+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":604800,"description":"I am running hadoop2.2 on redhat6.3-6.5,and all of my machines crashed after a while. /var/log/messages shows repeatedly:\n\nAug 11 06:30:42 jn4_73_128 kernel: BUG: soft lockup - CPU#1 stuck for 67s! [jsvc:11508]\nAug 11 06:30:42 jn4_73_128 kernel: Modules linked in: bridge stp llc iptable_filter ip_tables mptctl mptbase xfs exportfs power_meter microcode dcdbas serio_raw iTCO_w\ndt iTCO_vendor_support i7core_edac edac_core sg bnx2 ext4 mbcache jbd2 sd_mod crc_t10dif wmi mpt2sas scsi_transport_sas raid_class dm_mirror dm_region_hash dm_log dm_m\nod [last unloaded: scsi_wait_scan]\nAug 11 06:30:42 jn4_73_128 kernel: CPU 1 \nAug 11 06:30:42 jn4_73_128 kernel: Modules linked in: bridge stp llc iptable_filter ip_tables mptctl mptbase xfs exportfs power_meter microcode dcdbas serio_raw iTCO_w\ndt iTCO_vendor_support i7core_edac edac_core sg bnx2 ext4 mbcache jbd2 sd_mod crc_t10dif wmi mpt2sas scsi_transport_sas raid_class dm_mirror dm_region_hash dm_log dm_m\nod [last unloaded: scsi_wait_scan]\nAug 11 06:30:42 jn4_73_128 kernel: \nAug 11 06:30:42 jn4_73_128 kernel: Pid: 11508, comm: jsvc Tainted: G        W  ---------------    2.6.32-279.el6.x86_64 #1 Dell Inc. PowerEdge R510/084YMW\nAug 11 06:30:42 jn4_73_128 kernel: RIP: 0010:[<ffffffff8104d088>]  [<ffffffff8104d088>] wait_for_rqlock+0x28/0x40\nAug 11 06:30:42 jn4_73_128 kernel: RSP: 0018:ffff8807786c3ee8  EFLAGS: 00000202\nAug 11 06:30:42 jn4_73_128 kernel: RAX: 00000000f6e9f6e1 RBX: ffff8807786c3ee8 RCX: ffff880028216680\nAug 11 06:30:42 jn4_73_128 kernel: RDX: 00000000fffff6e9 RSI: ffff88061cd29370 RDI: 0000000000000286\nAug 11 06:30:42 jn4_73_128 kernel: RBP: ffffffff8100bc0e R08: 0000000000000001 R09: 0000000000000001\nAug 11 06:30:42 jn4_73_128 kernel: R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000286\nAug 11 06:30:42 jn4_73_128 kernel: R13: ffff8807786c3eb8 R14: ffffffff810e0f6e R15: ffff8807786c3e48\nAug 11 06:30:42 jn4_73_128 kernel: FS:  0000000000000000(0000) GS:ffff880028200000(0000) knlGS:0000000000000000\nAug 11 06:30:42 jn4_73_128 kernel: CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nAug 11 06:30:42 jn4_73_128 kernel: CR2: 0000000000e5bd70 CR3: 0000000001a85000 CR4: 00000000000006e0\nAug 11 06:30:42 jn4_73_128 kernel: DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nAug 11 06:30:42 jn4_73_128 kernel: DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400\nAug 11 06:30:42 jn4_73_128 kernel: Process jsvc (pid: 11508, threadinfo ffff8807786c2000, task ffff880c1def3500)\nAug 11 06:30:42 jn4_73_128 kernel: Stack:\nAug 11 06:30:42 jn4_73_128 kernel: ffff8807786c3f68 ffffffff8107091b 0000000000000000 ffff8807786c3f28\nAug 11 06:30:42 jn4_73_128 kernel: <d> ffff880701735260 ffff880c1def39c8 ffff880c1def39c8 0000000000000000\nAug 11 06:30:42 jn4_73_128 kernel: <d> ffff8807786c3f28 ffff8807786c3f28 ffff8807786c3f78 00007f092d0ad700\nAug 11 06:30:42 jn4_73_128 kernel: Call Trace:\nAug 11 06:30:42 jn4_73_128 kernel: [<ffffffff8107091b>] ? do_exit+0x5ab/0x870\nAug 11 06:30:42 jn4_73_128 kernel: [<ffffffff81070ce7>] ? sys_exit+0x17/0x20\nAug 11 06:30:42 jn4_73_128 kernel: [<ffffffff8100b0f2>] ? system_call_fastpath+0x16/0x1b\nAug 11 06:30:42 jn4_73_128 kernel: Code: ff ff 90 55 48 89 e5 0f 1f 44 00 00 48 c7 c0 80 66 01 00 65 48 8b 0c 25 b0 e0 00 00 0f ae f0 48 01 c1 eb 09 0f 1f 80 00 00 00 00 <f3> 90 8b 01 89 c2 c1 fa 10 66 39 c2 75 f2 c9 c3 0f 1f 84 00 00 \nAug 11 06:30:42 jn4_73_128 kernel: Call Trace:\nAug 11 06:30:42 jn4_73_128 kernel: [<ffffffff8107091b>] ? do_exit+0x5ab/0x870\nAug 11 06:30:42 jn4_73_128 kernel: [<ffffffff81070ce7>] ? sys_exit+0x17/0x20\nAug 11 06:30:42 jn4_73_128 kernel: [<ffffffff8100b0f2>] ? system_call_fastpath+0x16/0x1b\n</em>\nand finally crashed\n\ncrash /usr/lib/debug/lib/modules/2.6.32-431.5.1.el6.x86_64/vmlinux  /opt/crash/127.0.0.1-2014-08-10-09\\:47\\:38/vmcore\n\ncrash 6.1.0-5.el6\nCopyright (C) 2002-2012  Red Hat, Inc.\nCopyright (C) 2004, 2005, 2006, 2010  IBM Corporation\nCopyright (C) 1999-2006  Hewlett-Packard Co\nCopyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited\nCopyright (C) 2006, 2007  VA Linux Systems Japan K.K.\nCopyright (C) 2005, 2011  NEC Corporation\nCopyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.\nCopyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.\nThis program is free software, covered by the GNU General Public License,\nand you are welcome to change it and/or distribute copies of it under\ncertain conditions.  Enter \"help copying\" to see the conditions.\nThis program has absolutely no warranty.  Enter \"help warranty\" for details.\n\nGNU gdb (GDB) 7.3.1\nCopyright (C) 2011 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-unknown-linux-gnu\"...\n\nplease wait... (determining panic task)         \nWARNING: active task ffff881071850040 on cpu 12 not found in PID hash\n\n      KERNEL: /usr/lib/debug/lib/modules/2.6.32-431.5.1.el6.x86_64/vmlinux\n    DUMPFILE: /opt/crash/127.0.0.1-2014-08-10-09:47:38/vmcore  [PARTIAL DUMP]\n        CPUS: 24\n        DATE: Sun Aug 10 09:47:32 2014\n      UPTIME: 7 days, 16:00:19\nLOAD AVERAGE: 11.01, 3.11, 1.08\n       TASKS: 724\n    NODENAME: master1.otocyon.com\n     RELEASE: 2.6.32-431.5.1.el6.x86_64\n     VERSION: #1 SMP Fri Jan 10 14:46:43 EST 2014\n     MACHINE: x86_64  (1895 Mhz)\n      MEMORY: 64 GB\n       PANIC: \"Kernel panic - not syncing: Watchdog detected hard LOCKUP on cpu 0\"\n         PID: 23976\n     COMMAND: \"sh\"\n        TASK: ffff881071850aa0  [THREAD_INFO: ffff880a05c80000]\n         CPU: 0\n       STATE: TASK_INTERRUPTIBLE (PANIC)\n\ncrash> bt\nPID: 23976  TASK: ffff881071850aa0  CPU: 0   COMMAND: \"sh\"\n #0 [ffff880028207b50] machine_kexec at ffffffff81038f3b\n #1 [ffff880028207bb0] crash_kexec at ffffffff810c5d82\n #2 [ffff880028207c80] panic at ffffffff8152751a\n #3 [ffff880028207d00] watchdog_overflow_callback at ffffffff810e696d\n #4 [ffff880028207d20] __perf_event_overflow at ffffffff8111c847\n #5 [ffff880028207da0] perf_event_overflow at ffffffff8111ce14\n #6 [ffff880028207db0] intel_pmu_handle_irq at ffffffff81022d87\n #7 [ffff880028207e90] perf_event_nmi_handler at ffffffff8152bd69\n #8 [ffff880028207ea0] notifier_call_chain at ffffffff8152d825\n #9 [ffff880028207ee0] atomic_notifier_call_chain at ffffffff8152d88a\n#10 [ffff880028207ef0] notify_die at ffffffff810a153e\n#11 [ffff880028207f20] do_nmi at ffffffff8152b4eb\n\n\nIt happened on machines from different vendors,and I have tried to update to the latest kernel from redhat. Can anyone with the same experience help?","customfield_10010":null,"timetracking":{"originalEstimate":"168h","remainingEstimate":"168h","originalEstimateSeconds":604800,"remainingEstimateSeconds":604800},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":604800,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"411403","customfield_12312823":null,"summary":"hadoop cause system crash with “soft lock” and “hard lock”","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=linbao111","name":"linbao111","key":"linbao111","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"linbao111","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=linbao111","name":"linbao111","key":"linbao111","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"linbao111","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":604800,"percent":0},"customfield_12311024":null,"environment":"redhat rhel 6.3,6,4,6.5\njdk1.7.0_45\nhadoop2.2","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":604800,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12733384/comment/14093749","id":"14093749","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"body":"Hadoop core has no kernel mode components so it cannot cause a kernel panic. You likely have a buggy device driver or hit a kernel bug.\n\nResolving as Invalid.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=arpitagarwal","name":"arpitagarwal","key":"arpitagarwal","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arpit Agarwal","active":true,"timeZone":"America/Los_Angeles"},"created":"2014-08-12T05:11:57.244+0000","updated":"2014-08-12T05:11:57.244+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12733384/comment/14093762","id":"14093762","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbnote","name":"jbnote","key":"jbnote","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jean-Baptiste Note","active":true,"timeZone":"Etc/GMT"},"body":"We saw somthing very similar to this problem (among others) recurring on RHEL5.\nIt appears that the kernel, after an initial, legit, softlockup report (for instance because of IO contention), can go into a loop of reporting soft lockups and -- by the mere amount of data spewed -- lock itself to panic.\n\nFor us it was due to dumping data to the (relatively slow) serial console, for you it may be by dumping data to disk, which is presumably the cause for contention in your case.\n\nOnce you've cleared the way for real issues (controller problems, for instance), you may want to in vestigate one of the following:\n0) reduce kernel verbosity on the console (provided it reduces the amount of data dumped to /var/log/messages, i'm not familiar with your setup, we're remote logging everything)\n1) disable softlockup reboot\n2) disable disk logging of kernel messages / log to tmpfs / log to a separate, dedicated system *disk*\n\nHTH","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbnote","name":"jbnote","key":"jbnote","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jean-Baptiste Note","active":true,"timeZone":"Etc/GMT"},"created":"2014-08-12T05:35:18.688+0000","updated":"2014-08-12T05:35:18.688+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10960/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1ys2v:"}}