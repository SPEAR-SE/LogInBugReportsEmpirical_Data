{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12635732","self":"https://issues.apache.org/jira/rest/api/2/issue/12635732","key":"HADOOP-9377","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-03-07T06:21:54.658+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Sep 29 05:21:16 UTC 2014","customfield_12310420":"316224","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-9377/watchers","watchCount":7,"isWatching":false},"created":"2013-03-07T05:43:42.144+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["BB2015-05-TBR"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323273","id":"12323273","description":"2.0.3-alpha release","name":"2.0.3-alpha","archived":false,"released":true,"releaseDate":"2013-02-14"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-06T03:26:19.832+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310689","id":"12310689","name":"fs","description":"Generic FileSystem code"}],"timeoriginalestimate":null,"description":"FTPFileSystem.listStatus() calls\ngetFileStatus(ftpFiles[i], absolute) calls\nnew FileStatus(....) calls \nfilePath.makeQualified(...) calls\nfs.getWorkingDirectory() calls\ngetHomeDirectory()\n\nwhich creates new FTP connection every time, to get the workdingDirectory. this caused the FTPFileSystem.listStatus() takes long time to run (on average 3-6 seconds per file in my test).\n\nI attach a suggestion of fix in FTPFileSystem.java, only 4 lines of change. after the fix, there's no slowness issue anymore.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12572490","id":"12572490","filename":"HADOOP-9377.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T05:45:21.478+0000","size":1732,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12572490/HADOOP-9377.diff"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"316567","customfield_12312823":null,"summary":"FTPFileSystem.listStatus() runs very slow, due to inappropriate call of filePath.makeQualified","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595568","id":"13595568","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"body":"suggestion of code fix.\n\n\n\n\n\n\nsvn diff\nIndex: src/main/java/org/apache/hadoop/fs/ftp/FTPFileSystem.java\n===================================================================\n--- src/main/java/org/apache/hadoop/fs/ftp/FTPFileSystem.java\t(revision 1453599)\n+++ src/main/java/org/apache/hadoop/fs/ftp/FTPFileSystem.java\t(working copy)\n@@ -380,7 +380,7 @@\n     FTPFile[] ftpFiles = client.listFiles(absolute.toUri().getPath());\n     FileStatus[] fileStats = new FileStatus[ftpFiles.length];\n     for (int i = 0; i < ftpFiles.length; i++) {\n-      fileStats[i] = getFileStatus(ftpFiles[i], absolute);\n+      fileStats[i] = getFileStatus(ftpFiles[i], absolute, workDir);\n     }\n     return fileStats;\n   }\n@@ -422,7 +422,7 @@\n     if (ftpFiles != null) {\n       for (FTPFile ftpFile : ftpFiles) {\n         if (ftpFile.getName().equals(file.getName())) { // file found in dir\n-          fileStat = getFileStatus(ftpFile, parentPath);\n+          fileStat = getFileStatus(ftpFile, parentPath, workDir);\n           break;\n         }\n       }\n@@ -442,7 +442,7 @@\n    * @param parentPath\n    * @return FileStatus\n    */\n-  private FileStatus getFileStatus(FTPFile ftpFile, Path parentPath) {\n+  private FileStatus getFileStatus(FTPFile ftpFile, Path parentPath, Path workDir) {\n     long length = ftpFile.getSize();\n     boolean isDir = ftpFile.isDirectory();\n     int blockReplication = 1;\n@@ -456,7 +456,7 @@\n     String group = ftpFile.getGroup();\n     Path filePath = new Path(parentPath, ftpFile.getName());\n     return new FileStatus(length, isDir, blockReplication, blockSize, modTime,\n-        accessTime, permission, user, group, filePath.makeQualified(this));\n+        accessTime, permission, user, group, filePath.makeQualified(this.getUri(), workDir));\n   }\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T05:45:21.482+0000","updated":"2013-03-07T05:45:21.482+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595595","id":"13595595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"James, just posting the diff as attachment is sufficient. Also when you wan to post code snippets, you could surround it with \\{code\\}\\{code\\} to format it as code. See for details - https://issues.apache.org/jira/secure/WikiRendererHelpAction.jspa?section=texteffects (or click the question mark below the comment box)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T06:21:54.658+0000","updated":"2013-03-07T06:21:54.658+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595596","id":"13595596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12572490/HADOOP-9377.diff\n  against trunk revision .\n\n    {color:red}-1 patch{color}.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/2286//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-07T06:22:19.022+0000","updated":"2013-03-07T06:22:19.022+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595619","id":"13595619","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"I looked into this a bit, the slowness is probably because of the call to {{fs#getWorkingDirectory}} inside makeQualified:\n\n{code}\n  @Deprecated\n  public Path makeQualified(FileSystem fs) {\n    return makeQualified(fs.getUri(), fs.getWorkingDirectory());\n  }\n{code}\n\nLooking in {{FTPFileSystem#getWorkingDirectory}}, this is kind of a bogus call, since it returns the user's home directory, which involves connecting to the FTP server (slow!). So, unless people are depending on their relative paths being qualified with their home dir, the behavior in the posted patch should be fine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T06:59:15.194+0000","updated":"2013-03-07T06:59:15.194+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595621","id":"13595621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"body":"yes, actually in the attached patch file, I put a suggested fix, to pass the WorkingDirectory from caller method.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jym2307","name":"jym2307","key":"jym2307","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Yu","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T07:01:38.686+0000","updated":"2013-03-07T07:01:38.686+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595648","id":"13595648","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. the behavior in the posted patch should be fine.\nMy cursory look at the patch, I came to the same conclusion. What I did not have time to finish was, should FTPFileSystem be caching home directory from the time of the creation and not use remote connection to get that information at all.\n\nThoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T07:41:18.041+0000","updated":"2013-03-07T07:41:18.041+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13595713","id":"13595713","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"Do we have any tests for this FS yet?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2013-03-07T09:25:14.309+0000","updated":"2013-03-07T09:25:14.309+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13596124","id":"13596124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dcapwell","name":"dcapwell","key":"dcapwell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Capwell","active":true,"timeZone":"Etc/UTC"},"body":"Seeing how you cant set the home dir, nor should it be mutable via another service (since it would have been set for the session), cacheing the home dir would be safe to do.  Even if the home dir is cached, most of the ftp logic still would require the current state of WD (setWD is stubbed out, but might be implemented in the future).  If you go with the solution in the patch to pass the WD that was used during the list operation, you would future prof this call.  Example, if you list a dir with 3k files in it and another thread updates the WD, this would cause list to now use the wrong WD (locking would solve this) for part of the files; passing the known WD would be safer.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dcapwell","name":"dcapwell","key":"dcapwell","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Capwell","active":true,"timeZone":"Etc/UTC"},"created":"2013-03-07T18:08:58.365+0000","updated":"2013-03-07T18:08:58.365+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/13596310","id":"13596310","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"body":"Reading in more, the semantics for this filesystem are rather loose, since we create a new FTPClient within each of the public FileSystem methods. Thus, there's no persistent concept of a working directory, and everything relies on absolute paths. Seems like FTPFileSystem could use some love beyond this JIRA.\n\nSince the current working directory can be gotten from {{FTPClient#printWorkingDirectory}}, I think we could simply use that in {{getFileStatus}} without passing in a separate {{workDir}} parameter.\n\n[~sureshms] I think we can cache the home dir, we just need to set it in {{initialize()}}. I don't think homedirs don't change often, if at all, so pretty safe.\n\n[~stevel@apache.org] Poking in the test directory, I see no tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.wang","name":"andrew.wang","key":"andrew.wang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.wang&avatarId=19230","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.wang&avatarId=19230","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.wang&avatarId=19230","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.wang&avatarId=19230"},"displayName":"Andrew Wang","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-07T20:13:46.537+0000","updated":"2013-03-07T20:13:46.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/14151368","id":"14151368","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lalosam369","name":"lalosam369","key":"lalosam369","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eduardo Samano","active":true,"timeZone":"Etc/UTC"},"body":"Is there some reason to not solve this issue at version 2.4 ?\n\nThe workingDirectory feature continue unimplemented and the listStatus is very slow. It doesn't work. I need to list a folder with more than 2000 files and it takes several hours. No way.\n\nAdd a new parameter in getFileStatus avoid to brake something in the future when workingDirectory be implemented. And it imply that the app only query the workingDirectory once in each listStatus execution (instead by file).\n\nBut don't cache the workingDirectory in the initialize() method doesn't have sense. At the end getHomeDirectory query the workingDirectory, then if the workingDirectory feature is implemented in a future, it should be necessary reimplement the getHomeDirectory method and all the methods that depend on it.\n\nCache the workingDirectory is a quick and enough solution, and with less impact that have an useless implementation. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lalosam369","name":"lalosam369","key":"lalosam369","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eduardo Samano","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-29T05:10:51.975+0000","updated":"2014-09-29T05:10:51.975+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635732/comment/14151374","id":"14151374","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12572490/HADOOP-9377.diff\n  against trunk revision b38e52b.\n\n    {color:red}-1 patch{color}.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/4824//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-29T05:21:16.289+0000","updated":"2014-09-29T05:21:16.289+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-9377/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1ikev:"}}