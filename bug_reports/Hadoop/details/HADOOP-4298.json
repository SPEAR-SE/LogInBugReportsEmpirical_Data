{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12405341","self":"https://issues.apache.org/jira/rest/api/2/issue/12405341","key":"HADOOP-4298","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2008-09-29T23:03:27.466+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Oct 17 23:13:28 UTC 2008","customfield_12310420":"38792","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_1386744596_*|*_1_*:*_2_*:*_157898949_*|*_6_*:*_1_*:*_0_*|*_5_*:*_2_*:*_3016409182_*|*_4_*:*_1_*:*_62032","customfield_12312321":null,"resolutiondate":"2008-10-17T23:13:28.519+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-4298/watchers","watchCount":3,"isWatching":false},"created":"2008-09-29T04:21:51.059+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313357","id":"12313357","description":"","name":"0.18.1","archived":false,"released":true,"releaseDate":"2008-09-17"}],"issuelinks":[{"id":"12321868","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12321868","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12405505","key":"HADOOP-4319","self":"https://issues.apache.org/jira/rest/api/2/issue/12405505","fields":{"summary":"fuse-dfs dfs_read function may return less than the requested #of bytes even if EOF not reached","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12321996","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12321996","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12406238","key":"HADOOP-4397","self":"https://issues.apache.org/jira/rest/api/2/issue/12406238","fields":{"summary":"fuse-dfs causes corruptions on multi-threaded access","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12321866","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12321866","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12400514","key":"HADOOP-3784","self":"https://issues.apache.org/jira/rest/api/2/issue/12400514","fields":{"summary":"Cleanup optimization of reads and change it to a flag and remove #ifdefs","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T17:05:04.907+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I pulled a 5GB data file into Hadoop using the following command:\nhadoop fs -put /scratch/886B9B3D-6A85-DD11-A9AB-000423D6CA6E.root /user/brian/testfile\nI have HDFS mounted in /mnt/hadoop using fuse-dfs.\n\nHowever, when I try to md5sum the file in place (md5sum /mnt/hadoop) or copy the file back to local disk using \"cp\" then md5sum it, the checksum is incorrect.\n\nWhen I pull the file using normal hadoop means (hadoop fs -get /user/brian/testfile /scratch), the md5sum is correct.\n\nWhen I repeat the test with a smaller file (512MB, on the theory that there is a problem with some 2GB limit somewhere), the problem remains.\nWhen I repeat the test, the md5sum is consistently wrong - i.e., some part of the corruption is deterministic, and not the apparent fault of a bad disk.\n\nCentOs 4.6 is, unfortunately, not the apparent culprit.  When checking on CentOs 5.x, I could recreate the corruption issue.  The second node was also a 64-bit compile and CentOs 5.2 (`uname -r` returns 2.6.18-92.1.10.el5).\n\nThanks for looking into this,\nBrian","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12391315","id":"12391315","filename":"4298-patch-test.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T20:56:45.374+0000","size":60752,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12391315/4298-patch-test.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12391246","id":"12391246","filename":"HADOOP-4298.1.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T23:58:19.926+0000","size":3311,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12391246/HADOOP-4298.1.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"102593","customfield_12312823":null,"summary":"File corruption when reading with fuse-dfs","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"CentOs 4.6 final; kernel 2.6.9-67.ELsmp; FUSE 2.7.4; hadoop 0.18.1; 64-bit\n\nI hand-altered the fuse-dfs makefile to use 64-bit instead of the hardcoded -m32.","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635392","id":"12635392","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"body":"I wrote a small program this morning to do the file copies in C via libhdfs, thus bypassing fuse-dfs.\n\nThis resulted in no file corruption - seeming to indicate that the bug lies in fuse-dfs, not libhdfs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"created":"2008-09-29T14:32:13.776+0000","updated":"2008-09-29T14:32:13.776+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635566","id":"12635566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"body":"More debugging info.  This is definitely bad logic in the optimization block of fuse-ds, function dfs_read.  This most definitely would not work under any architecture.\n\nI turned on some of the debugging statements, and got the following:\n\nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 0 -> 10485760 (10485760 bytes). Check for offset 10199040 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10199040 in file \nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 0 -> 10485760 (10485760 bytes). Check for offset 10330112 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10330112 in file \nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 0 -> 10485760 (10485760 bytes). Check for offset 10461184 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10461184 in file \n\nPause here.  The contents of the cache are [0, 10485760]; however, we are trying to read 10461184 (in the cache) to 10461184+131072 (not in the cache!!!).\n\nNote that fuse-dfs serves this out of cache, and *does not* trigger a read!\n\nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 0 -> 10485760 (10485760 bytes). Check for offset 10592256 \nSep 29 17:27:03 node182 fuse_dfs: Reading /user/brian/test_helloworld4 from HDFS, offset 10592256, amount 10485760 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10592256 in file \n\nHere, we didn't load new info from the cache; so, the bytes in the range (10485760, 10592256) are taken as random junk from memory.\n\nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 10592256 -> 15600000 (5007744 bytes). Check for offset 10723328 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10723328 in file \nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 10592256 -> 15600000 (5007744 bytes). Check for offset 10854400 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10854400 in file \nSep 29 17:27:03 node182 fuse_dfs: Cache bounds for /user/brian/test_helloworld4: 10592256 -> 15600000 (5007744 bytes). Check for offset 10985472 \nSep 29 17:27:03 node182 fuse_dfs: FUSE requested 131072 bytes of /user/brian/test_helloworld4 for offset 10985472 in file \n\nI'm also pretty sure that reads greater than size 10MB (the size of the cache) are going to bust through the cache and again result in random junk.\n\nSomeone seriously needs to review the logic and corner conditions in this code.  I'll try to fix it myself and do a patch later, but no promises.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"created":"2008-09-29T22:39:25.559+0000","updated":"2008-09-29T22:39:25.559+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635578","id":"12635578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"body":"18.1 has already been released. Pushing to 0.18.2.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-09-29T23:03:27.466+0000","updated":"2008-09-29T23:03:27.466+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635637","id":"12635637","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"body":"Hey Owen, all,\n\nIn fuse_dfs.c, I replaced this line in function dfs_read:\n\n  if (fh->sizeBuffer == 0  || offset < fh->startOffset || offset > (fh->startOffset + fh->sizeBuffer)  )\n\nwith the following:\n\n  if (fh->sizeBuffer == 0  || offset < fh->startOffset || offset >= (fh->startOffset + fh->sizeBuffer) || (offset+size) >= (fh->startOffset + fh->sizeBuffer) )\n\nThis covers the bug I mentioned below.  I can now md5sum files successfully.  However, my application still complains of data corruption on reads (although it does make it further through the file!); the application, unlike md5sum, has a very random read pattern.\n\nOne possibility is that it is doing a huge read which would break through the buffer, or another undiscovered bug.  When I figure things out, I'll turn the above fix into a proper patch (although you are welcome to do it for me if you have time).\n\nHowever, I would prefer if the expert or original author took a peak at this code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"created":"2008-09-30T03:12:53.868+0000","updated":"2008-09-30T03:12:53.868+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635675","id":"12635675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"Hi Brian,\n\nthanks for looking into this. I will look at the code and try the change and test case you showed.  In version 18, you should be able to comment out #define OPTIMIZED_READS. Have you tried that and did it help? \n\nI didn't write this specific code but am fairly familiar with it and will look more carefully tomorrow.\n\nOne question - is this a single threaded application that is doing the reads? If not, this may be a problem with fuse-dfs not correctly interacting with the FileSystem filehandle cache.\n\npete\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T06:07:24.503+0000","updated":"2008-09-30T06:07:24.503+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635679","id":"12635679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"bq. I hand-altered the fuse-dfs makefile to use 64-bit instead of the hardcoded -m32.\n\nyou mean src/c++/llibhdfs/Makefile, right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T06:10:16.209+0000","updated":"2008-09-30T06:10:16.209+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635833","id":"12635833","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"bq. if (fh->sizeBuffer == 0 || offset < fh->startOffset || offset >= (fh->startOffset + fh->sizeBuffer))\n\nI think this is correct. it's just very conservative: if there's any data in the current buffer that can satisfy even 1 byte of the current request, then use that data before refilling  the buffer. The next call to read would then trigger offset > fh->startOffset.\n\nThis of course means that fuse-dfs is often returning less than the requested number of bytes.  Is this a problem for your application?\n\npete\n\n\n\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T20:09:45.423+0000","updated":"2008-09-30T20:09:45.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635834","id":"12635834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"bq. if (fh->sizeBuffer == 0 || offset < fh->startOffset || offset >= (fh->startOffset + fh->sizeBuffer))\n\nI think this is correct. it's just very conservative: if there's any data in the current buffer that can satisfy even 1 byte of the current request, then use that data before refilling  the buffer. The next call to read would then trigger offset > fh->startOffset.\n\nThis of course means that fuse-dfs is often returning less than the requested number of bytes.  Is this a problem for your application?\n\npete\n\n\n\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T20:09:54.608+0000","updated":"2008-09-30T20:09:54.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635845","id":"12635845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"looks like fuse itself doesn't like this.  let me look into this further\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T20:32:48.364+0000","updated":"2008-09-30T20:32:48.364+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635853","id":"12635853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"body":"Hey Pete - \n\nRegarding the comment on \"29/Sep/08 11:10 PM\": Yes, I misspoke.  I had adjusted -m64 in the libhdfs makefile.\n\nRegarding the later comment, \"30/Sep/08 01:09 PM\":  As you mention, FUSE appears to be unhappy with this behavior - I always get the asked-for number of bytes returned.\n\nBesides, in the unix definition of 'read' (http://www.opengroup.org/onlinepubs/000095399/functions/read.html), it states, regarding the return value:\n\n\"\"\"\nThis number shall never be greater than nbyte. The value returned may be less than nbyte if the number of bytes left in the file is less than nbyte, if the read() request was interrupted by a signal, or if the file is a pipe or FIFO or special file and has fewer than nbyte bytes immediately available for reading. For example, a read() from a file associated with a terminal may return one typed line of data.\n\"\"\"\n\nTo me, that means if there are more bytes in the file, you should give exactly nbytes; I guess I can see that if you have less than nbytes in the buffer, you could claim it meets the requirement \"fewer than nbyte bytes immediately available for reading\".\n\nI guess you still end up being stuck with the FUSE problem.\n\nRegarding exceptionally large reads (> 10MB): it might be a problem, but I can't trigger it locally.\n\nFinally, I think when my application failed last, I hadn't remounted the FS with the new code.  I tried it out this morning, and was pleased to see things work all the way through, no segfaults.\n\nThanks for the help.  This goes far in \"selling\" the idea of a new distributed file system to our sysadmins.\n\nBrian","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"created":"2008-09-30T20:55:08.215+0000","updated":"2008-09-30T20:55:08.215+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12635910","id":"12635910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"This fixes the problem as Brian did basically and adds a test case.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-09-30T23:58:19.956+0000","updated":"2008-09-30T23:58:19.956+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12636078","id":"12636078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12391246/HADOOP-4298.1.txt\n  against trunk revision 700628.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/3413/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T16:06:46.212+0000","updated":"2008-10-01T16:06:46.212+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12636171","id":"12636171","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"The patch command succeeds and testing passes for this component - there is some unrelated failure:\n hadoop-0.18.1 > grep FAIL ../4298-patch-test.txt \n    [junit] Test org.apache.hadoop.mapred.jobcontrol.TestLocalJobControl FAILED\nBUILD FAILED\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T20:56:45.405+0000","updated":"2008-10-01T20:56:45.405+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12636172","id":"12636172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"     [exec] +1 overall.  \n\n     [exec]     +1 @author.  The patch does not contain any @author tags.\n\n     [exec]     +1 tests included.  The patch appears to include 6 new or modified tests.\n\n     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-01T20:57:35.893+0000","updated":"2008-10-01T20:57:35.893+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12637673","id":"12637673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=craigm","name":"craigm","key":"craigm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Macdonald","active":true,"timeZone":"Etc/UTC"},"body":"Original code was mine.\n+1 on patch.\n\nC","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=craigm","name":"craigm","key":"craigm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Macdonald","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T22:00:31.075+0000","updated":"2008-10-07T22:00:31.075+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12637682","id":"12637682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=craigm","name":"craigm","key":"craigm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Macdonald","active":true,"timeZone":"Etc/UTC"},"body":"Pete,\n\nCan you confirm that this patch is only for 0.18 branch?\nHADOOP-4319 had the equivalent patch for trunk/0.20, as far as I can see.\n\nC","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=craigm","name":"craigm","key":"craigm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Macdonald","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-07T22:12:33.978+0000","updated":"2008-10-07T22:12:33.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12638292","id":"12638292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"body":"Bad news!\n\nI guess that, somewhere in our \"single-thread physics application\", a physicist stuck in a separate thread which does file system access.\n\nThis absolutely does cause problems with fuse-dfs: it appears that all the problems go away when I surround calls to dfs_read with a pthread mutex (still stress-testing things, however...).\n\nShould we add this to the task at hand, or open a new bug report?\n\nBrian","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bockelman","name":"bockelman","key":"bockelman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brian Bockelman","active":true,"timeZone":"America/Chicago"},"created":"2008-10-09T14:48:01.904+0000","updated":"2008-10-09T14:48:01.904+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12638925","id":"12638925","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"this is reading from the same file handle? \n\nI have looked some more at the DFSClient and it looks like everything is completely thread safe (but that was in trunk around the time of the 0.19 release).\n\nNow the libhdfs library should also be thread safe by design i believe, but I am not completely positive that all calls actually are.\n\npete\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-13T00:14:50.789+0000","updated":"2008-10-13T00:14:50.789+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12638928","id":"12638928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"bq. Can you confirm that this patch is only for 0.18 branch?\nyes - the one for 0.19 already got committed and i think i opened one for 0.20.\n\nThis is ready to commit.\n\nthanks, pete\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-13T00:37:54.476+0000","updated":"2008-10-13T00:37:54.476+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12640399","id":"12640399","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"HADOOP-4397 supersedes this one as it contains all the read and other concurrency problem fixes.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-17T01:11:13.320+0000","updated":"2008-10-17T01:11:13.320+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12640404","id":"12640404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"this fix is included in HADOOP-4397 as it fixes all read corruptions - from the buffer and from concurrency on the buffer.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-17T01:25:54.601+0000","updated":"2008-10-17T01:25:54.601+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12405341/comment/12640696","id":"12640696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"body":"opened again by accident","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wyckoff","name":"wyckoff","key":"wyckoff","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pete Wyckoff","active":true,"timeZone":"Etc/UTC"},"created":"2008-10-17T23:13:28.516+0000","updated":"2008-10-17T23:13:28.516+0000"}],"maxResults":22,"total":22,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-4298/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0hwwn:"}}