{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12464362","self":"https://issues.apache.org/jira/rest/api/2/issue/12464362","key":"HADOOP-6762","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323273","id":"12323273","description":"2.0.3-alpha release","name":"2.0.3-alpha","archived":false,"released":true,"releaseDate":"2013-02-14"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-06-03T06:39:25.860+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Dec 11 14:09:57 UTC 2012","customfield_12310420":"252","customfield_12312320":null,"customfield_12310222":"10002_*:*_4_*:*_73132668972_*|*_1_*:*_4_*:*_8360611856_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-12-10T21:26:01.577+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-6762/watchers","watchCount":16,"isWatching":false},"created":"2010-05-12T16:24:40.780+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"13.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314203","id":"12314203","description":"","name":"0.20.2","archived":false,"released":true,"releaseDate":"2010-02-16"}],"issuelinks":[{"id":"12364030","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12364030","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12618230","key":"HADOOP-9107","self":"https://issues.apache.org/jira/rest/api/2/issue/12618230","fields":{"summary":"Hadoop IPC client eats InterruptedException and sets interrupt on the thread which is not documented","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12368698","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12368698","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12645042","key":"HIVE-4436","self":"https://issues.apache.org/jira/rest/api/2/issue/12645042","fields":{"summary":"hive.exec.parallel=true doesn't work on hadoop-2","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12338108","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12338108","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12501652","key":"MAPREDUCE-2392","self":"https://issues.apache.org/jira/rest/api/2/issue/12501652","fields":{"summary":"TaskTracker shutdown in the tests sometimes take 60s","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12332308","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332308","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12464664","key":"HADOOP-6768","self":"https://issues.apache.org/jira/rest/api/2/issue/12464664","fields":{"summary":"RPC client can response more efficiently when sendParam() got IOException","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-09-03T23:11:04.882+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"If a single process creates two unique fileSystems to the same NN using FileSystem.newInstance(), and one of them issues a close(), the leasechecker thread is interrupted.  This interrupt races with the rpc namenode.renew() and can cause a ClosedByInterruptException.  This closes the underlying channel and the other filesystem, sharing the connection will get errors.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323273","id":"12323273","description":"2.0.3-alpha release","name":"2.0.3-alpha","archived":false,"released":true,"releaseDate":"2013-02-14"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12546168","id":"12546168","filename":"HADOOP-6762.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-09-22T15:25:47.431+0000","size":12948,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12546168/HADOOP-6762.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12555841","id":"12555841","filename":"hadoop-6762.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2012-12-03T22:41:43.735+0000","size":13569,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12555841/hadoop-6762.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12491851","id":"12491851","filename":"hadoop-6762.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-08-26T23:06:39.232+0000","size":13710,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12491851/hadoop-6762.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12491826","id":"12491826","filename":"hadoop-6762.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-08-26T19:40:11.542+0000","size":13631,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12491826/hadoop-6762.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12444323","id":"12444323","filename":"hadoop-6762-1.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-12T17:36:33.517+0000","size":6913,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12444323/hadoop-6762-1.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12459934","id":"12459934","filename":"hadoop-6762-10.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-18T18:20:24.765+0000","size":10134,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12459934/hadoop-6762-10.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12444414","id":"12444414","filename":"hadoop-6762-2.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-13T18:57:08.668+0000","size":6226,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12444414/hadoop-6762-2.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12444439","id":"12444439","filename":"hadoop-6762-3.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-13T23:34:40.623+0000","size":7650,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12444439/hadoop-6762-3.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12445408","id":"12445408","filename":"hadoop-6762-4.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-25T01:34:55.254+0000","size":8358,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12445408/hadoop-6762-4.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12446307","id":"12446307","filename":"hadoop-6762-6.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T00:16:58.848+0000","size":8835,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12446307/hadoop-6762-6.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12446356","id":"12446356","filename":"hadoop-6762-7.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T17:52:57.528+0000","size":9857,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12446356/hadoop-6762-7.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12446530","id":"12446530","filename":"hadoop-6762-8.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-07T21:41:04.655+0000","size":10166,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12446530/hadoop-6762-8.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12447484","id":"12447484","filename":"hadoop-6762-9.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-18T17:26:37.500+0000","size":10184,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12447484/hadoop-6762-9.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"14211","customfield_12312823":null,"summary":"exception while doing RPC I/O closes channel","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12866619","id":"12866619","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"the general problem is that 'client' threads hold the socket and do writes to it to send RPCs.  If a client thread receives an interrupt, it will leave the socket in an unusable state. \n\ni have a test for this general case and a patch which moves the actual writing to the socket to a thread owned by the Client object.  This means a client can be interrupted and not ruin the socket for other clients.\n\nnote:  other socket errors may occur that make the socket unusable. The patch doesn't handle this (only intended to help with interrupted cases since that is common with filesystem.close).\n\nwe might also want to consider finding a way to fail fast when RPC goes bad.  Near as I can tell from watching this happen, until the filesystem is closed, the underlying RPC is in a bad state.  It seems like we could fail on one operation, detect the bad socket and perhaps recreate the socket or the whole RPC object.  not sure where this retry logic goes","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-12T16:28:52.392+0000","updated":"2010-05-12T16:28:52.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12866647","id":"12866647","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"test uses MiniDFSCluster and includes a patch to it.  i might need to make a test case that doesn't rely on hdfs testing utils","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-12T17:36:33.583+0000","updated":"2010-05-12T17:36:33.583+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12867216","id":"12867216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"updated test to not used MiniDFSCluster","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-13T18:57:08.745+0000","updated":"2010-05-13T18:57:08.745+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12867312","id":"12867312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"1. previous patch had a bug where a race condition could cause indefinite hang of the client\n2. cleaned up case of close by shutting down executor (speeds up shutdown as thread is interrupted)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-13T23:34:40.696+0000","updated":"2010-05-13T23:34:40.696+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12870941","id":"12870941","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"unit tests would hang since threads in executor were not daemon threads.  change to daemon threads","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-05-25T01:34:55.330+0000","updated":"2010-05-25T01:34:55.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12874977","id":"12874977","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey Sam. Is it not sufficient to simply add a \"this.interrupt()\" in the catch clause of sendParams?\n\nI was running into an occasional issue with 1 minute pauses during DFSClient pipeline recovery, and I think it's due to this issue. I added this.interrupt() and it seems to pass test case, I'll see if it also fixes my 1 minute pauses.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-03T06:39:25.860+0000","updated":"2010-06-03T06:39:25.860+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875140","id":"12875140","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"so you mean add Thread.currentThread.interrupt() above markClosed(e) ?  I don't think this fixes the underlying problem.\n\nThe problem is if a channel is doing a wait for IO and an interrupt comes in, you get a ClosedByInterrupt exception\n\nhttp://java.sun.com/javase/6/docs/api/java/nio/channels/ClosedByInterruptException.html\n\nfrom the doc, this closes the channel and sets the interrupt status (ie interrupt() shouldn't have an effect--means my test doesn't repro the same thing I saw).\nWhat I then saw was that other RPC instances using the same channel would get ChannelClosedException.  The only way to avoid this in the FileSystem case was to move the thread that uses the channel to its own so the lease checker won't interrupt it.\n\nI'll play with the test case and see why your change makes it pass when it doesn't seem like it can't fix the underlying problem","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-03T15:08:39.960+0000","updated":"2010-06-03T15:08:39.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875193","id":"12875193","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"maybe you can elaborate on where you are adding the interrupt() call as trying what I understand you to have suggested didn't make the test pass.\n\nIs this what you mean for sendParam:\n\n{code}\n    public void sendParam(Call call) {\n      if (shouldCloseConnection.get()) {\n        return;\n      }\n\n      DataOutputBuffer d=null;\n      try {\n        synchronized (this.out) {\n          if (LOG.isDebugEnabled())\n            LOG.debug(getName() + \" sending #\" + call.id);\n          \n          //for serializing the\n          //data to be written\n          d = new DataOutputBuffer();\n          d.writeInt(call.id);\n          call.param.write(d);\n          byte[] data = d.getData();\n          int dataLength = d.getLength();\n          out.writeInt(dataLength);      //first put the data length\n          out.write(data, 0, dataLength);//write the data\n          out.flush();\n        }\n      } catch(IOException e) {\n        Thread.currentThread().interrupt(); //add this--should have no effect on ClosedByInterrupt as it sets the current thread to be interrupted already\n        markClosed(e);\n      } finally {\n        //the buffer is just an in-memory buffer, but it is still polite to\n        // close early\n        IOUtils.closeStream(d);\n      }\n    }  \n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-03T17:09:24.324+0000","updated":"2010-06-03T17:09:24.324+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875197","id":"12875197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey Sam. Instead of Thread.currentThread().interrupt(), I mean this.interrupt(), in order to interrupt the Connection thread (not the caller thread).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-03T17:18:58.106+0000","updated":"2010-06-03T17:18:58.106+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875200","id":"12875200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"sorry, I'm still confused--once you catch the IOException here, the channel is closed.  How does interrupting the Connection help avoid this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-03T17:26:46.726+0000","updated":"2010-06-03T17:26:46.726+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875203","id":"12875203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"maybe my test case is not sufficiently deterministic so it works differently for you.  I replaced \"Thread.currentThread.interrupt()\" with \"this.interrupt()\" in the code I pasted above.  \n\nThe test still fails\n(and regardless, I don't think that can affect the underlying problem that if something interrupts a thread that is doing RPC and that thread is blocked on the channel, it gets closed automatically)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-03T17:29:43.197+0000","updated":"2010-06-03T17:29:43.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875380","id":"12875380","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"improved test case: runs 200 threads doing rpc via the same connection.  shows that interrupting one can cause errors in the others.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T00:15:03.520+0000","updated":"2010-06-04T00:15:03.520+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875382","id":"12875382","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"had unnecessary Runnable cast","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T00:16:58.907+0000","updated":"2010-06-04T00:16:58.907+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875383","id":"12875383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"todd : you can try this.interrupt() now.  please let me know if it passes the new test case","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T00:18:49.384+0000","updated":"2010-06-04T00:18:49.384+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875406","id":"12875406","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey Sam. Sorry, I misunderstood your point earlier. You're definitely right that interrupting one thread shouldn't take down the RPC connection.\n\nAdding yet another thread to IPC seems a bit complicated, though. What about if we added a flag to Connection saying \"no more sends on this connection\", so that interrupting the sender did kill the connection but lets currently pending calls complete? Then when the queue has been quiesced the connection shuts down like it does today?\n\nThe issue I'm thinking is that we solve the interrupt problem, but don't solve the general case of exceptions during sendparam. The user can still have a Writable which eg throws an NPE, and we're back to the same problem of lack of isolation between writers.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T01:17:28.247+0000","updated":"2010-06-04T01:17:28.247+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875411","id":"12875411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"Hmm, how would pending calls complete?  They already have a Connection object with a socket channel that is in bad shape.  basically there would have to be a check inside a sync block that the channel is valid before sending.  If it's not, it would have to create a new socket (or whole Connection, again all in sync block).  Does this make sense?  A bunch of threads get the Connection object and pile up on the synchronized(this.out) and if one of them is interrupted, the whole pile will get errors.  I think having the test & fix code is more complicated than using another thread actually, but I may be biased (having already done it the other way)\n\nFWIW, we're already using this on our 0.20 branch in production where we have up to 200+ threads using the same RPC instance.\n\nalso, i don't actually think the code is complex--it's using an executor so the thread management is as simple as it can get. \nWe can even get rid of the latch--it's not necessary, but I wanted the change to function exactly as it does now, so I put it in.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T01:27:23.965+0000","updated":"2010-06-04T01:27:23.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875413","id":"12875413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey Sam, that's a fair argument. Let me look over your patch more closely. Do you have this against 0.20 as well? The test case I have that caused me to notice this is an 0.20 based cluster test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T01:29:51.429+0000","updated":"2010-06-04T01:29:51.429+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875415","id":"12875415","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"oh, i see now that this essentially applies to 20 without changes. Will try it out and let you know.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T01:38:22.046+0000","updated":"2010-06-04T01:38:22.046+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875416","id":"12875416","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"This patch should largely work against 0.20.  I originally patched our 0.20 and then ported to trunk (which was mostly re-writing the test case)\n\nif this doesn't apply, let me know and i'll back-port this (including test case) to 0.20\n\nalso, I do agree on one point about the extra thread:  while I don't see it as inherently complex, I do see it as an additional resource.  if we could solve it w/o the thread and similar in code complexity, that would be the superior solution imo\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T01:38:25.184+0000","updated":"2010-06-04T01:38:25.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875421","id":"12875421","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Looking at the code:\n- Instead of using the CountdownLatch, can you change the Runnable to a Callable<Void>() and then get back a Future<Void>? Seems a little cleaner.\n- The behavior is different since we've added a timeout waiting to sendParam. Do you think this change is necessary? (under what case would we block forever waiting to write?)\n- Regarding the issue I raised above with a Writable param that throws NPE, can we move the actual buffer construction back into the calling thread? Then if it throws an RTE, the user will see it (rather than it getting lost somewhere). There's still an issue that this will leave the call on the connection queue, but that's probably worth a separate jira.\n\nRegarding the resource usage issue: can we just use a static  cachedthreadpool that's shared across all of RPC for sending params? In the common case it would only have 0 or 1 threads but it could grow as necessary and then shrink back when idle.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T01:53:34.324+0000","updated":"2010-06-04T01:53:34.324+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875424","id":"12875424","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"thanks for reviewing the patch so quickly.  \n\n1. latch : I agree.  I'll change it to use a future & get (with timeout, see #2).\n\n2. actually the timeout helped me debug a switch issue today.  I would see a flurry of timeouts when I saturated a switch that wasn't performing to spec.  getting the timeouts was far preferable than hanging indefinitely.  i agree it changes the behavior, but it's the same we do pings at I think.  Also, playing a game of adversary, *if* somehow the connection thread in the executor did die, the latch would hang indefinitely.\n\nperhaps the timeout value should be something else? I choose the timeout value that was used to connect the socket (pingInterval) as it seemed appropriate.\n\n3. ah, i misread your comment above--that's a great idea.  Only the actual push out the socket needs to be in critical section (in theory could improve perf a tiny bit).\n\nI'll get to the changes and post another patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T02:07:33.801+0000","updated":"2010-06-04T02:07:33.801+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875426","id":"12875426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"re timeout: I'm a little nervous about such a change in the semantics of IPC at this point. The ping system ensures that the other side isn't completely dead, so some people use IPCs that are *supposed* to take a really long time, and rely on ping to know it's at least still connected. Maybe if you find it useful you could introduce a new parameter for the IPC timeout, and have it default to 0 (no timeout?)\n\nI could also see a situation where we wait for the ping time, and then print a LOG.warn(\"IPC call Protocol.callName to <IP> still waiting after 60000ms\") once every ping interval. This would help debugging without changing behavior. (I too have often wished for such a thing)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T02:11:52.519+0000","updated":"2010-06-04T02:11:52.519+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875427","id":"12875427","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey Sam,\n\nMy cluster test case just spat out a nice warning and then deadlocked my DFS client:\n\n10/06/03 18:48:54 WARN hdfs.DFSClient: Error Recovery for block blk_832465809601113490_3336818 in pipeline 192.168.42.40:11072, 192.168.42.41:11072, 192.168.42.43:11072: bad datanode 192.168.42.41:11072\nException in thread \"DataStreamer for file /user/todd/test-sync block blk_832465809601113490_3336818\" java.lang.reflect.UndeclaredThrowableException\n        at $Proxy1.getProtocolVersion(Unknown Source)\n        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:359)\n        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:346)\n        at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:383)\n        at org.apache.hadoop.hdfs.DFSClient.createClientDatanodeProtocolProxy(DFSClient.java:146)\n        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.processDatanodeError(DFSClient.java:2627)\n        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.access$1600(DFSClient.java:2139)\n        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream$DataStreamer.run(DFSClient.java:2306)\nCaused by: java.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1238)\n        at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:253)\n        at org.apache.hadoop.ipc.Client$Connection.sendParam(Client.java:526)\n        at org.apache.hadoop.ipc.Client.call(Client.java:765)\n        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:220)\n        ... 8 more\n\nI think we need to add another catch (InterruptedException) and rethrow as IOException around the sendParam call in Client.call","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T02:15:15.826+0000","updated":"2010-06-04T02:15:15.826+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875428","id":"12875428","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"forgot to comment on static cachedThreadPool:\n\nThis concerns me as if we don't bound the size of this, we could get a massive # of threads;  if we do bound it, then it seems to me we might have some form of deadlock possible where one RPC depends on another (indirectly) and due to limited threads, it can't complete.  Basically we would want at least one thread per Connection, but no more (which is what have now)\n\nWe have seem one case of distributed deadlock here on the IPC workers in the DN, so this isn't 100% theory\n\nWhile it is an extra resource, for simplicity and safety, I *do* prefer one thread Connection.  \n\nWhat do you think?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T02:15:48.388+0000","updated":"2010-06-04T02:15:48.388+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875429","id":"12875429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"yea, we do need to catch the interruptedException--our 0.20 version had that.  i'll also add that one\n\nthx\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T02:16:42.962+0000","updated":"2010-06-04T02:16:42.962+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875430","id":"12875430","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"re: timeout, so if a server disappeared, the ping would fail and the RPC would fail that way?  if that's the case, then I think removing the timeout on the Future.get() is fine. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T02:18:43.357+0000","updated":"2010-06-04T02:18:43.357+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875431","id":"12875431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"bq. re: timeout, so if a server disappeared, the ping would fail and the RPC would fail that way? if that's the case, then I think removing the timeout on the Future.get() is fine.\n\nYep, that should be the case. Of course a server can stay up but be unresponsive (eg deadlocked). In those cases, while it's annoying that clients get blocked forever, I don't know that changing the behavior to be timeout based would be a change we could really make at this point without worrying that it would break lots and lots of downstream users :(\n\nbq. We have seem one case of distributed deadlock here on the IPC workers in the DN, so this isn't 100% theory\n\nYep, I've seen internode deadlocks several times as well. Not pretty! However, I can't think of a situation where this could happen here -- the only thing that can block one of these sendParam calls is TCP backpressure on the socket, and that only happens when the network is stalled. I don't see a case where allowing other threads to start sending would have unstalled a prior sender.\n\nWe could actually enforce the max one thread per connection thing by synchronizing on Connection.this.out *outside* the submission of the runnable. That way we know there's only one sending going on at a time, and we're just using the thread exactly for avoiding interruption and nothing else.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T02:25:08.556+0000","updated":"2010-06-04T02:25:08.556+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875435","id":"12875435","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"hmm, actually with a Future, if there is a runtime exception, it'll show up as an ExecutionException on future.get(), so there isn't a need to move the buffer construction outside (requires another try/catch clause due to IOException).   We can use getCause() on the ExecutionException to find the underlying exception and use markClosed() if it's an IOException, and re-throw if it's a runtime exception (same behavior as now)\n\nor we can move it into the caller thread.  Using the future requires handling the ExecutionException anyway, so I sort of lean this way as it kills two birds. i don't know how much more parallelism we gain moving the buffer construction outside the sync block.\n\nwhat do you think?\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T02:32:15.082+0000","updated":"2010-06-04T02:32:15.082+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875437","id":"12875437","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Either way seems cool. I've never seen call param serialization be a bottleneck where parallelization would really help. Whichever one makes the code cleaner :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-04T02:39:13.305+0000","updated":"2010-06-04T02:39:13.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875675","id":"12875675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"I almost have an updated patch.  I loved the idea of sync on Connection.this.out around submit + wait, but this causes deadlock as the out.write() call inside is a synchronized function.  I instead sync'd on the connection object itself (seems safe and gives the same result.  1 : 1 Connection/socket => bounds the threads by the # of connections\n(really, very clean/clever idea to optimize thread use)\n\none catch with the static executor instance:  nothing ever shuts it down.  While this isn't an issue for actual execution, it won't cause unit tests to hang, will it?  (I made a thread factory that makes the threads daemons for this purpose)\n\npatch coming after i run a larger set of unit tests","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T17:32:33.791+0000","updated":"2010-06-04T17:32:33.791+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875679","id":"12875679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"1. changed to use Future.get() w/o timeout\n2. static executor instance with cached thread instances (with daemon thread factory)\n3. added catch of interruptedException around sendParams call to avoid undeclared throwable exception\n\nnote : used a dedicated lock var around the submit + wait for a sendParams call.  I didn't want to worry about reasoning through lock contention/deadlock with synchronized methods (why I didn't synchronize on \"this\")\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T17:52:57.592+0000","updated":"2010-06-04T17:52:57.592+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12875680","id":"12875680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"btw, is it appropriate to delete the very old patches as they aren't really relevant?  or just leave them?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-04T17:53:42.169+0000","updated":"2010-06-04T17:53:42.169+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876060","id":"12876060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"todd : actually i want open the timeout discussion back up.  I think there might be some confusion.  The 20s timeout that was there was *not* on the RPC, but *only* on sending the RPC.  Basically this is the time to write to the socket (which there might a timeout on the actual out.write call already--i need to double-check).\n\nThe RPC itself still would have no timeout.\n\nlet me know what you think.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-06T17:04:33.565+0000","updated":"2010-06-06T17:04:33.565+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876081","id":"12876081","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"bq. btw, is it appropriate to delete the very old patches as they aren't really relevant? or just leave them?\n\nUsually just leave them - makes it easier to follow the conversation and see how the patch evolved.\n\nbq. (which there might a timeout on the actual out.write call already--i need to double-check)\n\nLooks like there is one - a timeout is set when NetUtils.getOutputStream is called on the socket in setupIOStreams(). So I don't think we need a separate timeout in awaiting the send param.\n\n\nI think the patch is good. I ran it with my test case since Friday night and didn't see any RPC hangs. The test case eventually failed with \"Too many open files\" but I think it's some other bug/socket leak in DFS code, not IPC. Mark Patch Available to swing it through Hudson?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-06T20:24:56.612+0000","updated":"2010-06-06T20:24:56.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876088","id":"12876088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12446356/hadoop-6762-7.txt\n  against trunk revision 951624.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/567/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/567/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/567/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/567/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-06-06T21:20:04.697+0000","updated":"2010-06-06T21:20:04.697+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876205","id":"12876205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamahesh","name":"umamahesh","key":"umamahesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Mahesh","active":true,"timeZone":"Asia/Kolkata"},"body":"I applied the patch and ran this test continuously.\nSeems still race condition is occuring randomly.\nThat means this patch is not working. :-(","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamahesh","name":"umamahesh","key":"umamahesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Mahesh","active":true,"timeZone":"Asia/Kolkata"},"created":"2010-06-07T11:27:22.968+0000","updated":"2010-06-07T11:27:22.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876311","id":"12876311","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"can you elaborate on what you ran and what error messages + exceptions you saw in the test logs?  the thread that does the IO cannot receive an interrupt so if you are seeing an error, i don't think it can be the same one.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-07T16:57:13.276+0000","updated":"2010-06-07T16:57:13.276+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876322","id":"12876322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"Actually, this might be an artifact of the test.  The threads in the executor's threadpool will be interrupted on shutdown.  the test doesn't wait for all of the threads to terminate gracefully before doing so.  This means there is a race in the test for rpc threads to finish before getting interrupted.  I have an updated test that uses a latch to wait for all threads to terminate before letting the test complete. I haven't been able to repro, but can post the patch this afternoon and let you try.\n\nplease do still post what exception and any relevant looking log parts here.  it will help me ascertain if this is the case","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-07T17:29:17.139+0000","updated":"2010-06-07T17:29:17.139+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876433","id":"12876433","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"turns out this is just a really bad case of logging.  the exception was a BrokenBarrierException and I wasn't logging the real exception.  changed that and fixed the test so this doesn't occur\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-07T21:40:51.184+0000","updated":"2010-06-07T21:40:51.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876541","id":"12876541","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamahesh","name":"umamahesh","key":"umamahesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Mahesh","active":true,"timeZone":"Asia/Kolkata"},"body":"testRPCInterrupted3:--\ni also feel this may be the test problem.\n in this test, inside run method it is throwing the exception i.e java.util.concurrent.BrokenBarrierException\nThis is happening some times.\nI added some wait to complete all the threads before assertion.\nThis is happenning randomly...most of the times passing the test.\nPlease post the latest test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamahesh","name":"umamahesh","key":"umamahesh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Mahesh","active":true,"timeZone":"Asia/Kolkata"},"created":"2010-06-08T04:29:08.795+0000","updated":"2010-06-08T04:29:08.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12876546","id":"12876546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"-8 is the latest.  i ran it 100 times and did not get any failures.  do you still see a failure with rev 8?  if so, I can do some more work with latches to tighten it up (right now I have a simple sleep that should allow the threads to get warmed up, and a latch to let them gracefully exit)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-08T05:02:46.304+0000","updated":"2010-06-08T05:02:46.304+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12877262","id":"12877262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"-8 is identical to -7, did you mean to upload a different patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-09T23:21:28.537+0000","updated":"2010-06-09T23:21:28.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12877286","id":"12877286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"this is downright odd--if I click and view\n\nhttps://issues.apache.org/jira/secure/attachment/12446356/hadoop-6762-7.txt\nhttps://issues.apache.org/jira/secure/attachment/12446530/hadoop-6762-8.txt\n\nthey differ (the latter has a Thread.sleep() in the unit test)\n\nbut grabbing with wget \n\nwget https://issues.apache.org/jira/secure/attachment/12446530/hadoop-6762-7.txt --no-check-certificate\nwget https://issues.apache.org/jira/secure/attachment/12446530/hadoop-6762-8.txt --no-check-certificate\n\nthey both have the Thread.sleep()\n\nis something up with JIRA?  or what did I do?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-10T01:26:41.573+0000","updated":"2010-06-10T01:26:41.573+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12877482","id":"12877482","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Note that one of the path segments differs between the two URLs. I think it just pulls an attachment ID from that path segment and downloads that, regardless of the name at the end of the path (your two wget urls have the same path segment, I guess you manually edited the last bit?)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-10T16:47:45.226+0000","updated":"2010-06-10T16:47:45.226+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12877488","id":"12877488","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"yes, I did :)\n\nso the two patches do differ, probably in one line, Thread.sleep(1000);\n\nAs I said, I ran ant test-core in a loop 100x and did not see the failure.  If someone does, though, I can do something more sophisticated in the test (like using another latch to make sure the leader has started before interrupting it and causing the BrokenBarrierException)\n\nlet me know\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-10T17:00:04.912+0000","updated":"2010-06-10T17:00:04.912+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12880057","id":"12880057","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hey Sam, one small thing in the newest patch: there are some unspecified generics - eg should be new AtomicReference<Throwable>, not just new AtomicReference. Otherwise we get some warnings compiling the tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-18T02:56:15.831+0000","updated":"2010-06-18T02:56:15.831+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12880258","id":"12880258","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"AtomicReference typed now","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-18T17:26:37.566+0000","updated":"2010-06-18T17:26:37.566+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12883813","id":"12883813","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"This looks ready for commit. Please resubmit to hadoopQA so that the final round of tests pass.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2010-06-30T07:13:43.147+0000","updated":"2010-06-30T07:13:43.147+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12883954","id":"12883954","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12447484/hadoop-6762-9.txt\n  against trunk revision 957074.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/597/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/597/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/597/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h4.grid.sp2.yahoo.net/597/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-06-30T15:31:01.304+0000","updated":"2010-06-30T15:31:01.304+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12883999","id":"12883999","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"the javadoc warnings do not appear to be from my patch\n(and I see 6, not 1)\n\n     [exec]   [javadoc] Constructing Javadoc information...\n     [exec]   [javadoc] /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/src/java/org/apache/hadoop/security/KerberosName.java:31: warning: sun.securi\nty.krb5.Config is Sun proprietary API and may be removed in a future release\n     [exec]   [javadoc] import sun.security.krb5.Config;\n     [exec]   [javadoc]                         ^\n     [exec]   [javadoc] /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/src/java/org/apache/hadoop/security/KerberosName.java:32: warning: sun.securi\nty.krb5.KrbException is Sun proprietary API and may be removed in a future release\n     [exec]   [javadoc] import sun.security.krb5.KrbException;\n     [exec]   [javadoc]                         ^\n     [exec]   [javadoc] /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/src/java/org/apache/hadoop/security/KerberosName.java:81: warning: sun.securi\nty.krb5.Config is Sun proprietary API and may be removed in a future release\n     [exec]   [javadoc]   private static Config kerbConf;\n     [exec]   [javadoc]                  ^\n     [exec]   [javadoc] /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/src/java/org/apache/hadoop/security/SecurityUtil.java:33: warning: sun.securi\nty.jgss.krb5.Krb5Util is Sun proprietary API and may be removed in a future release\n     [exec]   [javadoc] import sun.security.jgss.krb5.Krb5Util;\n     [exec]   [javadoc]                              ^\n     [exec]   [javadoc] /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/src/java/org/apache/hadoop/security/SecurityUtil.java:34: warning: sun.securi\nty.krb5.Credentials is Sun proprietary API and may be removed in a future release\n     [exec]   [javadoc] import sun.security.krb5.Credentials;\n     [exec]   [javadoc]                         ^\n     [exec]   [javadoc] /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/src/java/org/apache/hadoop/security/SecurityUtil.java:35: warning: sun.securi\nty.krb5.PrincipalName is Sun proprietary API and may be removed in a future release\n     [exec]   [javadoc] import sun.security.krb5.PrincipalName;\n     [exec]   [javadoc]                         ^\n     [exec]   [javadoc] ExcludePrivateAnnotationsStandardDoclet\n     [exec]   [javadoc] Standard Doclet version 1.6.0_11\n     [exec]   [javadoc] Building tree for all the packages and classes...\n     [exec]   [javadoc] Building index for all the packages and classes...\n     [exec]   [javadoc] Building index for all classes...\n     [exec]   [javadoc] Generating /grid/0/hudson/hudson-slave/workspace/Hadoop-Patch-h4.grid.sp2.yahoo.net/trunk/build/docs/api/stylesheet.css...\n     [exec]   [javadoc] 6 warnings\n     [exec] \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-06-30T17:56:04.014+0000","updated":"2010-06-30T17:56:04.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12902556","id":"12902556","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hi Sam,\n\nWith this patch, I see occasinal failures of TestGridmixSubmission when the JobMonitor gets interrupted:\n\n{noformat}\n10/08/25 11:05:20 WARN ipc.Client: interrupted waiting to send params to server\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1215)\n        at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:218)\n        at java.util.concurrent.FutureTask.get(FutureTask.java:83)\n        at org.apache.hadoop.ipc.Client$Connection.sendParam(Client.java:754)\n        at org.apache.hadoop.ipc.Client.call(Client.java:1001)\n        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:224)\n        at org.apache.hadoop.mapred.$Proxy10.getJobStatus(Unknown Source)\n        at org.apache.hadoop.mapred.JobClient$NetworkedJob.updateStatus(JobClient.java:250)\n        at org.apache.hadoop.mapred.JobClient$NetworkedJob.isSuccessful(JobClient.java:339)\n        at org.apache.hadoop.mapreduce.Job.isSuccessful(Job.java:332)\n        at org.apache.hadoop.mapred.gridmix.JobMonitor$MonitorThread.process(JobMonitor.java:134)\n        at org.apache.hadoop.mapred.gridmix.JobMonitor$MonitorThread.run(JobMonitor.java:175)\n10/08/25 11:05:20 WARN gridmix.JobMonitor: Lost job GRIDMIX00000\njava.io.IOException: java.lang.InterruptedException\n        at org.apache.hadoop.ipc.Client.call(Client.java:1007)\n        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:224)\n        at org.apache.hadoop.mapred.$Proxy10.getJobStatus(Unknown Source)\n        at org.apache.hadoop.mapred.JobClient$NetworkedJob.updateStatus(JobClient.java:250)\n        at org.apache.hadoop.mapred.JobClient$NetworkedJob.isSuccessful(JobClient.java:339)\n        at org.apache.hadoop.mapreduce.Job.isSuccessful(Job.java:332)\n        at org.apache.hadoop.mapred.gridmix.JobMonitor$MonitorThread.process(JobMonitor.java:134)\n        at org.apache.hadoop.mapred.gridmix.JobMonitor$MonitorThread.run(JobMonitor.java:175)\nCaused by: java.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1215)\n        at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:218)\n        at java.util.concurrent.FutureTask.get(FutureTask.java:83)\n        at org.apache.hadoop.ipc.Client$Connection.sendParam(Client.java:754)\n        at org.apache.hadoop.ipc.Client.call(Client.java:1001)\n        ... 7 more\n{noformat}\n\nI think the patch is doing the right thing here for the most part, but it should throw InterruptedIOException instead of just a normal IOException. Then the caller can at least catch it distinctly from a normal IOException.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-08-25T18:19:37.017+0000","updated":"2010-08-25T18:19:37.017+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12902557","id":"12902557","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"actually, I might take it back - it looks like you can't pass cause information into an InterruptedIOException, so it's better to have callers check e.getCause() instanceof InterruptedException instead? What do you think? The gridmix case above already checks for ClosedByInterruptException, so it can easy check for InterruptedException too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-08-25T18:24:39.828+0000","updated":"2010-08-25T18:24:39.828+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12902685","id":"12902685","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"I think IOException makes sense for 2 reasons\n\n1. the reason you stated--we can pass the actual cause\n2. my read is that only if you are the thread doing the IO should you throw InterruptedIOException.  In this case, the thread truly was interrupted--the IO happens in the other thread.  \nhttp://download-llnw.oracle.com/javase/6/docs/api/java/io/InterruptedIOException.html\nit also has a field for the partial bytes transfered.  In fact, this patch is supposed to keep the IO from actually being interrupted :)\n\nhow can we make it so the test will pass?  does the test have a faulty assumption that I should fix?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-08-25T22:39:24.381+0000","updated":"2010-08-25T22:39:24.381+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12902692","id":"12902692","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"I think we just need this fix to the gridmix test:\n{quote}\n--- a/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/JobMonitor.java\n+++ b/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/JobMonitor.java\n@@ -177,7 +177,8 @@ class JobMonitor implements Gridmix.Component<Job> {\n                 continue;\n               }\n             } catch (IOException e) {\n-              if (e.getCause() instanceof ClosedByInterruptException) {\n+              if (e.getCause() instanceof ClosedByInterruptException ||\n+                  e.getCause() instanceof InterruptedException) {\n                 // Job doesn't throw InterruptedException, but RPC socket layer\n                 // is blocking and may throw a wrapped Exception if this thread\n                 // is interrupted. Since the lower level cleared the flag,\n{quote}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-08-25T22:56:47.170+0000","updated":"2010-08-25T22:56:47.170+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12908097","id":"12908097","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"just getting around to this--this requires a patch to the mapred project rt?  so do i file a separate jira for that?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-09-10T17:15:12.249+0000","updated":"2010-09-10T17:15:12.249+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12928503","id":"12928503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12447484/hadoop-6762-9.txt\n  against trunk revision 1031422.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/35//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-11-05T06:17:42.872+0000","updated":"2010-11-05T06:17:42.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12928936","id":"12928936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"i'll update the patch.  I think it just needs to be rebased\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-06T06:13:35.510+0000","updated":"2010-11-06T06:13:35.510+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12928937","id":"12928937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"also this was run against trunk?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-06T06:14:03.941+0000","updated":"2010-11-06T06:14:03.941+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12933510","id":"12933510","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"rebase off latest trunk","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-18T18:20:24.801+0000","updated":"2010-11-18T18:20:24.801+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12933519","id":"12933519","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12459934/hadoop-6762-10.txt\n  against trunk revision 1036130.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\n    +1 system test framework.  The patch passed system test framework compile.\n\nTest results: https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/110//testReport/\nFindbugs warnings: https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/110//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/110//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2010-11-18T18:46:14.641+0000","updated":"2010-11-18T18:46:14.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12933889","id":"12933889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"the javadoc warnings are not in any files I touched.  The warnings in tr\n\n-----------\n\n  [javadoc] Loading source files for package org.apache.hadoop.contrib.failmon...  [javadoc] Constructing Javadoc information...  [javadoc] /data/users/srash/apache/hadoop-common/src/java/org/apache/hadoop/security/SecurityUtil.java:39: warning: sun.security.jgss.krb5.Krb5Util is Sun proprietary API and may\n be removed in a future release\n  [javadoc] import sun.security.jgss.krb5.Krb5Util;  [javadoc]                              ^  [javadoc] /data/users/srash/apache/hadoop-common/src/java/org/apache/hadoop/security/SecurityUtil.java:40: warning: sun.security.krb5.Credentials is Sun proprietary API and may b\ne removed in a future release\n  [javadoc] import sun.security.krb5.Credentials;  [javadoc]                         ^\n  [javadoc] /data/users/srash/apache/hadoop-common/src/java/org/apache/hadoop/security/SecurityUtil.java:41: warning: sun.security.krb5.PrincipalName is Sun proprietary API and may be removed in a future release\n  [javadoc] import sun.security.krb5.PrincipalName;  [javadoc]                         ^\n  [javadoc] /data/users/srash/apache/hadoop-common/src/java/org/apache/hadoop/security/KerberosName.java:31: warning: sun.security.krb5.Config is Sun proprietary API and may be rem\noved in a future release\n  [javadoc] import sun.security.krb5.Config;  [javadoc]                         ^\n  [javadoc] /data/users/srash/apache/hadoop-common/src/java/org/apache/hadoop/security/KerberosName.java:32: warning: sun.security.krb5.KrbException is Sun proprietary API and may \nbe removed in a future release\n  [javadoc] import sun.security.krb5.KrbException;  [javadoc]                         ^\n  [javadoc] /data/users/srash/apache/hadoop-common/src/java/org/apache/hadoop/security/KerberosName.java:81: warning: sun.security.krb5.Config is Sun proprietary API and may be rem\noved in a future release\n  [javadoc]   private static Config kerbConf;  [javadoc]                  ^\n  [javadoc] ExcludePrivateAnnotationsStandardDoclet\n  [javadoc] Standard Doclet version 1.6.0_21\n  [javadoc] Building tree for all the packages and classes...  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n  [javadoc] Generating /data/users/srash/apache/hadoop-common/build/docs/api/stylesheet.css...\n  [javadoc] 6 warnings\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T17:58:10.549+0000","updated":"2010-11-19T17:58:10.549+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12933890","id":"12933890","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"todd: where are we on this?  you said some gridmx test in the mapred project needs updated based on this? shall we commit this and file a mapreduce jira?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-11-19T17:59:13.249+0000","updated":"2010-11-19T17:59:13.249+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12980179","id":"12980179","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Sorry, Sam, this one dropped off my radar. I'd like to get it in for 0.22, let me swing around and see what work's remaining.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-01-11T16:55:25.134+0000","updated":"2011-01-11T16:55:25.134+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/12996898","id":"12996898","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12459934/hadoop-6762-10.txt\n  against trunk revision 1071364.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 3 new or modified tests.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://hudson.apache.org/hudson/job/PreCommit-HADOOP-Build/272//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-02-19T22:09:49.839+0000","updated":"2011-02-19T22:09:49.839+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13002871","id":"13002871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hi Sam,\n\nWe saw the following deadlock which I think is related to this patch:\n\n{noformat}\nThread 50994 (IPC Client (47) connection to XXXXXXXXX:8020 from hdfs):\nState: BLOCKED\nBlocked count: 7168\nWaited count: 7122\nBlocked on java.io.DataOutputStream@2e932fec\nBlocked by 50828 (sendParams-14)\nStack:\norg.apache.hadoop.ipc.Client$Connection.sendPing(Client.java:676)\norg.apache.hadoop.ipc.Client$Connection.access$400(Client.java:210)\norg.apache.hadoop.ipc.Client$Connection$PingInputStream.handleTimeout(Client.java:340)\norg.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:370)\njava.io.BufferedInputStream.fill(BufferedInputStream.java:218)\njava.io.BufferedInputStream.read(BufferedInputStream.java:237)\njava.io.DataInputStream.readInt(DataInputStream.java:370)\norg.apache.hadoop.ipc.Client$Connection.receiveResponse(Client.java:781)\norg.apache.hadoop.ipc.Client$Connection.run(Client.java:689)\n\n\nThread 50828 (sendParams-14):\nState: BLOCKED\nBlocked count: 54\nWaited count: 8313\nBlocked on org.apache.hadoop.ipc.Client$Connection@54aeb3dd\nBlocked by 50994 (IPC Client (47) connection to XXXXXX:8020 from hdfs)\nStack:\norg.apache.hadoop.ipc.Client$Connection.markClosed(Client.java:809)\norg.apache.hadoop.ipc.Client$Connection.access$1200(Client.java:210)\norg.apache.hadoop.ipc.Client$Connection$3.run(Client.java:745)\njava.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\njava.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\njava.util.concurrent.FutureTask.run(FutureTask.java:138)\njava.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\njava.lang.Thread.run(Thread.java:619)\n{noformat}\n\nThe issue is that in the patch, we have the following inverted lock orders:\nsendParam's senderFuture: Connection.out -> Connection (in markClosed)\nsendPing: Connection -> Connection.out (explicit sync)\n\nHave you guys seen this issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-03-04T23:44:11.469+0000","updated":"2011-03-04T23:44:11.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13002873","id":"13002873","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"body":"I haven't noticed this.  In the rev we're running,  inside sendParams(), markClosed() is called outside the synchronized(Connection.this.out), so that lock isn't held...?\n\n(I'm using the original patch I uploaded before we changed it to a Future--it uses a latch)\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rash37","name":"rash37","key":"rash37","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam rash","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-03-04T23:52:49.148+0000","updated":"2011-03-04T23:52:49.148+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13090604","id":"13090604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"I'd really like to get this in for 0.23. I'm going to steal the patch and rebase Sam's work to trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-08-24T23:05:35.587+0000","updated":"2011-08-24T23:05:35.587+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13091979","id":"13091979","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Rebased on trunk. A few changes since the earlier revs:\n- added a new \"simple\" test case with a single thread\n- moved the serialization of the call response into the calling thread, outside of the lock acquisition, to get better CPU parallelism\n- used guava's ThreadFactoryBuilder to make the thread factory\n- Cleaned up some of the warning messages to include thread name","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-08-26T19:40:11.581+0000","updated":"2011-08-26T19:40:11.581+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13091985","id":"13091985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12491826/hadoop-6762.txt\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 4 new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed these unit tests:\n\n                  org.apache.hadoop.ipc.TestRPC\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HADOOP-Build/89//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/89//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-annotations.html\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/89//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common.html\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/89//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-auth.html\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/89//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-26T19:51:13.406+0000","updated":"2011-08-26T19:51:13.406+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13092118","id":"13092118","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Test failed since one of the new tests was leaving the main thread in an interrupted state, so a Thread.sleep crashed in the next test case. I added a \"Thread.interrupted()\" in the tests to clear state between test cases.\n\nThe -1 findbugs issue is due to HADOOP-7587 (not this patch)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-08-26T23:06:39.266+0000","updated":"2011-08-26T23:06:39.266+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13092128","id":"13092128","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12491826/hadoop-6762.txt\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 4 new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed these unit tests:\n\n                  org.apache.hadoop.ipc.TestRPC\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HADOOP-Build/92//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/92//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-auth.html\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/92//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common.html\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/92//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-annotations.html\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/92//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-26T23:15:23.730+0000","updated":"2011-08-26T23:15:23.730+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13092129","id":"13092129","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12491851/hadoop-6762.txt\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 6 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    -1 findbugs.  The patch appears to introduce 4 new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed unit tests in hadoop-common-project.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HADOOP-Build/93//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/93//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-annotations.html\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/93//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common.html\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/93//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-auth.html\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/93//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-08-26T23:21:01.992+0000","updated":"2011-08-26T23:21:01.992+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13277046","id":"13277046","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli2","name":"eli2","key":"eli2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"Etc/UTC"},"body":"Todd,\nLooks like the patch is out of date, mind updating it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli2","name":"eli2","key":"eli2","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"Etc/UTC"},"created":"2012-05-16T19:35:16.368+0000","updated":"2012-05-16T19:35:16.368+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13461192","id":"13461192","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"Unsure if this is still needed but here's a \"rebase\". Had to add in some hunks manually, as certain parts seem to have been highly updated since back then.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-09-22T15:25:47.443+0000","updated":"2012-09-22T15:25:47.443+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13461203","id":"13461203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12546168/HADOOP-6762.patch\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 2 new or modified test files.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 eclipse:eclipse.  The patch built with eclipse:eclipse.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed these unit tests in hadoop-common-project/hadoop-common:\n\n                  org.apache.hadoop.ipc.TestSaslRPC\n                  org.apache.hadoop.ipc.TestMultipleProtocolServer\n                  org.apache.hadoop.ipc.TestProtoBufRpc\n                  org.apache.hadoop.ipc.TestRPCCallBenchmark\n                  org.apache.hadoop.ha.TestZKFailoverController\n                  org.apache.hadoop.ipc.TestRPC\n                  org.apache.hadoop.ipc.TestIPC\n                  org.apache.hadoop.ipc.TestRPCCompatibility\n                  org.apache.hadoop.ipc.TestIPCServerResponder\n                  org.apache.hadoop.security.TestDoAsEffectiveUser\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HADOOP-Build/1499//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/1499//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-09-22T16:09:17.602+0000","updated":"2012-09-22T16:09:17.602+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13461393","id":"13461393","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"Cancelling patch as it fails several relevant tests. Needs to be re-investigated.\n\nTodd - Would you have a chance to look into this soon? Is this still required?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-09-23T11:33:31.146+0000","updated":"2012-09-23T11:33:31.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13509131","id":"13509131","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Thanks for updating the patch, Harsh. I'm looking into this again now. I'll try to post another patch later today.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2012-12-03T22:15:34.484+0000","updated":"2012-12-03T22:15:34.484+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13509278","id":"13509278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Here's an updated patch against trunk.\n\nI ran all of the unit tests in the ipc package locally and they passed. I also tried the new unit tests _without_ the patch, and they failed as expected.\n\nGiven that there was a deadlock found in an early rev of this patch, I also ran all of the IPC unit tests under jcarder to look for lock inversions and it found none.\n\nI ran the RPCCallBenchmark for 30 seconds with and without the patch, with the following results:\n\nWith patch:\n====== Results ======\nOptions:\nrpcEngine=class org.apache.hadoop.ipc.ProtobufRpcEngine\nserverThreads=30\nserverReaderThreads=4\nclientThreads=30\nhost=0.0.0.0\nport=12345\nsecondsToRun=30\nmsgSize=1024\nTotal calls per second: 24668.0\nCPU time per call on client: 58639 ns\nCPU time per call on server: 64893 ns\n\n\nWithout patch:\n====== Results ======\nOptions:\nrpcEngine=class org.apache.hadoop.ipc.ProtobufRpcEngine\nserverThreads=30\nserverReaderThreads=4\nclientThreads=30\nhost=0.0.0.0\nport=12345\nsecondsToRun=30\nmsgSize=1024\nTotal calls per second: 27881.0\nCPU time per call on client: 68079 ns\nCPU time per call on server: 62582 ns\n\nAs expected, the CPU time on the client was increased and the throughput went down by about 13%, since the RPC calls are now being shuttled between threads on the client side. That's unfortunate, but given that this fixes an important bug, and given that _client_ side RPC throughput is rarely a bottleneck in common usage scenarios, I think it is acceptable.\n\nThis patch is also nearly identical to a patch that we've shipped in CDH since June 2010, so I'm fairly confident that the approach is correct.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2012-12-03T22:41:43.737+0000","updated":"2012-12-03T22:41:43.737+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13509297","id":"13509297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Also figured I'd write up a short summary of this, since the above discussion is long and somewhat hard to follow after 2.5 years and ~15 attachments :)\n\nThe issue at hand is what happens when an IPC caller thread (i.e the user thread who is making an IPC call, for example to the NN) is interrupted while in the process of writing the call to the wire. Java NIO's semantics are that a ClosedByInterruptException is thrown on the blocked thread, _and also that the underlying channel is closed_. In the context of IPC, this meant that the caller thread would receive a ClosedByInterruptException, and that any other threads which were sharing the same IPC socket would then receive ClosedChannelExceptions, even though those other threads were never meant to be interrupted.\n\nThe solution is to change the call-sending code such that the actual write() call happens on a new thread, created by the {{SEND_PARAMS_EXECUTOR}} in the patch. Since the user code has no reference to this thread, it won't ever get interrupted, even if someone interrupts the user thread making the call. So, the user thread will receive an InterruptedException, but any other threads using the same socket continue to run unaffected.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2012-12-03T23:02:04.639+0000","updated":"2012-12-03T23:02:04.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13510204","id":"13510204","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=atm","name":"atm","key":"atm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=atm&avatarId=14136","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=atm&avatarId=14136","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=atm&avatarId=14136","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=atm&avatarId=14136"},"displayName":"Aaron T. Myers","active":true,"timeZone":"America/Los_Angeles"},"body":"The latest patch looks good to me. +1 pending Jenkins.\n\nJenkins appears to be down right now, and I think Jenkins flakiness caused test-patch not to notice this one. May need to manually kick it once Jenkins comes back up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=atm","name":"atm","key":"atm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=atm&avatarId=14136","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=atm&avatarId=14136","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=atm&avatarId=14136","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=atm&avatarId=14136"},"displayName":"Aaron T. Myers","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-12-05T01:39:03.464+0000","updated":"2012-12-05T01:39:03.464+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13528219","id":"13528219","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12555841/hadoop-6762.txt\n  against trunk revision .\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 2 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-common-project/hadoop-common.\n\n    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.\n\nTest results: https://builds.apache.org/job/PreCommit-HADOOP-Build/1843//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/1843//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-10T19:52:57.553+0000","updated":"2012-12-10T19:52:57.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13528309","id":"13528309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Committed to trunk and branch-2. Thanks, Sam.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2012-12-10T21:26:01.597+0000","updated":"2012-12-10T21:26:01.597+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13528326","id":"13528326","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-trunk-Commit #3106 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/3106/])\n    HADOOP-6762. Exception while doing RPC I/O closes channel. Contributed by Sam Rash and Todd Lipcon. (Revision 1419782)\n\n     Result = SUCCESS\ntodd : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1419782\nFiles : \n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestIPC.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-10T21:47:39.127+0000","updated":"2012-12-10T21:47:39.127+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13528876","id":"13528876","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Yarn-trunk #62 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/62/])\n    HADOOP-6762. Exception while doing RPC I/O closes channel. Contributed by Sam Rash and Todd Lipcon. (Revision 1419782)\n\n     Result = FAILURE\ntodd : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1419782\nFiles : \n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestIPC.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-11T10:45:40.444+0000","updated":"2012-12-11T10:45:40.444+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13528941","id":"13528941","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Hdfs-trunk #1251 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1251/])\n    HADOOP-6762. Exception while doing RPC I/O closes channel. Contributed by Sam Rash and Todd Lipcon. (Revision 1419782)\n\n     Result = FAILURE\ntodd : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1419782\nFiles : \n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestIPC.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-11T13:11:47.597+0000","updated":"2012-12-11T13:11:47.597+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464362/comment/13528991","id":"13528991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Mapreduce-trunk #1282 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1282/])\n    HADOOP-6762. Exception while doing RPC I/O closes channel. Contributed by Sam Rash and Todd Lipcon. (Revision 1419782)\n\n     Result = SUCCESS\ntodd : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1419782\nFiles : \n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestIPC.java\n* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/ipc/TestRPC.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-11T14:09:57.201+0000","updated":"2012-12-11T14:09:57.201+0000"}],"maxResults":86,"total":86,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-6762/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i02sgf:"}}