{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12380915","self":"https://issues.apache.org/jira/rest/api/2/issue/12380915","key":"HADOOP-2087","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2007-10-22T15:26:10.254+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Nov 27 02:15:02 UTC 2007","customfield_12310420":"125482","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3064260486_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_74122145","customfield_12312321":null,"resolutiondate":"2007-11-27T02:15:21.829+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-2087/watchers","watchCount":0,"isWatching":false},"created":"2007-10-22T15:04:21.343+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12318278","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12318278","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12365248","key":"HADOOP-1130","self":"https://issues.apache.org/jira/rest/api/2/issue/12365248","fields":{"summary":"Remove unused ClientFinalizer in DFSClient","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12317945","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12317945","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12380370","key":"MAPREDUCE-54","self":"https://issues.apache.org/jira/rest/api/2/issue/12380370","fields":{"summary":"distcp failed due to problem in creating files","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:42:42.164+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"task task_200710200555_0005_m_000725_0 started writing a file and the Node went down.. so all following file creation attempts were returned with AlreadyBeingCreatedException\nI think the dfs should handle cases wherein, if a dfsclient goes down between file creation, subsequent creates to the same file could be allowed. \n\n2007-10-20 06:23:51,189 INFO org.apache.hadoop.mapred.TaskInProgress: Error from task_200710200555_0005_m_000725_0: Task task_200710200555_0005_m_000725_0 failed to report status for 606 seconds. Killing!\n2007-10-20 06:23:51,189 INFO org.apache.hadoop.mapred.JobTracker: Removed completed task 'task_200710200555_0005_m_000725_0' from '[tracker_address]:/127.0.0.1:44198'\n2007-10-20 06:23:51,209 INFO org.apache.hadoop.mapred.JobInProgress: Choosing normal task tip_200710200555_0005_m_000725\n2007-10-20 06:23:51,209 INFO org.apache.hadoop.mapred.JobTracker: Adding task 'task_200710200555_0005_m_000725_1' to tip tip_200710200555_0005_m_000725, for tracker '[tracker_address]:/127.0.0.1:50914'\n2007-10-20 06:28:54,991 INFO org.apache.hadoop.mapred.TaskInProgress: Error from task_200710200555_0005_m_000725_1: org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.dfs.AlreadyBeingCreatedException: failed to create file /benchmarks/TestDFSIO/io_data/test_io_825 for DFSClient_task_200710200555_0005_m_000725_1 on client 72.30.50.198, because this file is already being created by DFSClient_task_200710200555_0005_m_000725_0 on 72.30.53.224\n        at org.apache.hadoop.dfs.FSNamesystem.startFileInternal(FSNamesystem.java:881)\n        at org.apache.hadoop.dfs.FSNamesystem.startFile(FSNamesystem.java:806)\n        at org.apache.hadoop.dfs.NameNode.create(NameNode.java:276)\n        at sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:379)\n        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:596)\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"105856","customfield_12312823":null,"summary":"Errors for subsequent requests for file creation after original DFSClient goes down..","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gautamk","name":"gautamk","key":"gautamk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gautam Kowshik","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gautamk","name":"gautamk","key":"gautamk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gautam Kowshik","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12536706","id":"12536706","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"body":"We should just rewrite TestDFSIO (and similar tests) to use *reducer NONE* and create/write the files in ${mapred.output.dir} from the map tasks: http://wiki.apache.org/lucene-hadoop/FAQ#9.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-22T15:26:10.254+0000","updated":"2007-10-22T15:26:10.254+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12536746","id":"12536746","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"I guess if we follow the convention described in http://wiki.apache.org/lucene-hadoop/FAQ#9, then the files are written to a temporary location and then moved to the final location. Does it mean that DFSIO will then have to incur the cost of the file(s) rename operation?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2007-10-22T17:15:32.860+0000","updated":"2007-10-22T17:15:32.860+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12536753","id":"12536753","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"I think the problem here is that Task task_200710200555_0005_m_000725_0 failed and was killed while it was creating a file.\nTask task_200710200555_0005_m_000725_1 was started to create the same file, but the lease issued for task _0 had not expired yet.\nIf task _1 waited for not more than 60 seconds, the lease would expire and it would be able to claim a new lease for this file.\nI think the client should retry file creation if AlreadyBeingCreatedException is caught.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-22T17:27:26.141+0000","updated":"2007-10-22T17:27:26.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537104","id":"12537104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"From conversation with Hairong, DFSClient should be retrying automatically to create a file after a 1 minute sleep\nif it receives AlreadyBeingCreatedException. This is a part of the retry policy introduced by HADOOP-1263.\n\n# So the first question to answer is whether the retry frameworks does what it is intended to do that is retry.\n# If it does then we should look into why the first task (_0) does not shut down properly, because that would mean\nthe first task is still up and renewing the lease for the file.\n# And the last question is whether DFSClient SHOULD do automatic retries on AlreadyBeingCreatedException.\nI think hdfs create() should throw this exception to the application, because applications might want to create a different \nfile or wait for the lease to expire depending on its internal logic. In case of TestDFSIO it should wait.\nThrowing should be explicit, meaning that the create api should explicitly list AlreadyBeingCreatedException as one of \nthe exceptions thrown by create(), rather than just generic IOException.\n\nWhether its critical for 0.15 or not depends on whether we can run TestDFSIO benchmark. If the exception is thrown every\ntime we run it, then yes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-23T18:18:16.191+0000","updated":"2007-10-23T18:18:16.191+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537109","id":"12537109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"> So the first question to answer is whether the retry frameworks does what it is intended to do that is retry.\n\nRetry after one minute applies only when there is a timeout. Otherwise it retries after a few millisec. Comment from http://issues.apache.org/jira/browse/HADOOP-1263#action_12504135 :\n\n{quote}\nI am planning to use this framework for some new RPCs I am adding. I just want to confirm if my understanding is correct: This patch adds a random exponential back off timeout starting with 400 milliseconds for 5 times. In all 5 retries, this add a max of 12 seconds. Since client RPC timeout is 60sec, time it takes for such RPC to fail takes between 300-312 seconds over 6 attempts. Is this expected?, because it is not exponential back off but essentially constant timeout of around 60sec for each retry.\n{quote}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-23T18:37:21.204+0000","updated":"2007-10-23T18:37:21.204+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537184","id":"12537184","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mukundm","name":"mukundm","key":"mukundm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukund Madhugiri","active":true,"timeZone":"America/Los_Angeles"},"body":"I don't see this on every run of the TestDFSIO benchmark. The latest run that is just wrapping up does not exhibit this problem","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mukundm","name":"mukundm","key":"mukundm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukund Madhugiri","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-24T01:06:47.310+0000","updated":"2007-10-24T01:06:47.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537249","id":"12537249","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gautamk","name":"gautamk","key":"gautamk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gautam Kowshik","active":true,"timeZone":"Etc/UTC"},"body":"Mukund: This bug shows up when a DFSClient goes down during a file creation. It's only when this scenario is hit does the problem show up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gautamk","name":"gautamk","key":"gautamk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gautam Kowshik","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-24T09:18:10.588+0000","updated":"2007-10-24T09:18:10.588+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537438","id":"12537438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Raghu, the client retries for 5 times with a sleeping period of 1 min in between. This was done in HADOOP-1411.\n\nI did an experiment and it showed that the client retry did not break. I suspect that it might be the server that does not handle the lease expiration correctly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-24T22:28:09.000+0000","updated":"2007-10-24T22:28:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537454","id":"12537454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"Thats right. HADOOP-1411 seems to fix this for AlreadyBeingCreated exception.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-24T23:23:44.074+0000","updated":"2007-10-24T23:23:44.074+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12537804","id":"12537804","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Gautam, could you please check for every successful run of TestDFSIO, was there a failed map task? I just want to check if the described problem occurs whenever there is a failed map task.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-26T02:01:36.700+0000","updated":"2007-10-26T02:01:36.700+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12538550","id":"12538550","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mukundm","name":"mukundm","key":"mukundm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukund Madhugiri","active":true,"timeZone":"America/Los_Angeles"},"body":"I went thru the logs from the latest run and here is the information from the dfsio500 run,\nIn the JT logs, there are _0 tasks (10 of them) that fail to report status for 600+ seconds and are killed and a respective _1 task is added. This _1 task is the one that fails to write to the file and throws the AlreadyBeingCreatedException. Seems like task _0 was not cleanly killed?\n\nException log snippet from NN:\n2007-10-25 06:07:52,665 WARN org.apache.hadoop.dfs.StateChange: DIR* NameSystem.startFile: failed to create file /benchmarks/TestDFSIO/io_data/test_io_346 for DFSClient_task_200710250537_0003_m_000246_1 on client 72.30.51.88, because this file is already being created by DFSClient_task_200710250537_0003_m_000246_0 on 72.30.53.224\n2007-10-25 06:07:52,668 INFO org.apache.hadoop.ipc.Server: IPC Server handler 22 on 8020, call create(/benchmarks/TestDFSIO/io_data/test_io_346, DFSClient_task_200710250537_0003_m_000246_1, true, 3, 134217728) from 72.30.51.88:42152: error: org.apache.hadoop.dfs.AlreadyBeingCreatedException: failed to create file /benchmarks/TestDFSIO/io_data/test_io_346 for DFSClient_task_200710250537_0003_m_000246_1 on client 72.30.51.88, because this file is already being created by DFSClient_task_200710250537_0003_m_000246_0 on 72.30.53.224\norg.apache.hadoop.dfs.AlreadyBeingCreatedException: failed to create file /benchmarks/TestDFSIO/io_data/test_io_346 for DFSClient_task_200710250537_0003_m_000246_1 on client 72.30.51.88, because this file is already being created by DFSClient_task_200710250537_0003_m_000246_0 on 72.30.53.224\n\nException log snippet from JT:\n2007-10-25 05:44:34,742 INFO org.apache.hadoop.mapred.JobTracker: Adding task 'task_200710250537_0003_m_000246_0' to tip tip_200710250537_0003_m_000246, for tracker 'tracker_kry2996.inktomisearch.com:/127.0.0.1:54641'\n2007-10-25 06:07:51,219 INFO org.apache.hadoop.mapred.TaskInProgress: Error from task_200710250537_0003_m_000246_0: Task task_200710250537_0003_m_000246_0 failed to report status for 605 seconds. Killing!\n2007-10-25 06:07:51,220 INFO org.apache.hadoop.mapred.JobTracker: Removed completed task 'task_200710250537_0003_m_000246_0' from 'tracker_kry2996.inktomisearch.com:/127.0.0.1:54641'\n2007-10-25 06:07:51,221 INFO org.apache.hadoop.mapred.JobTracker: Adding task 'task_200710250537_0003_m_000246_1' to tip tip_200710250537_0003_m_000246, for tracker 'tracker_kry2778.inktomisearch.com:/127.0.0.1:41150'\n2007-10-25 06:09:09,326 INFO org.apache.hadoop.mapred.JobInProgress: Task 'task_200710250537_0003_m_000246_1' has completed tip_200710250537_0003_m_000246 successfully.\n2007-10-25 06:13:16,060 INFO org.apache.hadoop.mapred.JobTracker: Removed completed task 'task_200710250537_0003_m_000246_1' from 'tracker_kry2778.inktomisearch.com:/127.0.0.1:41150'\n2007-10-25 06:13:21,374 INFO org.apache.hadoop.mapred.JobTracker: Removed completed task 'task_200710250537_0003_m_000246_0' from 'tracker_kry2996.inktomisearch.com:/127.0.0.1:54641'","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mukundm","name":"mukundm","key":"mukundm","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mukund Madhugiri","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-29T18:11:15.356+0000","updated":"2007-10-29T18:11:15.356+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12538603","id":"12538603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"I agree with Mukund. It seems to me that it is possible that task_0 was not cleanly killed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-29T21:46:58.106+0000","updated":"2007-10-29T21:46:58.106+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380915/comment/12545683","id":"12545683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"Sounds like everybody agrees that the problem was that the client was not properly shutdown.\nIf so then HADOOP-1130 should have fixed it.\nMukund confirms he has not observed any problems running benchmarks for quite a while.\nI am closing the issue, please feel free to reopen if the problem resumes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-27T02:15:02.431+0000","updated":"2007-11-27T02:15:02.431+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-2087/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ih1r:"}}