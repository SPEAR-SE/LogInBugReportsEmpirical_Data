{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12398239","self":"https://issues.apache.org/jira/rest/api/2/issue/12398239","key":"HADOOP-3554","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2008-06-14T02:00:05.727+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Aug 11 18:41:36 UTC 2011","customfield_12310420":"65368","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_99719968149_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-08-11T18:41:36.387+0000","workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-3554/watchers","watchCount":1,"isWatching":false},"created":"2008-06-13T14:42:08.250+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":"surelogic","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":3600,"aggregatetimeoriginalestimate":3600,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312913","id":"12312913","description":"","name":"0.17.0","archived":false,"released":true,"releaseDate":"2008-05-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-08-11T18:41:36.395+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":3600,"description":"LineRecordReader has three index fields start, end, and pos.  All of these fields are long, which means that, in general, access to them is not atomic.  This can cause problems if the fields are accessed without appropriate synchronization.  \n\nI propose the following changes to the class:\n- Make the fields start and end final.  This requires some minor changes to the constructor LineRecordReader(Configuration, FileSplit).\n- Make the method getProgress() synchronized.\n","customfield_10010":null,"timetracking":{"originalEstimate":"1h","remainingEstimate":"1h","originalEstimateSeconds":3600,"remainingEstimateSeconds":3600},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12384065","id":"12384065","filename":"HADOOP-3445.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-16T15:25:58.634+0000","size":2942,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12384065/HADOOP-3445.patch"}],"aggregatetimeestimate":3600,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"104925","customfield_12312823":null,"summary":"LineRecordReader needs more synchronization","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":3600,"percent":0},"customfield_12311024":null,"environment":"All java platforms","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":3600,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/12604901","id":"12604901","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"body":"Patch file for the class that applies the above changes.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-13T14:42:57.022+0000","updated":"2008-06-13T14:42:57.022+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/12605027","id":"12605027","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Aaron-\n\n* Would you mind generating the patch with subversion? Other contribution guidelines are [here|http://wiki.apache.org/hadoop/HowToContribute].\n* It looks like there are some annotations/comments that made it into the patch. Could you remove them?\n* Though writing a test case demonstrating a race condition or synchronization issue might be difficult, do you have a way to reproduce a problem or would you describe how one might arise? Where is a LineRecordReader instance shared between threads?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-06-14T02:00:05.727+0000","updated":"2008-06-14T02:53:22.532+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/12605286","id":"12605286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"body":"Per Nigel Daley's request, I should point out that this bug was discovered using Sierra from SureLogic to view FindBug results.  The bug was correct with the assistance of JSure from SureLogic.  The annotations mentioned above are a result of that process.  \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-16T13:51:05.757+0000","updated":"2008-06-16T13:51:05.757+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/12605289","id":"12605289","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"body":"Chris,\n\nI will regenerate the patch with SVN with the annotations removed.\n\nHonestly, I don't know if the this class is used by multiple threads or not.  I haven't even run HADOOP.  As stated above, my attention was drawn to this class through the use of FindBugs through SureLogic Sierra.  This class was flagged by FindBugs because it had partial synchronization.  I describe above how to fix the synchronization.  But if, it is the case that instances of the class are not meant to be shared across threads, then no synchronization is necessary, the class documentation should indicate that instances of the class should not be used by more than 1 thread, and all the existing sychronization in the class should be removed.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-16T13:55:13.806+0000","updated":"2008-06-16T13:55:13.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/12605315","id":"12605315","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"body":"Okay.  After reevaluating in the SVN Trunk (rather than based on the 0.17.0 source code), the field maxLineLength also needs to be made final.\n\nSo, in summary\n* If objects of the class LineRecordReader really are used by multiple threads, then the class needs to be updated:\n  - Make the fields start, end, and maxLineLength final.\n  - Make the method getProgress() synchronized.\n* Otherwise, remove the existing synchronization from methods next(), getPos(), and close() and update the class documentation to indicate that instances are not thread safe.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-16T15:24:28.846+0000","updated":"2008-06-16T15:24:28.846+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/12605317","id":"12605317","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"body":"Patch that applies the described changes.  Replaces the original patch.  This one is correctly generated by SVN.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aarongreenhouse","name":"aarongreenhouse","key":"aarongreenhouse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Aaron Greenhouse","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-16T15:25:58.656+0000","updated":"2008-06-16T15:25:58.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12398239/comment/13083359","id":"13083359","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"Out of date","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-08-11T18:41:36.394+0000","updated":"2011-08-11T18:41:36.394+0000"}],"maxResults":7,"total":7,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-3554/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ibav:"}}