{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12655539","self":"https://issues.apache.org/jira/rest/api/2/issue/12655539","key":"HADOOP-9679","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-07-01T16:45:34.179+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Apr 10 19:24:07 UTC 2015","customfield_12310420":"335814","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-9679/watchers","watchCount":7,"isWatching":false},"created":"2013-07-01T06:08:38.830+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321658","id":"12321658","description":"maintenance release on branch-1.1","name":"1.1.1","archived":false,"released":true,"releaseDate":"2012-11-27"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324135","id":"12324135","description":"2.0.4-alpha bug-fix release","name":"2.0.4-alpha","archived":false,"released":true,"releaseDate":"2013-04-25"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-04-10T19:24:07.880+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312526","id":"12312526","name":"security"}],"timeoriginalestimate":null,"description":"I am using hadoop-1.1.1 to add kerberos authentication to a web service. But found rules are not initialized, that makes following error happened:\njava.lang.NullPointerException\n        at org.apache.hadoop.security.KerberosName.getShortName(KerberosName.java:384)\n        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler$2.run(KerberosAuthenticationHandler.java:328)\n        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler$2.run(KerberosAuthenticationHandler.java:302)\n        at java.security.AccessController.doPrivileged(AccessController.java:310)\n        at javax.security.auth.Subject.doAs(Subject.java:573)\n        at org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler.authenticate(KerberosAuthenticationHandler.java:302)\n        at org.apache.hadoop.security.authentication.server.AuthenticationFilter.doFilter(AuthenticationFilter.java:340)\n\nSeems in hadoop-2.0.4-alpha branch, this issue still is still there. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12590566","id":"12590566","filename":"HADOOP-9679.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-03T02:58:02.272+0000","size":1349,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12590566/HADOOP-9679.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"336138","customfield_12312823":null,"summary":"KerberosName.rules are not initialized during adding kerberos support to a web servlet using hadoop authentications","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13696603","id":"13696603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"body":"With hadoop-2.0.3, seems this issue can be avoided via setting kerberos.name.rules at server side. But this setting does not work at hadoop-1.1.1. \nI think we should set KerberosName.rules with a default value during KerberosName(String Name) which is invoked at KerberosAuthenticationHandler.authenticate(HttpServletRequest request, final HttpServletResponse response) .","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-01T06:17:36.459+0000","updated":"2013-07-01T06:17:36.459+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13696639","id":"13696639","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"body":"Generate a draft fix based on branch-2.0.4-alpha KerberosAuthenticationHandler.authenticate(HttpServletRequest request, final HttpServletResponse response).\n\n                 String clientPrincipal = gssContext.getSrcName().toString();\n                 KerberosName kerberosName = new KerberosName(clientPrincipal);\n+                if( !KerberosName.hasRulesBeenSet()){\n+                       LOG.warn(\"No rules applied to \" + kerberosName.toString() + \". Using DEFAULT rules.\");\n+                       KerberosName.setRules(\"DEFAULT\");\n+                }\n                 String userName = kerberosName.getShortName();\n                 token = new AuthenticationToken(userName, clientPrincipal, getType());\n                 response.setStatus(HttpServletResponse.SC_OK);\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-01T07:55:14.424+0000","updated":"2013-07-01T07:55:14.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13696642","id":"13696642","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"body":"Patch based on hadoop-2.0.4-alpha branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-01T07:59:41.079+0000","updated":"2013-07-01T07:59:41.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13696944","id":"13696944","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"[~fang fang chen] Please provide the patch for the trunk. Set the target version field to the release that is due out (in this case 2.1.0-beta). Committer will merge the patch to that branch.\n\nQuick comment, please follow coding guidelines. Use 2 space indentation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-07-01T16:45:34.179+0000","updated":"2013-07-01T16:45:34.179+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13697157","id":"13697157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"[~tucu00], I seem to recall us investigating a similar issue with UGI & SPNEGO.  Does this look correct to you?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2013-07-01T20:45:43.953+0000","updated":"2013-07-01T20:45:43.953+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13697383","id":"13697383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tucu00","name":"tucu00","key":"tucu00","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alejandro Abdelnur","active":true,"timeZone":"Europe/Madrid"},"body":"on the patch, setting the rules on a request is not correct. if we need to do this it should be done during initialization.\n\nThe logic is a bit twisted as UGI.ensureInitialized() sets the rules only if they have not been set.\n\nThe think I don't understand is in which scenario the filter would be invoked before the UGI is 'ensureInitialized()'","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tucu00","name":"tucu00","key":"tucu00","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alejandro Abdelnur","active":true,"timeZone":"Europe/Madrid"},"created":"2013-07-02T00:50:25.089+0000","updated":"2013-07-02T00:50:25.089+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13698496","id":"13698496","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi Alejando,\n\nThanks for you reply.\nYou are right, I am using this outside of Hadoop. From user side, it will be great if he can use hadoop-auth classes to add kerberos support to any web servlet. Then I tried this, and it works besides the rules issue.\nAnd I agree with you that it will work if we set kerberos.name.rules in my AuthFilter(hard code). But from user side, I think it will be better if we can configure kerberos.name.rules at a configuration file(if set it in servers configuration file, it does not work directly). And use a default value if user did not set this property in his authFilter, just like other kerberos properties set in hdfs-site.xml/core-site.xml.\nThe fix is for using hadoop-auth outside Hadoop, then it will not invoke GUI. Maybe this is not the original usage of hadoop-auth. But I think hadoop has provided excellent kerberos authentications API which is very convenient for users to add kerberos support to any web service. And we can expand the hadoop-auth to any web servlet no matter this servlet is hadoop client or not. Just like what commons-logging did. Java provided logging APIs, but we choose to use commons-logging because it is more convenient and effective. What do you think?\n\nThanks~\n\n\n\nPost Alejandro's mail reply here: \nHi Lulynn,\n\nI've commented in the JIRA, now that I see your email that gives me a bit\nmore of context on what you are trying to do.\n\nIf I understand correctly, you are trying to use this outside of Hadoop. If\nthat is the case you should set the <PREFIX>.kerberos.name.rules=DEFAULT\n(or a custom name.rules if you have one) in your hadoop-auth\nAuthenticationFilter configuration.\n\nThis is required because you are not initializing UGI before initializing\nthe filter.\n\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-03T02:01:56.282+0000","updated":"2013-07-03T02:01:56.282+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13698538","id":"13698538","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"body":"Update patch per Suresh's comments. Current patch is based on trunk branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-03T03:38:52.937+0000","updated":"2013-07-03T03:38:52.937+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13698542","id":"13698542","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tucu00","name":"tucu00","key":"tucu00","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alejandro Abdelnur","active":true,"timeZone":"Europe/Madrid"},"body":"Lulynn,\n\nbq.  But from user side, I think it will be better if we can configure kerberos.name.rules at a configuration file(if set it in servers configuration file, it does not work directly). And use a default value if user did not set this property in his authFilter, just like other kerberos properties set in hdfs-site.xml/core-site.xml.\n\nyou don't need to hardcode it, it can be set it the configuration you use for the authentication filter. The hadoop-auth AuthenticationFilter takes its configuration from the filter definition in the web.xml. But you can create a subclass that overrides the getConfiguration(String configPrefix, FilterConfig filterConfig) to read it from any other place. The javadocs explain how config prefixes are handled.\n\nAgain, as I mentioned in my previous comment, the patch is not correct, you don't want to set the name.rules on every authentication request. This is an init thing, and it already handled. You have to set your config to 'DEFAULT; and you are done.\n\nIMO, this is not a bug.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tucu00","name":"tucu00","key":"tucu00","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alejandro Abdelnur","active":true,"timeZone":"Europe/Madrid"},"created":"2013-07-03T03:49:09.938+0000","updated":"2013-07-03T03:49:09.938+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13698641","id":"13698641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"body":"Thanks Alejandro. Actually, I have overwritten getConfiguration(String configPrefix, FilterConfig filterConfig), and am trying to testing whether these properties can be passed to KerberosAuthenticationHandler.authenticate(.. , ..) part.\n\nOK, for the usage inside hadoop, I agree this is not a bug. Because we always assume user should have done UGI 'ensureInitialized()' before invoke KerberosName and if user did not set this property, hadoop will use \"DEFAULT\" as default value. So this is not an init thing for the design inside hadoop, and I think it reasonable to provide a default value if user did not set it. \n\nThen for the usage outside hadoop, this is an init thing. As user need to set kerberos.name.rules before using hadoop-auth to add kerberos support to a web servlet. If things is like this, then I think at least it's better to remind user to set this property if user did not than just print out a \"NullPointerException\". \n\nActually, both are OK for me to add this property at web servlet side or hadoop-auth provide a dafult value in hadoop side. I just want to make this usage of hadoop-auth to be more smarter and simple.\n\nAgain, as I mentioned in my previous comment. I think the usage of hadoop kerberos authentication can be expanded. At least, maybe we can provide user a document to show that how to add kerberos support via hadoop-auth classes. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fang+fang+chen","name":"fang fang chen","key":"fang fang chen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"fang fang chen","active":true,"timeZone":"Asia/Shanghai"},"created":"2013-07-03T05:56:34.569+0000","updated":"2013-07-03T05:56:34.569+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/13701011","id":"13701011","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tucu00","name":"tucu00","key":"tucu00","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alejandro Abdelnur","active":true,"timeZone":"Europe/Madrid"},"body":"Improving doc is always good, current doc is at http://hadoop.apache.org/docs/current/hadoop-auth/index.html\n\nWithin Hadoop name.rules are set in the core-site.xml file, that is why the code in hadoop-auth does not set it (even to default).\n\nIf using hadoop-auth outside of hadoop (Oozie uses it and I believe Hbase does too) you have to set the the name.rules property explicitly even if to default because Hadoop UserGroupInformation is not there and i won't do it.\n\nhope this clarifies.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tucu00","name":"tucu00","key":"tucu00","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alejandro Abdelnur","active":true,"timeZone":"Europe/Madrid"},"created":"2013-07-05T17:22:46.895+0000","updated":"2013-07-05T17:22:46.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12655539/comment/14490185","id":"14490185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Removing Fix-version. Please use Target-version for the intended release and let committers set the fix-version at commit time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-04-10T19:24:07.867+0000","updated":"2015-04-10T19:24:07.867+0000"}],"maxResults":12,"total":12,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-9679/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1lxbz:"}}