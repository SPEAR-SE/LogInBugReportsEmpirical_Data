{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12375814","self":"https://issues.apache.org/jira/rest/api/2/issue/12375814","key":"HADOOP-1708","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312565","id":"12312565","description":"","name":"0.15.0","archived":false,"released":true,"releaseDate":"2007-10-19"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-08-16T21:04:32.206+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Oct 01 18:09:49 UTC 2007","customfield_12310420":"125369","customfield_12312320":null,"customfield_12310222":"3_*:*_1_*:*_316110_*|*_10002_*:*_1_*:*_18402_*|*_1_*:*_1_*:*_515006056_*|*_6_*:*_1_*:*_0_*|*_5_*:*_2_*:*_4977503587_*|*_4_*:*_1_*:*_2000038787","customfield_12312321":null,"resolutiondate":"2007-09-13T09:06:57.511+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-1708/watchers","watchCount":0,"isWatching":false},"created":"2007-08-11T00:50:50.063+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12317306","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12317306","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12376650","key":"HADOOP-1765","self":"https://issues.apache.org/jira/rest/api/2/issue/12376650","fields":{"summary":"IOException on close: Unknown file","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12317102","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12317102","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12330363","key":"HADOOP-89","self":"https://issues.apache.org/jira/rest/api/2/issue/12330363","fields":{"summary":"files are not visible until they are closed","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:42:21.460+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"In the current DFS implementation, a file appears in the namespace only when the creator closes the file. Also, if the namenode or the client dies before closing the file, the file never appears in the namespace.\n\nThis issue will make files appear in the namespace as soon as it is created. Also, it will continue to remain in the namespace even if the creator dies before closing the file.\n\nThis is related to HADOOP-89. It is different from HADOOP-89 because it does not attempt to make data visible as soon as it is written. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12364202","id":"12364202","filename":"1708-20070820a.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-21T04:16:38.596+0000","size":2029,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12364202/1708-20070820a.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12363728","id":"12363728","filename":"atomicCreation2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2007-08-13T21:48:24.865+0000","size":8657,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12363728/atomicCreation2.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"102689","customfield_12312823":null,"summary":"make files visible in the namespace as soon as they are created","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12519536","id":"12519536","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"Updates patch merged with latest trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2007-08-13T21:48:24.992+0000","updated":"2007-08-13T21:48:24.992+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12520372","id":"12520372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"+1 The code looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2007-08-16T21:04:32.206+0000","updated":"2007-08-16T21:04:32.206+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12520414","id":"12520414","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"I just committed this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2007-08-16T23:54:34.501+0000","updated":"2007-08-16T23:54:34.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12520640","id":"12520640","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"body":"Is it the right behavior, to keep the file directory entry even if the creator calls abandonFileInProgress?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-17T18:58:53.129+0000","updated":"2007-08-17T18:58:53.129+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12521316","id":"12521316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"body":"I would suggest this modification which removes the file entry from the directory tree when a client abandons a file being created.\n - added a test case for this\n\nJUnit tests pass successfully.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-21T04:16:38.668+0000","updated":"2007-08-21T04:16:38.668+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12521630","id":"12521630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"body":"-1\n\nThe presence of abandonFileInProgress was a necessary side effect of files not being visible when they were created. Now that they are, this is no longer needed. In any case, the only reliable way to prevent clients from stepping on each others toes is to use temporary filenames and then promote them to final names as is done in map/reduce. A client that needs to call abandonFileInProgress as your test case does can just as easily call delete.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-21T22:55:29.306+0000","updated":"2007-08-21T22:55:29.306+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12521632","id":"12521632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"body":"Should we merge abandonFileInProgress into delete then, and mark abandonFileInProgress as deprecated?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-21T23:02:36.085+0000","updated":"2007-08-21T23:02:36.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12521646","id":"12521646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"body":"I think that makes sense.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-22T00:41:26.897+0000","updated":"2007-08-22T00:41:26.897+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12521927","id":"12521927","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"body":"Anyway, a pending create which is never completed (e.g. because the client died) should remove the file entry... As well, to preserve some compatibility with the current semantic, the abandonFileInProgress operation need to be updated to delete the file entry.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-22T20:56:25.426+0000","updated":"2007-08-22T20:56:25.426+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12522263","id":"12522263","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"\nBefore this patch, completeInternal() looked up file INode twice. Since a fileINode is supposed to exist with this patch, we can avoid one INode look up. INode lookup is a little costly since it parses the full path and iterates down the directory tree.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-23T20:54:39.097+0000","updated":"2007-08-23T20:54:39.097+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12522267","id":"12522267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"What should the semantics of other file modications like reaname(), delete() be? Currently it looks like file can be created and before it is closed some one could rename it. Of course close() will fail.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-23T21:09:39.935+0000","updated":"2007-08-23T21:09:39.935+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12522289","id":"12522289","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"I think we should revert this patch until the semantics are are clear. See HADOOP-1765 for one of the affected cases.\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-23T22:15:19.478+0000","updated":"2007-08-23T22:15:19.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12522297","id":"12522297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"body":"I agree. At least in a short term, the semantics should remain as it is when the file is not visible, meaning that a file being created cannot be deleted or renamed before it is completed.\nIdeally however, renaming and deletion should also work on file being created. Renaming should not interfere with the file creation, while deletion should prevent it to complete.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kryzthov","name":"kryzthov","key":"kryzthov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kryzthov&avatarId=16188","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kryzthov&avatarId=16188","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kryzthov&avatarId=16188","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kryzthov&avatarId=16188"},"displayName":"Christophe Taton","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-23T22:35:18.577+0000","updated":"2007-08-23T22:35:18.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12522564","id":"12522564","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"body":"> Anyway, a pending create which is never completed ...\n\nWhy? Yes, it is a departure from the current semantics, but something that is quite intentional. Calling delete should be the responsibility of user code not the client library. This issue is one of the steps towards introducing append. With appends in place, we want exactly the behavior that when a client dies we don't delete a pending file, so that it or another client can resume where it left off.\n\n> Ideally however, renaming and deletion should also work on file being created. \n\nSo, rather than revert the change, I'd vote for implementing this behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-24T15:30:46.071+0000","updated":"2007-08-24T15:30:46.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12522628","id":"12522628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"Yes we knew this changes the semantics of file creates, but we did not take into account that semantics of deletes/renames will change too.\nI do not think we have  a consensus on what it should be.\nImho until we define the semantics and implement it the patch should be reverted (if it is still possible).\n\n> Ideally however, renaming and deletion should also work on file being created.\n\nWould it be more consistent to forbid deletion of files that have active leases.\nI agree rename should work on being created file, but then we will have to introduce file ids for accessing files that have been opened.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-24T19:43:03.938+0000","updated":"2007-08-24T19:43:03.938+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12523118","id":"12523118","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"body":"> Yes we knew this changes the semantics of file creates, but we did not take into account that semantics of deletes/renames will change too.\n\nHow not? The semantics for delete and rename for files that are being written are consistent with the semantics of delete and rename for files that are in the namespace and that have been completed and closed. If a client is reading a 'complete' file and that file gets deleted or renamed then the reader will fail. Arguably, this is a flaw in the filesystem, but addressing that is a different discussion.\n\nAll this issue does is make files visible in the namespace as they are created and while they are being written. Delete and rename semantics for these files are the same as for all other files.\n\n> Would it be more consistent to forbid deletion of files that have active leases.\n\nIt might be, but the change should apply to all files that are being written or read. I guess that is what you mean by files with active leases. It might be better to fix it so that files can be deleted and renamed as they are being operated on, with POSIX semantics. We should file a different JIRA issue for this.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sameerp","name":"sameerp","key":"sameerp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34061","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"},"displayName":"Sameer Paranjpye","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-08-27T22:32:49.545+0000","updated":"2007-08-27T22:32:49.545+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12526963","id":"12526963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"There is another more immediate issue with the patch. If a file is started but is not closed, when NameNode is restarted, it appears as a directory while loading the fsimage. Currently if number of blocks is zero, then it is treated as a directory in while loading fsimage.  Should we file another jira for it?\n\nI was working with patch for HADOOP-1298 which has directory specific fields, I saw for the first time an EOF error while loading the fsimage.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-09-13T01:18:11.165+0000","updated":"2007-09-13T01:18:11.165+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12527037","id":"12527037","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"I have a patch for the above-mentioned problem. Please see HADOOP-1887.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2007-09-13T09:02:19.883+0000","updated":"2007-09-13T09:02:19.883+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12527038","id":"12527038","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"Erroneously opened this issue. Follow-up work in HADOOP-1887.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2007-09-13T09:06:57.504+0000","updated":"2007-09-13T09:06:57.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12527143","id":"12527143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"body":"Dhruba, HADOOP-1887 is not related to my above comment. But you might have fixed both in HADOOP-1887.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rangadi","name":"rangadi","key":"rangadi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Raghu Angadi","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-09-13T15:31:37.342+0000","updated":"2007-09-13T15:31:37.342+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12375814/comment/12531586","id":"12531586","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Nightly #256 (See [http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/256/])","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-01T18:09:49.912+0000","updated":"2007-10-01T18:09:49.912+0000"}],"maxResults":21,"total":21,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-1708/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0hxhz:"}}