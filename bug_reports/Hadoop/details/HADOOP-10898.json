{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12730440","self":"https://issues.apache.org/jira/rest/api/2/issue/12730440","key":"HADOOP-10898","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2016-11-03T19:20:17.734+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Nov 03 21:49:49 UTC 2016","customfield_12310420":"408513","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10898/watchers","watchCount":2,"isWatching":false},"created":"2014-07-29T09:02:32.234+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-11-03T21:49:49.192+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310687","id":"12310687","name":"io","description":""}],"timeoriginalestimate":null,"description":"When a data stream contains several MapWritable instances, which contain instances of several different custom classes (implementing Writable), attempting to reuse a single MapWritable instance for reading the data stream results in an IllegalArgumentException. This happens because AbstractMapWritable.readFields doesn't reset the classToIdMap/idToClassMap data structures.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12658391","id":"12658391","filename":"HADOOP-10898.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"created":"2014-07-29T10:47:59.707+0000","size":3443,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12658391/HADOOP-10898.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"408511","customfield_12312823":null,"summary":"MapWritable instances cannot be reused when containing different custom Writable classes.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730440/comment/14077538","id":"14077538","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"body":"Test case:\nLet CustomWritableA and CustomWritableB be 2 custom implementations of Writable.\n1. (Acting as a producer of data) Create a MapWritable. Add an instance of CustomWritableA as a key or a value. Write the MapWritable to a data stream.\n2. Create another MapWritable. Add an instance of CustomWritableB. Write the MapWritable to the same data stream.\n3. (As a consumer of the data stream) Create a separate MapWritable instance and read from the data stream. The instance is correctly populated with CustomWritableA.\n4. Now, attempt to reuse the MapWritable instance and read again from the data stream. The instance should be populated with CustomWritableB, but the actual result is an IllegalArgumentException: \"Id 1 exists but maps to CustomWritableA and not CustomWritableB\". ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"created":"2014-07-29T09:10:00.369+0000","updated":"2014-07-29T09:10:00.369+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730440/comment/14077604","id":"14077604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"body":"Proposed patch attached and ready for review. It adds cleanup of the classToIdMap/idToClassMap data structures in AbstractMapWritable.readFields, and a new unit test in TestMapWritable. The initialization of the classToIdMap/idToClassMap maps in AbstractMapWritable was extracted to a separate method, addDefaultsToMap.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"created":"2014-07-29T10:53:08.961+0000","updated":"2014-07-29T10:53:08.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730440/comment/15633919","id":"15633919","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ViniciusMSAna","name":"ViniciusMSAna","key":"viniciusmsana","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinicius Maciel Sant' Ana","active":true,"timeZone":"Etc/UTC"},"body":"Hey there, Eli Acherkan.\nYour issue is a duplicate from https://issues.apache.org/jira/browse/HADOOP-9295\nThe author there had the same problem and proposed a similar solution, maybe you can help there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ViniciusMSAna","name":"ViniciusMSAna","key":"viniciusmsana","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinicius Maciel Sant' Ana","active":true,"timeZone":"Etc/UTC"},"created":"2016-11-03T19:20:17.734+0000","updated":"2016-11-03T19:20:17.734+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730440/comment/15634094","id":"15634094","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"body":"Thanks [~ViniciusMSAna], it definitely looks like the same issue. I'd love to help there (and I think the patch I attached should solve the problem), but I'm a bit unfamiliar with the process - could you tell me what should I do?.. The last comment on that issue says \"Marking it \"Unassgined\" in case someone else wants to take a stab it. Will reclaim if it is still open by the time I get to it.\"","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eliac","name":"eliac","key":"eliac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Acherkan","active":true,"timeZone":"Asia/Jerusalem"},"created":"2016-11-03T20:12:26.924+0000","updated":"2016-11-03T20:12:57.993+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12730440/comment/15634402","id":"15634402","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ViniciusMSAna","name":"ViniciusMSAna","key":"viniciusmsana","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinicius Maciel Sant' Ana","active":true,"timeZone":"Etc/UTC"},"body":"The user responsible for that issue seems to be inactive, maybe you could contact [~davidparks21] since he was the reporter.\n\nSince you said your patch should fix the problem, you could try contributing following this guide: https://wiki.apache.org/hadoop/HowToContribute","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ViniciusMSAna","name":"ViniciusMSAna","key":"viniciusmsana","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinicius Maciel Sant' Ana","active":true,"timeZone":"Etc/UTC"},"created":"2016-11-03T21:49:49.192+0000","updated":"2016-11-03T21:49:49.192+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-10898/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1yahj:"}}