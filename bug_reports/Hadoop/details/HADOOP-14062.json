{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13029311","self":"https://issues.apache.org/jira/rest/api/2/issue/13029311","key":"HADOOP-14062","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329058","id":"12329058","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339180","id":"12339180","name":"3.0.0-alpha4","archived":false,"released":true,"releaseDate":"2017-07-07"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2016-12-20T04:42:01.819+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Mar 10 17:26:49 UTC 2017","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_2_*:*_5870155592_*|*_4_*:*_1_*:*_14110843_*|*_5_*:*_2_*:*_8149253_*|*_10002_*:*_3_*:*_1080245914","customfield_12312321":null,"resolutiondate":"2017-03-10T17:26:49.774+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-14062/watchers","watchCount":12,"isWatching":false},"created":"2016-12-20T00:35:48.233+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329058","id":"12329058","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-03-10T17:26:49.832+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"When privacy is enabled for RPC (hadoop.rpc.protection = privacy), {{ApplicationMasterProtocolPBClientImpl.allocate}} sometimes (but not always) fails with an EOFException. I've reproduced this with Spark 2.0.2 built against latest branch-2.8 and with a simple distcp job on latest branch-2.8.\n\nSteps to reproduce using distcp:\n\n1. Set hadoop.rpc.protection equal to privacy\n2. Write data to HDFS. I did this with Spark as follows: \n\n{code}\nsc.parallelize(1 to (5*1024*1024)).map(k => Seq(k, org.apache.commons.lang.RandomStringUtils.random(1024, \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWxyZ0123456789\")).mkString(\"|\")).toDF().repartition(100).write.parquet(\"hdfs:///tmp/testData\")\n{code}\n\n3. Attempt to distcp that data to another location in HDFS. For example:\n\n{code}\nhadoop distcp -Dmapreduce.framework.name=yarn hdfs:///tmp/testData hdfs:///tmp/testDataCopy\n{code}\n\nI observed this error in the ApplicationMaster's syslog:\n\n{code}\n2016-12-19 19:13:50,097 INFO [eventHandlingThread] org.apache.hadoop.mapreduce.jobhistory.JobHistoryEventHandler: Event Writer setup for JobId: job_1482189777425_0004, File: hdfs://<namenode_host>:8020/tmp/hadoop-yarn/staging/<hdfs_user>/.staging/job_1482189777425_0004/job_1482189777425_0004_1.jhist\n2016-12-19 19:13:51,004 INFO [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator: Before Scheduling: PendingReds:0 ScheduledMaps:4 ScheduledReds:0 AssignedMaps:0 AssignedReds:0 CompletedMaps:0 CompletedReds:0 ContAlloc:0 ContRel:0 HostLocal:0 RackLocal:0\n2016-12-19 19:13:51,031 INFO [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerRequestor: getResources() for application_1482189777425_0004: ask=1 release= 0 newContainers=0 finishedContainers=0 resourcelimit=<memory:22528, vCores:23> knownNMs=3\n2016-12-19 19:13:52,043 INFO [RMCommunicator Allocator] org.apache.hadoop.io.retry.RetryInvocationHandler: Exception while invoking ApplicationMasterProtocolPBClientImpl.allocate over null. Retrying after sleeping for 30000ms.\njava.io.EOFException: End of File Exception between local host is: \"<application_master_host>/<ip_addr>\"; destination host is: \"<rm_host>\":8030; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:422)\n\tat org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:801)\n\tat org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:765)\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1486)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1428)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1338)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:227)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)\n\tat com.sun.proxy.$Proxy80.allocate(Unknown Source)\n\tat org.apache.hadoop.yarn.api.impl.pb.client.ApplicationMasterProtocolPBClientImpl.allocate(ApplicationMasterProtocolPBClientImpl.java:77)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:398)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:163)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:155)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:335)\n\tat com.sun.proxy.$Proxy81.allocate(Unknown Source)\n\tat org.apache.hadoop.mapreduce.v2.app.rm.RMContainerRequestor.makeRemoteRequest(RMContainerRequestor.java:204)\n\tat org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator.getResources(RMContainerAllocator.java:735)\n\tat org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator.heartbeat(RMContainerAllocator.java:269)\n\tat org.apache.hadoop.mapreduce.v2.app.rm.RMCommunicator$AllocatorRunnable.run(RMCommunicator.java:281)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:392)\n\tat org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1785)\n\tat org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1156)\n\tat org.apache.hadoop.ipc.Client$Connection.run(Client.java:1053)\n{code}\n\nMarking as \"critical\" since this blocks YARN users from encrypting RPC in their Hadoop clusters.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12329058","id":"12329058","description":"2.8.0 release","name":"2.8.0","archived":false,"released":true,"releaseDate":"2017-03-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12339180","id":"12339180","name":"3.0.0-alpha4","archived":false,"released":true,"releaseDate":"2017-07-07"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12851738","id":"12851738","filename":"HADOOP-14062.001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-08T21:55:01.820+0000","size":18635,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12851738/HADOOP-14062.001.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12851926","id":"12851926","filename":"HADOOP-14062.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-09T19:20:38.589+0000","size":22457,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12851926/HADOOP-14062.002.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12852762","id":"12852762","filename":"HADOOP-14062.003.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-15T08:36:38.642+0000","size":2875,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12852762/HADOOP-14062.003.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12856906","id":"12856906","filename":"HADOOP-14062.004.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-09T01:15:04.391+0000","size":2889,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12856906/HADOOP-14062.004.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12851925","id":"12851925","filename":"HADOOP-14062-branch-2.8.0.004.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-09T19:20:38.583+0000","size":18752,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12851925/HADOOP-14062-branch-2.8.0.004.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12854059","id":"12854059","filename":"HADOOP-14062-branch-2.8.0.005.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-22T20:31:56.428+0000","size":3728,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12854059/HADOOP-14062-branch-2.8.0.005.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12852759","id":"12852759","filename":"HADOOP-14062-branch-2.8.0.005.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-15T07:52:42.858+0000","size":3728,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12852759/HADOOP-14062-branch-2.8.0.005.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12855696","id":"12855696","filename":"HADOOP-14062-branch-2.8.0.dummy.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-02T21:16:09.011+0000","size":1395,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12855696/HADOOP-14062-branch-2.8.0.dummy.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12844108","id":"12844108","filename":"yarn-rm-log.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2016-12-20T18:10:13.533+0000","size":3409413,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12844108/yarn-rm-log.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"ApplicationMasterProtocolPBClientImpl.allocate fails with EOFException when RPC privacy is enabled","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15763232","id":"15763232","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"[~Steven Rand], do you have server side log where this exception happens?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-12-20T04:42:01.819+0000","updated":"2016-12-20T04:42:01.819+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15764843","id":"15764843","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe], I've attached the log from the Resource Manager while the distcp job is running. It contains no errors or warnings, and as far as I can tell nothing out of the ordinary.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2016-12-20T18:10:13.546+0000","updated":"2016-12-20T18:10:13.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15822052","id":"15822052","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"This issue also reproduces on latest branch-2.8.0 (most recent commit at the time of writing being e94a2bcfa82be0e24a49585b50dfdd0c3dfeb2e7). A cleaner repro than the one given above, by the way, is to simply run {{hadoop jar hadoop-2.8.0-SNAPSHOT/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.8.0-SNAPSHOT-tests.jar TestDFSIO -write -nrFiles 10 -fileSize 1000}}.\n\nI will try to debug this today, but I haven't made much progress in my previous attempts, so any help or tips would be greatly appreciated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-13T17:45:42.487+0000","updated":"2017-01-13T17:45:42.487+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15822290","id":"15822290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Relevant part of AM container log at DEBUG level:\n\n{code}\n2017-01-13 14:27:45,422 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: Sending sasl message state: NEGOTIATE\n\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: Get token info proto:interface org.apache.hadoop.yarn.api.ApplicationMasterProtocolPB info:org.apache.hadoop.yarn.security.SchedulerSecurityInfo$1@76856ec2\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.yarn.security.AMRMTokenSelector: Looking for a token with service 10.0.22.125:8030\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.yarn.security.AMRMTokenSelector: Token kind is YARN_AM_RM_TOKEN and the token's service name is 10.0.22.125:8030\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: Creating SASL DIGEST-MD5(TOKEN)  client to authenticate to service at default\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: Use TOKEN authentication for protocol ApplicationMasterProtocolPB\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: SASL client callback: setting username: Cg0KCQgDELeEw8iZKxABEOq0jBE=\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: SASL client callback: setting userPassword\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: SASL client callback: setting realm: default\n2017-01-13 14:27:45,423 DEBUG [RMCommunicator Allocator] org.apache.hadoop.security.SaslRpcClient: Sending sasl message state: INITIATE\ntoken: \"charset=utf-8,username=\\\"Cg0KCQgDELeEw8iZKxABEOq0jBE=\\\",realm=\\\"default\\\",nonce=\\\"WR1cP6XR4aRmnTNDvPNIJVyQoVcKs/L31wZ/2aTq\\\",nc=00000001,cnonce=\\\"h2O79JUxneBTofVfLlzS4BnkU1k2QWeFV8K0f6V7\\\",digest-uri=\\\"/default\\\",maxbuf=65536,response=5c07c8484a146548ee71bc1347451c23,qop=auth-conf,cipher=\\\"3des\\\"\"\nauths {\n  method: \"TOKEN\"\n  mechanism: \"DIGEST-MD5\"\n  protocol: \"\"\n  serverId: \"default\"\n}\n\n2017-01-13 14:27:45,425 DEBUG [RMCommunicator Allocator] org.apache.hadoop.ipc.Client: Negotiated QOP is :auth-conf\n2017-01-13 14:27:45,425 DEBUG [IPC Parameter Sending Thread #0] org.apache.hadoop.ipc.Client: IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER> sending #25\n2017-01-13 14:27:45,426 DEBUG [IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>] org.apache.hadoop.ipc.Client: IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>: starting, having connections 2\n2017-01-13 14:27:45,426 DEBUG [IPC Parameter Sending Thread #0] org.apache.hadoop.security.SaslRpcClient: wrapping token of length:306\n2017-01-13 14:27:45,427 DEBUG [IPC Parameter Sending Thread #0] org.apache.hadoop.security.SaslRpcClient: Sending sasl message state: WRAP\ntoken: \"i\\236:\\323o!\\016C\\032\\032\\303c%I\\036\\305\\245\\253J\\271\\311\\226\\213\\246\\234\\260\\341\\315\\371p\\017\\271\\027k\\223\\367D\\326\\276\\210e\\330\\237\\207\\247\\r\\002\\037\\004\\031l\\231q\\203\\232rnx\\271\\317h\\017\\247\\357\\325_}\\233s,\\250\\340\\002\\345\\3318\\364\\307\\246\\032+\\fI\\307\\366\\351\\303l\\006\\030\\tY\\251\\205WE\\227;\\276\\022Z\\210\\363W\\317\\252\\376$\\316\\243\\214\\313\\004\\317hv\\033\\333\\211\\230w\\273s\\375S\\260\\262\\205}\\343\\033\\362m\\006\\a\\250\\236e\\266\\034\\362\\352\\317\\211=F\\367#H6\\237\\322\\232$]\\217%\\340\\260Y\\330\\034\\302\\266\\315\\201*=//\\350\\220U\\276lk\\345\\253o\\021\\242e\\365M&\\200\\037\\235?O\\224\\371\\317\\2322{f\\262\\270\\323\\b\\247\\264\\364\\231\\243\\257\\342\\334e\\036d\\001ez\\266`R\\362\\026~\\340.A\\356]E\\331\\005\\214\\033E\\223\\202\\t\\275\\275h\\355\\v\\240B\\300\\265\\335\\303a\\021\\326 \\331\\247\\206f|\\211H|E~\\334;\\210\\371p\\370\\222^\\241O\\005;3\\rNY\\2456\\006\\257\\222\\220K;\\363\\222J\\311\\006\\030\\243\\337\\340pG/\\357w\\017\\2276Z~\\313\\303\\241\\246\\016\\232_\\345D\\374\\343o\\266\\231yF\\371\\000\\001\\000\\000\\000\\000\"\n\n2017-01-13 14:27:45,427 DEBUG [IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>] org.apache.hadoop.security.SaslRpcClient: reading next wrapped RPC packet\n2017-01-13 14:27:45,430 DEBUG [IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>] org.apache.hadoop.security.SaslRpcClient: unwrapping token of length:3574\n2017-01-13 14:27:45,431 DEBUG [IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>] org.apache.hadoop.ipc.Client: closing ipc connection to <RM_HOSTNAME>/10.0.22.125:8030: null\njava.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:392)\n\tat org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1785)\n\tat org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1156)\n\tat org.apache.hadoop.ipc.Client$Connection.run(Client.java:1053)\n2017-01-13 14:27:45,431 DEBUG [IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>] org.apache.hadoop.ipc.Client: IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>: closed\n2017-01-13 14:27:45,431 DEBUG [IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>] org.apache.hadoop.ipc.Client: IPC Client (1943634922) connection to <RM_HOSTNAME>/10.0.22.125:8030 from <YARN_USER>: stopped, remaining connections 1\n2017-01-13 14:27:45,431 INFO [RMCommunicator Allocator] org.apache.hadoop.io.retry.RetryInvocationHandler: Exception while invoking ApplicationMasterProtocolPBClientImpl.allocate over null. Retrying after sleeping for 30000ms.\njava.io.EOFException: End of File Exception between local host is: \"<AM_HOST>/10.0.22.190\"; destination host is: \"<RM_HOSTNAME>\":8030; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\t... rest of stack trace from above ...\n{code}\n\nThe part that sticks out to me is {{org.apache.hadoop.security.SaslRpcClient: unwrapping token of length:3574}}, indicating that the response received from the RM is of a valid length. However, the EOFException comes from {{int length = in.readInt();}}, meaning that after we've unwrapped the RPC response and created a {{DataInputStream}} from it, the length of the DataInputStream is less than 4 bytes.\n\nThis seems to indicate a problem in {{SaslRpcClient}} (maybe SaslRpcClient#getInputStream?), but other RPC calls from the AM to the RM and back are working just fine (e.g., before we get around to allocating containers the AM was able to successfully call {{registerApplicationMaster}}.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-13T20:13:13.603+0000","updated":"2017-01-13T20:13:13.603+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15836662","id":"15836662","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"This is also an issue on 2.8.0-RC1. [~jianhe], do you think there's any chance of this being fixed before 2.8.0 is released?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-24T21:31:47.643+0000","updated":"2017-01-24T21:31:47.643+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15836703","id":"15836703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"As an additional data point, setting {{hadoop.rpc.protection}} to {{integrity}} is also enough to reproduce the issue (previously I'd only tried with {{privacy}}).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-24T21:50:14.835+0000","updated":"2017-01-24T21:50:14.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15840119","id":"15840119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"// I deleted my above comment because it was inaccurate.\n\nLooked into this more today with a debugger. I still haven't figured out quite what's going on, but thought it might be useful to update this with some more information.\n\nOne of the first four bytes of the {{token}} variable returned by {{saslClient.unwrap}} \\[1\\] is consistently negative. Therefore {{DataInputStream#readInt}} thinks that the stream has prematurely ended, and throws an {{EOFException}}, when it's called by {{Client#readResponse}} \\[2\\].\n\n\\[1\\] https://github.com/apache/hadoop/blob/branch-2.8.0/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/SaslRpcClient.java#L610\n\\[2\\] https://github.com/apache/hadoop/blob/branch-2.8.0/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java#L1156\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-26T17:48:33.885+0000","updated":"2017-01-26T17:48:33.885+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15840244","id":"15840244","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"The problem is that {{Client$IpcStreams#readResponse}} is trying to get the length of the input stream _after_ it's been unwrapped. Before being unwrapped, the input stream does in fact contain the length of the RPC message in its first four bytes, as we see in SaslRpcClient#readNextRpcPacket(): https://github.com/apache/hadoop/blob/branch-2.8.0/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/SaslRpcClient.java#L589.\n\nHowever, the stream that we pass to {{saslClient.unwrap}} can't contain those four bytes. From the [javadoc|https://docs.oracle.com/javase/8/docs/api/javax/security/sasl/SaslClient.html#unwrap-byte:A-int-int-]: \"incoming is the contents of the SASL buffer as defined in RFC 2222 without the leading four octet field that represents the length.\" And indeed, the length of the incoming RPC is 3586 in the case I'm looking at, but then {{token}} is only 3570 bytes when we pass it to {{saslClient.unwrap}}, so the first four bytes are definitely gone. (I'm not sure what the other 12 missing bytes are though.)\n\nAlso, from what I can tell of the [SASL code|http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/com/sun/security/sasl/digest/DigestMD5Base.java], the {{unwrap}} implementation won't put the 4-byte header back on.\n\nSo it doesn't make sense to call {{int length = in.readInt();}} on an unwrapped stream, as the first four bytes of that do not contain its length. I can submit a patch for this.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-26T19:13:22.505+0000","updated":"2017-01-26T19:13:22.505+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15840286","id":"15840286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Also the reason why other RPC calls are working is evidently that they're not encrypted, which seems worrisome in its own right. For example, the code that receives an RPC response from the NameNode for a lease renewal request goes from {{Client$Connection$PingInputStream#read}} to {{SocketInputStream#read}} and never makes its way into {{SaslRpcClient}} code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-26T19:33:31.092+0000","updated":"2017-01-26T19:33:31.092+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15844791","id":"15844791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Some more testing with a debugger indicates that this problem is related to HADOOP-10940. Before then, {{in.readInt()}} in {{Client#receiveRpcResponse}} would call {{read(byte[] buf, int off, int len)}} with {{len=8192}} in SaslRpcClient, which would give back the correct result. After that change, {{in.readInt()}} in {{Client$IpcStreams#readResponse}} just calls {{read()}} in SaslRpcClient, which then calls {{read(byte[], int off, int len)}} with {{len=1}} 4 separate times.\n\nThe salient part of that change seems to be that before, {{in}} was wrapped in a {{BufferedInputStream}}: https://github.com/apache/hadoop/commit/4b9845bc53f47a32b4dfb1f271e6e193ce813f79#diff-034bce8e7837d9f0c216f85d4c185755L833.\nAnd calling {{BufferedInputStream#read()}} calls {{fill()}}, which calls {{read(byte[], int, int)}} as described above -- see http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/io/BufferedInputStream.java?av=f#246.\n\nAfter HADOOP-10940, we still wrap the {{SocketInputStream}} for {{in}} in a {{BufferedInputStream}}, but that itself is wrapped in a {{SaslRpcClient$WrappedInputStream}}, so we get the behavior where a single-byte read is performed four times.\n\nI'm not sure what the actual problem here is -- is it that we're eventually calling the wrong {{read}} method in {{SaslRpcClient$WrappedInputStream}}, or that the first four bytes in the unwrapped input stream don't actually contain the length of the RPC message (and they should)?\n\nIn any case, I'm attaching a patch that fixes this in the most naive way possible, but will defer to people who know this code better on what the correct fix is, and am happy to update the patch based on feedback. Naturally I should also add a test, but would like to have more confidence in the fix first. (So far I've tested by deploying the patch to a stack and successfully running {{TestDFSIO}} with SASL qop set to {{integrity}}.)\n\n[~daryn] or [~kihwal], would either of you be able to review this? It seems like you guys have a good understanding of this code and would be able to point me in the right direction.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-01-30T02:45:57.564+0000","updated":"2017-01-30T02:45:57.564+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15850106","id":"15850106","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~djp], I'm wondering whether you have any opinions here, since you've been working on the 2.8.0 release. I could be wrong, of course, but I'm concerned that this is a non-trivial regression from 2.7.3, and I think it'd be great if we could fix this (or determine that I'm just doing something wrong) before 2.8.0 is released.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-02T16:17:07.436+0000","updated":"2017-02-02T16:17:07.436+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15854582","id":"15854582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"// Attaching a better patch file now that I've gotten IntelliJ to behave better re: imports.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-06T19:23:16.438+0000","updated":"2017-02-06T19:23:16.438+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15854841","id":"15854841","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"[~Steven Rand], the server log you provided does not have any exceptions - it's for a different time range. Are you able to get the corresponding server log when the exception happens ?\nI also converted this to a hadoop common jira","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-06T22:09:41.595+0000","updated":"2017-02-06T22:09:41.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15854868","id":"15854868","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"Have you tested your patch with regard to the AM allocate call ? \nAlso, If possible, can you try to write a unit test ? A unit test is useful to show the correctness of the patch. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-06T22:29:38.485+0000","updated":"2017-02-06T22:29:38.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15855170","id":"15855170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe], the server logs are for a different time range, but correspond to another instance of the same problem happening. I have never seen any errors or warning in the RM's log when this problem occurs -- it appears to be entirely client-side. I can reproduce the issue again and attach AM and RM logs from the same time if it would be helpful, but the contents of the RM log will be the same as they are in the current attachment.\n\nI will write a unit test, but am also hoping for feedback on whether the approach taken in the current patch even makes sense. I can't tell whether the problem is that the unwrapped input stream needs to be wrapped in a {{BufferedInputStream}}, or whether it's that the first four bytes of the unwrapped input stream are supposed to be the length of the stream but instead are something else.\n\nEDIT: I forgot to say that yes, I have tested my patch using TestDFSIO and the patch resolves the issue as far as I can tell.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-07T02:22:38.365+0000","updated":"2017-02-07T03:25:47.249+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15855298","id":"15855298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"Do you mean TestDFSIO fails without the patch the patch, and pass with the patch ? How about the original issue you reported about AM allocate ? Does that also fail without the patch and pass with the patch ?  Frankly, I'm also unsure the correctness of the patch. Hence,a UT can prove It. This doesn't seem like an easy bug.  Regardless what the solution is, the UT will still be useful and hopefully the same, so the work won't be wasted. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-07T04:25:27.506+0000","updated":"2017-02-07T04:27:31.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15855312","id":"15855312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Correct, TestDFSIO fails without the patch and succeeds with the patch. The reason why TestDFSIO fails is because of the issue with {{ApplicationMasterProtocolPBClientImpl.allocate}} that I initially reported -- it's the same problem, just reproduced with MapReduce instead of with Spark.\n\nI am working on a unit test now and will hopefully have a new patch by the end of tonight.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-07T04:36:29.189+0000","updated":"2017-02-07T04:36:29.189+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15855464","id":"15855464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe], I haven't found a good way to add a unit test for this issue to {{org.apache.hadoop.ipc.TestSaslRPC}} yet. I will keep trying tomorrow.\n\nI did notice that in {{org.apache.hadoop.yarn.client.api.impl.TestAMRMClient}}, if I add {{conf.set(CommonConfigurationKeysPublic.HADOOP_RPC_PROTECTION, \"privacy\");}} to the {{setup()}} method, then these tests fail with the same EOFException as in the description of this JIRA:\n\n* testAMRMClient\n* testAMRMClientMatchStorage\n\nHowever, after I apply my patch, all of the tests in {{TestAMRMClient}} succeed, which seem like a good sign.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-07T07:16:16.710+0000","updated":"2017-02-07T07:16:16.710+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15857443","id":"15857443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"I'm attaching a patch with a unit test, but would definitely want to refactor the way the test is done. Ideally I think I'd add a test to either {{TestSaslRPC}} or {{TestAMRMClient}}, but I haven't found a way of doing so yet, so the patch in its current form duplicates lots of code in {{TestAMRMClient}}. \n\nI'll work on improving it, but wanted to have at least something by the end of today, and this approach was the most obvious / easiest to implement.\n\nThe test in {{TestAMRMClientWithEncryptedRpc}} fails without the change to {{Client}}, and succeeds with the change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-08T05:41:14.912+0000","updated":"2017-02-08T05:41:14.912+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15857450","id":"15857450","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"The patch is for 2.8, Does trunk not have this problem ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-08T05:45:16.981+0000","updated":"2017-02-08T05:45:16.981+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15857477","id":"15857477","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"I'm not sure, but I'll check. I was targeting 2.8 since the 2.8.0 release is happening soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-08T06:19:45.328+0000","updated":"2017-02-08T06:19:45.328+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15857540","id":"15857540","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Sorry, I can't get trunk to compile cleanly in IntelliJ, so I can't run any tests. I'll try again tomorrow, and if I can't run the tests I can just make a dist and deploy that + run TestDFSIO with hadoop.rpc.protection=privacy set.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-08T07:07:39.261+0000","updated":"2017-02-08T07:07:39.261+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15858597","id":"15858597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Reproduced the issue on trunk, and also that the same change to {{Client}} makes the tests pass. Attaching the same patch for trunk.\n\nToday I'll try to find a nicer way of writing a unit test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-08T21:55:01.832+0000","updated":"2017-02-08T21:55:01.832+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15858841","id":"15858841","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"This indeed looks to be a regression of  HADOOP-10940. But I cannot figure out why the other calls(register/unregister) are succeeding. Do you have any clue ?\ncan you add a comments in the code to explain why this is needed.  Also, the trunk patch has compilation error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-09T01:50:38.935+0000","updated":"2017-02-09T01:50:38.935+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15858853","id":"15858853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"No, I unfortunately have no clue. Honestly I'm fairly perplexed by the whole situation.\n\nI was hoping that [~daryn] might be able to weigh in, since from looking at the history for {{Client}} and {{SaslRpcClient}} it seems like you have a good understanding of this code, and were able to fix a break in SASL RPC encryption in HADOOP-9816.\n\nIn any case, I'll add a comment and will fix the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-09T01:59:00.812+0000","updated":"2017-02-09T01:59:00.812+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15860026","id":"15860026","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Attaching updated patches for branch-2.8.0 and trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-09T19:20:38.595+0000","updated":"2017-02-09T19:20:38.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15866489","id":"15866489","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"[~Steven Rand], for test case, instead of copying all TestAMRMClient, could you add one test inside TestAMRMClient which only does what is minimally required ?\nAlso, please cut the long comment into 2 lines as that exceeds the usual 80 column limit. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-14T19:43:20.131+0000","updated":"2017-02-14T19:43:20.131+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15867458","id":"15867458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe] I've attached new patches which create a single new test in {{TestAMRMClient}}. There's some weirdness in that they have to create a new instance of {{MiniYARNCluster}} just for that one test, and I wasn't sure of the best way to handle it, so happy to further edit the patches if there's a better way.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-15T08:36:38.649+0000","updated":"2017-02-15T08:36:38.649+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15872602","id":"15872602","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"After I removed these code, the test seems also pass, do we need these ?\n{code}\n    tearDown();\n    createClientAndCluster(conf);\n    // unless we start an application the cancelApp() method will fail when\n    // it runs after this test\n    startApp();\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-17T21:58:47.176+0000","updated":"2017-02-17T21:58:47.176+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15872658","id":"15872658","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"For me the tests also succeed if I comment out that code, but I think it's only because the new test happens to run last. When I add {{@FixMethodOrder(MethodSorters.NAME_ASCENDING)}} to the class, the test that runs immediately after the new test ({{testAllocationWithBlacklist}}) fails if I comment out that code. I think it's because that test calls {{amClient.init(conf)}}, and since we call {{conf.unset(CommonConfigurationKeysPublic.HADOOP_RPC_PROTECTION);}} in the new test, there's a mismatch between the client and the server.\n\nSo I think the two options are:\n\n1. Don't remove the code in your above comment\n2. Do remove that code, but also remove {{conf.unset(CommonConfigurationKeysPublic.HADOOP_RPC_PROTECTION);}}. When I do this all tests succeed regardless of order. \n\n[~jianhe] I'll defer to you on which option you prefer. Both seem okay to me. The first is a smaller change, since if we do the second, all tests after {{testAMRMClientWithSaslEncryption}} run with SASL RPC.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-17T22:31:43.589+0000","updated":"2017-02-17T22:31:43.589+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15877201","id":"15877201","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"yep, latest patch looks good to me.  \ncould you upload a patch for trunk as well ?\n\nOnce you upload a patch, you can click the submit Patch button which will triggers the jenkins report. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-22T01:24:42.965+0000","updated":"2017-02-22T01:24:42.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15877383","id":"15877383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 17s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 15s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 14m 54s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 15m 52s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  2m 20s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 51s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 45s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 16s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 15s{color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 17s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  0s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 12m  7s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 12m  7s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m 59s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 34s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 45s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 25s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 17s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}  8m 12s{color} | {color:red} hadoop-common in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 17m 12s{color} | {color:green} hadoop-yarn-client in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 38s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}111m 47s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.security.TestKDiag |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | HADOOP-14062 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12852762/HADOOP-14062.003.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux a384c8dd0a96 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 003ae00 |\n| Default Java | 1.8.0_121 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-HADOOP-Build/11682/artifact/patchprocess/patch-unit-hadoop-common-project_hadoop-common.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11682/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client U: . |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11682/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-22T03:20:07.887+0000","updated":"2017-02-22T03:20:07.887+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15878293","id":"15878293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe], it looks like the test failure is unrelated, since other people are seeing it too in HADOOP-14030?\n\nThe patch {{HADOOP-14062.003.patch}} is for trunk, and {{HADOOP-14062-branch-2.8.0.005.patch}} is for branch-2.8.0. Should I also make a separate patch file for branch-2?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-22T14:24:14.022+0000","updated":"2017-02-22T14:24:14.022+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15879165","id":"15879165","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"Attached the same branch-2.8 patch to trigger jenkins report","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-22T20:31:56.434+0000","updated":"2017-02-22T20:31:56.434+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15879166","id":"15879166","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. Should I also make a separate patch file for branch-2?\nNo, not needed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-22T20:32:21.598+0000","updated":"2017-02-22T20:32:21.598+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15879559","id":"15879559","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 16s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 15s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  9m  1s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  7m  2s{color} | {color:green} branch-2.8.0 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  7m 24s{color} | {color:green} branch-2.8.0 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  7s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 26s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 30s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 18s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} branch-2.8.0 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 17s{color} | {color:green} branch-2.8.0 passed with JDK v1.7.0_121 {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 16s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  3s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 48s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  5m 48s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 51s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  6m 51s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  9s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 27s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 36s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 46s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  7s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 22s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  9m  8s{color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_121. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 66m 19s{color} | {color:red} hadoop-yarn-client in the patch failed with JDK v1.7.0_121. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 29s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}229m 18s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_121 Failed junit tests | hadoop.yarn.client.TestGetGroups |\n|   | hadoop.yarn.client.api.impl.TestAMRMProxy |\n| JDK v1.8.0_121 Timed out junit tests | org.apache.hadoop.yarn.client.cli.TestYarnCLI |\n|   | org.apache.hadoop.yarn.client.api.impl.TestAMRMClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestYarnClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestNMClient |\n| JDK v1.7.0_121 Failed junit tests | hadoop.yarn.client.TestGetGroups |\n|   | hadoop.yarn.client.api.impl.TestAMRMProxy |\n|   | hadoop.yarn.client.TestApplicationClientProtocolOnHA |\n| JDK v1.7.0_121 Timed out junit tests | org.apache.hadoop.yarn.client.cli.TestYarnCLI |\n|   | org.apache.hadoop.yarn.client.api.impl.TestAMRMClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestYarnClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestNMClient |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:5af2af1 |\n| JIRA Issue | HADOOP-14062 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12854059/HADOOP-14062-branch-2.8.0.005.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 274fbf74bdf3 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.8.0 / 159b8b6 |\n| Default Java | 1.7.0_121 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-HADOOP-Build/11690/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-client-jdk1.7.0_121.txt |\n| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11690/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client U: . |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11690/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-23T00:27:40.185+0000","updated":"2017-02-23T00:27:40.185+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15880957","id":"15880957","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe], I can't tell how real the test failures are. I ran the ones mentioned above locally with the same patch for branch-2.8.0 and in most cases they succeeded:\n\n* I ran TestGetGroups once locally and it succeeded.\n* I ran TestAMRMProxy three times locally. Once it failed, twice it succeeded.\n* I ran TestYarnCLI once locally and it succeeded.\n* I ran TestAMRMClient several times locally both with and without my patch. Every time at least one test failed, but it was inconsistent which test or tests timed out.\n* I ran TestYarnClient once locally and it succeeded.\n* I ran TestNMClient once locally and it succeed.\n\nHow do you recommend I proceed? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-23T18:11:30.858+0000","updated":"2017-02-23T18:11:30.858+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15881034","id":"15881034","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"I tried to run the tests locally, below tests failed with or without the patch. Is this what you see as well ? I guess it's not related to the patch \n{code}\n  TestYarnClient.testShouldNotRetryForeverForNonNetworkExceptions   Unexpected ...\n  TestYarnClient.testClientStop:149  YarnRuntime java.net.BindException: Proble...\n  TestGetGroups.setUpResourceManager:67 IO ResourceManager failed to start. Fina...\n{code}\nI triggered a new jenkins run. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-02-23T19:04:50.995+0000","updated":"2017-02-23T19:04:50.995+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15881130","id":"15881130","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"For me when I run with the patch on branch-2.8.0 I get:\n\n{code}\n  TestApplicationClientProtocolOnHA.testGetApplicationReportOnHA:69   test time...\n  TestApplicationClientProtocolOnHA.testCancelDelegationTokenOnHA:213   test ti...\n  TestApplicationClientProtocolOnHA.testGetClusterNodesOnHA:104->Object.wait:502->Object.wait:-2 \n{code}\n\nAnd then without the patch:\n\n{code}\n  TestApplicationClientProtocolOnHA.testCancelDelegationTokenOnHA:213   test ti...\n  TestApplicationClientProtocolOnHA.testGetQueueInfoOnHA:113   test timed out a...\n  TestApplicationClientProtocolOnHA.testForceKillApplicationOnHA:189   test tim...\n  TestApplicationClientProtocolOnHA.testGetContainerReportOnHA:150   test timed...\n  TestResourceTrackerOnHA.testResourceTrackerOnHA:64   test timed out after 150..\n{code}\n\nBut it doesn't seem deterministic -- I get different failures on different test runs, both with and without the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-02-23T20:01:30.397+0000","updated":"2017-02-23T20:01:30.397+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15881412","id":"15881412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 19s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 15s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  6m 28s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 54s{color} | {color:green} branch-2.8.0 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 50s{color} | {color:green} branch-2.8.0 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  5s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 22s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 31s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 14s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} branch-2.8.0 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 17s{color} | {color:green} branch-2.8.0 passed with JDK v1.7.0_121 {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 16s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  2s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 50s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  5m 50s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 50s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  6m 50s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  7s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 27s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 36s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 49s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  7s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 23s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 18s{color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_121. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 66m 15s{color} | {color:red} hadoop-yarn-client in the patch failed with JDK v1.7.0_121. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 28s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}224m  9s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_121 Failed junit tests | hadoop.yarn.client.TestGetGroups |\n|   | hadoop.yarn.client.api.impl.TestAMRMProxy |\n| JDK v1.8.0_121 Timed out junit tests | org.apache.hadoop.yarn.client.cli.TestYarnCLI |\n|   | org.apache.hadoop.yarn.client.api.impl.TestAMRMClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestYarnClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestNMClient |\n| JDK v1.7.0_121 Failed junit tests | hadoop.yarn.client.TestGetGroups |\n|   | hadoop.yarn.client.api.impl.TestAMRMProxy |\n| JDK v1.7.0_121 Timed out junit tests | org.apache.hadoop.yarn.client.cli.TestYarnCLI |\n|   | org.apache.hadoop.yarn.client.api.impl.TestAMRMClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestYarnClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestNMClient |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:5af2af1 |\n| JIRA Issue | HADOOP-14062 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12854059/HADOOP-14062-branch-2.8.0.005.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux e737bbeb6350 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.8.0 / 159b8b6 |\n| Default Java | 1.7.0_121 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-HADOOP-Build/11699/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-client-jdk1.7.0_121.txt |\n| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11699/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client U: . |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11699/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-02-23T22:24:24.677+0000","updated":"2017-02-23T22:24:24.677+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15892915","id":"15892915","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"[~jianhe], I'm not really sure what to do about this since we can't get the tests to pass, but the failures don't seem related to the patch as far as I can tell. Do you have any suggestions for how to proceed?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-02T20:22:07.555+0000","updated":"2017-03-02T20:22:07.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15893031","id":"15893031","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"sorry, I forgot about this. I uploaded a dummy patch for branch-2.8.0, if it fails the same. we can ignore these failures and get this committed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-02T21:16:55.869+0000","updated":"2017-03-02T21:16:55.869+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15897814","id":"15897814","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Looks like Jenkins hasn't tested the dummy patch -- do I need to click \"Submit Patch\" to make it do that?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-06T18:47:43.096+0000","updated":"2017-03-06T18:47:43.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15897845","id":"15897845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"yeah, I just did that. thanks for reminding ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-06T19:03:08.349+0000","updated":"2017-03-06T19:03:08.349+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15898319","id":"15898319","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 29s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 17s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  8m 48s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 50s{color} | {color:green} branch-2.8.0 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 49s{color} | {color:green} branch-2.8.0 passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  7s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 23s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 32s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 17s{color} | {color:green} branch-2.8.0 passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  1s{color} | {color:green} branch-2.8.0 passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 16s{color} | {color:green} branch-2.8.0 passed with JDK v1.7.0_121 {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 16s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  1s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  5m 46s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  5m 46s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green}  6m 51s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green}  6m 51s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  1m  7s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 27s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 37s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 1 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 47s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m  7s{color} | {color:green} the patch passed with JDK v1.8.0_121 {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 23s{color} | {color:green} the patch passed with JDK v1.7.0_121 {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 19s{color} | {color:green} hadoop-common in the patch passed with JDK v1.7.0_121. {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red} 66m 19s{color} | {color:red} hadoop-yarn-client in the patch failed with JDK v1.7.0_121. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 28s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}226m 58s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| JDK v1.8.0_121 Failed junit tests | hadoop.yarn.client.TestGetGroups |\n|   | hadoop.yarn.client.api.impl.TestAMRMProxy |\n| JDK v1.8.0_121 Timed out junit tests | org.apache.hadoop.yarn.client.cli.TestYarnCLI |\n|   | org.apache.hadoop.yarn.client.api.impl.TestAMRMClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestYarnClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestNMClient |\n| JDK v1.7.0_121 Failed junit tests | hadoop.yarn.client.TestGetGroups |\n|   | hadoop.yarn.client.api.impl.TestAMRMProxy |\n|   | hadoop.yarn.client.TestApplicationClientProtocolOnHA |\n| JDK v1.7.0_121 Timed out junit tests | org.apache.hadoop.yarn.client.cli.TestYarnCLI |\n|   | org.apache.hadoop.yarn.client.api.impl.TestAMRMClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestYarnClient |\n|   | org.apache.hadoop.yarn.client.api.impl.TestNMClient |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:5af2af1 |\n| JIRA Issue | HADOOP-14062 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12855696/HADOOP-14062-branch-2.8.0.dummy.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 81fdef4b5671 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | branch-2.8.0 / 58fa75c |\n| Default Java | 1.7.0_121 |\n| Multi-JDK versions |  /usr/lib/jvm/java-8-oracle:1.8.0_121 /usr/lib/jvm/java-7-openjdk-amd64:1.7.0_121 |\n| findbugs | v3.0.0 |\n| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/11765/artifact/patchprocess/whitespace-eol.txt |\n| unit | https://builds.apache.org/job/PreCommit-HADOOP-Build/11765/artifact/patchprocess/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-client-jdk1.7.0_121.txt |\n| JDK v1.7.0_121  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11765/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client U: . |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11765/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-06T22:55:39.789+0000","updated":"2017-03-06T22:55:39.789+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15900470","id":"15900470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Looks like tests are also broken with the dummy patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-08T00:40:55.255+0000","updated":"2017-03-08T00:40:55.255+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15901774","id":"15901774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Jenkins build Hadoop-trunk-Commit #11373 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/11373/])\nHADOOP-14062. ApplicationMasterProtocolPBClientImpl.allocate fails with (jianhe: rev 241c1cc05b71f8b719a85c06e3df930639630726)\n* (edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-08T18:54:24.115+0000","updated":"2017-03-08T18:54:24.115+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15901792","id":"15901792","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"I committed to trunk, branch-2, branch-2.8, branch-2.8.0\n\nThanks [~Steven Rand] for the consistent contribution ! \nCongrats to your first patch into Hadoop !\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-08T19:04:28.980+0000","updated":"2017-03-08T19:04:28.980+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15901826","id":"15901826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Thanks [~jianhe] for reviewing!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-08T19:23:33.579+0000","updated":"2017-03-08T19:23:33.579+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15901870","id":"15901870","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"body":"[~Steven Rand]/[~jianhe],\n\nCan you please verify if your changes in TestAMRMClient is breaking the build ?\n\n{noformat}\n[ERROR] COMPILATION ERROR : \n[ERROR] /Users/manoj/work/ups-hadoop/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java:[145,5] non-static variable yarnCluster cannot be referenced from a static context\n[ERROR] /Users/manoj/work/ups-hadoop/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java:[145,71] non-static variable nodeCount cannot be referenced from a static context\n[ERROR] /Users/manoj/work/ups-hadoop/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java:[146,5] non-static variable yarnCluster cannot be referenced from a static context\n..\n..\n[ERROR] symbol:   method tearDown()\n[ERROR] location: class org.apache.hadoop.yarn.client.api.impl.TestAMRMClient\n[ERROR] /Users/manoj/work/ups-hadoop/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java:[876,5] cannot find symbol\n[ERROR] symbol:   method startApp()\n[ERROR] location: class org.apache.hadoop.yarn.client.api.impl.TestAMRMClient\n[ERROR] /Users/manoj/work/ups-hadoop/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java:[881,5] cannot find symbol\n[ERROR] sym\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=manojg","name":"manojg","key":"manojg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manoj Govindassamy","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-08T19:43:01.762+0000","updated":"2017-03-08T19:43:01.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15901942","id":"15901942","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Yes, it looks like the changes in YARN-6218 conflict with this change. For example, in that commit, the method {{tearDown}} was renamed to {{teardown}}, so in this patch we call a method that doesn't exist anymore. Want me to make a separate patch to fix this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-08T20:45:03.763+0000","updated":"2017-03-08T20:45:03.763+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15901991","id":"15901991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"[~manojg], thanks for reporting the issue. sorry for the troubles.  I reverted the patch from trunk and branch-2.\n[~Steven Rand], can you upload a new one ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-08T21:21:57.541+0000","updated":"2017-03-08T21:21:57.541+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15902008","id":"15902008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Yes, will do, hopefully by the end of today.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-08T21:33:32.795+0000","updated":"2017-03-08T21:33:32.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15902034","id":"15902034","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #11374 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/11374/])\nRevert \"HADOOP-14062. ApplicationMasterProtocolPBClientImpl.allocate (jianhe: rev 2be8947d12714c49ef7a90de82a351d086b435b6)\n* (edit) hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/test/java/org/apache/hadoop/yarn/client/api/impl/TestAMRMClient.java\n* (edit) hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/Client.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-08T21:54:57.674+0000","updated":"2017-03-08T21:54:57.674+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15902265","id":"15902265","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"Attaching a new patch for trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-09T01:15:04.399+0000","updated":"2017-03-09T01:15:04.399+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15902404","id":"15902404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"| (x) *{color:red}-1 overall{color}* |\n\\\\\n\\\\\n|| Vote || Subsystem || Runtime || Comment ||\n| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 29s{color} | {color:blue} Docker mode activated. {color} |\n| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |\n| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  1m 48s{color} | {color:blue} Maven dependency ordering for branch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 12m 36s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 11m 29s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  2m  9s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 48s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 49s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 27s{color} | {color:green} trunk passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 22s{color} | {color:green} trunk passed {color} |\n| {color:blue}0{color} | {color:blue} mvndep {color} | {color:blue}  0m 16s{color} | {color:blue} Maven dependency ordering for patch {color} |\n| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  1m  8s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} compile {color} | {color:green} 10m 45s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javac {color} | {color:green} 10m 45s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  2m  7s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 50s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 53s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |\n| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  2m 46s{color} | {color:green} the patch passed {color} |\n| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  1m 28s{color} | {color:green} the patch passed {color} |\n| {color:red}-1{color} | {color:red} unit {color} | {color:red}  8m 28s{color} | {color:red} hadoop-common in the patch failed. {color} |\n| {color:green}+1{color} | {color:green} unit {color} | {color:green} 19m 35s{color} | {color:green} hadoop-yarn-client in the patch passed. {color} |\n| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 51s{color} | {color:green} The patch does not generate ASF License warnings. {color} |\n| {color:black}{color} | {color:black} {color} | {color:black}109m 43s{color} | {color:black} {color} |\n\\\\\n\\\\\n|| Reason || Tests ||\n| Failed junit tests | hadoop.security.TestKDiag |\n\\\\\n\\\\\n|| Subsystem || Report/Notes ||\n| Docker |  Image:yetus/hadoop:a9ad5d6 |\n| JIRA Issue | HADOOP-14062 |\n| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12856906/HADOOP-14062.004.patch |\n| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |\n| uname | Linux 98c3be7a4f94 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |\n| Build tool | maven |\n| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |\n| git revision | trunk / 33a38a5 |\n| Default Java | 1.8.0_121 |\n| findbugs | v3.0.0 |\n| unit | https://builds.apache.org/job/PreCommit-HADOOP-Build/11784/artifact/patchprocess/patch-unit-hadoop-common-project_hadoop-common.txt |\n|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11784/testReport/ |\n| modules | C: hadoop-common-project/hadoop-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client U: . |\n| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11784/console |\n| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |\n\n\nThis message was automatically generated.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2017-03-09T03:10:19.577+0000","updated":"2017-03-09T03:10:19.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15902526","id":"15902526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"body":"It looks like HADOOP-14030 strikes again. Should I re-trigger Jenkins to try to get a green build?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Steven+Rand","name":"Steven Rand","key":"steven rand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steven Rand","active":true,"timeZone":"America/New_York"},"created":"2017-03-09T05:36:49.783+0000","updated":"2017-03-09T05:36:49.783+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13029311/comment/15905438","id":"15905438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"body":"committed the new patch to trunk and branch-2 ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jianhe","name":"jianhe","key":"jianhe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jian He","active":true,"timeZone":"America/Los_Angeles"},"created":"2017-03-10T17:26:49.813+0000","updated":"2017-03-10T17:26:49.813+0000"}],"maxResults":58,"total":58,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-14062/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i37str:"}}