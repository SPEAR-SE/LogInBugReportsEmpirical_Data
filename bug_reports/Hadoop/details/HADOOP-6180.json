{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12423396","self":"https://issues.apache.org/jira/rest/api/2/issue/12423396","key":"HADOOP-6180","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313563","id":"12313563","description":"","name":"0.21.0","archived":false,"released":true,"releaseDate":"2010-08-23"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-04-21T18:25:51.577+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Oct 09 17:34:37 UTC 2009","customfield_12310420":"19102","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_599881483_*|*_1_*:*_1_*:*_8731182390_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-08-07T18:01:13.994+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-6180/watchers","watchCount":5,"isWatching":false},"created":"2009-04-21T18:03:30.121+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-08-24T20:39:17.339+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"This fix changes the naming of files moved to Trash.\nBefore files with the same name were appended with a running number 1,2,3.. and so on. Now it will have the current time in milliseconds attached to the name.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12415163","id":"12415163","filename":"COMMON-124.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-07-31T19:22:53.465+0000","size":7927,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12415163/COMMON-124.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"103357","customfield_12312823":null,"summary":"Namenode slowed down when many files with same filename were moved to Trash","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701222","id":"12701222","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"We observed Namenode was spending more time in GC than usual.\nNo metrics stood out.\n\nAudit showed many rename operations like the following. \n{noformat}\n2009-04-17 23:00:03,957 INFO org.apache.hadoop.fs.FSNamesystem.audit: ugi=user1,users,  \n  ip=/99.111.222.111      cmd=rename\n  src=/user/user1/agg_results/20090417/part-00489      dst=/user/user1/.Trash/Current/part-00489.507   \n  perm=user1:users:rw-r--r--\n{noformat}\n\nIt turns out that this user had large number of small jobs and was calling \n{noformat}\n   hadoop dfs -rmr $outdir/\\* \n{noformat}\nafter each job.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2009-04-21T18:11:41.923+0000","updated":"2009-04-21T18:11:41.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701224","id":"12701224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"Looking at the Trash.java, \n\n{noformat}\n118         String orig = trashPath.toString();\n119         for (int j = 1; fs.exists(trashPath); j++) {\n120           trashPath = new Path(orig + \".\" + j);\n121         }\n122         if (fs.rename(path, trashPath))           // move to current trash\n123           return true;\n{noformat}\n\nit seems like fs.exists were called 506 times before the single rename in the original description.\n\nWhen user changed his script to simply call dfs -rmr $outdir,  namenode came back to normal.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2009-04-21T18:19:04.946+0000","updated":"2009-04-21T18:19:04.946+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701226","id":"12701226","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"From 0.20, HADOOP-4970 changed to preserve the full path for Trash and this should reduce the chances of name\nclashing.  However, we still have this problem if a user decides to repeat create&delete on some temp files.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2009-04-21T18:24:24.047+0000","updated":"2009-04-21T18:24:24.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701227","id":"12701227","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"body":"Maybe this should be changed to something like:\n\n{code}\nwhile (fs.exists(trashPath)) {\n  trashPath = new Path(orig + \".\" + System.currentTimeMillis());\n}\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-04-21T18:25:51.577+0000","updated":"2009-04-21T18:25:51.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701229","id":"12701229","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"Thanks Doug.  +1 for the change.\n\nCreated HADOOP-5714 for a new metric (for tracking number of getFileInfo calls).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2009-04-21T18:35:13.121+0000","updated":"2009-04-21T18:35:13.121+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701284","id":"12701284","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Wow! After Koji figured out the cause of the problem, he talked about the same timestamp solution as what Doug suggested. This reminded me of a Chinese saying: all heroes have the same great idea! :-)\n\nOne minor suggestion... This solution assumes that all client machines have synchronized clocks. We could eliminate possible conflicts by appending client's machine name as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2009-04-21T21:57:41.504+0000","updated":"2009-04-21T21:57:41.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12701370","id":"12701370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"body":"> This solution assumes that all client machines have synchronized clocks.\n\nWe don't require that these are strictly ascending, just that they're unique.  There's very little chance that two nodes, whether they have synchronized clocks or not, will collide to the millisecond, and, if they do, one will have to try twice.  But the chances of ever having to try more than twice are even smaller.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-04-22T04:00:53.968+0000","updated":"2009-04-22T04:00:53.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12707774","id":"12707774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"The proposal of using the timestamp instead of a monotonically increasing number solves the issue. However, it is not very user-friendly.  What do other filesystems that have a Trash feature do in this case... the only other FS that I know of implements this feature uses the monotonically increasing number instead of appending the timestamp. At present, it is very easy to find out the last version of the file in Trash.\n\nAnother option would be to make the Trash client retrieve the contents of the Trash directory and then scan what files pre-exist in the list. Also, this code is not fool-proof because there is no atomicity between the exists and the rename. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-10T10:43:10.886+0000","updated":"2009-05-10T10:43:10.886+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12708134","id":"12708134","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"bq. At present, it is very easy to find out the last version of the file in Trash.\n\nIf all the nodes in the cluster are in the same timezone, timestamp would (almost) serve this purpose?\n\nbq. Another option would be to make the Trash client retrieve the contents of the Trash directory and then scan what files pre-exist in the list. \n\nlistStatus is one of the most expensive call to Namenode right now.  \nI really want to avoid an extra overhead to the namenode with this common command.\n\nbq. Also, this code is not fool-proof because there is no atomicity between the exists and the rename. \n\nTrue.  But I haven't seen this become a problem yet.\nFor me, the contract is we *try* to move the files to Trash but if that fails, we simply delete them.\nWe completely delete the files if rename fails twice in a row anyway.\n\nIn short, I want the Trash feature to stay as simple as it is now without involving the Namenode much.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2009-05-11T17:51:05.467+0000","updated":"2009-05-11T17:51:05.467+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12708441","id":"12708441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"> In short, I want the Trash feature to stay as simple as it is now without involving the Namenode much.\n\nOk, sounds good to me. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-12T13:55:51.608+0000","updated":"2009-05-12T13:55:51.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12708713","id":"12708713","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=he+yongqiang","name":"he yongqiang","key":"he yongqiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"He Yongqiang","active":true,"timeZone":"Etc/UTC"},"body":"Maybe we can also add the file's path info as well as the timestamp when it is moved to trash.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=he+yongqiang","name":"he yongqiang","key":"he yongqiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"He Yongqiang","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-13T01:21:37.496+0000","updated":"2009-05-13T01:21:37.496+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12708718","id":"12708718","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"> For me, the contract is we try to move the files to Trash but if that fails, we simply delete them.\n\nI agree.  I sometimes create a file named .Trash in my hdfs home directory for disabling trash in my account.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-13T01:39:40.931+0000","updated":"2009-05-13T01:39:40.931+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12708720","id":"12708720","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"bq. Maybe we can also add the file's path info as well as the timestamp when it is moved to trash. \n\nHADOOP-4970 from 0.20.\n\nbq. I sometimes create a file named .Trash in my hdfs home directory for disabling trash in my account.\n\nNever thought of that.  Interesting.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2009-05-13T01:54:58.277+0000","updated":"2009-05-13T01:54:58.277+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12708727","id":"12708727","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=he+yongqiang","name":"he yongqiang","key":"he yongqiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"He Yongqiang","active":true,"timeZone":"Etc/UTC"},"body":"Then what about adding the file's create time?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=he+yongqiang","name":"he yongqiang","key":"he yongqiang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"He Yongqiang","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-13T02:30:52.510+0000","updated":"2009-05-13T02:30:52.510+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12737670","id":"12737670","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"body":"I  added currTimeMillis() to the file name.\nSince the jira is defined as a performance problems I put here some numbers before and after the change.\nDeleting file with the same name 1000 times. Printing every 100 time. Comparing with first deletion:\n\nold code:\niteration=100;res =0; start=1249064570781; iterTime = 30 vs. firstTime=26\niteration=200;res =0; start=1249064576620; iterTime = 35 vs. firstTime=26\niteration=300;res =0; start=1249064583456; iterTime = 42 vs. firstTime=26\niteration=400;res =0; start=1249064590637; iterTime = 50 vs. firstTime=26\niteration=500;res =0; start=1249064598285; iterTime = 56 vs. firstTime=26\niteration=600;res =0; start=1249064606626; iterTime = 63 vs. firstTime=26\niteration=700;res =0; start=1249064615643; iterTime = 71 vs. firstTime=26\niteration=800;res =0; start=1249064625248; iterTime = 76 vs. firstTime=26\niteration=900;res =0; start=1249064635654; iterTime = 83 vs. firstTime=26\n\n\nnew code:\niteration=100;res =0; start=1249066273893; iterTime = 22 vs. firstTime=22\niteration=200;res =0; start=1249066278729; iterTime = 22 vs. firstTime=22\niteration=300;res =0; start=1249066283591; iterTime = 22 vs. firstTime=22\niteration=400;res =0; start=1249066288416; iterTime = 24 vs. firstTime=22\niteration=500;res =0; start=1249066293223; iterTime = 27 vs. firstTime=22\niteration=600;res =0; start=1249066298018; iterTime = 30 vs. firstTime=22\niteration=700;res =0; start=1249066302824; iterTime = 25 vs. firstTime=22\niteration=800;res =0; start=1249066307593; iterTime = 23 vs. firstTime=22\niteration=900;res =0; start=1249066312833; iterTime = 23 vs. firstTime=22\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-07-31T19:18:24.998+0000","updated":"2009-07-31T19:18:24.998+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12737674","id":"12737674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"body":"I've noticed there is no unit test for the case of deletion of the same file multiple time. So I added one. \n\nI also added the performance test (the one used in the previous comment) if someone wants to run it in the future. It is not a part of unit test. It can only be run as a separate test (I've added main() method for this purpose).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-07-31T19:21:34.732+0000","updated":"2009-07-31T19:21:34.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12737676","id":"12737676","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cos","name":"cos","key":"cos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cos&avatarId=16741","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cos&avatarId=16741","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cos&avatarId=16741","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cos&avatarId=16741"},"displayName":"Konstantin Boudnik","active":true,"timeZone":"America/Los_Angeles"},"body":"I love the fact that it has a performance test now - it seems like a yet another brick to the performance wall being build!\n\nA couple of quick comments:\n- Hadoop is using JUnit4.5 right now. However, I'm seeing new tests coming in using old JUnit3 notations. E.g. TestCase extensions, junit.framework.* etc. Shall we start using org.junit.* instead and use \n{noformat}\n@Test\n{noformat}\nannotation instead of direct inheritance from TestCase superclass? Annotations should let us use arbitrary test names as well.\n- for future use I'd suggest to put additional tags to the JavaDoc of performanceTestDeleteSameFile. Say \n{noformat}\n+ *  PerformanceTestSuite\n{noformat}\nso later on we'd be able to find all such tests at once to include them into performance suite whenever it will be created?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cos","name":"cos","key":"cos","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cos&avatarId=16741","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cos&avatarId=16741","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cos&avatarId=16741","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cos&avatarId=16741"},"displayName":"Konstantin Boudnik","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-07-31T19:38:26.172+0000","updated":"2009-07-31T19:38:26.172+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12738700","id":"12738700","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"+1. The patch and the performance look good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-04T00:23:03.171+0000","updated":"2009-08-04T00:23:03.171+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12740237","id":"12740237","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"body":"ant test-patch\n+1 overall.  \n     [exec] \n     [exec]     +1 @author.  The patch does not contain any @author tags.\n     [exec] \n     [exec]     +1 tests included.  The patch appears to include 3 new or modified tests.\n     [exec] \n     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.\n     [exec] \n     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n     [exec] \n     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n     [exec] \n     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n     [exec] \n\nant test\n\nrun-test-core:\n    [mkdir] Created dir: /home/borya/work/hadoop/hadoop-common/build/test/data\n    [mkdir] Created dir: /home/borya/work/hadoop/hadoop-common/build/test/logs\n     [copy] Copying 1 file to /home/borya/work/hadoop/hadoop-common/build/test/extraconf\n    [junit] Running org.apache.hadoop.cli.TestCLI\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.292 sec\n    [junit] Running org.apache.hadoop.conf.TestConfiguration\n    [junit] Tests run: 13, Failures: 0, Errors: 0, Time elapsed: 1.198 sec\n    [junit] Running org.apache.hadoop.conf.TestConfigurationSubclass\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.419 sec\n    [junit] Running org.apache.hadoop.conf.TestGetInstances\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.381 sec\n    [junit] Running org.apache.hadoop.filecache.TestDistributedCache\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 1.198 sec\n    [junit] Running org.apache.hadoop.fs.TestBlockLocation\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.229 sec\n    [junit] Running org.apache.hadoop.fs.TestChecksumFileSystem\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.561 sec\n    [junit] Running org.apache.hadoop.fs.TestDFVariations\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.375 sec\n    [junit] Running org.apache.hadoop.fs.TestDU\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 5.497 sec\n    [junit] Running org.apache.hadoop.fs.TestGetFileBlockLocations\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 1.278 sec\n    [junit] Running org.apache.hadoop.fs.TestGlobExpander\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.055 sec\n    [junit] Running org.apache.hadoop.fs.TestLocalDirAllocator\n    [junit] Tests run: 5, Failures: 0, Errors: 0, Time elapsed: 1.106 sec\n    [junit] Running org.apache.hadoop.fs.TestLocalFileSystem\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 1.096 sec\n    [junit] Running org.apache.hadoop.fs.TestLocalFileSystemPermission\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.584 sec\n    [junit] Running org.apache.hadoop.fs.TestPath\n    [junit] Tests run: 8, Failures: 0, Errors: 0, Time elapsed: 0.084 sec\n    [junit] Running org.apache.hadoop.fs.TestTrash\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 2.506 sec\n    [junit] Running org.apache.hadoop.fs.TestTruncatedInputBug\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.531 sec\n    [junit] Running org.apache.hadoop.fs.kfs.TestKosmosFileSystem\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.824 sec\n    [junit] Running org.apache.hadoop.fs.permission.TestFsPermission\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.1 sec\n    [junit] Running org.apache.hadoop.fs.s3.TestINode\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.076 sec\n    [junit] Running org.apache.hadoop.fs.s3.TestInMemoryS3FileSystemContract\n    [junit] Tests run: 29, Failures: 0, Errors: 0, Time elapsed: 2.437 sec\n    [junit] Running org.apache.hadoop.fs.s3.TestS3Credentials\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.195 sec\n    [junit] Running org.apache.hadoop.fs.s3.TestS3FileSystem\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.237 sec\n    [junit] Running org.apache.hadoop.fs.s3native.TestInMemoryNativeS3FileSystemContract\n    [junit] Tests run: 35, Failures: 0, Errors: 0, Time elapsed: 2.031 sec\n    [junit] Running org.apache.hadoop.http.TestGlobalFilter\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 1.535 sec\n    [junit] Running org.apache.hadoop.http.TestServletFilter\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 1.826 sec\n    [junit] Running org.apache.hadoop.io.TestArrayFile\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 6.627 sec\n    [junit] Running org.apache.hadoop.io.TestArrayWritable\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.213 sec\n    [junit] Running org.apache.hadoop.io.TestBloomMapFile\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.766 sec\n    [junit] Running org.apache.hadoop.io.TestBytesWritable\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.186 sec\n    [junit] Running org.apache.hadoop.io.TestDefaultStringifier\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.341 sec\n    [junit] Running org.apache.hadoop.io.TestEnumSetWritable\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.2 sec\n    [junit] Running org.apache.hadoop.io.TestGenericWritable\n    [junit] Tests run: 5, Failures: 0, Errors: 0, Time elapsed: 0.527 sec\n    [junit] Running org.apache.hadoop.io.TestMD5Hash\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.088 sec\n    [junit] Running org.apache.hadoop.io.TestMapFile\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.861 sec\n    [junit] Running org.apache.hadoop.io.TestMapWritable\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.289 sec\n    [junit] Running org.apache.hadoop.io.TestSequenceFileSerialization\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.672 sec\n    [junit] Running org.apache.hadoop.io.TestSetFile\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 6.44 sec\n    [junit] Running org.apache.hadoop.io.TestSortedMapWritable\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.263 sec\n    [junit] Running org.apache.hadoop.io.TestText\n    [junit] Tests run: 9, Failures: 0, Errors: 0, Time elapsed: 1.092 sec\n    [junit] Running org.apache.hadoop.io.TestTextNonUTF8\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.046 sec\n    [junit] Running org.apache.hadoop.io.TestUTF8\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.223 sec\n    [junit] Running org.apache.hadoop.io.TestVersionedWritable\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.075 sec\n    [junit] Running org.apache.hadoop.io.TestWritable\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.079 sec\n    [junit] Running org.apache.hadoop.io.TestWritableName\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.231 sec\n    [junit] Running org.apache.hadoop.io.TestWritableUtils\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.036 sec\n    [junit] Running org.apache.hadoop.io.compress.TestCodec\n    [junit] Tests run: 6, Failures: 0, Errors: 0, Time elapsed: 20.625 sec\n    [junit] Running org.apache.hadoop.io.compress.TestCodecFactory\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.453 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFile\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 2.756 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileByteArrays\n    [junit] Tests run: 25, Failures: 0, Errors: 0, Time elapsed: 6.188 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileComparators\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.555 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileJClassComparatorByteArrays\n    [junit] Tests run: 25, Failures: 0, Errors: 0, Time elapsed: 6.104 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileLzoCodecsByteArrays\n    [junit] Tests run: 25, Failures: 0, Errors: 0, Time elapsed: 0.207 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileLzoCodecsStreams\n    [junit] Tests run: 19, Failures: 0, Errors: 0, Time elapsed: 0.201 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileNoneCodecsByteArrays\n    [junit] Tests run: 25, Failures: 0, Errors: 0, Time elapsed: 3.298 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileNoneCodecsJClassComparatorByteArrays\n    [junit] Tests run: 25, Failures: 0, Errors: 0, Time elapsed: 3.378 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileNoneCodecsStreams\n    [junit] Tests run: 19, Failures: 0, Errors: 0, Time elapsed: 3.224 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileSeek\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 6.468 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileSeqFileComparison\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 23.683 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileSplit\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 11.542 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileStreams\n    [junit] Tests run: 19, Failures: 0, Errors: 0, Time elapsed: 3.893 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestTFileUnsortedByteArrays\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.875 sec\n    [junit] Running org.apache.hadoop.io.file.tfile.TestVLong\n    [junit] Tests run: 9, Failures: 0, Errors: 0, Time elapsed: 4.215 sec\n    [junit] Running org.apache.hadoop.io.retry.TestRetryProxy\n    [junit] Tests run: 9, Failures: 0, Errors: 0, Time elapsed: 0.417 sec\n    [junit] Running org.apache.hadoop.io.serializer.TestWritableSerialization\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.264 sec\n    [junit] Running org.apache.hadoop.io.serializer.avro.TestAvroSerialization\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.677 sec\n    [junit] Running org.apache.hadoop.ipc.TestIPC\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 15.459 sec\n    [junit] Running org.apache.hadoop.ipc.TestIPCServerResponder\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 11.274 sec\n    [junit] Running org.apache.hadoop.ipc.TestRPC\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 34.832 sec\n    [junit] Running org.apache.hadoop.log.TestLogLevel\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 1.407 sec\n    [junit] Running org.apache.hadoop.metrics.TestMetricsServlet\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.142 sec\n    [junit] Running org.apache.hadoop.metrics.spi.TestOutputRecord\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.048 sec\n    [junit] Running org.apache.hadoop.net.TestDNS\n    [junit] Tests run: 7, Failures: 0, Errors: 0, Time elapsed: 0.107 sec\n    [junit] Running org.apache.hadoop.net.TestScriptBasedMapping\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.489 sec\n    [junit] Running org.apache.hadoop.net.TestSocketIOWithTimeout\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 3.091 sec\n    [junit] Running org.apache.hadoop.record.TestBuffer\n    [junit] Tests run: 6, Failures: 0, Errors: 0, Time elapsed: 0.069 sec\n    [junit] Running org.apache.hadoop.record.TestRecordIO\n    [junit] Tests run: 5, Failures: 0, Errors: 0, Time elapsed: 0.209 sec\n    [junit] Running org.apache.hadoop.record.TestRecordVersioning\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.143 sec\n    [junit] Running org.apache.hadoop.security.TestAccessControlList\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.047 sec\n    [junit] Running org.apache.hadoop.security.TestAccessToken\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 1.029 sec\n    [junit] Running org.apache.hadoop.security.TestUnixUserGroupInformation\n    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 0.534 sec\n    [junit] Running org.apache.hadoop.security.authorize.TestConfiguredPolicy\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.401 sec\n    [junit] Running org.apache.hadoop.util.TestCyclicIteration\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.049 sec\n    [junit] Running org.apache.hadoop.util.TestGenericsUtil\n    [junit] Tests run: 6, Failures: 0, Errors: 0, Time elapsed: 0.247 sec\n    [junit] Running org.apache.hadoop.util.TestIndexedSort\n    [junit] Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 2.097 sec\n    [junit] Running org.apache.hadoop.util.TestProcfsBasedProcessTree\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 7.739 sec\n    [junit] Running org.apache.hadoop.util.TestPureJavaCrc32\n    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 1.372 sec\n    [junit] Running org.apache.hadoop.util.TestShell\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 4.265 sec\n    [junit] Running org.apache.hadoop.util.TestStringUtils\n    [junit] Tests run: 6, Failures: 0, Errors: 0, Time elapsed: 0.071 sec\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=boryas","name":"boryas","key":"boryas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Boris Shkolnik","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-08-06T20:21:13.506+0000","updated":"2009-08-06T20:21:13.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12740627","id":"12740627","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"I was about to commit this patch, but realized that this issue should have belonged to hadoop project common.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-07T16:38:55.820+0000","updated":"2009-08-07T16:38:55.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12740656","id":"12740656","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"I've just committed this. Thanks Boris!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-07T18:01:13.911+0000","updated":"2009-08-07T18:01:13.911+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12740775","id":"12740775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"After updated hadoop-core-0.21.0-dev.jar and hadoop-core-test-0.21.0-dev.jar on hdfs, TestHDFSTrash failed.  Could someone take a look?\n\n{noformat}\n------------- Standard Error -----------------\nrmr: Cannot move \"hdfs://localhost:57940/user/tsz\" to the trash, as it contains  \nthe trash\n------------- ---------------- ---------------\n\nTestcase: testTrash took 1.451 sec\n        Caused an ERROR\nnull\njava.lang.NullPointerException\n        at org.apache.hadoop.fs.TestTrash.countSameDeletedFiles(TestTrash.java:77\n5)\n        at org.apache.hadoop.fs.TestTrash.trashShell(TestTrash.java:363)\n        at org.apache.hadoop.hdfs.TestHDFSTrash.testTrash(TestHDFSTrash.java:54)\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:23)\n        at junit.extensions.TestSetup.run(TestSetup.java:27)\n\nTestcase: testNonDefaultFS took 0.262 sec\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-08-07T23:01:11.914+0000","updated":"2009-08-07T23:01:11.914+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12740893","id":"12740893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-Common-trunk #48 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/48/])\n    . NameNode slowed down when many files with same filename were moved to Trash. Contributed by Boris Shkolnik.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2009-08-08T13:04:13.798+0000","updated":"2009-08-08T13:04:13.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423396/comment/12764110","id":"12764110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chansler","name":"chansler","key":"chansler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Chansler","active":true,"timeZone":"America/Los_Angeles"},"body":"Editorial pass over all release notes prior to publication of 0.21. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chansler","name":"chansler","key":"chansler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Chansler","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-10-09T17:34:37.656+0000","updated":"2009-10-09T17:34:37.656+0000"}],"maxResults":24,"total":24,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-6180/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0i1mf:"}}