{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12393130","self":"https://issues.apache.org/jira/rest/api/2/issue/12393130","key":"HADOOP-3173","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2008-04-08T00:23:26.712+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Jun 04 17:13:03 UTC 2008","customfield_12310420":"125822","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_2511876105_*|*_1_*:*_1_*:*_3906778309_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_7841262849","customfield_12312321":null,"resolutiondate":"2008-06-17T23:16:24.883+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-3173/watchers","watchCount":1,"isWatching":false},"created":"2008-04-04T16:18:50.469+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12320316","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12320316","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12393950","key":"HADOOP-3257","self":"https://issues.apache.org/jira/rest/api/2/issue/12393950","fields":{"summary":"Path should handle all characters","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12320315","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12320315","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12380564","key":"HDFS-13","self":"https://issues.apache.org/jira/rest/api/2/issue/12380564","fields":{"summary":"filenames with ':' colon throws java.lang.IllegalArgumentException","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:43:01.516+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"hadoop dfs -mkdir /user/*/bar creates a directory \"/user/*/bar\" and you cant deleted /user/* as -rmr expands the glob\n\n$ hadoop dfs -mkdir /user/rajive/a/*/foo\n$ hadoop dfs -ls /user/rajive/a\nFound 4 items\n/user/rajive/a/*\t<dir>\t\t2008-04-04 16:09\trwx------\trajive\tusers\n/user/rajive/a/b\t<dir>\t\t2008-04-04 16:08\trwx------\trajive\tusers\n/user/rajive/a/c\t<dir>\t\t2008-04-04 16:08\trwx------\trajive\tusers\n/user/rajive/a/d\t<dir>\t\t2008-04-04 16:08\trwx------\trajive\tusers\n\n$ hadoop dfs -ls /user/rajive/a/*\n/user/rajive/a/*/foo\t<dir>\t\t2008-04-04 16:09\trwx------\trajive\tusers\n\n$ hadoop dfs -rmr /user/rajive/a/*\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/*\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/b\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/c\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/d\n\n\nI am not able to escape '*' from being expanded.\n\n$ hadoop dfs -rmr '/user/rajive/a/*'\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/*\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/b\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/c\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/d\n\n$ hadoop dfs -rmr  '/user/rajive/a/\\*'\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/*\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/b\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/c\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/d\n\n$ hadoop dfs -rmr  /user/rajive/a/\\* \nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/*\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/b\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/c\nMoved to trash: hdfs://namenode-1:8020/user/rajive/a/d\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12382236","id":"12382236","filename":"3173-0.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-17T02:54:48.043+0000","size":3828,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12382236/3173-0.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"105224","customfield_12312823":null,"summary":"inconsistent globbing support for dfs commands","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajive","name":"rajive","key":"rajive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajiv Chittajallu","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajive","name":"rajive","key":"rajive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajiv Chittajallu","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Hadoop 0.16.1","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12585616","id":"12585616","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajive","name":"rajive","key":"rajive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajiv Chittajallu","active":true,"timeZone":"America/Los_Angeles"},"body":"Escaped formatting:\n\n{hadoop dfs -mkdir /user/*/bar creates a directory \"/user/*/bar\" and you cant just deleted /user/* as -rmr expands the glob}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rajive","name":"rajive","key":"rajive","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajiv Chittajallu","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-04-04T16:26:32.667+0000","updated":"2008-04-04T16:26:32.667+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12586607","id":"12586607","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"This is a known issue and is not a regression. See HADOOP-1995. So I am not going to mark it a blocker to release 0.17. Code-wise we use backslash to escape glob special characters. But backslash collides with the windows path separator. It does not work.\n\nFor now I would suggest a user to programatically remove a directory/file whose name contains glob special characters.\n\nAlso Rajiv, you should quote all dfs globs in the command line. Otherwise, the local file system will interpret it first.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-04-08T00:23:26.712+0000","updated":"2008-04-08T00:24:14.962+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12597672","id":"12597672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"I mostly agree with Hairong; this is easy to do programmatically, and while there are a few alternatives (different escape character, URI encoding, new \"literal\" FsShell commands, etc), most appear to make the general case worse to accommodate a fairly esoteric use.\n\nOn the other hand, there are only a few places (FsShell and FileInputFormat, mainly) where we call globStatus, and in each case a String is converted to a Path before being converted back into a String in globStatus. Without the conversion, the pattern syntax can mandate that the path separator must be '/' independent of the Path syntax. Unfortunately, actually effecting this change is awkward, primarily because one must still create a Path of the glob string to obtain the FileSystem to resolve it against. If the glob string creates a Path to be resolved against a FileSystem other than the default, then the scheme, authority, etc. must be excised from the original string to preserve the escaping, etc., which will ultimately duplicate much of the URI parsing that's already happening in Path. Particularly for FileInputFormat and its users, pulling out all the Path dependencies (i.e. changing users of the globbing API) is a huge job with a modest payback.\n\nSince Path(String) already isolates this segment, we could introduce Path::getRawPath that would preserve the path before Path::normalizePath and URI::normalize. With this, globStatus would resolve Path::getRawPath instead of p.toUri().getPath(). Unfortunately, this would mean that globStatus(p) might return different results than globstatus(new Path(p.toString())), which means FileInputFormat would still have this issue. Even if Path(Path, String) and variants preserved a raw path, its semantics would be unclear. In Path(Path, String), is the raw Path only eq the raw Path from the second arg if it is absolute? Is it the raw path from the first arg preserved in some way? We could just assert that the raw path is only different from p.toUri().getPath() if it was created with Path(String), but this could be confusing when creating globs from a base path (i.e. Path(Path, String) or possibly more confusing, Path(String, Path)). The URI normalization also removes all the \"..\" and \".\" entries in the Path, which the regexp would then have to handle (e.g. \"a/b/../c*\" is resolved to \"a/c*\" now, but using the raw path, GlobFilter would accept \"a/b/dd/c\" since '.' matches GlobFilter::PAT_ANY). That said, FileInputFormats and all Strings that were once Paths wouldn't have to deal with this, while utilities like FsShell could match \"a/b/../c\" as regexps, which might not be a bad thing.\n\nIf we want to fix this, I'd propose adding Path::getRawPath which would be used in FileSystem::globStatus, but could only be different from p.getUri().getPath() when the Path was created from a String. This covers cases where one wants to create a Path regexp manually and use it as a glob (as in FsShell), but should not change behavior elsewhere.\n\nThoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-17T01:01:07.817+0000","updated":"2008-05-17T01:01:07.817+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12597675","id":"12597675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"> hadoop dfs -mkdir /user/*/bar creates a directory \"/user/*/bar\" and you cant deleted /user/* as -rmr expands the glob\n\nSpecial characters like * is really problematic: even JIRA cannot display it correctly.  :)\n\nAgain, we need to escape:\nhadoop dfs -mkdir /user/\\*/bar creates a directory \"/user/\\*/bar\" and you cant deleted /user/* as -rmr expands the glob","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-17T01:19:18.181+0000","updated":"2008-05-17T01:19:18.181+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12597678","id":"12597678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=runping","name":"runping","key":"runping","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Runping Qi","active":true,"timeZone":"Etc/UTC"},"body":"Why don't we declare  not to allow those special characters?\nIt will simplify things a lot and make everybody's life easier.\nI don't think that causes serious limitation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=runping","name":"runping","key":"runping","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Runping Qi","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-17T01:31:25.773+0000","updated":"2008-05-17T01:31:25.773+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12597692","id":"12597692","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"Attached an example of the getRawPath approach.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-17T02:54:48.081+0000","updated":"2008-05-17T02:54:48.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12597695","id":"12597695","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"One more drawback: on windows, if one's path has backslashes in it, then Paths created with Path(String) cannot be globbed. This may not be a serious limitation, since any paths with backslashes are likely to be from environment variables, so real uses will come from Path(Path, String) and other variants.\n\nbq. Why don't we declare not to allow those special characters?\n\nWe could. The namenode would have to check for special characters when creating new nodes, and we'd also need to provide an upgrade path for users. In theory it's a pretty dramatic change to cut down the charset, but in practice I doubt many will notice.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-17T03:08:53.815+0000","updated":"2008-05-17T03:08:53.815+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12598104","id":"12598104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm marking this PA, mostly for discussion purposes. I'm not ecstatic about the current patch, but it passes tests on my machine and resolves the issue called out in this JIRA.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-19T21:31:48.771+0000","updated":"2008-05-19T21:31:48.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12598136","id":"12598136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12382236/3173-0.patch\n  against trunk revision 657985.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    +1 tests included.  The patch appears to include 8 new or modified tests.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 contrib tests.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2501/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2501/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2501/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2501/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-19T23:46:29.564+0000","updated":"2008-05-19T23:46:29.564+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12600672","id":"12600672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"I've been asked to clarify the implications of this proposal. There are 6 Path constructors:\n# Path(String, String)\n# Path(Path, String)\n# Path(String, Path)\n# Path(Path, Path)\n# Path(String)\n# Path(String, String, String)\n\nConstructors 5 and 6 would preserve the path component of the URI as a String (the \"rawPath\") used only for globbing; all other Path operations would continue to work as they always have. For the following, let {{p}}, {{q}} be Paths, where {{q}} is initialized as:\n{noformat}\nPath q = new Path(p.toString());\n{noformat}\n\nGiven the following initializations for {{p}}:\n{noformat}\n1. p = new Path(\"/foo/\\\\*/bar\");\n2. p = new Path(\"hdfs://foobar:8020/foo/p-1{\\?}\");\n{noformat}\n\n{{globStatus\\(x)}} would return different results. In the first instance, globbing {{p}} would return the directory \"\\*\", as _expected_ in this JIRA, while globbing {{q}} would have the result as _observed_ in this JIRA. In the second, p would be a legal glob (the escape prior to '?' wouldn't be converted to a path separator), so given:\n{noformat}\nuser@host$ bin/hadoop dfs -ls 'foo/bar/'\nFound 5 items:\n1    0           2008-05-28 20:00  -rw-r--r--  chrisdo  supergroup  /user/chrisdo/foo/bar/p-00\n1    0           2008-05-28 20:01  -rw-r--r--  chrisdo  supergroup  /user/chrisdo/foo/bar/p-01\n1    0           2008-05-28 20:01  -rw-r--r--  chrisdo  supergroup  /user/chrisdo/foo/bar/p-10\n1    0           2008-05-28 20:01  -rw-r--r--  chrisdo  supergroup  /user/chrisdo/foo/bar/p-11\n1    0           2008-05-28 20:03  -rw-r--r--  chrisdo  supergroup  /user/chrisdo/foo/bar/p-1?\n{noformat}\n\nOne could specify both '{{foo/bar/p-1{\\?}}}' (file 5) and '{{foo/bar/p-1?}}' (files 3-5).\n\nThere are two primary \"globbers\" in the codebase, FsShell and FileInputFormats. In the current proposal, the latter would continue to be in the \"{{q}} case\", i.e. there would be no change to its behavior. FsShell, however, would be in the \"{{p}} case\", i.e. the user string would be used for globbing without first passing through Path and URI normalization. This has the advantage of resolving this JIRA, but the significant disadvantage of making globbing in FsShell and map/reduce inconsistent. If a user were to test out a pattern in the shell and try to use it as a pattern for their FileInputFormat derivative, they could get different results.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-05-29T03:14:54.963+0000","updated":"2008-05-29T03:14:54.963+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12601205","id":"12601205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Chris's proposal solves the problem. But the patch gives different semantics to the constructors of Path. It seems not elegant and might bring confusion to users.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-05-30T18:02:12.380+0000","updated":"2008-05-30T18:02:12.380+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12602060","id":"12602060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"The possible solutions are constrained by the fact that Path objects go through two passes of normalization before they're globbed. Unless we preserve the path as a String prior those transformations, we can only glob the result, which yields the behavior in this JIRA. Come to think of it, how does the escape get to the globbing code? Given:\n\n{code:title=Path.java::normalizePath}\n    path = path.replace(\"\\\\\", \"/\");\n{code}\n\nHow does\n\n{code:title=FileSystem.GlobFilter::setRegex}\nif (pCh == PAT_ESCAPE) {\n  fileRegex.append(pCh);\n  i++;\n  if (i >= len)\n    error(\"An escaped character does not present\", filePattern, i);\n  pCh = filePattern.charAt(i);\n}\n{code}\n\never occur, when the pattern comes from {{pathPattern.toUri().getPath()}} ? Anyway- I agree with Hairong, the proposed solution is clearly a hack, but I don't see how we can avoid something like it.\n\nI propose we mark this as \"Won't fix\" and live with programmatically manipulating the odd file until we have a model that can handle this elegantly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-06-03T20:29:36.941+0000","updated":"2008-06-03T20:29:36.941+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12393130/comment/12602363","id":"12602363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chansler","name":"chansler","key":"chansler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Chansler","active":true,"timeZone":"America/Los_Angeles"},"body":"Assigning to whomever submitted a patch so as to better manage committing things that are ready for prime time. Although this one remains controversial ...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chansler","name":"chansler","key":"chansler","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Chansler","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-06-04T17:13:03.059+0000","updated":"2008-06-04T17:13:03.059+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-3173/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0id5b:"}}