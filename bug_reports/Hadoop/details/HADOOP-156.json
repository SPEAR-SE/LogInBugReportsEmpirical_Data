{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12332451","self":"https://issues.apache.org/jira/rest/api/2/issue/12332451","key":"HADOOP-156","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2006-09-16T08:39:14.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jan 15 17:30:10 UTC 2009","customfield_12310420":"19151","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_86447962431_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-01-15T17:30:10.431+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-156/watchers","watchCount":0,"isWatching":false},"created":"2006-04-21T04:10:48.000+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310930","id":"12310930","description":"","name":"0.3.0","archived":false,"released":true,"releaseDate":"2006-06-02"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:51:46.070+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"A job was running with all the map tasks completed.\nThe reducers were appending the intermediate files into the large intermediate file.\njava.io.EOFException was thrown when the record reader tried to read the version number\nduring initialization. Here is the stack trace:\n\njava.io.EOFException \n    at java.io.DataInputStream.readFully(DataInputStream.java:178) \n    at java.io.DataInputStream.readFully(DataInputStream.java:152) \n    at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:251) \n    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:236) \n    at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:226) \n    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:205) \n    at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:709) \n\nAppearantly, the intermediate file was empty. I suspect that one map task\ngenerated empty intermidiate files for all the reducers, since all the reducers\nfailed at the same place, and failed at the same place during retries.\n\nUnfortunately, we cannot know which map task generated the empty files,\nsince the exception does not offer any clue.\n\nOne simple enhancement is that the record reader should catch IOException and re-throw it with additional \ninformation, such as the file name.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"107315","customfield_12312823":null,"summary":"Reducer  threw IOEOFException","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=runping","name":"runping","key":"runping","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Runping Qi","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=runping","name":"runping","key":"runping","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Runping Qi","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332451/comment/12435198","id":"12435198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oae","name":"oae","key":"oae","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johannes Zillmann","active":true,"timeZone":"Europe/Berlin"},"body":"i've tackled the same problem with hadoop 0.3.2 after setting mapred.reduce.tasks from 'nodes' to 'nodes * mapred.tasktracker.tasks.maximum(==2)' like sugested in the wiki.\n\njava.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:178) at java.io.DataInputStream.readFully(DataInputStream.java:152) at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:263) at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:247) at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:237) at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:203) at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:847)  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oae","name":"oae","key":"oae","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johannes Zillmann","active":true,"timeZone":"Europe/Berlin"},"created":"2006-09-16T08:39:14.000+0000","updated":"2006-09-16T08:39:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332451/comment/12435262","id":"12435262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sanjay.dahiya","name":"sanjay.dahiya","key":"sanjay.dahiya","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sanjay Dahiya","active":true,"timeZone":"Etc/UTC"},"body":"I see the same problem with 0.6.2. But I suspect maps are producing correct data. From the logs it appears the map output was not empty for all reduces as some other reduce tasks read output and were successfully finished. For the map outputs which were not available when reduces asked for it, i can see consistently that task tracker assumes maps are done and deletes the files. after this reduces ask for the map data and the failures cascades.\n\nHere is a common pattern -\n\n2006-09-15 15:15:59,564 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_m_000341_0 done; removing files.\n\nFor this task - before it got cleaned up a reduce task copied data successfully and finished. \n\n2006-09-15 02:00:50,537 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000524_0 done copying task_0001_m_000341_0 output.\n\nBut after the cleanup another reduce task tries to copy and fails -\n\n2006-09-15 15:16:01,794 WARN org.apache.hadoop.mapred.TaskTracker: Http server (getMapOutput.jsp): java.io.FileNotFoundException: /***/hadoop/mapred/local/task_0001_m_000341_0/part-94.out\n\nOn reduce task we get same EOFException. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sanjay.dahiya","name":"sanjay.dahiya","key":"sanjay.dahiya","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sanjay Dahiya","active":true,"timeZone":"Etc/UTC"},"created":"2006-09-16T19:20:56.000+0000","updated":"2006-09-16T19:20:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332451/comment/12435447","id":"12435447","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sanjay.dahiya","name":"sanjay.dahiya","key":"sanjay.dahiya","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sanjay Dahiya","active":true,"timeZone":"Etc/UTC"},"body":"Also the task tracker running the map task in question was *not* reported lost on jobtracker and hence reinitialized causing map output to cleanup. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sanjay.dahiya","name":"sanjay.dahiya","key":"sanjay.dahiya","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sanjay Dahiya","active":true,"timeZone":"Etc/UTC"},"created":"2006-09-18T10:00:12.000+0000","updated":"2006-09-18T10:00:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332451/comment/12435464","id":"12435464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sanjay.dahiya","name":"sanjay.dahiya","key":"sanjay.dahiya","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sanjay Dahiya","active":true,"timeZone":"Etc/UTC"},"body":"ok, the EOFException in the case I posted earlier is not a critical issue. it happened after the job was aborted on job tracker, some task trackers cleaned up map outputs while reduce tasks were still running on others. \n\nHowever there are genuine EOFExceptions as well which occur in sort phase on reduce tasks, which may be due to malformed map output. e.g. following \n\n2006-09-15 08:04:13,900 INFO org.apache.hadoop.mapred.TaskTracker: task_0001_r_000511_0 0.33333334% reduce > sort\n\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0 06/09/15 08:04:13 WARN mapred.TaskTracker: Error running child\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0 java.io.EOFException\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at java.io.DataInputStream.readFully(DataInputStream.java:178)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at java.io.DataInputStream.readFully(DataInputStream.java:152)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.io.SequenceFile$Reader.init(SequenceFile.java:952)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.io.SequenceFile$Reader.<init>(SequenceFile.java:937)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.io.SequenceFile$Reader.<init>(SequenceFile.java:928)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.io.SequenceFile$Sorter$SortPass.run(SequenceFile.java:1594)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.io.SequenceFile$Sorter.sortPass(SequenceFile.java:1523)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.io.SequenceFile$Sorter.sort(SequenceFile.java:1496)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:240)\n2006-09-15 08:04:13,996 INFO org.apache.hadoop.mapred.TaskRunner: task_0001_r_000511_0  at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:1165)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sanjay.dahiya","name":"sanjay.dahiya","key":"sanjay.dahiya","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sanjay Dahiya","active":true,"timeZone":"Etc/UTC"},"created":"2006-09-18T12:10:50.000+0000","updated":"2006-09-18T12:10:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332451/comment/12664183","id":"12664183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"body":"I suspect this was one of the race conditions and that part of the code has changed completely since this was filed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-01-15T17:30:10.306+0000","updated":"2009-01-15T17:30:10.306+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-156/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0iq1z:"}}