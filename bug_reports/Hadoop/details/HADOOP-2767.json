{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12387641","self":"https://issues.apache.org/jira/rest/api/2/issue/12387641","key":"HADOOP-2767","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312913","id":"12312913","description":"","name":"0.17.0","archived":false,"released":true,"releaseDate":"2008-05-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-02-04T22:54:27.084+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Feb 08 12:01:15 UTC 2008","customfield_12310420":"81295","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_138865481_*|*_1_*:*_1_*:*_375708754_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_9004261747","customfield_12312321":null,"resolutiondate":"2008-02-07T14:54:49.003+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-2767/watchers","watchCount":0,"isWatching":false},"created":"2008-02-01T15:58:34.768+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312921","id":"12312921","description":"","name":"0.15.3","archived":false,"released":true,"releaseDate":"2008-01-21"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:42:53.819+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"I have written some test code that shows NetworkTopology.InnerNode#getLeaf will never return the last node on the rack if it is called with an excludedNode (for example the first node on the rack). \n\nConsequently I suspect that NetworkTopology.chooseRandom() will never returns the last node on the remote rack for the second replica in DFS. \n\nI have some test code that demonstrates this problem at the getLeaf level, although it is necessary to change the visibility of the NetworkTopology.InnerNode, NetworkTopology.InnerNode#getLeaf and NetworkTopology.getNode from private to package default to run the test. \n\nTODO: Demonstrate problem at NetworkTopology.chooseRandom level, then submit candidate fix. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12374721","id":"12374721","filename":"excludedLeaf.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-04T22:54:26.885+0000","size":3344,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12374721/excludedLeaf.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12374781","id":"12374781","filename":"excludedLeaf2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-05T16:00:10.487+0000","size":5807,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12374781/excludedLeaf2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12374824","id":"12374824","filename":"excludedLeaf3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-05T22:06:02.911+0000","size":5734,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12374824/excludedLeaf3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12374834","id":"12374834","filename":"excludedLeaf4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-06T00:19:55.218+0000","size":5982,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12374834/excludedLeaf4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12374570","id":"12374570","filename":"NetworkTopologyTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-01T18:07:16.824+0000","size":2721,"mimeType":"text/x-java","content":"https://issues.apache.org/jira/secure/attachment/12374570/NetworkTopologyTest.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"105559","customfield_12312823":null,"summary":"org.apache.hadoop.net.NetworkTopology.InnerNode#getLeaf does not return the last node on a rack when used with an excluded node","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12564807","id":"12564807","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"body":"This test case demonstrates the problem with last nodes on the rack at the getLeaf level. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-01T15:59:52.227+0000","updated":"2008-02-01T15:59:52.227+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12564850","id":"12564850","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"body":"This amended test case demonstrates that NetworkTopology.chooseRandom(~node) will not return the last node on the rack. \n\nThis is called by \n\norg.apache.hadoop.dfs.ReplicationTargetChooser#chooseRandom(int, String, List<Node>), \n\nwhich in turn is called by \n\nchooseRandom(int, String, List<Node>, long, int, List<DatanodeDescriptor> \nchooseRandom(String, List<Node>, long, int, List<DatanodeDescriptor>\n\nwhich are called by\n\nchooseRemoteRack(int, DatanodeDescriptor, List<Node>, long, int, List<DatanodeDescriptor>)\nchooseTarget(int, DatanodeDescriptor, List<Node>, long, int, List<DatanodeDescriptor>)\n\nchooseTarget is an important method for placing replicas. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-01T18:07:17.039+0000","updated":"2008-02-01T18:07:17.039+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12564858","id":"12564858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"body":"Further examination shows the problem only occurs when you are excluding a node, not when you are excluding a rack. So it may not be a problem for DFS ...\n\nHowever, if it does occur, it is not just a problem of not using a node, it also causes another node to be a \"hotspot\" as it is twice as likely as any other node to get a replica placement., which is clearly undesirable ..  \n\nCan someone more familiar with DFS replication code comment if this is likely to be a problem?\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-01T18:26:06.415+0000","updated":"2008-02-01T18:26:06.415+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565588","id":"12565588","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Mark, thank you for your time investigating this issue. Yes, this is a bug, wich occurs when the excluded node is a leaf. Fortunately dfs block allocation strategy only excludes racks. So the bug does not have an effect on the dfs block allocation. Could you please check if the attached patch fixed the problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-04T22:54:27.084+0000","updated":"2008-02-04T22:54:27.084+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565781","id":"12565781","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"body":"Hairong, thanks for the speedy reply. \n\nAs you note, looking at the code, DFS does not call this to exclude nodes.  So it is not a problem for DFS. Specifically excluding racks happens in NetworkTopology.chooseRandom(String) while excluding nodes occurs in ReplicationTargetChooser.chooseRandom(int numReplicas, String nodes, List<Node> excludedNodes).  \n\nHowever you have written the patch, so my suggestion is we fix this. I took a look at the patch and there is a small error in it - it said\n\n      if (excludedNode instanceof InnerNode) {\n\n        numOfExcludedLeaves = ((InnerNode)excludedNode).getNumOfLeaves();\n\n    \tisLeaf = true;\n      }\n\nbut if it is an inner node, it can't be a leaf? Consequently it fails the test so I think it should be \n\n      if (excludedNode instanceof InnerNode) {\n\n        numOfExcludedLeaves = ((InnerNode)excludedNode).getNumOfLeaves();\n\n      } else { isLeaf = true; }\n\nI've produced an updated patch and also modified my test code and incorporated it into TestNetworkTopology.java. This should resolve the issue.\n\nThanks again! ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-05T15:58:22.400+0000","updated":"2008-02-05T16:08:43.245+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565782","id":"12565782","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"body":"This is a modified patch file, it fixes a problem with the previous patch and adds unit tests for this change. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=butlermh","name":"butlermh","key":"butlermh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=butlermh&avatarId=10421","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=butlermh&avatarId=10421","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=butlermh&avatarId=10421","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=butlermh&avatarId=10421"},"displayName":"Mark Butler","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-05T16:00:19.913+0000","updated":"2008-02-05T16:00:19.913+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565905","id":"12565905","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Mark, thank you for providing junit tests for the patch. They look good. The patch that I am uploading have two minor changes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-05T22:06:03.054+0000","updated":"2008-02-05T22:06:03.054+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565939","id":"12565939","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"excludedLeaf3.patch: +1\ncodes look good, I suggest the following change:\n{code}\n      ...\n      int numOfExcludedLeaves = 1;\n      boolean isLeaf = !(excludedNode instanceof InnerNode);\n      if (!isLeaf) {\n        numOfExcludedLeaves = ((InnerNode)excludedNode).getNumOfLeaves();\n      }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-02-05T23:03:10.883+0000","updated":"2008-02-05T23:03:10.883+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565972","id":"12565972","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"body":"Incorporated Nicholas's comment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hairong","name":"hairong","key":"hairong","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hairong Kuang","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-06T00:19:55.351+0000","updated":"2008-02-06T00:19:55.351+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12565998","id":"12565998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"+1 overall.  Here are the results of testing the latest attachment \nhttp://issues.apache.org/jira/secure/attachment/12374834/excludedLeaf4.patch\nagainst trunk revision 616796.\n\n    @author +1.  The patch does not contain any @author tags.\n\n    javadoc +1.  The javadoc tool did not generate any warning messages.\n\n    javac +1.  The applied patch does not generate any new javac compiler warnings.\n\n    release audit +1.  The applied patch does not generate any new release audit warnings.\n\n    findbugs +1.  The patch does not introduce any new Findbugs warnings.\n\n    core tests +1.  The patch passed core unit tests.\n\n    contrib tests +1.  The patch passed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/1747/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/1747/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/1747/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/1747/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-06T03:07:26.924+0000","updated":"2008-02-06T03:07:26.924+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12566617","id":"12566617","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"I just committed this. Thanks Mark and Hairong!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2008-02-07T14:54:48.980+0000","updated":"2008-02-07T14:54:48.980+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387641/comment/12567008","id":"12567008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in Hadoop-trunk #394 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/394/])","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2008-02-08T12:01:15.308+0000","updated":"2008-02-08T12:01:15.308+0000"}],"maxResults":12,"total":12,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-2767/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0if7r:"}}