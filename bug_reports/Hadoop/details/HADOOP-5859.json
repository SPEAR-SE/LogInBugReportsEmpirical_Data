{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12425640","self":"https://issues.apache.org/jira/rest/api/2/issue/12425640","key":"HADOOP-5859","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313563","id":"12313563","description":"","name":"0.21.0","archived":false,"released":true,"releaseDate":"2010-08-23"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-05-25T04:39:54.274+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jul 27 01:15:35 UTC 2010","customfield_12310420":"77874","customfield_12312320":null,"customfield_12310222":"10002_*:*_4_*:*_857377034_*|*_1_*:*_4_*:*_847642770_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-06-04T18:15:10.236+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-5859/watchers","watchCount":8,"isWatching":false},"created":"2009-05-16T00:38:10.432+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"12.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12327554","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12327554","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12439023","key":"HDFS-732","self":"https://issues.apache.org/jira/rest/api/2/issue/12439023","fields":{"summary":"HDFS files are ending up truncated","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12324927","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12324927","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12426205","key":"HDFS-88","self":"https://issues.apache.org/jira/rest/api/2/issue/12426205","fields":{"summary":"Hung on hdfs: writeChunk, DFSClient.java:2126, DataStreamer socketWrite","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-08-24T20:37:57.920+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"This JIRA fixes the following warnings:\n\nSWL\torg.apache.hadoop.hdfs.DFSClient$DFSOutputStream.closeInternal() calls Thread.sleep() with a lock held\nTLW\twait() with two locks held in org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.flushInternal()\nTLW\twait() with two locks held in org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.flushInternal()\nTLW\twait() with two locks held in org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.writeChunk(byte[], int, int, byte[])","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12408887","id":"12408887","filename":"5859-21.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-23T20:21:40.687+0000","size":63176,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12408887/5859-21.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12408891","id":"12408891","filename":"5859-22.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-23T23:10:17.342+0000","size":63176,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12408891/5859-22.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12408980","id":"12408980","filename":"5859-26.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-26T02:48:07.481+0000","size":64057,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12408980/5859-26.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12409194","id":"12409194","filename":"5859-33.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-27T18:32:48.086+0000","size":64381,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12409194/5859-33.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12409409","id":"12409409","filename":"5859-35.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-29T19:15:49.431+0000","size":64034,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12409409/5859-35.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12409430","id":"12409430","filename":"5859-36.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-29T23:02:39.005+0000","size":64176,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12409430/5859-36.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12409681","id":"12409681","filename":"5859-38.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-02T17:47:05.678+0000","size":64904,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12409681/5859-38.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12408328","id":"12408328","filename":"5859-4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-17T00:25:15.569+0000","size":2195,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12408328/5859-4.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12409725","id":"12409725","filename":"5859-40.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-03T04:43:57.012+0000","size":64427,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12409725/5859-40.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12409796","id":"12409796","filename":"5859-41.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-03T17:01:36.330+0000","size":64442,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12409796/5859-41.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12408329","id":"12408329","filename":"5859-5.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-17T00:28:25.701+0000","size":6976,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12408329/5859-5.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12408501","id":"12408501","filename":"5859-8.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-19T18:52:57.197+0000","size":2872,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12408501/5859-8.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"103503","customfield_12312823":null,"summary":"FindBugs : fix \"wait() or sleep() with locks held\" warnings in hdfs","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12710155","id":"12710155","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"attached 2 versions of the same patch. one with correct indentation, one without, for easier reviewing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-17T00:30:09.659+0000","updated":"2009-05-17T00:30:09.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12712275","id":"12712275","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"added a new patch that refactored DFSClient.DFSOutputStream code.\n1) socket write operation in DataStreamer is now done without holding dataQueue lock\n2) dataQueue lock and ackQueue lock are merged into one\n3) removed the above findbugs warnings","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-22T21:40:06.724+0000","updated":"2009-05-22T21:40:06.724+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12712631","id":"12712631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"> 2) dataQueue lock and ackQueue lock are merged into one\n\nIs this done to make the code simpler? Or was there some race condition that this fixes?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-25T04:39:54.274+0000","updated":"2009-05-25T04:39:54.274+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12712832","id":"12712832","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"> Is this done to make the code simpler? Or was there some race condition that this fixes?\n\nI don't see any race condition so far. One potential case is calling ackQueue.size() in writeChunk() without holding ackQueue lock, which is ok assuming int assignments are atomic. The major reasons for refactoring the locks are 1) existing code is bit confusing. Sometimes the dataQueue lock is used to protect accesses to not only dataQueue but also currentPacket, blockStream, blockReplyStream, etc (see closeInternal() for example), which I think is a misuse. 2) I have moved time-consuming operations like RPC call or writing to socket out of blocks sync'ed on the dataQueue. So now the only times one needs to hold dataQueue or ackQueue lock is when manipulating the queues themselves. By merging the 2 locks, code can be simpler.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-26T02:51:17.037+0000","updated":"2009-05-26T02:51:17.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713061","id":"12713061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"bq. which is ok assuming int assignments are atomic\n\nI haven't had a chance to look through the patch, but in general this is not a safe assumption. Although int assignment itself is atomic, if you don't do access inside a synchronization block, there's no enforcement of a memory barrier between threads, so one thread might not see the other thread's assignment. Also, if someone later decides that size should be a long, long assignment is not atomic on some JVM platforms. Thus the existence of java.util.concurrent.atomic.AtomicInteger.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-26T15:42:15.144+0000","updated":"2009-05-26T15:42:15.144+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713161","id":"12713161","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"> so one thread might not see the other thread's assignment.\n\nUnless the variable is declared as \"volatile\", right?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-26T17:55:19.793+0000","updated":"2009-05-26T17:55:19.793+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713172","id":"12713172","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"bq. Unless the variable is declared as \"volatile\", right?\n\nRight. volatile longs, though, are still not atomically assigned on 32-bit platforms, so I think it's asking for trouble to use the atomic assignment of volatile ints to your advantage, since someone may co","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-26T18:14:36.269+0000","updated":"2009-05-26T18:14:36.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713174","id":"12713174","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"er... trackpad malfunction. sorry...\ncontinuing:\nsomeone may come along at a later date and replace the int with a long thinking it's a trivial change that couldn't possibly break anything.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-26T18:15:25.455+0000","updated":"2009-05-26T18:15:25.455+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713177","id":"12713177","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"body":"From the section 17.7 of the Java Language Specs: \"Writes and reads of volatile long and double values are always atomic. \".  I think all JVMs should ensure that all \"volatile longs\" are atomic.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dhruba","name":"dhruba","key":"dhruba","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dhruba&avatarId=30636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dhruba&avatarId=30636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dhruba&avatarId=30636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dhruba&avatarId=30636"},"displayName":"dhruba borthakur","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-26T18:21:07.569+0000","updated":"2009-05-26T18:21:07.569+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713180","id":"12713180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"> Unless the variable is declared as \"volatile\", right?\n\nI just checked, the JDK6 implementation of LinkedList didn't declare the \"size\" variable volatile. So Todd is right, a second thread may see a stale cached value. In any case, this is a non-issue after my refactoring. In the refactored code, all accesses to dataQueue or ackQueue are sync'ed on dataQueue lock. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-26T18:23:30.092+0000","updated":"2009-06-05T00:55:46.225+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713188","id":"12713188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Hm, thanks Dhruba - I was recalling incorrectly. The discussion is getting way off-topic to this JIRA, but if people are interested, I highly recommend this video lecture: http://video.google.com/videoplay?docid=8394326369005388010","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2009-05-26T18:59:37.030+0000","updated":"2009-05-26T18:59:37.030+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713307","id":"12713307","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"Comments on the latest patch:\n# Can you add a comment where dataQueue and ackQueue are declared, that both these data structures are synchronized on dataQueue object\n# Can you retain the code formatting where you think the existing code is fine. That makes the patch size smaller and applying patches to the changed code easier.\n# Move static variable to the beginning of the class {{DFSOutputStream}}\n# {{maxRecoveryErrorCount}} should become static\n# Do we need so many volatile variables. Can one thread flag close and the DataStreamer does all the closing of internal variables\n# As we discussed, in {{ResponseProcessor.run()}} add notify when exception is caught\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-26T22:46:47.616+0000","updated":"2009-05-26T22:46:47.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713681","id":"12713681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"> As we discussed, in ResponseProcessor.run() add notify when exception is caught\n\nAs we discussed again, it's better to avoid adding unnecessary notifications, but rather add a timeout to dataQueue.wait(). Other comments are addressed in the new patch. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-27T18:36:01.018+0000","updated":"2009-05-27T18:36:01.018+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12713894","id":"12713894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"> I just checked, the JDK6 implementation of LinkedList didn't declare the \"size\" variable volatile. So Todd is right, a second thread may see a stale cached value\n\nI take it back. Actually, in this particular case the writeChunk() thread will be able to see the fresh value of ackQueue size whenever it's been modified. The reason is that writeChunk() reads ackQueue size while holding the dataQueue lock and waits on the dataQueue lock in a loop when condition is not satisfied. There are 2 threads that may modify ackQueue size. One is DataStreamer, who always holds both dataQueue and ackQueue locks when modifying ackQueue. So any changes to ackQueue by DataStreamer will be visible to writeChunk() thread. The other thread that modifies ackQueue is ResponseProcessor. It may modify ackQueue while holding only the ackQueue lock. However, immediately after ackQueue modification, it grabs the dataQueue lock and calls dataQueue.notifyAll() to wake up the writeChunk() thread. So when the writeChunk() thread grabs the dataQueue lock afterwards, the fresh value of ackQueue size will be visible. Make sense?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-28T07:02:21.107+0000","updated":"2009-05-28T07:02:21.107+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714544","id":"12714544","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"# Remove commented line setting maxPacket to 1000\n# {{DataStreamer.run()}} No need to set {{response}} to null, because closeResponse() called prior, sets the response to null\n# {{DataStreamer.run()}} code could be refactor to use closeStream() method instead of duplicating the code to close {{blockStream}}. A flag could be passed to indicate indicate end-of-block.\n# {{ResponseProcessor.processDataNodeError()}} could use closeStream method.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-29T18:30:13.251+0000","updated":"2009-05-29T18:30:13.251+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714557","id":"12714557","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"thanks, Suresh. Attached a new patch that addressed your comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-29T19:16:51.161+0000","updated":"2009-05-29T19:16:51.161+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714630","id":"12714630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"added a new patch with some refactoring of closeStream().","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-29T23:02:39.086+0000","updated":"2009-05-29T23:02:39.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714631","id":"12714631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"+1. Looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-29T23:06:42.498+0000","updated":"2009-05-29T23:06:42.498+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714650","id":"12714650","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12409409/5859-35.patch\n  against trunk revision 780114.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no tests are needed for this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    -1 contrib tests.  The patch failed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/429/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/429/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/429/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/429/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-30T01:57:43.692+0000","updated":"2009-05-30T01:57:43.692+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714669","id":"12714669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"submit again to test the newest patch - 5859-36.patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-05-30T05:39:52.346+0000","updated":"2009-05-30T05:39:52.346+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12714933","id":"12714933","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12409430/5859-36.patch\n  against trunk revision 780465.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no tests are needed for this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    -1 core tests.  The patch failed core unit tests.\n\n    -1 contrib tests.  The patch failed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/442/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/442/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/442/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/442/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2009-05-31T22:05:10.476+0000","updated":"2009-05-31T22:05:10.476+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12715605","id":"12715605","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"After discussing with Raghu, I'm uploading a new patch where a new flag is added so that end-of-block is sent only when all data has been sent and ack'ed from datanode.\n\nThis patch doesn't include any new test since it's only a refactoring and no new feature is added.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-02T17:54:18.875+0000","updated":"2009-06-02T17:54:18.875+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12715636","id":"12715636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"# {{DataStreamer.nextBlockOutputStream()}} unnecessary code setting {{nodes}} to null (I see a Dead store to nodes findbugs warnings).\n# nit: You can get rid of parameter to {{DataStreamer.closeStream()}} and use {{DataStreamer.sendEndOfBlock}} instead. Simplifies understanding the cases when end of block is sent.\n# nit: {{DataStreamer.close()}} - it is a good idea to move printing the log of sending end of block to {{DataStreamer.closeStreamer()}} method.\n# nit: Move the comments added for {{DataStreamer.run()}} to the beginning of {{DataStreamer}} class.\n# nit: Capitalize {{MaxRecoveryErrorCount}}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-02T19:33:01.077+0000","updated":"2009-06-02T19:33:01.077+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12715801","id":"12715801","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"uploading a new patch, which doesn't send end-of-block when closing (end-of-block was sent unnecessarily in the original code). also addressed Suresh's earlier comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-03T04:43:57.035+0000","updated":"2009-06-03T04:43:57.035+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12715985","id":"12715985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"trivial updates.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-03T17:01:36.339+0000","updated":"2009-06-03T17:01:36.339+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12715996","id":"12715996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 with all the tests passing","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-03T17:25:07.148+0000","updated":"2009-06-03T17:25:07.148+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12716086","id":"12716086","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"body":"my local hdfs unit tests passed. here is the test-patch result.\n{noformat}\n     [exec] -1 overall.  \n     [exec] \n     [exec]     +1 @author.  The patch does not contain any @author tags.\n     [exec] \n     [exec]     -1 tests included.  The patch doesn't appear to include any new or modified tests.\n     [exec]                         Please justify why no tests are needed for this patch.\n     [exec] \n     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.\n     [exec] \n     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n     [exec] \n     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n     [exec] \n     [exec]     +1 Eclipse classpath. The patch retains Eclipse classpath integrity.\n     [exec] \n     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n{noformat}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kzhang","name":"kzhang","key":"kzhang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kan Zhang","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-03T22:25:12.736+0000","updated":"2009-06-03T22:25:12.736+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12716271","id":"12716271","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12409796/5859-41.patch\n  against trunk revision 781683.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no tests are needed for this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n\n    +1 Eclipse classpath. The patch retains Eclipse classpath integrity.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    -1 contrib tests.  The patch failed contrib unit tests.\n\nTest results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/461/testReport/\nFindbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/461/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nCheckstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/461/artifact/trunk/build/test/checkstyle-errors.html\nConsole output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-vesta.apache.org/461/console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2009-06-04T13:16:35.251+0000","updated":"2009-06-04T13:16:35.251+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12716354","id":"12716354","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"body":"I have committed this.  Thanks, Kan!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=szetszwo","name":"szetszwo","key":"szetszwo","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=szetszwo&avatarId=23156","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=szetszwo&avatarId=23156","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=szetszwo&avatarId=23156","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=szetszwo&avatarId=23156"},"displayName":"Tsz Wo Nicholas Sze","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-06-04T18:15:10.211+0000","updated":"2009-06-04T18:15:10.211+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12888943","id":"12888943","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lukeforehand","name":"lukeforehand","key":"lukeforehand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Luke Forehand","active":true,"timeZone":"America/Chicago"},"body":"Is this patch applied to 0.20.1 by chance?  We are experiencing this issue with regularity on a 3 node cluster attempting to load 15GB of data.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lukeforehand","name":"lukeforehand","key":"lukeforehand","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Luke Forehand","active":true,"timeZone":"America/Chicago"},"created":"2010-07-15T22:19:52.170+0000","updated":"2010-07-15T22:19:52.170+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12888967","id":"12888967","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"body":"This patch is not applied to 0.20.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sureshms","name":"sureshms","key":"sureshms","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10450","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10450","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10450","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10450"},"displayName":"Suresh Srinivas","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-07-16T00:14:17.265+0000","updated":"2010-07-16T00:14:17.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12425640/comment/12892592","id":"12892592","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Note that this patch doesn't address the root issue in most cases (I've seen confusion from several users on this front).\n\nUsually the root issue here is that a thread gets stuck in processDatanodeError, particularly the RPC to the recovering DN. I've seen this in a number of situations, usually due to other IPC bugs that cause hung clients in various error scenarios, and sometimes due to bugs in recovery on the DN side.\n\nSo, if you see a stack trace that looks like this issue, it's probably a symptom of some other bug, and this patch would just rejigger the stack traces, but not actually solve the underlying problem.\n\nLuke: do you have the stack trace from the DataStreamer thread? Is it stuck in an IPC call? If so, do you have the jstack from the recovery datanode?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2010-07-27T01:15:35.450+0000","updated":"2010-07-27T01:15:35.450+0000"}],"maxResults":32,"total":32,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-5859/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0i2iv:"}}