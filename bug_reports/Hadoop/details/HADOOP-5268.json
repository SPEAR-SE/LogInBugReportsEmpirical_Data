{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12414895","self":"https://issues.apache.org/jira/rest/api/2/issue/12414895","key":"HADOOP-5268","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313473","id":"12313473","description":"","name":"0.19.1","archived":false,"released":true,"releaseDate":"2009-02-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-02-19T17:27:07.447+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Feb 25 15:00:14 UTC 2009","customfield_12310420":"78048","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_756517900_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-02-25T15:00:14.900+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-5268/watchers","watchCount":1,"isWatching":false},"created":"2009-02-16T20:51:37.679+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313211","id":"12313211","description":"","name":"0.19.0","archived":false,"released":true,"releaseDate":"2008-11-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:53:16.999+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Hi,\n\nI'm trying to save the sorting step by only runnign the map phase (setting the reducers to 0), but my job will fail then. \nThe job runs fine when the reduce phase is activated.\n\nI'm using MultipleInputFormat and MultipleOutputFormat. Here is my outputformat class, below is the exception. \n\n\npublic class MultipleSequenceFileOutputFormat<K extends WritableComparable, V extends Writable> extends MultipleOutputFormat<K, V> {\n\n   private SequenceFileOutputFormat<K, V> sequencefileoutputformat = null;\n   private String uniqueprefix = \"\";\n   private boolean set = false;\n   private static Random r = new Random();\n\n   @Override\n   protected RecordWriter<K, V> getBaseRecordWriter(FileSystem fs, JobConf job, String name, Progressable arg3) throws IOException {\n\tif (sequencefileoutputformat == null) {\n\t   sequencefileoutputformat = new SequenceFileOutputFormat<K, V>();\n\n\t}\n\n\treturn sequencefileoutputformat.getRecordWriter(fs, job, name, arg3);\n   }\n\n   @Override\n   protected String generateFileNameForKeyValue(K key, V value, String name) {\n\n\tif (!set) {\n\t   synchronized (r) {\n\t\tuniqueprefix = new Long(System.currentTimeMillis()).toString() + \"_\" + r.nextInt();\n\t\tset = true;\n\t   }\n\t}\n\n\treturn \"prefix.....\" + uniqueprefix + \"_\" + name;\n   }\n\n\n   @Override\n   public void checkOutputSpecs(FileSystem fs, JobConf conf) {\n   }\n\n\norg.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: failed to create file ......1234809836818_-1723031414_part-00000 for DFSClient_attempt_200902111714_0492_m_000000_0 on client 192.168.0.6 because current leaseholder is trying to recreate file.\n\tat org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInternal(FSNamesystem.java:1052)\n\tat org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFile(FSNamesystem.java:995)\n\tat org.apache.hadoop.hdfs.server.namenode.NameNode.create(NameNode.java:301)\n\tat sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.hadoop.ipc.RPC$Server.call(RPC.java:452)\n\tat org.apache.hadoop.ipc.Server$Handler.run(Server.java:892)\n\n\tat org.apache.hadoop.ipc.Client.call(Client.java:696)\n\tat org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:216)\n\tat $Proxy1.create(Unknown Source)\n\tat sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)\n\tat $Proxy1.create(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.(DFSClient.java:2587)\n\tat org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:454)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:169)\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:487)\n\tat org.apache.hadoop.io.SequenceFile$BlockCompressWriter.(SequenceFile.java:1198)\n\tat org.apache.hadoop.io.SequenceFile.createWriter(SequenceFile.java:401)\n\tat org.apache.hadoop.io.SequenceFile.createWriter(SequenceFile.java:354)\n\tat org.apache.hadoop.io.SequenceFile.createWriter(SequenceFile.java:427)\n\tat org.apache.hadoop.mapred.SequenceFileOutputFormat.getRecordWriter(SequenceFileOutputFormat.java:57)\n\tat MultipleSequenceFileOutputFormat.getBaseRecordWriter(MultipleSequenceFileOutputFormat.java:33)\n\tat org.apache.hadoop.mapred.lib.MultipleOutputFormat$1.write(MultipleOutputFormat.java:99)\n\tat org.apache.hadoop.mapred.MapTask$DirectMapOutputCollector.collect(MapTask.java:385)\n\tat ...\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"103808","customfield_12312823":null,"summary":"Using MultipleOutputFormat and setting reducers to 0 causes org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException and job to fail","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bluelu","name":"bluelu","key":"bluelu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thibaut","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bluelu","name":"bluelu","key":"bluelu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thibaut","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414895/comment/12675051","id":"12675051","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bmaurer","name":"bmaurer","key":"bmaurer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Maurer","active":true,"timeZone":"Etc/UTC"},"body":"FYI, I got the same error and it was fixed on the .19.1 release candidates","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bmaurer","name":"bmaurer","key":"bmaurer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Maurer","active":true,"timeZone":"Etc/UTC"},"created":"2009-02-19T17:27:07.447+0000","updated":"2009-02-19T17:27:07.447+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12414895/comment/12676673","id":"12676673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bluelu","name":"bluelu","key":"bluelu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thibaut","active":true,"timeZone":"Europe/Berlin"},"body":"0.19.1 fixes this issue","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bluelu","name":"bluelu","key":"bluelu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thibaut","active":true,"timeZone":"Europe/Berlin"},"created":"2009-02-25T15:00:14.533+0000","updated":"2009-02-25T15:00:14.533+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-5268/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0i4en:"}}