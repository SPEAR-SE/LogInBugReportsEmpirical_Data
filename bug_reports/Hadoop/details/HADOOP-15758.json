{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13185231","self":"https://issues.apache.org/jira/rest/api/2/issue/13185231","key":"HADOOP-15758","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2018-09-16T11:27:53.379+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Oct 05 19:44:35 UTC 2018","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1815721607_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2018-10-05T19:45:00.039+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15758/watchers","watchCount":9,"isWatching":false},"created":"2018-09-14T19:22:58.458+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327179","id":"12327179","description":"2.6.0 release","name":"2.6.0","archived":false,"released":true,"releaseDate":"2014-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12341431","id":"12341431","description":"3.0.0 GA release","name":"3.0.0","archived":false,"released":true,"releaseDate":"2017-12-13"}],"issuelinks":[{"id":"12543350","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12543350","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12952554","key":"HADOOP-12953","self":"https://issues.apache.org/jira/rest/api/2/issue/12952554","fields":{"summary":"New API for libhdfs to get FileSystem object as a proxy user","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/10002","description":"A patch for this issue has been uploaded to JIRA by a contributor.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/document.png","name":"Patch Available","id":"10002","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2018-10-05T19:45:00.062+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"A user reported that the Filesystem.get API is not working as expected when they use the 'FileSystem.get(URI, Configuration, user)' method signature - but 'FileSystem.get(URI, Configuration)' works fine. The user is trying to use this method signature to mimic proxy user functionality e.g. provide ticket cache based kerberos credentials (using KRB5CCNAME env variable) for the proxy user and then in the java program pass name of the user to be impersonated. The alternative, to use [proxy users functionality|https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/Superusers.html] in Hadoop works as expected.\r\n\r\n \r\n\r\nSince FileSystem.get(URI, Configuration, user) is a public API and it does not restrict its usage in this fashion, we should ideally make it work or add docs to discourage its usage to implement proxy users.\r\n\r\n ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12940039","id":"12940039","filename":"HADOOP-15758-001.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-17T18:07:39.568+0000","size":1262,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12940039/HADOOP-15758-001.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Filesystem.get(URI, Configuration, user) API not working with proxy users","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16615305","id":"16615305","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"body":"Here is a sample program to reproduce this issue: [https://gist.github.com/hgadre/38e1b625a6af70f1659fb19137a12ece]\r\n\r\nThe steps to reproduce are as follows\r\n * export KRB5CCNAME=/tmp/krb5cc_foo\r\n * export CLASSPATH=$CLASSPATH:$(hadoop classpath)\r\n * javac ReadWriteHDFSWithKinit.java\r\n * kinit -l 1m -kt hdfs.keytab [hdfs@ABC.COM|mailto:hdfs@ABC.COM] # kinit as a superuser (could be any user that has ability to proxy)\r\n * java ReadWriteHDFSWithKinit systest # note: access file as systest via the FileSystem.get(uri,conf,user) API\r\n\r\n \r\n\r\nThe last step fails with following exception,\r\n{noformat}\r\nWARN security.UserGroupInformation: PriviledgedActionException as:hdfs@ABC.COM (auth:KERBEROS) cause:javax.security.sasl.SaslException: GSS initiate failed [Caused by GSSException: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)]\r\n18/06/21 12:59:58 WARN ipc.Client: Exception encountered while connecting to the server : javax.security.sasl.SaslException: GSS initiate failed [Caused by GSSException: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)]\r\n18/06/21 12:59:58 WARN security.UserGroupInformation: PriviledgedActionException as:hdfs@ABC.COM (auth:KERBEROS) cause:java.io.IOException: javax.security.sasl.SaslException: GSS initiate failed [Caused by GSSException: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)]\r\n18/06/21 12:59:58 WARN hdfs.LeaseRenewer: Failed to renew lease for [DFSClient_NONMAPREDUCE_1855947848_1] for 30 seconds.  Will retry shortly ...\r\njava.io.IOException: Failed on local exception: java.io.IOException: javax.security.sasl.SaslException: GSS initiate failed [Caused by GSSException: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)]; Host Details : local host is: \"host-2.abc.com/10.15.13.17\"; destination host is: \"host-1.abc.com\":8020;{noformat}\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-14T19:45:49.845+0000","updated":"2018-09-14T19:50:27.607+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16616683","id":"16616683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"As usual, can you tag this with the ASF hadoop version affected. thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2018-09-16T11:27:53.379+0000","updated":"2018-09-16T11:27:53.379+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16616684","id":"16616684","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"body":"+ remove any references to your customer from that githib gist","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org","name":"stevel@apache.org","key":"stevel@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"},"displayName":"Steve Loughran","active":true,"timeZone":"Europe/London"},"created":"2018-09-16T11:29:27.852+0000","updated":"2018-09-16T11:29:27.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16617709","id":"16617709","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"I was asked to take a look and as best I can tell this is probably working as designed.  There is no mimic-ing of a proxy user.  Will confirm in a bit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2018-09-17T15:34:55.410+0000","updated":"2018-09-17T15:34:55.410+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16617935","id":"16617935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"body":"[~daryn] thanks for looking into this issue. I investigated this a little deeper and here is my understanding,\r\n * HADOOP-6769 added the FileSystem.get(URI, Configuration, user) API to support remote users. The idea was to have FileSystem implementation create a remote user if the user argument is non-null. In the user parameter is null, the logic was to use the currently logged in user. \r\n * At some later point HDFS-3568 added an ability to obtain UGI using the provided ticket cache file path. As part of this patch, a new method \"getBestUGI\" was introduced in UserGroupInformation class. This method handles three cases separately (a) if a ticket cache path is specified, it uses the credentials to prepare UGI and ignores user argument (b) if a ticket cache path is not specified and user name is provided, it creates a remote user and (c) if the ticket cache path and user name are not specified, it uses the currently logged in user.\r\n\r\nNow as I see it, HDFS-3568 introduced an additional possibility - application provide the user name as well as the ticket cache path. The question is should it treat this as a proxy user scenario? If this scenario is not valid, then we probably need to add documentation to discourage its use or even throw an error?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-17T18:06:47.304+0000","updated":"2018-09-17T18:06:47.304+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16617937","id":"16617937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"body":"I found that a only a small code change is required to support this proxy user scenario. Please find the attached patch. Please note that this is only for reference as I have not added any unit tests (just verified via manual testing) and hence not ready for commit.\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-17T18:07:51.156+0000","updated":"2018-09-17T18:07:51.156+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16617983","id":"16617983","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"body":"[~hgadre] {quote}(b) if a ticket cache path is not specified and user name is provided, it creates a remote user {quote}\r\n\r\nTicket cache must be verified prior to create a remote user.  Without a validate ticket, Java code should not have access to create a remote user.  Proxy user check must be in place on server side to prevent security hole.\r\n\r\n{quote}application provide the user name as well as the ticket cache path. The question is should it treat this as a proxy user scenario?{quote}\r\n\r\nThis seem like valid use case that spark and hive would depend on.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eyang","name":"eyang","key":"eyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eric Yang","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-17T18:41:57.678+0000","updated":"2018-09-17T18:41:57.678+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16618199","id":"16618199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"body":"HADOOP-12953 is to add proxy users support for FileSystem API. Linking it with this Jira since they are related.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-17T21:56:58.643+0000","updated":"2018-09-17T21:56:58.643+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16622393","id":"16622393","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"body":"So in summary we need to decide if (a) we want to update existing 'FileSystem.get(URI, Configuration, user)'  API to work for proxy users OR (b) implement a new FileSystem API as proposed in HADOOP-12953.\r\n\r\n[~daryn] [~stevel@apache.org] [~andrew.wang] any thoughts here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-09-20T17:38:01.064+0000","updated":"2018-09-20T17:38:01.064+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16629025","id":"16629025","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"{quote}Now as I see it, HDFS-3568 introduced an additional possibility - application provide the user name as well as the ticket cache path. The question is should it treat this as a proxy user scenario? If this scenario is not valid, then we probably need to add documentation to discourage its use or even throw an error?\r\n{quote}\r\nThis api absolutely must not create a proxy user. The api is \"I want to be this user from this ticket cache\". Nothing more than nothing less. There's a fundamental misunderstanding of proxy users I'll attempt to clarify.\r\n{quote}The user is trying to use this method signature to mimic proxy user functionality e.g. provide ticket cache based kerberos credentials\r\n{quote}\r\nYou cannot mimic a proxy user. A proxy user is specific construct. There is no substitute. A proxy user is a ugi that lacks its own authentication credentials, thus it explicitly encapsulates a \"real\" ugi that does contain kerberos credentials. The real ugi's user must be specifically configured on the target service to allow impersonation of the proxied user.\r\n\r\nThere is no correlation between a proxy user and a ticket cache. The real ugi can supply ticket cache or keytab based credentials. All that matters is the real user has credentials.\r\n{quote}The alternative, to use [proxy users functionality|https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/Superusers.html] in Hadoop works as expected.\r\n{quote}\r\nIt's not an alternative, it's the only option if you need impersonation.\r\n\r\nAdditionally, any impersonating service should never ever be ticket cache based.  Use a keytab.  Otherwise you may be very surprised with proxy user service morphs into a different user if/when someone/something does a kinit as a different user.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2018-09-26T16:34:10.702+0000","updated":"2018-09-26T16:34:10.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13185231/comment/16640270","id":"16640270","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"body":"[~daryn] thanks for the detailed response. I am closing this Jira as \"Not a bug\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hgadre","name":"hgadre","key":"hgadre","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hrishikesh Gadre","active":true,"timeZone":"America/Los_Angeles"},"created":"2018-10-05T19:44:35.575+0000","updated":"2018-10-05T19:44:35.575+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-15758/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i3y44f:"}}