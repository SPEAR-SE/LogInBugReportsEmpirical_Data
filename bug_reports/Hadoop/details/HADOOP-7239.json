{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12504993","self":"https://issues.apache.org/jira/rest/api/2/issue/12504993","key":"HADOOP-7239","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2011-04-22T18:07:17.051+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jun 27 18:05:00 UTC 2013","customfield_12310420":"77518","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-7239/watchers","watchCount":4,"isWatching":false},"created":"2011-04-22T18:00:29.951+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314203","id":"12314203","description":"","name":"0.20.2","archived":false,"released":true,"releaseDate":"2010-02-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313563","id":"12313563","description":"","name":"0.21.0","archived":false,"released":true,"releaseDate":"2010-08-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-27T18:05:00.207+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310711","id":"12310711","name":"conf","description":"Hadoop configuration mechanism."}],"timeoriginalestimate":null,"description":"We have a case where we wanted to create the Job names dynamically at run time.Since JobConf is an extension for the Configuration object, we thought we can make use of the variable substitution concept in configuration like below\n\nJob job = new Job(conf, \"${mapred.user.name}\" + \"-job\" + new Random().nextInt()); \njob.setJarByClass(WordCount.class); \njob.setMapperClass(TokenizerMapper.class); \njob.setCombinerClass(IntSumReducer.class); \njob.setReducerClass(IntSumReducer.class); \njob.setOutputKeyClass(Text.class); \njob.setOutputValueClass(IntWritable.class); \nFileInputFormat.addInputPath(job, new Path(otherArgs[0])); \nFileOutputFormat.setOutputPath(job, new Path(otherArgs[1])); \njob.submit(); \n\n\nWe set the required run time variables(in this case mapred.user.name) before calling the job submit. But on the Job tracker side the variables are not replaced correctly.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"102681","customfield_12312823":null,"summary":"The variables in the configuration files are not replaced with values, when the job is submitted by Job client","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=venug","name":"venug","key":"venug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Venu Gopala Rao","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=venug","name":"venug","key":"venug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Venu Gopala Rao","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux + Sun JDK 1.6","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504993/comment/13023309","id":"13023309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"Is there some documentation that suggests this would be possible? This is not a bug in my opinion.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-04-22T18:07:17.051+0000","updated":"2011-04-22T18:07:17.051+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504993/comment/13023313","id":"13023313","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=venug","name":"venug","key":"venug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Venu Gopala Rao","active":true,"timeZone":"Etc/UTC"},"body":"I looked at code for the root cause. It is as follows\n\nWhile writing the job.xml, it is using the Configuration.writeXML(), which is as follows\n\n{code:title=Configuration.java|borderStyle=solid}\nProperties properties = getProps();\n    try {\n     ......\n\n      for (Enumeration e = properties.keys(); e.hasMoreElements();) {\n        String name = (String)e.nextElement();\n        Object object = properties.get(name);\n        String value = null;\n        if (object instanceof String) {\n          value = (String) object;\n        }else {\n          continue;\n        }\n{code} \n\nSo here all properties in configuration are retrieved using getProps() which returns a ConcurrentHashMap and written to XML from that. So the variables are not substituted. instead of using *properties.get(name);*\nin above snippet we should use *get(name)*, so that all variable substitution happen correctly.\n\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=venug","name":"venug","key":"venug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Venu Gopala Rao","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-22T18:12:33.695+0000","updated":"2011-04-22T18:12:33.695+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504993/comment/13023316","id":"13023316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=venug","name":"venug","key":"venug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Venu Gopala Rao","active":true,"timeZone":"Etc/UTC"},"body":"Hi Todd,\n\nBut the point here is, after creating the Job in my client application\n\n{noformat} Job job = new Job(conf, \"${mapred.user.name}\" + \"-job\" + new Random().nextInt());{noformat} \n\nIf I call job.getJobName() it returns me correct name. But if we get the Job Profile from the Job Tracker  and check the name/ check the Job tracker UI, it contains the expression. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=venug","name":"venug","key":"venug","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Venu Gopala Rao","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-22T18:19:37.088+0000","updated":"2011-04-22T18:19:37.088+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12504993/comment/13694929","id":"13694929","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jtuchscherer","name":"jtuchscherer","key":"jtuchscherer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johannes","active":true,"timeZone":"America/Denver"},"body":"This seems to be an issue with the current version, too. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jtuchscherer","name":"jtuchscherer","key":"jtuchscherer","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Johannes","active":true,"timeZone":"America/Denver"},"created":"2013-06-27T18:05:00.207+0000","updated":"2013-06-27T18:05:00.207+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-7239/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0hxg7:"}}