{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12344627","self":"https://issues.apache.org/jira/rest/api/2/issue/12344627","key":"HADOOP-309","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312257","id":"12312257","description":"","name":"0.11.0","archived":false,"released":true,"releaseDate":"2007-02-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2006-06-20T11:30:54.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Feb 02 21:06:47 UTC 2007","customfield_12310420":"80782","customfield_12312320":null,"customfield_12310222":"10002_*:*_2_*:*_154235599_*|*_1_*:*_2_*:*_19507133071_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_22592736","customfield_12312321":null,"resolutiondate":"2007-02-02T21:06:47.670+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-309/watchers","watchCount":0,"isWatching":false},"created":"2006-06-20T07:37:19.000+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312258","id":"12312258","description":"","name":"0.10.1","archived":false,"released":true,"releaseDate":"2007-01-10"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navychen","name":"navychen","key":"navychen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"navychen","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-08T16:51:50.247+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The NullPointerException happens in the constructor of StatusHttpServer because the System property \"hadoop.log.dir\" is undefined.\nI see it trying to start the Namenode directly without using any scripts.\n\nException in thread \"main\" java.lang.NullPointerException\n\tat org.mortbay.util.Resource.newResource(Resource.java:99)\n\tat org.mortbay.http.ResourceCache.setResourceBase(ResourceCache.java:140)\n\tat org.mortbay.http.HttpContext.setResourceBase(HttpContext.java:2207)\n\tat org.apache.hadoop.mapred.StatusHttpServer.<init>(StatusHttpServer.java:66)\n\tat org.apache.hadoop.dfs.FSNamesystem.<init>(FSNamesystem.java:172)\n\tat org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:97)\n\tat org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:88)\n\tat org.apache.hadoop.dfs.NameNode.main(NameNode.java:496)\n\nIn general I think the sources should not rely on the system properties and environment variables defined in hadoop scripts.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12350096","id":"12350096","filename":"309.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navychen","name":"navychen","key":"navychen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"navychen","active":true,"timeZone":"Etc/UTC"},"created":"2007-02-01T02:16:06.943+0000","size":1507,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12350096/309.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"107181","customfield_12312823":null,"summary":"NullPointerException in StatusHttpServer","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344627/comment/12416831","id":"12416831","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"body":"Even if I get through this I get yet another NullPointerException.\nNow because webapps resource is not defined.\n\nException in thread \"main\" java.lang.NullPointerException\n\tat org.apache.hadoop.mapred.StatusHttpServer.getWebAppsPath(StatusHttpServer.java:108)\n\tat org.apache.hadoop.mapred.StatusHttpServer.<init>(StatusHttpServer.java:71)\n\tat org.apache.hadoop.dfs.FSNamesystem.<init>(FSNamesystem.java:172)\n\tat org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:97)\n\tat org.apache.hadoop.dfs.NameNode.<init>(NameNode.java:88)\n\tat org.apache.hadoop.dfs.NameNode.main(NameNode.java:496)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shv","name":"shv","key":"shv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Konstantin Shvachko","active":true,"timeZone":"America/Los_Angeles"},"created":"2006-06-20T08:38:05.000+0000","updated":"2006-06-20T08:38:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344627/comment/12416846","id":"12416846","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"body":"As we discussed offline, this is just caused because you didn't define a value for \"hadoop.log.dir\" on your java command line. It would be good to have the server not crash when the property is not defined, but the property should be defined for the servers. The two obvious \"fixes\" are to:\n  1. Remove the \"/logs\" context when no \"hadoop.log.dir\" property is defined. This will be confusing to users.\n  2. See if we can get the value from log4j via the jakarta commons logging api. It looks like there might be routines that will work.\n\nIn any case, I believe this is a pretty low priority bug.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"created":"2006-06-20T11:30:54.000+0000","updated":"2006-06-20T11:30:54.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344627/comment/12416851","id":"12416851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"body":"These were the exact same problems I encountered when I ran the unit tests. I had to define hadoop.log.dir (in the build.xml file) and had to put the \"build\" directory (which contains the webapps) in the CLASSPATH.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj","name":"devaraj","key":"devaraj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj Das","active":true,"timeZone":"Pacific/Pitcairn"},"created":"2006-06-20T13:00:52.000+0000","updated":"2006-06-20T13:00:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344627/comment/12466637","id":"12466637","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navychen","name":"navychen","key":"navychen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"navychen","active":true,"timeZone":"Etc/UTC"},"body":"here is my solution, does it okay for this bug?\n\n> 1. Remove the \"/logs\" context when no \"hadoop.log.dir\" property is defined.\n\nI changed StatusHttpServer.java at line 73-79\n     73     // set up the context for \"/logs/\"\n     74     HttpContext logContext = new HttpContext();\n     75     logContext.setContextPath(\"/logs/*\");\n     76     String logDir = System.getProperty(\"hadoop.log.dir\");\n     77     logContext.setResourceBase(logDir);\n     78     logContext.addHandler(new ResourceHandler());\n     79     webServer.addContext(logContext);\nto\n     73     // set up the context for \"/logs/\" if \"hadoop.log.dir\" property is defined.\n     74     String logDir = System.getProperty(\"hadoop.log.dir\");\n     75     if( logDir != null ) {\n     76       HttpContext logContext = new HttpContext();\n     77       logContext.setContextPath(\"/logs/*\");\n     78       logContext.setResourceBase(logDir);\n     79       logContext.addHandler(new ResourceHandler());\n     80       webServer.addContext(logContext);\n     81     }\n\nAnd it works okay, but there has a little impact that user cannot visit \"/logs/\" at web UI.\n\n\n> 2. See if we can get the value from log4j via the jakarta commons logging api. It looks like there might be routines that will work.\n\nI does not find a api to get these value at Jakarta commons logging api documents:\nhttp://jakarta.apache.org/commons/logging/apidocs/index.html \nI am puzzle that how to do this, because log4j.properties is read by log4j lib automatically,\nFor hadoop framework, it don't know or should don't know what log library it use, so is it not good to\nGet value from log4j?\n\n\n> Konstantin: \n1, Even if I get through this I get yet another NullPointerException.Now because webapps resource is not defined.\n\nThis is because he did not add base directory of hadoop that contains \"webapp\" directory into CLASSPATH, \nI insert two lines to StatusHttpServer.java to throw \"not found webapps\" exception to user, Is this a good way to fix it?\n    154   private static String getWebAppsPath() throws IOException {\n    155     URL url = StatusHttpServer.class.getClassLoader().getResource(\"webapps\");\n    156     if( url == null )\n    157       throw new IOException(\"webapps not found in CLASSPATH\");\n    158     String path = url.getPath();\n\nif webapps resource is not defined, It seems that could not set a default value for it or return null, \nbecause webAppContext member of StatusHttpServer should be initialized with webapps resource path for many functions need to access it, \nso maybe throw a intelligible exception to user is a better way.\n\n> 2, trying to start the Namenode directly without using any scripts.\n\nTo resolve this problem and let user can start NameNode without any scripts, \ncan run as these steps in hadoop base directory:\n1, export CLASSPATH=$CLASSPATH:./build/:./build/classes/:./:./conf/\n2, export CLASSPATH=$CLASSPATH:`ls lib/*.jar | cat | tr '\\n' :`\n3, export CLASSPATH=$CLASSPATH:`ls lib/jetty-ext/*.jar | cat | tr '\\n' :`\n4, java org.apache.hadoop.dfs.NameNode\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navychen","name":"navychen","key":"navychen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"navychen","active":true,"timeZone":"Etc/UTC"},"created":"2007-01-23T03:37:25.731+0000","updated":"2007-01-23T03:37:25.731+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344627/comment/12469308","id":"12469308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navychen","name":"navychen","key":"navychen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"navychen","active":true,"timeZone":"Etc/UTC"},"body":"this patch will fix the follow bugs: \n1, The NullPointerException happens in the constructor of StatusHttpServer because the System property \"hadoop.log.dir\" is undefined. \n   - to fix this, remove the \"/logs\" context when no \"hadoop.log.dir\" property is defined. \n2, Even if I get through this I get yet another NullPointerException. Now because webapps resource is not defined. \n  - to fix this, just throw a \"not found webapps\" IOException to client ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=navychen","name":"navychen","key":"navychen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"navychen","active":true,"timeZone":"Etc/UTC"},"created":"2007-02-01T02:25:57.732+0000","updated":"2007-02-01T02:25:57.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344627/comment/12469869","id":"12469869","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"body":"I just committed this.  Thanks, navychen!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cutting","name":"cutting","key":"cutting","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Doug Cutting","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-02-02T21:06:47.657+0000","updated":"2007-02-02T21:06:47.657+0000"}],"maxResults":6,"total":6,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-309/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0ip87:"}}