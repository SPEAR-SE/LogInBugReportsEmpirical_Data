{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12514763","self":"https://issues.apache.org/jira/rest/api/2/issue/12514763","key":"HADOOP-7478","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310240","id":"12310240","key":"HADOOP","name":"Hadoop Common","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310240&avatarId=10095","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310240&avatarId=10095","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310240&avatarId=10095","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310240&avatarId=10095"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2011-07-20T11:42:22.528+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sun Jul 14 12:45:32 UTC 2013","customfield_12310420":"205","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_62645060765_*|*_1_*:*_1_*:*_8846630_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-07-14T12:45:32.854+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-7478/watchers","watchCount":7,"isWatching":false},"created":"2011-07-20T08:53:45.505+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/5","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/trivial.svg","name":"Trivial","id":"5"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315569","id":"12315569","description":"","name":"0.23.0","archived":false,"released":true,"releaseDate":"2011-11-11"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-07-14T12:45:32.897+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310689","id":"12310689","name":"fs","description":"Generic FileSystem code"}],"timeoriginalestimate":null,"description":"The process of putting file into dfs is approximately as follows:\n1) create a file in the dfs\n2) copy from one stream to the file\nBut the problem is that the file is still retained in the dfs when the process 2) is terminated abnormally with unexpected exceptions,such as there is no DataNode alive.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12487140","id":"12487140","filename":"HADOOP-7478.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-20T11:20:47.942+0000","size":1047,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12487140/HADOOP-7478.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"102482","customfield_12312823":null,"summary":"0-byte files retained in the dfs while the FSshell -put is unsuccessful","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13068284","id":"13068284","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"body":"Fix it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-20T11:21:12.127+0000","updated":"2011-07-20T11:21:12.127+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13068293","id":"13068293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12487140/HADOOP-7478.patch\n  against trunk revision 1147971.\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    +1 javadoc.  The javadoc tool did not generate any warning messages.\n\n    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n\n    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.\n\n    +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n\n    +1 core tests.  The patch passed core unit tests.\n\n    +1 system test framework.  The patch passed system test framework compile.\n\nTest results: https://builds.apache.org/job/PreCommit-HADOOP-Build/753//testReport/\nFindbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/753//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\nConsole output: https://builds.apache.org/job/PreCommit-HADOOP-Build/753//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-20T11:42:22.528+0000","updated":"2011-07-20T11:42:22.528+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13068628","id":"13068628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"It doesn't seem like FileUtil#copy should always delete the destination if there's an IOE doing the copy. For example, what if there's an error reading the source, overwrite is true, and the dest exists. We will have removed the dest but not necessarily replaced it with a new file, ie copy(x, y) should never result in y not existing right?  Please add tests that cover the current behavior (what happens when there's an IOE during copy) so we can see how the tests modify the behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-07-20T20:52:18.200+0000","updated":"2011-07-20T20:52:18.200+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13069595","id":"13069595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"I'm a bit uneasy about this change.  It feels like a lower level issue.  What's a real use case that causes the problem?  Is it something like the source file can't be opened due to permission issues?  If so, then the more appropriate change would be to open the source before opening the dest.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2011-07-22T16:05:56.261+0000","updated":"2011-07-22T16:05:56.261+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13069812","id":"13069812","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"body":"The change is definitely not good to go (see my last comment). However I think the jira itself (not polluting the fs with 0 byte files when a put fails) is totally reasonable.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eli","name":"eli","key":"eli","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Eli Collins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-07-22T22:26:32.993+0000","updated":"2011-07-22T22:26:32.993+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13070797","id":"13070797","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"body":"In trunk we have o.a.h.fs.Options.Rename.OVERWRITE. We could modify fs -put to write to a .tmp file in the same directory, then rename with OVERWRITE to the final destination.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tlipcon","name":"tlipcon","key":"tlipcon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tlipcon&avatarId=26804","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tlipcon&avatarId=26804","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tlipcon&avatarId=26804","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tlipcon&avatarId=26804"},"displayName":"Todd Lipcon","active":true,"timeZone":"America/Tijuana"},"created":"2011-07-25T21:45:23.500+0000","updated":"2011-07-25T21:45:23.500+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13070821","id":"13070821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"Wouldn't that possibly lead to false quota issues?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2011-07-25T22:21:22.096+0000","updated":"2011-07-25T22:21:22.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13070919","id":"13070919","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"body":"Thanks a lot for your comments,@Daryn & @Eli & @Todd.\nTo Daryn:\n   Reproduction steps:\n   1)start DFS.\n   2)kill all the datanodes. \n   3)put files into DFS.\n     # ls /work/xg1\n     -rw-r--r-- 1 root root 363 Jul 19 15:49 /work/xg1\n     # hadoop dfs -put /work/xg1 /user/hadoop/\n   4)# hadoop dfs -ls /user/hadoop\n       Found 2 items\n       -rw-r--r--   1 root supergroup         32 2011-07-26 10:05 /user/hadoop/xg\n       -rw-r--r--   1 root supergroup          0 2011-07-26 10:05 /user/hadoop/xg1\n\nTo Todd:\n   Thanks for your suggestion,but i think the problem will still exists while there`s an exception during putting file to the .tmp file.\n\nTo Eli:\n   Before copying bytes really,the function checkDest() will check the problems such as \"target already exists\" and \"target is a dir\". And i think it is necessary to delete the dest file while there`s an error reading the src,because it is easy to mislead users if 0-byte file retained.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-26T03:30:08.309+0000","updated":"2011-07-26T03:30:08.309+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13071138","id":"13071138","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"Is the -put not generating an exception?  That implies that whatever is opening the src is not throwing an exception, which leads to the dest being opened & truncated.  The problem might be solved if the dst is never opened when the src fails to open.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2011-07-26T14:56:23.176+0000","updated":"2011-07-26T14:56:23.176+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13071491","id":"13071491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"body":"The exception is as follows(and i think it wasn't caused by opening src file but making the DataNode's block):\n\n[root@localhost logs]# hadoop dfs -put /work/xg1 /user/hadoop\n11/07/26 10:05:19 INFO hdfs.DFSClient: Exception in createBlockOutputStream java.net.ConnectException: Connection refused\n11/07/26 10:05:19 INFO hdfs.DFSClient: Abandoning block blk_7177429611982124425_1004\n11/07/26 10:05:25 INFO hdfs.DFSClient: Exception in createBlockOutputStream java.net.ConnectException: Connection refused\n11/07/26 10:05:25 INFO hdfs.DFSClient: Abandoning block blk_9193825693957629504_1004\n11/07/26 10:05:31 INFO hdfs.DFSClient: Exception in createBlockOutputStream java.net.ConnectException: Connection refused\n11/07/26 10:05:31 INFO hdfs.DFSClient: Abandoning block blk_-7406363576735183504_1004\n11/07/26 10:05:37 INFO hdfs.DFSClient: Exception in createBlockOutputStream java.net.ConnectException: Connection refused\n11/07/26 10:05:37 INFO hdfs.DFSClient: Abandoning block blk_1387010999141076236_1004\n11/07/26 10:05:43 WARN hdfs.DFSClient: DataStreamer Exception: java.io.IOException: Unable to create new block.\n        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.nextBlockOutputStream(DFSClient.java:2845)\n        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.access$2000(DFSClient.java:2102)\n        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream$DataStreamer.run(DFSClient.java:2288)\n\n11/07/26 10:05:43 WARN hdfs.DFSClient: Error Recovery for block blk_1387010999141076236_1004 bad datanode[0] nodes == null\n11/07/26 10:05:43 WARN hdfs.DFSClient: Could not get block locations. Source file \"/user/hadoop/xg1\" - Aborting...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=xiexianshan","name":"xiexianshan","key":"xiexianshan","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"XieXianshan","active":true,"timeZone":"Etc/UTC"},"created":"2011-07-27T02:24:28.709+0000","updated":"2011-07-27T02:24:28.709+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13071753","id":"13071753","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"body":"Interesting.  Is the -put command returning non-0 to indicate failure?  I doubt it is since it's not generating an error message of its own...  Ex. {{put: /work/xg1: something}}.  That would be another bug in and of itself.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=daryn","name":"daryn","key":"daryn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daryn Sharp","active":true,"timeZone":"America/Chicago"},"created":"2011-07-27T14:16:11.702+0000","updated":"2011-07-27T14:16:11.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13178298","id":"13178298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"Exec'ing {{fs -put}} should return back a proper code in trunk, I think, given Daryn's work on the whole revamp.\n\nI'd argue that this behavior is OK, since it indicates that the file's inode was successfully created, but none of the writing of bytes passed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-01-02T06:23:25.996+0000","updated":"2012-01-02T06:23:25.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514763/comment/13708012","id":"13708012","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"No longer an issue on trunk after the shell changes.\n\n{code}\n$ hadoop fs -put /etc/foo foo\n…\n13/07/14 05:40:44 ERROR hdfs.DFSClient: Failed to close file /user/test/foo._COPYING_\norg.apache.hadoop.ipc.RemoteException(java.io.IOException): File /user/test/foo._COPYING_ could only be replicated to 0 nodes instead of minReplication (=1).  There are 2 datanode(s) running and 2 node(s) are excluded in this operation.\n…\n$ hadoop fs -ls /user/test/foo._COPYING_\nls: `/user/test/foo._COPYING_': No such file or directory\n$ hadoop fs -ls /user/test/foo\nls: `/user/test/foo': No such file or directory\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-07-14T12:45:32.873+0000","updated":"2013-07-14T12:45:32.873+0000"}],"maxResults":13,"total":13,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/HADOOP-7478/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0hw7z:"}}