[I agree that this should not fail.  Can you please modify one of the mini-mr unit tests to test for this case and submit that as a patch?, ok, here is a testcase (in a separate class). Indeed I tried to include it in TestMiniMRWithDFS class, but tests freezed at some point, don't know exactly why., here is a patch which fixes this issue. I don't have enough knowledge of the whole Hadoop codebase to determine if this is the best place/way to fix this problem, but it works., sorry, the patch was badly generated, this one seems better., +1 this patch looks fine.

We could move the new code and the code that corrects the number of map tasks above sorting the splits, but it isn't a big deal since sorting an empty array is pretty fast. *smile*, I just committed this.  Thanks Frédéric!]