[Note that FsShell does compare filesystems by URI, Depending on FileSystem equality is a bug.  Even though FileSystem instances are cached, it is still possible to have different instances that refer to the same files if different user credentials are used to create them.  Equality of FileSystem.getUri() should be more reliable, but is still not perfect, as foo://joe@bar.com/ and bar://bob@1.2.3.4/ could refer to the same files, since foo and bar could be different protocols to access the same data, and bar.com's address could be 1.2.3.4., well, some of the FileUtil and FsShell operations do equality tests either on instance (very bad) or uri. If we need a robust way to distinguish filesystems *and URI is inadequate*, then the only alternative would be for the far end to provide some unique ID. This could be a persistent ID of the FS itself, or it could be something created whenenver a name node or other filesystem comes up., Comparing URIs for equality is certainly better than comparing FileSystem instances, but I'm not convinced this is in general a solvalble problem: we won't ever be able to guarantee that two URIs don't refer to the same file.  An FTP server could refer to the same file as an HTTP server, etc.

I would support switching things from FileSystem instance equality to URI equality as an improvement, but I don't think it is worth our while to invest in a more elaborate equality mechanism.]