[presumably this is a reference to apache commons-lang.

2.6 is the last "legacy" release; there is now a commons-lang 3 release. This does look more modern, but an upgrade seems traumatic as [it requires every import to be changed|http://commons.apache.org/proper/commons-lang/article3_0.html].

There's benefits in doing this from the project's improvements, but there's 100+ imports that would need changing. That's a significant enough change that it would have to go into trunk and then be backported to branch-2 when people were happy. We'd also have to think about retaining the -2.6 jar on our classpath for the entirety of the hadoop 2.x lifetime to avoid breaking downstream projects that depend on it.

If you can supply a patch for trunk we to do this we can review it

(As you are clearly trying to get Hadoop working on BSD, you should switch to trunk because that is where fixes will go in. Consider also writing an Uber-JIRA "get Hadoop working on BSD" to which you can make these sub tasks or dependencies. Please also put "FreeBSD" in the environment field"), Well, I am not much familiar with maven build system (this change will require to update some maven stuff too?).
I can generate diff for Java files if you want (though I doubt it will be of much help because it is trivial addition of "3":
lang->lang3).

Of course I understand that it should go to trunk first.
At least this will mean that this change will *ever* appear in stable version., I am attaching a patch for this update., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12655528/commons-lang3.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 30 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:red}-1 javadoc{color}.  The javadoc tool appears to have generated 3 warning messages.
        See https://builds.apache.org/job/PreCommit-HADOOP-Build/4264//artifact/trunk/patchprocess/diffJavadocWarnings.txt for details.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:red}-1 findbugs{color}.  The patch appears to cause Findbugs (version 2.0.3) to fail.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-minikdc hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient hadoop-tools/hadoop-gridmix hadoop-tools/hadoop-rumen hadoop-tools/hadoop-streaming hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager:

                  org.apache.hadoop.fs.TestSymlinkLocalFSFileContext
                  org.apache.hadoop.ipc.TestIPC
                  org.apache.hadoop.fs.TestSymlinkLocalFSFileSystem
                  org.apache.hadoop.streaming.TestMultipleArchiveFiles
                  org.apache.hadoop.streaming.TestStreamingBadRecords
                  org.apache.hadoop.streaming.TestStreamingOutputKeyValueTypes
                  org.apache.hadoop.streaming.TestStreamAggregate
                  org.apache.hadoop.streaming.TestStreamReduceNone
                  org.apache.hadoop.streaming.TestUnconsumedInput
                  org.apache.hadoop.streaming.mapreduce.TestStreamXmlRecordReader
                  org.apache.hadoop.streaming.TestGzipInput
                  org.apache.hadoop.streaming.TestStreaming
                  org.apache.hadoop.streaming.TestStreamingFailure
                  org.apache.hadoop.streaming.TestStreamingSeparator
                  org.apache.hadoop.streaming.TestStreamingCounters
                  org.apache.hadoop.streaming.TestFileArgs
                  org.apache.hadoop.streaming.TestStreamDataProtocol
                  org.apache.hadoop.streaming.TestStreamingExitStatus
                  org.apache.hadoop.streaming.TestSymLink
                  org.apache.hadoop.streaming.TestRawBytesStreaming
                  org.apache.hadoop.streaming.TestStreamingCombiner
                  org.apache.hadoop.streaming.TestStreamingStderr
                  org.apache.hadoop.streaming.TestTypedBytesStreaming
                  org.apache.hadoop.streaming.TestStreamingBackground
                  org.apache.hadoop.streaming.TestStreamXmlRecordReader
                  org.apache.hadoop.streaming.TestStreamingKeyValue
                  org.apache.hadoop.streaming.TestStreamXmlMultipleRecords
                  org.apache.hadoop.streaming.TestMultipleCachefiles
                  org.apache.hadoop.streaming.TestStreamingOutputOnlyKeys
                  org.apache.hadoop.yarn.applications.distributedshell.TestDistributedShell
                  org.apache.hadoop.yarn.util.TestFSDownload
                  org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairScheduler

                                      The test build failed in hadoop-tools/hadoop-rumen hadoop-tools/hadoop-gridmix hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app 

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HADOOP-Build/4264//testReport/
Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/4264//console

This message is automatically generated., I am attaching another patch (trying to solve problems found by Jenkins), {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12656057/commons-lang3_1.patch
  against trunk revision .

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 31 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:red}-1 findbugs{color}.  The patch appears to cause Findbugs (version 2.0.3) to fail.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

    {color:red}-1 core tests{color}.  The patch failed these unit tests in hadoop-common-project/hadoop-auth hadoop-common-project/hadoop-common hadoop-common-project/hadoop-minikdc hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient hadoop-tools/hadoop-gridmix hadoop-tools/hadoop-rumen hadoop-tools/hadoop-streaming hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager:

                  org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl
                  org.apache.hadoop.fs.TestSymlinkLocalFSFileContext
                  org.apache.hadoop.ipc.TestIPC
                  org.apache.hadoop.fs.TestSymlinkLocalFSFileSystem
                  org.apache.hadoop.streaming.TestMultipleArchiveFiles
                  org.apache.hadoop.streaming.TestStreamingBadRecords
                  org.apache.hadoop.streaming.TestStreamingOutputKeyValueTypes
                  org.apache.hadoop.streaming.TestStreamAggregate
                  org.apache.hadoop.streaming.TestStreamReduceNone
                  org.apache.hadoop.streaming.TestUnconsumedInput
                  org.apache.hadoop.streaming.mapreduce.TestStreamXmlRecordReader
                  org.apache.hadoop.streaming.TestGzipInput
                  org.apache.hadoop.streaming.TestStreaming
                  org.apache.hadoop.streaming.TestStreamingFailure
                  org.apache.hadoop.streaming.TestStreamingSeparator
                  org.apache.hadoop.streaming.TestStreamingCounters
                  org.apache.hadoop.streaming.TestFileArgs
                  org.apache.hadoop.streaming.TestStreamDataProtocol
                  org.apache.hadoop.streaming.TestStreamingExitStatus
                  org.apache.hadoop.streaming.TestSymLink
                  org.apache.hadoop.streaming.TestRawBytesStreaming
                  org.apache.hadoop.streaming.TestStreamingCombiner
                  org.apache.hadoop.streaming.TestStreamingStderr
                  org.apache.hadoop.streaming.TestTypedBytesStreaming
                  org.apache.hadoop.streaming.TestStreamingBackground
                  org.apache.hadoop.streaming.TestStreamXmlRecordReader
                  org.apache.hadoop.streaming.TestStreamingKeyValue
                  org.apache.hadoop.streaming.TestStreamXmlMultipleRecords
                  org.apache.hadoop.streaming.TestMultipleCachefiles
                  org.apache.hadoop.streaming.TestStreamingOutputOnlyKeys
                  org.apache.hadoop.yarn.util.TestFSDownload
                  org.apache.hadoop.yarn.server.resourcemanager.TestClientRMService
                  org.apache.hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesApps
                  org.apache.hadoop.yarn.server.resourcemanager.TestRMRestart
                  org.apache.hadoop.yarn.server.resourcemanager.TestApplicationACLs
                  org.apache.hadoop.yarn.server.resourcemanager.TestRM
                  org.apache.hadoop.hdfs.tools.TestDFSAdminWithHA
                  org.apache.hadoop.hdfs.server.namenode.ha.TestPipelinesFailover

                                      The test build failed in hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell hadoop-tools/hadoop-rumen hadoop-tools/hadoop-gridmix hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app 

    {color:green}+1 contrib tests{color}.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HADOOP-Build/4292//testReport/
Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/4292//console

This message is automatically generated., BTH, I don't understand what to do now:
If I run those test which fail at jenkins, they work on my Ubuntu 12.04 box.

If I run all tests at this machine, I get several other tests failing (should all 100% tests pass or there are some known broken ones? I see bug reports which state some tests do not work for others too).

So I am stuck with this change., Instead of outright replacing lang2, can we add lang3 too?, {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12656057/commons-lang3_1.patch
  against trunk revision b3d8a64.

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/4946//console

This message is automatically generated., Cancelling patch, as it no longer applies., Hi [~stevel@apache.org] and [~trtrmitya], how is this issue going on? Now commons-lang3 is used in Apache Hadoop, so migrating to commons-lang3 seems easier than before., I've forgotten about this completely. Go for it, Thanks for working on this, all. I'd like to assign this jira to myself and take over your work., Thanks Takanobu!, Uploaded the 2nd patch. It completely upgrades commons-lang from 2 to 3.

{noformat}
find . -name "*.java" | xargs grep "commons.lang" | grep -v lang3 | wc -l
       0
{noformat}, Somehow Jenkins didn't work fine the last time.

I rebased a patch for trunk., There is a new import of commons-lang-2.6 that I didn't remove it in the 3rd patch. Uploaded the 4th patch addressing it., This is the build result with the latest patch. I don't know why it isn't reported here.
[https://builds.apache.org/job/PreCommit-HADOOP-Build/14623/]

Some of the failed tests seem to be related to commons-lang3. I will investigate it further., There is a bug of WordUtils in commos-lang3 and that is the cause of some of the failed tests., Uploaded the 5th patch addressing the failed tests. Some comments for modified class:
 * TableListing
 {{commons.lang3.text.WordUtils}} has a bug when {{wrapWidth}} is Integer.MAX_VAL. (See: LANG-1397) The patch use a workaround to use a large enough value instead of Integer.MAX_VAL.

 * ResourceUtils
 {{StringUtils.isAlpha}} breaks compatibility for emptye string. The patch handle it.
{code:java}
 org.apache.commons.lang.StringUtils.isAlpha("") // true
 org.apache.commons.lang3.StringUtils.isAlpha("") // false
{code}, The build aborted due to out of heap memory.
https://builds.apache.org/job/PreCommit-HADOOP-Build/14647/console, Rerun Jenkins., In most cases, I just modified package names of import statements. Some methods need to be renamed.

The biggest change is that Range classes have become a generic class. For other exceptions, I menthoned in the previous comment.

I've confirmed that "mvn clean package -Pdist,native -Dtar -DskipTests" succeeds with the latest patch. Please review it when you have time. Thanks., The build failed due to out of heap memory again... Would somebody please advise me about it?, HADOOP-10783.6.patch: rebased, Thanks [~tasanuma0829] for the work!

It looks precommit job timed out. https://builds.apache.org/job/PreCommit-HADOOP-Build/14670/console
Would you split this issue into modules (HDFS, MAPREDUCE, YARN, Common) to reduce the time to run precommit job?, [~ajisakaa] Thanks for the comments! I will create the JIRAs soon., I created HADOOP-15495, HDFS-13621, MAPREDUCE-7098 and YARN-8363 as the separated tasks., Thanks!, I also createdÂ HDDS-157 for hadoop-ozone and hadoop-hdds., All the subtasks were fixed. Closing this.
Thanks again [~tasanuma0829] for the work., Thanks for reviews and commits, [~ajisakaa] and [~anu]! Thanks for the early work, [~trtrmitya] and [~stevel@apache.org]!]