[The problem is because of calling recoverJobHistoryFile() from logSubmitted() for user log file with wrong filename(It was not considering the case of earlier call to recoverJobHistoryFile()).
Attaching patch with the fix. Please review and provide your comments., Ravi, HADOOP-5328 also does something similar. Can you plz check it and see if that solves the issue?, Yes Amar. That patch solves this issue too., Hey Ravi, HADOOP-5394 plans to remove JobHistory.Keys.RESTART_COUNT. Can you plz find out the impact of that on TestJobHistory?, TestJobHistory allows START_TIME=0 for tasks which are started before JT restart if the history file has the key RESTART_COUNT. We need to modify that logic if we are planning to remove the key RESTART_COUNT from history file., Resolving this issue as the patch of 5328 solves this issue too and it got committed., Reopening to make this a duplicate of 5328 as the patch of 5328 solves this issue too., Resolving this as duplicate of 5328 as the patch of 5328 solves this issue too.]