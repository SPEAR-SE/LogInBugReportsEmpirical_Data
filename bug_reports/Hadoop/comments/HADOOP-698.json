[Patch attached. It also include two unit tests., +1, http://issues.apache.org/jira/secure/attachment/12345881/datanode-exclude.patch applied and successfully tested against trunk revision 479931, I just committed this.  Thanks, Milind!]