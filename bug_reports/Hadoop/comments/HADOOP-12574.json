[This is already fixed in trunk as part of HADOOP-9902.  In addition to the problems noted above, there are also the re-eval HADOOP_OPTS problem which ultimately makes this impossible to fix in branch-2 without breaking compatibility., Ah alright, sorry for the re-posting of this!, No worries. There's no doubt the scripts in branch-2 are ... ugly.  ;)

, Resolving as duplicate of HADOOP-9902.]