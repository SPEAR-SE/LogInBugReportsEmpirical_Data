[Patch Attached. , +1, because http://issues.apache.org/jira/secure/attachment/12347309/Hadoop-596.patch applied and successfully tested against trunk revision r486901., I just committed this.  Thanks, Sanjay!]