[We don't do anything thread-local that could cause this. My guess is you're forgetting to close your files. If you can show a simple standalone reproducing program, we can take a look. Otherwise I'm inclined to mark "cannot reproduce", Can you fill in the "Affects Version/s"?  This could be HDFS-799, which was fixed in branch-2 and later but never backported.

Also, can you please explain how you are "monitoring the memory status" (besides noticing the out of memory exceptions).  Thanks., Thanks for your replies. I use top command to monitor the memory status when the program is running. We find the "VIRT" increases every time a new thread opens a file and never decreases. So we finally solve this problem by using thread-pool. Maybe the version used in our team is obsolete. It is my fault, sorry. , Hi dingyichuan,

What version of Hadoop are you using?, Hi, Colin Patrick McCabe 
Actually, I have no idea of the version info. Our team began to use the lib several years ago and have patched to the lib many times. I am new to this group, so... sorry :P]