[Test case:
Let CustomWritableA and CustomWritableB be 2 custom implementations of Writable.
1. (Acting as a producer of data) Create a MapWritable. Add an instance of CustomWritableA as a key or a value. Write the MapWritable to a data stream.
2. Create another MapWritable. Add an instance of CustomWritableB. Write the MapWritable to the same data stream.
3. (As a consumer of the data stream) Create a separate MapWritable instance and read from the data stream. The instance is correctly populated with CustomWritableA.
4. Now, attempt to reuse the MapWritable instance and read again from the data stream. The instance should be populated with CustomWritableB, but the actual result is an IllegalArgumentException: "Id 1 exists but maps to CustomWritableA and not CustomWritableB". , Proposed patch attached and ready for review. It adds cleanup of the classToIdMap/idToClassMap data structures in AbstractMapWritable.readFields, and a new unit test in TestMapWritable. The initialization of the classToIdMap/idToClassMap maps in AbstractMapWritable was extracted to a separate method, addDefaultsToMap., Hey there, Eli Acherkan.
Your issue is a duplicate from https://issues.apache.org/jira/browse/HADOOP-9295
The author there had the same problem and proposed a similar solution, maybe you can help there., Thanks [~ViniciusMSAna], it definitely looks like the same issue. I'd love to help there (and I think the patch I attached should solve the problem), but I'm a bit unfamiliar with the process - could you tell me what should I do?.. The last comment on that issue says "Marking it "Unassgined" in case someone else wants to take a stab it. Will reclaim if it is still open by the time I get to it.", The user responsible for that issue seems to be inactive, maybe you could contact [~davidparks21] since he was the reporter.

Since you said your patch should fix the problem, you could try contributing following this guide: https://wiki.apache.org/hadoop/HowToContribute]