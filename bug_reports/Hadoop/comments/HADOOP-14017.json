[Both {{setfacl}} and {{getfacl}} are supported.

One issue: names shown as GUID
{noformat}
$ hdfs dfs -Ddfs.adls.oauth2.access.token.provider.type='ClientCredential' ... -getfacl adl://account.azuredatalakestore.net/file
# file: adl://account.azuredatalakestore.net/file
# owner: aaaaaaaa-bbbb-1234-5678-cccccccccccc
# group: dddddddd-bbbb-3a53-f678-ccccc3cc2ccc
user::rw-
group::r--
other::r--
{noformat}

Another issue: names must be GUID to setfacl
{noformat}
hdfs dfs -Ddfs.adls.oauth2.access.token.provider.type='ClientCredential' -Dhadoop.security.credential.provider.path=localjceks://file/tmp/creds.jceks -setfacl -m user:foo:rw- adl://account.azuredatalakestore.net/file
setfacl: Invalid named user or group in <aclStr> : user:foo:rw-. The allowed names are must be a GUID. [a3aa9a0a-0bbb-12f4-5678-cccccccccccc][2017-01-22T11:02:01.2277079-08:00]
{noformat}, Thanks [~jzhuge], This is a known [limitation |https://hadoop.apache.org/docs/current/hadoop-azure-datalake/index.html] and provokes user to configure ACL from [Azure portal|https://ms.portal.azure.com] till the functionality for {{setfacl}} and {{getfacl}} is available.
{quote}
User and group information returned as ListStatus and GetFileStatus is in form of GUID associated in Azure Active Directory.
{quote}

However we are already working (Under testing) on supporting user friendly name as a configurable option instead of GUID associated with Azure Active Directory., Thanks [~vishwajeet.dusane] for the info., Closing this bug since this is known issue and relative change would be available as feature in separate JIRA., IMHO it is still not ideal to display AAD user friendly name. I am looking for an integration with Hadoop users and groups., Support for AAD user friendly name would be required to {{setfacl}} or {{getfacl}} but not enough for integration with Hadoop U/G. Would you like to file specific JIRA for integration with Hadoop users and groups?, Could we make it possible to display either GUID or user-friendly name? My use case is {{-ls -i}} to be introduced by HDFS-10233., Based on the discussion on the same thread with [~jzhuge]. Reopening this issue instead of creating new feature request.

ADLS to support configuration toggle between OID and UPN (User friendly name)., Added configuration support to return user/group as user friendly name or unique identifier from Azure AD profile (Object ID as GUID)., | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 14s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 1 new or modified test files. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 12m 19s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 15s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 12s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 16s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 12s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 21s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 11s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 12s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 12s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 12s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m  9s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m  9s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 24s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  9s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  3m 27s{color} | {color:green} hadoop-azure-datalake in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 16s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 20m 30s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:a9ad5d6 |
| JIRA Issue | HADOOP-14017 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12852823/HADOOP-14017.01.patch |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |
| uname | Linux 3d58c9a901d1 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / 859bd15 |
| Default Java | 1.8.0_121 |
| findbugs | v3.0.0 |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11631/testReport/ |
| modules | C: hadoop-tools/hadoop-azure-datalake U: hadoop-tools/hadoop-azure-datalake |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11631/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, Thanks [~vishwajeet.dusane] for working on the issue. I will take a look and try it.

The patch only support {{ls}} and {{getfacl}}, do you plan to add support for {{chown}} and {{setfacl}}?, {quote}
The patch only support ls and getfacl, do you plan to add support for chown and setfacl?
{quote}
That will be nice to have, though I expect extra work as ADLS sdk is not supporting directly this I guess?, {{chown}} and {{setfacl}} accepts user and group name as set in Azure AD tenant when run against ADLS {{FileSystem}}. The change was required in ADLS store back-end and is available in prod environment now.
, Thank you [~vishwajeet.dusane] for adding this very nice feature. Tested {{-ls}} and {{-getfacl}}. Also verified {{-chown}} with user name.

+1 (non-binding) with minor nitpicks below:

AdlConfKeys
- #90: Could we add suffix “_KEY” to the key name? Also add a constant ADL_ENABLEUPN_FOR_OWNERGROUP_DEFAULT, default to false

AdlFileSystem
- #188: Use ADL_ENABLEUPN_FOR_OWNERGROUP_DEFAULT instead of the literal “false”
- #189: Add a space after “if”
- #451: line wrap
- #762: line wrap after the “=“ on the previous line
- #977: remove the extra space after “void”

TestMetadata
- #21: Unused import org.apache.hadoop.conf.Configuration
- #26: Unused import org.apache.hadoop.fs.adl.AdlConfKeys

index.md
- #225: new line before
- #243: new line after
, Does {{chown}} and {{setfacl}} accept both UPN and OID?, - Incorporated comments from [~jzhuge]. 
- Updated index.md on recommendation to keep {{adl.feature.ownerandgroup.enableupn}} as false to avoid performance overhead.
- Added configuration test to validate {{adl.feature.ownerandgroup.enableupn}} configuration and default value.
, Thanks [~jzhuge] for the review. Incorporated your comments in patch 02., | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 13s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 11m 23s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 12s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m  9s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 14s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  1m  3s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 19s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  9s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 11s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 10s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 10s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m  7s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 11s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m  8s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 23s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m  7s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  3m 28s{color} | {color:green} hadoop-azure-datalake in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 16s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 19m 54s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:a9ad5d6 |
| JIRA Issue | HADOOP-14017 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12853668/HADOOP-14017.02.patch |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |
| uname | Linux 0533ac079c13 4.4.0-43-generic #63-Ubuntu SMP Wed Oct 12 13:48:03 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / 6ba61d2 |
| Default Java | 1.8.0_121 |
| findbugs | v3.0.0 |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11668/testReport/ |
| modules | C: hadoop-tools/hadoop-azure-datalake U: hadoop-tools/hadoop-azure-datalake |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11668/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, [~jzhuge] - {{chown}} and {{setfacl}} accept both UPN and OID., +1.  Rev 02 Looks great! Very few minor nitpicks:

AdlConfKeys
- #92: line wrap after “=“ ? This way, the entire string value is on 1 line.

AdlFileSystem
- #190-192, #88: Consider “oidOrUpn = enableUPN ? UserGroupRepresentation.UPN : UserGroupRepresentation.OID;” and remove the initializer at #88. What do you think?

index.md
- #238-240:
    - Document the default value is false for the sake of performance
    - Mention that setOwner/setAcl accept both UPN and OID
    - Lower case getFileStatus/listStatus/getAclStatus

BTW, how much is the performance impact when UPN is on?
, Thanks for the comment [~jzhuge].

1.
{quote}
#190-192, #88: Consider “oidOrUpn = enableUPN ? UserGroupRepresentation.UPN : UserGroupRepresentation.OID;” and remove the initializer at #88. What do you think?
{quote}

Are you suggesting? 

{code}
private UserGroupRepresentation oidOrUpn;
...
oidOrUpn = enableUPN ? UserGroupRepresentation.UPN : UserGroupRepresentation.OID;
{code}

instead of 
{code}
private UserGroupRepresentation oidOrUpn = UserGroupRepresentation.OID;
...
if (enableUPN) {
   oidOrUpn = UserGroupRepresentation.UPN;
}
{code}

2. 
{quote}
Document the default value is false for the sake of performance
{quote}
Documentation is already there in patch 02 as 

{noformat}
            When false (default) : User and Group in FileStatus/AclStatus
            response is represented by the unique identifier from Azure AD
            profile (Object ID as GUID).

            For performance optimization, Recommended default value.
{noformat}

Please let me know if you had different suggestion? 

3. 
{quote}
Mention that setOwner/setAcl accept both UPN and OID
{quote}

Good point. Will mention in the {{Features}} section.

4. Performance impact depends upon the number of unique user from the retrieved list and if explicit look up is required with Azure AD for name resolution., 1. Yes
2. It is ok. Sorry I missed it., Minor changes - Incorporated comments from [~jzhuge], | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 20s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} test4tests {color} | {color:green}  0m  0s{color} | {color:green} The patch appears to include 2 new or modified test files. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 14m 45s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 18s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 14s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 19s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 15s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 26s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 14s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  0m 16s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} compile {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javac {color} | {color:green}  0m 14s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} checkstyle {color} | {color:green}  0m 10s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 16s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} mvneclipse {color} | {color:green}  0m 11s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} findbugs {color} | {color:green}  0m 32s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} javadoc {color} | {color:green}  0m 11s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  3m 35s{color} | {color:green} hadoop-azure-datalake in the patch passed. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 19s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 24m  3s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:a9ad5d6 |
| JIRA Issue | HADOOP-14017 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12853785/HADOOP-14017.03.patch |
| Optional Tests |  asflicense  compile  javac  javadoc  mvninstall  mvnsite  unit  findbugs  checkstyle  |
| uname | Linux 1eefe95159d5 3.13.0-106-generic #153-Ubuntu SMP Tue Dec 6 15:44:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / 4804050 |
| Default Java | 1.8.0_121 |
| findbugs | v3.0.0 |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/11677/testReport/ |
| modules | C: hadoop-tools/hadoop-azure-datalake U: hadoop-tools/hadoop-azure-datalake |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11677/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, +1  Rev 03 LGTM, +1 Will commit shortly., I have committed to {{trunk}} branch. Thanks [~vishwajeet.dusane] for your contribution; thanks [~jzhuge] for your helpful review and comments!, SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #11284 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/11284/])
HADOOP-14017. User friendly name for ADLS user and group. Contributed by (liuml07: rev 924def78544a64449785f305cb6984c3559aea4d)
* (edit) hadoop-tools/hadoop-azure-datalake/src/main/java/org/apache/hadoop/fs/adl/AdlConfKeys.java
* (edit) hadoop-tools/hadoop-azure-datalake/src/main/java/org/apache/hadoop/fs/adl/AdlFileSystem.java
* (edit) hadoop-tools/hadoop-azure-datalake/src/site/markdown/index.md
* (edit) hadoop-tools/hadoop-azure-datalake/src/test/java/org/apache/hadoop/fs/adl/TestValidateConfiguration.java
* (edit) hadoop-tools/hadoop-azure-datalake/src/test/java/org/apache/hadoop/fs/adl/live/TestMetadata.java
, Thank you [~liuml07] and [~jzhuge].]