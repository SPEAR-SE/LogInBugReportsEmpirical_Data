[Sorry attached a wrong version the first time., I just committed this.  Thanks, Konstantin!]