[- Added ability to expand sum(table) macro into SQL statement.
- Change SQL statement to calculate rate for individual datanode, then aggregate the cluster throughput from datanode rates., Hdfs throughput data calculation should process data for one extra time window in case the dfs datanode metrics arrives late., Added extra time window to dfs throughput aggregation., I don't feel qualified to review this; my SQL experience is quite limited. 
Is there a way to reduce the line lengths in aggregator.sql?, Every iine in the file is a SQL query.  There is no way to reduce the line length for now., +1
If the goal is to extend the macro language it may be good to look at a template engine like Velocity for example., Integrated in Hadoop-trunk #778 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/778/])
    ]