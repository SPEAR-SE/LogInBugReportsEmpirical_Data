[Sample backtrace from a pig job:

{noformat}
org.apache.pig.backend.executionengine.ExecException: ERROR 2118: Wrong FS:
har://hdfs-x:x/x.har/x,
expected: hdfs://x:x
        at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigInputFormat.getSplits(PigInputFormat.java:288)
        at org.apache.hadoop.mapreduce.JobSubmitter.writeNewSplits(JobSubmitter.java:473)
        at org.apache.hadoop.mapreduce.JobSubmitter.writeSplits(JobSubmitter.java:490)
        at org.apache.hadoop.mapreduce.JobSubmitter.submitJobInternal(JobSubmitter.java:385)
        at org.apache.hadoop.mapreduce.Job$11.run(Job.java:1218)
        at org.apache.hadoop.mapreduce.Job$11.run(Job.java:1215)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:415)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1264)
        at org.apache.hadoop.mapreduce.Job.submit(Job.java:1215)
        at org.apache.hadoop.mapreduce.lib.jobcontrol.ControlledJob.submit(ControlledJob.java:336)
        at org.apache.hadoop.mapreduce.lib.jobcontrol.JobControl.run(JobControl.java:231)
        at java.lang.Thread.run(Thread.java:722)
        at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher$1.run(MapReduceLauncher.java:260)
Caused by: java.lang.IllegalArgumentException: Wrong FS:
har://hdfs-x:x/x.har/x,
expected: hdfs://x:x
        at org.apache.hadoop.fs.FileSystem.checkPath(FileSystem.java:582)
        at org.apache.hadoop.hdfs.DistributedFileSystem.getPathName(DistributedFileSystem.java:155)
        at org.apache.hadoop.hdfs.DistributedFileSystem.access$000(DistributedFileSystem.java:76)
        at org.apache.hadoop.hdfs.DistributedFileSystem$1.<init>(DistributedFileSystem.java:416)
        at org.apache.hadoop.hdfs.DistributedFileSystem.listLocatedStatus(DistributedFileSystem.java:409)
        at org.apache.hadoop.fs.FileSystem.listLocatedStatus(FileSystem.java:1654)
        at org.apache.hadoop.fs.FilterFileSystem.listLocatedStatus(FilterFileSystem.java:208)
        at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.listStatus(FileInputFormat.java:259)
        at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigTextInputFormat.listStatus(PigTextInputFormat.java:36)
        at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.getSplits(FileInputFormat.java:335)
        at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigInputFormat.getSplits(PigInputFormat.java:274)
        ... 13 more
{noformat}, HADOOP-10003's final patch tries to address larger issues with HarFileSystem beyond the listLocatedStatus issue and has followup JIRAs to fix the fixes.  Since this is a blocker for 0.23, I'm localizing this fix to just the listLocatedStatus issue.  That ends up essentially being the original fix for HADOOP-100091 proposed by [~jdere] ported to branch-0.23.

Patch contains binaries and needs to be applied via "git apply".  Patch has been manually tested.  Note that since this is a patch for branch-0.23, Jenkins is not going to like this patch one bit., {color:red}-1 overall{color}.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12613252/HADOOP-10091.branch-0.23.patch
  against trunk revision .

    {color:red}-1 patch{color}.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/3274//console

This message is automatically generated., +1 Looks good., Thanks for the review, Daryn, and thanks to [~jdere] for the original patch!  I committed this to branch-0.23., FAILURE: Integrated in Hadoop-Hdfs-0.23-Build #790 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/790/])
HADOOP-10091. Job with a har archive as input fails on 0.23. Contributed by Jason Dere and Jason Lowe (jlowe: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1541758)
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/pom.xml
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileSystem.java
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HarFileSystem.java
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestHarFileSystemBasics.java
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/resources/test.har
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/resources/test.har/.part-0.crc
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/resources/test.har/_SUCCESS
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/resources/test.har/_index
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/resources/test.har/_masterindex
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/test/resources/test.har/part-0
]