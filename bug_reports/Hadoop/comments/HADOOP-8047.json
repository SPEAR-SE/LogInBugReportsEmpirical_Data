[This is actually a general problem if the cache is in a persistent daemon like the namenode.  Transient DNS problems can cause false entries in the negative cache., you can set the JVM up not to cache -ve DNS entries; it used to do it forever (bad, bad sun), but this is a separate issue.

what the switch mapping is doing is caching the mapping to a specific switch, so if the topology script is updated as new machines are added, if somehow those new machines report in before the script is updated, the default rack settings get cached.

for extra fun, every switch mapping is wrapped by a (completely gratuitious) cache. I say gratuitous as the script mapper does its own caching, and other implementations are likely to be more dynamic (will need to check with people who have written their own mapper, obviously). Because of that wrapping, no dynamic topology scripts will ever have their changes picked up]