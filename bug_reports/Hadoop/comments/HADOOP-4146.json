[This is the patch intended for check-in.
I've done with the changes of hive/metastore and hive/ql. But that is going through code review right now and will come in a separate jira issue.

, Fixed as part of JIRA-4230]