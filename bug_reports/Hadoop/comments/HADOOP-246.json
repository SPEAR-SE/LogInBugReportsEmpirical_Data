[It would also be nice if the namespaces weren't closed off just to be opened again...

} // end namespace org
} // end namespace apache
} // end namespace hadoop
} // end namespace record
} // end namespace test
namespace org {
namespace apache {
namespace hadoop {
namespace record {
namespace test {
, I have attached a patch to hadoop-245 that includes a fix for this bug as well. Repeated opening and closing of namespaces does not cause any runtime inefficiency. (and probably very small compile-time inefficiency.) However it makes the code generator hairier than it needs to be. That is why I open and close namespaces for each record independently., Fix is part of patch in HADOOP-245]