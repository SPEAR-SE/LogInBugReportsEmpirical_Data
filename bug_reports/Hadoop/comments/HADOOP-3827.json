[I've tested that the above fix works, I'll upload the patch with a test case., Straight-forward fix, along with a test case., +1 (not committing it as hudson hasn't run it yet)., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12386848/HADOOP-3827_0_20080724.patch
  against trunk revision 679743.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2950/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2950/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2950/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2950/console

This message is automatically generated., Here are the output and error logs for the maps and reduces which can result from this bug
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
Logs of the output from killed map - "m_005937_0"  with zero input and output bytes to hdfs
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
attempt_200807242354_0001_m_005937_0: No outputs to promote from hdfs://ymachine.mydomain.com/myhome/dir/_temporary/_attempt_200807242354_0001_m_005937_0
2008-07-25 00:05:55,986 INFO org.apache.hadoop.mapred.TaskRunner: Task 'attempt_200807242354_0001_m_005937_0' done.
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
Error on map-side
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
Too many fetch-failures
Too many fetch-failures
Too many fetch-failures

--------------------------------------------------------------------------------------------------------------------------------------------------------------------
Logs of the output from killed reduce "attempt_200807242354_0001_r_000001_0 " as a result of  - map "m_005937_0"  providing zero output bytes to the reducers
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
2008-07-25 00:06:00,618 INFO org.apache.hadoop.mapred.ReduceTask: Shuffling 2 bytes (2 raw bytes) into RAM from attempt_200807242354_0001_m_005937_0
2008-07-25 00:06:00,618 INFO org.apache.hadoop.mapred.ReduceTask: Read 0 bytes from map-output for attempt_200807242354_0001_m_005937_0
2008-07-25 00:06:00,618 WARN org.apache.hadoop.mapred.ReduceTask: attempt_200807242354_0001_r_000001_0 copy failed: attempt_200807242354_0001_m_005937_0 from mymachine.mydomain.com
2008-07-25 00:06:00,618 WARN org.apache.hadoop.mapred.ReduceTask: java.io.IOException: Incomplete map output received for attempt_200807242354_0001_m_005937_0 from http://mymachine.mydomain.com:55279/mapOutput?job=job_200807242354_0001&map=attempt_200807242354_0001_m_005937_0&reduce=1 (0 instead of 2)
	at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.shuffleInMemory(ReduceTask.java:1248)
	at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.getMapOutput(ReduceTask.java:1093)
	at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.copyOutput(ReduceTask.java:983)
	at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.run(ReduceTask.java:932)
........
........
2008-07-25 00:06:37,696 INFO org.apache.hadoop.mapred.ReduceTask: Failed to fetch map-output from attempt_200807242354_0001_m_005937_0 even after MAX_FETCH_RETRIES_PER_MAP retries...  reporting to the JobTracker
--------------------------------------------------------------------------------------------------------------------------------------------------------------------, The test failure in TestCopyFiles is unrelated - I've checked that it works locally., I just committed this., Integrated in Hadoop-trunk #581 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/581/])]