[when the datanode restarts, remove all blocks from the tmp directory of the datanode. However, fsync does not throw an exception., Dhruba, we should also remove the unit tests that test the tmp directory does not get removed after restarting the cluster.  , The two junit tests that would fail with this patch are TestFileCreationDelete and TestRenameWhileOpen., Thanks Hairong.

The updated patch disables the test Hairong mentioned with a very explicit comment that it is a temporary change and it has the original patch Dhruba attached.
 , Hi Hairong, I saw ur comment just now about the unit tests. Thanks for fixing it., +1 on Raghu's patch. It is critical for 0.18., test-patch :
------------

     [exec] -1 overall.

     [exec]     +1 @author.  The patch does not contain any @author tags.

     [exec]     +1 tests included.  The patch appears to include 6 new or modified tests.

     [exec]     -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.

     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.

----------

JavaDoc failures are unrelated  to this patch (they are for "CyclicIterator.java").
, I just committed this to 0.18 only., Could you please file a bug against CyclicIterator.java, > Could you please file a bug against CyclicIterator.java 
done : HADOOP-5077.]