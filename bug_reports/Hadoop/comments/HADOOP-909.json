[After some further investigation, it turns out that the new FsShell does not handle the "du" command correctly. The size of a direcotry tree should be fetched using getContentLength not getLength., +1, because http://issues.apache.org/jira/secure/attachment/12349417/du.patch applied and successfully tested against trunk revision r498829., I think the default implementation in FileSystem#getContentLength should, when passed a directory, list it and recursively sum the contentLength of it's contents.  That way it will work correctly for LocalFileSystem, S3FileSystem, etc.  HDFS has an optimized implementation that sums server-side., The new patch reflects Doug's suggestion. Thank you, Doug., I just committed this.  Thanks, Hairong!]