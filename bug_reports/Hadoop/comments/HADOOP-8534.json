[Attaching a patch with the fix., +1. Would wrapping it in a BufferedInputStream help?, Thanks for reviewing Bikas!

bq. Would wrapping it in a BufferedInputStream help?
I assume you mean from the performance standpoint. I don't think there is a need for that given the scenario., Isnt it reading from a URL that could potentially be remote? I see that BufferedInputStream is used for the File input immediately following the URL input., bq. Isnt it reading from a URL that could potentially be remote? I see that BufferedInputStream is used for the File input immediately following the URL input.
Sorry, I am not following you, do you mind clarifying? In this case we are getting a resource from the classpath (for example {{hdfs-site.xml}})., I was just saying that the code doing the same thing in other places uses BufferedStreams. So there is a precedent for using it., I see, thanks! Attaching updated patch that addresses the comment., +1 Change looks good to me., Looks like the same fix was made for instance of String.
+1, Thanks Bikas and Chuan!

bq. Looks like the same fix was made for instance of String.
Right, I noticed that the above piece of code for {{URL}} had the same problem, so I fixed it. Re-run the commit & problematic tests to make sure the updated fix works fine., Committed to Hadoop-1 windows branch. Thanks Ivan.]