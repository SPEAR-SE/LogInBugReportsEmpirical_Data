[bq.  use the Path code:{code}
new Path(get("hadoop.log.dir", conf), get("hadoop.job.history.location"));
{code}
 This wouldnt work, because job history location need not be in hadoop.log.dir when it is on dfs. By default it will be on local fs and in 'hadoop.log.dir'. So, its location has to be specified as file:/// uri. 
I uploaded patch which fixes the case relative path in hadoop.log.dir at HADOOP-2871.  There the location is built as
{code}
        LOG_DIR = conf.get("hadoop.job.history.location" ,   "file:///" + new File ( System.getProperty("hadoop.log.dir")).getAbsolutePath() + File.separator + "history");
{code}

, Owen, Could you confirm whether the issue is fixed with the patch for HADOOP-2871?, Fixed as part of HADOOP-2871]