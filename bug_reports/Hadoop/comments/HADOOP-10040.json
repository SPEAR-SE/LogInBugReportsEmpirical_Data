[Hi, [~yingdachen].  I'm guessing that you had checked out the code from Subversion and not Git.  Can you please confirm?

We've set up line ending exceptions like this already for Git, covering *.bat, *.cmd, *.csproj, and *.sln.  This is specified in .gitattributes:

{code}
*.bat    text eol=crlf
*.cmd    text eol=crlf
*.csproj text merge=union eol=crlf
*.sln    text merge=union eol=crlf
{code}

This is working correctly for me on a checkout from git.  Here is a small partial hex dump of hadoop.cmd showing 0D 0A for line endings.

{code}
0000000: 4065 6368 6f20 6f66 660d 0a40 7265 6d20  @echo off..@rem 
0000010: 4c69 6365 6e73 6564 2074 6f20 7468 6520  Licensed to the 
0000020: 4170 6163 6865 2053 6f66 7477 6172 6520  Apache Software 
0000030: 466f 756e 6461 7469 6f6e 2028 4153 4629  Foundation (ASF)
0000040: 2075 6e64 6572 206f 6e65 206f 7220 6d6f   under one or mo
0000050: 7265 0d0a 4072 656d 2063 6f6e 7472 6962  re..@rem contrib
{code}

However, for my checkout of the Subversion repo, I see that I'm getting 0A for the line endings:

{code}
0000000: 4065 6368 6f20 6f66 660a 4072 656d 204c  @echo off.@rem L
0000010: 6963 656e 7365 6420 746f 2074 6865 2041  icensed to the A
0000020: 7061 6368 6520 536f 6674 7761 7265 2046  pache Software F
0000030: 6f75 6e64 6174 696f 6e20 2841 5346 2920  oundation (ASF) 
0000040: 756e 6465 7220 6f6e 6520 6f72 206d 6f72  under one or mor
0000050: 650a 4072 656d 2063 6f6e 7472 6962 7574  e.@rem contribut
{code}

I guess we'll need to apply these rules separately for the Subversion repo by running the appropriate svn propset svn:eol-style commands., yes. we see it on trunk checked out from svn, not git checek out.

, There isn't really a patch or a code review involved in fixing this.  Just to give everyone a heads-up though, I'm planning on running the following script in the Subversion repos for trunk, branch-2, and branch-2.2.  This will convert to CRLF line endings for Windows-related files.  I'll wait a few hours before doing this in case anyone has questions on the change.

{code}
for EXT in bat cmd vcxproj sln; do svn propset -R svn:eol-style CRLF *.$EXT; done
{code}
, I have applied the line ending changes in trunk, branch-2, and branch-2.2.  [~yingdachen], thank you for the bug report., SUCCESS: Integrated in Hadoop-trunk-Commit #4590 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/4590/])
HADOOP-10040. hadoop.cmd in UNIX format and would not run by default on Windows. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531491)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, thanks for the fast turn-around in fixing this., Woah, this completely mess up git.

Short answer: you should svn propset windows file as eol-style *native*

Long answer: in order for .gitattributes to work correctly with eol attributes, all text file with eol attributes are stored as with LF in the repository and converted to the value of eol upon checkout. This is not compatible with svn eol-style CRLF, which change the content in the repository as well. With svn eol-style native, an svn checkout will convert normalized text files (stored with LF) to CRLF.

I committed a workaround (to trunk and branch-2, so people can work with git) with .gitattributes for windows file as binary, so git won't touch them., SUCCESS: Integrated in Hadoop-Yarn-trunk #360 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/360/])
HADOOP-10040. hadoop.cmd in UNIX format and would not run by default on Windows. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531491)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, FAILURE: Integrated in Hadoop-Hdfs-trunk #1550 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1550/])
HADOOP-10040. hadoop.cmd in UNIX format and would not run by default on Windows. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531491)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #1576 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1576/])
HADOOP-10040. hadoop.cmd in UNIX format and would not run by default on Windows. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531491)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, Hi, [~vicaya].  Sorry to hear that this change caused trouble.

If I understand correctly, the right permanent fix that I need to do now is:

{code}
for EXT in bat cmd vcxproj sln; do svn propset -R svn:eol-style native *.$EXT; done
{code}

Then, I need to revert your workaround in .gitattributes so that git uses crlf instead of binary.  I'd be doing this on trunk and merging down to branch-2 and branch-2.2.

If this sounds right, can you give it a +1?  Thanks!, Why not just make the line end conversion a build time thing? This is precisely what Ant's {{<fixcrlf>}} task is for: to generate platform-specific executable scripts irrespective of the platform on which you are editing the code. No need to do things with svn -we can leave everything as unix and fix it package time, bq. Why not just make the line end conversion a build time thing?

I'd prefer to give Windows developers the right line endings for these files on checkout.  That way, they don't need to run a build or a manual unix2dos step while testing changes made in the scripts.

In fact, one could say that it's never valid for these files to have Unix line endings, because the files are only meaningful on Windows, which wants Windows line endings.  Even a developer editing the files on Unix and then copying them to a Windows VM ought to maintain CRLF.  It sounds like we can't fully guarantee this for an svn checkout due to the svn-git interaction that Luke pointed out.  We'll be guaranteeing it for a git checkout though, which is the more popular of the two., Small amendment to the command I intend to run:

{code}
for EXT in bat cmd vcxproj sln; do find . -name "*.$EXT" -exec svn propset svn:eol-style native {} \; ; done
{code}
, [~cnauroth]: You'll need to revert the change first before redo the propset, so that the repository contains normalized text. When you change .gitattributes, make sure it contains *.vcxproj, which was not there.

[~stevel@apache.org]: Build time fix is good idea, but orthogonal to the repository fix., SUCCESS: Integrated in Hadoop-trunk-Commit #4596 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/4596/])
HADOOP-10040. Revert svn propset for CRLF line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531977)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, SUCCESS: Integrated in Hadoop-trunk-Commit #4597 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/4597/])
HADOOP-10040. svn propset to native line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531983)
* /hadoop/common/trunk/.gitattributes
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, I have committed the changes described above.  I waited for the git sync and refreshed by git repos.  I don't see any problems.  I think this worked.

Luke, thanks again for help with this., SUCCESS: Integrated in Hadoop-trunk-Commit #4598 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/4598/])
HADOOP-10040. Correct merge error on native.vcxproj. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531994)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
, Chris, thanks for taking care of this!

Some notes for posterity: 

Due to the different ways subversion and git handle text EOLs. The build artifacts are currently VCS (version control system) dependent.

Currently if a release is built with git on either windows and \*nix platforms, the result will be correct (windows text (\*.cmd etc.) will have CRLF as EOL). If a release is built with subversion on *nix platforms, windows text will have LF as EOL.

This is not a major issue yet, as people typically build windows releases on windows boxes (required for windows native bits) and \*nix releases on corresponding machines., I just made one more commit related to this. It turns out that while correcting this I accidentally reverted one line from native.vcxproj to compile lz4hc.c.  This ultimately caused unresolved external symbol errors in the Windows native build.  I didn't catch it earlier, because I did my testing on branch-2.2, and lz4hc.c only exists on trunk and branch-2.  I re-committed the native.vcxproj change shown in HADOOP-9319 to trunk and branch-2.

Sorry if this caused churn for anyone., SUCCESS: Integrated in Hadoop-trunk-Commit #4604 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/4604/])
HADOOP-10040. Correct native.vcxproj for inclusion of lz4hc.c. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1532136)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
, SUCCESS: Integrated in Hadoop-Yarn-trunk #363 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/363/])
HADOOP-10040. Correct native.vcxproj for inclusion of lz4hc.c. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1532136)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
HADOOP-10040. Correct merge error on native.vcxproj. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531994)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
HADOOP-10040. svn propset to native line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531983)
* /hadoop/common/trunk/.gitattributes
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
HADOOP-10040. Revert svn propset for CRLF line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531977)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, FAILURE: Integrated in Hadoop-Hdfs-trunk #1553 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1553/])
HADOOP-10040. Correct native.vcxproj for inclusion of lz4hc.c. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1532136)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
HADOOP-10040. Correct merge error on native.vcxproj. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531994)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
HADOOP-10040. svn propset to native line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531983)
* /hadoop/common/trunk/.gitattributes
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
HADOOP-10040. Revert svn propset for CRLF line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531977)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #1579 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1579/])
HADOOP-10040. Correct native.vcxproj for inclusion of lz4hc.c. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1532136)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
HADOOP-10040. Correct merge error on native.vcxproj. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531994)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
HADOOP-10040. svn propset to native line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531983)
* /hadoop/common/trunk/.gitattributes
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
HADOOP-10040. Revert svn propset for CRLF line endings on Windows files. Contributed by Chris Nauroth. (cnauroth: http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1531977)
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop-config.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/hadoop.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/start-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/bin/stop-all.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/conf/hadoop-env.cmd
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/native/native.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/libwinutils.vcxproj
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.sln
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/winutils/winutils.vcxproj
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs-config.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/hdfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/start-dfs.cmd
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/src/main/bin/stop-dfs.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred-config.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/bin/mapred.cmd
* /hadoop/common/trunk/hadoop-mapreduce-project/conf/mapred-env.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/cat.cmd
* /hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/test/bin/xargs_cat.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/start-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/stop-yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn-config.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/bin/yarn.cmd
* /hadoop/common/trunk/hadoop-yarn-project/hadoop-yarn/conf/yarn-env.cmd
]