[This patch fixed the following 5 kinds of bugs reported by FindBugs
1. Dead store to local variable
2. Complicated, subtle or wrong increment in for-loop
3. Result of integer multiplication cast to long
4. Possible null pointer dereference due to return value of called method
5. Computation of average could overflow
6. Exception is caught when Exception is not thrown, +1. Regd #6, may be you could call the new function handleException instead of handleError., The new patch incorporates Raghu's suggestion., -1, build or testing failed

2 attempts failed to build and test the latest attachment http://issues.apache.org/jira/secure/attachment/12358491/dodgy.patch against trunk revision r542595.

Test results:   http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/214/testReport/
Console output: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/214/console

Please note that this message is automatically generated and may represent a problem with the automation system and not the patch., +1

http://issues.apache.org/jira/secure/attachment/12358562/dodgy.patch applied and successfully tested against trunk revision r542595.

Test results:   http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/217/testReport/
Console output: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/217/console, I just committed this.  Thanks, Hairong!, Integrated in Hadoop-Nightly #119 (See [http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/119/])]