[Here is a patch that fixes the problem. I use a flag to mark that the fault was on the input and therefore the map output should be declared lost. I'm not really that happy with all of the catches that rethrow, but I didn't see a more straightforward way of getting the right effect., Half the number of try/catch blocks would be required if you instead wrapped the outStream operations and use a badOutput boolean, no?, Ok, as suggested by Doug, I inverted the check and wrapped the socket.write call with a specialized check. Thanks!, I just committed this.  Thanks, Owen.]