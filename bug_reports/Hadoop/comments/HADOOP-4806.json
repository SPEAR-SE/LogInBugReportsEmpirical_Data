[In LeaseManager.changeLease(...), the variable overwrite is not a regular expression pattern but is used as a regular expression pattern in
{code}
      final String newpath = oldpath.replaceFirst(overwrite, replaceBy);
{code}

, 4806_20081208.patch: fixed string replacement bug., S3FileSystem.renameRecursive(...) also has this problem., 4806_20081208_0.18.patch: for 0.18 (added TestRenameWhileOpen), Could we Pattern#quote "overwrite"? I just want to be safe..., 4806_20081209.patch: using Pattern.quote(..)., 4806_20081209_0.18.patch: for 0.18, +1, {noformat}
     [exec] +1 overall.  

     [exec]     +1 @author.  The patch does not contain any @author tags.

     [exec]     +1 tests included.  The patch appears to include 3 new or modified tests.

     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.

     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.

     [exec]     +1 Eclipse classpath. The patch retains Eclipse classpath integrity.
{noformat}
Running tests locally., Only org.apache.hadoop.chukwa.datacollection.adaptor.filetailer.TestStartAtOffset failed and it is not related to this patch., 4806_20081209_0.18.patch: the previous file was wrong.  Should be this one., I just committed this., Integrated in Hadoop-trunk #685 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/685/])
    . HDFS rename should not use src path as a regular expression. (szetszwo)
, It turned out that the first patch is safer.  See HADOOP-6017.]