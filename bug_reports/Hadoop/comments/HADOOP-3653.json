[:-$ Please excuse me. Your very detailed bug report allowed me to write a fix. Thanks !

I tested it by creating a fake ${SUPPORT_DIR} of which I copied the content into the project, so I hope it is right. But calling it from Hudson would be the best way to test it., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12384817/fixHusondBreak3480.patch
  against trunk revision 673254.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 4 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    -1 contrib tests.  The patch failed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2779/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2779/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2779/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2779/console

This message is automatically generated., Thanks Brice.  Looks like it's still failing:

hudson> DECLARED_JARS+=' '$(cd "${SUPPORT_DIR}"; find lib -name '*.jar')
-bash: DECLARED_JARS+= lib/rat-0.5.1.jar: No such file or directory

, That's really strange. Maybe our versions of bash differs ?
This new version do things in a bit different way. I hope it will fix that bug... Thanks for your patience., Nope, still doesn't work.  Looks like += operator isn't supported.

[hudson]> DECLARED_JARS=$(sed -n 's@.*kind="lib".*path="\(.*jar\)".*@\1@p' < .eclipse.templates/.classpath)
[hudson]> PRESENT_JARS=$(find lib/ src/test/lib/ -name '*.jar' |sort)
[hudson]> SUPPORT_DIR=/export/home/nigel/hudsonSupport/buildSupport/
[hudson]> DECLARED_JARS+=' '
-bash: DECLARED_JARS+= : command not found
[hudson]> DECLARED_JARS+=$(cd "${SUPPORT_DIR}"; find lib -name '*.jar')
-bash: DECLARED_JARS+=lib/rat-0.5.1.jar: No such file or directory

Note this host runs Solaris x86:
[hudson]> bash -version
GNU bash, version 3.00.16(1)-release (i386-pc-solaris2.10)
Copyright (C) 2004 Free Software Foundation, Inc.

, Yes ! According to the bash Changelog '+=' appeared in 3.1-rc1.
So this one should be the right. I'll try to find an old system to test it tomorrow.
 I'll also have to RTFM about Hudson :-/.
Thanks a lot for your help, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12385147/fixHusondBreak3480_v3.patch
  against trunk revision 673517.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 4 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    -1 contrib tests.  The patch failed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2795/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2795/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2795/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2795/console

This message is automatically generated., A new patch that Brice and I have determined should work., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12385251/HADOOP-3653.patch
  against trunk revision 674442.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 4 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2798/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2798/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2798/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch/2798/console

This message is automatically generated., I just committed this to trunk and branch-0.18.  Thanks Brice!, Integrated in Hadoop-trunk #581 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/581/])]