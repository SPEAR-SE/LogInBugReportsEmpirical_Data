[Patch explicitly uses /usr/bin/stat on MacOS, instead of assuming that stat points to /usr/bin/stat., Tests pass locally. Submitting for jenkins to pick up., Since apache jenkins runs on linux, jenkins results are not relevant to this change, anyway ;-), -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12496319/7680-0.23.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed unit tests in .

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HADOOP-Build/230//testReport/
Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/230//console

This message is automatically generated., No new tests required, since testHardLink testcase covers it., Having PATH in your executing environment is a better fix than adding an absolute path in the code., bq. Having PATH in your executing environment is a better fix than adding an absolute path in the code. 

err.. I mean to say 

Having _right_ PATH in your executing environment is a better fix than adding an absolute path in the code., /usr/bin/stat is fixed for all mac os versions, and not likely to change anytime soon. The specific reason I need gnutools in my path is for openMPI tests. So, I cannot change it when I do mvn test.

:-(

Any other suggestions ?

, Do you have other similar binaries in /usr/bin/ and /opt/local/libexec/gnubin ? If not, changing order in $PATH should help., @Rajiv, yes I have similar binaries there.

$ls /usr/bin /opt/local/libexec/gnubin | sort | uniq -c | grep "^      2" | wc -l

56

So, there are 56 binaries with the same name in both directories.
, Hi Miland, I also think it isn't appropriate to hardcode a path into the Hadoop binaries; the whole point of PATH is allowing the user to specify what versions of utils (such as 'stat') get called.

If you must have /opt/local/libexec/gnubin before /usr/bin/ in your PATH, and /opt/local/libexec/gnubin/stat is broken, you may need to override that specific utility with a link to the one in /usr/bin.

Alternatively, is there a variant of the '-f%l' argument that does work with the gnubin/stat, that might also work with /usr/bin/stat?  

Or, third choice, this could be the motivation to change HardLink to a native call (if native calls work on Mac?)., @Matt, /opt/local/libexec/gnubin/stat is not *broken* it's just gnu stat (rather than bsd stat that is in /usr/bin/stat). I need that gnu stat, since it is called in the configure for a subtask I am working on. So, cannot override it.

I did not find a common cmd line param that will work with both bsd stat and gnu stat.

Third choice is the only way to go, it seems. But I don't have bandwidth to do it.

But, would it be too much of a hassle if /usr/bin/stat is explicitly referred to, since the target is Mac only, and very unusual to find stat in any place other than /usr/bin/stat ? This will also avoid issues such as when user has a ./stat (a nice statistics program ;-) etc ?, Actually, your point that this is in a piece of code specific to Mac only, is very valid.  I guess based on that I wouldn't mind this change.  Mac is probably the only OS that has tools from both BSD and Linux worlds co-resident.  So I withdraw the objection to, essentially, specifying which one is desired., After, Matt's comment, I think there are no more objections. Can someone commit this ?, Fixed in all 0.22.1 , trunk and 0.23, Integrated in Hadoop-Hdfs-trunk-Commit #1830 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Commit/1830/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290868)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290868
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Common-trunk-Commit #1756 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/1756/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290868)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290868
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Common-0.23-Commit #577 (See [https://builds.apache.org/job/Hadoop-Common-0.23-Commit/577/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290869)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290869
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Hdfs-0.23-Commit #564 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Commit/564/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290869)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290869
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Common-22-branch #105 (See [https://builds.apache.org/job/Hadoop-Common-22-branch/105/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290867)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290867
Files : 
* /hadoop/common/branches/branch-0.22/common/CHANGES.txt
* /hadoop/common/branches/branch-0.22/common/src/java/org/apache/hadoop/fs/FileUtil.java
, Integrated in Hadoop-Mapreduce-0.23-Commit #579 (See [https://builds.apache.org/job/Hadoop-Mapreduce-0.23-Commit/579/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290869)

     Result = ABORTED
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290869
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Mapreduce-trunk-Commit #1767 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/1767/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290868)

     Result = ABORTED
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290868
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, re-opening as the RESULT = ABORTED statement on the integration comments look worrying; something may have failed, Integrated in Hadoop-Hdfs-trunk #960 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/960/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290868)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290868
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Hdfs-0.23-Build #173 (See [https://builds.apache.org/job/Hadoop-Hdfs-0.23-Build/173/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290869)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290869
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Mapreduce-trunk #995 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/995/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290868)

     Result = SUCCESS
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290868
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, Integrated in Hadoop-Mapreduce-0.23-Build #201 (See [https://builds.apache.org/job/Hadoop-Mapreduce-0.23-Build/201/])
    HADOOP-7680 TestHardLink fails on Mac OS X, when gnu stat is in path. (Revision 1290869)

     Result = FAILURE
stevel : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1290869
Files : 
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/branches/branch-0.23/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/HardLink.java
, it is fixed, it's just jenkins that is complaining about post-build operations]