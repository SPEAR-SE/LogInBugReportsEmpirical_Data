[This is being addressed via HADOOP-8582., To me this seems NOT to be a duplicate of HADOOP-8582 .
To me this issue is essentially: Problem with Gzip in specific situation.  
HADOOP-8582 effectively says "Lets make the error message clear until we fix the real problem".

So I propose we keep this open as an unsolved 'non-duplicate' bug
, Hi Niels,

Am happy to reopen this, but the reason for this not to work is explained at HADOOP-538.

I will add that as a link as well.

Do you still wish to reopen?, Also Neils, If you notice the stack trace, the user ran into this cause his jobs did create it with the right codec, but his reader failed to enforce that the right codec is needed, which is what HADOOP-8582 wishes to fix. Or did I miss something?]