[fix for hadoop 0.4, fix for trunk, One more note, there were couiple of other places in code where the random was used in the same way, perhaps someone with better understanding of the internals should check them out too., I just committed this.  Thanks, Sami!]