[This patch fixes this serious bug by doing two things:

1. Restricting the instances that are to be terminated to the version of the Hadoop AMI specified in the config file.
2. Listing the instances that will be terminated and prompting the user for agreement to proceed.

I have also updated the wiki to draw attention to this bug., +1

http://issues.apache.org/jira/secure/attachment/12360138/HADOOP-1504.patch applied and successfully tested against trunk revision r548794.

Test results:   http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/303/testReport/
Console output: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/303/console, I just committed this.  Thanks, Tom!, Integrated in Hadoop-Nightly #131 (See [http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/131/])]