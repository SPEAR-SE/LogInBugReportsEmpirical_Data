[Here's a patch that probably fixes the issue. I don't have enough infrastructure yet to test this out. Nige, would it be possible for you to verify this since you also know how to reproduce the issue?, Better use synchronized maps to avoid more such issues, as JobHistory class and its inner classes used by multiple threads.

Submitted patch., +1, because http://issues.apache.org/jira/secure/attachment/12354497/1011.patch applied and successfully tested against trunk revision http://svn.apache.org/repos/asf/lucene/hadoop/trunk/523840. Results are at http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch, I like Tahir's patch better than blindly replacing with synchronized maps. The problem with synchronized maps is that often the locking is too fine grained and maps that are supposed to stay in sync with each other are locked independently. , I just committed this.  Thanks, Tahir!, Integrated in Hadoop-Nightly #43 (See http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/43/)]