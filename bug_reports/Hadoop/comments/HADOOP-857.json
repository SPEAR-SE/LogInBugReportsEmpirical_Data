[This failure occurs because S3FileSystem treats lack of a parent directory as an error in createRaw, whereas LocalFileSystem (and presumably DistributedFileSystem too) creates parent directories if they don't exist.

I will create a patch to fix this., This patch makes it possible to run Map/Reduce using S3 instead of HDFS. I've written a wiki page explaining how to do it here: http://wiki.apache.org/lucene-hadoop/AmazonS3., +1, because http://issues.apache.org/jira/secure/attachment/12348453/hadoop-857.patch applied and successfully tested against trunk revision r493236., I just committed this.  Thanks, Tom.]