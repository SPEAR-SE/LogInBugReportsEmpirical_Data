[[~yishuihanxiao], this part of the code is parsing the output of 

{code}
df -k -P <volume>
{code}

where volume is each of the local edit dirs namenode configured for the namenode as well as the extra checked dirs. This could possibly be affected if the output of df is 'aliased' on the namenode user's account or perhaps others issues where the df output is output on multiple lines.

Could you post an example output for the df -k -P <volume> (substituting <volume for the edit log dirs>)command for the namenode user on the affected system?]