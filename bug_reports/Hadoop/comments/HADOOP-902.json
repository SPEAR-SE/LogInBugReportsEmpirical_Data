[backupStream could be null when close() is called multiple times.. if the current write position is at the end of a block size, endBlock() is called before flushing any data which results in this NPE.

will submit a patch soon.



, 
attached patch checks if backupStream or backupFile is null when each is closed.
, +1, because http://issues.apache.org/jira/secure/attachment/12349210/HADOOP-902.patch applied and successfully tested against trunk revision r497583., I just committed this.  Thanks, Raghu!]