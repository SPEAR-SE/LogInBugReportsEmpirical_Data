[I agree that the unit test needs to be enhanced. However, I have another program in the same directory called recordBench, that generates buffers with random bytes. It seems to work. I will doublecheck though., I found the bug. It is in Buffer.toString. However, I am in the process of changing CSV serialization of Buffers. (Currently it is supposed to be hex pairs) which results in two times the optimal space., This bug also affects the XML serialization of buffers. This patch fixes it, and also modifies TestrecordIO to check for the proper serialization of Buffers., +1, because http://issues.apache.org/jira/secure/attachment/12354338/jute-patch.txt applied and successfully tested against trunk revision http://svn.apache.org/repos/asf/lucene/hadoop/trunk/522597. Results are at http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch, 
+1.  Code reviewed and looks fine.  A small safe fix., I just committed this.  Thanks, Milind!, Not quite two times, I think.  Are you switching to base-64 encoding?

- David


, No, I use hex pairs. So, one byte is serialized as two chars between 0-9a-f., Oh, i misunderstood your question. I am switching buffer serialization to just plain bytes except for 5 characters that are escaped (essentially similar to string serialization as if the string were iso-8859-1.), Integrated in Hadoop-Nightly #39 (See http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/39/)]