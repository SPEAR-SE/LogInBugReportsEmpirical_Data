[So bin/hadoop has this logic:

JAVA_HEAP_MAX=-Xmx1000m

# check envvars which might override default args
if [ "$HADOOP_HEAPSIZE" != "" ]; then
  #echo "run with heapsize $HADOOP_HEAPSIZE"
  JAVA_HEAP_MAX="-Xmx""$HADOOP_HEAPSIZE""m"
  #echo $JAVA_HEAP_MAX
fi


This makes it impossible to create a hadoop-env.sh that is truly generic to all nodes.  It would be better to do this HEAPSIZE management in hadoop-env.sh to allow it to be easily override-able., 
Though not the cleanest, there is a way to do this using various HADOOP_*_OPTS. We can set heap size also in these opts, for e.g. HADOOP_JOBTRACKER_OPTS=-Xmx2000m, it will be eventually picked up by the running command. It works this way because jvm takes up the last -Xmx value that occurs in the command line which would be from HADOOP_OPTS.

{code} exec "$JAVA" $JAVA_HEAP_MAX $HADOOP_OPTS $CLASS "$@"{code}, Oh, and I think this issue is a duplicate of HADOOP-6167., agreed that this a dupe.]