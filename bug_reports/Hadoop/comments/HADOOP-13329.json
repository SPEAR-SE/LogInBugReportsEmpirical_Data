[In INFRA-12014, [~asanjar] reports:

1) Switch from ubuntu:trusty to ppc64le/ubuntu:trusty
2) Switch Oracle JDK to OpenJDK
3) There is no libisal for PPC

Unless there is a trick that I don't know (likely), we're probably looking at creating Dockerfiles per HW arch due to that first issue  (argh!).  This has two follow-on ramifications:

1) start-build-env will need to be modified to do detection
2) Jenkins precommit will need to be changed to use the correct one on a per-job basis , Allen, I have a patch that adds a new Dockerfile and modify start-build-env.sh to detect host's architecture. However couldn't attach the patch to this JIRA ??!!
Adding the patch to JIRA https://issues.apache.org/jira/browse/INFRA-12014
 , submitted patch for review , I think what we should probably do is actually make separate platform directories underneath the docker dir then modify start-build-env.sh to point to the directory that matches the platform.  This would mean the current Dockerfile would get moved to x86_64 or whatever.

Some specific comments:

* The protobuf integration makes me very nervous.  That doesn't look like a long lasting URL at all.  Isn't there a repo we can point to?
* Why the custom code for leveldb?
* We should probably rework the start-build-env.sh docker call to avoid having two copies of the hadoop-env-checks script.  We could have it copy the correct Dockerfile and the hadoop-env-checks script to some place under target or patchprocess and build it from there.
* The Apache Yetus marker is missing which means this will completely blow up when used against the Apache build infrastructure

... speaking of, I can't really test this out until that machine gets re-hooked into the infra. :(
, | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 25s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green}  8m  9s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  9m 59s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  8m 43s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} shellcheck {color} | {color:red}  0m 13s{color} | {color:red} The patch generated 13 new + 75 unchanged - 0 fixed = 88 total (was 75) {color} |
| {color:orange}-0{color} | {color:orange} shelldocs {color} | {color:orange}  0m  8s{color} | {color:orange} The patch generated 8 new + 124 unchanged - 0 fixed = 132 total (was 124) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 2 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green}  8m 11s{color} | {color:green} root in the patch passed. {color} |
| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 28s{color} | {color:red} The patch generated 1 ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 36m 51s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:9560f25 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12816088/HADOOP-13329.patch |
| JIRA Issue | HADOOP-13329 |
| Optional Tests |  asflicense  shellcheck  shelldocs  mvnsite  unit  |
| uname | Linux 9b15f7f5ffef 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / a3f93be |
| shellcheck | v0.4.4 |
| shellcheck | https://builds.apache.org/job/PreCommit-HADOOP-Build/9934/artifact/patchprocess/diff-patch-shellcheck.txt |
| shelldocs | https://builds.apache.org/job/PreCommit-HADOOP-Build/9934/artifact/patchprocess/diff-patch-shelldocs.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/9934/artifact/patchprocess/whitespace-eol.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/9934/testReport/ |
| asflicense | https://builds.apache.org/job/PreCommit-HADOOP-Build/9934/artifact/patchprocess/patch-asflicense-problems.txt |
| modules | C: . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/9934/console |
| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, bq.  We could have it copy the correct Dockerfile and the hadoop-env-checks script to some place under target or patchprocess and build it from there.

Actually, that's a terrible idea.  But there's got to be a way to make this work. :/, > - I agree with your statement that Dockerfiles would get moved to x86_64, ppc64le, ARM64 or whatever.
> - I understand your concern, however Ubuntu 15.04 public repository does not house protobuf v2.5 any more. As an ex-canonical and Ubuntu developer I assure you https://launchpad.net/ubuntu/+source/protobuf/2.5.0-9ubuntu1/ launchpad is long lasting. There are repos with protobuf 2.5 for Power, but security was my main concern.
> - Why the custom code for leveldb? leveldb in public maven repository has x86 specif could that breaks on Power and ARM :( In meanwhile we are working with Maven community to establish a "secure" maven Power repo.
> - Interesting idea, I agree with your statement "We should probably rework the start-build-env.sh docker call to avoid having two copies of the hadoop-env-checks script. We could have it copy the correct Dockerfile and the hadoop-env-checks script to some place under target or patchprocess and build it from there." 
> - Regarding Apache Yetus, we are working on it.. 
 , Adding Yetus marker , | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m  0s{color} | {color:blue} Docker mode activated. {color} |
| {color:red}-1{color} | {color:red} patch {color} | {color:red}  0m  3s{color} | {color:red} HADOOP-13329 does not apply to trunk. Rebase required? Wrong Branch? See https://wiki.apache.org/hadoop/HowToContribute for help. {color} |
\\
\\
|| Subsystem || Report/Notes ||
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12817220/HADOOP-13329.2.patch |
| JIRA Issue | HADOOP-13329 |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/9959/console |
| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, merging patch #1 and #2, | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 21s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 10m 16s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 11m 44s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 11m 31s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} shellcheck {color} | {color:red}  0m 15s{color} | {color:red} The patch generated 13 new + 75 unchanged - 0 fixed = 88 total (was 75) {color} |
| {color:orange}-0{color} | {color:orange} shelldocs {color} | {color:orange}  0m 10s{color} | {color:orange} The patch generated 8 new + 124 unchanged - 0 fixed = 132 total (was 124) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 3 line(s) that end in whitespace. Use git apply --whitespace=fix. {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 10m  1s{color} | {color:green} root in the patch passed. {color} |
| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 27s{color} | {color:red} The patch generated 1 ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 45m 22s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:9560f25 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12817237/HADOOP-13329.3.patch |
| JIRA Issue | HADOOP-13329 |
| Optional Tests |  asflicense  shellcheck  shelldocs  mvnsite  unit  |
| uname | Linux 73b4b80f83a7 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / 0fd3980 |
| shellcheck | v0.4.4 |
| shellcheck | https://builds.apache.org/job/PreCommit-HADOOP-Build/9960/artifact/patchprocess/diff-patch-shellcheck.txt |
| shelldocs | https://builds.apache.org/job/PreCommit-HADOOP-Build/9960/artifact/patchprocess/diff-patch-shelldocs.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/9960/artifact/patchprocess/whitespace-eol.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/9960/testReport/ |
| asflicense | https://builds.apache.org/job/PreCommit-HADOOP-Build/9960/artifact/patchprocess/patch-asflicense-problems.txt |
| modules | C: . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/9960/console |
| Powered by | Apache Yetus 0.4.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, I'm using a modified version of this Dockerfile for the PPC build on Jenkins. One big thing: I opted not to do the LevelDB hack because I was under the impression that YARN is supposed to treat that requirement as optional.  It's causing massive test failure, but let's see what the community does with it., OK Allen, thanks, | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 13s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 12m 40s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  9m 11s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  9m 19s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} shellcheck {color} | {color:red}  0m  1s{color} | {color:red} The patch generated 14 new + 0 unchanged - 0 fixed = 14 total (was 0) {color} |
| {color:orange}-0{color} | {color:orange} shelldocs {color} | {color:orange}  0m  9s{color} | {color:orange} The patch generated 8 new + 104 unchanged - 0 fixed = 112 total (was 104) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 3 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 14m 41s{color} | {color:green} root in the patch passed. {color} |
| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 29s{color} | {color:red} The patch generated 1 ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 47m 11s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:14b5c93 |
| JIRA Issue | HADOOP-13329 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12817237/HADOOP-13329.3.patch |
| Optional Tests |  asflicense  shellcheck  shelldocs  mvnsite  unit  |
| uname | Linux ea1e02d383d2 4.4.0-43-generic #63-Ubuntu SMP Wed Oct 12 13:48:03 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / af2773f |
| shellcheck | v0.4.6 |
| shellcheck | https://builds.apache.org/job/PreCommit-HADOOP-Build/12674/artifact/patchprocess/diff-patch-shellcheck.txt |
| shelldocs | https://builds.apache.org/job/PreCommit-HADOOP-Build/12674/artifact/patchprocess/diff-patch-shelldocs.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/12674/artifact/patchprocess/whitespace-eol.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/12674/testReport/ |
| asflicense | https://builds.apache.org/job/PreCommit-HADOOP-Build/12674/artifact/patchprocess/patch-asflicense-problems.txt |
| modules | C: . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/12674/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 18s{color} | {color:blue} Docker mode activated. {color} |
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
|| || || || {color:brown} trunk Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m 53s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 10m 55s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  9m 27s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  9m 36s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} shellcheck {color} | {color:red}  0m  0s{color} | {color:red} The patch generated 14 new + 0 unchanged - 0 fixed = 14 total (was 0) {color} |
| {color:orange}-0{color} | {color:orange} shelldocs {color} | {color:orange}  0m 12s{color} | {color:orange} The patch generated 8 new + 104 unchanged - 0 fixed = 112 total (was 104) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 3 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |
| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  8m 55s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 18m 23s{color} | {color:green} root in the patch passed. {color} |
| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 39s{color} | {color:red} The patch generated 1 ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 74m 46s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:71bbb86 |
| JIRA Issue | HADOOP-13329 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12817237/HADOOP-13329.3.patch |
| Optional Tests |  asflicense  shellcheck  shelldocs  mvnsite  unit  |
| uname | Linux 0ac91512b348 3.13.0-119-generic #166-Ubuntu SMP Wed May 3 12:18:55 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / 6f789fe |
| shellcheck | v0.4.6 |
| shellcheck | https://builds.apache.org/job/PreCommit-HADOOP-Build/13418/artifact/patchprocess/diff-patch-shellcheck.txt |
| shelldocs | https://builds.apache.org/job/PreCommit-HADOOP-Build/13418/artifact/patchprocess/diff-patch-shelldocs.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/13418/artifact/patchprocess/whitespace-eol.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/13418/testReport/ |
| asflicense | https://builds.apache.org/job/PreCommit-HADOOP-Build/13418/artifact/patchprocess/patch-asflicense-problems.txt |
| modules | C: . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/13418/console |
| Powered by | Apache Yetus 0.6.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, | (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 24s{color} | {color:blue} Docker mode activated. {color} |
|| || || || {color:brown} Prechecks {color} ||
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:red}-1{color} | {color:red} test4tests {color} | {color:red}  0m  0s{color} | {color:red} The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. {color} |
|| || || || {color:brown} trunk Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 15m  2s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 10m 24s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  8m 53s{color} | {color:green} branch has no errors when building and testing our client artifacts. {color} |
|| || || || {color:brown} Patch Compile Tests {color} ||
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green} 14m  4s{color} | {color:green} the patch passed {color} |
| {color:red}-1{color} | {color:red} shellcheck {color} | {color:red}  0m  0s{color} | {color:red} The patch generated 14 new + 0 unchanged - 0 fixed = 14 total (was 0) {color} |
| {color:orange}-0{color} | {color:orange} shelldocs {color} | {color:orange}  0m 11s{color} | {color:orange} The patch generated 8 new + 104 unchanged - 0 fixed = 112 total (was 104) {color} |
| {color:red}-1{color} | {color:red} whitespace {color} | {color:red}  0m  0s{color} | {color:red} The patch has 3 line(s) that end in whitespace. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply {color} |
| {color:green}+1{color} | {color:green} shadedclient {color} | {color:green}  9m 27s{color} | {color:green} patch has no errors when building and testing our client artifacts. {color} |
|| || || || {color:brown} Other Tests {color} ||
| {color:green}+1{color} | {color:green} unit {color} | {color:green} 14m 14s{color} | {color:green} root in the patch passed. {color} |
| {color:red}-1{color} | {color:red} asflicense {color} | {color:red}  0m 30s{color} | {color:red} The patch generated 1 ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 73m 40s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker | Client=17.05.0-ce Server=17.05.0-ce Image:yetus/hadoop:d4cc50f |
| JIRA Issue | HADOOP-13329 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12817237/HADOOP-13329.3.patch |
| Optional Tests |  asflicense  shellcheck  shelldocs  mvnsite  unit  |
| uname | Linux 000daaa6d300 4.4.0-64-generic #85-Ubuntu SMP Mon Feb 20 11:50:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / fe224ff |
| maven | version: Apache Maven 3.3.9 |
| shellcheck | v0.4.6 |
| shellcheck | https://builds.apache.org/job/PreCommit-HADOOP-Build/14358/artifact/out/diff-patch-shellcheck.txt |
| shelldocs | https://builds.apache.org/job/PreCommit-HADOOP-Build/14358/artifact/out/diff-patch-shelldocs.txt |
| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/14358/artifact/out/whitespace-eol.txt |
|  Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/14358/testReport/ |
| asflicense | https://builds.apache.org/job/PreCommit-HADOOP-Build/14358/artifact/out/patch-asflicense-problems.txt |
| Max. process+thread count | 409 (vs. ulimit of 10000) |
| modules | C: . U: . |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/14358/console |
| Powered by | Apache Yetus 0.8.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

]