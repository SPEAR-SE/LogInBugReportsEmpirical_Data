[[~arpiagariu],

Could you please check my patch?, | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 15s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 13m 55s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  6s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m  1s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 19s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 17m  0s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:a9ad5d6 |
| JIRA Issue | HADOOP-14229 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12860355/HADOOP-14229.01.patch |
| Optional Tests |  asflicense  mvnsite  |
| uname | Linux cc418ca36696 3.13.0-108-generic #155-Ubuntu SMP Wed Jan 11 16:58:52 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / ab759e9 |
| modules | C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/11914/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, Patch 02:
Make it more compact
Test results:
{code}hadoop-3.0.0-alpha2/bin/hadoop kerbname {nn,dn,jn,rm,nm,jhs}/host.domain@REALM.TLD
Name: nn/host.domain@REALM.TLD to hdfs
Name: dn/host.domain@REALM.TLD to hdfs
Name: jn/host.domain@REALM.TLD to hdfs
Name: rm/host.domain@REALM.TLD to yarn
Name: nm/host.domain@REALM.TLD to yarn
Name: jhs/host.domain@REALM.TLD to mapred{code}, [~boky01], 
Verified that the current suggested settings for hadoop.security.auth_to_local in https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/SecureMode.html do not perform the intended action.
As you said, the command _hadoop kerbname jhs/host.domain@REALM.TLD_ gives the following result:
bq. Name: jhs/host.domain@REALM.TLD to jhs/host.domain@REALM.TLD
whereas, the intended result is:
bq. Name: jhs/host.domain@REALM.TLD to mapred

The patch LGTM., I'm going to +1 with the caveat that this makes the docs a little more clear, but doesn't really solve a key problem:

{code}
$ bin/hadoop kerbname nn/host2.domain@REALM.TLD
Name: nn/host2.domain@REALM.TLD to hdfs
{code}

This is sort of hinted at in the docs:

{code}
The default rule maps the principal host/full.qualified.domain.name@REALM.TLD to system user host. The default rule will not be appropriate for most clusters.
{code}

It then goes on to provide the example rule which doesn't actually fix that warning and all clusters still have super user access on every other cluster in the same realm.  At which point it becomes clear the documentation is mostly an exercise in obfuscation.  You're better off just using hdfs/, yarn/, etc for daemons and avoid all this mapping baloney anyway (which is what most people that I know of do).
, [~aw],

That is true. Skipping FQDN causes super *group* access between clusters (in the same realm).
I think here we are not intended to provide a production ready mapping it should just be an example showing what is the basic syntax.
Anyway, your comment made me feel I should provide a bit more complex (but not too complex) example to show the syntax of auth_to_local rules.
[^HADOOP-14229.03.patch], Reattach last patch to kick [~hadoopqa], | (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | {color:blue} reexec {color} | {color:blue}  0m 11s{color} | {color:blue} Docker mode activated. {color} |
| {color:green}+1{color} | {color:green} @author {color} | {color:green}  0m  0s{color} | {color:green} The patch does not contain any @author tags. {color} |
| {color:green}+1{color} | {color:green} mvninstall {color} | {color:green} 13m 12s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  1m 18s{color} | {color:green} trunk passed {color} |
| {color:green}+1{color} | {color:green} mvnsite {color} | {color:green}  0m 50s{color} | {color:green} the patch passed {color} |
| {color:green}+1{color} | {color:green} whitespace {color} | {color:green}  0m  0s{color} | {color:green} The patch has no whitespace issues. {color} |
| {color:green}+1{color} | {color:green} asflicense {color} | {color:green}  0m 14s{color} | {color:green} The patch does not generate ASF License warnings. {color} |
| {color:black}{color} | {color:black} {color} | {color:black} 16m  7s{color} | {color:black} {color} |
\\
\\
|| Subsystem || Report/Notes ||
| Docker |  Image:yetus/hadoop:14b5c93 |
| JIRA Issue | HADOOP-14229 |
| JIRA Patch URL | https://issues.apache.org/jira/secure/attachment/12866661/HADOOP-14229.03.patch |
| Optional Tests |  asflicense  mvnsite  |
| uname | Linux 80ec0aec2f3b 4.4.0-43-generic #63-Ubuntu SMP Wed Oct 12 13:48:03 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux |
| Build tool | maven |
| Personality | /testptch/hadoop/patchprocess/precommit/personality/provided.sh |
| git revision | trunk / e4f34ec |
| modules | C: hadoop-common-project/hadoop-common U: hadoop-common-project/hadoop-common |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/12251/console |
| Powered by | Apache Yetus 0.5.0-SNAPSHOT   http://yetus.apache.org |


This message was automatically generated.

, Looks good to me. +1. Committing shortly. Thank you for the contribution Andras!, Committed to trunk., SUCCESS: Integrated in Jenkins build Hadoop-trunk-Commit #12070 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/12070/])
HADOOP-14229. hadoop.security.auth_to_local example is incorrect in the (raviprak: rev 746189ad8cdf90ab35baec9364b2e02956a1e70c)
* (edit) hadoop-common-project/hadoop-common/src/site/markdown/SecureMode.md
, Thanks [~raviprak]!, Can this jira be backported to branch-2 also, as the same issue exists in 2.x releases also.]