[Just FYI, I recently integrated hadoop 0.5 into my copy of the source, rebuit and installed. I ran into similar "Could not obtain block" errors until I realized that I hadn't deployed the (new in hadoop 0.5) .../webapps/datanode/ servlet on my cluster.]