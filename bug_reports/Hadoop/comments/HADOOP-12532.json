[I think a simple fix is to remove the connection thread from the has map after connections are terminated. But creating a test case to verify the fix would be harder., rev1. WIP. I think it might resolve the bug., No go. Apparently the order of removing from the hash map is important. 
Another solution is to let connection threads register with Client when it's terminated.]