[Patch attached. , +1, http://issues.apache.org/jira/secure/attachment/12346547/Hadoop-786.patch applied and successfully tested against trunk revision r482999, +1, I just committed this.  Thanks, Sanjay!]