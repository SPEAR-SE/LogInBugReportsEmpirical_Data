[Hit enter too soon :(, this jira is for fixing test-patch so that we can get CI builds running for MR patches., After HADOOP-7560 both smart-apply-patch.sh and test-patch.sh will need updating to reflect the new module names: hadoop-common-project, hadoop-hdfs-project, and hadoop-mapreduce-project., Preliminary patch that allows testing of MR patches. Also includes changes to incorporate HADOOP-7560., updated patch. Had forgotten changes to smart-apply. Tom can you please take a look at the patch?, I tried it from the top-level and it worked fine (although the javadoc generation takes a while).

From a project sub-directory such as hadoop-hdfs-project it fails since the script expects a dev-support/test-patch.properties file there. This can be fixed by moving the one in hadoop-hdfs-project/hadoop-hdfs up a level., good point, 
Here is a set of svn commands to run to get this going:

{code}
svn move hadoop-common-project/hadoop-common/dev-support/test-patch.properties hadoop-common-project/dev-support/
svn move hadoop-hdfs-project/hadoop-hdfs/dev-support/test-patch.properties hadoop-hdfs-project/dev-support/
svn move hadoop-mapreduce-project/src/test/test-patch.properties hadoop-mapreduce-project/dev-support/
{code}, +1, I just pushed this. Thanks Tom for your help!, Integrated in Hadoop-Mapreduce-trunk-Commit #789 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/789/])
    HADOOP-7578. Fix test-patch to be able to run on MR patches. (mahadev and tom white)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161711
Files : 
* /hadoop/common/trunk/dev-support/smart-apply-patch.sh
* /hadoop/common/trunk/dev-support/test-patch.sh
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/src/test/test-patch.properties
, Integrated in Hadoop-Common-trunk-Commit #786 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/786/])
    HADOOP-7578. Fix test-patch to be able to run on MR patches. (mahadev and tom white)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161711
Files : 
* /hadoop/common/trunk/dev-support/smart-apply-patch.sh
* /hadoop/common/trunk/dev-support/test-patch.sh
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/src/test/test-patch.properties
, Integrated in Hadoop-Hdfs-trunk-Commit #863 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Commit/863/])
    HADOOP-7578. Fix test-patch to be able to run on MR patches. (mahadev and tom white)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161711
Files : 
* /hadoop/common/trunk/dev-support/smart-apply-patch.sh
* /hadoop/common/trunk/dev-support/test-patch.sh
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/src/test/test-patch.properties
, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12491671/HADOOP-7578.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    -1 javadoc.  The javadoc tool appears to have generated 80 warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    -1 core tests.  The patch failed these unit tests:

                  org.apache.hadoop.hdfs.TestDfsOverAvroRpc
                  org.apache.hadoop.hdfs.tools.offlineEditsViewer.TestOfflineEditsViewer
                  org.apache.hadoop.hdfs.server.blockmanagement.TestHost2NodesMap
                  org.apache.hadoop.hdfs.TestDFSRollback

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//testReport/
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-api.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-shuffle.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-hdfs-project/hadoop-hdfs.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common-project/hadoop-common.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common-project/hadoop-annotations.html
Findbugs warnings: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//artifact/trunk/patchprocess/newPatchFindbugsWarningshadoop-common-project/hadoop-auth.html
Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/81//console

This message is automatically generated., Integrated in Hadoop-Hdfs-trunk #768 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/768/])
    HADOOP-7578. Fix test-patch to be able to run on MR patches. (mahadev and tom white)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161711
Files : 
* /hadoop/common/trunk/dev-support/smart-apply-patch.sh
* /hadoop/common/trunk/dev-support/test-patch.sh
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/src/test/test-patch.properties
, Integrated in Hadoop-Common-trunk-Commit #790 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/790/])
    HADOOP-7578. Fix a mess up in svn move (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161777
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
, Integrated in Hadoop-Mapreduce-trunk-Commit #797 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/797/])
    HADOOP-7578. Fix a mess up in svn move (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161777
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
, Integrated in Hadoop-Hdfs-trunk-Commit #867 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Commit/867/])
    HADOOP-7578. Fix a mess up in svn move (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161777
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
, Integrated in Hadoop-Common-trunk-Commit #791 (See [https://builds.apache.org/job/Hadoop-Common-trunk-Commit/791/])
    HADOOP-7578. Adding needed files in svn (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161781
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support/test-patch.properties
, Integrated in Hadoop-Mapreduce-trunk-Commit #798 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Commit/798/])
    HADOOP-7578. Adding needed files in svn (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161781
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support/test-patch.properties
, Integrated in Hadoop-Hdfs-trunk-Commit #868 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Commit/868/])
    HADOOP-7578. Adding needed files in svn (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161781
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support/test-patch.properties
, Integrated in Hadoop-Mapreduce-trunk #793 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/793/])
    HADOOP-7578. Fix test-patch to be able to run on MR patches. (mahadev and tom white)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161711
Files : 
* /hadoop/common/trunk/dev-support/smart-apply-patch.sh
* /hadoop/common/trunk/dev-support/test-patch.sh
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/hadoop-hdfs/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-mapreduce-project/src/test/test-patch.properties
, Integrated in Hadoop-Hdfs-trunk #770 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/770/])
    HADOOP-7578. Adding needed files in svn (mahadev)
HADOOP-7578. Fix a mess up in svn move (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161781
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support/test-patch.properties

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161777
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
, Integrated in Hadoop-Mapreduce-trunk #794 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/794/])
    HADOOP-7578. Adding needed files in svn (mahadev)
HADOOP-7578. Fix a mess up in svn move (mahadev)

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161781
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-common-project/dev-support/test-patch.properties
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support/test-patch.properties

mahadev : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1161777
Files : 
* /hadoop/common/trunk/hadoop-common-project/dev-support
* /hadoop/common/trunk/hadoop-hdfs-project/dev-support
]