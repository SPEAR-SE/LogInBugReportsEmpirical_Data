[A file could deleted when fsck is running. So, getListings(0 can return null. fsck should handle this case., This bug exists in 0.15.3 also.
(I was able to reproduce by inserting some sleep statement and deleting some files), +1 codes look good, I think this might be the same issue as one I had using fsck / -move?, I just committed this. , Integrated in Hadoop-trunk #444 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/444/])]