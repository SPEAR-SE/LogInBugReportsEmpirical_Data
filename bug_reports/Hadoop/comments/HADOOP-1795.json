[It looks like this dates to HADOOP-1127, in 0.13.

Can you supply a patch with a unit test?  Thanks!, here it is (fix + test), +1

http://issues.apache.org/jira/secure/attachment/12364765/HADOOP-1795.patch applied and successfully tested against trunk revision r570881.

Test results:   http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/646/testReport/
Console output: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/646/console, I just committed this.  Thanks, Frédéric!]