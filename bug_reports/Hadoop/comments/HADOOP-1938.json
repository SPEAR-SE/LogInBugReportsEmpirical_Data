[bq.  Found 0 datanodes but MIN_REPLICATION for the cluster is configured to be 1.

I've seen this exception come up when the cluster was (semi-) full.  
If this is the case, maybe better error messages would help?


, The error occurs in an almost full cluster. Block placement needs to traverse the network topology to find good candidates. When a cluster is almost full, it needs to traverse much more number of datanodes before it declares failure. So it fails very slowly and wastes a lot of CPU time. 

What can be done is to remove a datanode from the network topology when it becomes full and then add it back to the network topology when it has some space available. So when a cluster becomes almost full, the network topology has much less number of datanodes. So it will be fast to place a block., HADOOP-3810 is resolved.]