[This can happen if the InMemoryFileSystem instance is "closed". The InMemoryFileSystem instance is closed prematurely if the merge of the files in the InMemoryFileSystem throws an exception. When close() is invoked on the instance of the InMemoryFileSystem, it will esentially clear out the mapping of the corresponding URI from the FileSystem's CACHE map, thereby invalidating the reference to the object. However, some of the copier threads might still be active and they might get NPEs if they try to invoke InMemoryFileSystem operations on that invalid object.
In essence, although the code could be tweaked to handle this exception, it is harmless, if there was some other fatal error before (like in-memory merge throwing an exception) this exception is thrown since the task is anyway going to die. Could you please confirm whether you see some other fatal exception before this NPE?, I verified from the logs that what I said earlier is indeed the case., Making it a Minor bug since the bug, as reported, is a side effect of a ReduceTask failure. It doesn't break anything, but, maybe these (spurious) NPE exceptions could be eliminated., InMemoryFileSystem was removed.  See HADOOP-4648.]