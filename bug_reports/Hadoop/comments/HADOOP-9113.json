[Uploading a patch that uses checks the DelegationTokenRenewer.queue length to verify a FileSystem being added and removed from it., Eli suggested I should annotate the method  with @VisibleForTesting - updating the patch with that., Looks like Hadoop QA is down. Here is the output from local run of test-patch.sh

{color:green}+1 overall{color}.  

    {color:green}+1 @author{color}.  The patch does not contain any @author tags.

    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.

    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.

    {color:green}+1 javadoc{color}.  The javadoc tool did not generate any warning messages.

    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.

    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version ) warnings.

    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.

, Uploading the same patch (it still applies) again to try and kick-off Jenkins., lgtm

Nit: the two assertTrues should be assertEquals so you can see what the value actually was if the test fails, Thanks for looking into this, Eli. Here is an updated patch addressing your comments., +1  pending jenkins. I kicked off a precommit job manually since it doesn't look like it picked up on the patch-available status of this jira.

https://builds.apache.org/job/PreCommit-HADOOP-Build/1839/
, Looks like the jenkins checkout failed. Is there an infra jira tracking the common precommit build?

Since you've already run test-patch offline on the prev version which was essentially the same I'm going to commit this., I've committed this. Thanks Karthik., Integrated in Hadoop-trunk-Commit #3114 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/3114/])
    HADOOP-9113. o.a.h.fs.TestDelegationTokenRenewer is failing intermittently. Contributed by Karthik Kambatla (Revision 1420490)

     Result = SUCCESS
eli : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1420490
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/DelegationTokenRenewer.java
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestDelegationTokenRenewer.java
, Integrated in Hadoop-Yarn-trunk #63 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/63/])
    HADOOP-9113. o.a.h.fs.TestDelegationTokenRenewer is failing intermittently. Contributed by Karthik Kambatla (Revision 1420490)

     Result = SUCCESS
eli : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1420490
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/DelegationTokenRenewer.java
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestDelegationTokenRenewer.java
, Integrated in Hadoop-Hdfs-trunk #1252 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/1252/])
    HADOOP-9113. o.a.h.fs.TestDelegationTokenRenewer is failing intermittently. Contributed by Karthik Kambatla (Revision 1420490)

     Result = FAILURE
eli : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1420490
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/DelegationTokenRenewer.java
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestDelegationTokenRenewer.java
, Integrated in Hadoop-Mapreduce-trunk #1283 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/1283/])
    HADOOP-9113. o.a.h.fs.TestDelegationTokenRenewer is failing intermittently. Contributed by Karthik Kambatla (Revision 1420490)

     Result = SUCCESS
eli : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1420490
Files : 
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/CHANGES.txt
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/DelegationTokenRenewer.java
* /hadoop/common/trunk/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/fs/TestDelegationTokenRenewer.java
]