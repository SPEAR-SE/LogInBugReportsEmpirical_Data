[expanded scope since I found the same idiom used in a few other classes., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |  14m 47s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 3 new or modified test files. |
| {color:green}+1{color} | javac |   7m 40s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |   9m 45s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 22s | The applied patch does not increase the total number of release audit warnings. |
| {color:red}-1{color} | checkstyle |   2m 17s | The applied patch generated  2 new checkstyle issues (total was 138, now 135). |
| {color:red}-1{color} | checkstyle |   2m 42s | The applied patch generated  1 new checkstyle issues (total was 9, now 9). |
| {color:red}-1{color} | checkstyle |   3m  5s | The applied patch generated  3 new checkstyle issues (total was 73, now 75). |
| {color:red}-1{color} | checkstyle |   3m 32s | The applied patch generated  8 new checkstyle issues (total was 31, now 39). |
| {color:green}+1{color} | whitespace |   0m  0s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 34s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 34s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   5m 26s | The patch does not introduce any new Findbugs (version 2.0.3) warnings. |
| {color:green}+1{color} | common tests |  25m 16s | Tests passed in hadoop-common. |
| {color:green}+1{color} | common tests |   1m 38s | Tests passed in hadoop-kms. |
| {color:green}+1{color} | mapreduce tests |   2m  4s | Tests passed in hadoop-mapreduce-client-core. |
| {color:green}+1{color} | tools/hadoop tests |   6m 13s | Tests passed in hadoop-distcp. |
| {color:green}+1{color} | tools/hadoop tests |   6m 22s | Tests passed in hadoop-streaming. |
| {color:red}-1{color} | hdfs tests |   3m 19s | Tests failed in hadoop-hdfs-httpfs. |
| | |  88m 35s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.fs.http.client.TestHttpFSFWithSWebhdfsFileSystem |
|   | hadoop.fs.http.client.TestHttpFSFWithWebhdfsFileSystem |
|   | hadoop.fs.http.client.TestHttpFSWithHttpFSFileSystem |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12732866/HADOOP-11969.1.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / def9136 |
| checkstyle |  https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/diffcheckstylehadoop-common.txt https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/diffcheckstylehadoop-hdfs-httpfs.txt https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/diffcheckstylehadoop-mapreduce-client-core.txt https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/diffcheckstylehadoop-streaming.txt |
| hadoop-common test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/testrun_hadoop-common.txt |
| hadoop-kms test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/testrun_hadoop-kms.txt |
| hadoop-mapreduce-client-core test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/testrun_hadoop-mapreduce-client-core.txt |
| hadoop-distcp test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/testrun_hadoop-distcp.txt |
| hadoop-streaming test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/testrun_hadoop-streaming.txt |
| hadoop-hdfs-httpfs test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/artifact/patchprocess/testrun_hadoop-hdfs-httpfs.txt |
| Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf903.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6689/console |


This message was automatically generated., -02
  * addresses checkstyle failures
  * fixes some related pre-existing javac warnings, \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |  14m 46s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 3 new or modified test files. |
| {color:red}-1{color} | javac |   6m 38s | The patch appears to cause the build to fail. |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12732925/HADOOP-11969.2.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / 15ccd96 |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6691/console |


This message was automatically generated., 
-03
  * for real this time., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |  14m 44s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 3 new or modified test files. |
| {color:green}+1{color} | javac |   7m 32s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |   9m 38s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   3m 30s | There were no new checkstyle issues. |
| {color:red}-1{color} | whitespace |   0m  1s | The patch has 1  line(s) that end in whitespace. Use git apply --whitespace=fix. |
| {color:green}+1{color} | install |   1m 32s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   5m 23s | The patch does not introduce any new Findbugs (version 2.0.3) warnings. |
| {color:green}+1{color} | common tests |  22m 17s | Tests passed in hadoop-common. |
| {color:green}+1{color} | common tests |   1m 39s | Tests passed in hadoop-kms. |
| {color:green}+1{color} | mapreduce tests |   1m 35s | Tests passed in hadoop-mapreduce-client-core. |
| {color:green}+1{color} | tools/hadoop tests |   6m  7s | Tests passed in hadoop-distcp. |
| {color:green}+1{color} | tools/hadoop tests |   6m  9s | Tests passed in hadoop-streaming. |
| {color:red}-1{color} | hdfs tests |   3m 18s | Tests failed in hadoop-hdfs-httpfs. |
| | |  84m 26s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.fs.http.client.TestHttpFSWithHttpFSFileSystem |
|   | hadoop.fs.http.client.TestHttpFSFWithSWebhdfsFileSystem |
|   | hadoop.fs.http.client.TestHttpFSFWithWebhdfsFileSystem |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12732940/HADOOP-11969.3.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / 15ccd96 |
| whitespace | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/whitespace.txt |
| hadoop-common test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/testrun_hadoop-common.txt |
| hadoop-kms test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/testrun_hadoop-kms.txt |
| hadoop-mapreduce-client-core test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/testrun_hadoop-mapreduce-client-core.txt |
| hadoop-distcp test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/testrun_hadoop-distcp.txt |
| hadoop-streaming test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/testrun_hadoop-streaming.txt |
| hadoop-hdfs-httpfs test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/artifact/patchprocess/testrun_hadoop-hdfs-httpfs.txt |
| Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf902.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6694/console |


This message was automatically generated., -04
  * fixes whitespace (which was adjacent to an added line.), \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |  14m 39s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 3 new or modified test files. |
| {color:green}+1{color} | javac |   7m 33s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |   9m 36s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 23s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   3m 31s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 35s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   5m 23s | The patch does not introduce any new Findbugs (version 2.0.3) warnings. |
| {color:green}+1{color} | common tests |  23m 44s | Tests passed in hadoop-common. |
| {color:green}+1{color} | common tests |   1m 37s | Tests passed in hadoop-kms. |
| {color:green}+1{color} | mapreduce tests |   1m 34s | Tests passed in hadoop-mapreduce-client-core. |
| {color:green}+1{color} | tools/hadoop tests |   6m  6s | Tests passed in hadoop-distcp. |
| {color:green}+1{color} | tools/hadoop tests |   6m  9s | Tests passed in hadoop-streaming. |
| {color:red}-1{color} | hdfs tests |   3m 19s | Tests failed in hadoop-hdfs-httpfs. |
| | |  85m 48s | |
\\
\\
|| Reason || Tests ||
| Failed unit tests | hadoop.fs.http.client.TestHttpFSWithHttpFSFileSystem |
|   | hadoop.fs.http.client.TestHttpFSFWithWebhdfsFileSystem |
|   | hadoop.fs.http.client.TestHttpFSFWithSWebhdfsFileSystem |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12732990/HADOOP-11969.4.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / 53fe4ef |
| hadoop-common test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/artifact/patchprocess/testrun_hadoop-common.txt |
| hadoop-kms test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/artifact/patchprocess/testrun_hadoop-kms.txt |
| hadoop-mapreduce-client-core test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/artifact/patchprocess/testrun_hadoop-mapreduce-client-core.txt |
| hadoop-distcp test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/artifact/patchprocess/testrun_hadoop-distcp.txt |
| hadoop-streaming test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/artifact/patchprocess/testrun_hadoop-streaming.txt |
| hadoop-hdfs-httpfs test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/artifact/patchprocess/testrun_hadoop-hdfs-httpfs.txt |
| Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf901.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6697/console |


This message was automatically generated., those three tests all fail on trunk for me without this patch., reopened HDFS-8332, which git bisect says is the cause of the test failures above., toggling back to patch available since the failures are not related (and fixed by HDFS-8412), +1.  Test failures appear to be unrelated., This probably needs to be rebased after HADOOP-11970, cancel patch to rebase., -05
  * rebase to current trunk, \\
\\
| (/) *{color:green}+1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:blue}0{color} | pre-patch |  14m 41s | Pre-patch trunk compilation is healthy. |
| {color:green}+1{color} | @author |   0m  0s | The patch does not contain any @author tags. |
| {color:green}+1{color} | tests included |   0m  0s | The patch appears to include 3 new or modified test files. |
| {color:green}+1{color} | javac |   7m 31s | There were no new javac warning messages. |
| {color:green}+1{color} | javadoc |   9m 41s | There were no new javadoc warning messages. |
| {color:green}+1{color} | release audit |   0m 21s | The applied patch does not increase the total number of release audit warnings. |
| {color:green}+1{color} | checkstyle |   3m 33s | There were no new checkstyle issues. |
| {color:green}+1{color} | whitespace |   0m  1s | The patch has no lines that end in whitespace. |
| {color:green}+1{color} | install |   1m 34s | mvn install still works. |
| {color:green}+1{color} | eclipse:eclipse |   0m 33s | The patch built with eclipse:eclipse. |
| {color:green}+1{color} | findbugs |   5m 29s | The patch does not introduce any new Findbugs (version 3.0.0) warnings. |
| {color:green}+1{color} | common tests |  23m 31s | Tests passed in hadoop-common. |
| {color:green}+1{color} | common tests |   1m 38s | Tests passed in hadoop-kms. |
| {color:green}+1{color} | mapreduce tests |   1m 40s | Tests passed in hadoop-mapreduce-client-core. |
| {color:green}+1{color} | tools/hadoop tests |   6m  2s | Tests passed in hadoop-distcp. |
| {color:green}+1{color} | tools/hadoop tests |   6m  8s | Tests passed in hadoop-streaming. |
| {color:green}+1{color} | hdfs tests |   3m 37s | Tests passed in hadoop-hdfs-httpfs. |
| | |  86m  5s | |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12733905/HADOOP-11969.5.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / fd3cb53 |
| hadoop-common test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/artifact/patchprocess/testrun_hadoop-common.txt |
| hadoop-kms test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/artifact/patchprocess/testrun_hadoop-kms.txt |
| hadoop-mapreduce-client-core test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/artifact/patchprocess/testrun_hadoop-mapreduce-client-core.txt |
| hadoop-distcp test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/artifact/patchprocess/testrun_hadoop-distcp.txt |
| hadoop-streaming test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/artifact/patchprocess/testrun_hadoop-streaming.txt |
| hadoop-hdfs-httpfs test log | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/artifact/patchprocess/testrun_hadoop-hdfs-httpfs.txt |
| Test Results | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/testReport/ |
| Java | 1.7.0_55 |
| uname | Linux asf909.gq1.ygridcore.net 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6743/console |


This message was automatically generated., Thanks for rebasing, [~busbey].  +1 once more, will commit shortly, FAILURE: Integrated in Hadoop-trunk-Commit #7905 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/7905/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
, SUCCESS: Integrated in Hadoop-Yarn-trunk-Java8 #209 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/209/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
, FAILURE: Integrated in Hadoop-Yarn-trunk #940 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/940/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #208 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/208/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk #2138 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2138/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
, FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #198 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/198/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
, FAILURE: Integrated in Hadoop-Mapreduce-trunk #2156 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2156/])
HADOOP-11969. ThreadLocal initialization in several classes is not thread safe (Sean Busbey via Colin P. McCabe) (cmccabe: rev 7dba7005b79994106321b0f86bc8f4ea51a3c185)
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableInput.java
* hadoop-common-project/hadoop-kms/src/main/java/org/apache/hadoop/crypto/key/kms/server/KMSMDCFilter.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/lib/servlet/ServerWebApp.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesOutput.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/ShuffleSchedulerImpl.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestJettyHelper.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesWritableOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordInput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/Text.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/pipes/PipesPartitioner.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesInput.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/MD5Hash.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestHdfsHelper.java
* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapred/lib/Chain.java
* hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/util/DistCpUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordOutput.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/record/BinaryRecordInput.java
* hadoop-hdfs-project/hadoop-hdfs-httpfs/src/test/java/org/apache/hadoop/test/TestDirHelper.java
* hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/ReflectionUtils.java
* hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/typedbytes/TypedBytesRecordOutput.java
, could we get this backported to 2.6/2.7?, [~busbey], out of curiosity, when you saw this issue, what was the JVM and its version? Did you see this with more than one type/version of the JVM?, This was long enough ago that I do not know. I'll poke about and see if I happen to have more notes somewhere. Just on odds, I'd guess an Oracle JVM but no clue on a specific version., I also added a comment on HDFS-10183.

I believe that JLS makes it clear that a memory barrier is required for the static initialization (by the JVM) and is expected from the user standpoint. This is something we should be able to rely on safely, or we have a bigger problem. And I don't think there is anything special about {{ThreadLocal}}.

I think it is a good idea to make these static variables final for a semantic reason and possibly to work around a JVM bug. However, for the record, we should be able to rely on any initial values of (non-final) static fields in general.]