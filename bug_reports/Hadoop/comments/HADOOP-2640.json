[This patch fixes the issue, by changing int partialLength to long and float's to int. , I'm marking this to be included 0.17, since feature freeze is today, and there are lots of patches in the review queue. We can merge it back to 0.16.1 and 0.15.4 if they are to be released. , +1 overall.  Here are the results of testing the latest attachment 
http://issues.apache.org/jira/secure/attachment/12373503/multi_long_v1.patch
against trunk revision r613359.

    @author +1.  The patch does not contain any @author tags.

    javadoc +1.  The javadoc tool did not generate any warning messages.

    javac +1.  The applied patch does not generate any new compiler warnings.

    findbugs +1.  The patch does not introduce any new Findbugs warnings.

    core tests +1.  The patch passed core unit tests.

    contrib tests +1.  The patch passed contrib unit tests.

Test results: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1649/testReport/
Findbugs warnings: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1649/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1649/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1649/console

This message is automatically generated., +1 This bugfix should go into 0.16.1, and perhaps even 0.16.0., Ok, I am marking this somewhat embarrassing issue blocker, and hence to be included in 0.16. Committers, please leave a comment if you don't think that this is a blocker. , I just committed this.  Thanks Enis!, Integrated in Hadoop-trunk #380 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/380/])]