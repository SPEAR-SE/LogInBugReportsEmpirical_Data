[Consolidated patch to backport both changes., +1 for the patch. Thanks for porting the two patches., I committed the patch to branch-1 and branch-1.2., Thanks Suresh!, Closed upon release of Hadoop 1.2.0.]