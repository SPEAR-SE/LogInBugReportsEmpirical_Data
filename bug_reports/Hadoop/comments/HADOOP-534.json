[Here is the patch., This looks like the patch for HADOOP-530, not for this issue., Attached the wrong patch. Sorry., I committed this on Friday.  Thanks, Hairong!]