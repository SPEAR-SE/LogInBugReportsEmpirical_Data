[I am not sure if it is related but take a loot at YARN-1203 (http / https) where now we are forcing AM to tell up front which scheme is supported and Yarn will use it for communication or else it will default to cluster default. I think something similar can be done here as well., Hey Lohit,

Why not use the default FS config parameter (fs.default.name) instead of using fully-qualified URLs? Then you just need to change the client config when switching clusters., Lohit, I can see why just changing the default FS parameter isn't enough -if you want to support inputs across clusters then you may need explicit source and dest URLs. Though if your code is using hdfs://// that's a very much "default" reference that is deprecated in 2.x (what if the default FS isn't HDFS?)

did you try just subverting `hdfs.fs.impl` to point to the viewfs implementation, or didn't that work due to viewfs being fussy about the URIs and/or you also wanting to use HDFS locally?

Otherwise, the general best practise is "don't have hard code URIs in your scripts", though that is easier said than done if you have a lot of existing scripts.

Can you stick up your new FS for us to look at? ]