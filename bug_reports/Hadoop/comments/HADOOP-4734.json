[4734_20081126.patch: retrieved codes from HADOOP-1700 and HADOOP-4257 for 0.18.  Will check lease recovery in 0.18., Since almost the entire patch in HADOOP-4257 should be committed to 0.18, I will re-open HADOOP-4257, instead of fixing here., 4734_20081202.patch: validate block metadata in datanode.  These codes from HADOOP-1700 should go to 0.18., +1. This looks good.

One suggestion is that DataNode should not only validate the meta information but also the integrity of block content before participating in a recovery process.  , > One suggestion is that DataNode should not only validate the meta information but also the integrity of block content before participating in a recovery process.

Created HADOOP-4769.

Thanks, Hairong., Tested the patch locally.  I just committed this to 0.18 only.]