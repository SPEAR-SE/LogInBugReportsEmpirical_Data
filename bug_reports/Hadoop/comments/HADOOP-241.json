[First bug was in the test iself, which was using string instead of Path to construct a path. That was fixed. The second bug was that when Namenode was made to stop from MiniDFSCluster, it was correctly closing FSNamesystem, but it was not closing the FSDirectory. As a result the editlog was never getting closed. On Windows, when it was trying to create the MiniDFSCluster again, it could not format the namedir because the editlog was still not closed. Fixed it., I just committed this.  Thanks, Milind.]