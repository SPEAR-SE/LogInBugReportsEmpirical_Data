[Same as HDFS-6972, which Yongjun has submitted a patch for?]