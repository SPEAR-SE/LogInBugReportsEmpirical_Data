[Occasionally the test will fail with the following exception.
{code}
java.lang.AssertionError: expected:<0> but was:<2>
	at org.junit.Assert.fail(Assert.java:93)
	at org.junit.Assert.failNotEquals(Assert.java:647)
	at org.junit.Assert.assertEquals(Assert.java:128)
	at org.junit.Assert.assertEquals(Assert.java:472)
	at org.junit.Assert.assertEquals(Assert.java:456)
	at org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl.testMultiThreadedPublish(TestMetricsSystemImpl.java:232)
{code}

At other times the exception looks as follows:
{code}
testMultiThreadedPublish(org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl)  Time elapsed: 0.468 sec  <<< FAILURE!
java.lang.AssertionError: Metric not collected!
Passed
Passed
Passed
Passed
Passed
Passed
Passed
Passed
Passed
        at org.junit.Assert.fail(Assert.java:93)
        at org.junit.Assert.assertTrue(Assert.java:43)
        at org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl.testMultiThreadedPublish(TestMetricsSystemImpl.java:233)
{code}

Log message showing dropped events:
{code}
2014-03-12 21:08:17,236 WARN  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:putMetricsImmediate(107)) - Collector has a full queue and can't consume the given metrics.
2014-03-12 21:08:17,237 WARN  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:putMetricsImmediate(107)) - Collector has a full queue and can't consume the given metrics.
{code}, The test failure is reported by HADOOP-10062.]