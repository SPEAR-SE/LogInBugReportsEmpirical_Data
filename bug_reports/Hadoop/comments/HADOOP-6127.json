[How can you get the "real" username without being subject to spoofing? It seems to me that the user can always play LD_PRELOAD tricks so that the call out to "whoami" goes to "evil-whoami.sh". Without something like identd or real token-based authentication I don't know that it's really possible to add any security here., This isn't about making it secure. It is just about removing the ability to spoof from the command line interface to Hadoop. Even after this change, it is still easy to spoof without getting to LD_PRELOAD. Of course to get to real security, you need authentication via Kerberos or something similar., Came across this old JIRA. It's been addressed by the "real" security on trunk.]