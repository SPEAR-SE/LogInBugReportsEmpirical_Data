[Here is the patch., I am unable to apply this patch:

% patch -p 0 < ~/Desktop/fs_close.patch
patching file src/java/org/apache/hadoop/fs/FileSystem.java
patching file src/java/org/apache/hadoop/dfs/DistributedFileSystem.java
patching file src/java/org/apache/hadoop/fs/LocalFileSystem.java
patching file src/test/org/apache/hadoop/fs/TestCopyFiles.java
patch: **** malformed patch at line 51: @@ -171,12 +171,10 @@

Does it work for you?  Thanks!, Hope this one works., FileSystem.close(String) should not be called by anything other than an implementation, so it should be protected instead of public.  Alternately, one could change FileSystem.close() to call NAME_TO_FS.remove(getName()), then just add a call to super.close() in the implementations (and document that all FileSystem implementations should do this)., Doug, thanks for the comment. The attached patch takes the 2nd approach that you suggested., I just committed this.  Thanks, Hairong.]