[This is 0.19.1 version of HADOOP-4997., 0.19 version of HADOOP-4997 attached with out any changes other than corrections to comments. test-core passes on 0.19.
, ant test-patch :

  {noformat}
     [exec] +1 overall.

     [exec]     +1 @author.  The patch does not contain any @author tags.

     [exec]     +1 tests included.  The patch appears to include 6 new or modified tests.

     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.

     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.
{noformat}, I just committed this to 0.19 (only).]