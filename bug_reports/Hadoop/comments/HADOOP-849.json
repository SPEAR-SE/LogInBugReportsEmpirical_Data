[This patch fixes the problem. The merge code that opens map output files for reading used to never close the empty map output files (empty means that the sequence files contains just the sequence file header without any key/val data). For the RandomWriter case, this problem shows up as OutOfMemory, which basically means that the program is out of file descriptors after merging 100s of empty map output files (in the case of RandomWriter, all map outputs are empty; the data is written directly to the dfs)., +1, because http://issues.apache.org/jira/secure/attachment/12347969/849.patch applied and successfully tested against trunk revision r489707., +1, How critical is this bug fix? It doesn't really require another 9.x bug fix release does it?, The bug fix will be critical for cases where empty map outputs are generated. RandomWriter is one instance of that but, in general, I think that's not the usual case., I have experienced this problem when trying to debug a mapred application - it was very difficult to figure out what was wrong, because this error was obscuring the real reason (which was a bug in my Mapper class).

Also, speaking with my Nutch hat on, if there are plans for substantial API changes in trunk/ it would be good to have a bugfix release, which is still API compatible, and which Nutch could use - there have been tons of fixes since 0.9.2 ..., I just committed this.  Thanks, Devaraj!]