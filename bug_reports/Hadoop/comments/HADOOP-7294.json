[Vitalli,

AFAIK, most of the shell calls were written with Linux in mind, and that platform is what we recommend to use as well (so far). Would you have a solution that would work on all platforms for this? A patch would be great as well, but just tips otherwise would be nice too!, Actually there is support for Windows and Mac in the code, so the thing to be changed is to rename Mac to BSD and treat FreeBSD as BSD. In general, I'd prefer it to be configurable., In general, we try to follow BSD semantics (http://hadoop.apache.org/hdfs/docs/r0.21.0/hdfs_permissions_guide.html)., This is patch for 0.21 release. I did a branch in my own svn, so revisions are off., -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12483262/patch.diff
  against trunk revision 1137724.

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/661//console

This message is automatically generated., Canceling the patch as it is rather old.  If you still want this patch to go in you are going to also need a patch that supports trunk, eventually. , Here is trunk commit from https://github.com/apache/hadoop-common/pull/2, Here is trunk patch from  https://github.com/apache/hadoop-common/pull/2, I've just committed a potentially conflict MAC specific patch to this file, HADOOP-7680, which hard codes in {{/usr/bin/stat}} as the path for stat.

Vitalli, can we be confident that this path will always be the location of stat in BSD unix?

It may be safer to have an explicit BSD case that is separate from the rest. 

We'll also need to retain the OS_TYPE_MAC enum for compatibility. There's no use of it in hadoop common/hdfs/mapreduce other than the {{HardLink}} file, but that doesn't mean others don't use it.

The options then
# Add a new OS enum for BSD, give it its own command (I prefer this)
# Add a new OS enum for BSD, share the action with the MAC option
# when BSD is found, just say its OS_TYPE_MAC even though it is the other way around

I prefer the first, -1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12512729/7294-trunk.patch
  against trunk revision .

    +1 @author.  The patch does not contain any @author tags.

    -1 tests included.  The patch doesn't appear to include any new or modified tests.
                        Please justify why no new tests are needed for this patch.
                        Also please list what manual steps were performed to verify this patch.

    -1 patch.  The patch command could not apply the patch.

Console output: https://builds.apache.org/job/PreCommit-HADOOP-Build/767//console

This message is automatically generated., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | patch |   0m  0s | The patch command could not apply the patch during dryrun. |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12512729/7294-trunk.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / f1a152c |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6250/console |


This message was automatically generated., \\
\\
| (x) *{color:red}-1 overall{color}* |
\\
\\
|| Vote || Subsystem || Runtime || Comment ||
| {color:red}-1{color} | patch |   0m  0s | The patch command could not apply the patch during dryrun. |
\\
\\
|| Subsystem || Report/Notes ||
| Patch URL | http://issues.apache.org/jira/secure/attachment/12512729/7294-trunk.patch |
| Optional Tests | javadoc javac unit findbugs checkstyle |
| git revision | trunk / f1a152c |
| Console output | https://builds.apache.org/job/PreCommit-HADOOP-Build/6254/console |


This message was automatically generated., This issue is resolved by HADOOP-8811

Current code to get stat command is checking for FreeBSD:

{code}
      if (Shell.MAC || Shell.FREEBSD) {
        String[] linkCountCmdTemplate = {"/usr/bin/stat","-f%l", null};
        HardLinkCGUnix.setLinkCountCmdTemplate(linkCountCmdTemplate);
      }
{code}

Closing this issue as duplicate of HADOOP-8811
]