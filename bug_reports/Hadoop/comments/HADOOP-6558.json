[Looks like this might be a problem with distcp whcih requires the src and dest to be the same filesystem?, No.  Distcp works if src and dest are in different filesystem schemes.

I briefly checked the codes.  It seems that harfs.listPath("har://hdfs-nn_hostname:8020/user/tsz/t101.har/t101") returns file statuses with hdfs://, e.g. hdfs://hostname:8020/user/tsz/t101.har/t101/file1.
, good catch..... ill fix that... , Took a closer look: HarFileSystem extends FilterFileSystem and it uses the underlying file system to get file checksum.  That's why we got Wrong FS since HarFileSystem passes a har:// path to the underlying fs.getFileChecksum(..).  In our case, the underlying fs is hdfs.
, Moved this from MapReduce to Common since it is a fs issue., c6558_20100216.patch: returns null in HarFileSystem.getFileChecksum(..), I will add a test once HADOOP-6560 is committed., c6558_20100216b.patch: added a test., +1 overall.  Here are the results of testing the latest attachment 
  http://issues.apache.org/jira/secure/attachment/12436084/c6558_20100216b.patch
  against trunk revision 910741.

    +1 @author.  The patch does not contain any @author tags.

    +1 tests included.  The patch appears to include 3 new or modified tests.

    +1 javadoc.  The javadoc tool did not generate any warning messages.

    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.

    +1 findbugs.  The patch does not introduce any new Findbugs warnings.

    +1 release audit.  The applied patch does not increase the total number of release audit warnings.

    +1 core tests.  The patch passed core unit tests.

    +1 contrib tests.  The patch passed contrib unit tests.

Test results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/9/testReport/
Findbugs warnings: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/9/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html
Checkstyle results: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/9/artifact/trunk/build/test/checkstyle-errors.html
Console output: http://hudson.zones.apache.org/hudson/job/Hadoop-Patch-h1.grid.sp2.yahoo.net/9/console

This message is automatically generated., Manually tested the patch with "distcp -update" as shown in the description. It worked fine.
{noformat}
-bash-3.1$ $H distcp ${Q} -update ${HAR_FULL}/${DIR} ${DIR}
10/02/17 21:29:36 INFO tools.DistCp: srcPaths=[har://hdfs-nn:8020/user/tsz/t20.har/t20]
10/02/17 21:29:36 INFO tools.DistCp: destPath=t20
10/02/17 21:29:37 INFO tools.DistCp: sourcePathsCount=21
10/02/17 21:29:37 INFO tools.DistCp: filesToCopyCount=0
10/02/17 21:29:37 INFO tools.DistCp: bytesToCopyCount=0.0
{noformat}, +1 ... the patch looks good... , Thanks Mahadev for reviewing it.

I have committed this., c6558_20100216b_y0.20.patch: for y0.20, Integrated in Hadoop-Common-trunk-Commit #175 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk-Commit/175/])
    . Return null in HarFileSystem.getFileChecksum(..) since no checksum algorithm is implemented.
, Integrated in Hadoop-Common-trunk #255 (See [http://hudson.zones.apache.org/hudson/job/Hadoop-Common-trunk/255/])
    ]