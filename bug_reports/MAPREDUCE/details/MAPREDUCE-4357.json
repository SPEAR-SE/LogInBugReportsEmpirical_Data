{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12595321","self":"https://issues.apache.org/jira/rest/api/2/issue/12595321","key":"MAPREDUCE-4357","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-06-21T13:25:47.260+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Oct 14 01:56:09 UTC 2017","customfield_12310420":"253848","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4357/watchers","watchCount":11,"isWatching":false},"created":"2012-06-20T18:48:52.687+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12320354","id":"12320354","description":"hadoop-2.0.0-alpha release","name":"2.0.0-alpha","archived":false,"released":true,"releaseDate":"2012-05-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2017-10-14T01:56:09.698+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"# sudo -u hdfs hadoop jar /usr/lib/hadoop-mapreduce/hadoop-mapreduce-client-jobclient-2.0.0-cdh4.0.0-tests.jar TestDFSIO -write\n12/06/01 18:17:11 INFO fs.TestDFSIO: TestDFSIO.0.0.6\n12/06/01 18:17:11 INFO fs.TestDFSIO: nrFiles = 1\n12/06/01 18:17:11 INFO fs.TestDFSIO: fileSize (MB) = 1.0\n12/06/01 18:17:11 INFO fs.TestDFSIO: bufferSize = 1000000\n12/06/01 18:17:11 INFO fs.TestDFSIO: baseDir = /benchmarks/TestDFSIO\n12/06/01 18:17:11 INFO fs.TestDFSIO: creating control file: 1048576 bytes, 1 files\n12/06/01 18:17:12 INFO fs.TestDFSIO: created control files for: 1 files\n12/06/01 18:17:12 INFO mapred.FileInputFormat: Total input paths to process : 1\n12/06/01 18:17:12 INFO mapreduce.JobSubmitter: number of splits:1\n12/06/01 18:17:12 WARN conf.Configuration: mapred.jar is deprecated. Instead, use mapreduce.job.jar\n12/06/01 18:17:12 WARN conf.Configuration: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces\n12/06/01 18:17:12 WARN conf.Configuration: mapred.output.value.class is deprecated. Instead, use mapreduce.job.output.value.class\n12/06/01 18:17:12 WARN conf.Configuration: mapred.job.name is deprecated. Instead, use mapreduce.job.name\n12/06/01 18:17:12 WARN conf.Configuration: mapred.input.dir is deprecated. Instead, use mapreduce.input.fileinputformat.inputdir\n12/06/01 18:17:12 WARN conf.Configuration: mapred.output.dir is deprecated. Instead, use mapreduce.output.fileoutputformat.outputdir\n12/06/01 18:17:12 WARN conf.Configuration: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps\n12/06/01 18:17:12 WARN conf.Configuration: mapred.output.key.class is deprecated. Instead, use mapreduce.job.output.key.class\n12/06/01 18:17:12 WARN conf.Configuration: mapred.working.dir is deprecated. Instead, use mapreduce.job.working.dir\n12/06/01 18:17:12 INFO mapred.ResourceMgrDelegate: Submitted application application_1338599410922_0004 to ResourceManager at /0.0.0.0:8032\n12/06/01 18:17:12 INFO mapreduce.Job: The url to track the job: http://localhost:8088/proxy/application_1338599410922_0004/\n12/06/01 18:17:12 INFO mapreduce.Job: Running job: job_1338599410922_0004\n12/06/01 18:17:17 INFO mapreduce.Job: Job job_1338599410922_0004 running in uber mode : true\n12/06/01 18:17:17 INFO mapreduce.Job: map 0% reduce 0%\n12/06/01 18:17:17 INFO mapreduce.Job: Job job_1338599410922_0004 failed with state FAILED due to: \n12/06/01 18:17:17 INFO mapreduce.Job: Counters: 11\nJob Counters \nFailed map tasks=1\nFailed reduce tasks=1\nLaunched map tasks=1\nLaunched reduce tasks=1\nOther local map tasks=1\nTotal time spent by all maps in occupied slots (ms)=2456\nTotal time spent by all reduces in occupied slots (ms)=136\nTOTAL_LAUNCHED_UBERTASKS=2\nNUM_UBER_SUBMAPS=1\nNUM_UBER_SUBREDUCES=1\nNUM_FAILED_UBERTASKS=2\njava.io.IOException: Job failed!\nat org.apache.hadoop.mapred.JobClient.runJob(JobClient.java:883)\nat org.apache.hadoop.fs.TestDFSIO.runIOTest(TestDFSIO.java:340)\nat org.apache.hadoop.fs.TestDFSIO.writeTest(TestDFSIO.java:321)\nat org.apache.hadoop.fs.TestDFSIO.run(TestDFSIO.java:520)\nat org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)\nat org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:84)\nat org.apache.hadoop.fs.TestDFSIO.main(TestDFSIO.java:445)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:72)\nat org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:144)\nat org.apache.hadoop.test.MapredTestDriver.run(MapredTestDriver.java:112)\nat org.apache.hadoop.test.MapredTestDriver.main(MapredTestDriver.java:120)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat org.apache.hadoop.util.RunJar.main(RunJar.java:208)\n\nAttaching my mapred-site.xml as well.\nI have snappy compression enabled but I never see it get loaded in the logs.\n\ncat /etc/hadoop/conf.pseudo/mapred-site.xml \n<?xml version=\"1.0\"?>\n<!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements. See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License. You may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n-->\n<?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?>\n\n<configuration>\n<property>\n<name>mapred.job.tracker</name>\n<value>localhost:8021</value>\n</property>\n\n<property>\n<name>mapreduce.framework.name</name>\n<value>yarn</value>\n</property>\n\n<property>\n<description>To set the value of tmp directory for map and reduce tasks.</description>\n<name>mapreduce.task.tmp.dir</name>\n<value>/var/lib/hadoop-mapreduce/cache/${user.name}/tasks</value>\n</property>\n\n<property>\n<name>mapreduce.job.ubertask.enable</name>\n<value>true</value>\n<description>Run very small jobs in a single JVM</description>\n</property>\n\n<property>\n<name>mapreduce.map.output.compress</name>\n<value>true</value>\n<description>Should the outputs of the maps be compressed before being sent\nacross the network.\n</description>\n</property>\n\n<!-- This is set since the disks were not really being stressed much, but\nCPUs are. If this is generating too much disk I/O, it can be set back to\nDefaultCodec (deflate) -->\n<property>\n<name>mapreduce.map.output.compress.codec</name>\n<value>org.apache.hadoop.io.compress.SnappyCodec</value>\n</property>\n</configuration>\n\nin non uber mode it works fine\n\nsudo -u hdfs hadoop jar /usr/lib/hadoop-mapreduce/hadoop-mapreduce-client-jobclient-2.0.0-cdh4.0.0-tests.jar TestDFSIO -Dmapreduce.job.ubertask.enable=false -write\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"80674","customfield_12312823":null,"summary":"Snappy Codec does not load properly when m/r job is run in \"uber\" mode","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlord","name":"jlord","key":"jlord","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeff Lord","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlord","name":"jlord","key":"jlord","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeff Lord","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595321/comment/13398414","id":"13398414","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"I believe this is cause the MR AM never really starts with the jobConf default of \"mapred.child.env\" that has LD_LIBRARY_PATH set to the right native lib area. Without that, I don't think the AM container really gets the proper native paths on its runtime?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-06-21T13:25:47.260+0000","updated":"2012-06-21T13:25:47.260+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595321/comment/13398718","id":"13398718","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"Or well the reason I say that is the AMLauncher does not seem to be populating a LD_LIBRARY_PATH for natives, pre-launch. But I see NM launching with a proper java.library.path at least (no LD_LIBRARY_PATH though), but unsure if that is inflicted automatically onto the AM env?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-06-21T18:35:55.175+0000","updated":"2012-06-21T18:35:55.175+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595321/comment/16204421","id":"16204421","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joey_krabacher","name":"joey_krabacher","key":"joey_krabacher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=joey_krabacher&avatarId=27059","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=joey_krabacher&avatarId=27059","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=joey_krabacher&avatarId=27059","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=joey_krabacher&avatarId=27059"},"displayName":"Joey Krabacher","active":true,"timeZone":"America/Chicago"},"body":"Possibly related to MAPREDUCE-5799, still an issue in 2.6. I am planning on digging into this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joey_krabacher","name":"joey_krabacher","key":"joey_krabacher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=joey_krabacher&avatarId=27059","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=joey_krabacher&avatarId=27059","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=joey_krabacher&avatarId=27059","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=joey_krabacher&avatarId=27059"},"displayName":"Joey Krabacher","active":true,"timeZone":"America/Chicago"},"created":"2017-10-14T01:56:09.698+0000","updated":"2017-10-14T01:56:09.698+0000"}],"maxResults":3,"total":3,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4357/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0e5mn:"}}