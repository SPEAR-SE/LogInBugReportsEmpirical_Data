{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12546563","self":"https://issues.apache.org/jira/rest/api/2/issue/12546563","key":"MAPREDUCE-4013","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2012-03-15T14:35:59.133+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Sep 28 21:10:30 UTC 2015","customfield_12310420":"231721","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1004747512_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-03-27T01:37:28.493+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4013/watchers","watchCount":6,"isWatching":false},"created":"2012-03-15T10:31:41.111+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"labels":["shuffle"],"customfield_12312333":null,"customfield_12310230":"reduce mrv2 shuffle ","customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319851","id":"12319851","description":"0.23.2","name":"0.23.2","archived":true,"released":false}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-09-28T21:10:30.041+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12314301","id":"12314301","name":"mrv2","description":"MR-279: Map Reduce Next."}],"timeoriginalestimate":null,"description":"When a M/R job is configured to run with some tolerance to task failures (via mapreduce.map.failures.maxpercent), then the reduce task of that job gets stuck in the shuffle phase. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12518885","id":"12518885","filename":"MAPREDUCE-4013.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-03-19T10:48:43.219+0000","size":833,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12518885/MAPREDUCE-4013.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"112785","customfield_12312823":null,"summary":"Reduce task gets stuck when a M/R job is configured to tolerate failures","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amar_kamat","name":"amar_kamat","key":"amar_kamat","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amar Kamat","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amar_kamat","name":"amar_kamat","key":"amar_kamat","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amar Kamat","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13230047","id":"13230047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amar_kamat","name":"amar_kamat","key":"amar_kamat","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amar Kamat","active":true,"timeZone":"Etc/UTC"},"body":"BTW, the job has some failed map tasks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amar_kamat","name":"amar_kamat","key":"amar_kamat","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amar Kamat","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-15T10:32:33.220+0000","updated":"2012-03-15T10:32:33.220+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13230200","id":"13230200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"body":"I *think*, the following could be the reason\n\nWe are initializing remainingMaps as totalMaps. But if we configure *mapreduce.map.failures.maxpercent* as some non zero value, job will proceed to run even some maps fail (configured %). However, decrementing count of remainingMaps, only when the map output copy is sucessful. But even if a single map fails, it will not be copied and so remainingMaps will be non zero always. \n\n{code:title=ShuffleScheduler.java|borderStyle=solid}\n if (--remainingMaps == 0) {\n        notifyAll();\n }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-03-15T14:35:59.133+0000","updated":"2012-03-15T14:35:59.133+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13232544","id":"13232544","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"body":"Shuffle phase hangs,as long as *remainingMaps > 0*. We are decrementing the count of *remainingMaps* only when the copy phase is sucessful.But for the failedmaps, we are not decrementing *remainingMaps* count. We should decrement it. Attaching the patch for the same.\n\nTested the patch by setting *mapreduce.map.failures.maxpercent* value as 2. Ran a job having 104 map tasks and failed 2 map tasks. Job is till passing.\n\nPlease look into the patch and provide your comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-03-19T10:48:43.318+0000","updated":"2012-03-19T10:48:43.318+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13238277","id":"13238277","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ravidotg","name":"ravidotg","key":"ravidotg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ravi Gummadi","active":true,"timeZone":"Etc/UTC"},"body":"Patch looks fine to me.\nOne minor comment:\nWhat about the \"progress of map tasks\" when there are failed-maps ? Is it getting updated to 100% ? I see copySucceded() is updating the progress of map-tasks. So what happens when the last few maps fail ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ravidotg","name":"ravidotg","key":"ravidotg","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ravi Gummadi","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-26T11:17:52.146+0000","updated":"2012-03-26T11:17:52.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13238625","id":"13238625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj.k","name":"devaraj.k","key":"devaraj.k","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj K","active":true,"timeZone":"America/Los_Angeles"},"body":"Seems dup of MAPREDUCE-3927.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj.k","name":"devaraj.k","key":"devaraj.k","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj K","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-03-26T17:53:58.197+0000","updated":"2012-03-26T17:53:58.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13239107","id":"13239107","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amar_kamat","name":"amar_kamat","key":"amar_kamat","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amar Kamat","active":true,"timeZone":"Etc/UTC"},"body":"Duplicate of MAPREDUCE-3927.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=amar_kamat","name":"amar_kamat","key":"amar_kamat","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amar Kamat","active":true,"timeZone":"Etc/UTC"},"created":"2012-03-27T01:37:28.576+0000","updated":"2012-03-27T01:37:28.576+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/13239260","id":"13239260","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks Ravi for taking a look into the patch\n\nbq.What about the \"progress of map tasks\" when there are failed-maps ? Is it getting updated to 100% ? I see copySucceded() is updating the progress of map-tasks. So what happens when the last few maps fail ?\n\nSuppose say a user has configured *mapreduce.map.failures.maxpercent* as 2, so job can tolerate upto  2% of map tasks failures. \nAs \"progress of map tasks\" indicates percentage of the sucessful completion of map tasks, I *think* showing the actual *progress* may be more useful than showing 100%. \ni.e. if \"progress of map tasks\" indicates 99%, by this, atleast it gives an idea that 1% of map tasks have been failed and consequently may take action on that failed map tasks.\n\nOTOH, if \"progress of map tasks\" should indicate the overall progress of the map phase, then patch needs to be updated to reflect the same.\n\nAs this has been duplicated, we can have our further discussion at [MAPREDUCE-3927|https://issues.apache.org/jira/browse/MAPREDUCE-3927]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kam_iitkgp","name":"kam_iitkgp","key":"kam_iitkgp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bhallamudi Venkata Siva Kamesh","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-03-27T06:52:06.389+0000","updated":"2012-03-27T06:52:06.389+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546563/comment/14934021","id":"14934021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"body":"Dropping fix-version from 'non-fixed' (didn't have code-fixes) JIRAs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinodkv","name":"vinodkv","key":"vinodkv","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vinod Kumar Vavilapalli","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-09-28T21:10:30.023+0000","updated":"2015-09-28T21:10:30.023+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4013/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0jnsn:"}}