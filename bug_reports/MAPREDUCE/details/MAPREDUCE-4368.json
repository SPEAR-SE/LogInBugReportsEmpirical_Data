{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12595849","self":"https://issues.apache.org/jira/rest/api/2/issue/12595849","key":"MAPREDUCE-4368","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321744","id":"12321744","description":"hadoop-1.x for MS Windows ","name":"1-win","archived":true,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-06-26T01:52:56.996+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Thu Jul 05 07:15:42 UTC 2012","customfield_12310420":"247454","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_91872088_*|*_1_*:*_2_*:*_712245041_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2012-07-05T07:15:42.265+0000","workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4368/watchers","watchCount":5,"isWatching":false},"created":"2012-06-25T23:53:45.191+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["newbie","patch"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":86400,"aggregatetimeoriginalestimate":86400,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321744","id":"12321744","description":"hadoop-1.x for MS Windows ","name":"1-win","archived":true,"released":false}],"issuelinks":[{"id":"12353990","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12353990","type":{"id":"12310010","name":"Incorporates","inward":"is part of","outward":"incorporates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"},"inwardIssue":{"id":"12542808","key":"HADOOP-8079","self":"https://issues.apache.org/jira/rest/api/2/issue/12542808","fields":{"summary":"Proposal for enhancements to Hadoop for Windows Server and Windows Azure development and runtime environments","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-07-05T07:15:42.312+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312906","id":"12312906","name":"tasktracker"}],"timeoriginalestimate":86400,"description":"TaskRunner splits arguments by space before it adds them back to the vargs list, so it loses all context of quote escaped strings with embedded spaces.  This gets fixed up later by wrapping all arguments with \" -- so you get something like java \"-D<opt>=<value>\".  This is problematic for paths with embedded spaces, where we end up creating \"-D<opt>=<first part\" \"last part>\".  To java, the jar being run is last part.  So with the environment above, you will see \"ClassNoDefFoundError: memorable\" and the jar will fail to start.  In this particular case, we know that java.libarary.path contains paths and the tests often use %PATH% to seed this, so the fix is to remove embedded quotes in listed path elements because we know the aggregate will be quoted when the JVM is started.","customfield_10010":null,"timetracking":{"originalEstimate":"24h","remainingEstimate":"24h","originalEstimateSeconds":86400,"remainingEstimateSeconds":86400},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321744","id":"12321744","description":"hadoop-1.x for MS Windows ","name":"1-win","archived":true,"released":false}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12533576","id":"12533576","filename":"TaskRunner.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T01:33:28.408+0000","size":1442,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12533576/TaskRunner.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12533589","id":"12533589","filename":"TaskRunner2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T02:23:57.126+0000","size":1394,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12533589/TaskRunner2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12533592","id":"12533592","filename":"TaskRunner3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T02:44:59.697+0000","size":1540,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12533592/TaskRunner3.patch"}],"aggregatetimeestimate":86400,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"46341","customfield_12312823":null,"summary":"TaskRunner fails to start jars when the java.library.path contains a quoted path with embedded spaces","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":86400,"percent":0},"customfield_12311024":null,"environment":"on Windows: \nset PATH=%PATH%;\"C:\\this memorable place\".","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":86400,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401048","id":"13401048","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Remove embedded quotes specifically for java.library.path and refactor double for loop to reduce overhead.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-25T23:57:01.771+0000","updated":"2012-06-25T23:57:01.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401050","id":"13401050","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Patch for TaskRunner.java in 1-win","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-25T23:59:30.661+0000","updated":"2012-06-25T23:59:30.661+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401104","id":"13401104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12533410/TaskRunner.patch\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/2511//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T01:52:56.996+0000","updated":"2012-06-26T01:52:56.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401115","id":"13401115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Updated patch file with full paths, previous patch was taken from the mapred subdirectory.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T02:24:31.849+0000","updated":"2012-06-26T02:24:31.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401116","id":"13401116","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"To explain why there are no tests added with this change -- existing commit tests find this issue before the patch on Windows if you add a quoted, space-separated, string to your PATH before running the tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T02:28:15.369+0000","updated":"2012-06-26T02:28:15.369+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401177","id":"13401177","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12533422/TaskRunner.patch\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/2513//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T05:18:30.996+0000","updated":"2012-06-26T05:18:30.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401604","id":"13401604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Fixed patch apply issue in previous patch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T18:49:34.454+0000","updated":"2012-06-26T18:49:34.454+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401609","id":"13401609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12533523/TaskRunner.patch\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/2517//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T18:54:25.072+0000","updated":"2012-06-26T18:54:25.072+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401755","id":"13401755","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"body":"1) I think spaces are allowed on Unix paths too. So this bug is not Windows specific. The fix need not be under Shell.WINDOWS. Also it does not seem specific to just the library path.\n2) I think the refactoring ended up being incorrect because if(javaOptsSplit[i].startsWith(\"-Djava.library.path=\")) then the new code will a) break and forget to add subsequent javaOptsSplit[i] and b) add only the system library path to vargs and forget to include the values in javaOptsSplit[i].\n3) Also, the split on ' ' is done before appending the library path. So I fail to see how that affects spaces in the library path. It looks like when the library path with '\"' is appended to \"-Djava.library.path=\" then the resulting string (when written to the batch script) does not end up being a valid command line argument. So the issue is not about splitting on the blank but about not escaping/handling the '\"' already present in the path.\n\nWould you mind spending some time and seeing if you can fix the generic problem? If its not worth a significant refactor then we could add some documentation around this instead of a fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-26T22:42:25.290+0000","updated":"2012-06-26T22:42:25.290+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401778","id":"13401778","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Good catch on the break.  I had trouble with the patches and manually generated one from the branch to address it in my last patch -- leaving the break in.  That break is not supposed to be there.  Resubmitting the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T23:11:09.367+0000","updated":"2012-06-26T23:11:09.367+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401791","id":"13401791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"-1 overall.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12533557/TaskRunner.patch\n  against trunk revision .\n\n    +1 @author.  The patch does not contain any @author tags.\n\n    -1 tests included.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    -1 patch.  The patch command could not apply the patch.\n\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/2518//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T23:24:32.785+0000","updated":"2012-06-26T23:24:32.785+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401797","id":"13401797","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"body":"b) add only the system library path to vargs and forget to include the values in javaOptsSplit[i].\nThis bug still seems to be there.\n\nDid you get a chance to look at 3) above? Seems to me the issue is not about split on ' ' but not handling the '\"' that gets embedded into the cmd line. You could add a random '\"' in the path (and no space) and that should also repro the problem. Would you mind verifying that and seeing if its a Windows only issue? If its not, then it would be better to have generic solution.\n\nThe handling of spaces is itself an issue because the current code assumes there are no spaces except as delimiters. And that is not Windows specific.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-26T23:28:39.592+0000","updated":"2012-06-26T23:28:39.592+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401800","id":"13401800","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"for 1) We scoped it to Windows because in Windows \" is not legal in a file name at all, but it is legal in filenames in Posix.  While \"file name\" is similarly used in linux and windows, \\\"file\\\"\\ name is also a legal construct in linux for a file that actually contains quotes in the path.  In that case, stripping internal quotes would potentially break execution and the shell would have handled everything just fine.  I did initially experiment with doing this for all arguments, in hopes of improving upstream quality for things like pig.additional.jars where we may find quotes in the path specified there.  However, we kept it scoped down to java.library.path here because it is the only one explicitly interpreted as a path here.  One can imagine a scenario where an upstream component has an argument like pig.query=^\"a=load ...^\" -- which may need embedded quotes and may also be escaped properly.  In such a case, blanket removal of embedded quotes without handling escaping would be potentially dangerous.\n\n3) is particularly interesting and maybe needs examples to explain.  \n\nHere is a javaopts string that the space split makes sense for:\n-Dpig.additional.jars=/tmp/foo.jar -Djava.library.path=/usr/lib/java/;/usr/lib64/java -esa\n\nThis parses into this javaoptssplit:\n   -Dpig.additional.jars=/tmp/foo.jar\n   -Djava.library.path=/usr/lib/java;/usr/lib64/java\n   -esa\n\nWhich goes to the command line as:\njava \"-Dpig.additional.jars=/tmp/foo.jar\" \"-Djava.library.path=/usr/lib/java;/usr/lib64/java\" \"-esa\" job.jar\n\n\nNow, here is an example of what this patch fixes and why the combination of space splitting and quote escaping is broken: \n-Dpig.additional.jars=/tmp/foo.jar -Djava.library.path=/usr/lib/java;/usr/lib64/java;\"/opt/hadoop/somewhat memorable/path\";/lib/java -esa\n\nThis parses into this javaoptssplit:\n   -Dpig.additional.jars=/tmp/foo.jar\n   -Djava.library.path=/usr/lib/java;/usr/lib64/java;\"/opt/hadoop/somewhat\n   memorable/path\";/lib/java\n   -esa\n\nWhich goes to the command line as:\njava \"-Dpig.additional.jars=/tmp/foo.jar\" \"-Djava.library.path=/usr/lib/java;/usr/lib64/java;\"/opt/hadoop/somewhat\" \"memorable/path\";/lib/java\" \"-esa\" job.jar\n\nThis is bad in a number of ways, but here are the two most obvious to me:\n1.) The semicolon is no longer quoted, so the shell read end of line after <path\"> and will try to execute /lib/java as a separate shell command after java completes.\n2.) java's command-line parsing rules will cause it to interpret \"memorable/path\" as the name of the jar it should execute and will yield (most likely) a ClassNoDefFoundException for \"memorable/path\" or \"memorable.path\".\n\nHope that explains what the comment was trying to read.\n\nThanks, Bikas, for the feedback -- really appreciate it.  Great catch on the break!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-26T23:35:58.928+0000","updated":"2012-06-26T23:35:58.928+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401819","id":"13401819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks for the explanations. Scoping the quotes handling to Windows makes sense. In conjunction with the last comment on MAPREDUCE-4322 do you see some way by which we can reduce the number of Shell.WINDOWS in this code launch JVM code path?\n\nTo round off above examples, would you mind adding an example with only quotes and no spaces and explaining what happens?\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-27T00:09:35.516+0000","updated":"2012-06-27T00:09:35.516+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401832","id":"13401832","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"On quotes with no spaces, here are two example input strings with an option that has quotes but no embedded spaces:\n[EX 1 -- problem]\n-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\";/lib/java -esa\n\nThis splits to:\n-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\";/lib/java\n-esa\n\nthen goes to the command line as:\njava \"-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\";/lib/java\" \"-esa\" job.jar\n\nThis still has the semicolon termination problem due to the \" being present, it is interpreted by the shell parser (on win/linux) as:\njava \"-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\"\n<semicolon line break>\n/lib/java\" \"-esa\" job.jar\n\n[EX 2 -- no problem]\n-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\" -esa\n\nThis splits to:\n-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\"\n-esa\n\nthen goes to the command line as:\njava \"-Djava.library.path=/usr/lib/java/;/usr/lib64/java;\"/opt/sun/sunstudio/somejars\"\" \"-esa\" job.jar\n\nIn this case, the quotes are interpreted by the command-line parser wrong, but in a benign way and it has no effect.  The two problematic cases for this code around quotes are:\n1.) \"string with spaces\"\n2.) \"anything\" [ ; | > && || ] -- any quoted string followed by a shell character that is implicitly or explicitly end-of-command","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T00:24:51.569+0000","updated":"2012-06-27T00:24:51.569+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401845","id":"13401845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks. That makes sense. So for Windows we have made a solution for both 1) and 2) by taking advantage of the fact that \" is an invalid path character and restricted it to java.library.path for safety.\nThe issue of spaces and quotes in paths remains open for Linux.\n\nWouldnt the fix also need to be applied to the path that comes with javaOptsSplit[i].startsWith(\"-Djava.library.path=\")? Currently we are applying it to only libraryPath = System.getProperty(\"java.library.path\")?\n\nWould you also please mention this jira in your code comments so that people can refer back to it for a better understanding.\n\nThere is no need to \"Submit Patch\". It will always give an error because it tries to apply the patch to trunk and will fail. Just attach the file.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-27T00:57:17.019+0000","updated":"2012-06-27T00:57:17.019+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401858","id":"13401858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Updated patch with other java.library.path case handled.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T01:31:17.347+0000","updated":"2012-06-27T01:31:17.347+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401859","id":"13401859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Adding JIRA # to the code comment for the fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T01:33:28.434+0000","updated":"2012-06-27T01:33:28.434+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401863","id":"13401863","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Good catch, Bikas.  Thank you.  Yes, this function in particular function would probably need a broader rewrite to handle all the escaping mechanisms and special characters on Linux.  For instance, a string with -Djava.library.path=/home/jgordon/hadoop\\ lib;/usr/lib64 would also have problems with surrounding quotes, because the \\ would be interpreted literally.\ntouch this\\ file\nis different from:\ntouch \"this\\ file\"\n\nIn that case, the more ideal solution would be to not pass javaopts as one string, but as an array of options or a hash a-priori to improve the ability to reason about them at all layers in the stack.  Then we could have a check for non-escaped problem characters like ;|&\\,whitespace,#,etc and quote escape the whole option only when we see those.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T01:42:28.056+0000","updated":"2012-06-27T01:42:28.056+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401871","id":"13401871","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"body":"In the latest patch, isnt the quote replacement too late? The initial split on ' ' would have already mangled the path that should have gone into javaOptsSplit[i].startsWith(\"-Djava.library.path=\"). So at this point javaOptsSplit[i].startsWith(\"-Djava.library.path=\") contains an incomplete path.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-27T01:50:28.120+0000","updated":"2012-06-27T01:50:28.120+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401878","id":"13401878","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivanmi","name":"ivanmi","key":"ivanmi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Mitic","active":true,"timeZone":"Europe/Berlin"},"body":"Thanks John for the patch, and Bikas for reviewing it thoroughly!\n\nOne minor comment on the latest patch, we would still need to scope the {{javaOptsSplit}} down to Windows only, and assign the value back. Instead of {code}javaOptsSplit[i].replaceAll(\"\\\"\", \"\");{code} we should have\n{code}if (Shell.WINDOWS) {\n  javaOptsSplit[i] = javaOptsSplit[i].replaceAll(\"\\\"\", \"\");\n}{code}\n\nOtherwise, +1 from me!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivanmi","name":"ivanmi","key":"ivanmi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Mitic","active":true,"timeZone":"Europe/Berlin"},"created":"2012-06-27T02:03:57.502+0000","updated":"2012-06-27T02:03:57.502+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401887","id":"13401887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Good feedback, refactoring to keep the Shell.WINDOWS checks down and get the replace applied in both contexts iff Windows.  Testing the new patch now, will post soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T02:16:36.194+0000","updated":"2012-06-27T02:16:36.194+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401889","id":"13401889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Actually, Bikas is right.  We can't address user specified java.library.path -- only the java property we look up.  The reason is that the user path is incomplete in the combination (quote + space) case.  If we want to handle the user case, we have to either fix the parser or remove quotes across the board in the javaOptsSplit array, otherwise we will remove only the first quote and leave the second one dangling, which would leave a mismatched quote in the eventual command.  Bringing the patch back to the system.getProperty scope.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T02:22:32.047+0000","updated":"2012-06-27T02:22:32.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401894","id":"13401894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"body":"That would leave the code change incomplete. But I am ok with that since it is blocked by the basic generic bug in the handling of the white space delimiter for java opts. Could you please open a jira (not targeted to branch-1-win) to track and fix the bug around handling blanks while delimiting java opts? And leave a comment with that jira number to explain the missing check mentioned in your last comment.\nAfter that I am +1 on the fix. We can commit unless someone else has any objections.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bikassaha","name":"bikassaha","key":"bikassaha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=bikassaha&avatarId=29845","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bikassaha&avatarId=29845","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bikassaha&avatarId=29845","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bikassaha&avatarId=29845"},"displayName":"Bikas Saha","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-06-27T02:30:41.346+0000","updated":"2012-06-27T02:30:41.346+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401898","id":"13401898","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivanmi","name":"ivanmi","key":"ivanmi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Mitic","active":true,"timeZone":"Europe/Berlin"},"body":"Makes sense, +1, the latest patch looks good!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivanmi","name":"ivanmi","key":"ivanmi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Mitic","active":true,"timeZone":"Europe/Berlin"},"created":"2012-06-27T02:38:29.554+0000","updated":"2012-06-27T02:38:29.554+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13401906","id":"13401906","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"body":"Filed MAPREDUCE-4377 here (https://issues.apache.org/jira/browse/MAPREDUCE-4377) and added a comment for it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgordon","name":"jgordon","key":"jgordon","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Gordon","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-27T02:44:59.727+0000","updated":"2012-06-27T02:44:59.727+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12595849/comment/13406886","id":"13406886","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"body":"Looks good, +1.\n\nI just committed this. Thanks for the patch John and Bikas/Ivan for reviews.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acmurthy","name":"acmurthy","key":"acmurthy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Arun C Murthy","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-05T07:15:42.299+0000","updated":"2012-07-05T07:15:42.299+0000"}],"maxResults":27,"total":27,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4368/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i08ar3:"}}