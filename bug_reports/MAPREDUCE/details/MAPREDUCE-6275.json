{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12782367","self":"https://issues.apache.org/jira/rest/api/2/issue/12782367","key":"MAPREDUCE-6275","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327586","id":"12327586","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2015-03-16T23:18:04.866+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Mar 24 19:45:47 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_253276096_*|*_1_*:*_1_*:*_7580055_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-03-19T21:45:59.259+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-6275/watchers","watchCount":19,"isWatching":false},"created":"2015-03-16T21:18:23.178+0000","customfield_12310192":null,"customfield_12310191":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10343","value":"Reviewed","id":"10343"}],"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327586","id":"12327586","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"}],"issuelinks":[{"id":"12411043","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12411043","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12783038","key":"MAPREDUCE-6280","self":"https://issues.apache.org/jira/rest/api/2/issue/12783038","fields":{"summary":"Reject directory vs file path conflict resolution in FileOutputCommitter ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12410800","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12410800","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12617132","key":"MAPREDUCE-4815","self":"https://issues.apache.org/jira/rest/api/2/issue/12617132","fields":{"summary":"Speed up FileOutputCommitter#commitJob for many output files","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-04-10T20:19:40.135+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":null,"customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12327586","id":"12327586","description":"2.7.0 release","name":"2.7.0","archived":false,"released":true,"releaseDate":"2015-04-20"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12705157","id":"12705157","filename":"MAPREDUCE-6275.002.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-17T18:56:57.199+0000","size":11166,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12705157/MAPREDUCE-6275.002.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12705461","id":"12705461","filename":"MAPREDUCE-6275.003.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-18T22:45:36.076+0000","size":11958,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12705461/MAPREDUCE-6275.003.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12704897","id":"12704897","filename":"MAPREDUCE-6275.v1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=l201514","name":"l201514","key":"l201514","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siqi Li","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-16T21:51:13.743+0000","size":3029,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12704897/MAPREDUCE-6275.v1.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"Race condition in FileOutputCommitter v2 for user-specified task output subdirs","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=l201514","name":"l201514","key":"l201514","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siqi Li","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=l201514","name":"l201514","key":"l201514","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siqi Li","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14364000","id":"14364000","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=l201514","name":"l201514","key":"l201514","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siqi Li","active":true,"timeZone":"America/Los_Angeles"},"body":"In FileOutputCommiter v2, multiple reducers may call commitTask at the same time. If the outputs of reducers have directory structure with the same name, it may encounter problems with v2.\n\nFor example, if reducerA has output Dir1/File1, reducerB has output Dir1/File2. Since final output directory doesn't have Dir1, both reducers may call rename at the same time. This would end up with weird output directory structure like(Dir1/Dir1/File1, or Dir1/Dir/File2).\n\nTherefore, we should remove FileSystem.rename from FileOutputCommitter#mergePaths method.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=l201514","name":"l201514","key":"l201514","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Siqi Li","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-16T21:35:56.565+0000","updated":"2015-03-16T21:35:56.565+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14364181","id":"14364181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kasha","name":"kasha","key":"kasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karthik Kambatla","active":true,"timeZone":"America/Los_Angeles"},"body":"Bumping up priority, and would like this to included in 2.7.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kasha","name":"kasha","key":"kasha","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Karthik Kambatla","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-16T23:18:04.866+0000","updated":"2015-03-16T23:18:04.866+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14364301","id":"14364301","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:red}-1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12704897/MAPREDUCE-6275.v1.patch\n  against trunk revision 5608520.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:red}-1 tests included{color}.  The patch doesn't appear to include any new or modified tests.\n                        Please justify why no new tests are needed for this patch.\n                        Also please list what manual steps were performed to verify this patch.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core.\n\nTest results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/5297//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/5297//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-17T00:37:29.939+0000","updated":"2015-03-17T00:37:29.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14364308","id":"14364308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"body":"[~l201514], thanks for v1.  We need a regression test for this patch, we can start with a scenario we seem to understand.\n\nThe fix should be always force the merge code path for the less common case when a task outputs to an extra subdir instead of doing any renames.\n\nNote that mkdirs does not throw exception if the directory exists. Let us minimize {{exists}} because it's an extra RPC for getFileStatus.\n\n\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-17T00:42:04.693+0000","updated":"2015-03-17T00:42:04.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14365790","id":"14365790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"body":"Here is 002 patch. I have a reliable reproducer of my understanding of the problem. Without the product code fix the test fails as follows:\n{code}\ntestConcurrentCommitTaskWithSubDirV2(org.apache.hadoop.mapreduce.lib.output.TestFileOutputCommitter)  Time elapsed: 249.209 sec  <<< FAILURE!\njunit.framework.AssertionFailedError: Must not end up with sub_dir/sub_dir\n\tat junit.framework.Assert.fail(Assert.java:57)\n\tat junit.framework.Assert.assertTrue(Assert.java:22)\n\tat junit.framework.Assert.assertFalse(Assert.java:39)\n\tat junit.framework.TestCase.assertFalse(TestCase.java:210)\n\tat org.apache.hadoop.mapreduce.lib.output.TestFileOutputCommitter.testConcurrentCommitTaskWithSubDir(TestFileOutputCommitter.java:542)\n\tat org.apache.hadoop.mapreduce.lib.output.TestFileOutputCommitter.testConcurrentCommitTaskWithSubDirV2(TestFileOutputCommitter.java:555)\n{code}\n\n[~ivan.bella], [~jlowe], [~dlmarion], please review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-17T18:56:57.207+0000","updated":"2015-03-17T18:56:57.207+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14365809","id":"14365809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dlmarion","name":"dlmarion","key":"dlmarion","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dave Marion","active":true,"timeZone":"America/New_York"},"body":"LGTM, appears to only do a rename for files, not directories.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dlmarion","name":"dlmarion","key":"dlmarion","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dave Marion","active":true,"timeZone":"America/New_York"},"created":"2015-03-17T19:08:30.036+0000","updated":"2015-03-17T19:08:30.036+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14365936","id":"14365936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"body":"I reviewed the code and I believe this will resolve the issue.  We will deploy the previous release to prove it still fails and subsequently the patch.  We should be able to try out this patch by Friday.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"created":"2015-03-17T20:05:37.407+0000","updated":"2015-03-17T20:05:37.407+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14365991","id":"14365991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12705157/MAPREDUCE-6275.002.patch\n  against trunk revision 32b4330.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core.\n\nTest results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/5302//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/5302//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-17T20:22:36.214+0000","updated":"2015-03-17T20:22:36.214+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14366138","id":"14366138","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Thanks for working on the patch, Gera and Siqi!\n\nI'm a little concerned about this portion of the patch:\n\n{noformat}\n+    if (from.isFile()) {\n+      if (toStat != null) {\n+        if (!fs.delete(to, true)) {\n+          throw new IOException(\"Failed to delete \" + to);\n+        }\n+      }\n{noformat}\n\nIf we're trying to commit a file and there's a directory with the same name there, do we really want to recursively delete that directory?  Seems to me something is terribly amiss with the output (buggy output committer code?) and we should fail here rather than delete something we don't really understand.  Am I missing a valid use-case?  There's going to be some issues if a reducer wants to commit a file to that path while another reducer who wants to commit a directory to that path is still committing.\n\nNit: Not introduced by this change, but the test should use System.getProperty(java.io.tmpdir) instead of a hardcoded \"/tmp\".  Also \"output\" isn't a very unique pathname in light of unit tests running in parallel, and I'd recommend using the qualified classname as a prefix or just as-is to avoid collisions.\n\nOtherwise patch looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-03-17T21:40:13.197+0000","updated":"2015-03-17T21:40:13.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14366437","id":"14366437","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks Jason for a review.\n \nMis-formatted code was hurting my eyes and so patch appears bigger than it is after reformatting unless you diff -w. I did not change the semantics of the file replacement even if the existing path a directory. I am also not aware what is the background here, and tend to agree that we should have an extra check. Probably in a separate JIRA.\n\nI don't think /tmp is hard coded here (if I am looking at the right file)\nIn o.a.h.m.lib.output.TestFileOutputCommitter \n{code}\n  private static final Path outDir = new Path(\n      System.getProperty(\"test.build.data\", \"/tmp\"), \"output\");\n{code}\n\ntest.build.data is recommended even on http://wiki.apache.org/hadoop/HowToContribute\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-18T01:12:00.693+0000","updated":"2015-03-18T01:12:00.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14366536","id":"14366536","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"body":"I would have to say if someone is creating a reducer that creates both files and directories of the same name, then the code will have to select one over the other or simply fail to merge.  I would think failing would be a better choice but perhaps there was a reason for the original choice.  In any case the original contract is being preserved here and that change should be a separate Jira ticket.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"created":"2015-03-18T02:47:38.626+0000","updated":"2015-03-18T02:47:38.626+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14367128","id":"14367128","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"bq.I did not change the semantics of the file replacement even if the existing path a directory. I am also not aware what is the background here, and tend to agree that we should have an extra check. Probably in a separate JIRA.\n\nAh, yes, I missed this is basically existing behavior.  Agree we can tackle this in a separate JIRA.\n\n bq. I don't think /tmp is hard coded here\n\nIt is hardcoded as the fallback for a missing test.build.data setting.  More specifically, I think it should be something like this:\n\n{code}\nprivate static final Path outDir = new Path(\n      System.getProperty(\"test.build.data\", System.getProperty(\"java.io.tmpdir\")),\n      TestFileOutputCommitter.class.getName());\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-03-18T13:35:41.689+0000","updated":"2015-03-18T13:35:41.689+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14368068","id":"14368068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"body":"Addressing [~jlowe]'s review.\n\nMinor modifications:\n- thread pool shutdown in a finally block in TestFileOutputCommitter\n- Surround LOG.debug by if (LOG.isDebugEnabled) in FileOutputCommitter","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-18T22:45:36.083+0000","updated":"2015-03-18T22:45:36.083+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14368188","id":"14368188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"{color:green}+1 overall{color}.  Here are the results of testing the latest attachment \n  http://issues.apache.org/jira/secure/attachment/12705461/MAPREDUCE-6275.003.patch\n  against trunk revision 8c40e88.\n\n    {color:green}+1 @author{color}.  The patch does not contain any @author tags.\n\n    {color:green}+1 tests included{color}.  The patch appears to include 1 new or modified test files.\n\n    {color:green}+1 javac{color}.  The applied patch does not increase the total number of javac compiler warnings.\n\n    {color:green}+1 javadoc{color}.  There were no new javadoc warning messages.\n\n    {color:green}+1 eclipse:eclipse{color}.  The patch built with eclipse:eclipse.\n\n    {color:green}+1 findbugs{color}.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.\n\n    {color:green}+1 release audit{color}.  The applied patch does not increase the total number of release audit warnings.\n\n    {color:green}+1 core tests{color}.  The patch passed unit tests in hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core.\n\nTest results: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/5310//testReport/\nConsole output: https://builds.apache.org/job/PreCommit-MAPREDUCE-Build/5310//console\n\nThis message is automatically generated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-19T00:08:28.666+0000","updated":"2015-03-19T00:08:28.666+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14369652","id":"14369652","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"+1 lgtm.  I'll commit this later today if there are no objections.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-03-19T16:36:39.837+0000","updated":"2015-03-19T16:36:39.837+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14369674","id":"14369674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks, Jason!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-19T16:48:26.248+0000","updated":"2015-03-19T16:48:26.248+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14369820","id":"14369820","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"body":"We are ok with you committing this, however we will not have this tested at scale until tomorrow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"created":"2015-03-19T18:03:52.832+0000","updated":"2015-03-19T18:03:52.832+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14369821","id":"14369821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"body":"We are ok with you committing this, however we will not have this tested at scale until tomorrow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"created":"2015-03-19T18:03:58.267+0000","updated":"2015-03-19T18:03:58.267+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14370163","id":"14370163","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"I'd like to get this in today since 2.7 is trying to close up, and I think this is an important fix for that release.  Given Gera's unit test reproduces the scenario we believe is occurring and the patch fixes that issue, I think it's best to get this in now to make 2.7 and address any followup issues in a separate JIRA.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-03-19T21:33:47.037+0000","updated":"2015-03-19T21:33:47.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14370188","id":"14370188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"Thanks to Gera and Siqi for the contribution and to Dave and Ivan for additional review!  I committed this to trunk, branch-2, and branch-2.7.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2015-03-19T21:45:59.308+0000","updated":"2015-03-19T21:45:59.308+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14370283","id":"14370283","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-trunk-Commit #7377 (See [https://builds.apache.org/job/Hadoop-trunk-Commit/7377/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n* hadoop-mapreduce-project/CHANGES.txt\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-19T22:55:11.358+0000","updated":"2015-03-19T22:55:11.358+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14371160","id":"14371160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Yarn-trunk-Java8 #138 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk-Java8/138/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n* hadoop-mapreduce-project/CHANGES.txt\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-20T11:34:56.987+0000","updated":"2015-03-20T11:34:56.987+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14371194","id":"14371194","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"SUCCESS: Integrated in Hadoop-Yarn-trunk #872 (See [https://builds.apache.org/job/Hadoop-Yarn-trunk/872/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/CHANGES.txt\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-20T11:57:18.876+0000","updated":"2015-03-20T11:57:18.876+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14371362","id":"14371362","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk #2070 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk/2070/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/CHANGES.txt\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-20T14:31:51.419+0000","updated":"2015-03-20T14:31:51.419+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14371371","id":"14371371","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Hdfs-trunk-Java8 #129 (See [https://builds.apache.org/job/Hadoop-Hdfs-trunk-Java8/129/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n* hadoop-mapreduce-project/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-20T14:31:53.345+0000","updated":"2015-03-20T14:31:53.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14371453","id":"14371453","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk-Java8 #138 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk-Java8/138/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n* hadoop-mapreduce-project/CHANGES.txt\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-20T15:21:13.483+0000","updated":"2015-03-20T15:21:13.483+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14371474","id":"14371474","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"FAILURE: Integrated in Hadoop-Mapreduce-trunk #2088 (See [https://builds.apache.org/job/Hadoop-Mapreduce-trunk/2088/])\nMAPREDUCE-6275. Race condition in FileOutputCommitter v2 for user-specified task output subdirs. Contributed by Gera Shegalov and Siqi Li (jlowe: rev 91baca145a6c16fe13f455d150c05bd73179531b)\n* hadoop-mapreduce-project/CHANGES.txt\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/test/java/org/apache/hadoop/mapreduce/lib/output/TestFileOutputCommitter.java\n* hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/lib/output/FileOutputCommitter.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2015-03-20T15:27:22.845+0000","updated":"2015-03-20T15:27:22.845+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14378444","id":"14378444","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"body":"Since applying this patch, we have not seen this issue crop up on our test system.  So there is a high likelihood that this issue has been put to rest.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ivan.bella","name":"ivan.bella","key":"ivan.bella","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ivan.bella&avatarId=16575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ivan.bella&avatarId=16575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ivan.bella&avatarId=16575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ivan.bella&avatarId=16575"},"displayName":"Ivan Bella","active":true,"timeZone":"America/New_York"},"created":"2015-03-24T19:43:45.044+0000","updated":"2015-03-24T19:43:45.044+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12782367/comment/14378448","id":"14378448","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"body":"[~ivan.bella], thanks for giving it a try.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira.shegalov","name":"jira.shegalov","key":"jira.shegalov","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gera Shegalov","active":true,"timeZone":"America/Los_Angeles"},"created":"2015-03-24T19:45:47.643+0000","updated":"2015-03-24T19:45:47.643+0000"}],"maxResults":29,"total":29,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-6275/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i26u0v:"}}