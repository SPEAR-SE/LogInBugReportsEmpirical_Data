{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12507554","self":"https://issues.apache.org/jira/rest/api/2/issue/12507554","key":"MAPREDUCE-2510","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-05-18T02:58:38.549+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jun 14 02:42:18 UTC 2011","customfield_12310420":"67351","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_5485349165_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2011-07-20T13:57:10.416+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-2510/watchers","watchCount":5,"isWatching":false},"created":"2011-05-18T02:14:41.297+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[{"id":"12339150","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12339150","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12414186","key":"MAPREDUCE-143","self":"https://issues.apache.org/jira/rest/api/2/issue/12414186","fields":{"summary":"OOM in the TaskTracker while serving map outputs","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-07-20T13:57:10.424+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"Our product cluster's TaskTracker sometimes throw OutOfMemoryError after upgrade to jetty6. The exception in TT's log is as follows:\n2011-05-17 19:16:40,756 ERROR org.mortbay.log: Error for /mapOutput\n\njava.lang.OutOfMemoryError: Java heap space\n\n        at java.io.BufferedInputStream.<init>(BufferedInputStream.java:178)\n\n        at org.apache.hadoop.fs.BufferedFSInputStream.<init>(BufferedFSInputStream.java:44)\n\n        at org.apache.hadoop.fs.RawLocalFileSystem.open(RawLocalFileSystem.java:176)\n\n        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:359)\n\n        at org.apache.hadoop.mapred.TaskTracker$MapOutputServlet.doGet(TaskTracker.java:3040)\n\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)\n\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)\n\n        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)\n\n        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:363)\n\n        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n\n        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n\n        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)\n\n        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)\n\n        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)\n\n        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n\n        at org.mortbay.jetty.Server.handle(Server.java:324)\n\n        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:534)\n\n        at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:864)\n\n        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:533)\n\n        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:207)\n\n        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:403)\n\n        at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)\n\n        at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:522)\n\nExceptions in .out file:\njava.lang.OutOfMemoryError: Java heap space\n\nException in thread \"process reaper\" java.lang.OutOfMemoryError: Java heap space\n\nException in thread \"pool-1-thread-1\" java.lang.OutOfMemoryError: Java heap space\n\njava.lang.OutOfMemoryError: Java heap space\n\njava.lang.reflect.InvocationTargetException\n\nException in thread \"IPC Server handler 6 on 50050\"     at sun.reflect.GeneratedMethodAccessor15.invoke(Unknown Source)\n\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\n        at java.lang.reflect.Method.invoke(Method.java:597)\n\n        at org.mortbay.log.Slf4jLog.warn(Slf4jLog.java:126)\n\n        at org.mortbay.log.Log.warn(Log.java:181)\n\n        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:449)\n\n        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n\n        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n\n        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)\n\n        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)\n\n        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)\n\n        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n\n        at org.mortbay.jetty.Server.handle(Server.java:324)\n\n        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:534)\n\n        at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:864)\n\n        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:533)\n\n        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:207)\n\n        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:403)\n\n        at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)\n\n        at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:522)\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"52654","customfield_12312823":null,"summary":"TaskTracker throw OutOfMemoryError after upgrade to jetty6","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13035175","id":"13035175","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"The following comments are copied from MAPREDUCE-143:\nWe dump the heap of TaskTracker and analyze it with MAT. We found one instance of \"org.mortbay.thread.QueuedThreadPool\" occupies 853,258,184 (72.51%) bytes. This object contain a \"java.lang.Runnable[]\" which has 7200 elements.\n\nThe QueuedThreadPool of jetty6 own an array of jobs. If an idle thread is available a job is directly dispatched, otherwise the job is queued to the array. At first the size of the array is _maxThreads(tasktracker.http.threads). When its full, the size grow to array.length() + _maxThreads. Because the grow has no limit, this array can occupy too many memory when there are lots of fetch request from reduce task. So is this jetty6's bug?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-18T02:25:31.205+0000","updated":"2011-05-18T02:25:31.205+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13035181","id":"13035181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"What is the exact version of Jetty you're using? A similar bug has been seen in Hadoop clusters before; it was fixed by upgrading Jetty. The current stable release 6.1.26 does not have this behavior (again, assuming it's the same circular buffer issue)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-05-18T02:58:38.549+0000","updated":"2011-05-18T02:58:38.549+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13035183","id":"13035183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Hi Chris, \nour Jetty version is 6.1.14, the same with trunk. Is there an issue about upgrading Jetty to 6.1.26? Why Jetty 6.1.26 does not have this behavior? I saw that Cloudera's cdh3u0 use Jetty 6.1.26.\n\nThanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-18T03:35:06.857+0000","updated":"2011-05-18T03:35:06.857+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13035185","id":"13035185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Hi Chris,\nHADOOP-6882 upgrade the version of Jetty to 6.1.26. That jira has checked in to 0.20 branch. But I still don't know why 6.1.26 does not have this behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-18T03:53:18.605+0000","updated":"2011-05-18T03:53:18.605+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13035585","id":"13035585","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. Is there an issue about upgrading Jetty to 6.1.26?\n\nNone that I'm aware of. Upgrading from Jetty5 to Jetty6 was painful, but upgrading within Jetty6 has been very easy.\n\nbq. Why Jetty 6.1.26 does not have this behavior?\n\nThis showed up in a cluster while I was on call. The heap dump of the TaskTracker showed exactly what you found, i.e. a large number of Runnable instances in an array. Looking at the 6.1.14 source, it was obvious that the circular buffer was failing to free references to requests queued in this buffer, which expanded whenever its throughput lagged behind the request rate. Looking at the 6.1.25 source, references to requests in this buffer were correctly set to {{null}} after dispatching them. I don't know when this was fixed, only that we've been running 6.1.26 and it's the smoothest version of Jetty we've deployed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.douglas","name":"chris.douglas","key":"chris.douglas","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Douglas","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-05-18T18:55:06.376+0000","updated":"2011-05-18T18:55:06.376+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13035935","id":"13035935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Hi Chris,\nI really appreciate your comments! Jetty 6.1.26 did free the references to Runnable instances. We'll upgrade our cluster's jetty version asap.\nThanks again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-19T02:04:33.898+0000","updated":"2011-05-19T02:04:33.898+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13039365","id":"13039365","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"body":"> > Is there an issue about upgrading Jetty to 6.1.26?\n> None that I'm aware of. Upgrading from Jetty5 to Jetty6 was painful, but upgrading within Jetty6 has been very easy.\n>\nAfter 6.1.26 upgrade, I think we started seeing various fetch failure issues that persists on TaskTracker/jetty delaying the jobs. (MAPREDUCE-2529, MAPREDUCE-2530, etc)  So far we haven't found any fixes and instead working on a workaround.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knoguchi","name":"knoguchi","key":"knoguchi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Koji Noguchi","active":true,"timeZone":"America/New_York"},"created":"2011-05-25T22:03:31.546+0000","updated":"2011-05-25T22:03:31.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13039487","id":"13039487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"Hi Koji,\nWe just trigger this bug in our test cluster with jetty6.1.26. Can you please share your workaround?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-26T02:27:36.302+0000","updated":"2011-05-26T02:27:36.302+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13039736","id":"13039736","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"After upgrading our product cluster's Jetty version to 6.1.26. The checkpoint become very slow. \n\n                   fsimage size          download time\nBefore upgrading   10G                    2 mins\nAfter upgrading    9.95G                 15 mins \n\nWhat's more, there are many \"JVM BUG(s)\" logs in NN's log file:\n2011-05-26 22:46:48,807 INFO org.mortbay.log: org.mortbay.io.nio.SelectorManager$SelectSet@173ab5e JVM BUG(s) - injecting delay59 times\n\n2011-05-26 22:46:48,807 INFO org.mortbay.log: org.mortbay.io.nio.SelectorManager$SelectSet@173ab5e JVM BUG(s) - recreating selector 59 times, canceled keys 944 times\n\nAccording to Jetty 6.1.26's code, Jetty's Selector sleep some time when print above logs.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-05-26T15:29:22.605+0000","updated":"2011-05-26T15:29:22.605+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507554/comment/13048963","id":"13048963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"body":"We have planned to build our own jetty version based on 6.1.14, with following patches to fix OOM bugs.\nJETTY-1157, Don't hold array passed in write(byte[]).\nJETTY-861,switched buffer pools to ThreadLocal implementation.\nJETTY-1188,Null old jobs in QueuedThreadPool.\n\nIt works well in test cluster.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=liangly","name":"liangly","key":"liangly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=liangly&avatarId=10105","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=liangly&avatarId=10105","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=liangly&avatarId=10105","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=liangly&avatarId=10105"},"displayName":"Liyin Liang","active":true,"timeZone":"Asia/Hong_Kong"},"created":"2011-06-14T02:42:18.233+0000","updated":"2011-06-14T02:42:18.233+0000"}],"maxResults":10,"total":10,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-2510/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i09dpj:"}}