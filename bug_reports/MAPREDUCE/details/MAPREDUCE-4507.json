{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12601281","self":"https://issues.apache.org/jira/rest/api/2/issue/12601281","key":"MAPREDUCE-4507","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-08-03T11:07:12.431+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Aug 03 11:07:12 UTC 2012","customfield_12310420":"253827","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4507/watchers","watchCount":2,"isWatching":false},"created":"2012-08-02T22:39:46.522+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12320250","id":"12320250","description":"maintenance release on branch-1.0","name":"1.0.3","archived":false,"released":true,"releaseDate":"2012-05-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-08-03T11:07:12.474+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315344","id":"12315344","name":"mrv1"}],"timeoriginalestimate":null,"description":"If we use the default InputFormat (TextInputFormat) but specify the Key type in mapper as IntWritable instead of Long Writable. The framework is supposed throw a class cast exception.Such an exception is thrown only if the key types at class level and method level are the same (IntWritable). But if we provide the Input key type as IntWritable on the class level but LongWritable on the method level (map method), instead of throwing a compile time error, the code compliles fine . In addition to it on execution the framework triggers Identity Mapper instead of the custom mapper provided with the configuration. In this case the 'mapreduce.map.class' in job.xml shows mapper as Custom Mapper itself , it should show IdentityMapper in cases where IdentityMapper is triggered to avoid confusion and easy debugging.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"80653","customfield_12312823":null,"summary":"IdentityMapper is being triggered when the type of the Input Key at class level and method level has a conflict","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"linux ubuntu","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12601281/comment/13427695","id":"13427695","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"body":"This piece of code will trigger IdentityReducer. No compile time errors thrown even though the Input Key Type is not matching at Class and Method levels \n\nMain Class\n{code}\nimport org.apache.hadoop.conf.Configuration;\nimport org.apache.hadoop.conf.Configured;\nimport org.apache.hadoop.fs.Path;\nimport org.apache.hadoop.io.IntWritable;\nimport org.apache.hadoop.io.Text;\nimport org.apache.hadoop.mapreduce.Job;\nimport org.apache.hadoop.mapreduce.lib.input.FileInputFormat;\nimport org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;\nimport org.apache.hadoop.util.Tool;\nimport org.apache.hadoop.util.ToolRunner;\n\n\npublic class WcNewMain extends Configured implements Tool\n{\n      public int run(String[] args) throws Exception\n      {\n            //getting configuration object and setting job name\n            Configuration conf = getConf();\n\t        Job job = new Job(conf, \"Word Count \");\n\t      \n\t        //setting the class names\n\t        job.setJarByClass(WcNewMain.class);\n\t        job.setMapperClass(WcMapperNew.class);\n\t        //job.setReducerClass(WordCountReducer.class);\n\t        job.setNumReduceTasks(0);\n\t\n\t        //setting the output data type classes\n\t    \tjob.setOutputKeyClass(Text.class);\n\t        job.setOutputValueClass(IntWritable.class);\n\t\n\t      \n\t        \n\t        FileInputFormat.addInputPath(job, new Path(\"hdfs://localhost:9000/userdata/bejoy/samples/wc/input\"));\n\t\t    FileOutputFormat.setOutputPath(job, new Path(\"hdfs://localhost:9000/userdata/bejoy/samples/wc/output\"));\n\t\n\t        return job.waitForCompletion(true) ? 0 : 1;\n    }\n\n    public static void main(String[] args) throws Exception {\n        int res = ToolRunner.run(new Configuration(), new WcNewMain(), args);\n        System.exit(res);\n    }\n}\n\n\n{code}\n\nMapper Class\n{code}\nimport java.io.IOException;\nimport java.util.StringTokenizer;\n\nimport org.apache.hadoop.io.IntWritable;\nimport org.apache.hadoop.io.LongWritable;\nimport org.apache.hadoop.io.Text;\nimport org.apache.hadoop.mapreduce.Mapper;\n\npublic class WcMapperNew extends Mapper<IntWritable, Text, Text, IntWritable>\n{\n            //hadoop supported data types\n      private final static IntWritable one = new IntWritable(1);\n      private Text word = new Text();\n       \n           public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException\n           {\n             //taking one line at a time and tokenizing the same\n               String line = value.toString();\n               StringTokenizer tokenizer = new StringTokenizer(line);\n           \n             //iterating through all the words available in that line and forming the key value pair\n               while (tokenizer.hasMoreTokens())\n               {\n                  word.set(tokenizer.nextToken());\n                  //sending to output collector which inturn passes the same to reducer\n                  context.write(word, one);\n               }\n           }\n           \n }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-02T22:51:47.853+0000","updated":"2012-08-02T22:51:47.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12601281/comment/13427701","id":"13427701","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"body":"Sorry About the typo\n\nThis piece of code will trigger ***{color:blue} IdentityMapper{color} ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-02T22:54:31.967+0000","updated":"2012-08-02T22:54:31.967+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12601281/comment/13427709","id":"13427709","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"body":"By just changing the Input Key Type to IntWritable in map method level. The code throws \n\n{code}\njava.lang.ClassCastException: org.apache.hadoop.io.LongWritable cannot be cast to org.apache.hadoop.io.IntWritable\n\n{code}\n\nModified Mapper Class\n\n{code}\nimport java.io.IOException;\nimport java.util.StringTokenizer;\n\nimport org.apache.hadoop.io.IntWritable;\nimport org.apache.hadoop.io.Text;\nimport org.apache.hadoop.mapreduce.Mapper;\n\npublic class WcMapperNew extends Mapper<IntWritable, Text, Text, IntWritable>\n{\n            //hadoop supported data types\n      private final static IntWritable one = new IntWritable(1);\n      private Text word = new Text();\n       \n           public void map(IntWritable key, Text value, Context context) throws IOException, InterruptedException\n           {\n             //taking one line at a time and tokenizing the same\n               String line = value.toString();\n               StringTokenizer tokenizer = new StringTokenizer(line);\n           \n             //iterating through all the words available in that line and forming the key value pair\n               while (tokenizer.hasMoreTokens())\n               {\n                  word.set(tokenizer.nextToken());\n                  //sending to output collector which inturn passes the same to reducer\n                  context.write(word, one);\n               }\n           }\n           \n }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bejoyks","name":"bejoyks","key":"bejoyks","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bejoy KS","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-02T22:58:44.141+0000","updated":"2012-08-02T22:58:44.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12601281/comment/13427993","id":"13427993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"body":"The {{map()}} function is to be properly overriden when using the new API. Using @Override annotations on map() (and for that matter, reduce() too) will help you catch your mistake here.\n\nAs discussed on http://search-hadoop.com/m/hSxqz1vsQPc, this is a user-side mistake, but in no way a bug. See http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/mapreduce/Mapper.html#map(KEYIN,%20VALUEIN,%20org.apache.hadoop.mapreduce.Mapper.Context).\n\nWe can add a javadoc improvement (and a tutorial improvement) to state the right answer to avoiding this issue: Always use @Override annotations when overriding methods. (Any IDE today provides support for this).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qwertymaniac","name":"qwertymaniac","key":"qwertymaniac","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=qwertymaniac&avatarId=16780","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=qwertymaniac&avatarId=16780","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=qwertymaniac&avatarId=16780","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=qwertymaniac&avatarId=16780"},"displayName":"Harsh J","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-08-03T11:07:12.431+0000","updated":"2012-08-03T11:07:12.431+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4507/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0e5hz:"}}