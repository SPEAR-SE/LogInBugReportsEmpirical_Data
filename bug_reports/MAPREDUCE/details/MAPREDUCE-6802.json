{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"13015682","self":"https://issues.apache.org/jira/rest/api/2/issue/13015682","key":"MAPREDUCE-6802","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/3","id":"3","description":"The problem is a duplicate of an existing issue.","name":"Duplicate"},"customfield_12312322":null,"customfield_12310220":"2016-10-31T16:19:45.189+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Nov 16 22:59:35 UTC 2016","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1789904619_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-11-16T22:59:58.505+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-6802/watchers","watchCount":3,"isWatching":false},"created":"2016-10-27T05:48:14.053+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12334007","id":"12334007","description":"2.7.3 release","name":"2.7.3","archived":false,"released":true,"releaseDate":"2016-08-25"}],"issuelinks":[{"id":"12486771","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12486771","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"13015466","key":"MAPREDUCE-6801","self":"https://issues.apache.org/jira/rest/api/2/issue/13015466","fields":{"summary":"Fix flaky TestKill.testKillJob()","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-11-16T22:59:58.537+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12314301","id":"12314301","name":"mrv2","description":"MR-279: Map Reduce Next."}],"timeoriginalestimate":null,"description":"Running org.apache.hadoop.mapreduce.v2.app.TestKill\nTests run: 5, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 9.86 sec <<< FAILURE! - in org.apache.hadoop.mapreduce.v2.app.TestKill\ntestKillJob(org.apache.hadoop.mapreduce.v2.app.TestKill)  Time elapsed: 0.377 sec  <<< FAILURE!\njava.lang.AssertionError: Task state not correct expected:<KILLED> but was:<NEW>\n       at org.junit.Assert.fail(Assert.java:88)\n       at org.junit.Assert.failNotEquals(Assert.java:743)\n       at org.junit.Assert.assertEquals(Assert.java:118)\n       at org.apache.hadoop.mapreduce.v2.app.TestKill.testKillJob(TestKill.java:99)\n\n\nResults :\n\nFailed tests:\n TestKill.testKillJob:99 Task state not correct expected:<KILLED> but was:<NEW>\n\nTests run: 5, Failures: 1, Errors: 0, Skipped: 0","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12337977","id":"12337977","name":"3.0.0-alpha2","archived":false,"released":true,"releaseDate":"2017-01-25"}],"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"TestKill.testKillJob() fails intermittently on Power","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"# uname -a\nLinux pts00452-vm10 3.10.0-327.el7.ppc64le #1 SMP Thu Oct 29 17:31:13 EDT 2015 ppc64le ppc64le ppc64le GNU/Linux\n# cat /etc/redhat-release\nRed Hat Enterprise Linux Server release 7.2 (Maipo)","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/13015682/comment/15610776","id":"15610776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"body":"similar to MAPREDUCE-6801 but this bug is related to ppc64le.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-27T05:50:39.503+0000","updated":"2016-10-27T05:50:39.503+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13015682/comment/15610792","id":"15610792","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"body":"On further debugging we found that the issue is related to the performance of MRApp.submit().\n\nIn case of failure:\nJust after app.submit() method, app.waitForState(job,JobState.RUNNING) is getting Job state as RUNNING but the Task state is NEW. When JOB_KILL event is triggered, there is no transition which can change the Task state from NEW. Hence the Task state is remaining in the NEW state itself.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"created":"2016-10-27T05:56:43.548+0000","updated":"2016-10-27T05:56:43.548+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13015682/comment/15622628","id":"15622628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haibochen","name":"haibochen","key":"haibochen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haibo Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"[~yussufshaikh] I believe this is a sub case of MAPREDUCE-6801. The root cause for cases is the same, that is, the event handler thread not being able to process events on time. The external state of a job that we observe does not indicate progress of the event handler thread.  For example, when the job goes into RUNNING state, it just means that all tasks have been created. Depending on how fast the event handler thread is, the tasks could still be in NEW, or SCHEDULED or RUNNING.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haibochen","name":"haibochen","key":"haibochen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haibo Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-10-31T16:19:45.189+0000","updated":"2016-10-31T16:19:45.189+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13015682/comment/15624587","id":"15624587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"body":"[~haibochen] Even I think same.\nI suggest along with waitForState on the job, add a line in the test case to waitForState for the task to be SCHEDULED state.\nHave tested above workaround on Power and it worked every time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yussufshaikh","name":"yussufshaikh","key":"yussufshaikh","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yussuf Shaikh","active":true,"timeZone":"Etc/UTC"},"created":"2016-11-01T07:06:50.438+0000","updated":"2016-11-01T07:06:50.438+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/13015682/comment/15671985","id":"15671985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haibochen","name":"haibochen","key":"haibochen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haibo Chen","active":true,"timeZone":"America/Los_Angeles"},"body":"[~yussufshaikh] I have posted a fix for MAPREDUCE-6801, which I believe includes MAPREDUCE-6802 as well. Will close this one as duplicate. Feel free to reopen if think otherwise.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=haibochen","name":"haibochen","key":"haibochen","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Haibo Chen","active":true,"timeZone":"America/Los_Angeles"},"created":"2016-11-16T22:59:35.112+0000","updated":"2016-11-16T22:59:35.112+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-6802/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i35gqf:"}}