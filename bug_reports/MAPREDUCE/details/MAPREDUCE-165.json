{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12386405","self":"https://issues.apache.org/jira/rest/api/2/issue/12386405","key":"MAPREDUCE-165","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2014-07-17T19:44:41.501+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri May 01 07:55:38 UTC 2015","customfield_12310420":"148557","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-165/watchers","watchCount":3,"isWatching":false},"created":"2008-01-16T18:07:34.397+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["newbie","security"],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-05-01T07:55:38.455+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"The servlet we use to export the map outputs doesn't protect itself against \"..\" attacks. However, because the code adds a /file.out.index and /file.out to it, it can only be used to read files with those names.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"107782","customfield_12312823":null,"summary":"the map task output servlet doesn't protect against \"..\" attacks","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=owen.omalley","name":"owen.omalley","key":"owen.omalley","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=owen.omalley&avatarId=29697","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=owen.omalley&avatarId=29697","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=owen.omalley&avatarId=29697","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=owen.omalley&avatarId=29697"},"displayName":"Owen O'Malley","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12386405/comment/14065441","id":"14065441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"body":"I suspect this issue can be closed, but it would be good to have some verification.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=aw","name":"aw","key":"aw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=aw&avatarId=23681","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aw&avatarId=23681","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aw&avatarId=23681","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aw&avatarId=23681"},"displayName":"Allen Wittenauer","active":true,"timeZone":"America/Tijuana"},"created":"2014-07-17T19:44:41.501+0000","updated":"2014-07-17T19:44:41.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12386405/comment/14522903","id":"14522903","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d4rr3ll","name":"d4rr3ll","key":"d4rr3ll","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=d4rr3ll&avatarId=23449","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=d4rr3ll&avatarId=23449","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=d4rr3ll&avatarId=23449","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=d4rr3ll&avatarId=23449"},"displayName":"Darrell Taylor","active":true,"timeZone":"Europe/London"},"body":"OK, I've had a quick look through this and the two places I can find where file.out and file.out.index are created are in MROutputFiles.java and YarnOutputFiles.java, both of these push all their work through LocalDirAllocator.java and ultimately Path.java.  \n\nSo I'd presume (maybe incorrectly) that LocalDirAllocator and Path both protect against \"..\" attacks?  I'll spend a bit more time looking through them to try and understand how they work.  But the map output classes look sensible.\n\nThe one thing that did make me wonder though is this piece of code that appears in the LocalDirAllocator, it strips off the leading /, which could result in a \"..\" attack, but that may be picked up in the Path class.\n\n{code}\n      //remove the leading slash from the path (to make sure that the uri\n      //resolution results in a valid path on the dir being checked)\n      if (pathStr.startsWith(\"/\")) {\n        pathStr = pathStr.substring(1);\n      }\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=d4rr3ll","name":"d4rr3ll","key":"d4rr3ll","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=d4rr3ll&avatarId=23449","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=d4rr3ll&avatarId=23449","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=d4rr3ll&avatarId=23449","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=d4rr3ll&avatarId=23449"},"displayName":"Darrell Taylor","active":true,"timeZone":"Europe/London"},"created":"2015-05-01T07:55:38.455+0000","updated":"2015-05-01T07:55:38.455+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-165/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0isxr:"}}