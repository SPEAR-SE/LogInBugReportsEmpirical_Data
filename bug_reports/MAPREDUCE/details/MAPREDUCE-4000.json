{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12546191","self":"https://issues.apache.org/jira/rest/api/2/issue/12546191","key":"MAPREDUCE-4000","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2012-05-08T14:19:12.673+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Jan 01 23:22:30 UTC 2013","customfield_12310420":"231349","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":0,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4000/watchers","watchCount":1,"isWatching":false},"created":"2012-03-13T07:15:12.680+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":86400,"aggregatetimeoriginalestimate":86400,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319503","id":"12319503","description":"maintenance release on branch-1.0","name":"1.0.1","archived":false,"released":true,"releaseDate":"2012-02-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12320047","id":"12320047","description":"maintenance release on branch-1.0","name":"1.0.2","archived":false,"released":true,"releaseDate":"2012-04-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12320060","id":"12320060","description":"0.23.3","name":"0.23.3","archived":false,"released":true,"releaseDate":"2012-09-20"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-01-01T23:22:30.637+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312908","id":"12312908","name":"pipes"}],"timeoriginalestimate":86400,"description":"Create jobTokenPassword file fail when run hadoop pipes  locally.\n\nI have put such settings in my job conf.\n{code:xml} \n<property>\n  <name>mapreduce.jobtracker.address</name>\n  <value>local</value>\n</property>\n\n<property>\n  <name>mapreduce.framework.name</name>\n  <value>local</value>\n</property>\n\n<property>\n  <name>fs.defaultFS</name>\n  <value>file:///</value>\n</property>\n{code} \n\nThis job has one map task ,and one reduce task. It will fail when running PipesReducer, because \"jobTokenPassword\" file is created at current working directory,with permission 0400.\n\n{code:title=org.apache.hadoop.mapred.pipes.Application.java} \n private void writePasswordToLocalFile(String localPasswordFile,\n      byte[] password, JobConf conf) throws IOException {\n    FileSystem localFs = FileSystem.getLocal(conf);\n    Path localPath = new Path(localPasswordFile);\n    FSDataOutputStream out = FileSystem.create(localFs, localPath,\n        new FsPermission(\"400\"));\n    out.write(password);\n    out.close();\n  }\n{code}\n\nSo, it will fail at the second time.\n\nIn such situation,the application cannot be initialized, but the PipesReducer.close() method will be called after that ,so there will be NullPointer Exception raise in close() method.\n\n\n\n","customfield_10010":null,"timetracking":{"originalEstimate":"24h","remainingEstimate":"24h","originalEstimateSeconds":86400,"remainingEstimateSeconds":86400},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":86400,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"112782","customfield_12312823":null,"summary":"Create jobTokenPassword file fail when run hadoop pipes  locally","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=snnn","name":"snnn","key":"snnn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Changming Sun","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=snnn","name":"snnn","key":"snnn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Changming Sun","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":86400,"percent":0},"customfield_12311024":null,"environment":"Fedora release 16\nLinux localhost.localdomain 3.2.7-1.fc16.x86_64 #1 SMP Tue Feb 21 01:40:47 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\nApache Maven 3.0.4 (r1232337; 2012-01-17 16:44:56+0800)\nMaven home: /usr/local/apache-maven-3.0.4\nJava version: 1.7.0_03, vendor: Oracle Corporation\nJava home: /usr/java/jdk1.7.0_03/jre\nDefault locale: en_US, platform encoding: UTF-8\nOS name: \"linux\", version: \"3.2.7-1.fc16.x86_64\", arch: \"amd64\", family: \"unix\"","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":86400,"percent":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546191/comment/13270482","id":"13270482","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ilveroluca","name":"ilveroluca","key":"ilveroluca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Luca Pireddu","active":true,"timeZone":"Europe/Berlin"},"body":"Stack trace, from Hadoop 1.0.2:\n\n{{\n12/05/08 16:11:32 INFO mapred.JobClient: Task Id : attempt_201205081608_0001_m_000000_2, Status : FAILED\njava.io.FileNotFoundException: /u/pireddu/Projects/pydoop.git/examples/wordcount/test/jobTokenPassword (Permission denied)\n        at java.io.FileOutputStream.open(Native Method)\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:194)\n        at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:188)\n        at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:184)\n        at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:255)\n        at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:236)\n        at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:335)\n        at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:381)\n        at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:364)\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:555)\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:536)\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:443)\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:435)\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:315)\n        at org.apache.hadoop.mapred.pipes.Application.writePasswordToLocalFile(Application.java:170)\n        at org.apache.hadoop.mapred.pipes.Application.<init>(Application.java:106)\n        at org.apache.hadoop.mapred.pipes.PipesMapRunner.run(PipesMapRunner.java:68)\n        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:436)\n        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:372)\n        at org.apache.hadoop.mapred.Child$4.run(Child.java:255)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.Subject.doAs(Subject.java:396)\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1093)\n        at org.apache.hadoop.mapred.Child.main(Child.java:249)\n}}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ilveroluca","name":"ilveroluca","key":"ilveroluca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Luca Pireddu","active":true,"timeZone":"Europe/Berlin"},"created":"2012-05-08T14:19:12.673+0000","updated":"2012-05-08T14:19:12.673+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12546191/comment/13541943","id":"13541943","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khsibr","name":"khsibr","key":"khsibr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ryadh Khsib","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\n\nLooking at java.io.FileNotFoundException: /u/pireddu/Projects/pydoop.git/examples/wordcount/test/jobTokenPassword (Permission denied) it seems that the java process doesn't have the right access to this folder. \nCan you check it?\n\nCheers Ryadh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khsibr","name":"khsibr","key":"khsibr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10432","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10432","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10432","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10432"},"displayName":"Ryadh Khsib","active":true,"timeZone":"Etc/UTC"},"created":"2013-01-01T23:22:30.637+0000","updated":"2013-01-01T23:22:30.637+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-4000/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0jnrz:"}}