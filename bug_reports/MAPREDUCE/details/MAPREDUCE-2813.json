{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12415831","self":"https://issues.apache.org/jira/rest/api/2/issue/12415831","key":"MAPREDUCE-2813","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":null,"customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Feb 28 02:42:56 UTC 2009","customfield_12310420":"65412","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-2813/watchers","watchCount":1,"isWatching":false},"created":"2009-02-27T23:34:59.460+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314045","id":"12314045","description":"","name":"0.21.0","archived":false,"released":true,"releaseDate":"2010-08-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-08-11T18:11:59.673+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[],"timeoriginalestimate":null,"description":"Running a recent version of trunk on 100 nodes, I occasionally see some tasks freeze at startup and hang the job. These tasks are not speculatively executed either. Here's sample output from one of them:\n\n{noformat}\n2009-02-27 15:19:10,229 INFO org.apache.hadoop.metrics.jvm.JvmMetrics: Initializing JVM Metrics with processName=MAP, sessionId=\n2009-02-27 15:19:10,486 INFO org.apache.hadoop.mapred.MapTask: numReduceTasks: 0\n2009-02-27 15:21:20,952 INFO org.apache.hadoop.hdfs.DFSClient: Could not obtain block blk_2086525142250101885_39076 from any node:  java.io.IOException: No live nodes contain current block\n2009-02-27 15:23:23,972 INFO org.apache.hadoop.hdfs.DFSClient: Could not obtain block blk_2086525142250101885_39076 from any node:  java.io.IOException: No live nodes contain current block\n2009-02-27 15:25:26,992 INFO org.apache.hadoop.hdfs.DFSClient: Could not obtain block blk_2086525142250101885_39076 from any node:  java.io.IOException: No live nodes contain current block\n2009-02-27 15:27:30,012 WARN org.apache.hadoop.hdfs.DFSClient: DFS Read: java.io.IOException: Could not obtain block: blk_2086525142250101885_39076 file=/user/root/rand2/part-00864\n    at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.chooseDataNode(DFSClient.java:1664)\n    at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.blockSeekTo(DFSClient.java:1492)\n    at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.read(DFSClient.java:1619)\n    at java.io.DataInputStream.read(DataInputStream.java:83)\n    at org.apache.hadoop.util.LineReader.readLine(LineReader.java:134)\n    at org.apache.hadoop.mapred.LineRecordReader.next(LineRecordReader.java:136)\n    at org.apache.hadoop.mapred.LineRecordReader.next(LineRecordReader.java:40)\n    at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.moveToNext(MapTask.java:191)\n    at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.next(MapTask.java:175)\n    at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:48)\n    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:354)\n    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:305)\n    at org.apache.hadoop.mapred.Child.main(Child.java:155)\n\n2009-02-27 15:27:30,018 WARN org.apache.hadoop.mapred.TaskTracker: Error running child\njava.io.IOException: Could not obtain block: blk_2086525142250101885_39076 file=/user/root/rand2/part-00864\n    at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.chooseDataNode(DFSClient.java:1664)\n    at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.blockSeekTo(DFSClient.java:1492)\n    at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.read(DFSClient.java:1619)\n    at java.io.DataInputStream.read(DataInputStream.java:83)\n    at org.apache.hadoop.util.LineReader.readLine(LineReader.java:134)\n    at org.apache.hadoop.mapred.LineRecordReader.next(LineRecordReader.java:136)\n    at org.apache.hadoop.mapred.LineRecordReader.next(LineRecordReader.java:40)\n    at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.moveToNext(MapTask.java:191)\n    at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.next(MapTask.java:175)\n    at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:48)\n    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:354)\n    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:305)\n    at org.apache.hadoop.mapred.Child.main(Child.java:155)\n{noformat}\n\nNote how the DFS client fails multiple times to retrieve the block, with a 2 minute wait between each one, without giving up. During this time, the task is *not* speculated. However, once this task finally failed, a new version of it ran successfully. Getting the input file in question with bin/hadoop fs -get also worked fine.\n\nThere is no mention of the task attempt in question in the NameNode logs but my guess is that something to do with RPC queues is causing its connection to get lost, and the DFSClient does not recover.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"80919","customfield_12312823":null,"summary":"Tasks freeze with \"No live nodes contain current block\", job takes long time to recover","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matei","name":"matei","key":"matei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matei Zaharia","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matei","name":"matei","key":"matei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matei Zaharia","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12415831/comment/12677631","id":"12677631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matei","name":"matei","key":"matei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matei Zaharia","active":true,"timeZone":"America/Los_Angeles"},"body":"I think the root cause of this was me using values that were too small for dfs.namenode.handler.count, dfs.datanode.max.xcievers and ipc.client.connection.maxidletime. After tweaking those I was able to prevent the error from happening. However, I still think the way this was handled is wrong.. you should be allowed to speculate tasks that fail to load up for this reason, rather than having them hang for 8 minutes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matei","name":"matei","key":"matei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matei Zaharia","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-02-28T02:42:22.054+0000","updated":"2009-02-28T02:42:22.054+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12415831/comment/12677632","id":"12677632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matei","name":"matei","key":"matei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matei Zaharia","active":true,"timeZone":"America/Los_Angeles"},"body":"Updated description to remove an insanely long line.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=matei","name":"matei","key":"matei","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matei Zaharia","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-02-28T02:42:56.914+0000","updated":"2009-02-28T02:42:56.914+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-2813/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0e753:"}}