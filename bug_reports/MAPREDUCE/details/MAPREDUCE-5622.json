{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12678951","self":"https://issues.apache.org/jira/rest/api/2/issue/12678951","key":"MAPREDUCE-5622","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2013-11-13T15:40:20.752+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Nov 13 15:40:20 UTC 2013","customfield_12310420":"358317","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-5622/watchers","watchCount":6,"isWatching":false},"created":"2013-11-13T06:23:34.146+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12325050","id":"12325050","description":"2.2.0 release","name":"2.2.0","archived":false,"released":true,"releaseDate":"2013-10-15"}],"issuelinks":[{"id":"12378424","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12378424","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12624704","key":"MAPREDUCE-4893","self":"https://issues.apache.org/jira/rest/api/2/issue/12624704","fields":{"summary":"MR AppMaster can do sub-optimal assignment of containers to map tasks leading to poor node locality","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-11-13T15:40:20.752+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315625","id":"12315625","name":"applicationmaster"}],"timeoriginalestimate":null,"description":"MRAppMaster will request containers for all the splits to launch map tasks, RM will give Node Local containers for all these if available. When the RM gives all containers as Node Local, MR AM may assign these  NODE-LOCAL containers to non-local maps.\n\\\\\n\\\\\n|node1|split1|split2| |split4|\n|node2| |split2|split3| |\n|node3|split1|split2|split3|split4|\n|node4|split1| |split3|split4|\n\\\\\nConsider this instance, assume RM has given one NODE LOCAL container on each node to process all the splits as local maps. While assigning, if the AM gives node1-container for split1, node2-container for split3, node3-container for split3 and node4-container can be given to only split2 which is not local. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"358607","customfield_12312823":null,"summary":"MRAppMaster doesn't assign all allocated NODE_LOCAL containers to node-local maps","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj.k","name":"devaraj.k","key":"devaraj.k","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj K","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj.k","name":"devaraj.k","key":"devaraj.k","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj K","active":true,"timeZone":"America/Los_Angeles"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678951/comment/13820992","id":"13820992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj.k","name":"devaraj.k","key":"devaraj.k","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj K","active":true,"timeZone":"America/Los_Angeles"},"body":"RM Log:\n{code:xml}\nyarn-hdpcrm-resourcemanager-ocean24.log.1:2013-11-11 13:58:36,738 DEBUG org.apache.hadoop.yarn.server.resourcemanager.scheduler.common.fica.FiCaSchedulerApp: allocate: applicationAttemptId=appattempt_1383828930654_0030_000001 container=container_1383828930654_0030_01_000073 host=ocean21 type=NODE_LOCAL\n\nyarn-hdpcrm-resourcemanager-ocean24.log.1:2013-11-11 13:58:36,743 DEBUG org.apache.hadoop.yarn.server.resourcemanager.scheduler.common.fica.FiCaSchedulerApp: allocate: applicationAttemptId=appattempt_1383828930654_0030_000001 container=container_1383828930654_0030_01_000074 host=ocean21 type=NODE_LOCAL\n{code}\n\\\\\nNM Log:\n{code:xml}\n2013-11-11 13:57:38,904 INFO [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator: Assigned container (Container: [ContainerId: container_1383828930654_0030_01_000073, NodeId: ocean21:23240, NodeHttpAddress: ocean21:23239, Resource: <memory:6144, vCores:1>, Priority: 20, State: NEW, Token: null, Status: container_id {, app_attempt_id {, application_id {, id: 30, cluster_timestamp: 1383828930654, }, attemptId: 1, }, id: 73, }, state: C_NEW, ])  to task attempt_1383828930654_0030_m_000061_0 on node ocean21:23240\n2013-11-11 13:57:38,904 DEBUG [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator: Assigned based on rack match /default-rack\n\n\n2013-11-11 13:57:38,905 INFO [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator: Assigned container (Container: [ContainerId: container_1383828930654_0030_01_000074, NodeId: ocean21:23240, NodeHttpAddress: ocean21:23239, Resource: <memory:6144, vCores:1>, Priority: 20, State: NEW, Token: null, Status: container_id {, app_attempt_id {, application_id {, id: 30, cluster_timestamp: 1383828930654, }, attemptId: 1, }, id: 74, }, state: C_NEW, ])  to task attempt_1383828930654_0030_m_000063_0 on node ocean21:23240\n2013-11-11 13:57:38,905 DEBUG [RMCommunicator Allocator] org.apache.hadoop.mapreduce.v2.app.rm.RMContainerAllocator: Assigned based on rack match /default-rack\n{code}\n\\\\\nHere RM says allocating the container as NODE_LOCAL but AM is assigning based on rack match. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=devaraj.k","name":"devaraj.k","key":"devaraj.k","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Devaraj K","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-11-13T06:26:35.535+0000","updated":"2013-11-13T06:26:35.535+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678951/comment/13821434","id":"13821434","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"body":"This stems from the fact that in general AMs can't always correlate container assignments to container requests, and in this case the AM is mistakenly mis-matching the assignments to the tasks that made the requests.\n\nIdeally YARN should allow AMs to associate a piece of app-specific data to container requests and have that returned in the corresponding container assignment.  That would make it trivial for AMs to associate requests with assignments and therefore not screw up the scheduling on their end.  However that's a significant impact on the protocol and RM scheduler, as it currently collates all requests for an application at a particular priority as a simple count and therefore cannot distinguish which request corresponds to a granted container.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jlowe","name":"jlowe","key":"jlowe","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jason Lowe","active":true,"timeZone":"America/Chicago"},"created":"2013-11-13T15:40:20.752+0000","updated":"2013-11-13T15:40:20.752+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-5622/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1prpb:"}}