{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12760085","self":"https://issues.apache.org/jira/rest/api/2/issue/12760085","key":"MAPREDUCE-6185","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310941","id":"12310941","key":"MAPREDUCE","name":"Hadoop Map/Reduce","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310941&avatarId=10096","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310941&avatarId=10096","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310941&avatarId=10096","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310941&avatarId=10096"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10292","id":"10292","description":"Scalable Distributed Computing","name":"Hadoop"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12312322":null,"customfield_12310220":"2015-08-28T05:22:14.881+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Fri Aug 28 05:22:14 UTC 2015","customfield_12310420":"9223372036854775807","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_22710907130_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2015-08-28T05:21:21.803+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-6185/watchers","watchCount":3,"isWatching":false},"created":"2014-12-08T08:46:14.716+0000","customfield_12310192":null,"customfield_12310191":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12310230":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326698","id":"12326698","description":"2.4.1 bug-fix release","name":"2.4.1","archived":false,"released":true,"releaseDate":"2014-06-30"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-08-28T05:22:14.881+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12315343","id":"12315343","name":"jobhistoryserver"}],"timeoriginalestimate":null,"description":null,"customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12310320":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"9223372036854775807","customfield_12312823":null,"summary":"YARN M/R may return NaN for reducer progress after Job completion","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sam+liu","name":"sam liu","key":"sam liu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam liu","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sam+liu","name":"sam liu","key":"sam liu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam liu","active":true,"timeZone":"Asia/Shanghai"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12760085/comment/14237635","id":"14237635","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sam+liu","name":"sam liu","key":"sam liu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam liu","active":true,"timeZone":"Asia/Shanghai"},"body":"This issue is about method 'jobClient.getJob(jobid).reduceProgress()' and only happens on the job which only has map tasks, but no reduce task, such as Teragen.\n\n[A] My Test Code:\n// Using hadoop-mapreduce-client-core\\org.apache.hadoop.mapred.JobClient.java\n\t\tJobClient jobClient = new JobClient(new Configuration()); \n\t\t\n\t\tfor (int i = 0; i < 120; i++){\n\t\t\tThread.sleep(1000);\n\t\t\tSystem.out.println(\"jobClient.getJob(\" + args[0] + \").reduceProgress()=\" + jobClient.getJob(args[0]).reduceProgress());\t\t\t\n\t\t}\n\n[B] WordCount: Got expected result\nCan get reduceProgress during job running(0.0 to 1.0) and after job completion(1.0).\n\n$ hadoop jar yarn.hadoop.jar hadoop.yarn.proj.test.YarnClientTest job_1417679271770_0169\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.20833334\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.20833334\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.20833334\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.33333334\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.33333334\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.33333334\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.6765683\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.6765683\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.6765683\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.76213264\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.76213264\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.76213264\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.8284452\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.8284452\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.8284452\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.9177592\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.9177592\njobClient.getJob(job_1417679271770_0169).reduceProgress()=0.9177592\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\n14/12/04 22:54:21 INFO mapred.ClientServiceDelegate: Application state is completed. FinalApplicationStatus=SUCCEEDED. Redirecting to job history server\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\njobClient.getJob(job_1417679271770_0169).reduceProgress()=1.0\n\n[C] Teragen: Failed to get expected result\n- Can get reduceProgress during job running(0.0 ) \n- But get NaN after job completion\n\nAs Teragen only has Mapper, but does not has Reducer, so I think it's correct.\n\n$ hadoop jar yarn.hadoop.jar hadoop.yarn.proj.test.YarnClientTest job_1417679271770_0168\n14/12/04 22:51:53 INFO client.RMProxy: Connecting to ResourceManager at cluster.nn1/9.31.111.201:8032\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\njobClient.getJob(job_1417679271770_0168).reduceProgress()=0.0\n14/12/04 22:52:17 INFO mapred.ClientServiceDelegate: Application state is completed. FinalApplicationStatus=SUCCEEDED. Redirecting to job history server\njobClient.getJob(job_1417679271770_0168).reduceProgress()=NaN\njobClient.getJob(job_1417679271770_0168).reduceProgress()=NaN\njobClient.getJob(job_1417679271770_0168).reduceProgress()=NaN\njobClient.getJob(job_1417679271770_0168).reduceProgress()=NaN\njobClient.getJob(job_1417679271770_0168).reduceProgress()=NaN\n\nExpected result: '0.0'.\nActual result:  'NaN'.\nComment:\n- Even after job completion, method reduceProgress() still should return same result '0.0', but not 'NaN'.\n- As 'Redirecting to job history server', marked the component of this jira as 'jobhistoryserver'","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sam+liu","name":"sam liu","key":"sam liu","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"sam liu","active":true,"timeZone":"Asia/Shanghai"},"created":"2014-12-08T08:54:17.456+0000","updated":"2014-12-08T08:54:17.456+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12760085/comment/14718076","id":"14718076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"body":"I tried on 2.7.1 version, I did not see this problem. \n\nJob : TeraGen Map Status : 0.0\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.0\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.0\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.0\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.0\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.0\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.10577558\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.1667912\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.21577513\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.28504142\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.3270764\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.39930692\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.45963144\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.5045679\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.57796395\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.65182614\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.695593\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.7389177\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.7799666\nJob : TeraGen Reduce Status : 0.0\nJob : TeraGen Map Status : 0.8276253\nJob : TeraGen Reduce Status : 0.0\n15/08/27 20:24:08 INFO mapred.ClientServiceDelegate: Application state is completed. FinalApplicationStatus=SUCCEEDED. Redirecting to job history server\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\nJob : TeraGen Map Status : 1.0\nJob : TeraGen Reduce Status : 1.0\n\nWhen job finished, the reduce progress is 1.0, which indicates the job is done.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cheersyang","name":"cheersyang","key":"cheersyang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=cheersyang&avatarId=23772","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cheersyang&avatarId=23772","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cheersyang&avatarId=23772","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cheersyang&avatarId=23772"},"displayName":"Weiwei Yang","active":true,"timeZone":"Asia/Shanghai"},"created":"2015-08-28T05:22:14.881+0000","updated":"2015-08-28T05:22:14.881+0000"}],"maxResults":2,"total":2,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAPREDUCE-6185/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i2362f:"}}